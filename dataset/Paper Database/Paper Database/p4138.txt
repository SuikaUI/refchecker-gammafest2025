On-the-fly machine-learning for
high-throughput experiments: search for
rare-earth-free permanent magnets
Aaron Gilad Kusne1,2*, Tieren Gao1*, Apurva Mehta3, Liqin Ke4, Manh Cuong Nguyen4,5, Kai-Ming Ho4,5,
Vladimir Antropov4, Cai-Zhuang Wang4,5, Matthew J. Kramer4, Christian Long1 & Ichiro Takeuchi1
1Department of Materials Science and Engineering, University of Maryland, College Park, MD 20742, USA, 2National Institute of
Standards and Technology, Gaithersburg, MD 20899, USA, 3Stanford Synchrotron Radiation Lightsource, SLAC National
Accelerator Laboratory, Menlo Park, CA 94025, USA, 4Ames Laboratory, Iowa State University, Ames, IA 50011, USA,
5Department of Physics and Astronomy, Iowa State University, Ames, IA, 50011, USA.
Advanced materials characterization techniques with ever-growing data acquisition speed and storage
capabilities represent a challenge in modern materials science, and new procedures to quickly assess and
analyze the data are needed. Machine learning approaches are effective in reducing the complexity of data
and rapidly homing in on the underlying trend in multi-dimensional data. Here, we show that by employing
an algorithm called the mean shift theory to a large amount of diffraction data in high-throughput
experimentation, one can streamline the process of delineating the structural evolution across
compositional variations mapped on combinatorial libraries with minimal computational cost. Data
collected at a synchrotron beamline are analyzed on the fly, and by integrating experimental data with the
inorganic crystal structure database (ICSD), we can substantially enhance the accuracy in classifying the
structural phases across ternary phase spaces. We have used this approach to identify a novel magnetic phase
with enhanced magnetic anisotropy which is a candidate for rare-earth free permanent magnet.
ecent explosion of activities in computational materials design is rapidly changing the landscape of materials science, and massive databases of predicted materials properties are now generated out of high-throughput thermodynamic and electronic-structure calculations1–5. To truly harness the benefits of potential gold
mines contained in the large number of such materials ‘‘blue prints’’, however, it is still necessary to complete the
materials exploration cycle by experimentally verifying the computed results. To establish such a cycle with steady
feedback to predictions, it is often desirable to also carry out experiments in a high-throughput manner.
High-throughput and combinatorial experimental methods have indeed become mainstream techniques in
many arenas of materials science in recent years owing in part to development of sophisticated materials synthesis
and rapid characterization techniques. Depending on the physical property, measurement and data acquisition
speed are now matching or in some instances outpacing the library synthesis speed. In many cases, one can now
collect the data faster than they can be analyzed. This disparity in data collection and analysis time is fueling
interest in expanding the high-throughput materials science to include accelerated data analysis through the use
of new machine learning algorithms.
In the past, machine learning techniques have been implemented to computed materials properties such as
electronic structures6–17. Recent applications in materials science include texture analysis in micrographs18–24.
However, compared to the widespread use in other domains such as medical diagnostics25,26, computational
finances27,28, and natural language processing29, by and large, applications of machine learning in materials science
are in their infancy. This is particularly true for exploratory learning from experimental data, which has been
mostly limited to simple latent variable analysis techniques such as principle component analysis. More effective
data mining techniques are especially in dire need when a large amount of data are being generated in a turn-key
manner and individual data sometimes takes on non-trivial, high-dimensional forms such as spectra or images,
and thus data from combinatorial experimentation represents an ideal platform to carry out machine learning
based analysis.
One demonstrated application of machine learning in data from combinatorial libraries is to employ algorithms to quickly separate different parts of libraries into groups. When this is performed on a large number of xray diffraction patterns taken across a composition spread, the algorithms can be used to guide and delineate
SUBJECT AREAS:
TECHNIQUES AND
INSTRUMENTATION
INFORMATION TECHNOLOGY
SCIENTIFIC DATA
11 June 2014
18 August 2014
15 September 2014
Correspondence and
requests for materials
should be addressed to
I.T. (takeuchi@umd.
* These authors
contributed equally to
this work.
SCIENTIFIC REPORTS | 4 : 6367 | DOI: 10.1038/srep06367
structural phase boundaries leading to rapid construction of a
composition-structure relationship, often an end goal of many materials science experiments30–32. The learned composition-structure
relationship from diffraction data can also be extrapolated to relationships between structure and functional properties such as magnetostriction or piezoelectricity33,34, with structural phase boundaries
indicating potential regions of significant change in functional properties. Here, we have devised an efficient and computationallyinexpensive new algorithm based on mean shift theory (MST) which
overcomes shortcomings of previous methods we had used (hierarchical clustering and non-negative matrix factorization), including
the inability to handle diffraction peak shifting.
Equipping the data analysis platform with a means of accessing
and utilizing data entries from existing archival databases can
provide significant benefits: analyzing experimental data in rapid
cross-referencing mode with verified/archived data entries can substantially increase reliability and one’s confidence in analysis performance. To this end, for studying a large number of x-ray
diffraction data, we have developed a technique to mix and guide
clustering of experimental diffraction patterns with simulated diffraction patterns using entries from the Inorganic Crystal Structure
Database (ICSD), containing over 166,000 known compounds.
Further integrating the analysis platform with direct access to data
as it is being collected by the characterization systems can provide the
added benefits of live data analysis. For example, when instrument
time or financial constraints limit the number of measurements to be
performed, live data analysis can provide a means for guiding one to
the optimal (number of) samples to characterize, maximizing knowledge of the overall set of samples with a minimum number of measurements. This is of great utility to experiments being carried out,
for instance, at synchrotron beamlines.
We have developed a comprehensive algorithm which allows onthe-fly analysis of diffraction data from combinatorial libraries as
they are collected and rapidly cross-referenced with pre-selected
entries from the ICSD. Below, we describe how this strategy was used
to study a series of Fe-Co-X ternary thin film composition spreads
(where X is a transition metal element such as Mo, W, Ta, Zr, Hf, and
V)35,36 to explore novel magnetic phases with enhanced magnetic
anisotropy. Through the use of mean shift theory37 as the machinelearning technique of choice on-the-fly separation and grouping of
hundreds of diffraction patterns taken at a synchrotron beamline
have led to the identification of a Mo substituted Fe-Co, whose
tetragonally distorted structure is the origin of enhanced magnetic
anisotropy.
Unsupervised learning as applied to data from combinatorial
materials libraries. Previously, hierarchical cluster analysis (HCA)
has been used to sort samples within combinatorial libraries into
groups with similar characteristics using x-ray diffraction patterns,
Raman spectra, and ferroelectric hysteresis loops30,34. In addition to
separating the composition regions into groups with similar structural properties, comparison of clustering results from different
measurement techniques has been effective in revealing hidden
correlations between physical properties. It is important to
recognize that however robust and automated such a procedure
might become, the clustering results always require human
inspection for consistency and agreement with physical rules, e.g.
Gibb’s phase rule. The high speed technique of principal component analysis and other multidimensional scaling methods have
been used to take the high dimensional powder patterns, typically
hundreds to thousands of dimensions long, and visualize them in a
2D or 3D space, allowing experts to quickly determine structural
trends. The latent variable analysis tool of non-negative matrix
factorization (NMF) has also been found to be useful for swiftly
identifying different phase mixture regions through a rapid basis
pattern deconvolution process31.
However, one problem these techniques have in common is that
they do not perform as well in the presence of peak shifting (the
movement of diffraction peaks as a function of continuously changing composition due to lattice constant change), and often cluster
adjacent region with shifted lattice constants as different phases.
Because shifting of peaks as a function of composition is also common in many other spectral data such as Raman and X-ray photoelectron spectroscopy, a robust algorithm which can keep track of
moving peaks is needed for analysis of a variety of characterization
techniques.
One solution to the peak shifting issue had been proposed in the
method of dynamic time warping (DTW). This method provides a
measure for identifying similarities between diffraction patterns despite the presence of peak shifts38. LeBras, et al. incorporated the DTW
measure into their clustering algorithm39. The algorithm breaks
down each diffraction pattern into a list of peaks and uses constraint
programming to discover the constituent phases through hard constraints on the form of the constituent phases. This algorithm is
resilient to peak shifting and enforces both phase region connectivity
and the Gibbs’ phase rule. However, it currently comes at a high
computational cost. Evaluation time can run in the tens of hours,
without additional data processing performed by the user – currently
too slow for a turn-key operation of continuous measurement/analysis cycles.
Out of a number of relatively new machine learning techniques we
have looked at40, we have elected to implement MST for the current
work. We have found that MST is resilient to the presence of background noise in diffraction patterns and peak shifting and provides
good cluster connectivity. MST is also fast and computationally inexpensive, taking less than ten seconds to analyze the material systems
discussed here, and, as such, can be used for high-throughput analysis40. MST is a non-parameteric density estimation based clustering
method. While not a Bayesian method, MST’s statistical framework
provides a probabilistic perspective on cluster membership in a high
speed algorithm. The density of samples in the sample feature space
are assumed to be dictated by probability density functions (PDF)
associated with underlying (and unknown) sample classifications.
For the case of mapping a composition spread, the classifications
are assumed to be phase mixture regions in the composition space.
MST identifies the PDF modes and sorts samples into clusters associated with each mode. This method is robust and applicable to different phase distribution scenarios, i.e. the phase regions to be
distinguished can be either phase pure or phase mixed regions.
(Figure 1) The implementation of MST follows the work found in
The feature vectors used for this work are a concatenation of the
relative ternary composition with x-ray diffraction pattern intensity
in order of corresponding Q values. While only the two feature types
of composition and x-ray diffraction patterns have been used for this
analysis, the MST method in general is capable of clustering based on
a larger set of features including scalar features such as coercive field
and high dimensional features such as Raman spectra. We combine
experimental sample vectors with simulated sample vectors derived
from the ICSD to provide improved clustering results.
To validate the overall approach developed here, MST was applied
to a set of diffraction data from a Fe-Ga-Pd composition spread30,
which were previously also analyzed with other clustering techniques
in separating composition regions into groups with similar crystal
structures (Figure 2).
Compared to hierarchical clustering (Fig. 2a) and non-negative
matrix factorization (Fig. 2b), MST (Fig. 2d) provides similar clustering results separating composition regions into different structural phases previously identified.
Inclusion of ICSD indeed leads to improved clustering results
when using a suboptimal choice of bandwidths (Fig. 2c and 2d).
We therefore incorporate ICSD data in analysis of all systems whenwww.nature.com/scientificreports
SCIENTIFIC REPORTS | 4 : 6367 | DOI: 10.1038/srep06367
ever data are available. Because most ICSD entries are for binary
compounds, as is the case with most ternary composition phase
diagram studies, this works in such a way so that the mapping of
ternary composition spreads is guided by known binary phases.
High-throughput search of Fe-Co-X with enhanced magnetic
anisotropy. The utility of the above mentioned method was
demonstrated in the high-throughput experimental search of novel
rare-earth-free permanent magnets. We are systematically exploring
Fe-Co-X composition spreads, where X is one of the 3d, 4d or 5d
transition-metal elements. The outstanding challenge in the
permanent magnet materials community is to design a magnetic
sufficient
magnetization
anisotropy without the use of inherently large spin-orbit coupling
present in rare-earth elements42. One avenue to pursue such
compounds is to insert elements such as W, Mo, or V in small
atomic percentage to Fe-Co, so that hybridization of electronic
states due to the finite spin-orbit coupling of 4d or 5d electrons
with those of Fe and Co would lead to magnetic anisotropy.
Another possibility is that small atomic percentage of inserted X
element in the unit cell of cubic Fe-Co leads to tetragonal
distortion resulting in magnetocrystalline anisotropy43–45.
Fe-Co-X thin film composition spreads encompassing large ternary composition variation were made by co-sputtering and annealed
in vacuum at 700uC for X 5 Mo, W, Ta, Zr, Hf, and V35. Their
magnetic properties were initially screened by a scanning MOKE
(magneto-optical Kerr effect) set up, followed by more detailed hysteresis measurements using vibrating sample magnetometry (VSM)
once composition regions which display indication of enhanced outof-plane anisotropy were identified. Based on the shapes of the hysteresis loops, we can separate the composition regions into different
groups as shown in Fig. 3(a), where hysteresis loops are overlaid on
their approximate positions on the composition spread wafer. Such a
quick visualization scheme is effective in rapidly assessing the landscape of how magnetism evolves as a continuous function of
composition34.
A composition region which consistently displays increased coercive field (which we take as the sign of anisotropy enhancement) in a
single-phase-like out-of-plane hysteresis loop was observed in Fe-
Co-Mo composition spreads (hysteresis loops plotted in red in
Fig. 3(a)). This group of compositions was found to be centered
around Fe78Co11Mo11. Fig. 3(b) shows the typical out-of-plane and
in-plane hysteresis loops of a Fe78Co11Mo11 film. Other major characteristics seen in this visualization include 1) a broad composition
region where two-phase-like out-of-plane hysteresis curves are
observed indicating the presence of two co-existing magnetic phases
(within each sample) with different coercive fields, and 2) a region
with atom % concentration of Mo larger than 40%, where the films
largely display paramagnetic behavior due to nanocrystalline and
amorphous films.
The out-of-plane coercive field can also be mapped on the Fe-Co-
Mo ternary spread as shown in Fig. 3(c). We see a clear transition of
magnetization easy axis from out-of-plane to in-plane, and it is
reflected in the out-of-plane coercive field map as a function of
composition: the films of high Fe and low Mo concentration areas
show higher perpendicular coercive field indicated by the red spots
(corresponding to highest values in the coercive field measured here),
and the films of high Co or high Mo concentration areas show
minimal to no perpendicular coercive field from the blue spots where
the magnetizations predominantly are lying in the film plane.
In order to streamline the process of determining the phase distribution and structural evolution across composition spreads, we
carried out synchrotron x-ray diffraction at beam line 7-2 at Stanford
Synchrotron Radiation Laboratory. An automated scanning stage is
used to quickly step from spot to spot on the composition spread
wafer, so that each diffraction image is acquired in 30 seconds per
spot, and it takes roughly two hours to obtain mapping of the entire
spread with approximately 200 spots using a Pilatus detector. The
Figure 1 | Mean shift theory (MST) as applied to diffraction patterns taken from a composition spread wafer for rapid phase distribution analysis.
(a) X-ray diffraction data are taken from a thin-film composition spread wafer mapping a ternary (A-B-C) compositional phase diagram. The data are
then analyzed using cluster analysis to produce a potential structural phase distribution diagram, identifying separated phase regions. (b) The MST
process: 1) Feature vectors are produced for each sample on a combinatorial library. Each sample is projected into the feature vector space - shown here as
2 dimensional and unitless for ease of visualization, and the feature vector density is correlated to an underlying probability density function (PDF) for
each ‘hidden’ classification, which in this case are assumed to be two separated different phase regions R1 and R2. 2) PDF analysis is performed using
MST-based mode detection, and all samples from the same PDF are clustered together.
www.nature.com/scientificreports
SCIENTIFIC REPORTS | 4 : 6367 | DOI: 10.1038/srep06367
data were analyzed on-the-fly using a combination of software,
WxWindows Diffraction Integration Tool for integration of diffraction images into diffraction patterns, and CombiDM-Live for live
clustering analysis. The fast and computationally-inexpensive MST
implemented in this manner enabled the live analysis in such a way
so that as the diffraction images are acquired for a spread wafer,
updated clustering results are available for human inspection after
measurement of each spot. Because of the robustness of the MST
results, no noise smoothing was required for the analysis.
A quick inspection of the clustering behavior of the diffraction
patterns using MST (Fig. 3 (d)) on a Fe-Co-Mo spread revealed that a
group of compositions with enhanced single-phase-like coercive
field (in Fig. 3(c)) coincides with a clustered region which displays
a broad diffraction peak observed at q 5 3.06 , 3.09 A˚ 21 (red cluster
in Fig. 3(d)). Fig. 3 (e) shows the intensity plot of all the X-ray
diffraction patterns, grouped by MST in a selected q-region from
2.9 and 3.3 A˚ 21. From the top, they are: the region of interest with
the broadened diffraction peak which coincides with the perpendicularly magnetized samples (red); the a-bcc Fe phase region with the
sharp (110) peak (blue); the fcc Co phase, cubic Co-Mo or Fe-Mo
phases (green). Because of the limited Mo solubility (at the annealing
temperature of 700uC) and the non-equilibrium sputtering process,
the mapping of the observed phases is a non-equilibrium one. Some
clustered regions (red and green) stretch into the high average Mo
concentration region due partly to segregation of Mo (which we have
confirmed with transmission electron microscopy (not shown)).
The films with the composition in the vicinity of Fe78Co11Mo11
show perpendicular magnetic anisotropy with coercive field of
1.2 kOe (95.5 kA/m) and magnetization of 850 emu/cc (850 kA/m)
(Fig. 3(b)). From these numbers, one can estimate the perpendicular
anisotropy KU using HK~ 2KU
assuming that the magnetization
reversal is through coherent rotation. Here, MS is the saturation
magnetization, and HK is the anisotropic field. The estimated perpendicular anisotropy KU is typically around 3.6 3 106 erg/cm3
(27.0 meV/atom) for Fe78.4Co10.8Mo10.8 which is of the same order
as that of the Co-Pt alloy46.
To understand the origin of the enhanced coercive field and the
out-of-plane anisotropy of this compound, we have employed the
genetic algorithm (GA) search approach47,48 using the composition
Fe8CoMo, and the Scherrer equation was used in simulating the XRD
patterns to take into account the broadening of the peak with a
typical grain size of 50 nm (observed with transmission electron
microscopy, not shown). There is good agreement between the
Figure 2 | Comparison of clustering results using different machine learning techniques applied to diffraction data taken from a Fe-Ga-Pd
composition spread in the Fe-rich region. (a) Hierarchical cluster analysis clustering of diffraction pattern data (left); representative diffraction patterns
from major cluster groups are plotted on the right; Reproduced from Ref. . (b) Non-negative matrix factorization (NMF) analysis provides the
positive principle components of the diffraction patterns. NMF gives deconvolution of patterns into components corresponding to peaks from pure
phases, and accordingly, pie-charts are obtained at each average composition spot (left); peaks from basis patterns are then identified (right); Reproduced
from Ref . (c) High-speed mean shift theory based structural phase distribution analysis of experimental data using a suboptimal choice of bandwidth
parameters. (d) High-speed MST results for experimental diffraction pattern data (ternary data points) and simulated data based on ICSD entries (square
points along the binary lines) using the same suboptimal choice of bandwidths as in (c). ICSD based simulated data provides improved cluster stability
despite suboptimal bandwidth choice.
www.nature.com/scientificreports
SCIENTIFIC REPORTS | 4 : 6367 | DOI: 10.1038/srep06367
experimental XRD pattern and the simulated pattern for a relatively
low energy tetragonal P4/m structure (Fig. S1) identified by the GA
search (Fig. 3(f)).
The formation energy of the P4/m structure is positive (7.7 meV/
atom), indicating that the structure may be a metastable one.
However, the structure can be stabilized in non-equilibrium processes depending on synthesis conditions. We believe it is not unreasonable that our co-sputtered films have resulted in formation of this
structure. The magnetic moment of 4j-site Fe, 4k-site Fe, Co and Mo
atoms in the P4/m Fe8CoMo structure are 2.11, 2.55, 1.67 and
20.61 mB, respectively, in our spin-polarized calculations. A noncollinear magnetic structure density function theory calculation
spin-orbit
interaction
Fe8CoMo structure has a uniaxial easy axis along the (001) direction
with magnetic anisotropy energy of 18.2 meV/atom, which compares
well with the experimental observed value of 27.0 meV/atom.
Alternatively, the observed broadened bcc (110) peak can be taken
as merging of two tetragonal peaks with a corresponding c/a ratio of
approximately 1.04. We have also calculated the magnetocrystalline
anisotropy energy (MAE) of Fe8CoMo with a layered structure using
this c/a ratio value using the full potential LMTO (linear muffin tin
orbital) method. The calculation details can be found elsewhere49.
The calculated MAE is 28.0 meV/atom, which is very close to the
experimentally extracted anisotropy value. Our calculations also
indicate that a similar distortion may be brought about by substitution of other elements such as W and V.
We have thus experimentally realized a sought-after tetragonally
distorted Fe-Co43,44 by introducing a third element and identified its
composition. While the increase in anisotropy is modest, the fact that
such a structure can be realized in a thin film form indicates that this
is potentially a viable path toward manufacturing rare-earth free
permanent magnets.
We have shown the use of the MST machine learning algorithm
for on-the-fly analysis of x-ray diffraction and composition data
toward the discovery of a novel rare-earth-free permanent magnet.
While the MST method was found to be resilient to noise in the data,
specifically diffraction pattern noise, further algorithm developments should focus on Bayesian techniques that utilize data noise
to quantify the uncertainty of cluster membership. Furthermore, an
area of machine learning that may prove fruitful for high speed
diffraction pattern analysis, including pure phase identification, is
that of blind source separation: this is a research direction made
popular by the famous cocktail party problem, where the goal is to
identify individual speakers in a crowded room through the use of
multiple simultaneous audio recordings, each recording containing a
different mixture of the party goers’ voices. For the case of the combinatorial library, the analogous goal is to identify pure phases from
samples containing different phase mixtures. The diffraction patterns from the different phase mixture samples provide the multiple
‘recordings’ of the mixed pure phases to be analyzed with blind
source separation. A collection of simple clustering methods such
as MST and hierarchical cluster analysis can also be used in combination with a collection of blind source separation methods
through the use of an ensemble algorithm that capitalizes on each
method’s benefits to provide an optimized analysis result. For
example, the ensemble method could select the clustering result with
the greatest cluster stability and then utilize the cluster boundaries to
inform the blind source separation method on potential phase
boundaries.
Naturally, the methods presented here can be extended to a variety
of other spectral and image data. As previously demonstrated34, such
clustering algorithms (as well as visualization) can be applied simultaneously to data from a number of different physical properties
measured on the same composition spread in order to rapidly delineate correlations between them. An important next step in developing the rapid materials exploration cycle is to directly integrate
computational results and experimental results, as some computational databases provide extensive information on predicted stable
crystal structures with lattice constants50. Carrying out various
machine learning algorithms on merged diffraction data from
high-throughput experiments together with simulated diffraction
patterns from predicted structures would provide instant feedback
Figure 3 | Magnetic and structural property maps of Fe-Co-Mo composition spread: (a) out-of-plane hysteresis loops of Fe-Co-Mo samples for different
compositions superimposed on the spread wafer positions; (b) typical out-of-plane (OOP, red) and in-plane (IP, black) hysteresis loops of
Fe78.4Co10.8Mo10.8 sample with perpendicular anisotropy (1 emu/cc 5 103 A/m, 1 Oe 5 103/(4p) A/m); (c) Out-of-plane coercive field map of Fe-Co-Mo
ternary alloys. (d) Clustering results of diffraction data using MST of Fe-Co-Mo ternary; (e) Intensity plot of x-ray diffraction patterns grouped by the
clustering result (same color clusters as Fig. 3(d)); (f) Synchrotron X-ray diffraction spectrum (red) of Fe78Co11Mo11 and calculated X-ray diffraction
spectrum (black) with P4/m tetragonal structure.
www.nature.com/scientificreports
SCIENTIFIC REPORTS | 4 : 6367 | DOI: 10.1038/srep06367
on a number of computational results simultaneously. Such an integrated platform could thus truly speed up the process of materials
discovery in the future.
For mean shift theory clustering, the concatenated sample vectors are first normalized
by subtracting the vector mean. No noise smoothing is performed. The feature vectors
in the composition space are assumed to be relatively uniformly distributed and the
local density in both feature spaces is approximated using the normal kernel density
estimator ^f given by:
exp { dL1 x,xi
where dL1 is the L1 metric51, h is the bandwidth, and a symmetric kernel support of ch
is used with c 5 1. Two bandwidths are selected by the user, one for the diffraction
data and one for the relative composition data, and these bandwidths determine the
mode detection resolution. Choice of bandwidths impacts the number of clusters in
the final clustering results, with suboptimal bandwidth choices resulting in either too
many or too few clusters. The bandwidth selection heuristic used here and alternative
methods for setting the bandwidths are discussed in the Supplementary Information.
The experimental sample vectors and the ICSD derived sample vectors are combined in the same feature space during clustering. The experimental samples are given
a mass of 1 during MST mode detection, and all ICSD vectors are given the same user
determined mass. Increasing the mass of the ICSD vectors increases local density in
the feature space. In this way, the critically evaluated data from the ICSD can be given
greater influence in guiding the clustering results than the experimentally obtained
data. Cluster assignment is performed by associating each converged sample vector to
the nearest original diffraction pattern, and all sample vectors that share the same
associated diffraction pattern are assigned to the same cluster. Again, validation of
clustering results against physical rules (e.g. Gibbs’ phase rule for equilibrium systems) by a human expert is critical.
In incorporating data from the ICSD, the material structure data was exported in
CIF format and then transformed into simulated diffraction patterns using Bruker’s
Topas software. Typical parameters were used and are listed in Table S1 in
Supplementary Information. The simulated patterns from ICSD were then combined
with their compositions to create simulated sample vectors. Most of the metallic film
phases we are looking at deposited on Si/SiO2 wafers predominantly grow with (110)/
(101) texture (for a-Fe and related structures studied here), and therefore in generating the simulated patterns, (110) (and its family of) peaks were used as the main
The ternary composition spread films were deposited using magnetron co-sputtering on 3-inch diameter Si wafers (with 200 nm thick thermally oxidized SiO2 layer)
at room temperature. The details of the composition spread deposition technique are
described elsewhere52. A physical shadow mask is used to separate the composition
spread film into a grid of 4.5 mm 3 4.5 mm regions in order to characterize the
structural and magnetic properties. The room-temperature deposited samples were
then post-annealed in vacuum at 700uC for 45 min. The average composition for
both spreads of each thin film region is determined by wavelength dispersive spectroscopy (WDS). The synchrotron X-ray diffraction was performed with 16.5 keV
energy at Beam line 7-2 at Stanford Synchrotron Radiation Laboratory (SSRL). Some
of the Fe-Co-Mo wafers were cut into small pieces to characterize the magnetic and
microstructural properties by vibrating sample magnetometry (VSM) and transmission electron microscopy (TEM).
The genetic algorithm (GA) searches were ‘‘from scratch’’ with only chemical
compositions given. Structural optimizations during the GA searches were carried
out by LAMMPS code53 with Embedded Atom Method potential developed by Zhou
et. al.54. The low energy structures obtained from GA searches were then fully relaxed
again by first-principles calculations for the final structures. The first-principle spinpolarized density functional theory calculations55 were performed by Vienna Ab
initio Simulation Package56 with PAW pseudopotential method57,58 within generalized-gradient approximation59. The energy cutoff was 370 eV and the Monkhorst-
Pack’s scheme60 was used for Brillouin zone sampling. A high-quality k-point grid,
which is corresponding to 14 3 14 3 14 for body-centered cubic (bcc) Fe, was used in
all calculations. The references for formation energy calculations were bcc Fe, hexagonal closed-pack (hcp) Co and bcc Mo. The X-ray diffraction patterns were simulated with X-ray wavelength l 5 0.7517 A˚ and the Scherrer equation was used for the
peak broadening with sample size of 50 nm.
The magnetocrystalline anisotropy of layered Fe8CoMo was calculated by using the
full potential (FP) LMTO method with smoothed generalizations of Hankel functions
for the envelope functions. Spin-orbit coupling has been added into the Hamiltonian
and self-consistent calculations have been performed with spin quantization direction along different directions. The integration over the Brillouin zone was performed using the tetrahedron method with the Blo¨ch’s correction. A dense k-mesh
was used for integration to ensure a good accuracy of calculated MAE. Certain
commercial equipment, instruments, or materials are identified in this publication for
informational purposes only. Such identification is not intended to imply recommendation or endorsement by NIST, nor is it intended to imply that the materials or
equipment identified are necessarily the best available for the purpose.
1. Curtarolo, S. et al. The high-throughput highway to computational materials
design. Nat. Mater. 12, 191–201 .
2. Jain, A. et al. A high-throughput infrastructure for density functional theory
calculations. Comput. Mater. Sci. 50, 2295–2310 .
3. Klintenberg, M. The Electronic Structure Project. Electron. Struct. Proj. . at
, .
4. Landis, D. D. et al. The Computational Materials Repository. Comput. Sci. Eng. 14,
51–57 .
5. Mihalkovicˇ, M. & Widom, M. Ab initio calculations of cohesive energies of Febased glass-forming alloys. Phys. Rev. B 70, 144107 .
6. Fischer, C. C., Tibbetts, K. J., Morgan, D. & Ceder, G. Predicting crystal structure
by merging data mining with quantum mechanics. Nat. Mater. 5, 641–646 .
7. Saad, Y. et al. Data mining for materials: Computational experiments with AB
compounds. Phys. Rev. B 85, 104104 .
8. Pilania, G., Wang, C., Jiang, X., Rajasekaran, S. & Ramprasad, R. Accelerating
materials property predictions using machine learning. Sci. Rep. 3, 1–6 .
9. Snyder, J. C., Rupp, M., Hansen, K., Mu¨ller, K.-R. & Burke, K. Finding Density
Functionals with Machine Learning. Phys. Rev. Lett. 108, 253002 .
10. Montavon, G. et al. Machine learning of molecular electronic properties in
chemical compound space. New J. Phys. 15, 095003 .
11. Hautier, G., Fischer, C. C., Jain, A., Mueller, T. & Ceder, G. Finding Nature’s
Missing Ternary Oxide Compounds Using Machine Learning and Density
Functional Theory. Chem. Mater. 22, 3762–3767 .
12. Rupp, M., Tkatchenko, A., Mu¨ller, K.-R. & von Lilienfeld, O. A. Fast and Accurate
Modeling of Molecular Atomization Energies with Machine Learning. Phys. Rev.
Lett. 108, 058301 .
13. Balabin, R. M. & Lomakina, E. I. Neural network approach to quantum-chemistry
data: Accurate prediction of density functional theory energies. J. Chem. Phys.
131, 074104 .
14. Hansen, K. et al. Assessment and Validation of Machine Learning Methods for
Predicting Molecular Atomization Energies. J. Chem. Theory Comput. 9,
3404–3419 .
15. D’ Avezac, M., Luo, J.-W., Chanier, T. & Zunger, A. Genetic-Algorithm Discovery
of a Direct-Gap and Optically Allowed Superstructure from Indirect-Gap Si and
Ge Semiconductors. Phys. Rev. Lett. 108, 027401 .
16. Behler, J. Neural network potential-energy surfaces in chemistry: a tool for largescale simulations. Phys. Chem. Chem. Phys. 13, 17930–17955 .
17. Meredig, B. et al. Combinatorial screening for new materials in unconstrained
composition space with machine learning. Phys. Rev. B 89, 094104 .
18. Huffman, L., Simmons, J., De Graef, M. & Pollak, I. Shape priors for MAP
segmentation of alloy micrographs using graph cuts. in Proc. IEEE Stat. Signal
Process. Workshop 661–664 .
19. Simmons, J. P. et al. Application and further development of advanced image
processing algorithms for automated analysis of serial section image data. Model.
Simul. Mater. Sci. Eng. 17, 025002 .
20. Comer, M., Bouman, C. A., Graef, M. D. & Simmons, J. P. Bayesian methods for
image segmentation. JOM 63, 55–57 .
21. MacSleyne, J. P., Simmons, J. P. & De Graef, M. On the use of 2-D moment
invariants for the automated classification of particle shapes. Acta Mater. 56,
427–437 .
22. Gulsoy, E. B., Simmons, J. P. & De Graef, M. Application of joint histogram and
mutual information to registration and data fusion problems in serial sectioning
microstructure studies. Scr. Mater. 60, 381–384 .
23. Niezgoda, S. R., Yabansu, Y. C. & Kalidindi, S. R. Understanding and visualizing
microstructure and microstructure variance as a stochastic process. Acta Mater.
59, 6387–6400 .
24. Kalidindi, S. R., Niezgoda, S. R. & Salem, A. A. Microstructure informatics using
higher-order statistics and efficient data-mining protocols. JOM 63, 34–41 .
25. Lavracˇ, N. in Artif. Intell. Med. (Horn, W., Shahar, Y., Lindberg, G., Andreassen, S.
& Wyatt, J.) 47–62 .
26. Cleophas, T. J. & Zwinderman, A. H. Machine Learning in Medicine. .
28. Kovalerchuk, B. & Vityaev, E. in Data Min. Knowl. Discov. Handb. (Maimon, O. &
Rokach, L.) 1203–1224 .
29. Jurafsky, D. & Martin, J. H. Speech and language processing: an introduction to
natural language processing, computational linguistics, and speech recognition.
 .
30. Long, C. et al. Rapid structural mapping of ternary metallic alloy systems using the
combinatorial approach and cluster analysis. Rev. Sci. Instrum. 78, 072217 .
31. Long, C., Bunker, D., Li, X., Karen, V. & Takeuchi, I. Rapid identification of
structural phases in combinatorial thin-film libraries using x-ray diffraction and
non-negative matrix factorization. Rev. Sci. Instrum. 80, 103902 .
32. Barr, G., Dong, W. & Gilmore, C. J. High-throughput powder diffraction. II.
Applications of clustering methods and multivariate data analysis. J. Appl.
Crystallogr. 37, 243–252 .
www.nature.com/scientificreports
SCIENTIFIC REPORTS | 4 : 6367 | DOI: 10.1038/srep06367
33. Hunter, D. et al. Giant magnetostriction in annealed Co1-xFex thin-films. Nat.
Commun. 2, 518 .
34. Kan, D., Long, C. J., Steinmetz, C., Lofland, S. E. & Takeuchi, I. Combinatorial
search of structural transitions: Systematic investigation of morphotropic phase
boundaries in chemically substituted BiFeO3. J. Mater. Res. 27, 2691–2704 .
35. Gao, T. et al. Combinatorial exploration of rare-earth-free permanent magnets:
Magnetic and microstructural properties of Fe-Co-W thin films. Appl. Phys. Lett.
102, 022419 .
36. Sourmail, T. Near equiatomic FeCo alloys: Constitution, mechanical and
magnetic properties. Prog. Mater. Sci. 50, 816–880 .
37. Fukunaga, K. & Hostetler, L. The estimation of the gradient of a density function,
with applications in pattern recognition. IEEE Trans. Inf. Theory 21, 32–40
38. Baumes, L. A., Moliner, M., Nicoloyannis, N. & Corma, A. A reliable methodology
for high throughput identification of a mixture of crystallographic phases from
powder X-ray diffraction data. CrystEngComm 10, 1321–1324 .
39. LeBras, R. et al. in Princ. Pract. Constraint Program. 2011 508–522 (Springer,
40. Mueller, T., Kusne, A. G. & Ramprasad, R. Machine learning in materials science:
Recent progress and emerging applications. Rev. Comput. Chem. (Accepted for
publication).
41. Comaniciu, D. & Meer, P. Mean shift: A robust approach toward feature space
analysis. Pattern Anal. Mach. Intell. IEEE Trans. On 24, 603–619 .
42. Kramer, M. J., McCallum, R. W., Anderson, I. A. & Constantinides, S. Prospects
for Non-Rare Earth Permanent Magnets for Traction Motors and Generators.
JOM 64, 752–763 .
43. Burkert, T., Nordstro¨m, L., Eriksson, O. & Heinonen, O. Giant Magnetic
Anisotropy in Tetragonal FeCo Alloys. Phys. Rev. Lett. 93, 027203 .
44. Andersson, G. et al. Perpendicular Magnetocrystalline Anisotropy in Tetragonally
Distorted Fe-Co Alloys. Phys. Rev. Lett. 96, 037205 .
45. Yildiz, F., Przybylski, M., Ma, X.-D. & Kirschner, J. Strong perpendicular
anisotropy in Fe1-xCox alloy films epitaxially grown on mismatching Pd(001),
Ir(001), and Rh(001) substrates. Phys. Rev. B 80, 064415 .
46. Weller, D., Bra¨ndle, H., Gorman, G., Lin, C.-J. & Notarys, H. Magnetic and
magneto-optical properties of cobalt-platinum alloys with perpendicular
magnetic anisotropy. Appl. Phys. Lett. 61, 2726–2728 .
47. Deaven, D. & Ho, K. Molecular geometry optimization with a genetic algorithm.
Phys. Rev. Lett. 75, 288–291 .
48. Ji, M., Wang, C.-Z. & Ho, K.-M. Comparing efficiencies of genetic and minima
hopping algorithms for crystal structure prediction. Phys. Chem. Chem. Phys. 12,
11617–11623 .
49. Ke, L., Belashchenko, K. D., van Schilfgaarde, M., Kotani, T. & Antropov, V. P.
Effects of alloying and strain on the magnetic properties of Fe16N2. Phys. Rev. B
88, 024404 .
50. Curtarolo, S. et al. AFLOWLIB.ORG: A distributed materials properties
repository from high-throughput ab initio calculations. Comput. Mater. Sci. 58,
227–235 .
51. Krause, E. F. Taxicab Geometry: An Adventure in Non-Euclidean Geometry.
 .
52. Takeuchi, I. et al. Identification of novel compositions of ferromagnetic shapememory alloys using composition spreads. Nat. Mater. 2, 180–184 .
53. Plimpton, S. Fast parallel algorithms for short-range molecular dynamics.
J. Comput. Phys. 117, 1–19 .
54. Zhou, X., Johnson, R. & Wadley, H. Misfit-energy-increasing dislocations in
vapor-deposited CoFe/NiFe multilayers. Phys. Rev. B 69, 144113 .
55. Kohn, W. & Sham, L. J. Self-consistent equations including exchange and
correlation effects. Phys. Rev. 140, A1133–A1138 .
56. Kresse, G. & Furthmu¨ller, J. Efficient iterative schemes for ab initio total-energy
calculations using a plane-wave basis set. Phys. Rev. B 54, 11169–11185 .
57. Blo¨chl, P. E. Projector augmented-wave method. Phys. Rev. B 50, 17953 .
58. Kresse, G. & Joubert, D. From ultrasoft pseudopotentials to the projector
augmented-wave method. Phys. Rev. B 59, 1758–1775 .
59. Perdew, J. P., Burke, K. & Ernzerhof, M. Generalized gradient approximation
made simple. Phys. Rev. Lett. 77, 3865–3868 .
60. Monkhorst, H. J. & Pack, J. D. Special points for Brillouin-zone integrations. Phys.
Rev. B 13, 5188–5192 .
Acknowledgements
This project was funded by the beyond rare-earth permanent magnet project (U.S. DOE
EERE under the Vehicle Technologies Program), NIST grant #70NANB10H207, and
partially funded by the ARPA-E REACT program. We acknowledge valuable discussions
with V.L. Karen, U.R. Kettner, T. Vanderah, R. McCallum and I. Anderson. We also
acknowledge the computing resources supports from Oak Ridge Leadership Computing
Facility (OLCF) via INCITE project. The work at Stanford Synchrotron Radiation
Lightsource, SLAC National Accelerator Laboratory is supported by the U.S. Department of
Energy, Office of Science, Office of Basic Energy Sciences under Contract No.
DE-AC02-76SF00515.
Author contributions
The on-the-fly machine learning procedure was conceived and developed by A.G.K. and
I.T. T.G. made the combinatorial libraries and did the magnetic characterization. T.G.,
A.M., M.J.K. and I.T. carried out the synchrotron diffraction experiment. L.K. and V.A.
performed the density functional theory calculations. The genetic algorithm calculations
were carried out by M.C.N., C.Z.W. and K.M.H. C.L. performed the non-negative matrix
factorization on the Fe-Ga-Pd data. A.G.K., T.G. and I.T. wrote the manuscript. All authors
discussed and commented on the manuscript.
Additional information
Supplementary information accompanies this paper at 
scientificreports
Competing financial interests: The authors declare no competing financial interests.
How to cite this article: Kusne, A.G. et al. On-the-fly machine-learning for
high-throughput experiments: search for rare-earth-free permanent magnets. Sci. Rep. 4,
6367; DOI:10.1038/srep06367 .
This work is licensed under a Creative Commons Attribution-NonCommercial-
ShareAlike 4.0InternationalLicense.The images or other third party material in this
article are included in the article’s Creative Commons license, unless indicated
otherwise in the credit line; if the material is not included under the Creative
Commons license, users will need to obtain permission from the license holder
in order to reproduce the material. To view a copy of this license, visit http://
creativecommons.org/licenses/by-nc-sa/4.0/
www.nature.com/scientificreports
SCIENTIFIC REPORTS | 4 : 6367 | DOI: 10.1038/srep06367