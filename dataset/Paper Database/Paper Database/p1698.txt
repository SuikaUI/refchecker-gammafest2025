MIT Open Access Articles
Aligning Books and Movies: Towards Story-Like Visual
Explanations by Watching Movies and Reading Books
The MIT Faculty has made this article openly available. Please share
how this access benefits you. Your story matters.
Citation: Zhu, Yukun, et al. "Aligning Books and Movies: Towards Story-Like Visual Explanations
by Watching Movies and Reading Books." 2015 IEEE International Conference on Computer
Vision (ICCV), 7-13 December, 2015, Santiago, Chile, IEEE, 2015, pp. 19–27.
As Published: 
Publisher: Institute of Electrical and Electronics Engineers (IEEE)
Persistent URL: 
Version: Original manuscript: author's manuscript prior to formal peer review
Terms of use: Creative Commons Attribution-Noncommercial-Share Alike
Aligning Books and Movies: Towards Story-like Visual Explanations by
Watching Movies and Reading Books
Yukun Zhu ∗,1
Ryan Kiros*,1
Richard Zemel1
Ruslan Salakhutdinov1
Raquel Urtasun1
Antonio Torralba2
Sanja Fidler1
1University of Toronto
2Massachusetts Institute of Technology
{yukun,rkiros,zemel,rsalakhu,urtasun,fidler}@cs.toronto.edu, 
Books are a rich source of both ﬁne-grained information,
how a character, an object or a scene looks like, as well as
high-level semantics, what someone is thinking, feeling and
how these states evolve through a story. This paper aims to
align books to their movie releases in order to provide rich
descriptive explanations for visual content that go semantically far beyond the captions available in current datasets.
To align movies and books we exploit a neural sentence
embedding that is trained in an unsupervised way from a
large corpus of books, as well as a video-text neural embedding for computing similarities between movie clips and
sentences in the book. We propose a context-aware CNN
to combine information from multiple sources. We demonstrate good quantitative performance for movie/book alignment and show several qualitative examples that showcase
the diversity of tasks our model can be used for.
1. Introduction
A truly intelligent machine needs to not only parse the
surrounding 3D environment, but also understand why people take certain actions, what they will do next, what they
could possibly be thinking, and even try to empathize with
them. In this quest, language will play a crucial role in
grounding visual information to high-level semantic concepts. Only a few words in a sentence may convey really
rich semantic information. Language also represents a natural means of interaction between a naive user and our vision
algorithms, which is particularly important for applications
such as social robotics or assistive driving.
Combining images or videos with language has gotten
signiﬁcant attention in the past year, partly due to the creation of CoCo , Microsoft’s large-scale captioned image dataset. The ﬁeld has tackled a diverse set of tasks such
as captioning , alignment ,
Q&A , visual model learning from textual descriptions , and semantic visual search with natural multisentence queries .
∗Denotes equal contribution
Figure 1: Shot from the movie Gone Girl, along with the
subtitle, aligned with the book. We reason about the visual
and dialog (text) alignment between the movie and a book.
Books provide us with very rich, descriptive text that
conveys both ﬁne-grained visual details (how people or
scenes look like) as well as high-level semantics (what people think and feel, and how their states evolve through a
story). This source of knowledge, however, does not come
with associated visual information that would enable us
to ground it with descriptions. Grounding descriptions in
books to vision would allow us to get textual explanations
or stories behind visual information rather than simplistic
captions available in current datasets. It can also provide us
with extremely large amount of data (with tens of thousands
books available online).
In this paper, we exploit the fact that many books have
been turned into movies. Books and their movie releases
have a lot of common knowledge as well as they are complementary in many ways. For instance, books provide detailed descriptions about the intentions and mental states of
the characters, while movies are better at capturing visual
aspects of the settings.
The ﬁrst challenge we need to address, and the focus
of this paper, is to align books with their movie releases
in order to obtain rich descriptions for the visual content.
We aim to align the two sources with two types of information: visual, where the goal is to link a movie shot
to a book paragraph, and dialog, where we want to ﬁnd
correspondences between sentences in the movie’s subtitle
and sentences in the book. We formulate the problem of
movie/book alignment as ﬁnding correspondences between
shots in the movie as well as dialog sentences in the subtitles and sentences in the book (Fig. 1). We introduce a
novel sentence similarity measure based on a neural sen-
 
tence embedding trained on millions of sentences from a
large corpus of books. On the visual side, we extend the
neural image-sentence embeddings to the video domain and
train the model on DVS descriptions of movie clips. Our
approach combines different similarity measures and takes
into account contextual information contained in the nearby
shots and book sentences. Our ﬁnal alignment model is formulated as an energy minimization problem that encourages
the alignment to follow a similar timeline. To evaluate the
book-movie alignment model we collected a dataset with
11 movie/book pairs annotated with 2,070 shot-to-sentence
correspondences. We demonstrate good quantitative performance and show several qualitative examples that showcase
the diversity of tasks our model can be used for.
The alignment model can have multiple applications.
Imagine an app which allows the user to browse the book
as the scenes unroll in the movie: perhaps its ending or acting are ambiguous, and one would like to query the book
for answers. Vice-versa, while reading the book one might
want to switch from text to video, particularly for the juicy
scenes. We also show other applications of learning from
movies and books such as book retrieval (ﬁnding the book
that goes with a movie and ﬁnding other similar books), and
captioning CoCo images with story-like descriptions.
2. Related Work
Most effort in the domain of vision and language has
been devoted to the problem of image captioning. Older
work made use of ﬁxed visual representations and translated
them into textual descriptions .
Recently, several
approaches based on RNNs emerged, generating captions
via a learned joint image-text embedding .
These approaches have also been extended to generate descriptions of short video clips . In , the authors go
beyond describing what is happening in an image and provide explanations about why something is happening.
For text-to-image alignment, ﬁnd correspondences between nouns and pronouns in a caption and visual
objects using several visual and textual potentials. Lin et
al. does so for videos. In , the authors use RNN
embeddings to ﬁnd the correspondences.
 combines
neural embeddings with soft attention in order to align the
words to image regions.
Early work on movie-to-text alignment include dynamic
time warping for aligning movies to scripts with the help
of subtitles . Sankar et al. further developed a
system which identiﬁed sets of visual and audio features to
align movies and scripts without making use of the subtitles.
Such alignment has been exploited to provide weak labels
for person naming tasks .
Closest to our work is , which aligns plot synopses to
shots in the TV series for story-based content retrieval. This
work adopts a similarity function between sentences in plot
synopses and shots based on person identities and keywords
in subtitles. Our work differs with theirs in several important aspects. First, we tackle a more challenging problem of
movie/book alignment. Unlike plot synopsis, which closely
follow the storyline of movies, books are more verbose and
might vary in the storyline from their movie release. Furthermore, we use learned neural embeddings to compute the
similarities rather than hand-designed similarity functions.
Parallel to our work, aims to align scenes in movies
to chapters in the book. However, their approach operates
on a very coarse level (chapters), while ours does so on the
sentence/paragraph level. Their dataset thus evaluates on
90 scene-chapter correspondences, while our dataset draws
2,070 shot-to-sentences alignments. Furthermore, the approaches are inherently different.
 matches the presence of characters in a scene to those in a chapter, as well
as uses hand-crafted similarity measures between sentences
in the subtitles and dialogs in the books, similarly to .
Rohrbach et al. recently released the Movie Description dataset which contains clips from movies, each
time-stamped with a sentence from DVS (Descriptive Video
Service). The dataset contains clips from over a 100 movies,
and provides a great resource for the captioning techniques.
Our effort here is to align movies with books in order to obtain longer, richer and more high-level video descriptions.
We start by describing our new dataset, and then explain
our proposed approach.
3. The MovieBook and BookCorpus Datasets
We collected two large datasets, one for movie/book
alignment and one with a large number of books.
The MovieBook Dataset.
Since no prior work or data exist on the problem of movie/book alignment, we collected a
new dataset with 11 movies along with the books on which
they were based on. For each movie we also have a subtitle ﬁle, which we parse into a set of time-stamped sentences. Note that no speaker information is provided in the
subtitles. We automatically parse each book into sentences,
paragraphs (based on indentation in the book), and chapters
(we assume a chapter title has indentation, starts on a new
page, and does not end with an end symbol).
Our annotators had the movie and a book opened side
by side. They were asked to iterate between browsing the
book and watching a few shots/scenes of the movie, and
trying to ﬁnd correspondences between them. In particular,
they marked the exact time (in seconds) of correspondence
in the movie and the matching line number in the book ﬁle,
indicating the beginning of the matched sentence. On the
video side, we assume that the match spans across a shot (a
video unit with smooth camera motion). If the match was
longer in duration, the annotator also indicated the ending
time of the match. Similarly for the book, if more sentences
ANNOTATION
avg. # words
max # words
# paragraphs
# sent. in
Fight Club
No Country for Old Men
Harry Potter and the Sorcerers Stone
Shawshank Redemption
The Green Mile
American Psycho
One Flew Over the Cuckoo Nest
Brokeback Mountain
Table 1: Statistics for our MovieBook Dataset with ground-truth for alignment between books and their movie releases.
# of books
# of sentences
# of words
# of unique words
mean # of words per sentence
median # of words per sentence
74,004,228
984,846,357
Table 2: Summary statistics of our BookCorpus dataset. We use this corpus to train the sentence embedding model.
matched, the annotator indicated from which to which line a
match occurred. Each alignment was also tagged, indicating
whether it was a visual, dialogue, or an audio match. Note
that even for dialogs, the movie and book versions are semantically similar but not exactly the same. Thus deciding
on what deﬁnes a match or not is also somewhat subjective
and may slightly vary across our annotators. Altogether,
the annotators spent 90 hours labeling 11 movie/book pairs,
locating 2,070 correspondences.
Table 1 presents our dataset, while Fig. 8 shows a few
ground-truth alignments. One can see the complexity and
diversity of the data: the number of sentences per book vary
from 638 to 15,498, even though the movies are similar in
duration. This indicates a huge diversity in descriptiveness
across literature, and presents a challenge for matching. The
sentences also vary in length, with the sentences in Brokeback Mountain being twice as long as those in The Road.
The longest sentence in American Psycho has 422 words
and spans over a page in the book.
Aligning movies with books is challenging even for humans, mostly due to the scale of the data. Each movie is on
average 2h long and has 1,800 shots, while a book has on
average 7,750 sentences. Books also have different styles
of writing, formatting, different and challenging language,
slang (going vs goin’, or even was vs ’us), etc. As one can
see from Table 1, ﬁnding visual matches turned out to be
particularly challenging. This is because the visual descriptions in books can be either very short and hidden within
longer paragraphs or even within a longer sentence, or very
verbose – in which case they get obscured with the surrounding text – and are hard to spot. Of course, how close
the movie follows the book is also up to the director, which
can be seen through the number of alignments that our annotators found across different movie/books.
The BookCorpus Dataset.
In order to train our sentence
similarity model we collected a corpus of 11,038 books
from the web. These are free books written by yet unpublished authors. We only included books that had more than
20K words in order to ﬁlter out perhaps noisier shorter stories.
The dataset has books in 16 different genres, e.g.,
Romance (2,865 books), Fantasy (1,479), Science ﬁction
(786), Teen (430), etc.
Table 2 highlights the summary
statistics of our book corpus.
4. Aligning Books and Movies
Our approach aims to align a movie with a book by exploiting visual information as well as dialogs. We take shots
as video units and sentences from subtitles to represent dialogs. Our goal is to match these to the sentences in the
book. We propose several measures to compute similarities between pairs of sentences as well as shots and sentences. We use our novel deep neural embedding trained
on our large corpus of books to predict similarities between
sentences. Note that an extended version of the sentence
embedding is described in detail in showing how to
deal with million-word vocabularies, and demonstrating its
performance on a large variety of NLP benchmarks. For
comparing shots with sentences we extend the neural embedding of images and text to operate in the video domain. We next develop a novel contextual alignment model
that combines information from various similarity measures
and a larger time-scale in order to make better local alignment predictions. Finally, we propose a simple pairwise
Conditional Random Field (CRF) that smooths the alignments by encouraging them to follow a linear timeline, both
in the video and book domain.
We ﬁrst explain our sentence, followed by our joint video
to text embedding. We next propose our contextual model
that combines similarities and discuss CRF in more detail.
4.1. Skip-Thought Vectors
In order to score the similarity between two sentences,
we exploit our architecture for learning unsupervised representations of text . The model is loosely inspired by
Figure 2: Sentence neural embedding . Given a tuple (si−1, si, si+1) of consecutive sentences in text, where si is the
i-th sentence, we encode si and aim to reconstruct the previous si−1 and the following sentence si+1. Unattached arrows are
connected to the encoder output. Colors depict which components share parameters. ⟨eos⟩is the end of sentence token.
he started the car , left the parking lot and merged onto the highway a few miles down the road .
he shut the door and watched the taxi drive off .
he drove down the street off into the distance .
she watched the lights ﬂicker through the trees as the men drove toward the road .
he jogged down the stairs , through the small lobby , through the door and into the street .
a messy business to be sure , but necessary to achieve a ﬁne and noble end .
they saw their only goal as survival and logically planned a strategy to achieve it .
the most effective way to end the battle .
there would be far fewer casualties and far less destruction .
the outcome was the lisbon treaty .
Table 3: Qualitative results from the sentence embedding model. For each query sentence on the left, we retrieve the 4 nearest
neighbor sentences (by inner product) chosen from books the model has not seen before.
the skip-gram architecture for learning representations
of words. In the word skip-gram model, a word wi is chosen and must predict its surrounding context (e.g. wi+1 and
wi−1 for a context window of size 1). Our model works in
a similar way but at the sentence level. That is, given a sentence tuple (si−1, si, si+1) our model ﬁrst encodes the sentence si into a ﬁxed vector, then conditioned on this vector
tries to reconstruct the sentences si−1 and si+1, as shown
in Fig. 2. The motivation for this architecture is inspired
by the distributional hypothesis: sentences that have similar
surrounding context are likely to be both semantically and
syntactically similar. Thus, two sentences that have similar
syntax and semantics are likely to be encoded to a similar
vector. Once the model is trained, we can map any sentence
through the encoder to obtain vector representations, then
score their similarity through an inner product.
The learning signal of the model depends on having contiguous text, where sentences follow one another in sequence. A natural corpus for training our model is thus
a large collection of books. Given the size and diversity
of genres, our BookCorpus allows us to learn very general
representations of text. For instance, Table 3 illustrates the
nearest neighbours of query sentences, taken from held out
books that the model was not trained on. These qualitative
results demonstrate that our intuition is correct, with resulting nearest neighbors corresponds largely to syntactically
and semantically similar sentences. Note that the sentence
embedding is general and can be applied to other domains
not considered in this paper, which is explored in .
To construct an encoder, we use a recurrent neural network, inspired by the success of encoder-decoder models
for neural machine translation . Two kinds
of activation functions have recently gained traction: long
short-term memory (LSTM) and the gated recurrent unit
(GRU) . Both types of activation successfully solve the
vanishing gradient problem, through the use of gates to control the ﬂow of information. The LSTM unit explicity employs a cell that acts as a carousel with an identity weight.
The ﬂow of information through a cell is controlled by input, output and forget gates which control what goes into
a cell, what leaves a cell and whether to reset the contents
of the cell. The GRU does not use a cell but employs two
gates: an update and a reset gate. In a GRU, the hidden state
is a linear combination of the previous hidden state and the
proposed hidden state, where the combination weights are
controlled by the update gate. GRUs have been shown to
perform just as well as LSTM on several sequence prediction tasks while being simpler. Thus, we use GRU as the
activation function for our encoder and decoder RNNs.
(si−1, si, si+1), and let wt
i denote the t-th word for si
and let xt
i be its word embedding. We break the model
description into three parts:
the encoder, decoder and
objective function.
Encoder. Let w1
i , . . . , wN
i denote words in sentence si with
N the number of words in the sentence. The encoder produces a hidden state ht
i at each time step which forms the
representation of the sequence w1
i , . . . , wt
i. Thus, the hidden state hN
is the representation of the whole sentence.
The GRU produces the next hidden state as a linear combination of the previous hidden state and the proposed state
update (we drop subscript i):
ht = (1 −zt) ⊙ht−1 + zt ⊙¯ht
where ¯ht is the proposed state update at time t, zt is the update gate and (⊙) denotes a component-wise product. The
update gate takes values between zero and one. In the extreme cases, if the update gate is the vector of ones, the
previous hidden state is completely forgotten and ht = ¯ht.
Alternatively, if the update gate is the zero vector, than the
hidden state from the previous time step is simply copied
over, that is ht = ht−1. The update gate is computed as
zt = σ(Wzxt + Uzht−1)
where Wz and Uz are the update gate parameters. The
proposed state update is given by
¯ht = tanh(Wxt + U(rt ⊙ht−1))
where rt is the reset gate, which is computed as
rt = σ(Wrxt + Urht−1)
If the reset gate is the zero vector, than the proposed state
update is computed only as a function of the current word.
Thus after iterating this equation sequence for each word,
we obtain a sentence vector hN
i = hi for sentence si.
Decoder. The decoder computation is analogous to the encoder, except that the computation is conditioned on the
sentence vector hi. Two separate decoders are used, one
for the previous sentence si−1 and one for the next sentence
si+1. These decoders use different parameters to compute
their hidden states but both share the same vocabulary matrix V that takes a hidden state and computes a distribution
over words. Thus, the decoders are analogous to an RNN
language model but conditioned on the encoder sequence.
Alternatively, in the context of image caption generation,
the encoded sentence hi plays a similar role as the image.
We describe the decoder for the next sentence si+1 (computation for si−1 is identical). Let ht
i+1 denote the hidden
state of the decoder at time t. The update and reset gates for
the decoder are given as follows (we drop i + 1):
zxt−1 + Ud
zht−1 + Czhi)
rxt−1 + Ud
rht−1 + Crhi)
the hidden state ht
i+1 is then computed as:
¯ht = tanh(Wdxt−1 + Ud(rt ⊙ht−1) + Chi) (7)
i+1 = (1 −zt) ⊙ht−1 + zt ⊙¯ht
i+1, the probability of word wt
i+1 given the previous t −1 words and the encoder vector is
i+1, hi) ∝exp(vwt
i+1 denotes the row of V corresponding to the
word of wt
i+1. An analogous computation is performed for
the previous sentence si−1.
Objective. Given (si−1, si, si+1), the objective optimized
is the sum of log-probabilities for the next and previous sentences conditioned on the representation of the encoder:
i+1, hi) +
The total objective is the above summed over all such training tuples. Adam algorithm is used for optimization.
4.2. Visual-semantic embeddings of clips and DVS
The model above describes how to obtain a similarity
score between two sentences, whose representations are
learned from millions of sentences in books. We now discuss how to obtain similarities between shots and sentences.
Our approach closely follows the image-sentence ranking model proposed by . In their model, an LSTM is
used for encoding a sentence into a ﬁxed vector. A linear
mapping is applied to image features from a convolutional
network. A score is computed based on the inner product
between the normalized sentence and image vectors. Correct image-sentence pairs are trained to have high score,
while incorrect pairs are assigned low scores.
In our case, we learn a visual-semantic embedding between movie clips and their DVS description. DVS (“Descriptive Video Service”) is a service that inserts audio descriptions of the movie between the dialogs in order to enable the visually impaired to follow the movie like anyone
We used the movie description dataset of for
learning our embedding. This dataset has 94 movies, and
54,000 described clips. We represent each movie clip as a
vector corresponding to mean-pooled features across each
frame in the clip. We used the GoogLeNet architecture 
as well as hybrid-CNN for extracting frame features.
For DVS, we pre-processed the descriptions by removing
names and replacing these with a someone token.
The LSTM architecture in this work is implemented using the following equations. As before, we represent a word
embedding at time t of a sentence as xt:
σ(Wxixt + Whimt−1 + Wcict−1)
σ(Wxfxt + Whfmt−1 + Wcfct−1) (12)
tanh(Wxcxt + Whcmt−1)
f t ⊙ct−1 + it ⊙at
σ(Wxoxt + Whomt−1 + Wcoct)
ot ⊙tanh(ct)
where (σ) denotes the sigmoid activation function and
(⊙) indicates component-wise multiplication.
The states
(it, f t, ct, ot, mt) correspond to the input, forget, cell, output and memory vectors, respectively. If the sentence is of
length N, then the vector mN = m is the vector representation of the sentence.
Let q denote a movie clip vector, and let v = WIq
be the embedding of the movie clip. We deﬁne a scoring
function s(m, v) = m · v, where m and v are ﬁrst scaled
to have unit norm (making s equivalent to cosine similarity).
We then optimize the following pairwise ranking loss:
max{0, α −s(m, v) + s(m, vk)}
max{0, α −s(v, m) + s(v, mk)},
with mk a contrastive (non-descriptive) sentence vector for
a clip embedding v, and vice-versa with vk. We train our
model with stochastic gradient descent without momentum.
4.3. Context aware similarity
We employ the clip-sentence embedding to compute
similarities between each shot in the movie and each sentence in the book. For dialogs, we use several similarity
measures each capturing a different level of semantic similarity. We compute BLEU between each subtitle and
book sentence to identify nearly identical matches. Similarly to , we use a tf-idf measure to ﬁnd near duplicates
but weighing down the inﬂuence of the less frequent words.
Finally, we use our sentence embedding learned from books
to score pairs of sentences that are semantically similar but
may have a very different wording (i.e., paraphrasing).
These similarity measures indicate the alignment between the two modalities. However, at the local, sentence
level, alignment can be rather ambiguous. For example, despite being a rather dark book, Gone Girl contains 15 occurrences of the sentence “I love you”. We exploit the fact that
a match is not completely isolated but that the sentences (or
shots) around it are also to some extent similar.
We design a context aware similarity measure that takes
into account all individual similarity measures as well as
a ﬁxed context window in both, the movie and book domain, and predicts a new similarity score. We stack a set
of M similarity measures into a tensor S(i, j, m), where i,
j, and m are the indices of sentences in the subtitle, in the
book, and individual similarity measures, respectively. In
particular, we use M = 9 similarities: visual and sentence
embedding, BLEU1-5, tf-idf, and a uniform prior. We want
to predict a combined score score(i, j) = f(S(I, J, M))
at each location (i, j) based on all measurements in a ﬁxed
volume deﬁned by I around i, J around j, and 1, . . . , M.
Evaluating the function f(·) at each location (i, j) on a 3-D
tensor S is very similar to applying a convolution using a
kernel of appropriate size. This motivates us to formulate
the function f(·) as a deep convolutional neural network
(CNN). In this paper, we adopt a 3-layer CNN as illustrated
in Figure 3. We adopt the ReLU non-linearity with dropout
to regularize our model. We optimize the cross-entropy loss
over the training set using Adam algorithm.
4.4. Global Movie/Book Alignment
So far, each shot/sentence was matched independently.
However, most shots in movies and passages in the books
follow a similar timeline. We would like to incorporate this
prior into our alignment. In , the authors use dynamic
time warping by enforcing that the shots in the movie can
only match forward in time (to plot synopses in their case).
However, the storyline of the movie and book can have
crossings in time (Fig. 8), and the alignment might contain
Figure 3: Our CNN for context-aware similarity computation. It has 3 conv. layers and a sigmoid layer on top.
giant leaps forwards or backwards. Therefore, we formulate a movie/book alignment problem as inference in a Conditional Random Field that encourages nearby shots/dialog
alignments to be consistent. Each node yi in our CRF represents an alignment of the shot in the movie with its corresponding subtitle sentence to a sentence in the book. Its
state space is thus the set of all sentences in the book. The
CRF energy of a conﬁguration y is formulated as:
−log p(x,y; ω) =
ωuφu(yi) +
ωpψp(yi, yj)
where K is the number of nodes (shots), and N(i) the left
and right neighbor of yi. Here, φu(·) and ψp(·) are unary
and pairwise potentials, respectively, and ω = (ωu, ωp). We
directly use the output of the CNN from 4.3 as the unary
potential φu(·). For the pairwise potential, we measure the
time span ds(yi, yj) between two neighbouring sentences in
the subtitle and the distance db(yi, yj) of their state space in
the book. One pairwise potential is deﬁned as:
ψp(yi, yj) =
(ds(yi, yj) −db(yi, yj))2
(ds(yi, yj) −db(yi, yj))2 + σ2
Here σ2 is a robustness parameter to avoid punishing giant leaps too harsh.
Both ds and db are normalized to
 . In addition, we also employ another pairwise potential ψq(yi, yj) =
(db(yi,yj))2
(db(yi,yj))2+σ2 to encourage state consistency between nearby nodes. This potential is helpful when
there is a long silence (no dialog) in the movie.
Inference.
Our CRF is a chain, thus exact inference is
possible using dynamic programming. We also prune some
states that are very far from the uniform alignment (over
1/3 length of the book) to further speed up computation.
Since ground-truth is only available for a
sparse set of shots, we regard the states of unobserved nodes
as hidden variables and learn the CRF weights with .
5. Experimental Evaluation
We evaluate our model on our dataset of 11 movie/book
pairs. We train the parameters in our model (CNN and CRF)
on Gone Girl, and test our performance on the remaining
10 movies. In terms of training speed, our video-text model
“watches” 1,440 movies per day and our sentence model
reads 870 books per day. We also show various qualitative
results demonstrating the power of our approach. We provide more results in the Appendix of the paper.
5.1. Movie/Book Alignment
Evaluating the performance of movie/book alignment is
an interesting problem on its own.
This is because our
ground-truth is far from exhaustive – around 200 correspondences were typically found between a movie and its book,
and likely a number of them got missed. Thus, evaluating
the precision is rather tricky. We thus focus our evaluation
on recall, similar to existing work on retrieval. For each shot
that has a GT correspondence in book, we check whether
our prediction is close to the annotated one. We evaluate
recall at the paragraph level, i.e., we say that the GT paragraph was recalled, if our match was at most 3 paragraphs
away, and the shot was at most 5 subtitle sentences away.
As a noisier measure, we also compute recall and precision
at multiple alignment thresholds and report AP (avg. prec.).
The results are presented in Table 4. Columns show different instantiations of our model: we show the leave-onefeature-out setting (∅indicates that all features were used),
compare how different depths of the context-aware CNN in-
ﬂuence the performance, and compare it to our full model
(CRF) in the last column.
We get the highest boost by
adding more layers to the CNN – recall improves by 14%,
and AP doubles. Generally, each feature helps performance.
Our sentence embedding (BOOK) helps by 4%, while noisier video-text embedding helps by 2% in recall. CRF which
encourages temporal smoothness generally helps (but not
for all movies), bringing additional 2%. We also show how
a uniform timeline performs on its own. That is, for each
shot (measured in seconds) in the movie, we ﬁnd the sentence at the same location (measured in lines) in the book.
We add another baseline to evaluate the role of context
in our model. Instead of using our CNN that considers contextual information, we build a linear SVM to combine different similarity measures in a single node (shot) – the ﬁnal
similarity is used as a unary potential in our CRF alignment
model. The Table shows that our CNN contextual model
outperforms the SVM baseline by 30% in recall, and doubles the AP. We plot alignment for a few movies in Fig. 8.
Running Times.
We show the typical running time of
each component in our model in Table 5. For each moviebook pair, calculating BLEU score takes most of the time.
Note that BLEU does not contribute signiﬁcantly to the performance and is of optional use. With respect to the rest,
extracting visual features VIS (mean pooling GoogleNet
features over the shot frames) and SCENE features (mean
pooling hybrid-CNN features over the shot frames),
Fight Club
No Country ...
One Flew...
American Psy.
Shawshank ...
Fight Club
Green Mile
One Flew...
American Psy.
Shawshank ...
No Country ...
Green Mile
Harry Potter
Brokeback ...
American Psy.
One Flew...
Shawshank ...
Harry Potter
American Psy.o
One Flew...
Fight Club
Shawshank ...
No Country ...
Brokeback ...
American Psy.
One Flew...
Harry Potter
Shawshank ...
Brokeback ...
No Country ...
One Flew...
Shawshank ...
No Country ...
One Flew...
Brokeback ...
Green Mile
Shawshank ...
Shawshank ...
Fight Club
Brokeback ...
One Flew...
American Psy.
Harry Potter
Brokeback ...
One Flew...
Fight Club
American Psy.
Green Mile
Shawshank ...
Brokeback ...
One Flew...
No Country ...
Fight Club
Shawshank ...
Green Mile
No Country ...
Brokeback ...
One Flew...
Shawshank ...
Harry Potter
No Country...
Table 6: Book “retrieval”. For a movie (left), we rank
books wrt to their alignment similarity with the movie. We
normalize similarity to be 100 for the highest scoring book.
takes most of the time (about 80% of the total time).
We also report training times for our contextual model
(CNN) and the CRF alignment model. Note that the times
are reported for one movie/book pair since we used only
one such pair to train all our CNN and CRF parameters. We
chose Gone Girl for training since it had the best balance
between the dialog and visual correspondences.
5.2. Describing Movies via the Book
We next show qualitative results of our alignment. In
particular, we run our model on each movie/book pair, and
visualize the passage in the book that a particular shot in
the movie aligns to. We show best matching paragraphs as
well as a paragraph before and after. The results are shown
in Fig. 8. One can see that our model is able to retrieve a
semantically meaningful match despite large dialog deviations from those in the book, and the challenge of matching
a visual representation to the verbose text in the book.
Figure 4: Describing movie clips via the book: we align the movie to the book, and show a shot from the movie and its
corresponding paragraph (plus one before and after) from the book.
Figure 5: We can use our model to caption movies via a corpus of books. Top: A shot from American Pyscho is captioned
with paragraphs from the Fight Club, and a shot from Harry Potter with paragraphs from Fight Club. Middle and Bottom:
We match shots from Avatar and Batman Begins against 300 books from our BookCorpus, and show the best matched
paragraph.
1 layer CNN w/o one feature
Fight Club
The Green Mile
Harry Potter and the
Sorcerers Stone
American Psycho
One Flew Over the
Cuckoo Nest
Redemption
Brokeback Mountain
No Country for Old
Mean Recall
Table 4: Performance of our model for the movies in our dataset under different settings and metrics.
CNN (training)
CNN (inference)
CRF (training)
CRF (inference)
Per movie-book pair
Table 5: Running time for our model per one movie/book pair.
5.3. Book “Retrieval”
In this experiment, we compute alignment between a
movie and all (test) 10 books, and check whether our model
retrieves the correct book. Results are shown in Table 6.
Under each book we show the computed similarity. In particular, we use the energy from the CRF, and scale all similarities relative to the highest one (100). Notice that our
model retrieves the correct book for each movie.
Describing a movie via other books. We can also caption movies by matching shots to paragraphs in a corpus of
books. Here we do not encourage a linear timeline (CRF)
since the stories are unrelated, and we only match at the local, shot-paragraph level. We show a description for American Psycho borrowed from the book Fight Club in Fig. 5.
5.4. The CoCoBook: Writing Stories for CoCo
Our next experiment shows that our model is able to
“generate” descriptive stories for (static) images. In particular we used the image-text embedding from and
generated a simple caption for an image. We used this caption as a query, and used our sentence embedding trained on
books to ﬁnd top 10 nearest sentences (sampled from a few
hundred thousand from BookCorpus). We re-ranked these
based on the 1-gram precision of non-stop words. Given the
best result, we return the sentence as well as the 2 sentences
before and after it in the book. The results are in Fig. 6. Our
sentence embedding is able to retrieve semantically meaningful stories to explain the images.
6. Conclusion
In this paper, we explored a new problem of aligning
a book to its movie release.
We proposed an approach
that computes several similarities between shots and dialogs and the sentences in the book. We exploited our new
sentence embedding in order to compute similarities between sentences. We further extended the image-text neural
embeddings to video, and proposed a context-aware alignment model that takes into account all the available similarity information. We showed results on a new dataset of
movie/book alignments as well as several quantitative results that showcase the power and potential of our approach.
Acknowledgments
We acknowledge the support from NSERC, CIFAR, Samsung,
Google, and ONR-N00014-14-1-0232. We also thank Lea Jensterle for helping us with elaborate annotation, and Relu Patrascu
for his help with numerous infrastructure related problems.
In the Appendix we provide more qualitative results.
A. Qualitative Movie-Book Alignment Results
We show a few qualitative examples of alignment in
Fig. 8. In this experiment, we show results obtained with
our full model (CRF). For a chosen shot (a node in the CRF)
we show the corresponding paragraph in the book.
the club was a little emptier than i would have expected for
the late afternoon , and the bartender , in red waistcoat and
bowtie , was busy wiping down his counter , replacing peanuts
and putting out new coasters . a television with the latest la liga
news was hung in an upper corner , and behind him , rows of
bottles were reﬂected in a giant bar mirror . above the stools
, a pergola-type overhead structure held rows of wine glasses
. it was a classy place , with ferns in the corner , and not the
kind of bar to which i was accustomed . my places usually had
a more ... relaxed feel .
he felt like an idiot for yelling at the child , but his
frustration and trepidation was getting the better
of him . he glanced toward the shadowed hall and
quickly nodded toward melissa before making his
way forward . he came across more children sitting
upon a couch in the living room . they watched him ,
but did n’t move and did n’t speak . his skin started to
feel like hundreds of tiny spiders were running up and
down it and he hurried on .
a few miles before tioga road reached highway 395
and the town of lee vining , smith turned onto a
narrow blacktop road . on either side were parched ,
grassy open slopes with barbed-wire fences marking
property lines . cattle and horses grazed under trees
whose black silhouettes stood stark against the
gold-velvet mountains .
marty burst into song : “
home , home on the range , where the deer and the
antelope play ! where seldom is heard a discouraging
word and the skies are not cloudy all day ! ”
“number seventy-three , second to last from the corner .
adam slowed the porsche as he approached the quaint-he could
think of no other word to use , even though “quaint” was one
he normally , manfully , avoided-townhouse , coming to a halt
beside a sleek jaguar sedan . it was a quiet street , devoid of
trafﬁc at this hour on a monday night . in the bluish-tinted light
of a corner street lamp , he developed a quick visual impression
of wrought-iron railings on tidy front stoops , window boxes
full of bright chrysanthemums , beveled glass in bay windows ,
and lace curtains . townhouses around here didn’t rent cheaply ,
he could n’t help but observe .
Figure 6: CoCoBook: We generate a caption for a CoCo image via and retrieve its best matched sentence (+ 2 before
and after) from a large book corpus. One can see a semantic relevance of the retrieved passage to the image.
Figure 7: Alignment results of our model (bottom) compared to ground-truth alignment (top). In ground-truth, blue lines
indicate visual matches, and magenta are the dialog matches. Yellow lines indicate predicted alignments.
We can see that some dialogs in the movies closely follow the book and thus help with the alignment. This is
particularly important since the visual information is not as
strong. Since the text around the dialogs typically describe
the scene, the dialogs thus help us ground the visual information contained in the description and the video.
B. Borrowing “Lines” from Other Books
We show a few qualitative examples of top-scoring
matches for shot in a movie with a paragraph in another
book (a book that does not correspond to this movie).
10 book experiment. In this experiment, we allow a
clip in our 10 movie dataset (excluding the training movie)
to match to paragraphs in the remaining 9 books (excluding
the corresponding book). The results are in Fig. 12. Note
that the top-scoring matches chosen from only a small set
of books may not be too meaningful.
200 book experiment. We scale the experiment by randomly selecting 200 books from our BookCorpus. The results are in Fig. 15. One can see that by using many more
books results in increasingly better “stories”.
American Psycho
American Psycho
Harry Potter
Figure 8: Examples of movie-book alignment. We use our model to align a movie to a book. Then for a chosen shot (which
is a node in our CRF) we show the corresponding paragraph, plus one before and one after, in the book inferred by our model.
On the left we show one (central) frame from the shot along with the subtitle sentence(s) that overlap with the shot. Some
dialogs in the movie closely follow the book and thus help with the alignment.
One Flew Over the Cuckoo’s Nest
One Flew Over the Cuckoo’s Nest
Shawshank Redemption
Figure 9: Examples of movie-book alignment. We use our model to align a movie to a book. Then for a chosen shot (which
is a node in our CRF) we show the corresponding paragraph, plus one before and one after, in the book inferred by our model.
On the left we show one (central) frame from the shot along with the subtitle sentence(s) that overlap with the shot. Some
dialogs in the movie closely follow the book and thus help with the alignment.
Figure 10: Examples of movie-book alignment. We use our model to align a movie to a book. Then for a chosen shot
(which is a node in our CRF) we show the corresponding paragraph, plus one before and one after, in the book inferred by
our model. On the left we show one (central) frame from the shot along with the subtitle sentence(s) that overlap with the
shot. Some dialogs in the movie closely follow the book and thus help with the alignment.
The Green Mile
The Green Mile
Figure 11: Examples of movie-book alignment. We use our model to align a movie to a book. Then for a chosen shot
(which is a node in our CRF) we show the corresponding paragraph, plus one before and one after, in the book inferred by
our model. On the left we show one (central) frame from the shot along with the subtitle sentence(s) that overlap with the
shot. Some dialogs in the movie closely follow the book and thus help with the alignment.
Figure 12: Examples of of borrowing paragraphs from other books – 10 book experiment. We show a few examples
of top-scoring correspondences between a shot in a movie and a paragraph in a book that does not correspond to the movie.
Note that by forcing the model to choose from another book, the top-scoring correspondences may still have a relatively low
similarity. In this experiment, we did not enforce a global alignment over the full book – we use the similarity output by our
contextual CNN.
Figure 13: Examples of of borrowing paragraphs from other books – 10 book experiment. We show a few examples
of top-scoring correspondences between a shot in a movie and a paragraph in a book that does not correspond to the movie.
Note that by forcing the model to choose from another book, the top-scoring correspondences may still have a relatively low
similarity. In this experiment, we did not enforce a global alignment over the full book – we use the similarity output by our
contextual CNN.
Figure 14: Examples of of borrowing paragraphs from other books – 200 book experiment. We show a few examples of
top-scoring correspondences between a shot in a movie and a paragraph in a book that does not correspond to the movie. By
scaling up the experiment (more books to choose from), our model gets increasingly more relevant “stories”.
Figure 15: Examples of of borrowing paragraphs from other books – 200 book experiment. We show a few examples of
top-scoring correspondences between a shot in a movie and a paragraph in a book that does not correspond to the movie. By
scaling up the experiment (more books to choose from), our model gets increasingly more relevant “stories”. Bottom row:
failed example.
C. The CoCoBook
We show more results for captioning CoCo images with passages from the books.
“ somewhere you ’ll never ﬁnd it , ” owens sneered . if never
meant ﬁve seconds , his claim was true . the little shit ’s gaze
cut left , where a laptop sat on a coffee table . trey strode to it .
owens ’ email program was open .
seriously . its like a train crashing into another train . a train
wreck . just something like that . i try to convince her .
everyone was allowed to rest for the next twenty-four hours . that
following evening : the elect , not their entourages , were called
to a dining hall for supper with lady dolorous . a table that curved
inward was laden with food and drink . the wall behind the table
was windows with a view of the planet . girls in pink stood about
and at attention .
he had simply ... healed . brian watched his fellow passengers come aboard .
a young woman with blonde hair was walking with a little girl in dark glasses
. the little girl ’s hand was on the blonde ’s elbow . the woman murmured to
her charge , the girl looked immediately toward the sound of her voice , and
brian understood she was blind - it was something in the gesture of the head .
this was a beautiful miniature reproduction of a real london town house , and when
jessamine touched it , tessa saw that the front of it swung open on tiny hinges . tessa
caught her breath . there were beautiful tiny rooms perfectly decorated with miniature
furniture , everything built to scale , from the little wooden chairs with needlepoint
cushions to the cast-iron stove in the kitchen . there were small dolls , too , with china
heads , and real little oil paintings on the walls . “ this was my house . ”
if he had been nearby he would have dragged her out of the room
by her hair and strangled her . during lunch break she went with a
group back to the encampment . out of view of the house , under
a stand of towering trees , several tents were sitting in a ﬁeld of
mud . the rain the night before had washed the world , but here it
had made a mess of things . a few women ﬁred up a camp stove
and put on rice and lentils .
then a frightened yell . “ hang on ! ” suddenly , jake was ﬂying
through the air . nefertiti became airborne , too . he screamed ,
not knowing what was happening-then he splashed into a pool of
grabbing his wristwatch off the bedside table he checked the time
, grimacing when he saw that it was just after two in the afternoon
. jeanne louise should n’t be up yet . stiﬂing a yawn , he slid out
of bed and made his way to the en suite bathroom for a shower
. twenty minutes later paul was showered , dressed , and had
brushed his teeth and hair . feeling somewhat alive now , he
made his way out of his and jeanne louise ’s room , pausing to
look in on livy as he passed .
she cried . quentin put a heavy , warm , calming hand on her
thigh , saying , “ he should be sober by then . ” a cell phone rang
. he pulled his from his back pocket , glanced at it , then used the
remote to turn the tv to the channel that showed the feed from the
camera at the security gate . “ oh , it ’s rachel . ”
now however she was out of his shot . he had missed it completely until he had
ended up on the ground with his shotgun . an old clock hung on the wall near the
door . the was obviously broken , the small red hand ticking the same second away
over and over again . morgan squeezed the trigger and pellets ripped out of their
package , bounced down the barrel , ﬂew through the air and ripped into the old
clock tearing it in two before it smashed to the ground .
a man sat in a chair , facing the wall opposite of me . it nearly
startled me when i ﬁrst saw him , and made a bit of a squeak , but
he did nothing . he had dark gray hair , a black suit and pants ,
and a gray and blue striped tie . s-sir ? i said .
its been years since we last played together , but as i recall , he
was rather weak at the net . or was it his serving ? all i know
is he plays tennis much better than he plays cricket . perhaps
, mr brearly , frances eventually replied , we should wait until
we actually start playing . then we can ascertain our oppositions
faults , and make a plan based on the new information .
since it was the middle of summer , there were candles in the
ﬁreplace instead of a ﬁre . but it still cast a romantic glow over
the room . there were candles on the mantle and on a table set
up in the corner with ﬂowers . as she looked around , her eyes
instinctively turned to ﬁnd max who was behind a bar opening a
bottle of champagne . the doors were closed quietly behind her
and her mouth felt dry as she looked across the room at the man
who had haunted her dreams for so long .
the open doorway of another house provided a view of an ancient
game of tiles . it wasnt the game that held reddings attention
. it was the four elderly people who sat around a table playing
the game . they were well beyond their productive years and the
canal township had probably been their whole lives . redding and
lin ming stepped away from the doorway right into the path of a
wooden pushcart .
along with the ﬁsh , howard had given them some other picnic
treats that had spoiled ... mushrooms in cream sauce , rotted
greens . the bats and temp were only eating from the river now ,
but the remaining picnic food was running low . there were a few
loaves of stale bread , some cheese , some dried vegetables , and
a couple of cakes . gregor looked over the supplies and thought
about boots wailing for food and water in the jungle . it had been
unbearable .
he felt the ﬁrst stirrings of fear mixing with his anger . a light
ﬂicked on in the room and eric jerked , blinking for a minute
at the brightness before the images focused . there was a tall
, thin man standing over a mannequin . he looked like he was
assembling it , since its leg was on the ground next to the man
and its arm was in two pieces farther away . then the mannequin
’s head turned .