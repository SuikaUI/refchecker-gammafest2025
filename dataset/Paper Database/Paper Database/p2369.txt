LiteFlowNet: A Lightweight Convolutional Neural Network
for Optical Flow Estimation
Tak-Wai Hui, Xiaoou Tang, Chen Change Loy
CUHK-SenseTime Joint Lab, The Chinese University of Hong Kong
{twhui,xtang,ccloy}@ie.cuhk.edu.hk
FlowNet2 , the state-of-the-art convolutional neural
network (CNN) for optical ﬂow estimation, requires over
160M parameters to achieve accurate ﬂow estimation. In
this paper we present an alternative network that outperforms FlowNet2 on the challenging Sintel ﬁnal pass and
KITTI benchmarks, while being 30 times smaller in the
model size and 1.36 times faster in the running speed. This
is made possible by drilling down to architectural details
that might have been missed in the current frameworks: (1)
We present a more effective ﬂow inference approach at each
pyramid level through a lightweight cascaded network. It
not only improves ﬂow estimation accuracy through early
correction, but also permits seamless incorporation of descriptor matching in our network. (2) We present a novel
ﬂow regularization layer to ameliorate the issue of outliers
and vague ﬂow boundaries by using a feature-driven local convolution. (3) Our network owns an effective structure for pyramidal feature extraction and embraces feature warping rather than image warping as practiced in
FlowNet2. Our code and trained models are available at
 
1. Introduction
Optical ﬂow estimation is a long-standing problem in
computer vision. Due to the well-known aperture problem,
optical ﬂow is not directly measurable . Hence, the
estimation is typically solved by energy minimization in a
coarse-to-ﬁne framework . This class
of techniques, however, involves complex energy optimization and thus it is not scalable for applications that demand
real-time estimation.
FlowNet and its successor FlowNet2 , have
marked a milestone by using CNN for optical ﬂow estimation. Their accuracies especially the successor are approaching that of state-of-the-art energy minimization approaches, while the speed is several orders of magnitude
Feature warping
Feature warping
Cascaded inference
Feature warping
Cascaded inference
Flow regularization
Figure 1: Examples demonstrate the effectiveness of the proposed
components in LiteFlowNet for i) feature warping, ii) cascaded
ﬂow inference, and iii) ﬂow regularization. Enabled components
are indicated with bold black fonts.
faster. To push the envelop of accuracy, FlowNet2 is designed as a cascade of variants of FlowNet that each network in the cascade reﬁnes the preceding ﬂow ﬁeld by contributing on the ﬂow increment between the ﬁrst image and
the warped second image. The model, as a result, comprises over 160M parameters, which could be formidable in
many applications. A recent network termed SPyNet 
attempts a network with smaller size of 1.2M parameters
by adopting image warping in each pyramid level. Nonetheless, the accuracy can only match that of FlowNet but not
FlowNet2. The objective of this study is to explore alternative CNN architectures for accurate ﬂow estimation yet
with high efﬁciency. Our work is inspired by the successes
of FlowNet2 and SPyNet, but we further drill down the key
elements to fully unleash the potential of deep convolutional
network combined with classical principles.
There are two general principles to improve the design
of FlowNet2 and SPyNet. The ﬁrst principle is pyramidal feature extraction. The proposed network, dubbed Lite-
FlowNet, consists of an encoder and a decoder. The encoder
maps the given image pair, respectively, into two pyramids
 
of multi-scale high-dimensional features. The decoder then
estimates the ﬂow ﬁeld in a coarse-to-ﬁne framework. At
each pyramid level, the decoder infers the ﬂow ﬁeld by selecting and using the features of the same resolution from
the feature pyramids. This design leads to a lighter network
compared to FlowNet2 that adopts U-Net architecture 
for ﬂow inference. In comparison to SPyNet, our network
separates the process of feature extraction and ﬂow estimation. This helps us to better pinpoint the bottleneck of accuracy and model size.
The second general principle is feature warping.
FlowNet2 and SPyNet warp the second image towards the
ﬁrst image in the pair using the previous ﬂow estimate, and
then reﬁne the estimate using the feature maps generated by
the warped and the ﬁrst images. Warping an image and then
generating the feature maps of the warped image are two
ordered steps. We ﬁnd that the two steps can be reduced to
a single one by directly warping the feature maps of the second image, which have been computed by the encoder. This
one-step feature warping process reduces the more discriminative feature-space distance instead of the RGB-space distance between the two images. This makes our network
more powerful and efﬁcient in addressing the ﬂow problem.
We now highlight the more speciﬁc differences between
our network and existing CNN-based optical ﬂow estimation frameworks:
1) Cascaded ﬂow inference – At each pyramid level, we introduce a novel cascade of two lightweight networks. Each
of them has a feature warping (f-warp) layer to displace
the feature maps of the second image towards the ﬁrst image using the ﬂow estimate from the previous level. Flow
residue is computed to further reduce the feature-space distance between the images. This design is advantageous to
the conventional design of using a single network for ﬂow
inference. First, the cascade progressively improves ﬂow
accuracy thus allowing an early correction of the estimate
without passing more errors to the next level. Second, this
design allows seamless integration with descriptor matching. We assign a matching network to the ﬁrst inference.
Consequently, pixel-accuracy ﬂow ﬁeld can be generated
ﬁrst and then reﬁned to sub-pixel accuracy in the subsequent inference network. Since at each pyramid level the
feature-space distance between the images has been reduced
by feature warping, we can use a rather short displacement than to establish the cost volume. Besides,
matching is performed only at sampled positions and thus a
sparse cost-volume is aggregated. This effectively reduces
the computational burden raised by the explicit matching.
2) Flow regularization – The cascaded ﬂow inference resembles the role of data ﬁdelity in energy minimization
methods. Using data term alone, vague ﬂow boundaries
and undesired artifacts exist in ﬂow ﬁelds. To tackle this
problem, local ﬂow consistency and co-occurrence between
ﬂow boundaries and intensity edges are commonly used as
the cues to regularize ﬂow ﬁeld. Some of the representative
methods include anisotropic image-driven , image- and
ﬂow-driven , and complementary regularizations.
After cascaded ﬂow inference, we allow the ﬂow ﬁeld to be
further regularized by our novel feature-driven local convolution (f-lconv) layer1 at each pyramid level. The kernels of
such a local convolution are adaptive to the pyramidal features from the encoder, ﬂow estimate and occlusion probability map. This makes the ﬂow regularization to be both
ﬂow- and image-aware. To our best knowledge, state-ofthe-art CNNs do not explore such a ﬂow regularization.
The effectiveness of the aforementioned contributions
are depicted in Figure 1. In summary, we propose a compact
LiteFlowNet to estimate optical ﬂow. Our network innovates the useful elements from conventional methods. e.g.,
brightness constraint in data ﬁdelity to pyramidal CNN features and image warping to CNN feature warping. More
speciﬁcally, we present a cascaded ﬂow inference with feature warping and ﬂow regularization in each pyramid level,
which are new in the literature. Overall, our network outperforms FlowNet and SPyNet and is on par with
or outperforms the recent FlowNet2 on public benchmarks, while having 30 times fewer parameters and being
1.36 times faster than FlowNet2.
2. Related Work
Here, we brieﬂy review some of the major approaches
for optical ﬂow estimation.
Variational methods. Since the pioneering work by Horn
and Schunck , variational methods have dominated optical ﬂow estimation.
Brox et al. address illumination
changes by combining the brightness and gradient constancy assumptions . Brox et al. integrate rich descriptors
into variational formulation . In DeepFlow , Weinzaepfel et al. propose to correlate multi-scale patches and incorporate this as the matching term in functional. In Patch-
Match Filter , Lu et al. establish dense correspondence
using the superpixel-based PatchMatch . Revaud et al.
propose a method EpicFlow that uses externally matched
ﬂows as initialization and then performs interpolation .
Zimmer et al. design the complementary regularization that
exploits directional information from the constraints imposed in data term . Our network that infers optical
ﬂow and performs ﬂow regularization is inspired by the use
of data ﬁdelity and regularization in variational methods.
Machine learning methods. Black et al. propose to represent complex image motion as a linear combination of the
learned basis vectors . Roth et al. formulates the prior
1We name it as feature-driven local convolution (f-lconv) layer in order
to distinguish it from local convolution (lconv) layer of which ﬁlter weights
are locally ﬁxed in conventional CNNs .
probability of ﬂow ﬁeld as Field-of-Experts model that
captures higher order spatial statistics . Sun et al. study
the probabilistic model of brightness inconstancy in a highorder random ﬁeld framework .
Nir et al. represent
image motion using the over-parameterization model .
Rosenbaum et al. model the local statistics of optical ﬂow
using Gaussian mixtures .
Given a set of sparse
matches, Wulff et al. propose to regress them to a dense
ﬂow ﬁeld using a set of basis ﬂow ﬁelds (PCA-Flow) .
It can be shown that the parameterized model 
can be efﬁciently implemented using CNN.
CNN-based methods. In the work of Fischer et al. termed
FlowNet , a post-processing step that involves energy
minimization is required to reduce smoothing effect across
ﬂow boundaries. This process is not end-to-end trainable.
In our work, we present an end-to-end approach that performs in-network ﬂow regularization using the proposed
f-lconv layer, which plays similar role as the regularization term in variational methods.
In FlowNet2 , Ilg
et al. introduce a huge network cascade (over 160M parameters) that consists of variants of FlowNet. The cascade improves ﬂow accuracy with an expense of model size
and computational complexity. Our model uses a more ef-
ﬁcient architecture containing 30 times fewer parameters
than FlowNet2 while the performance is on par with it. A
compact network termed SPyNet from Ranjan et al. is
inspired from spatial pyramid. Nevertheless, the accuracy is
far below FlowNet2. A small-sized variant of our network
outperforms SPyNet while being 1.33 times smaller in the
model size. Zweig et al. present a network to interpolate
third-party sparse ﬂows but requiring off-the-shelf edge detector . DeepFlow that involves convolution and
pooling operations is however not a CNN, since the “ﬁlter
weights” are non-trainable image patches. According to the
terminology used in FlowNet, DeepFlow uses correlation.
An alternative approach for establishing point correspondence is to match image patches. Zagoruyko et al. ﬁrst introduce to CNN-feature matching . G¨uney et al. ﬁnd
feature representation and formulate optical ﬂow estimation
in MRF . Bailer et al. use multi-scale features and
then perform feature matching as Flow Fields . Although
pixel-wise matching can establish accurate point correspondence, the computational demand is too high for practical
use (it takes several seconds even a GPU is used). As a
tradeoff, Fischer et al. and Ilg et al. perform feature
matching only at a reduced spatial resolution. We reduce
the computational burden of feature matching by using a
short-ranged matching of warped CNN features at sampled
positions and a sub-pixel reﬁnement at every pyramid level.
We are inspired by the feature transformation used in
Spatial Transformer . Our network uses the proposed
f-warp layer to displace each channel2 of the given vector-
2We can also use f-warp layer to displace each channel differently when
valued feature according to the provided ﬂow ﬁeld. Unlike
Spatial Transformer, f-warp layer is not fully constrained
and is a relaxed version of it as the ﬂow ﬁeld is not parameterized. While transformation in FlowNet2 and SPyNet is
limited to images, our decider network is a more generic
warping network that warps high-level CNN features.
3. LiteFlowNet
LiteFlowNet is composed of two compact sub-networks
that are specialized in pyramidal feature extraction and optical ﬂow estimation as shown in Figure 2. Since the spatial
dimension of feature maps is contracting in feature extraction and that of ﬂow ﬁelds is expanding in ﬂow estimation,
we call the two sub-networks as NetC and NetE respectively. NetC transforms any given image pair into two pyramids of multi-scale high-dimensional features. NetE consists of cascaded ﬂow inference and regularization modules
that estimate coarse-to-ﬁne ﬂow ﬁelds.
Pyramidal Feature Extraction.
As shown in Figure 2,
NetC is a two-stream network in which the ﬁlter weights
are shared across the two streams. Each of them functions
as a feature descriptor that transforms an image I to a pyramid of multi-scale high-dimensional features {Fk(I)} from
the highest spatial resolution (k = 1) to the lowest spatial
resolution (k = L). The pyramidal features are generated
by stride-s convolutions with the reduction of spatial resolution by a factor s up the pyramid. In the following, we
omit the subscript k that indicates the level of pyramid for
brevity. We use Fi to represent CNN features for Ii. When
we discuss the operations in a pyramid level, the same operations are applicable to other levels.
Feature Warping. At each pyramid level, a ﬂow ﬁeld is
inferred from high-level features F1 and F2 of images I1
and I2. Flow inference becomes more challenging if I1 and
I2 are captured far away from each other. With the motivation of image warping used in conventional methods 
and recent CNNs for addressing large-displacement
ﬂow, we propose to reduce feature-space distance between
F1 and F2 by feature warping (f-warp). Speciﬁcally, F2
is warped towards F1 by f-warp via ﬂow estimate ˙x to
eF2(x) ≜F2(x + ˙x) ∼F1(x). This allows our network to
infer residual ﬂow between F1 and eF2 that has smaller ﬂow
magnitude (more details in Section 3.1) but not the complete ﬂow ﬁeld that is more difﬁcult to infer. Unlike conventional methods, f-warp is performed on high-level CNN
features but not on images. This makes our network more
powerful and efﬁcient in addressing the optical ﬂow problem. To allow end-to-end training, F is interpolated to eF
multiple ﬂow ﬁelds are supplied. The usage, however, is beyond the scope
of this work.
Figure 2: The network structure of LiteFlowNet. For the ease of representation, only a 3-level design is shown. Given an image pair (I1
and I2), NetC generates two pyramids of high-level features (Fk(I1) in pink and Fk(I2) in red, k ∈ ). NetE yields multi-scale ﬂow
ﬁelds that each of them is generated by a cascaded ﬂow inference module M:S (in blue color, including a descriptor matching unit M and
a sub-pixel reﬁnement unit S) and a regularization module R (in green color). Flow inference and regularization modules correspond to
data ﬁdelity and regularization terms in conventional energy minimization methods respectively.
for any sub-pixel displacement ˙x as follows:
where xs = x + ˙x = (xs, ys)⊤denotes the source coordinates in the input feature map F that deﬁnes the sample
point, x = (x, y)⊤denotes the target coordinates of the
regular grid in the interpolated feature map eF, and N(xs)
denotes the four pixel neighbors of xs. The above bilinear
interpolation allows back-propagation during training as its
gradients can be efﬁciently computed .
3.1. Cascaded Flow Inference
At each pyramid level of NetE, pixel-by-pixel matching
of high-level features yields coarse ﬂow estimate. A subsequent reﬁnement on the coarse ﬂow further improves it to
sub-pixel accuracy.
First Flow Inference (descriptor matching). Point correspondence between I1 and I2 is established through computing correlation of high-level feature vectors in individual
pyramidal features F1 and F2 as follows:
c(x, d) = F1(x) · F2(x + d)/N,
where c is the matching cost between point x in F1 and
point x+d in F2, d ∈Z is the displacement vector from x,
and N is the length of the feature vector. A cost volume C
is built by aggregating all the matching costs into a 3D grid.
We reduce the computational burden raised by costvolume processing in three ways: 1) We perform
short-range matching at every pyramid level instead of longrange matching at a single level. 2) We reduce feature-space
distance between F1 and F2 by warping F2 towards F1
using our proposed f-warp through ﬂow estimate3 ˙x from
previous level. 3) We perform matching only at the sampled positions in the pyramid levels of high-spatial resolution. The sparse cost volume is interpolated in the spatial
dimension to ﬁll the missed matching costs for the unsampled positions. The ﬁrst two techniques effectively reduce
the searching space needed, while the last technique reduces
the frequency of matching per pyramid level.
In the descriptor matching unit M, residual ﬂow ∆˙xm
is inferred by ﬁltering the cost volume C as illustrated in
Figure 3. A complete ﬂow ﬁeld ˙xm is computed as follows:
 C(F1, eF2; d)
Second Flow Inference (sub-pixel reﬁnement).
the cost volume in descriptor matching unit is aggregated
by measuring pixel-by-pixel correlation, ﬂow estimate ˙xm
from the previous inference is only up to pixel-level accuracy. We introduce the second ﬂow inference in the wake
of descriptor matching as shown in Figure 3. It aims to
reﬁne the pixel-level ﬂow ﬁeld ˙xm to sub-pixel accuracy.
This prevents erroneous ﬂows being ampliﬁed by upsampling and passing to the next pyramid level. Speciﬁcally,
F2 is warped to eF2 via ﬂow estimate ˙xm. Sub-pixel reﬁnement unit S yields a more accurate ﬂow ﬁeld ˙xs by minimizing feature-space distance between F1 and eF2 through
3 ˙x from previous level needs to be upsampled in spatial resolution (denoted by “↑s”) and magnitude (multiplied by a scalar s) to s ˙x↑s for matching the spatial resolution of the pyramidal features at the current level.
Figure 3: A cascaded ﬂow inference module M:S in NetE. It consists of a descriptor matching unit M and a sub-pixel reﬁnement
unit S. In M, f-warp transforms high-level feature F2 to e
upscaled ﬂow ﬁeld 2 ˙x↑2 estimated at previous pyramid level. In
S, F2 is warped by ˙xm from M. In comparison to residual ﬂow
∆˙xm, more ﬂow adjustment exists at ﬂow boundaries in ∆˙xs.
computing residual ﬂow ∆˙xs as the following:
 F1, eF2, ˙xm
3.2. Flow Regularization
Cascaded ﬂow inference resembles the role of data ﬁdelity in conventional minimization methods. Using data
term alone, vague ﬂow boundaries and undesired artifacts
commonly exist in ﬂow ﬁeld . To tackle this problem, we propose to use a feature-driven local convolution
(f-lcon) to regularize ﬂow ﬁeld from the cascaded ﬂow inference. The operation of f-lcon is well-governed by the
Laplacian formulation of diffusion of pixel values . In
contrast to local convolution (lcon) used in conventional
CNNs , f-lcon is more generalized. Not only is a distinct ﬁlter used for each position of feature map, but the
ﬁlter is adaptively constructed for individual ﬂow patches.
Consider a general case, a vector-valued feature F that
has to be regularized has C channels and a spatial dimension M × N. Deﬁne G = {g} as the set of ﬁlters used in
f-lcon layer. The operation of f-lcon to F can be formulated
as follow:
fg(x, y, c) = g(x, y, c) ∗f(x, y, c),
where “∗” denotes convolution, f(x, y, c) is a w × w patch
centered at position (x, y) of channel c in F, g(x, y, c) is the
corresponding w × w regularization ﬁlter, and fg(x, y, c) is
a scalar output for x = (x, y)⊤and c = 1, 2, ..., C. To
be speciﬁc for regularizing ﬂow ﬁeld ˙xs from the cascaded
Figure 4: Folding and packing of f-lcon ﬁlters {g}. The (x, y)entry of 3D tensor ¯G(c) is a 3D column with size 1 × 1 × w2.
It corresponds to the unfolded w × w f-lcon ﬁlter g(x, y, c) to be
applied at position (x, y) of channel c in vector-valued feature F.
ﬂow inference, we replace F to ˙xs. Flow regularization
module R is deﬁned as follows:
˙xr = R( ˙xs; G).
The f-lcon ﬁlters need to be specialized for smoothing
ﬂow ﬁeld. It should behave as an averaging ﬁlter if the variation of ﬂow vectors over the patch is smooth. It should also
not over-smooth ﬂow ﬁeld across ﬂow boundary. We deﬁne
a feature-driven CNN distance metric D that estimates local ﬂow variation using pyramidal feature F1, ﬂow ﬁeld ˙xs
from the cascaded ﬂow inference, and occlusion probability map4 O. In summary, D is adaptively constructed by a
CNN unit RD as follows:
D = RD(F1, ˙xs, O).
With the introduction of feature-driven distance metric D,
each ﬁlter g of f-lcon is constructed as follows:
g(x, y, c) =
exp(−D(x, y, c)2)
(xi,yi)∈N(x,y) exp(−D(xi, yi, c)2),
where N(x, y) denotes the neighborhood containing ω × ω
pixels centered at position (x, y).
Here, we provide a mechanism to perform f-lcon ef-
For a C-channel input F, we use C tensors
¯G(1), ..., ¯G(C) to store f-lcon ﬁlter set G. As illustrated
in Figure 4, each f-lcon ﬁlter g(x, y, c) is folded into a
1 × 1 × w2 3D column and then packed into the (x, y)entry of a M × N × w2 3D tensor ¯G(c). Same folding and
packing operations are also applied to each patch in each
channel of F. This results C tensors ¯F(1), ..., ¯F(C) for F.
In this way, Equation (5) can be reformulated to:
Fg(c) = ¯G(c) ⊙¯F(c),
where “⊙” denotes element-wise dot product between the
corresponding columns of the tensors. With the abuse of
4We use the brightness error ||I2(x+ ˙x)−I1(x)||2 between the warped
second image and the ﬁrst image as the occlusion probability map.
Table 1: AEE on the Chairs testing set. Models are trained on the
Chairs training set.
LiteFlowNetX-pre
LiteFlowNet-pre
notation, Fg(c) means the c-th xy-slice of the regularized
C-channel feature Fg. Equation (9) reduces the dimension
of tensors from M ×N ×w2 (right-hand side in prior to the
dot product) to M × N (left-hand side).
4. Experiments
Network Details. In LiteFlowNet, NetC generates 6-level
pyramidal features and NetE predicts ﬂow ﬁelds for levels
6 to 2. Flow ﬁeld in level 2 is upsampled to yield ﬂow ﬁeld
in level 1. We set the maximum searching radius in costvolume to 3 pixels (levels 6 to 4) or 6 pixels (levels 3 to 2).
Matching is performed at each position in pyramidal features, except for levels 3 to 2 that it is performed at a regularly sampled grid (a stride of 2). All convolution layers use
3 × 3 ﬁlters, except each last layer in descriptor matching
M, sub-pixel reﬁnement S, and ﬂow regularization R units
uses 5×5 (levels 4 to 3) or 7×7 (level 2) ﬁlters. Each convolution layer is followed by a leaky rectiﬁed linear unit layer,
except f-lcon and the last layer in M, S and R CNN units.
More details can be found in the supplementary material.
Training Details. We train our network stage-wise by the
following steps: 1) NetC and M6:S6 of NetE is trained
for 300k iterations. 2) R6 together with the trained network in step 1 is trained for 300k iterations. 3) For levels k ∈ , Mk:Sk followed by Rk is added into the
trained network each time. The new network cascade is
trained for 200k (level 2: 300k) iterations. Filter weights
are initialized from previous level. Learning rates are initially set to 1e-4, 5e-5, and 4e-5 for levels 6 to 4, 3 and
2 respectively. We reduce it by a factor of 2 starting at
120k, 160k, 200k, and 240k iterations. We use the same
loss weight, L2 training loss, Adam optimization, data augmentation (including noise injection), and training schedule 5 (Chairs →Things3D ) as FlowNet2 . We
denote LiteFlowNet-pre and LiteFlowNet as the networks
trained on Chairs and Chairs →Things3D, respectively.
4.1. Results
We compare several variants of LiteFlowNet to stateof-the-art methods on public benchmarks including FlyingChairs
KITTI12 , KITTI15 , and Middlebury .
FlyingChairs. We ﬁrst compare the intermediate results of
5We excluded a small amount of training data in Things3D undergoing
extremely large ﬂow displacement as advised by the authors (https://
github.com/lmb-freiburg/flownet2/issues).
different well-performing networks trained on Chairs alone
in Table 1.
Average end-point error (AEE) is reported.
LiteFlowNet-pre outperforms the compared networks. No
intermediate result is available for FlowNet2 as each
cascade is trained on the Chairs →Things3D schedule individually. Since FlowNetC, FlowNetS (variants of
FlowNet ), and SPyNet have fewer parameters than
FlowNet2 and the later two models do not perform feature matching, we also construct a small-size counterpart
LiteFlowNetX-pre by removing the matching part and
shrinking the model sizes of NetC and NetE by about 4 and
5 times, respectively. Despite that LiteFlowNetX-pre is 43
and 1.33 times smaller than FlowNetC and SPyNet, respectively, it still outperforms these networks and is on par with
FlowNetC that uses explicit matching.
MPI Sintel.
In Table 2, LiteFlowNetX-pre outperforms
FlowNetS (and C) and SPyNet that are trained
on Chairs on all cases except the Middlebury benchmark.
LiteFlowNet, trained on the Chairs →Things3D schedule, performs better than LiteFlowNet-pre as expected.
LiteFlowNet also outperforms SPyNet, FlowNet2-S (and -
C) . We also ﬁne-tuned LiteFlowNet on a mixture of
Sintel clean and ﬁnal training data (LiteFlowNet-ft) using
the generalized Charbonnier loss . No noise augmentation was performed but we introduced image mirroring
to improve the diversity of the training set. LiteFlowNetft outperforms FlowNet2-ft-sintel and EpicFlow 
for Sintel ﬁnal testing set. Despite DC Flow (a hybrid method consists of CNN and post-processing) performs better than LiteFlowNet, its GPU runtime requires
several seconds that makes it formidable in many applications. Figure 5 shows some examples of ﬂow ﬁelds on Sintel dataset. LiteFlowNet-ft and FlowNet2-ft-sintel perform
the best among the compared methods. As LiteFlowNet has
ﬂow regularization module, sharper ﬂow boundaries and
lesser artifacts can be observed in the generated ﬂow ﬁelds.
KITTI. LiteFlowNet consistently performs better than
LiteFlowNet-pre especially on KITTI15 as shown in Table 2. It also outperforms SPyNet and FlowNet2-S
(and C) . We also ﬁne-tuned LiteFlowNet on a mixture of KITTI12 and KITTI15 training data (LiteFlowNetft) using the same augmentation as the case of Sintel except that we reduced the amount of augmentation for spatial motion to ﬁt the driving scene. After ﬁne-tuning, Lite-
FlowNet generalizes well to real-world data. LiteFlowNetft outperforms FlowNet2-ft-kitti .
Figure 6 shows
some examples of ﬂow ﬁelds on KITTI. As in the case
for Sintel, LiteFlowNet-ft and FlowNet2-ft-kitti performs
the best among the compared methods.
Even though
LiteFlowNet and its variants perform pyramidal descriptor matching in a limited searching range, it yields reliable
large-displacement ﬂow ﬁelds for real-world data due to the
feature warping (f-warp) layer introduced. More analysis
Table 2: AEE of different methods. The values in parentheses are the results of the networks on the data they were trained on, and hence are
not directly comparable to the others. Fl-all: Percentage of outliers averaged over all pixels. Inliers are deﬁned as EPE <3 pixels or <5%.
The best number for each category is highlighted in bold. (Note: 1The values are reported from . 2We re-trained the model using the
code provided by the authors. 3,4,5The values are computed using the trained models provided by the authors. 4Large discrepancy exists as
the authors mistakenly evaluated the results on the disparity dataset. 5 Up-to-date dataset is used. 6Trained on Driving and Monkaa )
Sintel clean
Sintel ﬁnal
Middlebury
train (Fl-all)
test (Fl-all)
Conventional
DeepFlow1 
Classic+NLP 
PCA-Layers1 
EpicFlow1 
FlowFields1 
Deep DiscreteFlow 
Bailer et al. 
DC Flow 
Heavyweight CNN
FlowNetS 
FlowNetS-ft 
FlowNetC 
FlowNetC-ft 
FlowNet2-S3 
FlowNet2-S re-trained2
FlowNet2-C3 
FlowNet2 
FlowNet2-ft-sintel 
FlowNet2-ft-kitti 
Lightweight CNN
SPyNet 
SPyNet-ft 
LiteFlowNetX-pre
LiteFlowNetX
LiteFlowNet-pre
LiteFlowNet
LiteFlowNet-ft
Table 3: Number of training parameters and runtime. The model
for which the runtime is in parentheses is measured using Torch,
and hence are not directly comparable to the others using Caffe.
Abbreviation LFlowNet refers to LiteFlowNet.
# param. (M)
Runtime (ms)
will be presented in Section 4.3.
Middlebury.
LiteFlowNet has comparable performance
with conventional methods.
It outperforms FlowNetS
(and C) , FlowNet2-S (and C) , SPyNet , and
FlowNet2 . On the benchmark, LiteFlowNet-ft refers
to the one ﬁne-tuned on Sintel.
4.2. Runtime and Parameters
We measure runtime of a CNN using a machine
equipped with an Intel Xeon E5 2.2GHz and an NVIDIA
GTX 1080. Timings are averaged over 100 runs for Sintel image pairs of size 1024 × 436. As summarized in Table 3, LiteFlowNet has about 30 times fewer parameters
Table 4: AEE of different variants of LiteFlowNet-pre trained on
Chairs dataset with some of the components disabled.
Feature Warping
Descriptor Matching
Sub-pix. Reﬁnement
Regularization
FlyingChairs (train)
Sintel clean (train)
Sintel ﬁnal (train)
KITTI12 (train)
KITTI15 (train)
than FlowNet2 and is 1.36 times faster in runtime.
LiteFlowNetX, a variant of LiteFlowNet having a smaller
model size and without descriptor matching, has about 43
times fewer parameters than FlowNetC and a comparable runtime. LiteFlowNetX also has 1.33 times fewer parameters than SPyNet . LiteFlowNet and its variants are
currently the most compact CNNs for ﬂow estimation.
4.3. Ablation Study
investigate
LiteFlowNet-pre trained on Chairs by evaluating the per-
Image overlay
Ground truth
FlowNetC 
FlowNet2 
LiteFlowNet
First image
FlowNetC 
FlowNet2 
FlowNet2-ft-sintel 
LiteFlowNet-ft
Figure 5: Examples of ﬂow ﬁelds from different methods on Sintel training sets for clean (top row), ﬁnal (middle row) passes, and the
testing set for ﬁnal pass (last row). Fine details are well preserved and less artifacts can be observed in the ﬂow ﬁelds of LiteFlowNet.
Image overlay
Ground truth
FlowNetC 
FlowNet2 
LiteFlowNet
First Image
FlowNetC 
FlowNet2 
FlowNet2-ft-kitti 
LiteFlowNet-ft
Figure 6: Examples of ﬂow ﬁelds from different methods on the training set (top) and the testing set (bottom) of KITTI15.
formance of different variants with some of the components
disabled. The AEE results are summarized in Table 4 and
examples of ﬂow ﬁelds are illustrated in Figure 7.
Feature Warping. We consider two variants LiteFlowNetpre (WM and WMS) and compare them to the counterparts
with warping disabled (M and MS). Flow ﬁelds from M and
MS are more vague. Large degradation in AEE is noticed
especially for KITTI12 (33%) and KITTI15 (25%). With
feature warping, pyramidal features that input to ﬂow inference are closer to each other. This facilitates ﬂow estimation
in subsequent pyramid level by computing residual ﬂow.
Descriptor Matching. We compare the variant WSR without descriptor matching for which the ﬂow inference part
is made as deep as that in the unamended LiteFlowNetpre (ALL). No noticeable difference between the ﬂow ﬁelds
from WSR and ALL. Since the maximum displacement of
the example ﬂow ﬁeld is not very large (only 14.7 pixels),
accurate ﬂow ﬁeld can still be yielded from WSR. For evaluation covering a wide range of ﬂow displacement (especially large-displacement benchmark, KITTI), degradation
in AEE is noticed for WSR. This suggests that descriptor
matching is useful in addressing large-displacement ﬂow.
Sub-Pixel Reﬁnement.
The ﬂow ﬁeld generated from
WMS is more crisp and contains more ﬁne details than
that generated from WM with sub-pixel reﬁnement disabled. Less small-magnitude ﬂow artifacts (represented by
light color on the background) are also observed. Besides,
WMS achieves smaller AEE. Since descriptor matching establishes pixel-by-pixel correspondence, sub-pixel reﬁnement is necessary to yield detail-preserving ﬂow ﬁeld.
Regularization. In comparison WMS with regularization
disabled to ALL, undesired artifacts exist in homogeneous
regions (represented by very dim color on the background)
of the ﬂow ﬁeld generated from WMS. Flow bleeding and
vague ﬂow boundaries are observed. Degradation in AEE is
also noticed. This suggests that the proposed feature-driven
local convolution (f-lcon) plays the vital role to smooth ﬂow
ﬁeld and maintain crisp ﬂow boundaries as regularization
term in conventional variational methods.
5. Conclusion
We have presented a compact network for accurate ﬂow
estimation. LiteFlowNet outperforms FlowNet and is on
par with or outperforms the state-of-the-art FlowNet2 
Figure 7: Examples of ﬂow ﬁelds from different variants of LiteFlowNet-pre trained on Chairs with some of the components disabled.
LiteFlowNet-pre is denoted as “All”. W = Feature Warping, M = Descriptor Matching, S = Sub-Pixel Reﬁnement, R = Regularization.
on public benchmarks while being faster in runtime and
30 times smaller in model size. Pyramidal feature extraction and feature warping (f-warp) help us to break the de
facto rule of accurate ﬂow network requiring large model
size. To address large-displacement and detail-preserving
ﬂows, LiteFlowNet exploits short-range matching to generate pixel-level ﬂow ﬁeld and further improves the estimate
to sub-pixel accuracy in the cascaded ﬂow inference. To
result crisp ﬂow boundaries, LiteFlowNet regularizes ﬂow
ﬁeld through feature-driven local convolution (f-lcon). With
its lightweight, accurate, and fast ﬂow computation, we expect that LiteFlowNet can be deployed to many applications
such as motion segmentation, action recognition, SLAM,
3D reconstruction and more.
Acknowledgement. This work is supported by SenseTime
Group Limited and the General Research Fund sponsored
by the Research Grants Council of the Hong Kong SAR
(CUHK 14241716, 14224316, 14209217).
6. Appendix
LiteFlowNet consists of two compact sub-networks,
namely NetC and NetE. NetC is a two-steam network in
which the two network streams share the same set of ﬁlters.
The input to NetC is an image pair (I1, I2). The network
architectures of the 6-level NetC and NetE at pyramid level
5 are provided in Table 5 and Tables 6 to 8, respectively.
We use sufﬁxes “M”, “S” and “R” to highlight the layers
that are used in descriptor matching, sub-pixel reﬁnement,
and ﬂow regularization units in NetE, respectively. We declare a layer as “ﬂow” to highlight when the output is a
ﬂow ﬁeld. Our code and trained models are available at
 
video clip ( 
pfQ0zFwv-hM) and a supplementary material are available on our project page ( 
edu.hk/projects/LiteFlowNet/) to showcase the
performance of LiteFlowNet and the effectiveness of the
proposed components in our network.