THE THREE-DIMENSIONAL POWER SPECTRUM OF GALAXIES FROM THE SLOAN DIGITAL SKY SURVEY
Max Tegmark,1 Michael R. Blanton,2 Michael A. Strauss,3 Fiona Hoyle,4 David Schlegel,3 Roman Scoccimarro,2
Michael S. Vogeley,4 David H. Weinberg,5 Idit Zehavi,6 Andreas Berlind,6 Tama´s Budavari,7 Andrew Connolly,8
Daniel J. Eisenstein,9 Douglas Finkbeiner,3 Joshua A. Frieman,6,10James E. Gunn,3 Andrew J. S. Hamilton,11
Lam Hui,10 Bhuvnesh Jain,1 David Johnston,6,10 Stephen Kent,10 Huan Lin,10 Reiko Nakajima,1
Robert C. Nichol,12 Jeremiah P. Ostriker,3 Adrian Pope,7 Ryan Scranton,8 Urosˇ Seljak,3
Ravi K. Sheth,8 Albert Stebbins,10 Alexander S. Szalay,7 Istva´n Szapudi,13 Licia Verde,3
Yongzhong Xu,1 James Annis,10 Neta A. Bahcall,3 J. Brinkmann,14 Scott Burles,15
Francisco J. Castander,16 Istvan Csabai,7 Jon Loveday,17 Mamoru Doi,18 Masataka Fukugita,18
J. Richard Gott III,3 Greg Hennessy,19 David W. Hogg,2 Zˇeljko Ivezic´,3 Gillian R. Knapp,3
Don Q. Lamb,6 Brian C. Lee,10 Robert H. Lupton,3 Timothy A. McKay,20 Peter Kunszt,7
Jeffrey A. Munn,19 Liam O’Connell,17 John Peoples,10 Jeffrey R. Pier,19
Michael Richmond,21 Constance Rockosi,6 Donald P. Schneider,22
Christopher Stoughton,10 Douglas L. Tucker,10 Daniel E. Vanden Berk,8
Brian Yanny,10 and Donald G. York6,23
(For the SDSS Collaboration)
Received 2003 June 18; accepted 2003 December 17
We measure the large-scale real-space power spectrum PðkÞ by using a sample of 205,443 galaxies from the
Sloan Digital Sky Survey, covering 2417 effective square degrees with mean redshift z  0:1. We employ a
matrix-based method using pseudo–Karhunen-Loe`ve eigenmodes, producing uncorrelated minimum-variance
measurements in 22 k-bands of both the clustering power and its anisotropy due to redshift-space distortions,
with narrow and well-behaved window functions in the range 0:02 h Mpc1 < k < 0:3 h Mpc1. We pay particular attention to modeling, quantifying, and correcting for potential systematic errors, nonlinear redshift
distortions, and the artiﬁcial red-tilt caused by luminosity-dependent bias. Our results are robust to omitting
angular and radial density ﬂuctuations and are consistent between different parts of the sky. Our ﬁnal result is a
measurement of the real-space matter power spectrum PðkÞ up to an unknown overall multiplicative bias factor.
Our calculations suggest that this bias factor is independent of scale to better than a few percent for
k < 0:1 h Mpc1, thereby making our results useful for precision measurements of cosmological parameters in
conjunction with data from other experiments such as the Wilkinson Microwave Anisotropy Probe satellite. The
power spectrum is not well-characterized by a single power law but unambiguously shows curvature. As a simple
characterization of the data, our measurements are well ﬁtted by a ﬂat scale-invariant adiabatic cosmological
model with h m ¼ 0:213  0:023 and 8 ¼ 0:89  0:02 for L galaxies, when ﬁxing the baryon fraction
b=m ¼ 0:17 and the Hubble parameter h ¼ 0:72; cosmological interpretation is given in a companion paper.
Subject headings: galaxies: statistics — large-scale structure of universe — methods: data analysis
On-line material: color ﬁgures
1. INTRODUCTION
The spectacular recent cosmic microwave background
(CMB) measurements from the Wilkinson Microwave Anisotropy Probe (WMAP) satellite and other
experiments have increased the importance of non-CMB
measurements for the endeavor to constrain cosmological
1 Department of Physics, University of Pennsylvania, Philadelphia, PA
2 Center for Cosmology and Particle Physics, Department of Physics, New
York University, 4 Washington Place, New York, NY 10003.
3 Princeton University Observatory, Princeton, NJ 08544.
4 Department of Physics, Drexel University, Philadelphia, PA 19104.
5 Department of Astronomy, Ohio State University, Columbus, OH 43210.
6 Center for Cosmological Physics and Department of Astronomy and
Astrophysics, University of Chicago, Chicago, IL 60637.
7 Department of Physics and Astronomy, Johns Hopkins University, 3701
San Martin Drive, Baltimore, MD 21218.
8 University of Pittsburgh, Department of Physics and Astronomy, 3941
O’Hara Street, Pittsburgh, PA 15260.
9 Department of Astronomy, University of Arizona, 933 North Cherry
Avenue, Tucson, AZ 85721.
10 Fermi National Accelerator Laboratory, P.O. Box 500, Batavia, IL
11 JILA and Department of Astrophysical and Planetary Sciences, University of Colorado, Boulder, CO 80309; .
12 Department of Physics, 5000 Forbes Avenue, Carnegie Mellon University, Pittsburgh, PA 15213.
13 Institute for Astronomy, University of Hawaii, 2680 Woodlawn Drive,
Honolulu, HI 96822.
14 Apache Point Observatory, 2001 Apache Point Road, Sunspot, NM
88349-0059.
15 Department of Physics, Massachusetts Institute of Technology, Cambridge, MA 02139.
16 Institut d’Estudis Espacials de Catalunya/CSIC, Gran Capita 2-4, 08034
Barcelona, Spain.
17 Sussex Astronomy Centre, University of Sussex, Falmer, Brighton BN1
18 Institute of Astronomy, University of Tokyo, Kashiwa 277-8582, Japan.
19 US Naval Observatory, Flagstaff Station, Flagstaff, AZ 86002-1149.
20 Department of Physics, University of Michigan, Ann Arbor, MI 48109-1120.
21 Physics Department, Rochester Institute of Technology, 1 Lomb
Memorial Drive, Rochester, NY 14623.
22 Department of Astronomy and Astrophysics, Pennsylvania State
University, University Park, PA 16802.
23 Enrico Fermi Institute, University of Chicago, Chicago, IL 60637.
The Astrophysical Journal, 606:702–740, 2004 May 10
# 2004. The American Astronomical Society. All rights reserved. Printed in U.S.A.
models and their free parameters. These non-CMB constraints are crucially needed for breaking CMB degeneracies
 ; for instance, WMAP alone is consistent with a closed
universe with Hubble parameter h ¼ 0:32 and no cosmological
constant . Yet they are
currently less reliable and precise than the CMB, making them
the limiting factor and weakest link in the quest for precision
cosmology. Much of the near-term progress in cosmology will
therefore be driven by reductions in statistical and systematic
uncertainties of non-CMB probes such as Ly forest and galaxy clustering and motions, gravitational lensing, cluster
studies, and supernova Ia distance determinations. Galaxy
redshift surveys can play a key role in breaking degeneracies
and providing cross-checks but only if systematics can be controlled to high precision. The goal of the present paper is to do just this, using over
200,000 galaxies from the Sloan Digital Sky Survey to measure the shape of the real-space matter
power spectrum PðkÞ, accurately quantifying and correcting for
the effects of light-to-mass bias, redshift-space distortions,
survey geometry effects, and other complications.
The cosmological constraining power of three-dimensional
maps of the universe provided by galaxy redshift surveys has
motivated ever more ambitious observational efforts such as
the CfA/Updated Zwicky Catalog , Las Campanas Redshift Survey , and PSCz surveys, each
well in excess of 104 galaxies. The current state of the art is
the Anglo-Australian Telescope Two Degree Field Galaxy
Redshift Survey . Analysis of the
ﬁrst 147,000 2dFGRS galaxies has supported a ﬂat, dark energy–dominated cosmology, as have angular clustering analyses of the parent catalogs
underlying the 2dFGRS and
SDSS . Tantalizing evidence for baryonic wiggles in the galaxy power
spectrum is presented by Percival et al. , Miller, Nichol,
& Batuski , and Miller, Nichol, & Chen
 , and cosmological models have been further constrained in conjunction with CMB data .
The SDSS is the most ambitious galaxy redshift survey to
date, whose goal, driven by large-scale structure science, is to
measure of order 106 galaxy redshifts. Zehavi et al. 
computed the correlation function using about 30,000 galaxies
from early SDSS data . In conjunction
with the ﬁrst major SDSS data release in 2003 , a series of papers will address various
aspects of the three-dimensional clustering of a much larger
data set involving over 200,000 galaxies with redshifts. This
paper is focused on measuring the power galaxy spectrum
PðkÞ on large scales, dealing with complications such as
luminosity-dependent bias and redshift distortions only to the
extent necessary to recover an undistorted measurement of the
real-space matter power spectrum. Zehavi et al. measure and model the real-space correlation function, mainly on
smaller scales, focusing on departures from power-law behavior, and I. Zehavi et al. will study
how the correlation function depends on galaxy properties.
Pope et al. measure the parameters that characterize the
large-scale power spectrum with a complementary approach
involving direct likelihood analysis on Karhunen-Loe`ve eigenmodes, as opposed to the quadratic estimator technique employed in the present paper.
This paper is organized as follows. In x 2, we describe the
SDSS data used and how we model it; the technical details can
be found in Appendix A. In x 3, we describe our methodology
and present our basic measurements of both the power spectrum and its redshift-space anisotropy. The details of the formalism for doing this are described in Appendix B. In x 4 we
focus on this anisotropy to model, quantify, and correct for the
effects of redshift-space distortions, producing an estimate of
the real-space galaxy power spectrum and testing our procedure with Monte Carlo simulations. In x 5, we model, quantify, and correct for the effects of luminosity-dependent
biasing, producing an estimate of the real-space matter power
spectrum. In x 6, we test for a variety of systematic errors. In
x 7, we discuss our results. The cosmological interpretation of
our measurements is given in a companion paper .
2. DATA AND DATA MODELING
The SDSS uses a mosaic CCD camera to
image the sky in ﬁve photometric bandpasses denoted u, g, r,
i, and z .24 After astrometric calibration
 , photometric data reduction , and photometric calibration , galaxies are selected for
spectroscopic observations by using the algorithm described
by Strauss et al. . To a good approximation, the main
galaxy sample consists of all galaxies with r-band apparent
Petrosian magnitude r <17:77 (see Appendix A). Galaxy
spectra are also measured for a luminous red galaxy sample
 , for which clustering results will be
reported in a separate paper. These targets are assigned to
spectroscopic plates by an adaptive tiling algorithm and observed with a pair of ﬁber-fed CCD
spectrographs , after
which the spectroscopic data reduction and redshift determination are performed by automated pipelines .
The rms galaxy redshift errors are 30 km s1 and hence
negligible for the purpose of the present paper.
Our analysis is based on SDSS sample11 , consisting of the 205,443 galaxies observed before
2002 July, all of which will be included in the upcoming
SDSS Data Release 2. From this basic sample, we produce a
set of subsamples as speciﬁed in Table 1. The details of how
this basic sample was processed, modeled, and subdivided are
given in Appendix A. The bottom line is that each sample is
completely speciﬁed by three entities: (1) the galaxy positions
(a list of right ascension, declination, and comoving redshiftspace distance r for each galaxy), (2) the radial selection
function ¯nðrÞ, which gives the expected (not observed) number density of galaxies as a function of distance, and (3) the
angular selection function ¯nðˆrÞ, which gives the completeness as a function of direction in the sky. Our samples are
24 The Fukugita et al. paper actually deﬁnes a slightly different
system, denoted u0, g0, r0, i0, z0, but SDSS magnitudes are now referred to the
native ﬁlter system of the 2.5 m survey telescope, for which the bandpass
notation is unprimed.
3D POWER SPECTRUM OF GALAXIES FROM SDSS
constructed so that their three-dimensional selection function
is separable, i.e., simply the product ¯nðrÞ ¼ ¯nðˆrÞ¯nðrÞ of an
angular and a radial part; here r  jrj and ˆr  r=r are the
comoving radial distance and the unit vector corresponding to
the position r. The conversion from redshift z to comoving
distance was made for a ﬂat cosmological model with a cosmological constant  ¼ 0:7; below we see that our results
are insensitive to this assumption.
2.1. Angular Selection Function
The angular selection function ¯nðˆrÞ is shown in Figure 1. For
the baseline sample, it covers a sky area of 2499 deg2. The
function ¯nðˆrÞ is deﬁned to be the completeness, i.e., the probability that a galaxy satisfying the sample cuts actually gets
assigned a redshift (including the 6% of the total that are determined on the basis of the nearest neighbor redshift as described in Appendix A). Therefore, the completeness is a
dimensionless number between 0 and 1. The effective area is
Ð ¯nðˆrÞ d  2417 deg2, corresponding to an average completeness of 96.7%. As detailed in Appendix A.2, we model
¯nðˆrÞ as a piecewise constant function. We specify this function
by giving its value in each of a large number of disjoint
spherical polygons, within each of which it takes a constant
value. There are 2914 such polygons for the baseline sample,
encoding the geometric boundaries of spectroscopic tiles,
holes, and other relevant entities. Figure 1 shows that the sky
coverage naturally separates into three fairly compact regions
of comparable size: north of the Galactic plane (in the center of
the ﬁgure), there is one region on the celestial equator and
another at high declination; south of the Galactic plane, there is
a set of three stripes near the equator. For the purpose of testing
for systematic errors, we deﬁne angular subsamples A1, A3,
and A4 corresponding to these regions (see Table 1), which
have effective areas of 809, 1007, and 600 deg2, respectively.
2.2. Radial Selection Function
Our estimate of the radial selection function for the baseline
sample is shown in Figures 2 and 3, together with a histogram
of the galaxy distances. The full details of the derivation of the
radial selection function can be found in Appendix A.4, including both evolution and K-corrections. Our basic sample
has magnitude limits r  14:5 at the bright end (since the
survey becomes incomplete for bright galaxies with large
angular size) and r  17:5 at the faint end (Appendix A.4).
Figure 4 shows all galaxies within 5 of the equator in a pie
diagram, color coded by their absolute magnitude, and illustrates one of the fundamental challenges for our project (and
indeed for the analysis of any ﬂux-limited sample): luminous
Summary of Galaxy Samples
Sample Name
Absolute Magnitude
Apparent Magnitude
All ............................................
r < 17.517.77
safe0 .........................................
14.50 < r < 17.50
safe13 .......................................
23 < M0.1r < 18.5
14.50 < r < 17.50
0.001 < z < 0.400
safe22 .......................................
22 < M0.1r < 19.0
14.50 < r < 17.50
0.001 < z < 0.400
Baseline....................................
23 < M0.1r < 18.5
14.50 < r < 17.50
0.002 < z < 0.210
Angular Subsamples
A1 (south)................................
23 < M0.1r < 18.5
14.50 < r < 17.50
0.017 < z < 0.210
A2 (north) ................................
23 < M0.1r < 18.5
14.50 < r < 17.50
0.017 < z < 0.210
A3 (north equatorial) ...............
23 < M0.1r < 18.5
14.50 < r < 17.50
0.017 < z < 0.210
A4 (north rest) .........................
23 < M0.1r < 18.5
14.50 < r < 17.50
0.017 < z < 0.210
Radial Subsamples
R1 (near) ..................................
23 < M0.1r < 18.5
14.50 < r < 17.50
0.017 < z < 0.078
R2 (middle)..............................
23 < M0.1r < 18.5
14.50 < r < 17.50
0.078 < z < 0.117
R3 (far) ....................................
23 < M0.1r < 18.5
14.50 < r < 17.50
0.117 < z < 0.210
Luminosity (Volume-limited) Subsamples
L1.............................................
17 < M0.1r < 16
14.50 < r < 17.50
0.008 < z < 0.017
L2.............................................
18 < M0.1r < 17
14.50 < r < 17.50
0.011 < z < 0.027
L3.............................................
19 < M0.1r < 18
14.50 < r < 17.50
0.017 < z < 0.042
L4.............................................
20 < M0.1r < 19
14.50 < r < 17.50
0.027 < z < 0.065
L5.............................................
21 < M0.1r < 20
14.50 < r < 17.50
0.042 < z < 0.103
L6.............................................
22 < M0.1r < 21
14.50 < r < 17.50
0.065 < z < 0.157
L7.............................................
23 < M0.1r < 22
14.50 < r < 17.50
0.104 < z < 0.238
L8.............................................
24 < M0.1r < 23
14.50 < r < 17.50
0.164 < z < 0.349
Mock Samples
M1–M275 (PTHalos) ..............
0.015 < z < 0.240
V1–V10 (VIRGO)...................
0.001 < z < 0.150
Note.—The table summarizes the various galaxy samples used in our analysis, listing cuts made on evolution-corrected absolute magnitude
M0:1r (for h ¼ 1), apparent magnitude r, and redshift z. M0:1r was computed from r and z assuming a ﬂat cosmological model with  ¼ 0:7.
TEGMARK ET AL.
galaxies dominate the sample at large distances, and dim ones
dominate nearby. A measurement of the power spectrum on
very large scales is therefore statistically dominated by luminous galaxies, whereas a measurement on small scales is
dominated by dim ones (since they have much higher number
density). Yet it is well known that luminous galaxies cluster
more than dim ones , so
when comparing PðkÞ on large and small scales we are in
effect comparing apples with oranges and may mistakenly
conclude that the power spectrum is red-tilted (with a spectral
index n ¼ 0:94, say) even if the truth is n ¼ 1. Thus far, no
magnitude-limited galaxy power spectrum analysis has been
corrected for this effect. We do so in x 5. Although this effect
is not large in an absolute sense, we ﬁnd that it must nonetheless be included for precision cosmology applications.
The ﬁrst step is to quantify the luminosity dependence of
bias. For this purpose, we deﬁne a series of volume-limited
samples as speciﬁed in Table 1, constructed by discarding all
galaxies that are too faint to be included at the far limit or too
bright to be included at the near limit. This gives a radial
selection function (Fig. 3) that is constant within the radial
limits and zero elsewhere. The radial limits are set so that
galaxies at the far (near) radial limit and the dim (luminous)
end of the absolute magnitude range in question have ﬂuxes at
the faint (bright) ﬂux limit. Because the ﬂux range 14:5 < r <
17:5 spans exactly 3 mag, these subsamples overlap spatially
only with their nearest neighbor samples and have a near limit
Fig. 1.—Top: Angular completeness map, the relative probabilities that galaxies in various directions get included, in Hammer-Aitoff projection in equatorial
coordinates on a gray scale ranging from black (0) to white (1). It is this completeness map that we expand in spherical harmonics. The backdrop is the logarithm of
the dust map from Schlegel et al. , indicating which sky regions are most likely to be affected by extinction-related systematic errors. [See the electronic
edition of the Journal for a color version of this ﬁgure.] Bottom: Complex nature of the completeness map and the high average completeness with a zoom of a small
sky region.
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
that would be equal to the far limit of the sample that is two
notches more luminous if it were not for evolution and
K-corrections. This is clear in Figures 5 and 6. These samples
have the advantage that the measured clustering is that of a
well-deﬁned set of objects whose selection is redshift independent. Although we have not accounted for our surface
brightness limits in deﬁning these samples, very few of even
the lowest luminosity galaxies in our sample are affected by
the surface brightness limits of the survey .
3. METHOD AND BASIC ANALYSIS
We now turn to our basic goal: accurately measuring the
shape of the matter power spectrum PðkÞ on large scales by
using the data described above, i.e., measuring a curve that
equals the large-scale matter power spectrum up to an unknown overall multiplicative bias factor that is independent of
scale. This involves four basic challenges: (1) accounting for
the complicated survey geometry, (2) correcting for the effect
of redshift-space distortions, (3) correcting for bias effects,
which as described in x 5 cause an artiﬁcial red-tilt in the
power spectrum, and (4) checking for potential systematic
errors. Before delving into detail, let us summarize each of
these challenges and how we will tackle them.
3.1. Battle Plan
3.1.1. Survey Geometry and Method of Estimating Power
It is well known that since galaxies in a redshift survey
probe the underlying density ﬁeld only in a ﬁnite volume, the
power spectrum estimated with traditional Fourier methods
 
is complicated to interpret: it corresponds to a smeared out
version of the true power spectrum, can underestimate power
on the largest scales because of the so-called integral constraint , and has correlated errors.
Fig. 2.—Redshift distribution of the galaxies in sample safe13 shown as a
histogram and compared with the expected distribution in the absence of
clustering, ln 10¯nðrÞr3 d (solid curve) in comoving coordinates assuming
a ﬂat  ¼ 0:7 cosmology. Bottom: Ratio of observed and expected distributions. The vertical lines indicate the redshift limits ð50 h1 Mpc < r <
600 h1 MpcÞ employed in the baseline analysis. This near cut removes only
22 galaxies, the far cut, 3295. [See the electronic edition of the Journal for a
color version of this ﬁgure.]
Fig. 3.—Same as Fig. 2 but plotted as comoving number density. The gray
(background) histogram shows the full ﬂux-limited sample, and the others
show the volume-limited subsamples, with lines indicating their predicted
constant selection functions. [See the electronic edition of the Journal for a
color version of this ﬁgure.]
Fig. 4.—Distribution of 67,676 galaxies within 5 of the equatorial plane,
color coded by their absolute magnitudes. Mr in the ﬁgure refers to the absolute r-magnitude K-corrected to z ¼ 0:1. [See the electronic edition of the
Journal for a color version of this ﬁgure.]
TEGMARK ET AL.
We therefore measure power spectra with an alternative,
matrix-based approach, which, although more numerically
demanding, has several advantages on the large scales that are
the focus of this paper. It facilitates tests for radial and angular
systematic errors. If galaxies were faithful tracers of mass,
then it would produce unbiased minimum-variance power
spectrum measurements with uncorrelated error bars that are
smaller than those from traditional Fourier methods. The
power smearing is quantiﬁed by window functions that are
both narrower than with traditional Fourier methods and can
be computed without need for approximations or Monte
Carlo simulations. (We do, however, use Monte Carlo simulations in x 4 to verify that the method and software work
as advertised.)
3.1.2. Redshift-Space Distortions
Our basic input data consist of galaxy positions r in threedimensional ‘‘redshift space,’’ where the comoving distance
r ¼ jrj is that which would explain the observed redshift if the
galaxy were merely following the Hubble ﬂow of the expanding
universe. The same gravitational forces that cause galaxies to
cluster also cause them to move relative to the Hubble ﬂow, and
these so-called peculiar velocities make the clustering in redshift space anisotropic . Although this effect can be modeled and accounted for exactly on
very large scales on which the clustering is linear ,
nonlinear corrections cannot be neglected on some of the scales
of interest to us . Section 4 is
devoted to dealing with this complication, going beyond the
Kaiser approximation with a three-pronged approach:
1. We precede our power spectrum analysis by a nonlinear
‘‘ﬁnger-of-God’’ compression step with a tunable threshold, to
quantify the sensitivity of our results to nonlinear galaxy
groups and clusters.
2. We measure three power spectra (galaxy-galaxy, galaxyvelocity, and velocity-velocity spectra) rather than one, quantifying the clustering anisotropy and allowing the real-space
power to be reconstructed beyond linear order.
3. We analyze an extensive set of mock galaxy catalogs to
quantify the accuracy of our results and measure how the
nonlinear correction factor grows toward smaller scales.
Our mock analysis will also allow us to quantify the effects of
nonlinear clustering on the error bars and band-power correlations. Step 1 is optional, and we present results both with
and without it.
3.1.3. Bias
All we can ever measure with galaxy redshift surveys is
galaxy clustering, whereas what we care about for constraining cosmological models is the clustering of the underlying matter distribution. Our ability to do cosmology with
the real-space galaxy power spectrum PggðkÞ is therefore only
as good as our understanding of bias, i.e., the relation of
PggðkÞ to the matter power spectrum PðkÞ. Pessimists have
often argued that since we do not understand galaxy formation at high precision, we cannot understand bias accurately
either, so galaxy surveys will be relegated to a historical
footnote, having no role to play in the precision cosmology
era. Optimists retort that no matter how complicated the
gasdynamical and radiative processes involved in galaxy
formation may be, they have only a ﬁnite spatial range (a few
h1 Mpc, say), leading to a generic prediction that bias on
much larger scales (>20 h1 Mpc, say) should be scale independent for any particular type of galaxy . This theoretical expectation is supported by visual inspection of the galaxy
Fig. 5.—Distribution of galaxies within 5 of the equatorial plane for the
volume-limited subsamples L1, L3, L5, and L7 from Table 1. [See the electronic edition of the Journal for a color version of this ﬁgure.]
Fig. 6.—Distribution of galaxies within 5 of the equatorial plane for the
remaining four volume-limited subsamples from Table 1, i.e., L2, L4, L6, and
L8. [See the electronic edition of the Journal for a color version of this ﬁgure.]
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
distribution. Comparing early- and late-type galaxies in the
2dFGRS shows that
whereas the small-scale distribution differs (elliptical galaxies display a more ‘‘skeletal’’ distribution than do clustershunning spiral galaxies), their large-scale clustering patterns
are indistinguishable.
We devote x 5 to the bias issue, arguing that both the pessimists and the optimists have turned out to be right: yes,
biasing is indeed complicated on small scales (where the
galaxy power spectrum will therefore teach us more about
galaxy formation than about cosmology), but no, this in no
way prevents us from doing precision cosmology with the
galaxy power spectrum on very large scales. Our main tool is
analyzing our volume-limited magnitude subsamples, showing that their large-scale power spectra are consistent with all
having the same shape and differing merely in amplitude.
Although the argument above for scale-independent bias
holds only for a volume-limited subsample, we wish to use
our full galaxy sample over a broad range of redshifts, both to
expand the range of k-scales probed and to reduce shot noise.
We therefore use our measured luminosity dependence of
bias to compute and remove the artiﬁcial red-tilt in our full
magnitude-limited baseline sample.
In future papers, we will constrain galaxy bias empirically
by using clustering measurements on smaller scales , which will allow us to
calculate the effects of scale-dependent bias on the power
spectrum in the nonlinear regime and thus to extend the
measurement of the matter power spectrum shape to smaller
3.1.4. Systematic Errors
As the old saying goes, the devil you know poses a lesser
threat than the devil you do not. We therefore devote x 6 to
testing for the sort of effects that are not included in our Monte
Carlo simulations. This includes both radial modulations (due
to misestimates of evolution or K-corrections) and angular
modulations (due to effects such as uncorrected dust extinction,
variable observing conditions, photometric calibration errors,
and ﬁber collisions). Our tests use two basic approaches:
1. Analyzing subsets of galaxies.—We compare the power
spectra from different parts of the sky (subsamples A1–A4
from Table 1) and different distance ranges (subsamples R1–
R3) looking for inconsistencies.
2. Analyzing subsets of modes.—We look for excess power
in purely angular and purely radial modes of the density ﬁeld,
which act like lightning rods for angular and radial modulations
such as those mentioned above.
3.2. Three-Step Power Spectrum Estimation
Our matrix-based power spectrum estimation approach is
described in Tegmark et al. . It starts by expanding the
galaxy density ﬁeld in a set of functions known as pseudo–
Karhunen-Loe`ve eigenmodes. This step compresses the data
set into a much smaller size (from hundreds of thousands of
galaxy coordinates to a few thousand expansion coefﬁcients)
while retaining the large-scale cosmological information in
which we are interested. It also reduces the power spectrum
estimation problem to a mathematical form equivalent to that
encountered in CMB analysis, enabling us to take advantage
of a powerful set of matrix-based tools that have been fruitfully employed in the CMB ﬁeld. Our basic analysis in the
remainder of this section therefore consists of the following
three steps:
1. Finger-of-God compression to remove redshift-space
distortions due to virialized structures (x 3.3).
2. Pseudo–Karhunen-Loe`ve eigenmode expansion (x 3.4).
3. Power spectrum estimation using quadratic estimators
As mentioned, the third step measures not one but three power
spectra, encoding clustering anisotropy that contains information about redshift-space distortions. In this section, we
merely present the basic measurement of these three curves,
which involves no assumptions about linearity, the nature of
biasing, or anything else. We then return to modeling and
interpreting these curves in terms of real-space power in x 4
and to bias modeling in x 5.
3.3. Step 1: Finger-of-God Compression
Since our analysis method is motivated by (although not
limited to) the linear Kaiser approximation for redshift-space
distortions, it is crucial that we be able to empirically quantify
our sensitivity to the so-called ﬁnger-of-God (FOG) effect,
whereby radial velocities in virialized clusters make them
appear elongated along the line of sight. We therefore start our
analysis by compressing (isotropizing) FOGs, as illustrated in
Figure 7. The FOG compression involves a tunable threshold
density, and in x 4 we study how the ﬁnal results change as we
gradually change this threshold to include lesser or greater
numbers of FOGs.
We use a standard friends-of-friends algorithm, in which
two galaxies are considered friends, therefore in the same
cluster, if the density windowed through an ellipse 10 times
longer in the radial than transverse direction, centered on the
pair, exceeds a certain overdensity threshold. To avoid linking
well-separated galaxies in deep, sparsely sampled parts of the
survey, we impose the additional constraint that friends should
be closer than r? max ¼ 5 h1 Mpc in the transverse direction.
The two conditions are combined into the following single
criterion: two galaxies separated by rjj in the radial direction
and by r? in the transverse direction are considered friends if
3 ¯nð1þ cÞþ r3
where ¯n is the three-dimensional selection function at the
position of the pair and c is an overdensity threshold. Note
that c represents not the overdensity of the pair as seen in
redshift space but rather the overdensity of the pair after their
radial separation has been reduced by a factor of 10. Thus, c
is intended to approximate the threshold overdensity of a
cluster in real space. We have chosen r? max somewhat larger
than the virial diameter of typical clusters to be conservative,
minimizing the risk of missing FOGs—for our baseline
threshold c ¼ 200, our results are essentially unaffected by
this choice of r? max. Having identiﬁed a cluster by friends-offriends in this fashion, we measure the dispersion of galaxy
positions about the center of the cluster in both radial and
transverse directions. If the one-dimensional radial dispersion
exceeds the transverse dispersion, then the cluster is deemed a
FOG, and the FOG is then compressed radially so that the
cluster becomes round, that is, the transverse dispersion
equals the radial dispersion. We perform the entire analysis
5 times, using density cutoffs 1 þ c ¼ 1, 200, 100, 50, and
TEGMARK ET AL.
25, respectively; in our analyses below, we explore the sensitivity of our results to this cutoff. The inﬁnite threshold
1þ c ¼ 1 corresponds to no compression at all.
Figure 7 illustrates FOG compression with threshold density 1þ c ¼ 200, and unless explicitly stated otherwise, all
results presented in this paper are for this threshold density.
We make this choice to be on the safe side: Bryan & Norman
 estimate that the overdensity of a cluster at virialization
is about 337 in a CDM model, rising further as the universe
expands and the background density continues to drop.
3.4. Step 2: Pseudo-KL Pixelization
The raw data consist of three-dimensional vectors r ,
 ¼ 1, : : : , Ngal, giving the measured positions of each galaxy
in redshift space, with the number of galaxies Ngal given in
Table 1 for each sample. As in Tegmark et al. , we
expand the observed three-dimensional density ﬁeld in a basis
of Nx noise-orthonormal functions i, i ¼ 1 , : : : , Nx,
¯nðrÞ iðrÞ d3r;
and work with the Nx-dimensional data vector x of expansion
coefﬁcients instead of the 3
Ngal numbers r . Here ¯n is
the three-dimensional selection function described in x 2; i.e.,
¯nðrÞ dV is the expected (not the observed) number of galaxies
in a volume dV about r in the absence of clustering, and the
integration is carried out over the volume V of the sample
where the selection function ¯nðrÞ is nonzero. We frequently
refer to the functions i as ‘‘modes.’’ As we see below, these
modes play a role quite analogous to pixels in CMB maps,
with the variance of xi depending linearly on the power
spectrum that we wish to measure.
Galaxies are (from a cosmological perspective) -functions
in space, so the integral in equation (2) reduces to a discrete
sum over galaxies. We do not rebin the galaxies spatially,
which would artiﬁcially degrade the resolution. It is convenient to isolate the mean density into a single mode 1ðrÞ ¼
¯nðrÞ, with amplitude
nðrÞ d3r ¼ Ngal;
and to arrange for all other modes to have zero mean
iðrÞ d3r ¼ 0;
The covariance matrix of the vector x of amplitudes is a sum
of noise and signal terms
hxxti ¼ C  N þ S;
where the shot-noise covariance matrix is given by
Fig. 7.—Effect of our FOG removal shown in part of the equatorial slice jj < 5 (left) before and (right) after FOG compression. Top, All 67,626 galaxies in the
slice; bottom, 28,255 that are identiﬁed as belonging to FOGs (with density threshold 200).
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
and the signal covariance matrix is
ˆ iðkÞ ˆ jðkÞPggðkÞ d3k
in the absence of redshift-space distortions (which are
included in x 3.5). Here hats denote Fourier transforms,
and the asterisk denotes complex conjugation. PggðkÞ is the
(real-space) galaxy power spectrum, which for a random
ﬁeld of density ﬂuctuations ðrÞ is deﬁned by h ˆðkÞ ˆðk0Þi ¼
ð2Þ3Diracðk  k0ÞPggðkÞ. We take the functions i to have
units of inverse volume, so x, N, S, and ˆ i are all dimensionless.
Our method requires computing the signal covariance
matrix S, both to calculate power spectrum error bars and to
ﬁnd the power spectrum estimator that minimizes them.
Equation (7) shows that this requires assuming a power
spectrum PggðkÞ. For this spectrum, which we refer to as our
‘‘prior,’’ we use a simple two-parameter ﬁt as described in
x B.4.1, whose parameters are determined from our measurements by iterating the entire analysis.
As our functions iðrÞ, we use the pseudo–Karhunen-
Loe`ve (PKL) eigenmodes deﬁned in Hamilton, Tegmark, &
Padmanabhan and Tegmark et al.
 . The construction of these PKL
modes iðrÞ explicitly uses the three-dimensional selection
function ¯nðrÞ but is model independent since it does not depend on the power spectrum.
To provide an intuitive feel for the nature of these modes,
a sample is plotted in Figures 8 and 9. We use these modes
because they have the following desirable properties:
1. They form a complete set of basis functions probing
successively smaller scales, so that a ﬁnite number of them (we
use the ﬁrst 4000, for the reasons given in x B.4.2) allow
essentially all information about the density ﬁeld on large
scales to be distilled into the vector x.
2. They are orthonormal with respect to the shot noise, i.e.,
such that equation (6) gives N ¼ I, the identity matrix. The
construction of the modes thus depends explicitly on the survey
geometry as speciﬁed by ¯nðrÞ, and iðrÞ ¼ 0 in regions of
space where ¯nðrÞ ¼ 0.
3. They allow the covariance matrix S to be fairly rapidly
4. They are the product of an angular and a radial part; i.e.,
they take the separable form iðrÞ ¼ iðˆrÞ iðrÞ, which accelerates numerical computations and helps isolate radial and
angular systematic problems.
5. A range of potential sources of systematic problems are
isolated into special modes that are orthogonal to all other
modes. This means that we can test for the presence of such
problems by looking for excess power in these modes and
immunize against their effects by discarding these modes.
We have four types of such special modes:
1. The very ﬁrst mode is the mean density, 1ðrÞ ¼ ¯nðrÞ.
The mean mode is used in determining the maximum likelihood normalization of the selection function but is then discarded from the analysis, since it is impossible to measure the
ﬂuctuation of the mean mode. The idea of solving the so-called
integral constraint problem by making all modes orthogonal to
the mean (eq. ) goes back to Fisher et al. .
2. Modes 2–8 are associated with the motion of the Local
Group through the CMB at 622 km s1 toward (B1950 FK4)
R:A: ¼ 162 , decl: ¼ 27 . To ﬁrst order, these modes are the
only modes affected by misestimates of the motion of the Local
3. Purely radial modes (e.g., mode 468 in Fig. 9) are to ﬁrst
order the only ones affected by misestimates of the radial selection function ¯nðrÞ.
4. Purely angular modes (e.g., mode 859 in Fig. 9) are to
ﬁrst order the only ones affected by misestimates of the angular
selection function ¯nðˆrÞ, as may result from inadequate corrections for, e.g., extinction, the variable magnitude limit, the
Fig. 8.—Sample of four angular pseudo-KL (PKL) modes are shown in
Hammer-Aitoff projection in equatorial coordinates, with gray representing
zero weight and lighter/darker shades indicating positive/negative weight,
respectively. Uniform gray areas are outside the observed region. From top to
bottom, they are angular modes 1 (the mean mode), 3, 35, and 286 and are
seen to probe progressively smaller angular scales. [See the electronic edition
of the Journal for a color version of this ﬁgure.]
TEGMARK ET AL.
variable magnitude completeness, or photometric zero-point
The computation of the modes in practice is described in detail
in THX02 and in even more detail in Hamilton & Tegmark
The pixelized data vector x is shown in Figure 10, and its
distribution is shown in Figure 11. This data compression step
has thus distilled the large-scale information about the galaxy
density ﬁeld from 3Ngal ¼ 429; 942 galaxy coordinates into
4000 PKL coefﬁcients. The order of these coefﬁcients is one
of decreasing scale (increasing k) as is shown in Figure 12. If
there were no cosmological density ﬂuctuations in the survey,
merely Poisson ﬂuctuations, the PKL coefﬁcients xi would be
uncorrelated with unit variance (since N ¼ I), so about 68%
of them would be expected to lie within the dark gray band.
Figure 10 shows that the ﬂuctuations are considerably larger
than Poisson, especially for the largest scale modes (to the
left), demonstrating the obvious fact that cosmological density
ﬂuctuations are present, as expected.
3.5. What We Wish To Measure: Three Power Spectra, Not One
Following HTP00 and THX02, we measure three separate
power spectra, whose ratios encode information about clustering anisotropy due to redshift-space distortions. Let us now
give their deﬁnition and some intuition for how to interpret
On large scales where redshift-space distortions can be
treated in the linear approximation , the signal
covariance matrix S in equation (5) can be generalized from
equation (7) and written in the form
Fig. 9.—Sample of six pseudo-KL modes shown in the equatorial plane. Gray represents zero weight, and lighter/darker shades indicate positive/negative weight,
respectively. Uniform gray areas are outside the volume used. Bottom: Examples of special modes, (left) a purely radial mode and (right) a purely angular mode.
[See the electronic edition of the Journal for a color version of this ﬁgure.]
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
½PggðkÞPggðkÞ þ PgvðkÞPgvðkÞ þ PvvðkÞPvvðkÞ
where PggðkÞ, PgvðkÞ, and PvvðkÞ are three power spectra de-
ﬁned in real space (as opposed to redshift space) and PggðkÞ,
PgvðkÞ, and PvvðkÞ are known dimensionless matrix-valued
functions. We refer to these three power spectra as the galaxygalaxy power, the galaxy-velocity power, and the velocityvelocity power, respectively, or gg, gv, and vv for short.
Speciﬁcally, PggðkÞ is the real-space galaxy power spectrum,
PvvðkÞ is the velocity power spectrum, and PgvðkÞ is the cross
power between galaxies and velocity. More rigorously, ‘‘velocity’’ here refers to minus the velocity divergence H Gv,
which in linear theory is related to the mass (not galaxy)
overdensity  by f  þ H Gv ¼ 0, where H denotes the comoving gradient in velocity units. Here f  0:6
is the dimensionless growth rate for linear density perturbations . The three matrix-valued functions are determined directly from the modes i, i.e., by geometry alone:
ˆ iðkÞ ˆ jðkÞ dk;
ˆ iðkÞ ˆjðkÞ þ ˆiðkÞ ˆ jðkÞ
ˆiðkÞ ˆjðkÞ dk;
in which the velocity mode ˆiðkÞ is related to the position
mode ˆ iðkÞ by 
i ¼ My i;
where My is the Hermitian conjugate of the velocity part of the
linear redshift distortion operator. In the small-angle, or distant
Fig. 12.—Relation between mode number i and physical scale k. The
variance hx2
i i gets nonnegative contributions from all k as per eq. (8). Fifty
percent of the contribution comes from below the solid black curve, which we
can interpret as the median k-value probed by the ith mode. The shaded
regions show percentiles of the contribution: from outside in, they show the
k-ranges giving 99.98%, 99.8%, 98%, 80%, and 60% of the contribution,
respectively. Apart from the ﬁrst eight special modes, the modes are ordered
by increasing median k-value. [See the electronic edition of the Journal for a
color version of this ﬁgure.]
Fig. 10.—Four thousand elements xi (triangles) of the data vector x (the
pseudo-KL expansion coefﬁcients) for the baseline galaxy sample. If there were
no clustering in the survey, merely shot noise, they would have unit variance,
and about 68% of them would lie within the dark gray band. If our prior power
spectrum were correct, then the standard deviation would be larger, as indicated
by the shaded light gray band. To reduce clutter, the modes are (apart from the
ﬁrst eight special modes) ordered by decreasing signal-to-noise ratio, which
corresponds approximately to the ordering by scale in Fig. 12. [See the electronic edition of the Journal for a color version of this ﬁgure.]
Fig. 11.—Gaussianity of ﬂuctuations. The histogram shows the distribution
of the 4000 PKL coefﬁcients xi from the previous ﬁgure after dividing by their
predicted standard deviation C1=2
ii , assuming our prior power spectrum. The
histogram has been normalized to have unit area. The solid curve shows a
Gaussian of unit variance, zero mean, and unit area. [See the electronic edition
of the Journal for a color version of this ﬁgure.]
TEGMARK ET AL.
observer, approximation, the operator M takes the familiar
Kaiser form, a diagonal operator in Fourier space
where k  ˆkGz is the cosine of the angle between the
wavevector k and the line of sight z. Here, however, we do not
assume the small-angle approximation but rather take into
account the full radial nature of redshift distortions. Radial
redshift distortions destroy translation invariance, so the radial
redshift distortion operator is no longer diagonal in Fourier
space, as it is in the small-angle approximation; indeed, the
radial redshift distortion operator takes a rather complicated
form in Fourier space . The radial
redshift distortion operator takes a simpler form in real space,
where M, expressed in the frame of the Local Group, can be
written as the integrodifferential operator 
@r2 þ ðrÞˆr
with ðrÞ the logarithmic derivative of r2 times the selection
function ¯nðrÞ,
ðrÞ  @ ln ½r2¯nðrÞ
The @=@rjr¼0 term inside parentheses in equation (14), which
subtracts from the ﬁrst term @=@r its value at the position
r ¼ 0 of the Local Group, is the term that arises from the
motion of the Local Group. The Hermitian conjugate My,
which enters equation (12) for the velocity mode i, can be
written 
My ¼ r2r2 @
in which the last term is again the term arising from the motion of the Local Group.
Although the deﬁnition of these three power spectra
assumes that redshift distortions conform to the linear Kaiser
model, they measure useful information from the data even if
the linear model fails. In the small-angle (distant observer)
approximation, they reduce to simple linear combinations of
the monopole, quadrupole, and hexadecapole power spectra in
redshift space :
Whereas the vector on the right-hand side is closer to the
measurements (and also more familiar in the literature), the
vector on the left-hand side is closer to the physics of linear
redshift distortions. Indeed, inverting equation (17),
we see that we can use this last equation as an improved deﬁnition of monopole, quadrupole, and hexadecapole, remaining
valid even in the regime where the small-angle approximation
fails. For the reader more used to thinking in terms of the
multipole formalism, the bottom line is that our main measurement PggðkÞ is basically the monopole power minus half the
quadrupole power plus 3
8 of the hexadecapole power, as per
equation (17).
Because redshift distortions displace galaxies only along
the line of sight, the transverse, or angular, power spectrum
is completely unaffected by redshift distortions, a point emphasized by Hamilton & Tegmark . In the small-angle
approximation, the galaxy-galaxy power spectrum equals the
redshift-space power spectrum in the transverse direction,
PggðkÞ ¼ P sðk ¼ 0Þ ¼
ð1Þ‘=2ð‘ 1Þ!!
which is true in all circumstances, linear or nonlinear, regardless of the character of redshift distortions. The coef-
ﬁcients of the expansion (19) are the values of Legendre
polynomials P‘ðkÞ in the transverse direction k ¼ 0. The
ﬁrst few terms of the expansion (19) are
PggðkÞ ¼ P s
6ðkÞ þ : : : ;
which shows that our linear estimate of PggðkÞ is effectively
the expansion (19) truncated at the ‘ ¼ 4 harmonic, as predicted by linear theory . We expect on general
grounds that the linear estimate of PggðkÞ will underestimate
the true galaxy-galaxy power spectrum at nonlinear scales
 , although this underestimate
should be mitigated by FOG compression.
In x 4, we demonstrate with Monte Carlo simulations that
Pgg faithfully recovers the true real-space galaxy power
spectrum on large scales, and we quantify what constitutes
‘‘large,’’ ﬁnding accurate recovery on substantially smaller
scales than those on which the Kaiser approximation is valid.
A wide range of approximations for Pgv and Pvv have been
introduced in the literature. By using our notation, the Kaiser
 approximation becomes simply
PgvðkÞ ¼ ðkÞrðkÞPggðkÞ;
PvvðkÞ ¼ ðkÞ2PggðkÞ;
where ðkÞ  f =bðkÞ, bðkÞ is the bias factor, rðkÞ is the dimensionless correlation coefﬁcient between the galaxy and
matter density , and f  0:6
m was deﬁned above. Since both b
and r can in principle depend on scale, we have two unknown
functions ðkÞ and rðkÞ that can in principle be determined
uniquely from the two measured ratios PgvðkÞ=PggðkÞ and
PvvðkÞ=PggðkÞ in the Kaiser approximation. Further popular
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
approximations in the literature are that both b and r are
constant, and most workers also assume r ¼ 1 despite some
observational and
simulational evidence that r may be of the order of
0.9 for some galaxies.25
We do not make any of these approximations in our basic
data analysis, simply reporting measurements of PggðkÞ, PgvðkÞ,
and PvvðkÞ from the SDSS data. In x 4 we use the approximation
that ‘ > 4 anisotropies are negligible, assessing its accuracy
with Monte Carlo simulations and tunable FOG compression,
but the reader wishing to avoid approximations can simply ﬁt
better simulations directly to our three measured curves. Speciﬁcally, using an axis of a periodic cube as the line-of-sight
direction, so that the distant observer approximation holds
perfectly, one can compute the monopole, quadrupole, and
hexadecapole components of the redshift-space power spectrum and transform them to Pgg, Pgv, and Pvv via equation (17).
3.6. Step 3: Power Spectrum Estimation
All our information about the SDSS density ﬁeld is encoded
in the 4000-dimensional vector x plotted in Figure 10, and
equation (8) shows that the covariance matrix of x depends
linearly on the three power spectra that we want to measure.
We wish to invert equations (5) and (8) to estimate the power
spectra from the data vector. This problem is mathematically
equivalent to that of measuring the power spectrum from a
CMB map and can be solved optimally with so-called quadratic estimators . We describe our analysis method in full detail in Appendix B. However, since it is important for the interpretation,
let us brieﬂy review here how the measurements are computed
from the input data x.
We parameterize our three power spectra by their amplitudes in 97 separate logarithmically spaced k-bands as detailed
in Appendix B, so our goal is to measure 3
97 ¼ 291 band
powers pi, i ¼ 1, : : : , 291. Quadratic estimators ˆpi are simply
quadratic functions of the data vector x, and the most general
unbiased case can be written as
ˆpi  xtQi x  tr ðNQiÞ
for some symmetric N
N –dimensional matrices Qi; the
second term merely subtracts the expected contribution from
shot noise.
The basic idea behind quadratic estimators is that each
matrix Qi can be chosen to effectively Fourier transform the
density ﬁeld, square the Fourier modes in the ith power
spectrum band, and average the results together, thereby
probing the power spectrum on that scale. Grouping the
parameters pi and the estimators ˆpi into vectors denoted p and
ˆp, the expectation value and covariance of the measurements
is given by
h ˆpi ¼ Wp;
cov ð ˆpÞ  h ˆpˆpti  h ˆpih ˆpit ¼ 2;
where the matrices W and 2 can be computed from the Qi
matrices and the geometry alone via equations (B3) and (B4)
in Appendix B.
As detailed in Appendix B, there are several attractive
choices of Q matrices, each giving different desirable properties to the matrices W and 2. Figure 13 shows the power
spectrum measurements ˆp for the baseline galaxy sample by
using the choice of Qi that gives the smallest error bars, and
Figure 14 shows them by using a better choice described
Although Figure 13 looks impressive, it fails to convey
two important complications. The ﬁrst is that the error bars
are strongly correlated between neighboring bands; i.e., the
covariance matrix 2 is far from diagonal. The second complication involves the matrix W, known as the window matrix.
The Q matrices are normalized so that each row of the window
matrix sums to unity. Equation (24) shows that this normalization enables us to interpret each band power measurement
ˆpi as a weighted average of the true power spectrum pj, the
elements of the ith row of W giving the weights (the so-called
window function). In short, the window functions connect our
measurements ˆp to the underlying power spectrum parameters
p. The windows are plotted in Figure 15, and we see that they
are complicated in two different ways, making Figure 13 hard
to interpret:
1. Smearing.—They have a nonzero width k, so that our
estimate of the power on some scale k is really the weighted
average of the power over a range of scales around k. In other
words, Figure 13 shows a measurement of the true power
spectrum that has been smoothed and convolved with rather
broad window functions.
2. Leakage.—They mix the gg, gv, and vv power spectra, so
that a nominal estimate of gv, say, is really a weighted average
of gg, gv, and vv power. This is why the signal-to-noise ratio of
gv and vv appears so high in Figure 13.
As described in Appendix B, both the correlation problem
and the smearing problem can be tackled in one fell swoop
with a better choice of quadratic estimators that give uncorrelated error bars and narrower window functions, shown in
Figure 16, and the leakage problem can be solved as shown
in Figure 17. This choice makes the covariance matrix 2 for
the measured vector ˆp diagonal (combining shot noise and
sample variance errors), so it is completely characterized by
its diagonal elements, given by the error bars in Table 2 and
Figure 14. A clearer and less cluttered view of a sample window function for this uncorrelated case is given in Figure 18
(top left). We see that such a window is almost never negative,
and tends to be sharply peaked around the k-value that it is
designed to probe.26
Let us now turn to the remaining problem: leakage. The
leakage results from a combination of two effects: difﬁculties
in separating the monopole, quadrupole, and hexadecapole
power given the complicated survey geometry and the mixing
of these three multipoles given by equation (17). Figures 15,
25 Although r < 1 is normally referred to as stochastic bias, this does of
course not imply any randomness in the galaxy formation process, merely that
additional factors besides the present-day dark matter density may be important (gas temperature, say). The evidence for r < 1 thus far comes from
scales smaller than those that are the focus of this paper. More details on the
relationship between our three power spectra and the stochastic bias formalism
are given in x 3.4 of THX02.
26 Its characteristic width k corresponds roughly to the inverse width of
the survey volume in its narrowest direction , so the windows
will get narrower as the SDSS becomes more complete and the thin sky slices
seen in Fig. 1 thicken and merge. Windows farther to the left are slightly
narrower (when plotted on a linear k-scale as opposed to the logarithmic scale
used here), since they probe more distant galaxies and hence a larger effective
volume. However, since our sample contains very few galaxies with z 3 0:2,
the window width k approaches a constant as we keep moving to the left in
Fig. 16, causing the windows to look wider on our logarithmic axis.
TEGMARK ET AL.
16, and 17 show the ith window function (the ith row of the W
matrix) as three curves plotted in the top, middle, and bottom
panels, giving the sensitivity of the estimator ˆpi to gg, gv, and
vv power, respectively. If there were no leakage, then all
curves in the six off-diagonal panels in these ﬁgures would be
identically zero. This is not the case, but the area under the
curves is much reduced in the off-diagonal panels, as is shown
by comparing the leftmost and middle panels of Figure 19.
Switching to uncorrelated quadratic estimators causes a substantial leakage reduction as a side beneﬁt, but that leakage is
still nonnegligible: for instance, an estimate of the gg power is
seen to give about 15% weight to Pgv and about 2% weight to
Pvv, with these percentages depending only weakly on k.
As detailed in Appendix B, we can eliminate the leakage
problem and measure one power spectrum, say, PggðkÞ, without
any assumptions about the other two by effectively marginalizing over their amplitudes separately for each k-band. This
procedure is equivalent to yet another choice of the Q matrices,
which we refer to as ‘‘disentangled .’’ As seen in Figure 17 and
Figure 19 (right), it eliminates leakage completely in the sense
that all unwanted (off-diagonal) window functions have zero
area. The basic idea of the disentanglement procedure is
illustrated in Figure 18: since the gg, gv, and vv components
of the window function have very similar shape, differing
Fig. 14.—Decorrelated and disentangled measurements of (top) the galaxygalaxy power spectrum, (middle) the galaxy-velocity power spectrum, and
(bottom) the velocity-velocity power spectrum for the baseline galaxy sample.
Each point is plotted at the k-value that is the median of its window function,
and the horizontal bars range from the 20th to the 80th percentile of the
window function. The values of PggðkÞ are given in Table 3. From top to
bottom, the three curves show our prior for PggðkÞ, PgvðkÞ, and PvvðkÞ. Note
that most of the information in the survey is in the galaxy-galaxy spectrum.
Band power measurements with very low information content have been
binned into fewer (still uncorrelated) bands. All these measurements are for
our baseline FOG compression threshold of 200. Unlike Fig. 13, these points
are uncorrelated (affecting all three panels), and the leakage between gg, gv,
and vv has been removed (affecting mostly the lower panels), giving much
larger (and easier to interpret) error bars. [See the electronic edition of the
Journal for a color version of this ﬁgure.]
Fig. 13.—Minimum-variance quadratic estimators ˆpi nominally measuring
(top) the galaxy-galaxy power spectrum, (middle) the galaxy-velocity power
spectrum, and (bottom) the velocity-velocity power spectrum for the baseline
galaxy sample. They cannot be directly interpreted as power spectrum
measurements, since each point probes a linear combination of all three power
spectra over a broad range of scales, typically centered at a k-value different
than the nominal k where it is plotted. Moreover, nearby points are strongly
correlated, causing this plot to overrepresent the amount of information
present in the data. The solid curves show the window-convolved prior power
spectrum Wp, and the dashed curve shows the shot-noise contribution subtracted out. [See the electronic edition of the Journal for a color version of this
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
essentially only in amplitude, it is possible to form linear
combinations of them that for all practical purposes vanish.
In forming these linear combinations, we do introduce statistical correlations between PggðkÞ, PgvðkÞ, and PvvðkÞ at a
given value of k; the values at different values of k remain
uncorrelated.
In summary, we have measured the three power spectra
PggðkÞ, PgvðkÞ, and PvvðkÞ, obtaining the results shown in
Figure 14. These basic measurements are given in Table 2.27
The measurements make no assumptions whatsoever about
redshift-space distortions, and the issue of whether the density
ﬂuctuations are Gaussian affects only the error bars, not the
measurements themselves.
In the next section, we model the effect of redshift distortions and make what we argue is a more accurate estimate
of PggðkÞ. However, the conservative reader trusting only
her/his own modeling can in principle stop right here and ﬁt
simulations directly to our measurements from Figure 14,
which are given in Table 2.
4. ACCOUNTING FOR REDSHIFT SPACE DISTORTIONS
Thus far, we have measured the SDSS galaxy power spectrum and its redshift-space anisotropy, encoded in the three
functions PggðkÞ, PgvðkÞ, and PvvðkÞ. In the present section, we
focus on this anisotropy to model, quantify, and correct for the
effects of redshift-space distortions, producing an estimate of
the true real-space galaxy power spectrum, Pggtrue ðkÞ. We use
Fig. 15.—By using the correlated minimum-variance estimators, the window functions are shown for those k-bands with nonnegligible information content.
The ith row of W typically peaks at the ith band, the scale k that the band power estimator ˆpi was designed to probe. The three rows correspond to the
estimators of gg, gv, and vv power, and the three columns, to their sensitivity to gg, gv, and vv power. For example, the window function of the quadratic
estimator targeting PgvðkÞ at k ¼ 0:1 h Mpc1 is given by the three curves in the middle column peaking at k ¼ 0:1 h Mpc1 (top, middle, and bottom panels),
and the normalization is such that the sum of the areas under these three curves is unity. [See the electronic edition of the Journal for a color version of this
27 Also available at together
with their window matrix and likelihood calculation software, incorporating
the bias correction described in x 5.
TEGMARK ET AL.
Monte Carlo simulations to assess the accuracy of two alternative approaches:
1. Disentanglement approach.—Perform FOG compression, then simply use PggðkÞ from Figure 14 as the estimator
of Pggtrue ðkÞ.
2. Modeling approach.—Perform FOG compression, then
make the Kaiser approximation of equations (21) and (22) with
the best-ﬁt constant values of  and r to eliminate PgvðkÞ and
PvvðkÞ from the problem, solving for the 97 decorrelated
measurements of Pggtrue ðkÞ (see Appendix B and THX02 for
The difference between the two approaches is essentially between marginalizing over the other two power spectra [PgvðkÞ
and PvvðkÞ] and modeling them. Both approaches break down
on small scales, so we focus on quantifying their accuracy as
a function of k. We see that although the disentanglement
approach is more robust to nonlinearities, the modeling approach has the advantage of roughly halving the error bars,
corresponding to quadrupling the Fisher information. The
gain comes from using rather than discarding measured information about the amplitudes of the gv and vv power spectra. We
argue that the disentanglement method is overly conservative,
especially on extremely large scales such as k < 0:05 h Mpc1,
where we need all the statistical power that we can get.
There are two separate sources of statistical bias in our
measurement that we quantify below. The ﬁrst is that PggðkÞ
equals the true real-space power only on scales on which the
Kaiser approximation holds, generally underestimating it on
smaller scales. The second occurs only in the modeling approach, which produces a biased measurement of PggðkÞ if the
model parameters  and r are incorrect. Let us begin our
investigation by studying the real data, then turn to Monte
Carlo simulations to better understand and quantify the results.
4.1. Results Based on the Data
Figure 14 shows that whereas we have precise measurements of PggðkÞ, we have rather limited information about
PgvðkÞ and close to no information about PvvðkÞ. Figure 20
shows a slightly less noisy rendition of the same information.
Fig. 16.—Same as Fig. 15, but using decorrelated estimators (before disentanglement). Comparison with Fig. 15 shows that decorrelation makes all windows
substantially narrower. [See the electronic edition of the Journal for a color version of this ﬁgure.]
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
Here we have taken all three curves to have the shape of the
prior power spectrum and plotted their best-ﬁt amplitudes
relative to the prior. These ﬁts are performed cumulatively,
using all measurements for all wavenumbers k. The three
bands give the 1  allowed ranges for gg, gv, and vv, respectively. It is well known that as k increases, nonlinearities
become more important and start reducing gv, eventually
driving it to negative values. This is because the FOG effect
has the opposite sign of the linear Kaiser infall, causing less
rather than more radial power (or larger rather than smaller
radial correlations, for the reader preferring real space over
Fourier space). The fact that Figure 20 does not show this
effect is therefore a ﬁrst encouraging indication that nonlinearities have only a minor impact on our results over the
range of scales that we consider. Since we have used only
4000 PKL modes, most of the information from scales k 3
0:1 h Mpc1 is excluded from our analysis (cf. Fig. 12). The
ﬁgure therefore
stop getting thinner
k 3 0:1 h Mpc1. In other words, the information contained
in our data vector x describes only a highly smoothed version
of the density ﬁeld, where nonlinear effects are small.
The ﬁve thin lines in Figure 20 correspond to our ﬁve FOG
compression thresholds and show several noteworthy things.
First of all, changing the FOG threshold is seen to have a
strong effect on gv but almost no effect on gg (the quantity that
we really care about in this paper), providing another encouraging indication that virialized structures do not pose an
unsurmountable problem for us. Second, more aggressive
FOG removal is seen to raise the gv amplitude. This is the
expected sign of the effect, since it removes (and eventually
overcorrects for) the FOG effect, which suppresses gv. Third,
the gg and gv curve pentuplets are seen to diverge as k
increases, as nonlinearities become more important. For
gv, the spread between the baseline threshold 1 þ c ¼ 200
and the rather extreme neighboring thresholds (100 and 1)
equals the error bar for k  0:3 h Mpc1, suggesting that
nonlinearity-related uncertainties become comparable to statistical uncertainties on this scale when trying to measure the
redshift distortion parameter . For gg, on the other hand, the
statistical uncertainties dominate on all scales to which we are
sensitive. The optimal FOG compression threshold should be
expected to lie somewhere between our options 200 and 1,
Fig. 17.—Same as Fig. 16, but decorrelated and disentangled estimators. Comparison with Fig. 16 shows that disentanglement gives curves in the off-diagonal
panels a vanishing average and almost completely eliminates leakage of gv and vv power into estimators of gg power (left middle and left bottom). [See the
electronic edition of the Journal for a color version of this ﬁgure.]
TEGMARK ET AL.
since 1þ c ¼ 200 is the approximate overdensity of a cluster
that has just formed, and many FOG systems will have formed
earlier and hence have higher overdensities. The other
thresholds plotted, i.e., 100, 50, and 25, are thus more extreme
and eventually unphysical—we have used and plotted them
merely to exaggerate and illustrate the effect of FOG removal
more clearly.
Since vv is so noisy, our main constraint on redshift-space
distortion comes from the ratio of gv to gg power, i.e., on
r ¼ Pgg=Pgv. Figure 21 shows our 1  constraints on r as a
function of the maximal k-band included in a cumulative ﬁt,
discarding the vv information to be conservative. The effect of
FOG removal is seen to be smaller than the statistical errors
for all scales that we consider. Our (loose) constraints agree
well with a previous -measurement from earlier SDSS data
 and also with measurements from the
2dFGRS , assuming that the bias
does not differ dramatically between the r-band–selected
SDSS galaxies and B-band–selected 2dF galaxies. We are
unable to break their near degeneracy and place strong constraints on  and r separately, but a joint likelihood analysis
marginally favors r  1.
Our estimate of the real-space galaxy power spectrum from
the disentanglement approach is simply Figure 14 (top). The
corresponding estimate using the model approach is shown in
Figures 22 and 23; the values are tabulated in Table 3. Here
we use  ¼ 0:5 and r ¼ 1, which provides a good ﬁt to our
data. The measurements are also tabulated in Tables 2 and 3.
Changing these two parameters within their measurement
uncertainty causes an uncertainty of 4% in the overall normalization of the recovered gg power spectrum (which is, of
course, degenerate with a 2% change in the galaxy bias). The
Real-Space Power Spectrum with the Disentanglement Method
ðh1 MpcÞ3
ðh1 MpcÞ3
ðh1 MpcÞ3
0:018þ0:008
0:004............
0:023þ0:009
0:005............
0:028þ0:010
0:005............
0:032þ0:010
0:006............
0:037þ0:011
0:007............
0:042þ0:012
0:008............
0:049þ0:013
0:009............
0:056þ0:014
0:010............
0:065þ0:015
0:012............
0:075þ0:017
0:014............
0:086þ0:019
0:016............
0:100þ0:021
0:018............
0:115þ0:024
0:021............
0:132þ0:027
0:025............
0:153þ0:031
0:030............
0:176þ0:035
0:037............
0:202þ0:039
0:045............
0:232þ0:043
0:058............
0:264þ0:043
0:075............
0:290þ0:047
0:102............
0:022þ0:005
0:005............
0:039þ0:007
0:009............
0:069þ0:011
0:015............
0:120þ0:021
0:028............
0:211þ0:040
0:047............
0:291þ0:047
0:039............
0:067þ0:040
0:034............
0:278þ0:128
0:184............
Note.—P is the 1  error. These values have been corrected for luminositydependent bias by dividing by the square of the last column and thus refer to the
clustering of L galaxies. The k-column gives the median of the window function and
its 20th and 80th percentiles; the exact window functions from 
upenn.edu/~max/sdss.html should be used for any quantitative analysis. The Pgg
errors are uncorrelated with one another but are correlated with the Pgv and Pvv errors.
We recommend using col. (2) for basic analysis. Col. (3) is without FOG removal
(i.e., with threshold c ¼ 1) and is therefore easier to compare against numerical
simulations.
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
corresponding window functions are shown in Figure 24;
compare with Figure 17.
To indicate how linear the ﬂuctuations are on various scales,
Figure 23 shows the square root of the corresponding dimensionless power spectrum, which can be crudely interpreted as
the rms ﬂuctuation on that scale. This ﬂuctuation level is seen to
drop below 10% on the largest scales, k k 0:02 h Mpc1, with
the curve being strikingly different from a power law (more
clearly seen in Fig. 22).28 The nonlinearity transition   1
is seen to occur around k  0:2 h Mpc1, but this is a crude
estimate since what matters is of course the ﬂuctuation level of
the matter, not of the galaxies, and the two differ by the bias
factor. As detailed in x 7, our L galaxies have 8  0:93, so if
8  0:8 for the matter as indicated by many recent CMB,
lensing, and cluster studies , the ﬂuctuations are slightly more
linear than Figure 23 indicates.
To quantify the FOG effect on our recovered real-space
power spectrum, Figure 25 shows the ratio of the measured
power spectrum amplitude to its value with our baseline FOG
compression. Just as we saw in Figure 20, nonlinearities become progressively more important toward smaller scales. Quantitatively, the disentanglement method is seen to be almost
unaffected by FOG compression. Over the range 0:1 h Mpc1 <
k < 0:2 h Mpc1 where the error bars are smallest, changing the
FOG compression threshold within the rather extreme range
100–1 changes the measured ﬂuctuation amplitude by only
about 1%, which should be compared with statistical error bars
of 8% or more. The sensitivity of the modeling method to these
nonlinear effects is slightly greater: 1% at k  0:1 h Mpc1 and
4% at k  0:2 h Mpc1, again letting the FOG threshold vary
across the rather extreme range 100–1.
4.2. Results from Monte Carlo Simulations
We need to quantify how accurately what we measure,
PggðkÞ, recovers what we really care about, i.e., the real-space
matter power spectrum PðkÞ. Nonlinear clustering per se
would not bias quadratic estimators of the power spectrum,
but how much do nonlinearities in the redshift-space distortions affect the results? Figure 25 shows that the sensitivity
of the PggðkÞ measurement to FOG nonlinearities is around
1% at k  0:1 h Mpc1, i.e., negligible compared with our
statistical measurement errors. Although FOGs are perhaps the
most important way in which nonlinear redshift distortions
manifest themselves, mildly nonlinear effects on larger scales
are also important , obtaining a curvature d log P=d log k ¼ 1:28  0:49. For a
Markov chain with 106 models, 99.9% had  < 0, thereby driving yet another
nail into the cofﬁn of the fractal universe hypothesis and any other models
predicting a power-law power spectrum ( ¼ 0).
Fig. 18.—Window function for our measurement of the 49th band of the galaxy-galaxy power (left) before and (right) after disentanglement. Whereas unwanted
leakage of gv and vv power is present initially, these unwanted window functions both average to zero afterward. The success of this method hinges on the fact that
since the three initial functions (left) have similar shape, it is possible to take linear combinations of them that almost vanish (right). This procedure is repeated
separately for each k.
TEGMARK ET AL.
2004, in preparation). To be prudent, we therefore complement the above-mentioned tests with a Monte Carlo analysis
in which the true PðkÞ is known and we can directly determine
how well we recover it.
We use two suites of Monte Carlo simulations as summarized in Table 1. The ﬁrst consists of 275 simulations constructed with the PTHalos code ,
covering 1395 deg2 with an angular completeness map
corresponding to the northern part of SDSS sample9, an earlier version of sample11 discussed in Appendix A. In short,
this code is a fast approximate method to build non-Gaussian
density ﬁelds with the halo model. It produces realistic correlation functions and includes nontrivial galaxy biasing by
placing galaxies within dark matter halos with a prescribed
halo occupation number as a function of halo mass. The
second suite of simulated surveys is based on the Hubble
volume CDM n-body simulation . Ten mock surveys were produced by sparsesampling different parts of the simulation cube to reproduce
the three-dimensional selection function
¯nðrÞ for SDSS
sample8, so although these mock surveys include fully nonlinear gravitational clustering, they have trivial light-to-mass bias
with b ¼ r ¼ 1 (the ‘‘galaxies’’ are simply a random subset of
the dark matter particles).
Figure 26 shows that the average PggðkÞ recovered by using
the methodology described in this paper from the PTHalos
simulations agrees with the matter PðkÞ on all relevant scales
to within the sensitivity we can test, as expected given the
above indications that the effect of nonlinearities on Pgg is
small. It also conﬁrms that the analysis pipeline produces
unbiased results (this was also demonstrated with extensive
Monte Carlo simulations in THX02). The mock surveys based
on the Hubble volume simulation give similar agreement, although with larger noise since there are only 10 of them.
Since the possible biases that we wish to quantify are so
small (at the percent level), it is desirable to have still more
statistical testing power than these numerical experiments
provide. In particular, we wish to test the breakdown of the
Kaiser approximation as a function of scale; here we are not
concerned with the effects of the survey geometry. For the 275
PTHalos simulations, we therefore measure the various power
spectra by using all of the roughly 106 galaxies in each of the
Fig. 19.—Leakage is shown for the (left) correlated, (middle) decorrelated, and (right) disentangled methods. From top to bottom within each box, the three bands
(dark gray, gray, and light gray) show the relative contributions from gg, gv, and vv power, respectively. From top to bottom, the three rows are for estimators of gg,
gv, and vv power, respectively. [See the electronic edition of the Journal for a color version of this ﬁgure.]
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
full simulation cubes. [Since ¯nðrÞ is now constant and the
boundary conditions are periodic, we do this by simply using
fast Fourier transforms, matching to the Kaiser limit as k ! 0
to reduce sample variance; see Scoccimarro & Sheth 2002.]
No FOG correction was applied to these simulations.
The results are shown in Figure 27. The upper panel (on a
logarithmic scale) shows the input power spectrum, the quantities Pgg, Pgv, and Pvv, as well as the monopole, quadrupole, and
hexadecapole Ps
4 as dotted lines. The lower panel
shows (on a linear scale) the ratio of each of these quantities to
the input power spectrum. In the absence of nonlinear clustering
and bias, each of these lines would be horizontal. We see that
PggðkÞ agrees well with the real-space matter power spectrum
PðkÞ on large scales and progressively underestimates it more
Fig. 20.—Gray bands show the 1  allowed ranges for the amplitude of the
gg, gv, and vv power, respectively, relative to the prior gg spectrum, as a
function of the maximum wavenumber included in the ﬁt. The sets of ﬁve
black curves show the best-ﬁt values using FOG compression with the ﬁve
density thresholds 1 þ c ¼ 1 (no FOG compression), 200 (our baseline;
heavy curve), 100, 50, and 25 (successive curves go higher for gv and lower
for gg and vv). [See the electronic edition of the Journal for a color version of
this ﬁgure.]
Fig. 21.—Gray band shows the 1  allowed range for r, assuming the
shape of the prior PggðkÞ but marginalizing over the power spectrum normalization, using FOG compression with our baseline density threshold
1 þ c ¼ 200. From bottom to top, the three curves show the best-ﬁt  for
FOG thresholds 1 þ c ¼ 1 (no FOG compression), 200 (our baseline; heavy
curve), and 100. [See the electronic edition of the Journal for a color version
of this ﬁgure.]
Fig. 22.—Decorrelated real-space galaxy-galaxy power spectrum using the
modeling method (bottom) for the baseline galaxy sample assuming  ¼ 0:5
and r ¼ 1. As discussed in the text, uncertainty in  and r contribute to an
overall calibration uncertainty of order 4%, which is not included in these
error bars. To remove scale-dependent bias caused by luminosity-dependent
clustering, the measurements have been divided by the square of the curve in
the top panel, which shows the bias relative to L galaxies. This means that the
points in the bottom panel can be interpreted as the power spectrum of L
galaxies. The solid curve (bottom) is the best-ﬁt linear CDM model of x 5.
[See the electronic edition of the Journal for a color version of this ﬁgure.]
TEGMARK ET AL.
and more as k increases. Quantitatively, it is off by 4% at k 
0:1 h Mpc1 and 6% at k  0:2 h Mpc1, corresponding to 2%
and 3% in ﬂuctuation amplitude, respectively. These numbers
are thus in the same ballpark as those we found from varying the
FOG compression threshold above.
While the agreement is impressive, we note that PTHalos
code may not have a fully accurate radial distribution of
galaxies inside halos, nor is the halo occupation number as a
function of mass uniquely determined from the observations.
For these reasons one should exercise caution when using
these results in the nonlinear regime (k k 0:2 h Mpc1),
bearing in mind that different galaxy distribution models may
lead to larger differences between the nonlinear matter power
spectrum and Pgg.
When Figure 27 is compared with Figures 14 and 20, it is
striking that the simulations display stronger nonlinearity than
the real data. The simulations show PgvðkÞ going negative for
k k0:14 h Mpc1, whereas the data show no statistically
signiﬁcant detection of negative Pgv power on any scale
probed. This difference reﬂects the fact that the small-scale
velocity dispersion in the PTHalos simulations is larger than
those actually observed. In other words, our PTHalos results
should not be interpreted as our best estimate of how large
the nonlinear problems are but rather more as a worst-case
scenario for the importance of nonlinear corrections.
In the Kaiser approximation, all curves in Figure 27 (bottom) would be horizontal lines. It is noteworthy that although
the strong nonlinearities in the simulations cause the Kaiser
Fig. 23.—The rms density ﬂuctuation amplitude ðkÞ1=2 derived from the
modeling method power spectrum of Fig. 22, where ðkÞ  4PggðkÞ½k=ð2Þ
and k is the effective k-value from Table 2.
Real-Space Power Spectrum with the Modeling Method
ðh1 MpcÞ3
0:016þ0:006
0:003........................
0:018þ0:006
0:003........................
0:021þ0:007
0:004........................
0:024þ0:007
0:004........................
0:028þ0:008
0:005........................
0:032þ0:008
0:005........................
0:037þ0:009
0:006........................
0:043þ0:010
0:007........................
0:049þ0:011
0:008........................
0:057þ0:012
0:008........................
0:065þ0:013
0:010........................
0:075þ0:015
0:011........................
0:087þ0:017
0:012........................
0:100þ0:019
0:014........................
0:116þ0:021
0:016........................
0:134þ0:024
0:019........................
0:154þ0:027
0:022........................
0:178þ0:031
0:027........................
0:205þ0:036
0:032........................
0:236þ0:041
0:039........................
0:271þ0:043
0:048........................
0:306þ0:042
0:075........................
Note.—Pgg is the 1  error, uncorrelated between bands. These
values have been corrected for luminosity-dependent bias by dividing
by the square of the last column (see x 5) and thus refer to the clustering of L galaxies. The k-column gives the median of the window
function and its 20th and 80th percentiles; the exact window functions
from  max/sdss.html should be used for
any quantitative analysis.
Fig. 24.—SDSS window functions (rows of W; top) using decorrelated
estimators for the modeling method. The ith row of W typically peaks at the
ith band, the scale k that the band power estimator ˆpi was designed to probe.
All curves have been normalized to have the same area, so the highest peaks
indicate the scales where the window functions are narrowest. The turnover in
the envelope at k  0:1 h Mpc1 reﬂects our running out of information because of the omission of modes probing smaller scales. The 32 2dFGRS
window functions estimated by Percival et al. are shown for comparison, plotted with the exact same conventions. They correspond to correlated
rather than uncorrelated measurements. Their shapes and widths seem to agree
well with the SDSS windows around k  0:1 h Mpc1, becoming substantially wider on larger scales; this is a key advantage of our analysis method.
[See the electronic edition of the Journal for a color version of this ﬁgure.]
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
approximation for Ps
0ðkÞ and Ps
2ðkÞ (Fig. 27, dotted lines) to
break down on very large scales, k P 0:02 h Mpc1, the
combination that represents PggðkÞ remains an accurate estimate of Ptrue
gg ðkÞ down to much smaller scales. We obtain
similar results by using the analytic halo model approach of
Seljak in place of our simulations. R. Scoccimarro
 shows that this is in fact a generic result: as long as the wavenumber k times the rms pairwise
velocity dispersion is smaller than the Hubble parameter
gg ðkÞ is accurately approximated by equation (17) even if
the coefﬁcients in this expansion are not well approximated
by the Kaiser formula.29 This can be intuitively understood
from the fact that PggðkÞ is equal to transverse power under all
circumstances, linear or nonlinear, as exploited in Hamilton &
Tegmark . As long as redshift distortions can be reasonably approximated by quadrupole and hexadecapole distortions, then the arbitrary functions PgvðkÞ and PvvðkÞ contain
Fig. 25.—Effect of FOG compression on the measured power spectrum.
From bottom to top, the three solid curves show the factor by which the
measured ﬂuctuation amplitude PggðkÞ1=2 is increased by FOG compression
with overdensity thresholds 1 (no compression), 200 (our baseline; horizontal line), and 100, respectively, using the disentanglement method. The
dashed curves show the same ratios for the modeling method. To place these
effects in context, the relative 1  measurement errors on the power spectrum
amplitude are indicated by the light gray band for the disentanglement method
and by the gray band for the modeling method. [See the electronic edition of
the Journal for a color version of this ﬁgure.]
Fig. 26.—Squares show the mean power spectrum PggðkÞ recovered from
62 PTHalos simulations by our analysis pipeline, by using the disentanglement method without FOG compression. If these squares faithfully measure
the average real-space matter power spectrum of the simulations (solid line),
then about 68% of them should lie in the shaded band around this curve,
whose width is given by the 1  errors computed by our pipeline divided by
the square root of the number of simulations. For comparison, the dotted curve
shows the linear power spectrum used as input for the simulations. [See the
electronic edition of the Journal for a color version of this ﬁgure.]
Fig. 27.—Power spectra from 275 PTHalos mock catalogs, quantifying
how accurately our PggðkÞ statistic recovers the true power spectrum. The
thick black curve in the upper panel shows the real-space power spectrum that
we wish to recover, on a logarithmic scale. The lower panel, on a linear scale,
shows the same curves as the upper panel, but divided by this reference model.
The thin solid black curve is the linear power spectrum that was taken as input
for the simulations. The thick dark gray, gray, and light gray curves show the
recovered gg, gv, and vv power spectra, and the three dotted curves show the
redshift-space monopole, quadrupole, and hexadecapole power from top to
bottom on the left-hand side (see eq. ), all curves being averages from 275
simulations using about 106 galaxies each in the full simulation cube. Where
they are negative, the gv and quadrupole curves are plotted as positive and
dashed in the upper panel. The velocity dispersion is higher than in the real
SDSS data, and no FOG compression has been performed, so this should be
viewed as a worst case scenario. Nonetheless, the ﬁgure shows that the PggðkÞ
(dark gray) recovers the true power spectrum (thick black curve) to within a
few percent at k ¼ 0:1 h Mpc1 even though strong departures from the
Kaiser approximation (which predicts that all curves are horizontal in the
lower panel) are evident in the PgvðkÞ curve (thick gray curve) on these scales.
The reason that our method works so well is that PggðkÞ recovers the transverse power (which is unaffected by redshift distortions) beyond the Kaiser
approximation, requiring merely that ‘  6 anisotropies be negligible. [See the
electronic edition of the Journal for a color version of this ﬁgure.]
29 Unfortunately, this useful result does not hold for PgvðkÞ or PvvðkÞ, so
these two functions cannot be interpreted as simply the galaxy-velocity and
velocity-velocity power when nonlinearities are important.
TEGMARK ET AL.
enough freedom to model distortions completely, even if they
do not conform to the Kaiser model.
A third and ﬁnal piece of evidence that nonlinearities have
no major effect on our measurement of the large-scale realspace power comes from a direct comparison of PggðkÞ recovered with our disentanglement and modeling methods.
Although the former has about twice as much scatter as the
latter, the two measurements show excellent agreement. There
is no hint of systematic differences between the two on any
The bottom line of this section is that although estimates of
the redshift-space distortions (estimates of , the gv/gg ratio,
the quadrupole-to-monopole ratio, etc.) are very sensitive to
nonlinear effects, our estimates of the real-space matter power
are not. We have argued that any scale-dependent statistical
bias in our PggðkÞ results due to nonlinear redshift distortions
(or errors in our code) is smaller than a few percent for
k < 0:1 h Mpc1, i.e., that the systematic errors associated
with this are negligible compared with the statistical errors.
5. ACCOUNTING FOR LUMINOSITY-DEPENDENT BIAS
We have now measured the real-space power spectrum
PggðkÞ of the SDSS galaxies, obtaining the results shown in
Figure 22. The goal of this section is to compute and apply a
small (10%) scale-dependent bias correction, producing a
curve proportional to the underlying matter power spectrum
and usable for cosmological parameter estimation.
As discussed in x 3.1.3, there is good reason to believe that
bias is complicated on small scales, yet simple and essentially
scale-independent on the extremely large scales k ¼ 2=k P
60 h1 Mpc that are the focus of this paper.30 However, since
this scale-independent bias factor depends on luminosity
(among other galaxy properties), we should expect to introduce an artiﬁcial scale dependence of bias from the magnitudelimited nature of our sample.
It is easy to understand how luminosity-dependent clustering can masquerade as scale-dependent bias. Since luminous
galaxies dominate the sample at large distances and dim ones
dominate nearby, a measurement of PggðkÞ on very large
scales is statistically dominated by luminous galaxies whereas
a measurement on small scales is dominated by dim ones
(which have much higher number density). Since luminous
galaxies cluster more than dim ones, the measured power
spectrum will therefore be redder than the matter power
spectrum, with a lower ratio of small-scale to large-scale
Below we quantify and correct for this effect. We emphasize
that this is not intended to be the mother of all bias treatments
and the ﬁnal word on the subject. Rather, this artiﬁcial red-tilt
is a small (10%) effect that has never previously been
quantiﬁed, and we simply wish to make a ﬁrst-order estimate
of it. We start by measuring the luminosity dependence of bias
by using our volume-limited subsamples in the next section,
then use this to compute the scale-dependent effect.
It has been long known that galaxy bias depends on other galaxy properties as
well, e.g., morphological type, color, and environment. Fortunately, the only intrinsic property that determines whether a
galaxy gets included in our baseline sample is its luminosity,
so we can ignore dependence on all other properties for our
present purposes (type dependence of clustering is of course a
fascinating subject of its own and will be the topic of future
SDSS papers).
5.1. Measurement of the Luminosity Dependence of Bias
To quantify the luminosity dependence of bias for the SDSS
galaxies, we repeat our entire analysis for each of the volumelimited samples L2–L7 speciﬁed in Table 1 and plotted in x 2
(samples L1 and L8 contain too few galaxies to be useful).
The resulting power spectra are shown in Figure 28. To avoid
excessive clutter in this ﬁgure, we plot the minimum variance
power spectrum estimate described in Appendix B.3.1. To
indicate that the measurement errors are correlated between
k-bins, we show the measurements as a shaded band rather
than as separate points, with the vertical thickness of the band
corresponding to the 1  uncertainty. (The bias ﬁtting below
uses the full covariance matrix and is of course independent of
what plotting convention is used, as is 2 computed with
eq. [B8].)
Figure 28 shows that all power spectra have roughly the
same shape, increasing in amplitude as the galaxies become
more luminous. This is seen more clearly in Figure 29, where
we have divided them all by the linear power spectrum of the
simple CDM reference model described below.
To quantify this similarity of shapes, we ﬁt each of the
measured power spectra to the reference CDM curve with
Fig. 28.—Real-space power spectrum PggðkÞ for galaxies in six bins of
absolute magnitude M0:1r detailed in Table 1, with the shading indicating 1 
uncertainty. All power spectra have roughly the same shape, increasing in
amplitude as the galaxies become more luminous. The dashed curve is the
best-ﬁt linear CDM model (see text) normalized to 8 ¼ 1. [See the electronic edition of the Journal for a color version of this ﬁgure.]
30 On large scales, bias can also introduce an additive (as opposed to
multiplicative) constant, related to halo shot noise, thereby affecting the shape
of the power spectrum on scales larger than the turnover . Although this effect is negligible for
k k0:003 h1 Mpc and is therefore unimportant for the present paper, it may
be important for the upcoming analysis of the SDSS luminous red galaxy
(LRG) sample, both because the halo shot noise effect is larger for such rare
objects and because LRGs probe PðkÞ out to larger scales than does the main
SDSS galaxy sample analyzed here.
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
the amplitude freely adjustable. All six cases produce acceptable ﬁts with reduced 2 of order unity, and the
corresponding best-ﬁt normalizations are shown in Figure 30.
We want our reference model to provide an accurate empirical characterization of the SDSS data with as few parameters as possible. We choose it to be a ﬂat scale-invariant
CDM model with the baryon density h2 b ¼ 0:024 favored
by WMAP and the Hubble parameter
h ¼ 0:72 favored by the Hubble Space Telescope Key Project,
leaving m as the only free parameter determining its shape.
We determine m by the following iterative procedure:
1. Given an m value, we compute the reference model
PðkÞ normalized to 8 ¼ 1.
2. Given the reference model, we ﬁt for the six bias factors
plotted in Figure 30.
3. We ﬁt these bias factors to a smooth curve bðMÞ=b ¼
A þ BðL=LÞ þ CðM  MÞ shown in Figure 30 and given by
the three parameters (A, B, C).
4. We compute the correction beAðkÞ for scale-dependent
bias shown in Figure 22 (top) as described below.
5. We compute the value of m that best ﬁts the biascorrected measurements in Figure 22 (bottom).
This procedure converges to within ﬂoating-point numerical
precision in merely a few iterations for starting values anywhere in the range 0:1 < m < 1:0, yielding m ¼ 0:300 and
ðA; B; CÞ ¼ ð0:895; 0:150; 0:040Þ. The basic reason for this
robustness is that changing the shape of the ﬁducial model
changes beAðkÞ2 by a much smaller amount, because of the
smearing by the integrals below.
5.2. Correcting for the Luminosity Dependence of Bias
Above we quantiﬁed the well-known fact that the density
ﬁeld MðrÞ of galaxies of absolute magnitude M is more
strongly clustered for larger luminosity (smaller absolute
magnitude M). Let us consider the simple bias model
MðrÞ ¼ bðMÞðrÞ;
where ðrÞ is the ﬁeld of matter ﬂuctuations and bðMÞ is the
luminosity-dependent bias factor proportional to what is
plotted in Figure 30. Since our observed galaxy sample mixes
galaxies of various absolute magnitudes with some probability
distribution fMðM; rÞ, our observed density ﬁeld can be written
fMðM; rÞMðrÞ dM:
This probability distribution fMðM; rÞ is simply proportional
to the galaxy luminosity function ðMÞ over the absolute
magnitude range MbriðrÞ < M < MdimðrÞ where the galaxy is
observable at comoving distance r, zero otherwise, and normalized to integrate to unity. MbriðrÞ and MdimðrÞ are given by
equation (A5) on inserting the appropriate absolute magnitude cuts from Table 1 (for instance, the sample safe13 has
Mmin ¼ 23, Mmax ¼ 18:5). Substituting equation (26) into
equation (27), we obtain
obsðrÞ ¼ beAðrÞðrÞ;
fMðM; rÞbðMÞ dM
MdimðrÞ ðMÞbðMÞ dM
MdimðrÞ ðMÞ dM
Fig. 29.—Bias relative to the linear CDM model of Fig. 28 for galaxies in
six bins of absolute magnitude M0:1r. All six curves are consistent with being
scale independent, the bias merely increasing in amplitude as the galaxies
become more luminous. [See the electronic edition of the Journal for a color
version of this ﬁgure.]
Fig. 30.—Squares show the measured bias of our SDSS galaxies as a
function of magnitude relative to b, the bias at M ¼ 20:83 (vertical dotted
line). The solid curve shows the ﬁt to our measurements described in the text,
bðMÞ=b ¼ 0:895 þ 0:150L=L  0:040ðM  MÞ,
shows the corresponding ﬁt of Norberg et al. based on 2dFGRS data,
bðMÞ=b ¼ 0:85 þ 0:15L=L. [See the electronic edition of the Journal for a
color version of this ﬁgure.]
TEGMARK ET AL.
We evaluate this expression by using the SDSS luminosity
function measured in Blanton et al. . The results are
plotted in Figure 31, and the effective bias is seen to increase
with distance as expected. We see that the curve beAðrÞ becomes
shallower as the range of absolute magnitudes in the sample is
cut, so the samples safe0, safe13, and safe22 are progressively
less affected. Our volume-limited samples by construction
simply have beAðrÞ ¼ const.
Bias is expected to depend not only on luminosity but also
on time . In addition,
the intrinsic matter clustering should increase over time. Since
the net result of these two counteracting effects is likely to be
smaller than the luminosity effect at the low redshifts (zP 0:2)
that we are considering, this is difﬁcult to measure separately.
The same applies to the small effect from the time dependence
of the redshift-space distortion parameter  caused by the time
dependence of m and . Indeed, since typical luminosity
grows monotonically with distance, the distance-dependent
bias beAðrÞ plotted in Figure 31 should be expected to approximately include the combination of all four effects, so that
our analysis will to ﬁrst order be corrected for all of them.
Let us now estimate how beAðrÞ translates into k-dependent
bias in our measured power spectrum. We do this in the FKP
approximation . Here the density ﬁeld
obsðrÞ is multiplied by a weight function
1 þ ¯nðrÞPðkÞ
and then Fourier transformed, giving
ðrÞobsðrÞeik G r d3r ¼
ðrÞbeAðrÞðrÞeik G r d3r
because of equation (28), so we see that we are simply measuring the power spectrum by using a modiﬁed effective
weight function, replacing by beA. It is well known that the FKP estimate ˜PðkÞ of the three-dimensional
power spectrum PðkÞ satisﬁes
h˜PðkÞi ¼ ðW  PÞðkÞ;
i.e., that it probes the true power spectrum convolved with a
window function WðkÞ. This window function is the square
modulus of the Fourier transform of the weight function, so it
is given by
W0ðkÞ  j ˆ ðkÞj2;
W1ðkÞ  jb beAðkÞj2;
where W0 applies if we ignore bias and W1 applies if we take
bias into account. According to equation (32), galaxy bias
therefore increases the measured power by a factor
beAðkÞ2 ¼ ðW1  PÞðkÞ
ðW0  PÞðkÞ ¼
W1ðk0ÞPðk  k0Þ d3k 0
W0ðk0ÞPðk  k0Þ d3k 0 :
The window function is normally narrower than the scale on
which the power spectrum varies appreciably, so we can make
the approximation of taking it out of the convolution integral,
obtaining simply
W1ðk0Þ d3k 0
W0ðk0Þ d3k 0 ¼
ðrÞ2beAðrÞ2 d3r
where we used Parseval’s theorem
j ˆ ðkÞj2 d3k ¼ ð2Þ3
j ðrÞj2 d3r
in the last step. In summary, substituting equation (30), we have
shown that the effective bias as a function of wavenumber is
1 þ ¯nðrÞPðkÞ
beAðrÞ2r3 d ln r
1 þ ¯nðrÞPðkÞ
The resulting curves beAðkÞ are plotted in Figure 32. As
expected, the effective bias is seen to decrease with wavenumber k, reﬂecting the fact that low-k measurements are
dominated by more distant and luminous galaxies. Just as in the
previous ﬁgure, the curves become shallower going from safe0
to safe13 to safe22, as the range of absolute magnitudes shrinks.
Note that if one treats PðkÞ as a constant in equation (37),
then beAðkÞ becomes a constant independent of k. Of the
magnitude-limited galaxy survey analyses of the last decade,
essentially the only one using such a constant weighting was the
2dFGRS analysis by Percival et al. . Thus, one can
minimize the luminosity bias at the expense of increased statistical errors due to suboptimal galaxy weighting (as shown by
Fig. 31.—Effective bias (eq. ; heavy curves) is seen to increase with
distance, reﬂecting the fact that more distant galaxies are on average more
luminous. The curves become shallower as the range of absolute magnitudes
in the sample is cut, going from safe0 (no cuts; dashed curve) to safe13
(23 < M0:1r < 18:5; solid curve) to safe22 (22 < M0:1r < 18; dotted
curve). Our volume-limited samples simply have beAðrÞ constant. The ﬁve thin
curves show the relative weights given to different distances when measuring
PðkÞ for k ¼ 0:03, 0.1, 0.3, 1, and 3 h Mpc1 by using the safe13 radial
selection function. [See the electronic edition of the Journal for a color version of this ﬁgure.]
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
Feldman et al. 1994, such uniform weighting is desirable only
for volume-limited surveys for which the galaxy number density is constant). In this paper we have instead used minimumvariance methods to measure the luminosity bias and power
spectrum jointly. For a detailed discussion of these issues that
appeared after the original version of this paper was submitted,
see Percival, Verde, & Peacock .
The bottom line of this section is that although luminositydependent bias has only a small tilting effect on our measured
SDSS power spectrum, we can and should correct for it when
doing precision cosmology, by simply dividing the measured
power spectrum by the square of the curve in Figure 22 (top).
This correction curve has a slope around 10% per decade at
k  0:2 h Mpc1. This means that ﬁtting for cosmological
parameters by ignoring this effect would give noticeably biased results. For instance, assuming a power-law primordial
power spectrum of the form kns, this would correspond to
shifting the best-ﬁt spectral index ns by an amount ns 
ð2= ln 10Þ
10%  0:1, and a more careful analysis in
x 7.3 shows the net effect to be 0.06. To place this in context,
the popular stochastic eternal inﬂation model 
predicts ns  0:96, i.e., a substantially smaller departure from
the ns ¼ 1 scale-invariant case.
6. TESTS FOR SYSTEMATIC ERRORS IN THE DATA
The Monte Carlo experiments described in x 4 provided an
end-to-end validation of our method and our software. In this
section, we turn to potential systematic errors in the SDSS data
themselves. Examples of such effects include radial modulations (due to misestimates of evolution or K-corrections) and
angular modulations (due to effects such as uncorrected dust
extinction, variable observing conditions, photometric calibration errors, and ﬁber collisions) of the density ﬁeld.
6.1. Analysis of Subsets of Galaxies
Since such effects would be expected to vary across the sky
(depending on, say, reddening, seasonally variable baseline
offsets, or observing conditions such as seeing and sky
brightness), we repeat our entire analysis for four different angular subsets of the sky (subsamples A1–A4 from Table 1) in
search of inconsistencies. We subtract the power spectrum
measured south of the Galactic plane (A1) from the power
spectrum measured north of the Galactic plane (A2) for k <
0:2 h Mpc1 by using the modeling method and obtain a residual 2  16 for 19 degrees offreedom. A similar comparison
of the two disjoint northern regions (A3 and A4) gives a residual 2  26, again for 19 degrees offreedom. Under the null
hypothesis that a such a pair of curves are independent measurementsof thesameunderlyingpower spectrum,the meanand
standard deviation are h2i ¼ 19 and 2 ¼ ð2
19Þ1=2  6,
so these residuals are 0.4 and +1.4 standard deviations away
from the expectation, respectively. In other words, there is no
signiﬁcant evidence for discrepancies between the power
spectra measured in different parts of the sky.
The actual residuals are shown in Figure 33. Since our
measurements in different k-bands are uncorrelated, 2 is
simply the sum of the square of what is plotted. The most
notable discrepancy is at k  0:05 h Mpc1, where there is
more power in A4 than in A3. This appears to be related to a
striking wall-like structure that is seen in the northern galaxy
distribution around z  0:08 (see Fig. 5). Although this ‘‘great
blob’’ may be the largest coherent structure yet observed, a
ﬁrst crude estimate suggests that it is not inconsistent with
Gaussian ﬂuctuations: visual inspection of the 275 PTHalos
simulations reveals similar structures in more than 10% of the
cases. A similar comparison of the power spectra in the radial
subsamples R1–R3 is less useful, since this radial binning is
largely degenerate with the luminosity binning (x 5), so we
test for radial systematics with mode subsets instead.
6.2. Analysis of Subsets of Modes
Because of their angular or radial nature, all potential systematic errors discussed above create excess power mainly in
Fig. 32.—Effective bias in the power spectrum measurement, eq. (37), is
seen to decrease with wavenumber k, reﬂecting the fact that low-k measurements are dominated by more distant and luminous galaxies. The curves become shallower as the range of absolute magnitudes in the sample is cut, going
from safe0 (no cuts; thick dashed curve) to safe13 (23 < M0:1r < 18:5;
solid curve) to safe22 (22 < M0:1r < 18; dotted curve). [See the electronic
edition of the Journal for a color version of this ﬁgure.]
Fig. 33.—Comparison of power in different parts of the sky deﬁned by the
angular subsamples A1–A4 in Table 1. Each curve shows the difference of
two power spectra divided by the error bar on this quantity, so 2 is simply the
sum of the square of what is plotted. 2 per degree of freedom is 0.86 for A2–
A1 (north vs. south) and 1.39 for A3–A4 (the two separate northern regions).
[See the electronic edition of the Journal for a color version of this ﬁgure.]
TEGMARK ET AL.
the radial and angular modes. To quantify any such excess, we
therefore repeat our entire analysis with all 233 special modes
(27 radial modes, 199 angular modes, and 7 Local Group
modes) deleted. The results of this test are shown in Figure 34
and are very encouraging; the differences are tiny. Any systematic errors adding power to these special modes would cause
the squares to lie systematically above the crosses, yet the
squares fall below the crosses for four of the ﬁve leftmost bands,
where such systematics would be most important. Thus, there is
no indication of excess radial or angular power in the data.
Figure 34 shows that removing the special modes results in
a slight error bar increase on the largest scales and essentially
no change on smaller scales. This can be readily understood
geometrically. If we count the number of modes that probe
mainly scales k < k, then the number of purely radial, purely
angular, and arbitrary modes will grow as k, k2
, respectively. This means that ‘‘special’’ modes (radial and angular) will make up a larger fraction of the total pool on large
scales (at small k) and that the purely radial ones will be
outnumbered by the purely angular ones.
Our treatment of spectroscopic ﬁber collisions described in
Appendix A is another source of potential angular/radial
problems. By assigning both members of some close pairs
(separated by less than 5500, corresponding to 0:08 h1 Mpc at
the mean depth of the survey) at the same redshift, we overestimate the radial power on small scales. Zehavi et al. 
perform extensive tests of this effect and show that it is negligible on large scales considered in this paper. As a further
cross-check, we repeat our entire calculation with all galaxies
with such assigned redshifts removed. Since this second approach is guaranteed to underestimate the power, the two
approaches will bracket the correct answer. As expected on the
basis of the Zehavi et al. analysis, we ﬁnd no evidence
that ﬁber collisions are boosting our measured power spectrum on the smallest scales we probe (k  0:3 h Mpc1).
7. DISCUSSION AND CONCLUSIONS
7.1. Basic Results
We have measured the shape of the real-space power
spectrum PðkÞ on large scales by using the SDSS galaxy
redshift catalog, paying particular attention to quantifying and
correcting for the effects of survey geometry, redshift-space
distortions, and luminosity-dependent bias. Our principal
results are the estimates PggðkÞ of the real-space galaxy power
spectrum, which are listed in Tables 2 and 3 for the disentanglement and modeling methods, respectively. As discussed
in x 4, the disentanglement method is more robust, but the
modeling method (Fig. 22) yields smaller statistical errors and
appears in our tests to introduce little systematic error. Table 3
lists results both for FOG compression with c ¼ 200, which
we consider the most reliable choice for estimating the true
real-space power spectrum, and for no FOG compression,
which is the case easiest to model in detail. Our estimation
procedure yields uncorrelated error bars, so the reported errors
in these tables can be used as a diagonal covariance matrix
when evaluating the likelihood for model ﬁts. For such ﬁts, it
is crucial to use the exact window functions.31
As noted in x 4, uncertainties in the values of  and r leave
a 4% 1  uncertainty in the overall normalization of PggðkÞ
with the modeling method, in addition to the error bars on
individual points. There is no corresponding normalization
uncertainty for the disentanglement method. Our tabulated
power measurements have all been corrected for the effect of
luminosity-dependent bias as discussed in x 5. The correction
bðkÞ used is given in Tables 2 and 3 and is normalized so that
our quoted power measurements represent the power spectrum
of galaxies with absolute r-band magnitude M  20:83; the
relative bias of galaxies as a function of luminosity can be
found in Figure 30.
7.2. Using Our Results
There are several levels at which one might use our results,
depending on how conservative one wishes to be and how
much energy one has for theoretical modeling. The mock
catalog tests in x 4.2 (Fig. 27 in particular) suggest that our
method is quite successful at correcting for redshift-space
distortions to recover the real-space galaxy power spectrum
gg ðkÞ. However, there are notable departures from perfect
recovery at k k 0:15 h Mpc1, and the tests are in any event
carried out for a particular choice of cosmology and galaxy
bias model. The simplest and least conservative way to use
our results is to assume that we have indeed recovered Ptrue
and to further assume that on the scales of our measurement
the galaxy power spectrum is a scale-independent multiple of
the linear theory matter power spectrum, PggðkÞ ¼ b2
where b represents the large-scale bias factor of L galaxies.
The agreement of the lines representing PggðkÞ and the linear
PðkÞ in Figure 27 suggests that this approach is probably safe
for k P 0:1 h Mpc1 and that one can use the more precise
modeling estimates of PggðkÞ (Table 3) without incurring a
systematic error that is signiﬁcant relative to the statistical
Fig. 34.—Effect of removing special modes. The black curve with associated error bars shows our measured power spectrum PggðkÞ from the modeling method using all 4000 PKL modes. Red squares with error bars show the
effect of removing the 234 special modes corresponding to purely angular and
purely radial ﬂuctuations, as well as ﬂuctuations associated with the motion of
the Local Group relative to the CMB rest frame. Any systematic errors adding
power to these special modes would cause the curve to lie systematically
above the squares. [See the electronic edition of the Journal for a color
version of this ﬁgure.]
31 The window functions are available at 
sdss.html, together with sample software for evaluating the SDSS likelihood
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
errors of the current measurement. However, our tests are not
exhaustive, and it is possible that the agreement of PggðkÞ and
linear PðkÞ shapes in Figure 27 arises in part from a cancellation of nonlinear gravitational effects with errors in the
redshift-space distortion correction. This cancellation, in turn,
might not hold for other cosmological or galaxy bias models.
A second option is to assume that we have recovered Ptrue
but not assume that this has the same shape as the linear
theory matter power spectrum. Here, for example, one could
use n-body simulations or analytic approximations to compute
the nonlinear, real-space power spectrum, incorporating galaxy bias based on semianalytic galaxy formation calculations,
hydrodynamic simulations, or a ‘‘halo occupation’’ model
constrained by other measurements of galaxy clustering.
Figure 27 again suggests that this approach can be used safely
for k P 0:1 h Mpc1 (and perhaps a bit further) without systematic errors that exceed the statistical errors. One can also
use the nonlinear matter power spectrum and a constant b, but
there is good reason to expect scale-dependent bias on scales
where nonlinearity is signiﬁcant .
Finally, the most cumbersome but most reliable way to use our
data is to follow the course suggested at the end of x 4: create
redshift-space realizations using nonlinear simulations with
galaxy bias, compute the monopole, quadrupole, and hexadecapole components of the redshift-space power spectrum in
the distant observer approximation, and use equation (17) to
convert them to PggðkÞ. These predictions should be compared
directly with the disentanglement estimates of PggðkÞ, since the
redshift-space distortions have been incorporated into the
model rather than removed from the data. However, by focusing on a quantity PggðkÞ that responds mainly to real-space
clustering (exactly so in the linear regime), such a comparison
will be insensitive to moderate errors in the redshift-space
distortions incorporated in the theoretical predictions. This last
approach is still much simpler than creating artiﬁcial SDSS
catalogs and reproducing our estimation method in its entirety,
but it should be equally valid.
7.3. Comparison with Other Results
Figure 35 compares our results from Table 3 (modeling
approach) with other measurements from galaxy surveys but
must be interpreted with care. The UZC points may contain
excess large-scale power because of selection function effects
 , and the
angular SDSS points measured from the early data release
sample are difﬁcult to interpret because of their extremely
broad window functions. Only the SDSS, APM, and angular
SDSS points can be interpreted as measuring the large-scale
matter power spectrum with constant bias, since the others
have not been corrected for the red-tilting effect of luminositydependent bias. The Percival et al. 2dFGRS analysis
unfortunately cannot be directly plotted in the ﬁgure because
of its complicated window functions.
Figure 36 is the same as Figure 35 but restricted to a comparison of decorrelated power spectra, those for SDSS,
2dFGRS, and PSCz. Because the power spectra are decorrelated, it is fair to do ‘‘ by eye’’ when examining this ﬁgure. The
similarity in the bumps and wiggles between the three power
spectra is quite striking. Moreover, there is an interesting degree
of similarity with the power spectrum of the Abell/ACO cluster
catalog (not shown) reported by Miller & Batuski . It is
tempting to see hints of baryonic oscillations in these wiggles.
Fig. 35.—Comparison with other galaxy power spectrum measurements.
Numerous caveats must be borne in mind when this ﬁgure is interpreted. Our
SDSS power spectrum measurements are those from Fig. 22, corrected for the
red-tilting effect of luminosity-dependent bias. The purely angular analyses of
the APM survey and the SDSS should also be free of this effect, but represent
different mixtures of luminosities. The 2dFGRS points are from the analysis of
HTX02 and, like the PSCz points (HTP00) and the UZC points (THX02),
have not been corrected for this effect, whereas the Percival et al. 2dFGRS
analysis should be unafﬂicted by such red-tilting. The inﬂuential PD94 points
 , summarizing the state of the art a
decade ago, are shown assuming IRAS bias of unity and the then fashionable
density parameter m ¼ 1. [See the electronic edition of the Journal for a
color version of this ﬁgure.]
Fig. 36.—Same as Fig. 35, but restricted to a comparison of decorrelated
power spectra, those for SDSS, 2dFGRS, and PSCz. The similarity in the
bumps and wiggles between the three power spectra is intriguing. [See the
electronic edition of the Journal for a color version of this ﬁgure.]
TEGMARK ET AL.
Indeed, Percival et al. , in their analysis of the 2dFGRS,
and Miller et al. , in
their analysis of the Abell/ACO cluster , APM cluster , and
PSCz surveys (HTP00), already concluded that their data
mildly favored model power spectra with baryonic oscillations
over those without. However, the oscillations at large scales
evident in Figure 36, notably the dip at k  0:035 h Mpc1 and
bump at k  0:05 h Mpc1, are substantially larger than predicted by the standard CDM concordance model illustrated in
Figure 22; if conﬁrmed, such a feature would challenge the
CDM concordance model with scale-invariant initial conditions. This preference for a large baryon fraction is also seen
in Figure 37 (details below), which, however, shows that our
SDSS data are nonetheless perfectly consistent with the concordance baryon fraction—about one-sixth of the 100,000
points shown have a baryon fraction below the WMAP value
Figure 37 also illustrates why galaxy clustering data is so
complementary to CMB measurements. The 100,000 gray
points are from a Monte Carlo Markov chain analysis of the
WMAP for simple ﬂat scalar adiabatic models parameterized by
the densities of dark energy, dark matter, and baryronic matter,
the spectral index and amplitude, and the reionization optical
depth. As emphasized by Eisenstein et al. and Bridle
et al. , WMAP alone cannot determine m to better than a
factor of 2 or so because of a strong degeneracy with other
parameters. Fortunately, the WMAP degeneracy banana in
Figure 37 is seen to be almost orthogonal to the SDSS degeneracy, which means that combining the two measurements
dramatically tightens the constraints on all the parameters involved in the degeneracy—notably m, h, and 8.
To place our SDSS results in a larger context, Figure 38
compares them with other measurements of the matter power
spectrum PðkÞ. Here the CMB, galaxy cluster, lensing, and Ly
forest results have been mapped into k-space using the method
of Tegmark & Zaldarriaga , assuming the WMAP model
given in the legend, and we have assumed an SDSS bias b ¼ 1.
The CMB data combine the BOOMERANG, MAXIMA,
Degree Angular Scale Interferometer (DASI), Cosmic Background Imager, Very Small Array, Arcminute Cosmology Bolometer Array Receiver (ACBAR), and WMAP data as in Wang
et al. with the WMAP measurements . The cluster point reﬂects the spread in the recent literature rather than any one quoted measurement. The lensing data
are from Hoekstra, Yee, & Gladders . The Ly forest
points are from the Gnedin & Hamilton reanalysis of the
Croft et al. data.
We leave detailed investigation of the implications of our
measurement to other papers (by us in Paper II and, we hope,
by others), since the primary goal of this paper is the measurement itself. As a characterization of our data, we brieﬂy
indulge in the simplest of the interpretive approaches described in x 7.2. For this purpose, we ﬁt our 22 PggðkÞ
measurements derived from the modeling method with c ¼
200 by using the linear CDM power spectrum of Eisenstein &
Hu , ﬁxing the baryon fraction b=m ¼ 0:17 and the
Hubble parameter h ¼ 0:72 as per the best ﬁts from WMAP
 and
no massive neutrino contribution. If we further ﬁx the inﬂationary spectral index to ns ¼ 1, then the shape of PðkÞ
is determined by the combination hm, and we ﬁnd hm ¼
0:2010:017 at 1 , i.e., m ¼ 0:3000:018.
As discussed above, our modeling of nonlinear redshiftspace distortions is accurate only on large scales, so we
Fig. 37.—Characterization of the SDSS power spectrum in terms of constraints on the ‘‘shape parameter’’ h m and the baryon fraction fb. Black
points show 100,000 Markov chain steps for SDSS; gray points are for WMAP
data. [See the electronic edition of the Journal for a color version of this
Fig. 38.—Comparison of our results with other PðkÞ constraints. The location of CMB, cluster, lensing, and Ly forest points in this plane depends
on the cosmic matter budget (and, for the CMB, on the reionization optical
), so requiring consistency with SDSS constrains these cosmological
parameters without assumptions about the primordial power spectrum.
This ﬁgure is for the case of a vanilla ﬂat scalar scale-invariant model with
m ¼ 0:28, h ¼ 0:72, and b=m ¼ 0:16,
¼ 0:17 , assuming b ¼ 0:92 for the SDSS
galaxies. [See the electronic edition of the Journal for a color version of this
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
recommend not using the measurements with k > 0:2 h
Mpc1 for cosmological analysis. In this spirit, we ﬁt the
19 PggðkÞ measurements for k < 0:2 h Mpc1 to the twoparameter model deﬁned by the Smith et al. nonlinear
power spectrum approximation by using the Eisenstein & Hu
 ﬁt as above for the linear transfer function, ﬁxing the
bias b ¼ 1. This gives the shape parameter hm ¼ 0:213 
0:0233 at 1 , i.e., m ¼ 0:295  0:0323. This ﬁt has 2 ¼
15:6 for 19  2 ¼ 17 effective degrees of freedom, so this twoparameter model ﬁt can be regarded as an adequate representation of our results in compact summary form. (Using a linear
power spectrum model would increase this m value by 0.043.)
Figure 37, which was commented on above, shows the result of
repeating this same ﬁt after adding the baryon fraction as a
third free parameter. Fixing the best-ﬁt shape hm ¼ 0:213; the
power spectrum amplitude corresponds to 8 ¼ 0:89  0:02
for L galaxies after marginalizing over the redshift-space
distortion parameters  and r. Note that this normalization is at
the effective redshift of the survey, not for z ¼ 0 galaxies.
If we ﬁx m at the best-ﬁt value 0.291 and treat the spectral
index as the free shape parameter, then we ﬁnd ns ¼ 0:995 
0:049. Without our correction for luminosity-dependent bias,
the corresponding numbers are ns ¼ 0:933  0:046, so the
statistical errors are now small enough for effects such as
this to be important. Similarly, Table 7 of Paper II shows
that ignoring this correction reduces the measured value of
m by 0.035.
Paper II presents a thorough analysis of the cosmological
constraints from our PðkÞ measurement, ﬁnding them in good
agreement with a ‘‘vanilla’’ ﬂat adiabatic CDM model with
negligible tilt, running tilt, tensor modes, or massive neutrinos. Our PðkÞ measurement provides a powerful conﬁrmation
of the results reported by the WMAP team and more than
halves the WMAP-only error bars on some parameters, e.g.,
the matter density m and the Hubble parameter h: Paper II
ﬁnds m ¼ 0:30  0:04 from WMAP+SDSS when marginalizing over the other vanilla parameters. This is about 1 
higher than when using the 2dFGRS survey [which gave a
slightly redder PðkÞ slope than we found]—just the sort of
statistical difference one would expect from two completely
independent samples.
7.4. Outlook
Let us conclude by looking ahead. Galaxy surveys have the
potential to greatly improve the cosmological constraints from
the cosmic microwave background by breaking degeneracies
and providing cross-checks, so detailed joint analysis of our
measurements with WMAP and other data sets will be
worthwhile. In particular, detecting the effect of baryons on
PðkÞ can provide
powerful constraints on the Hubble parameter , and accurate determination of the shape of
PðkÞ can place strong constraints on neutrino masses and help pin down the primordial power spectrum.
Deeper surveys can also provide interesting constraints on the
evolution of clustering and dark energy, and the SDSS luminous red galaxy (LRG) sample and photometric redshift catalog will complement specialized deep redshift surveys such
as DEEP and VIRMOS in this regard.
Prospects are also good for reducing systematic uncertainties involving both bias and redshift distortions. A key virtue
of having very large galaxy samples is that it permits accurate
measurements for large numbers of subsamples. For instance,
repeating our analysis for subsamples based on galaxy color
or spectral type will provide a powerful test of how scale
independent the bias is on large scales. Moreover, empirical
constraints from SDSS on redshift-space distortions should
improve substantially. These constraints are currently rather
weak because the survey geometry consists largely of thin
wedges; we have therefore focused simply on modeling distortions well enough to remove their impact on the real-space
PðkÞ estimate. As the survey area ﬁlls in and becomes more
contiguous, we expect to obtain interesting constraints on
redshift distortions that can be used to test and reﬁne theoretical and numerical models.
In addition to more careful modeling and combining with
other observational constraints, we anticipate several complementary results from the SDSS in the near future, such as
cosmological constraints directly from KL modes , real-space clustering on small scales from the projected
correlation function wðrpÞ , power spectrum measurements on large scales by using
the luminous red galaxy sample, and angular clustering
measurements by using photometric redshifts . This should help break degeneracies and provide crosschecks to test rather than assume the physics underlying the
cosmological model, thereby strengthening the weakest link in
post-WMAP cosmology.
We wish to thank Adrian Jenkins and Carlton Baugh
for providing Hubble volume simulation results and Scott
Dodelson for useful suggestions. M. T. thanks Angelica
de Oliveira-Costa for helpful comments and inﬁnite patience.
Funding for the creation and distribution of the SDSS Archive32 has been provided by the Alfred P. Sloan Foundation,
the participating institutions, the National Aeronautics and
Space Administration, the National Science Foundation, the
Department of Energy, the Japanese Monbukagakusho, and
the Max Planck Society.
The SDSS is managed by the Astrophysical Research
Consortium for the participating institutions. The participating
institutions are the University of Chicago, Fermilab, the Institute for Advanced Study, the Japan Participation Group,
Johns Hopkins University, Los Alamos National Laboratory,
the Max-Planck-Institute for Astronomy, the Max-Planck-
Institute for Astrophysics, New Mexico State University,
University of Pittsburgh, Princeton University, the United
States Naval Observatory, and the University of Washington.
M. T. was supported by NSF grants AST 00-71213 and
AST 01-34999, NASA grants NAG5-9194 and NAG5-11099,
and fellowships from the David and Lucile Packard Foundation and the Cottrell Foundation. M. A. S. acknowledges
support from NSF grant AST 00-7109, and A. J. S. H., from
NSF grant AST 02-05981 and NASA grant NAG5-10763.
Our PTHalos mock catalogs were created on the NYU
Beowulf cluster supported by NSF grants PHY 01-16590 and
PHY 01-01738 and NASA grant NAG5-12100.
32 The SDSS Web site is at 
TEGMARK ET AL.
APPENDIX A
DATA AND DATA MODELING
In this Appendix, we provide a detailed description of how our basic galaxy sample was processed, modeled, and split into the
subsamples used in our power spectrum analysis.
A1. THE SDSS GALAXY CATALOG
The SDSS is producing imaging and spectroscopic surveys over about a quarter of the celestial sphere. A
dedicated 2.5 m telescope at Apache Point Observatory, Sunspot, New Mexico, images the sky in ﬁve bands between 3000 and
10,000 A˚ by using a drift-scanning, mosaic CCD camera , detecting objects
to a ﬂux limit of r  22:5: The photometric quality of the observations is tracked by using an automatic photometricity monitor
 . One of the goals is to spectroscopically observe 900,000 galaxies ,
100,000 LRGs , and 100,000 QSOs . This spectroscopic follow-up uses two digital
spectrographs on the same telescope as the imaging camera. Other aspects of the survey are
described in the Early Data Release (EDR) paper .
The SDSS images are reduced, and catalogs are produced by the SDSS pipeline photo , which detects and
measures objects, the sky background, and the seeing conditions. As described in Smith et al. , magnitudes are calibrated to
a standard star network approximately in the AB system. The astrometric calibration is also performed by an automatic pipeline,
which obtains absolute positions to better than 0B1 rms per coordinate .
Object ﬂuxes are determined in several different ways by photo, as described in Stoughton et al. . The primary measure of
ﬂux used for galaxies is the SDSS Petrosian magnitude, a modiﬁed version of the quantity proposed by Petrosian . In the
absence of seeing, Petrosian magnitudes measure a constant fraction of a galaxy’s light regardless of distance (or size). They are
described in greater detail by Blanton et al. and Strauss et al. . Another important measure of ﬂux for galaxies is the
SDSS model magnitude, which is an estimate of the magnitude by using the better of a de Vaucouleurs and an exponential ﬁt to the
image. Finally, the SDSS also measures the ﬂux in each object by using the local point-spread function (PSF) as a template, which
is the highest signal-to-noise ratio measurement of ﬂux for point sources.
Main sample target selection involves star/galaxy separation, application of the ﬂux limit, application of the
surface brightness limit, and application of the ﬁber magnitude limit. Expressed quantitatively, the ﬁrst three of these criteria are
rPSF  rmod > slim;
rPet < rlim;
50 < 50;lim;
where rPet is the dereddened Petrosian magnitude in the r band ,
rmod is the model magnitude, rPSF is the PSF magnitude, and 50 is the Petrosian half-light surface brightness of the object in the
r-band. In practice, the values of the target selection parameters vary across the survey in a well-understood way, but for the bulk of
the area, they are slim ¼ 0:3, rlim ¼ 17:17, and 50;lim ¼ 24:5: We note here that objects near the spectroscopic ﬂux limit are nearly
5 mag brighter than the photometric limit; that is, the ﬂuxes are measured at a signal-to-noise ratio of a few hundred.
Fibers are assigned to a set of circular tiles with a ﬁeld of view 1 .49 in radius by an automatic tiling pipeline . The targets are observed using a 640 ﬁber spectrograph on the same telescope as the imaging camera. We extract onedimensional spectra from the two-dimensional spectrograms by using a pipeline (idlspec2d) created speciﬁcally for the SDSS
instrumentation ; a further pipeline (specBS v4_9) ﬁts for the redshift of each spectrum.
The ofﬁcial SDSS redshifts are obtained from a different pipeline . The two independent
versions provide a consistency check on the redshift determination. They are consistent (for galaxies) at over the 99% level.
Fibers on a single plate cannot be placed more closely than 5500. Thus, redshifts for both members of a close galaxy pair can be
obtained only in regions where tiles overlap. If we did not take ﬁber collisions into account at all, we would systematically
underestimate correlations on all scales. We correct for this bias by assigning each galaxy pair member whose redshift was not
obtained because of a ﬁber collision the same redshift as the pair member whose redshift was measured. Thus, for 192,642 of the
galaxies in the full sample, a spectroscopic redshift is available, but for 12,801 (6%) we must assign redshifts according to this
prescription. By using the overlaps of multiple tiles, where many of these pairs can be recovered, Zehavi et al. have shown
that this procedure works well on large scales, and we conﬁrm this conclusion with additional tests in x 6.
As of July 2002, the SDSS had imaged and targeted 2873 deg2 of sky and taken 431,291 successful spectra (including 323,126
spectra of galaxies) over 2499 deg2 of that area. We created a well-deﬁned sample for calculating large-scale structure and galaxy
property statistics from these data, known as Large-Scale Structure sample11. Our sample11 consists of all of the photometry for all
of the targets over that area (as extracted from the internal SDSS operational database), all of the spectroscopic results (as output
from idlspec2d), and a description of the angular window function of the survey and the ﬂux and surface brightness limits used for
galaxies in each area of the sky (discussed more fully below). For most of the area, we used the same version of the analysis
software that was used to create the target list. However, for the area covered by the EDR we used the
version of the analysis software used for that data release, since it was substantially better than the early versions of the software
used to target that area. For PHOTO, the most important piece of analysis software run on the data, the versions used for the
photometry range from v5_0 to v5_2. The region covered by this sample is similar to, but somewhat greater than, the region that
will be released in the SDSS Data Release 1 . For all of the subsamples of sample11 deﬁned here, we deﬁne a bright limit of r ¼ 14:5
(using Petrosian, dereddened magnitudes) to exclude the spectroscopic bright limits imposed in galaxy target selection, as well as
the possibility of poor deblending of bright objects by PHOTO (a problem for v5_2 and previous, though less so for v5_3).
We measure galaxy magnitudes through a set of bandpasses that are constant in the observer frame. These observer frame
magnitudes correspond to different rest-frame magnitudes depending on the galaxy redshift. To compare galaxies observed at
different redshifts, we convert all the magnitudes to a single ﬁxed set of bandpasses by using the method of Blanton et al. . These routines ﬁt a linear combination of four spectral templates to each set of ﬁve magnitudes. The coefﬁcient a0
of the ﬁrst template is an estimate of the ﬂux in the rest-frame optical range ð3500
A < k < 7500
AÞ, while the fractional
contribution of the other coefﬁcients a1=a0, a2=a0, and a3=a0 characterizes the spectral energy distribution (SED) of the galaxy.
The most signiﬁcant variation is along a3=a0. Taking the sum of the templates and projecting it onto ﬁlter responses, we can
calculate the K-corrections from the observed bandpass to any rest-frame bandpass. In practice, for the rare galaxies in our sample
around redshift z  0:3 this procedure is unstable. Thus, for this sample we ﬁx the coefﬁcients for all galaxies at redshifts z > 0:28
to the average value for galaxies between redshifts 0:26 < z < 0:28, corresponding to the typical red luminous galaxy SED. The
median redshift of the sample is 0.1, so in this paper we quote absolute magnitude rest-frame bandpasses shifted blueward from
the observatory frame bandpasses by a factor 1.1 and denoted 0:1r in r-band. This procedure minimizes the uncertainties in the
K-corrections, since galaxies near the median redshift are independent of their SED. For a galaxy exactly at z ¼ 0:1, the
K-corrections are trivial.
In the remainder of this section, we model the three-dimensional selection function ¯nðrÞ, which gives the expected number
density of galaxies in the absence of clustering as a function of three-dimensional position. For a uniform magnitude limit, our
selection function is separable into the product of an angular part and a radial part:
¯nðrÞ ¼ ¯nðˆrÞ¯nðrÞ;
where r  rˆr and ˆr is a unit vector. The angular part ¯nðˆrÞ may take any value between 0 and 1 and gives the completeness as a
function of position, i.e., the fraction of all survey-selected galaxies for which survey-quality redshifts are actually obtained, while
¯nðrÞ gives the radial selection function. As described in x 6, this separability allows powerful tests for possible systematic effects
arising from extinction or calibration problems, which would cause a purely angular modulation of density ﬂuctuations, or from a
misestimate of the radial selection function, which would cause a purely radial modulation of the density. The SDSS spectroscopic
completeness is so good that we ﬁnd no evidence for weather-related effects breaking the separability as in the 2dFGRS and therefore do not need to perform corrections for this effect as in THX02. We now describe our modeling of the two
factors ¯nðˆrÞ and ¯nðrÞ in turn.
A2. THE ANGULAR SELECTION FUNCTION
A2.1. Speciﬁcation
The geometry of the survey is somewhat complex because of the fact that the imaging and spectroscopy programs are carried out
concurrently. To supply targets for the spectroscopic program, periodically a ‘‘target chunk’’ of imaging data is processed, calibrated,
and has targets selected. These target chunks never overlap, so that once a set of targets is deﬁned in a particular region of sky, it never
changes in that region. Thus, the task of determining the selection limits used in any region reduces to tracking how the target chunks
cover the sky. This list of target chunks, their boundaries, and their selection criteria is an important product of sample11.
To drill spectroscopic plates that have ﬁbers on these targets, we deﬁne ‘‘tiling chunks,’’ which in principle can overlap more
than one target chunk. The tiling algorithm is then run in order to position tiles and assign ﬁbers to them,
after which plates are designed (that is, any available ﬁbers are assigned to various classes of auxiliary targets, as well as to sky and
calibration stars) and then drilled. In general, these tiling chunks will overlap because we want the chance to assign ﬁbers to targets
that may have been in adjacent, earlier tiling chunks but were not assigned a ﬁber. For a target to be covered by a particular tile, it
must be in the same tiling chunk as that tile and be within the area of the tile itself (because the edges of tiles can extend beyond the
tiling chunk boundaries, a particular region of sky can be within the area of a tile but not ‘‘covered’’ by it as deﬁned here). We then
divide the survey into a number of ‘‘sectors,’’ regions that are covered by a unique set of tiles and tiling chunks . For instance, two tiles overlapping each other but no other tiles give rise to three sectors: the area covered only by the ﬁrst
tile, the area covered only by the second tile, and the area covered by both.
For sample11 the sky area is covered by 669 circular tiles of diameter 2 .98 and is split into 2489 disjoint sectors. This
decomposition is convenient since each sector has a unique sampling rate. The sampling rate of a sector is deﬁned as the number of
redshifts of galaxy targets obtained in the sector (including the galaxies assigned the redshift of a neighbor because of a ﬁber
collision) divided by the number of galaxy targets in the sector. The sampling rate so calculated is about 95% on average across the
survey area; about 95% of the survey area has completeness greater than 90%. This is illustrated in Figure 1.
Two additional sets of geometric entities aAect the angular selection function ¯nðˆrÞ: it vanishes inside each of 55 rectangular holes
(regions masked out because of bad data quality or tiling bugs from early in the survey) and outside the oDcial survey region
deﬁned by 83 rectangular bounding boxes (the boundaries of the target chunks). In summary, the angular selection function ¯nðˆrÞ
equals the sampling fraction when inside the survey area and is zero otherwise.
An additional complication when one is evaluating ¯nðˆrÞ is that the above-mentioned geometric entities are speciﬁed in three
diAerent coordinate systems in various combinations: equatorial coordinates (right ascension, declination), SDSS survey coordinates ð
; kÞ, and SDSS great circle coordinates (,
TEGMARK ET AL.
A2.2. Spherical Polygon Representation
Fortunately, we can convert the speciﬁcation of ¯nðˆrÞ into an equivalent but much simpler form in terms of spherical polygons
that encodes all these complications. This simpliﬁcation is necessary since our power spectrum estimation method involves the
complex task of expanding ¯nðˆrÞ in spherical harmonics.
All tile, hole, and bounding box boundaries are simple arcs on the celestial sphere, corresponding to the intersection of the sphere
with some appropriate plane. This means that any convex spherical polygon (a tile, hole, bounding box, sector, etc.) can be deﬁned as
the intersection of a set of ‘‘caps,’’ where a cap is the set of directions ˆr satisfying ˆaG ˆr > b for some unit vector ˆa and some constant
b 2 ½1; 1
. Think of a cap as the area deﬁned by a plane slicing a sphere. For instance, a tile is a single cap, and a rectangular hole is the
intersection of four caps. The angular selection function ¯nðˆrÞ (plotted in Fig. 1) can be clearly represented as a list of nonoverlapping
polygons such that ¯nðˆrÞ is constant in each one. We construct the polygon list by using the MANGLE33 software described in
Hamilton & Tegmark , which involves the following steps:
1. We generate a list of 807 polygons comprising 669 tiles, 83 bounding boxes, and 55 holes.
2. Whenever two polygons intersect, we split them into nonintersecting parts, thereby obtaining a longer list of 8484 nonoverlapping polygons. Although slightly tricky in practice, such an algorithm is easy to visualize: if you draw all boundary lines on a
sphere and give it to a child as a coloring exercise, using four crayons and not allowing identically colored neighbors, you would
soon be looking at such a list of nonoverlapping polygons.
3. We compute the completeness nðˆrÞ for each of these new polygons, by using the scheme described in x A.2.1.
4. We simplify the result by omitting polygons with zero weight and merging adjacent polygons that have identical weight.
The result is a list of 2914 polygons with a total (unweighted) area of 2499 deg2 and an effective (weighted) area
Ð ¯nðˆrÞ d of
2417 deg2. These polygons are sometimes sectors, sometimes parts of sectors. This angular completeness map and the polygons
into which it resolves are illustrated in Figure 1.
A3. IMPOSING A UNIFORM MAGNITUDE LIMIT
As mentioned above, the faint magnitude limit varies in a known way from target chunk to target chunk and is hence a known
constant in each of our 2914 polygons. We construct a uniform galaxy sample that is complete down to a limiting magnitude rlim by
applying the following two cuts:
1. Reject all galaxies whose extinction-corrected magnitude r is fainter than rlim:
2. Reject all sectors whose extinction-corrected magnitude limit is brighter than rlim:
Figure 39 shows the number of surviving galaxies as a function of rlim: As we increase rlim; the ﬁrst cut eliminates fewer galaxies
whereas the second cut eliminates more galaxies. The result is seen to be a curve with peaks at 17.50, 17.60, 17.62, 17.67, and 17.77,
corresponding to the ﬁve magnitude limits used in spectroscopic target selection during the course of the survey. To maximize our
sample size, we choose to cut at the highest peak ðrlim ¼ 17:50Þ: This gives a sample of 157,389 galaxies, denoted safe0 in Table 1.
Since the optimal cut of 17.50 also happens to be the brightest magnitude limit used, we need not reject any sectors (as per cut 2), so the
angular footprint of this uniform subsample has the same area as that of the full sample. As the survey progresses further with its
current magnitude limit of 17.77, this will eventually become the limit that yields the largest sample.
Fig. 39.—Jagged curve shows number of galaxies surviving as a function of uniform magnitude cut and is approximately shaped as the product of the two other
curves, which corresponds to our two cuts: the rising curve shows the number of galaxies whose magnitude is brighter than rlim, and the falling staircase–shaped
curve shows the number of galaxies in sectors whose magnitude limit is fainter than rlim. [See the electronic edition of the Journal for a color version of this ﬁgure.]
33 Available at ajsh/mangle.
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
A4. THE RADIAL SELECTION FUNCTION
It is important to estimate the radial selection function ¯nðrÞ as accurately as possible, since errors in it translate into spurious
large-scale power. Our estimate is plotted in Figure 2 and is computed as follows.
The radial window function of sample11 is deﬁned by the galaxy luminosity function, the ﬂux limits, and the absolute magnitude
limits of the sample in question. As noted above, our sample is limited at bright and faint apparent magnitudes: 14:5 < r < 17:5.
Thus, at any given redshift we can observe galaxies only in a given absolute magnitude range. When making cuts based on absolute
magnitude, we use the quantity 0:1r described in Blanton , which refers to the r-band magnitude K-corrected to its z ¼ 0:1
value. Thus, evolution-corrected absolute magnitudes M are calculated from apparent magnitudes m as follows:
M ¼ m  DM ðzÞ  K0:1ðzÞ þ QðzÞ:
Here K0:1ðzÞ is the galaxy K-correction, as calculated by using the code of Blanton et al. , kcorrect v1_11. DM ðzÞ ¼
5 log ½rð1 þ zÞ
þ 25 is the distance modulus , where ð1 þ zÞr is the luminosity distance. QðzÞ accounts for the average
evolution in galaxy luminosities in the recent past, and we use the ﬁt QðzÞ ¼ 1:6ðz  0:1Þ. We will measure evolution in detail for
diAerent galaxy types in future papers; however, for the present work, this simple ﬁt for the evolution of all galaxies is suDcient.
At any redshift, the fraction of objects in this absolute magnitude range Mbri–Mdim that are in the sample is
Ð M dimðzÞ
MbriðzÞ ðMÞ dM
Ð M dimðzÞ
MbriðzÞ ðMÞ dM
where ðMÞ is the luminosity function (number density of objects per unit magnitude) and
MbriðzÞ ¼ max ½M min; 14:5  DMðzÞ  K0:1ðzÞ þ QðzÞ
MdimðzÞ ¼ min ½M max; 17:5  DMðzÞ  K0:1ðzÞ þ QðzÞ
In this context, K0:1ðzÞ is determined by using the mean galaxy SED in the sample. Equations (A4) and (A5) simply express the fact
that a galaxy must lie in our apparent magnitude range and in our absolute magnitude range to be included in the sample. The
luminosity function for our sample is determined in the manner described by Blanton et al. , by using the step-wise maximum
likelihood method of Efstathiou, Ellis, & Peterson , again by using QðzÞ ¼ 1:6ðz  0:1Þ.
We transform the galaxy positions into the Local Group frame, assuming that the solar motion relative to the Local Group is
306 km s1 toward l ¼ 99 , b ¼ 4 .
APPENDIX B
POWER SPECTRUM ESTIMATION DETAILS
In this Appendix, we describe our power spectrum estimation procedure in suDcient detail for the reader interested in reproducing our analysis.
B1. PARAMETERIZING OUR PROBLEM
We parameterize the ratio of the three power spectra PggðkÞ, PgvðkÞ, and PvvðkÞ to the prior as piecewise constant functions, each
with 97 ‘‘steps.’’ Doing this rather than taking the power spectrum itself to be constant avoids unnecessarily jagged spectra as
discussed in THX02. The resulting parameters pi are termed the ‘‘band powers.’’ As long as the prior agrees fairly well with the
measured result, this has the advantage of giving better behaved window functions, as described in Hamilton & Tegmark .
We group these 3
97 numbers into a 291-dimensional vector p. We choose our 97 k-bands to be centered on logarithmically
equispaced k-values ki ¼ 10 i65
Þ=16 h Mpc1; i ¼ 1; : : :; 97, i.e., ranging from 0.0001 to 100 h Mpc1. This should provide ﬁne
enough k-resolution to resolve any spectral features that may be present in the power spectrum. For instance, baryon wiggles have a
characteristic scale on the order of k  0:1; so we oversample the ﬁrst one around k  0:1 by a factor
k=ðk26  k25Þ  16= ln 10  7.
This parameterization means that we can write the pixel covariance matrix of equation (5) as
where the derivative matrix C;i  @C=@pi is the contribution to the covariance matrix from the ith band. For notational convenience, we have included the noise term in equation (B1) by deﬁning C;0  N, corresponding to an extra dummy parameter p0 ¼ 1
giving the shot noise normalization.
B2. QUADRATIC ESTIMATOR BASICS
Quadratic estimators were originally derived for galaxy survey applications . They were accelerated
and Brst applied to CMB analysis and have been a cornerstone of almost all recent CMB power
spectrum analyses.
TEGMARK ET AL.
Our quadratic estimators ˆpi deﬁned by equation (23) are designed to measure the corresponding parameters pi. We choose the
Q matrices to be of the form
MijC1C;i C1;
where m ¼ 291 is the number of bands (power spectrum parameters). M is an m
m matrix that we specify below. In the
approximation that the pixelized data have a Gaussian probability distribution (a good approximation in our case because we are
mostly in the linear regime), the choice of equation (B2) has been shown to be lossless, distilling all the power spectrum
information from the original data set into the quadratic estimator vector ˆp . This is true for any choice of the
matrix M as long as it is invertible: the result from using a diAerent matrix M0 could always be computed afterward by multiplying
the vector ˆp by M0M1:
The quadratic estimators ˆpi have the additional advantage (as compared with, e.g., maximum likelihood estimators) that their
statistical properties are easy to compute: their mean and covariance are given by equations (24) and (25), where the window
matrix W and the covariance matrix 2 are
Wij ¼ tr ½QiC;j
2ij ¼ 2tr ½QiCQjC
By substituting equation (B2), this gives
where F is the Fisher information matrix 
2 tr ½C1C;i C1C;j
In conclusion, the quadratic estimator method takes the vector x and its covariance matrix C from Figure 10 and compresses it into
the shorter vector ˆp in Figure 14 and its covariance matrix while retaining essentially all the cosmological information.
B3. QUADRATIC ESTIMATOR VARIANTS: CHOOSING THE M MATRIX
For the purpose of ﬁtting models p to our measurements ˆp, we are already ﬁnished—equations (24) and (25) tell us how to compute
2 for any given p, and the result,
2 ¼ ð ˆp 
h iÞt21ð ˆp 
is independent of the choice of M. However, since one of the key goals of our analysis is to provide model-independent
measurement of the three power spectra themselves, the choice of M is crucial. Ideally, we would like both uncorrelated error bars
(diagonal 2) and well-behaved (narrow, unimodal, and nonnegative) window functions W that do not mix the three power spectra,
W ¼ I being the ideal.
There are two separate issues of interest for choosing M. The ﬁrst involves the trade-oA between making 2 well behaved and
making W well behaved. The second involves the complication that we are measuring three power spectra rather than one and that
quadratic estimators tend to mix them, with estimators of one spectrum being contaminated by ‘‘leakage’’ from another. The
following two subsections discuss these two issues in turn. For all choices below, we wish each window function (row of W ) to
sum to unity so that we can interpret ˆpi as measuring a weighted average of the true power. Because of equation (B5), the rows of
M are therefore normalized to satisfy
ðMFÞij ¼ 1
for all i.
B3.1. Correlated, Anticorrelated, and Uncorrelated Band Powers
There are a number of interesting choices of M that each have their pros and cons . The simple choice in which M is diagonal gives the ‘‘best guess’’ estimates in the sense of having minimum variance and also has the advantage of being independent of the number of bands used in the limit of
high spectral resolution. It was used for Figures 13 and 15. Here the window functions are simply the rows of the Fisher matrix and are
seen to be rather broad. All entries of F are guaranteed to be positive as proven in PTH01, which means not only that all windows are
positive (which is good) but also that all measurements are positively correlated (which is bad).
Another interesting choice is M ¼ F1, which gives W ¼ I. In other words, all window functions are Kronecker
delta functions, and ˆp gives completely unbiased estimates of the band powers, with h ˆpii ¼ pi regardless of what values the other band
powers take. This gives an estimate ˆp similar to the maximum likelihood method , and the covariance matrix of
equation (25) reduces to F1. A serious drawback of this choice is that if we have sampled the power spectrum on a scale ﬁner than the
3D POWER SPECTRUM OF GALAXIES FROM SDSS
No. 2, 2004
inverse survey size in an attempt to retain all information about wiggles, etc., this covariance matrix tends to give substantially larger
error bars ðpi  M1=2
¼ ½ðF1Þii
1=2Þ than the ﬁrst method, anticorrelated between neighboring bands.
The two above-mentioned choices for M both tend to produce correlations between the band power error bars. The minimumvariance choice generally gives positive correlations, since the Fisher matrix cannot have negative elements, whereas the unbiased
choice tends to give anticorrelation between neighboring bands. The choice 
M ¼ F1=2 with the rows renormalized has the attractive property of making the errors uncorrelated, with the covariance matrix of
equation (25) diagonal. The corresponding window functions W are plotted in Figure 16 and are seen to be quite well behaved, even
narrower than those in Figure 15 while remaining positive in almost all cases.34 This choice, which is the one we make in this paper,
is a compromise between the ﬁrst two: it narrows the minimum-variance window functions at the cost of only a small noise increase,
with uncorrelated noise as an extra bonus. The minimum-variance band power estimators are essentially a smoothed version of
the uncorrelated ones, and their lower variance was paid for by correlations that reduced the eAective number of independent
measurements.
B3.2. Disentangling the Three Power Spectra
The fact that we are measuring three power spectra rather than one introduces an additional complication. As illustrated by Figure 18,
an estimate of the power in one of the three spectra generally picks up unwanted contributions (‘‘leakage’’) from the other two, making
it complicated to interpret. Although the above-mentioned F1 method in principle eliminates leakage completely (since it gives
W ¼ I), the cost in terms of increased error bars is found to be prohibitive. We therefore follow HTP00 and THX02 in adopting the
following procedure for disentangling the three power spectra: For each of the 97 k-bands, we take linear combinations of the gg, gv, and
vv measurements such that the unwanted parts of the window functions average to zero. This procedure is mathematically identical to
that used in Tegmark & de Oliveira-Costa for separating diAerent types of CMB polarization, so the interested reader is referred
there for the explicit equations. For the reader familiar with Bayesian statistics, our disentanglement procedure is tantamount to
marginalizing over the amplitudes of the other two power spectra, separately for each band.
The procedure is illustrated in Figure 18 and by construction has the property that leakage is completely eliminated if the true
power has the same shape (not necessarily the same amplitude) as the prior. We ﬁnd that this method works quite well (in the sense
that the unwanted windows do not merely average to zero) for the most accurately measured band powers, in particular the central
parts of the gg spectrum, with slightly poorer leakage elimination for bands with larger error bars.
The window functions plotted in Figure 24 are the gg windows after disentanglement. Note that although our disentanglement
introduces correlations between the gg, gv, and vv measurements for a given k-band, diAerent k-bands remain uncorrelated.
B4. NUMERICAL ISSUES
Our analysis pipeline has a few ‘‘knobs’’ that can be set in more than one way. This section discusses the sensitivity to such
B4.1. Prior
The analysis method employed assumes a ‘‘prior’’ power spectrum via equation (B1), both to compute band power error bars
and to ﬁnd the galaxy pair weighting that minimizes them. An iterative approach was adopted by starting with a simple BBKS
model for PggðkÞ , then shifting it vertically and horizontally to better ﬁt the resulting measurements and
recomputing the measurements a second time. As priors for PgvðkÞ and PvvðkÞ we use equations (21) and (22) with r ¼ 1 and
 ¼ 0:5; which provides a good ﬁt to the measurements.
To what extent does this choice of prior aAect the results? On purely theoretical grounds , one expects
a grossly incorrect prior to give unbiased results but with unnecessarily large variance. If the prior is too high, the sample-variance
contribution to error bars will be overestimated and vice versa. This hypothesis has been extensively tested and conﬁrmed in the
context of power spectrum measurements from both the CMB and galaxy redshift surveys (PTH01), conﬁrming
that the correct result is recovered on average even when a grossly incorrect prior is used. In our case, the prior by construction
agrees quite well with the actual measurements (see Fig. 14), so the quoted error bars should be reliable as well.
B4.2. Effect of Changing the Number of PKL Modes
We have limited our analysis to the ﬁrst N ¼ 4000 PKL modes whose angular part is spanned by spherical harmonics with ‘  40.
This choice was a trade-oA between the desire to capture as much information as possible about the galaxy survey and the need to stay
away from small scales on which nonlinear eAects invalidate the Kaiser approximation to redshift distortions. To quantify our
sensitivity to these choices, we repeated the entire analysis using the ﬁrst 500, 1000, 2000, and 4000 modes. Our power spectrum
measurements on the very largest scales were recovered even with merely 500 modes. As we added more and more modes (more and
more small-scale information), the power measurements converged to those in Figure 14 for larger and larger k: Figure 12 shows that
our 4000 PKL modes are all rather insensitive to cosmological information for k k 0:2:
B4.3. Convergence Issues
A key step in our analysis pipeline is the computation of the matrices Pi  @2=@pi that give the contribution to the signal
covariance matrix section from the ith band power. This computation involves a summation over multipoles ‘ that should, strictly
speaking, run from ‘ ¼ 0 to 1, since the angular completeness map itself has sharp edges involving harmonics to ‘ ¼ 1: In
34 The reader interested in mathematical challenges will be interested to know that it remains a mystery to the authors why this F1=2 method works so well. We
have been unable to prove that the resulting window matrix F1=2 has no negative elements (indeed, counterexamples can be constructed), yet the method works like
magic in practice in all LSS and CMB applications we have tried.
TEGMARK ET AL.
practice, this summation must of course be truncated at some ﬁnite multipole ‘cut. To quantify the eAect of this truncation, we
plot the diagonal elements of the P matrices as a function of ‘cut and study how they converge as ‘cut increases. We deﬁne a
given PKL mode as having converged by some multipole if subsequent ‘-values contribute less than 1% of its variance. Figure 40
plots the number of usable PKL modes as a function of wavenumber k; deﬁning a mode to be usable for our analysis only if it is
converged for all smaller wavenumbers k 0 < k for all three power ﬂavors (Pgg, Pgv, and Pvv). We use ‘cut ¼ 260 in our ﬁnal
analysis, since this guarantees that all 4000 modes are usable for wavenumbers k in the range 0–0:7 h Mpc1, i.e., comfortably
beyond the large scales 0–0.3 h Mpc1 that are the focus of this paper. With this cutoA, the computation of the P matrices
(which scales as ‘2
cut asymptotically), took about a week on a 2 GHz LINUX workstation. As a further test, we repeated our
entire analysis with ‘cut ¼ 120 and obtained almost indistinguishable power spectra.