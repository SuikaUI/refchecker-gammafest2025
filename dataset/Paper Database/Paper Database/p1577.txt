An Analysis of Polynomial Chaos Approximations for Modeling
Single-Fluid-Phase Flow in Porous Medium Systems
C.P. Ruperta,* and C.T. Millera
aDepartment of Environmental Sciences and Engineering, University of North Carolina, Chapel Hill, NC
27599-7431, USA
We examine a variety of polynomial-chaos-motivated approximations to a stochastic form of a steady
state groundwater flow model. We consider approaches for truncating the infinite dimensional
problem and producing decoupled systems. We discuss conditions under which such decoupling is
possible and show that to generalize the known decoupling by numerical cubature, it would be
necessary to find new multivariate cubature rules. Finally, we use the acceleration of Monte Carlo
to compare the quality of polynomial models obtained for all approaches and find that in general the
methods considered are more efficient than Monte Carlo for the relatively small domains considered
in this work. A curse of dimensionality in the series expansion of the log-normal stochastic random
field used to represent hydraulic conductivity provides a significant impediment to efficient
approximations for large domains for all methods considered in this work, other than the Monte Carlo
Stochastic; groundwater flow; Monte Carlo; Karhunen-Loève expansion
1 Introduction
Analysis of groundwater flow in naturally occurring water-saturated porous media is
influenced by significant variations in medium properties and source and boundary conditions
over relevant length scales. When this variability cannot be characterized deterministically
using available means, stochastic analysis of single-fluid-phase (hereafter simply single-phase)
flow through porous media is commonly performed [cf. 28,82]. The objective of such an
analysis is to characterize the uncertainty of quantities such as the hydraulic head or velocity
as a function of uncertain parameters and conditions in the model. This uncertainty is typically
described by low-order moments of the quantities of interest.
While the stochastic nature of subsurface systems has been recognized for more than a quarter
of a century , the quest continues for development of accurate and efficient methods of
stochastic analysis that effectively reduce such analysis to routine practice. An ideal, but
perhaps unattainable, solution to the problem would provide expressions functionally
incorporating stochastic parameters, associated with the conductivity field and boundary
conditions, from which desired statistical properties could be computed. This goal has not been
* Corresponding author. Email addresses: (C.P. Rupert), (C.T. Miller).
Publisher's Disclaimer: This is a PDF file of an unedited manuscript that has been accepted for publication. As a service to our customers
we are providing this early version of the manuscript. The manuscript will undergo copyediting, typesetting, and review of the resulting
proof before it is published in its final citable form. Please note that during the production process errors may be discovered which could
affect the content, and all legal disclaimers that apply to the journal pertain.
NIH Public Access
Author Manuscript
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
 
J Comput Phys. 2007 October 1; 226(2): 2175–2205.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
attained, except in special cases, and current practice often aims for somewhat less, such as
approximate values of the first few statistical moments. Calculation of such statistics involves
evaluation of certain integrals in probability space, but hydrological problems potentially
involve many degrees of freedom, and the density functions are often unknown.
Naïve Monte Carlo (MC) methods [e.g. 40] were the first to be used and are still often chosen,
being easily implemented adaptively and having the advantage of generality but converging
sublinearly at a rate independent of the stochastic dimension. Certain pitfalls must be avoided
when using MC methods: for example, the pseudorandom variates used for simulation can fail
in important ways . These methods are not easily conditionalized , and their slow
convergence has led to interest in acceleration techniques . Transformation of the
underlying probability space using importance sampling was suggested in , using a
spatially constant random conductivity field with one-dimensional flow, but to the best of our
knowledge it has not been considered for nontrivial stochastic flow problems.
One class of standard acceleration techniques involves preferential sampling of the underlying
probability space, as in the Latin hypercube method ; one might consider the direct attempt
to calculate statistical moments from simulations by a numerical cubature as a limiting case of
such methods, which has led to interest in sparse cubature schemes, as in Xiu and Hesthaven
 , for example. Chorin has suggested a variance-reduction use of Hermite series to
accelerate MC. Other alternatives include spectral methods , as well as perturbation series
methods and moment equations .
Polynomial chaos (PC) methods for approximating solutions of stochastic equations have
received recent attention in the water resources , engineering , and mathematics
literature . These methods approximate both stochastic model inputs and output using series
expansions to replace stochastic equations by deterministic systems that are then finitely
truncated and solved discretely. Variations of the method have been used to study diffusion
 and fluid dynamics . There is also a growing literature on applications of PC
methods to steady state flow in porous media and related elliptic equations [4,5,22,41,64, 77,
As opposed to MC methods, which require many domain-sized solves, PC methods typically
produce large coupled systems. In special cases, it is possible to decouple these large systems
into domain-sized problems, restoring one of the benefits of the MC approach. One technique
accomplishing this decoupling is the so-called method of double orthogonal variables (DOV),
solving a generalized eigenvalue problem to decompose the system. Another technique
decomposes an approximation to the system by computing certain expectations numerically.
As opposed to MC, none of these methods are adaptive: one decides in advance the
approximation to be used.
Applying the PC approach becomes problematic as the number of independent modes of
variability of the problem increases: if many variables are required to model the stochastic
inputs, the resulting systems can become quite large. The suggestion of Roy and Grilli ,
that moment methods might sometimes be more practical in such cases, led to a multivariate
moment method ; similar to MC, this method requires only domain-sized solves and can
be run until a desired tolerance is reached, at the cost of storing some prior results for reuse.
It is at present unclear which statistical approximation methods, if any, are superior. Some
methods, for example, easily produce approximate solutions to the stochastic equation that are
polynomial in the random input variables. There are also questions of applicability in complex
environments and convenience of use. Method-specific limitations arise, such as the restriction
to low-variability systems required by moment methods . A detailed comparison of
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
statistical approximation methods is currently lacking from the literature, and it is not clear if
and when such approaches are preferable computationally to MC methods.
The overall goal of this work is to investigate and compare methods to approximate low-order
stochastic moments of the single-phase groundwater flow equation. The specific objectives of
this work are: (1) to formulate a PC approximation of the groundwater flow equation; (2) to
summarize a set of methods that result in decoupled approximations; (3) to establish conditions
under which such decoupling is possible; (4) to formulate a MC acceleration and error analysis
approach based upon the derived stochastic polynomial models, (5) to compare the
approximation methods for computational efficiency; and (6) to assess the limitations and areas
of potentially fruitful future study for these methods.
2 Background
As described in Ghanem and Spanos , PC methods involve expanding random functions
of independent variates in orthogonal polynomials, based on work of Wiener and Cameron
and Martin , truncating the series and projecting to replace the stochastic systems by a
deterministic system. Solution of the deterministic systems then produces approximate
polynomial solutions to the original stochastic equation. Using properties of the orthogonal
polynomials, the integrals needed in moment calculations can be obtained directly. Related
ideas have been used to construct polynomial solutions to study climate , to model dose
and exposure , and to simulate watersheds . PC methods typically produce large
coupled systems, which can be tedious to derive and can require special solution techniques.
PC methods seem attractive because the underlying polynomial expansions can converge
quickly . These methods can also be used to produce easily conditionalized polynomial
models . But when many independent random variables are required to model the stochastic
inputs, it may be necessary to ignore some random variates in order to model the others to
sufficiently high degree, and the effects of this trade-off are not immediately clear. The
advantages might therefore be illusory when the number of degrees of freedom is large.
Pellissetti and Ghanem noted that for stochastic systems satisfying a certain linearity
condition, the PC approach involves matrices with a sparse block structure and suggested
avoiding full matrix assembly. Such systems are obtainable for the groundwater flow equation
with lognormal conductivity by rewriting the equation appropriately. For some truncations of
such systems, the DOV method, attributed in Keese to Werder et al. , will reduce the
problem to a number of uncoupled domain-sized problems. This decoupling is accomplished
by solving a generalized eigenvalue problem. Using this decoupling, Frauenfelder et al. 
studied an elliptic equation, with conductivity linear in each of the underlying random variates.
The DOV method has also been applied to a linear transport model .
Relations between numerical quadrature and pseudospectral methods being well known , several authors naturally investigated collocation techniques related to PC systems as an
alternative to projection methods . Numerical cubature has been applied to
simplify computation of expectations in PC expansions and as a method for estimating
PC coefficients without considering the coupled systems that result from projection . Babuska et al. studied the groundwater flow equation with a multilinear conductivity,
noted that the eigenvalues obtained by DOV are multivariate Gauss cubature knots, remarked
that the DOV decoupling strategy works in the multilinear case, and noted the equivalence of
DOV decoupling and numerical cubature in the stochastic dimensions (also called collocation)
in the case of a multilinear source and homogeneous Dirichlet boundary. Collocation based on
knots associated with sparse grid cubatures has also been studied . It has similarly been
remarked that PC systems can be decoupled by certain cubature formulæ: for example, Sandu
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
et al. have remarked that a cubature formula respecting the orthogonality of the
polynomials will decouple PC systems associated with certain mechanical problems.
PC methods have been applied to flow and transport problems . Babuska et al. 
provided a theoretical discussion of the relative merits of PC expansion and MC methods,
concentrating on cases for which DOV decoupling is available when the underlying variates
are independent and not examining more general truncations. Lognormal conductivities seldom
appear in PC investigations of the elliptic steady groundwater flow equation, but Babuska et
al. established that lognormal conductivities in the flow equation leads to well-posed
problems. Because the coupled systems are large, the question raised by Roy and Grilli 
remains: is the method really useful for ground-water flow equations? Related nonspectral
moment-method techniques have been examined as an alternative.
For hydrological investigations, the fields of interest are likely to involve more modes of
variation than can be modeled in full detail, and the effects of neglecting some variability are
therefore important. In this context, the relative accuracy of PC and related methods, and the
effects of domain size and field variability on the accuracy of the methods, deserves further
investigation.
3 Polynomial Chaos and Projection
The standard PC approach to approximate the solution of stochastic differential equations
involves: expansion of the uncertain input parameters and unknown dependent variables in
series of orthogonal polynomials, computation of certain expectations to produce a system of
deterministic equations, and solution of the deterministic system.
Consider the stochastic steady state porous medium flow equation
with first- and second-kind boundary conditions given by
where ∂D and ∂N respectively refer to complementary portions of the Dirichlet and Neumann
boundary. The conductivity K ≡ K(x, ω), source θ ≡ θ (x, ω), head H ≡ H(x, ω), and boundary
values HD(x, ω) and QN(x, ω)/K(x, ω) here are all random fields, functions of spatial position
x and of a certain finite set of random variates ω that have known joint probability density ρ
≡ ρ(ω). Throughout this article, ω always denotes one of the random variates in ω.
The head, source, and boundary terms are expanded as infinite series
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
involving a family of multivariate polynomials hα(ω) orthonormal with respect to ρ, as well
as purely spatial functions Hα, θα,
. To avoid negative diffusion coefficients, that
might result from truncation, K is not similarly expanded [cf. 4,64].
We substitute the expansions given by Eqs. (4) - (7) into Eqs. (1) - (3), multiply each of the
resulting equations by various hβ, and compute expectations relative to ρ. Thus from Eq. (1),
for example, we obtain
Similarly, Eqs. (2) and (3) produce
Similarly, rewriting Eq. (1) in the form
multiplying by hϕ and computing expectations yields
To proceed further, it is necessary to specify the field K as a function of the variables ω and
their joint density ρ; specify the polynomials hα; and compute explicitly certain integrals such
as Gβα. It is further necessary to choose a finite truncation of the infinite series in Eqs. (9) or
(15) and (12).
3.1 Further Specification
A natural interpretation, of the common view that the hydraulic conductivity K(x, ω) is
lognormal, is that the log-conductivity κ ≡ ln(K) is a Gaussian field. Whether conductivities
can reasonably be assumed lognormal is a regular topic of investigation: the distribution in a
sandstone formation, for example, varied with the part sampled , while a soil investigation
concluded the lognormal distribution fit the data better than a gamma distribution .
Although the validity of using Gaussian fields to describe log-conductivities remains open to
question , we adopt the hypothesis here because it is convenient for calculation and has
commonly been assumed . We thus assume a finite expansion for the log-conductivity of
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
involving the mean field κ̄(x) and certain auxiliary fields κω(x) indexed by the random variates
ω in the set ω. Expansions, or approximate expansions, of the form (16) can be obtained in
various ways, but there is some advantage to using a finitely truncated Karhunen-Loève
expansion (KLE). The KLE is determined by the mean κ̄(x) and covariance function cκ (x, x′)
of κ. The KLE terms and variates correspond to certain eigenpairs of an integral operator,
whose eigenvalues can be arranged in decreasing order λω1 ≥ λω2 ≥ λω3 ⋯; it is natural to say
that the variate ω is “more important” than the variate ω′ if the corresponding eigenvalues
satisfy λω > λω′. Series obtained by KLE have optimal mean-square convergence in the
following sense: no sum of n terms from any other series expansion of the random field can
produce a more accurate approximation of κ than the sum of the first n KLE terms . This
optimal convergence property explains the common use of KLE in PC analyses, because it
minimizes the number of variables required for a given accuracy and hence limits system size.
See Appendix A for details and references.
The assumption that κ is a Gaussian field leads to uncorrelated (hence independent) standard
normal variates ω ~ N(0, 1). The normalized univariate probabilists’ Hermite polynomials
(univariate h-polynomials) are defined by the three-term relation
with h0(ω) ≡ 1 and h1(ω) ≡ ω. These h-polynomials are orthonormal with respect to the standard
univariate normal density
Since ω is assumed finite, the product density
makes sense, and an orthonormal family of multivariate polynomials for ρ(ω) is obtained by
taking products of the univariate h-polynomials.
The remainder of this subsection involves some largely notational issues. To help fix ideas,
the reader may consult Appendix B, which contains some sample calculations. It is convenient
to forget the random character of the variates ω, when they are used for indexing purposes,
regarding them merely as formal variables appearing in certain polynomials.
There is a natural indexing of the multivariate h-polynomials: each monomial α, in the variates
ω, determines a vector of integer exponents 〈aω〉ω∊ω defined by
and we define the corresponding multivariate h-polynomial by
so α is the pure monomial part of the unique highest degree term in hα. The natural indexing
is a notational convenience: for coding purposes, it is useful to maintain a table of the various
exponent vectors ⟨aω⟩ω∊ω.
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
For the univariate h-polynomials, the triple product expectations are
and we define infinite matrices X0, X1, X2, ⋯ by
Appendix C contains explicit expressions for the matrix entries.
Similarly for the multivariate h-polynomials, the triple product expectations
define, for each monomial α in the variates ω, an infinite (but row and column finite) matrix
with entries indexed by the various pairs of monomials in those variates. The matrices Xα
describe the multiplication of the h-polynomials:
Since each variate ω is a monomial, the definition (24) makes sense for α ≡ ω, and the resulting
matrices Xω provide multivariate analogs of the univariate Jacobi matrix encoding the threeterm relation, that in the multivariate case becomes
In Eq. (27), αω and α/ω respectively denote the results of multiplying or dividing the monomial
α by the variate ω, with the convention that the second term is dropped if the variate ω does
not actually occur in α.
Because the matrix entries
can be computed exactly, it is possible to obtain exact
expressions for the entries of the matrices G and G–1; see Appendix C. The quantities
also required for the computation of higher order statistics, although the mean and covariance
function can be expressed easily:
Here, α ≠ 1 indicates that the summation extends over multivariate polynomials of positive
3.2 Truncation
For numerical purposes, the infinite series in Eqs. (9) or (15) and (12) must be truncated. We
write β≺ α to indicate that the monomial β divides the monomial α or (in other words) bω ≤
aω for each variate ω. By a truncation set τ of the system, we mean a finite set of monomials,
containing the constant unit monomial, and with the following property: whenever α belongs
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
to τ and β ≺ α, then β also belongs to τ. Throughout this article, τ always denotes a truncation
The set of variates ω∩τ actually appearing in τ may be a proper subset of ω. So we further
impose the following condition: whenever a variate ω belongs to τ, so does every variate “more
important” than ω, in the sense of §3.1.
We note, in particular, two special classes of a truncation set. By a total degree truncation set
τ = τ(e, d), we mean a truncation set obtained by choosing e of the most important variates and
then collecting the monomials α in those variates with total degree ∣α∣ ≡ Σωaω ≤ d. Such a
truncation set has size
and is related to a standard orthogonal decomposition of a Gaussian Hilbert space . By
a rectangular truncation set τ = τ(μ), we mean a truncation set consisting of all α ≺ μ for some
fixed monomial μ = ∏ωωmω . For such a truncation set, we also use the convenient notation
of Frauenfelder et al. , which describes a rectangular truncation τ(μ) in terms of the degreevector of μ
with indices ordered by decreasing importance of the variates; the size is ∏ω(1 + mω).
Each truncation set τ naturally induces truncations of matrices and summations, by restricting
the indices to τ. We indicate a truncated summation by Σα∈τϕα; in the case of a rectangular
truncation set, τ ≡ τ(μ), we write Σα≺μϕα. Given a random function Y (x, ω) with PC expansion
we define the truncated summation corresponding to τ by
In particular, this has the effect of zeroing the variates not in τ. We similarly indicate by X˘γ
the finite matrix with entries
with indices α and β (but not γ) restricted to lie in τ, which
will always be clear from the context and hence is not reflected in the notation.
3.3 Number of Variates
Solving the truncated system, consisting of (9) or (15) and (11)–(13), produces a polynomial
model from the truncated form of Eq. (4), and the statistics may be obtained as described in
The truncation set, however, must be chosen so the truncated system is not too large: the infinite
series in Eq. (4) is expected to contain terms of arbitrarily high degree, which are suppressed
by truncation, and in general ω ∩ τ will be a proper subset of ω and some of the true variability
of K will be lost.
If the conductivity K has a covariance functions decaying with separation, the field values
become increasingly decoupled at distance; the field therefore exhibits more degrees of
freedom on larger domains. Arranging the eigenvalues from a KLE in decreasing order λω1 ≥
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
λω2 ≥ λω3 ≥ ⋯, one may ask how quickly λωn decays as a function of n. Frauenfelder et al.
 obtained estimates for the decay of eigenvalues, showing the decay rate decreases with
increasing spatial dimension, and that the decay is faster for analytic covariance functions than
for the nonanalytic ones. Some intuition is provided by the one-dimensional case: Huang et al.
 have shown that the eigenfunctions approach sinusoids as the domain size increases and
the expansion approaches a spectral representation; thus, dropping eigenpairs with small
eigenvalues from the KLE corresponds to a primitive upscaling of the conductivity field, by
ignoring the higher frequency modes of variation of κ.
For our simulations, we adopted a Gaussian covariance that leads, on a two-dimensional
rectangular domain, to Kronecker product matrices and to rapid eigenpair decay; the required
expansion for the field κ was thus obtained as a sum of products of the discretized onedimensional eigenfunctions for the separated components of the covariance function. Table I
illustrates that many eigenpairs may be required to obtain a random field that approximates the
target field well by KLE. This table shows the L2 error of the approximate covariance function
on a unit square obtained from a truncated KLE as a function of domain size in correlation
lengths and number of retained variates. The data were obtained by computing the
eigenfunctions Ψω of an isotropic Gaussian covariance
with correlation length ϱ on a unit square Ω and computing
where x0 is a corner point of Ω, the norm is defined by spatial integration
is an estimate for cψ, based on Eq. (A.4) but using only the eigenpairs corresponding to the
largest eigenvalues.
In general, the total number of variates required is expected to exceed the number required to
reproduce κ accurately, since not all variability in the source term and boundary conditions
will arise from modes of fluctuation of the log-conductivity field.
4 Decoupling the Polynomial Chaos System
The size of the coupled systems, produced by projection, grows quickly with the number of
normal variates ω and the degrees of the retained h-polynomials hα, which limits the feasibility
of the PC methods. In certain cases, however, the large system given by Eq. (15) can be
decoupled: that is, it is possible to solve the large system by solving a number of independent
domain-sized problems. Using Eq. (16) to expand ln(K), together with the definition (24)
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
For each α and ϕ , the summation
contains at most one nonzero term. After truncating
the system in Eq. (38), it is natural to attempt to decouple the system by simultaneous
diagonalization of the truncated matrices X̆ω. As shown in Appendix D, such a simultaneous
diagonalization is possible only for rectangular truncation sets τ = τ(μ). In this case, the
diagonalizing matrix Uτ has entries
where the ζ are the knots, for the cubature given by the tensor-product of the corresponding
univariate Hermite-Gauss (HG) quadratures, while the squares of the Cζ are the corresponding
weights Wζ . Further, the eigenvalue of Xω, corresponding to column ζ of Uτ, is simply the ωcomponent zω of the tensor-product cubature knot ζ. Note that retaining only the τ(μ) terms in
the PC series for a random function Y and setting each ω = zω yields
In the sections that follow, We discuss two related decoupling strategies for rectangular
truncation sets: the method of DOV and the collocation by cubature.
4.1 Double Orthogonal Variables
With a rectangular truncation set τ = τ(μ) of the variables, the matrices X̆ω are simultaneously
diagonalized by Uτ:
and denote by κ̆τ(x, ζ) the result of setting ω = zω for each ω in τ and zeroing the remaining
variates in the expansion of κ. Applying the matrix Uτ to Eq. (38) yields
Boundary conditions are handled similarly, leading to
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
This leads to the following polynomial model:
so that the DOV decoupling corresponds to multivariate polynomial interpolation back from
the solutions H̆τ(x, ζ) of certain auxiliary problems indexed by the multivariate HG knots ζ.
In special cases, the DOV decoupling corresponds to interpolation from certain natural
problems: one simply truncates the series for the boundary conditions and evaluating the
truncated series at the knots ζ, then performs the interpolation corresponding to the HGcubature. This holds, in particular, in the multilinear cases isolated by Babuska et al. . In
the general case, the auxiliary problems, on which the interpolation is based, seem less natural.
The method of DOV has limited applicability: as shown in Appendix D, the matrices X̆ω
commute only for rectangular truncation sets; even in this case, the matrix Uτ will not
diagonalize other matrices X̆α.
4.2 Approximate Collocation
Since the double orthogonal variable decoupling reflects a polynomial interpolation based on
tensor-product cubature knots, it is reasonable to consider approximating the various integrals,
involved in the stochastic projections, by the corresponding cubature formulæ. Unlike the
truncated matrices X̆γ, the approximations X̃γ computed by the cubature formula are all
diagonalized by the matrix Uτ, so all expressions simplify further.
With a rectangular truncation set τ = τ(μ) of the variables, Eq. (9) becomes
One obtains by the corresponding Gaussian cubature
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
Here H^ is defined by Eq. (42); Eq. (56) results from a division by Cγ; and we continue to use
the definition (40). The Dirichlet boundary condition in Eqs. (47) and (48) is unaffected, while
the Neumann condition becomes
The interpolation scheme (49) remains in effect. For these equations, there seems to be no
obvious reason to prefer the truncated expansions θ̆τ(x, ζ), H̆τD(x, ζ) and Q̆τN(x, ζ) to the exact
evaluations θ(x, ζ), HD(x, ζ) and QN(x, ζ), use of which may avoid a somewhat tedious
expansion.
Thus, in the collocation decoupling, as opposed to the DOV decoupling, the log-conductivity
need not be multilinear. Moreover, the problems on which the polynomial interpolation is based
are simpler in the case of the collocation decoupling. In fact, given a stochastic equation for
an unknown Z ≡ Z(ω) involving known functions Y1(ω), ⋯ , Yn(ω) of independent normal
variates, rectangular truncation of the PC expansion for Z, with computation of the projections
by tensor-product HG cubature, will produce a system neatly decoupled by the matrix Uτ, and
the functions Y will be replaced by their values (or the values of their truncated expansions) at
the knots ζ.
The calculations in this section will not directly generalize to nonrectangular truncation sets.
In Appendix D, it is shown that there is no exact analog for HG cubature for the nonrectangular
truncation sets τ. A cubature rule, having the same number of knots as monomials in τ, either
fails to respect the orthonormality of the h-polynomials corresponding to monomials in τ or
miscalculates entries in some X̆ω . Appendix D contains a brief discussion of the restrictions
imposed by such a decoupling cubature rule, and some indications of the problem that would
have to be solved to find such a cubature. To our knowledge, the relations of such cubature
problems to polynomial chaos have not been explored.
5 Karhunen-Loève-based Moment Equations
The Karhunen-Loève Moment Equation (KLME) method, introduced in Lu and Zhang 
and Zhang and Lu , offers a polynomial interpolation method with reduced coupling
between polynomials: the field H is expanded in a multivariate power series
where, as before, the α denote monomials in the random variates ω obtained from κ by KLE.
Inserting the expansions of H and the log-conductivity κ into Eq. (14), expanding the modified
source θe-κ in a multivariate power series, and comparing terms, one finds Hα satisfies an
equation in which the source-term involves various Hα/ω, so the coefficient fields Hα may be
found successively. The expectations E[α] being known, the various covariance functions
involving H are directly computable. Calculations can become somewhat more convenient,
however, if one transforms the expansion of Eq. (58) into a Hermite series, which is inexpensive
as the basis-change coefficients, described in Appendix C, form sparse upper triangular
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
KLME seems attractive since, like MC, it requires only domain-sized solves and can be applied
adaptively, without initial decisions regarding the truncation set. But even in the univariate
case, techniques based on manipulation of ordinary power series may not perform well with
the generality of PC expansions. Because the moments E[ωn] grow rapidly, simple series
manipulations may not produce sensible results. The following can occur, for example. An
ordinary (nonstochastic) function ϕ may admit a Taylor series expansion which converges
everywhere in the ordinary sense, and the expectation E[ϕ(ω)] may exist for the Gaussian
variate ω, yet an attempt to compute E[ϕ(ω)] by taking the expectation term-by-term from the
ordinary Taylor expansion yields a non-convergent series. Use of ordinary series expansions
in a stochastic setting may therefore require careful attention. On the other hand, under mild
conditions Cameron and Martin establishes a good Hermite series approximation to ϕ,
considered as a function of the Gaussian variate ω.
6 Nicolaides Interpolation
To obtain polynomial models, using the decouplings of §4, becomes increasingly expensive
with dimension: the cost of the cubatures is exponential in e, and the interpolatory matrix Uτ
of Eq. (49) is full. Because these decouplings indicate that the PC attack on a stochastic equation
is closely related to polynomial interpolation in stochastic space, further examination of
interpolation seems reasonable.
Using various sparse cubature schemes Xiu and Hesthaven have considered a collocation
solution of a one-dimensional analog of Eq. (1) with independent uniform variates ω. Although
the sparse cubatures considered involve many fewer knots than the full tensor-product
HG-cubature, the number of required knots is still a multiple of the number of PC terms sought.
Furthermore, the effect of this multiple may be non-negligible, since each function evaluation
requires solving a realization of Eq. (1).
We briefly consider, as a simple alternative to the decouplings of §4.2, solving the polynomial
interpolation problem with N(e, d) knots by the method of Nicolaides . In this method,
interpolatory polynomials are constructed using hyperplanes defined by barycentric
coordinates relative to a given simplex. For the standard simplex with vertices defined by the
origin and standard basis vectors, one considers vectors ζ ≡ (zω1, zω2, ⋯ , zωe) of non-negative
integers satisfying ∣ζ∣ ≤ d and takes as knots the points with spatial coordinates nζ ≡ ζ/d. The
corresponding interpolatory polynomials are defined by
If instead, one dilates the standard simplex by the factor d, the knots coincide with the vectors
ζ and the polynomials become pζ(ω/d). Carnicer et al. have obtained error estimates for
such interpolations. A simple algorithm thus results by solving Eq. (1) at the Nicolaides knots
and using Eq. (59) to obtain a polynomial model; statistics are available from the typically
sparse matrix of moments.
7 Monte Carlo Simulation
We next consider evaluation of the quality of a truncated PC expansion by comparison to naïve
MC. Although it seems natural to value a PC solution in terms of the number of MC simulations
required to obtain the same accuracy, judging quality in this manner is problematic, since the
exact problem solution is unknown. Chorin proposed use of univariate Hermite expansions
to accelerate MC, and Maltz and Hitzl suggested the extension to multivariate expansions.
Here we instead use such ideas to evaluate the accuracy of PC expansions, rather than to
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
improve MC. A PC solution provides a polynomial “easy function” that can be used to
accelerate MC by variance reduction. This acceleration provides a natural, easily estimated
measure of the accuracy of the approximate PC coefficients.
Approximate statistics of a random function η can be obtained from a sequence ηj of N
independent realizations. Direct calculation shows the estimator
for the mean η̄ converges subject to the estimate
where σ is the standard deviation of η. As the mean η̄ is unknown, convergence may be
conveniently judged by examining the fluctuation sizes between successive estimates; the
fluctuation of η̄N with lag k is given by
where σ2 is the variance of η, and the log-fluctuation of the standard deviation is therefore
when N ≫ k.
Another estimator for the mean head can be obtained from H̄N, using a finite approximation
to the PC expansion H = ΣαHαhα of the true field H. Each realization κj is associated with a
collection ω(j) of specific values for the variates ω, and the Hj, obtained by solving Eq. (1) with
log-conductivity κj, can be approximated by substituting the ω(j) into the approximate PC
expansion to obtain
so the multivariate h-polynomials, defined by (21) and (17), are required here.
Consider the accelerated estimator
where the H̄est is the estimated mean head obtained from the PC approximation (64). The naïve
estimator H̄N has variance
while the accelerated estimator
has variance
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
where Σα≠1 denotes summation over the exponent vectors < αω >ω∈ω corresponding to
nonconstant multivariate h-polynomials hα, with the convention
for α not belonging
to τ. Convergence of the modified estimator is accelerated relative to the naïve estimator by
the factor
in the sense that use of the accelerated estimator
leads to approximately the accuracy
expected from H̄Nϕμ; true acceleration, of course, only occurs if ϕμ > 1. The factor ϕμ can be
easily be estimated using Eq. (63): in log-log space, regression lines for the fluctuations of
(both with lag k) should be approximately parallel, with negative unit slope,
separated by log(ϕμ). The acceleration measures the accuracy of a truncated PC expansion,
since 1/ϕμ is the relative error associated with the truncation.
To assess the quality of a PC approximation, by comparing the unaccelerated and accelerated
estimators as just described, it is necessary to obtain the PC coefficients together with the
variate values ω(j) for each realization κj and to evaluate the PC expansion at those values. The
acceleration of higher order moments may be gauged similarly, using the analogous variance
reduced “easy functions”
where Hj and
are again the actual and estimated values of the head for a particular
realization and the uncentered moment
is precalculated from the approximation Hest.
In the discussion above, the acceleration is measured pointwise throughout the domain. Rather
than obtaining a domain-averaged version, we produce two estimates, differing in the order in
which ratios are computed and domain-averaging conducted. We describe these estimates for
the mean, the variance is handled similarly. The first estimate domain-averages the logspace
fluctuations of the ordinary and accelerated MC generators and, assuming that true results
would be approximately governed by a linear law of the form (63), uses the average separation
of the lines of best fit to estimate the reduction of variance. This estimate is thus obtained from
the separation of the lines of best fit to log ∥H̄n − H̄n+k∥Ω and
. The second
estimate domain-averages the difference of the logspace fluctuations and, assuming that the
results would be approximately constant, uses the average height of the line of best fit to
estimate the reduction of variance. The second estimate is obtained from the average height of
the line of best fit to
A polynomial model may be compared to MC in the following manner. By the triangle
inequality, an MC estimate H̄N of the mean H̄ is more accurate than the estimate H̄est provided
by a polynomial model once the MC estimate error is less than half the difference between the
two estimates. Thus MC results are expected to be more accurate than PC results when
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
where ΔMCN ≡ ∣H̄N − H̄N+k∣ is the MC fluctuation. The left side of the inequality should tend
to a constant with increasing N, while the right side continues to decrease. Equivalently, MC
Higher order moments may be treated similarly.
8 Implementation and Results
In principle, any simulator for the field κ could be used, since the family ω can then be recovered
using Eq. (A.3). However, as Xiu and Karniadakis have noted, additional numerical issues
would arise if a generator, different from that analyzed by the PC expansion, were used for
MC; we therefore simulated κ using the computed KLE. The same generator is reused to
compute the values of exp(κ˘τ) at the cubature points in the solution of the decoupled system.
After solving the decoupled systems of §4, the approximate solution of the coupled PC system
is recovered by polynomial interpolation back from the multivariate knots. As discussed in
§3.2, the variates appearing in τ may be a subset of those in ω: that is, the KL simulator may
include variability for which the truncation set τ does not account.
A pseudorandom variable cannot pass all statistical tests. PC analysis requires the nonconstant
multivariate probabilists’ h-polynomials (in a standard normal variate) to vanish in expectation,
and good correspondence between MC and PC results cannot be expected if the simulated
expectations E[hn] are large. Bontemps and Meddahi have remarked that the vanishing of
such polynomials is actually characteristic of the standard normal distribution. This leads to a
natural family of conditions E[hn] ≡ 0 (n > 0) for the pseudorandom generator. We examined
the ziggurat, described in Marsaglia and Tsang and references therein, and implemented
by Matlab’s randn, as well as Box-Muller transformations of several uniform generators
(Matlab’s rand, the Sedgewick generator, L’Ecuyer’s MLCG ), and the Mathwork’s mexfile implementation of Twister , before choosing the ziggurat for N(0, 1) variate simulation.
Estimators described in §7 were obtained using 1000 MC simulations with lag k ≡ 10.
For computational purposes, the indices α of the h-polynomials can be encoded by a table, with
the row corresponding to α containing the exponent vector < aω >ω∈ω. For total degree
truncation sets, such a table with degree-lexicographic ordering can be built quickly by
recursion on the degree.
The operator ∇K∇ was discretized using a central five-point finite difference stencil. The
operator ∇κ · ∇ + ∇2, was discretized using central second-order finite differences for the first
term and a five point stencil for the Laplacian. Stencils for the coupled system were obtained
using the same projection technique described in §3, that is, by multiplying the stencil with
various h-polynomials and computing expections. The numerical versions of the computed PC
fields then actually provide a truncated PC expansion of the numerical version of H. The
symmetric systems resulting from (1) were solved using the conjugate gradient method and
the nonsymmetric systems resulting from (14) were solved using the biconjugate gradient
method. In both cases, Jacobi preconditioning was used on a 50 × 50 grid; for comparison
purposes, some cases were rerun on a 100 × 100 grid.
8.1 Analytic Example
Simple analytic examples can provide some information regarding the accuracy of PC methods.
Given independent standard normal variates ω and corresponding functions kω (on domain
Ω) satisfying
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
Then equation (1) with boundary conditions
has analytic solution
against which MC and PC solutions can be compared. We take
with normalization constants cmn and certain synthetic eigenvalues λmn. Double orthogonal
variable decoupling requires computation of the source-terms from Eq. (46)
In this fashion, small dimensional examples can be constructed for which MC converges slowly
while PC methods provide accurate results; it is also possible to construct such examples for
which the decoupled PC methods do not produce acceptable results. Such examples also
illustrate the reason for the decision in §3, to work with the conductivity in the form K ≡ exp
(κ), rather than using a truncated Hermite series
with Kα found, for example, from Eq. (C.9); use of the truncated series can lead to erratic
numerical breakdown. Since the statistics vary rapidly in space the two acceleration estimates
described in §7 can differ substantially for such examples.
Taking m1 = n1 = 1, m2 = n2 = 2, λ11 = 0.5, and λ22 = 0.25, using the rectangular truncation set
described in the notation of §3.2 as
or τ = , and decoupling by DOV,
produces mean and variance estimates an order of magnitude more accurate than those provided
by 1000 naïve MC simulations. The same example, using the exact collocation source term
(rather than the truncated collocation source suggested by the tensor-product HG cubature) in
the collocation decoupling actually provides a slightly more accurate variance estimate than
provided by the orthogonal variables decoupling (with errors measured in the L∞ spatial norm).
The Nicolaides interpolation based on the dilated simplex is completely unsatisfactory for this
example; the analogous interpolation based on the undilated simplex reproduces some basic
features of the exact solution (in the degree five case, say) but suffers rapid breakdown with
increasing degree and does not appear competitive with the tensor-product interpolation.
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
8.2 Non-Analytic Investigation
Using a twenty-term KLE to simulate the log-conductivity field, we solved (14) in the sourcefree case on the unit square with two opposite no-flow and two opposite constant head
boundaries
for a range of domain sizes (measured in correlation lengths ϱ) and variances of the logconductivity κ, assuming the Gaussian covariance described by Eq. (34). Polynomial models
were evaluated by calculating MC accelerations as described in §7; not all variates used for
the field simulator are necessarily included in the analysis leading to the models. To compare
polynomial models to MC, we used Eq. (73).
Four different polynomial models were compared: the one obtained from HG cubature, the one
obtained by Nicolaides interpolation, the one obtained from the coupled PC system in Eq. (15),
and the one obtained by KLME. Table II exhibits results for the HG cubature associated with
the DOV decoupling, Table III for Nicolaides interpolation, Table IV for the coupled PC
systems, and Table V for the KLME method. The truncations for Table II were chosen to
involve truncations sets of approximately the same size as those used in Tables III, IV, and V,
so that the number of function evaluations is approximately equivalent for all cases shown.
These tables all exhibit MC acceleration factors ϕμ and ϕσ for head mean μH and variance
, as functions of domain size ϱ−1 × ϱ−1 and log-conductivity variance
. In calculation of
Table V, solver failures of unknown origin affected one row (marked by an asterisk), which
was therefore recalculated independently.
Several distinct issues contribute to the nonagreement between the numerical acceleration
estimates given in each row of the tables. As discussed in §7, the estimates ϕμ(est1) and
ϕμ(est2), and similarly the estimates ϕσ(est1) and ϕσ(est2), differ in the order in which ratios
and domain-averages were calculated. See Fig. 1 in which the average gap between the lower
lines represents the first estimate, while the average height of the upper line represents the
second estimate. There is no reason to expect the first and second estimates to agree precisely.
Moreover, the final estimates are obtained by exponentiating the results of such linear
regressions in log-log space based on MC simulations. But the natural measure of the error is
the reciprocal of the acceleration. For example, a table row with acceleration factors ranging
from 40–50 would correspond to estimated relative errors of 2.0–2.5%. On balance, the table
data appear surprisingly consistent.
8.3 Discussion
8.3.1 Acceleration Factors—As discussed in §3.3, the number of variates required to
accurately describe the field κ will increase with domain size (measured in correlation lengths).
For a fixed truncation, increasing domain size increases the importance of un-simulated
variates, and we therefore expect accuracy to decrease with domain size. The loss of accuracy,
however, persists for the truncation (e, d) = (20, 2), although the twenty-term KLE we use as
a simulator models the effect of all twenty variates to second order in this case.
Acceleration factors reported in the tables estimate the accuracy with which the various
methods capture the influence of the variates. Our reported factors are overly optimistic because
we simulate, not the full intended Gaussian field, but rather a truncated version that involves
only a finite number of variates. Using more terms, from the KL expansion of the field, in these
simulations should reduce the acceleration factors.
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
Because stencils for the PC systems were produced by inserting the KL and PC expansions
into the deterministic stencils and projecting, as described in §3, the numerical PC coefficients
reflect truncated PC system approximations to the random variates forming the numerical H
field. The latter variates change with the discretization, but given sufficiently many PC terms
one expects from the Cameron-Martin theorem that the numerical PC coefficients will
faithfully model the numerical field, whether or not the numerical field accurately models the
intended field. In support of this view, consider Table VI which exhibits the acceleration factors
computed using a domain one correlation length in size for the truncations (e, d) = (5, 5) and
(e, d) = (9, 3) with various discretizations. For Table IV acceleration factors smaller than about
15 (that is, in all (e, d) = (5, 5) cases), there is a spread of about 3% between the various
estimates; when the acceleration factors are near 20 (that is, in the (e, d) = (9, 3) case with
), the spread is about 2%; and for acceleration factors larger than about 35 (that is, in
cases of (e, d) = (9, 3)), the spread is only about 1%. Data in the
tables indicates acceleration factors for a given truncation decrease with increasing variance
and with increasing domain size for all methods considered.
The first effect seems natural: had we not renormalized our variates ω by absorbing their
deviations into the eigenfunctions κω, the leading term of each h-polynomial hα would include
these variances; the rescaling must transfer this contribution to the Hα, which consequently
must scale as polynomials in σκ; and thus neglected higher-order terms become more important
as the variance increases.
The second effect may be more complicated. The slower eigenvalue decay associated with
larger domains (cf. §3.3) has several consequences. As domain size increases, later eigenvalues
become relatively more important, and neglected higher-order terms become more important
as with increasing
. In particular, any failure to model all variates used by the MC simulator
will produce larger errors on larger domains, as unmodeled contributions to the variability of
κ increase. There being no ignored variates for our (20, 2)-truncation (because our simulation
of the log-conductivity field involved only the 20 most important eigenpairs), the decrease in
accuracy with increasing domain size in this case cannot be attributed only to missing variates.
That the effect is seen in the case (e, d) = (20, 2), not only for PC but for KLME and the
Nicolaides interpolation as well, provides additional evidence that the true H is more
complicated and requires a higher-order analysis when the eigenvalues are more nearly equal
than when there are relatively few large eigenvalues with the rest small.
For PC, there is a further possible contribution, associated with inaccurate calculation of the
coefficient fields Hα, because truncation eliminates the full coupling between the defining
equations. This effect is more diffcult to probe, because different truncations ignore different
coupling effects. On small domains, where relatively few eigenvalues are important, one might
expect the coupling among the first nine variates to be more important the coupling between
the first nine and the last eleven, while the latter coupling effects become relatively more
significant with increasing domain size. To test this, we replaced Hα computed by PC for the
(20, 2)-truncation by the corresponding Hα computed for the (20, 2)-truncation; the
replacements were made for the Hα with index α in the set of 55 indices τ(9, 3) ∩ τ(20, 2)
common to both truncations. Acceleration factors were computed as before by MC, using the
(20, 2)-table with the indicated replacements. Results are exhibited in Table VII, which
suggests some improvement only on 1 × 1 and 2 × 2 domains and only in the small variance
case and suggests some deterioration of the approximation in the remaining cases on the 1 ×
1 domain. In general, it is not clear how to improve the estimated Hα except by using larger
coupled systems.
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
8.3.2 Polynomial Chaos and Karhunen-Loève Moment Equations—The PC
approach and KLME both yield polynomial models without much additional computation. The
comparative accuracy of these methods is therefore interesting. Comparing Tables IV and V
indicates that KLME may outperform PC when using a small number of variates to approximate
a field of low variability. With increasing variability and number of variates, PC typically
outperforms KLME.
Use of inequality (73) to compare the accuracy of the polynomial model and MC is illustrated
for estimates in Figs. 2, 3, and 4. The straight lines provide the first acceleration estimate, while
the irregular line provides the left side of inequality (73). Once the irregular line permanently
falls above the upper straight line, representing the MC fluctuations, the MC estimate of the
mean has become the more accurate of the two. In Fig. 2, cross-over occurs prior to 100 MC
simulations, while N(20, 2) = 231. In Fig. 3, the irregular line does not fall above the upper
line, indicating N(5, 5) = 252 iterations of KLME outperform 1000 MC simulations. In Fig. 4,
the coupled PC system for the truncation τ = τ(9, 3) apparently outperform 600 but not 1000
MC simulations.
Comparison of KLME to MC by this method is straightforward, since KLME involves only
domain-sized solves. For the given truncations τ = τ (e, d), with few exceptions, KLME wins
over 1000 MC simulations, and in the exceptional cases KLME clearly provides better accuracy
than would be obtained by MC using N(e, d) solves. Comparison of PC to MC by the same
method is less meaningful, since the coupled PC system does not involve domain-sized solves
and because a cubature decoupling would result in loss of accuracy, if it even existed. In almost
all cases, the results obtained from the coupled PC system are more accurate than those obtained
from 1000 MC realizations, and in the exceptional cases at least 600 MC realizations are needed
to produce more accurate results. In our unoptimized code, the time needed for 1000 MC solves,
together with the inexpensive auxiliary computations needed to compute the variance reduced
estimators, is typically about twice that needed for the coupled PC system solve.
Individual matrix-vector multiplies, associated with the coupled systems for the truncation sets
in Table IV, are about three orders of magnitude more costly than those associated with domainsized solves. KLME requires eN(e, d−1) auxiliary matrix multiplications, but this extra cost
associated with computing the problems to solve is small in our examples.
Thus, both PC and KLME appear to be competitive with MC on small domains. However, it
is important to note that the feasibility of PC in this case depends heavily on the possibility of
rewriting the stochastic equation in the form given by Eq. (14); projecting instead from Eq. (1)
leads to intractably large systems. For both methods, it is clear that modeling enough variates
becomes important as domain size increases, while on smaller domains a significant advantage
can be obtained by ignoring some variates in order to use a higher degree model.
8.3.3 Interpolation and Cubature—Although HG cubature can produce good results when
the number of required variates is small, our data might suggest that, for similar effort,
Nicolaides interpolation outperforms HG cubature. However, the large size of rectangular
truncation sets obstructs matching of the number of variates and degree to the problem, and
the data illustrate the importance of an appropriate truncation, as is clear from the PC and
KLME data: thus, for example, for
on a 1 × 1 domain, the truncation set τ = τ(9, 3)
provided better results for both PC and KLME than any other triangular truncation set
considered, while for
on a 3 × 3 domain, the truncation set τ = τ (20, 2) provides the
best result.
Compared to PC and KLME, Nicolaides interpolation does not perform particularly well. This
is not surprising, because no effort has been devoted to the optimal choice of the knots.
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
Nicolaides interpolation with the undilated standard simplex, in fact, may negatively accelerate
MC convergence; we used the dilated simplex.
Because the cost of obtaining a polynomial model from a cubature rule involves full matrices
and is therefore is quadratic in the size of the truncation set, it is natural to seek interpolatory
methods which involve relatively sparse matrices, as would be the case with Nicolaides
interpolation. We do not know if good interpolatory methods, that can be applied adaptively,
can be found for non-rectangular truncations. Stable interpolatory methods exist, in principle
at least, for any finite set of bounded functions but may not be convenient when the set of
functions varies. The sparse cubature methods examined in can be applied adaptively, by
choosing nested knots, but have substantial overhead costs. KLME offers an adaptive method,
which is competitive in the low-variance case with PC expansions, when not too many terms
are included in the expansion. Both cubature rules and interpolatory methods deserve further
examination as approaches to stochastic problems; for more information, see ).
8.3.4 Remarks on the Non-Gaussian Case—Two-point statistics cannot reproduce
important features, such as networks of high-permeability channels , of interest to
hydrologists. There has therefore been some interest in multipoint statistics, and non-Gaussian
distributions are then indicated, because multivariate normal densities are completely
characterized by their moments to second order.
We now remark on the effect of eliminating the independent normal variate assumption. For
independent variates, of course, calculations still reduce to manipulations of univariate
polynomials; Koekoek and Swarttouw is a useful reference. Without assuming
independence, one might begin as before, approximating the conductivity as a function K(x,
ϖ) ≡ ϕ[ϰ(x, ϖ)] of some auxiliary field expansible in a finite series
with uncorrelated (but not necessarily independent) variates ϖ, which may be assumed
centered with unit variance. As indicated in D.3.2, one obtains under mild hypotheses a threeterm recurrence for an orthonormal collection of multivariate polynomials πα(ϖ). But beyond
the problem of selecting a multivariate density, there is the further diffculty of computing the
high-dimensional integrals required for the recurrence coefficients, when the number of
variates is large.
Although simple formulæ for the
are not expected without special assumptions, convenient
calculation may nevertheless sometimes be possible. Replacing each ϖ with the corresponding
Xϖ, in the three-term recurrence for the polynomials πα(ϖ), produces a valid recurrence for
the matrices Xα. A truncation of Xα, corresponding to a given truncation set τ, can therefore be
computed by appropriately enlarging the truncation set to some τ′ (depending on both τ and
α) and replacing each ϖ in πα with the τ′-truncation of Xϖ: the desired τ-truncation of Xα lies
embedded within the resulting matrix (which, however, is not generally the τ′-truncation of
Xα). As previously, the Xϖ are simultaneously diagonalizable precisely for rectangular
truncations.
Auxiliary calculations depend on certain series and hence not only on the joint density of the
ϖ but on the particular function ϕ (ϰ). The case K ≡ ϰ is straightforward when the source term
is expansible in the desired orthogonal series, because the matrices X̆ϖ are sparse; moreover,
the DOV decoupling applies for rectangular truncations. Thus Frauenfelder et al. consider
K ≡ ϰ involving independent identically-distributed (iid) uniform variates ϖ and apply DOV
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
to precomputed rectangular truncations. Similarly with a linear conductivity assumption and
using generalized PC expansions from various distribution functions, Xiu and Karniadakis
 compare polynomial approximation and MC results.
Enforcing the natural requirement K(x, ϖ) > 0 will limit the possible variates ϖ: it would be
inappropriate to use an expansion K ≡ ϰ with normal ϖ (say). Therefore other functional
dependencies K ≡ ϕ may be unavoidable. To illustrate that other issues may arise from the
interaction of ϕ with the density, consider iid exponential variates ϖ with K ≡ exp(ϰ). The
univariate
are known for Laguerre polynomials so the
a can be computed. The
various Gαβ ≡ E[exp(ϰ)παπβ] of Eq. (9) can be recovered from the generating function for the
univariate Laguerre polynomials, analogous to the computations in Appendix C (provided exp
(ϰ) and θ are expansible; see for conditions). Rewriting Eq. (1) in the more convenient
form of Eq. (14) does not represent a useful option unless θ/K admits a Laguerre series.
Unfortunately, it is possible that neither exp(ϰ) nor θ exp(−ϰ) can be developed in Laguerre
polynomials. The possibility of expanding exp(ϰ) depends on the point values of the various
fields ϰϖ, which are determined by the covariance function of ϰ.
In general, there may also be pragmatic reasons to choose models with non-Gaussian variates.
Assuming lognormal K and constant S, for example, the transient flow equation
leads to an analog of Eq. (9)
in which the full matrix G ≡ (Gβα) remains inconvenient, while choosing instead K ≡ ϰ, with
independent variates ϖ governed by gamma distributions (say), would replace the G by a sparse
9 Conclusions
Using acceleration of MC by Hermite series, and assuming a Gaussian covariance function
that decays with separation, we compared the quality of polynomial models for stochastic flow
obtained by several methods, including numerical cubature, Nicolaides interpolation, truncated
PC expansions, and KLME. Such models seem attractive because when available they might
provide fast simulators and can be used to compute covariance functions.
We examined an analytic problem, showing that numerical cubature techniques can provide
high quality results. Assessment by Monte Carlo, however, suggests the existing numerical
cubatures are potentially useful only when the domains are relatively small (as measured in
correlation lengths). The cubatures provide decouplings of certain truncated PC systems, and
these decouplings suffer from a dimensional curse: system size grows exponentially with the
number of variates required and so the methods rapidly become intractable. The method of
DOV requires commuting truncations of the Jacobi matrices, available only for rectangular
truncation sets. A collocation by cubature attack for non-rectangular truncation sets will either
require more function evaluations than the size of the truncation set, force the approximations
to the truncated Jacobi matrices to commute by miscomputing entries, or fail to respect the
orthogonality of the h-polynomials associated with the truncation set. Prospects for
generalizing the decouplings therefore seem limited.
Nicolaides interpolation does not appear to produce satisfactory results if applied without
careful attention to knot location. In general, interpolatory methods could reduce the
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
dimensional problems associated with increasing domain size, provided the knots and weights
can be obtained without substantial overhead costs. Unless such difficulties are resolved, we
expect interpolatory methods will not be useful for stochastic flow problems.
Truncated PC systems can provide accurate results. Because the relative error for a fixed
truncation increases with increasing domain size and variance, computational resources
required for a given accuracy similarly increase. There remains, however, the matter of
appropriately choosing the truncation set. KLME typically provides somewhat less accurate
results than PC. In particular, the relative error associated with a given truncation still increases
with domain size and variance. It nevertheless has the advantage that it can be implemented
adaptively and requires only solution of modified versions of the original equation. Conditions
under which KLME converges seem to be unknown. Our investigations further indicate that
on large domains, meaningful acceleration of MC by Hermite series can require a significant
number of terms.
We conclude that when the number of required variates is small, numerical cubature is the
method of choice. When the number of required variates eliminates the cubature option, PC
should be considered as an alternative if an appropriate truncation can be found consistent with
available memory constraints. When such a truncation cannot be identified, KLME should be
considered, unless higher order nonlinearities are expected. When such nonlinearities exist, it
is unclear whether KLME will converge, and then MC may be the only option. For large
domains of a scale of several correlation lengths or larger, which will typically require many
variates to resolve, or for high variability cases, Monte Carlo methods will remain the method
of choice unless better interpolatory techniques become available.
Appendix A Karhunen-Loève expansion of a random field
The KLE of a random field Ψ on domain Ω may be obtained formally by seeking an expression
in spatially orthogonal functions Ψω(x) and uncorrelated centered variates ω; then
is an eigenpair of the integral operator
having as its kernel the covariance function cΨ. The relative sizes of the corresponding
eigenvalues naturally describe the relative importance of the variates ω. Truncating a KLE
produces a KLE of the field defined by the truncation. When Ψ is a Gaussian field, the variates
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
ω are also normal and, renormalizing, we may assume ω ~ N(0, 1), so ∥ Ψω∥2 is the eigenvalue
associated with the eigenfunction Ψω. Since, the family ω is uncorrelated and jointly normal,
it comprises independent variates. The KLE applies equally well to vector processes . For
further details on KLE, see Adler , Ghanem and Spanos , Hernandez and Riesz and
Szent-Nagy [§§97–98: 63].
Appendix B Notational Examples
The entry of the univariate X-matrix with a = 1, b = 2, c = 3 can be computed as
Such calculations need not be performed explicitly: the results are known and are provided in
Appendix C
For ω = {ω1, ω2, ω3, ω4} and
, the vector of exponents of α is 〈αω1, αω2, αω3,
αω4 〉 = 〈3,0,1,2 〉 and
with leading term
. In practice, such products are needed when using polynomial
models, for example to evaluate hα(ω) for specific numerical values of the variates ω.
Again with the same ω and α, but
Again with the same ω and α
where aω2 = 0, because ω2 does not divide α, and the second term of the three-term relation
has therefore been dropped.
Again with the same ω, the truncation set
For ω ≡ {ω1, ω2} with the truncation set
, here is one of the
truncated Jacobi matrices:
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
Eq. (38) thus assumes the form
I is the identity, H˘ and θ˘ are the truncated vectors with components Hα and θα, and G˘−1 is
the truncated matrix with components
If Eq.(38) is discretized by finite differences, with domain-sized matrices M(?) discretizing
∇?·∇ and D2 discretizing ∇2, then projecting from the discretized equation produces a system
matrix with block decomposition
For total degree truncations τ = τ(e, d), the system matrix involves N(e, d)2 blocks, of which
only (2e + 1)N(e, d − 1) + N(e − 1, d) are occupied. Thus, for τ = τ(2, 2) only 18 of the 36 blocks
are nonzero, while for τ = τ(20, 2) only 1, 071 of the 53, 361 blocks are occupied.
Appendix C Computing Expectations
Note first the rules
when f satisfies certain smoothness and growth conditions [cf. 9,24,39]), and ∂ω denotes the
differentiation operator.
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
The univariate triple product expectations
defined by Eq. (22) can therefore be found
explicitly (by Liebniz’ rule, for example):
vanishes unless t ≡ (a + b + c)/2 is an integer
and satisfies t ≥ max(a, b, c), in which case
This also follows from an exact formula in Szego .
The coefficients of the expansion
formally satisfy
this may similarly be found from the Taylor series or from the exponential generating function
for the ordinary Hermite polynomials [cf. 51,65,72]. Thus
A version of Eq. (C.7) can be found in .
Using Eq. (C.3), Eq. (C.7) becomes a finite expression
The multivariate analog is
where the powers
are calculated pointwise and
Expressions for the fields
, defined by Eq. (13), can be obtained by replacing the
components of κ by those of −κ in expressions for the fields Gαβ.
Similarly, the various E[α] are known from the univariate recurrence
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
obtained with Eq. (C.2) . Thus the basis-change coefficients defined by
are also easily computable: Pαβ vanishes unless α ≺ β with β/α a square, in which case
Appendix D Basic Properties of Xα
D.1 The Univariate Case
We summarize the theory of the finite Jacobi matrices X˘1. The eigenvalues of X˘1 are the zeros
z of hd+1 with associated eigenvectors
as can be shown, for example, by modifying an argument in . By the Christoffel-Darboux
formula, distinct eigenvalues z, z′ produce orthogonal eigenvectors νz, νz′, and the norms
provide the inverse weights for the HG quadrature with knots z . Thus the orthogonal
diagonalizing matrix U for X˘1 has entries
where z are the knots and
the roots of the corresponding weights for the HG quadrature. The polynomials
satisfy pz(z′) = δzz′ and provide a polynomial interpolation scheme
If the entries of X˘c are approximately computed by the corresponding HG quadrature, matrices
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
result with X˜1 = X˘1, since the quadrature is exact to degree 2d + 1 ; thus U diagonalizes
X˜c, so X˜c = hc(X˘1) and the eigenpairs are known from those of X˘1.
D.2 The Multivariate Case
For the multivariate case, define infinite matrices Xα as tensor products
Given a rectangular truncation set, choose (as in D.1 supra) a diagonalizing matrix Uω for each
stochastic dimension, and define
The multivariate interpolation is formally identical to the univariate version given by (D.5).
D.3 Simultaneous Diagonalizability of the X̆ω
D.3.1 Rectangular Truncation
In the case of a rectangular truncation set, each X̆ω is a tensor product of some truncated
univariate matrix X̆1 with identity matrices, so the X̆ω are simultaneously diagonalizable. We
show conversely that the truncated matrices X̆ω can all be simultaneously diagonalized only
for truncation sets τ that are rectangular.
Since the X̆ω can be simultaneously diagonalized iff they commute, consider distinct variates
ω ≠ ω′ and study the commutator. The matrices Xω and Xω′ commute, since
Therefore, for α ∈ τ and β ∈ τ,
(with α ∈ τ, β ∈ τ, and γ ∉ τ) vanishes except when αω′ = γ = βω; similarly, a
vanishes unless αω = γ′ = βω′. If both αω′ = βω and αω = βω′, then
which is impossible since ω ≠ ω′. The right side of Eq. (D.12) therefore contains at most one
term, so the matrices can commute only if the right side is empty.
It follows that the truncated matrices commute iff the following condition holds for every pair
of distinct variates ω ≠ ω′ and every monomial μ: whenever μ, ωμ, and ω′μ all belong to τ, so
does ωω′μ.
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
This implies that α ∨ β, defined by (α ∨ β)ω ≡ max(aω, bω), belongs to τ whenever α and β do:
for suppose that this is true whenever the total degree ∣α∨β∣ < n and consider α and β in T with
∣α∨β∣ = n; there is nothing to show if α = α ∨ β or β = α ∨ β, so we may assume there are
variates ω ≠ ω′ with aω > bω and aω′ < bω′; by the induction hypothesis α/ω ∨ β = (α ∨ β)/ω
and α∨β/ω′ = (α∨β)/ω′ both belong to τ; since τ is a truncation set, (α∨β)/(ωω′) also belongs
to τ; hence, by the condition in the prior paragraph, so does α∨β. Therefore τ is rectangular:
pick, for each variate ω an element μ(ω) ∈ τ with largest possible ω-degree and set μ = μ(ω1)
∨⋯∨ μ (ωe); then by the previous paragraph, μ belongs to τ; but then by construction, τ contains
precisely the α ≺ μ and is therefore rectangular. To our knowledge, such questions have not
been considered, except in the case of the total degree truncations.
D.3.2 Generality of the Argument
The preceding argument remains valid with some generality. Suppose, for example, given a
finite collection of uncorrelated (but not necessarily independent) variates ϖ. To avoid heavy
tails and densities concentrated at a finite number of points, require 0 < E[p(ϖ)2] < ∞ for all
polynomials p. After shifting and rescaling, we may assume each variate centered with unit
variance. By copying standard univariate arguments, obtain a three-term recurrence defining
an orthonormal family of multivariate polynomials πα(ϖ). After introducing as before infinite
direct computation shows the infinite matrices Xϖ commute. Inspecting the above arguments
then reveals that the truncations X˘ϖ commute when and only when the truncation is
rectangular.
D.4 Remark on Truncation and Cubature
Here is a consequence of the foregoing remarks.
Suppose a truncation set τ admits a cubature rule
satisfying the following conditions: (1) the number of knots ζ is the same as the number of
monomials in τ; (2) I = 1 and for every α and β in τ and every ω,
. Then τ is
rectangular.
To see this, observe first I[hαhβ] = δαβ for α and β in τ . This is clear if either α or β is linear in
any ω or if hα = hβ = 1. Proceeding inductively, we may assume some ω2 ≺ α and apply the
three-term relation of Eq. (27) to write
and setting Uαζ ≡ hα(ζ)Cζ shows that
so the X̆ω are simultaneously diagonalizable and τ is rectangular.
Rupert and Miller
J Comput Phys. Author manuscript; available in PMC 2008 October 1.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
The hypothesis I = 1 in condition (2) is equivalent in that context to the assertion that I
[hαhβ] = δαβ for all α and β in the truncation set τ.
To generalize the calculations of §4.2, by providing a cubature rule that preserves the
orthogonality of the h-polynomials associated with a truncation set τ and with number of knots
the size of the truncation set, one must therefore find a cubature that correctly computes
exactly except possibly when both ωα, ωβ fall outside of τ. If it were possible to
selectively damage these entries of the matrices X̆ω, so the damaged matrices X̃ω remained
symmetric but commuted, then by simultaneously diagonalizing the X̃ω, one would obtain the
knots and weights for a decoupling cubature. But it is not clear how to accomplish this.
Additional complications are introduced if one seeks cubature rules involving more knots than
polynomials, producing non-rectangular U.
To our knowledge, such questions have not been considered, except in the case of the total
degree truncations.
Acknowledgements
This work was supported National Institute of Environmental Health Science grant P42 ES05948 and National Science
Foundation grant DMS-0327896.