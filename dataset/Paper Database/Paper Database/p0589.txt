Behavior Research Methods, Instruments, & Computers
2001, 33 (4), 443-456
The diffusion process has become quite popularin cognitive psychology during the last two decades . In the study
of complicated stochastic models such as the diffusion
process,simulationsof the modelplay an importantpart for
three reasons; they enable one to (1) understand the basic
characteristics of the model, (2) generate data in order to
evaluate estimation techniques for the model parameters,
and (3) derive predictions to test the performance of the
The problemwith simulatingthediffusionprocessis that
it is a stochastic process with a continuousstate and time
space. Roughly, we can distinguishtwo classes of simulation methods on the basis of accuracy of approximationof
the continuousdiffusion process. First, there are methods
in which a discretization of the continuous state and/or
timespaceofthediffusionmodelisneeded.In a secondclass
of methods, no discretizationis made, and the accuracy of
the approximationof the continuousstate and time spaceis
limited only by the precision of the floating-point implementation.A method from the second class is expected to
give always more exact results than any method from the
first class. Therefore,it can be used as a benchmarkto evaluate the accuracy of methods from the first class.
Apart from differences in accuracy, simulationmethods
may also differ with respect to their simulation speed. If a
huge number of simulationsof the model is needed, as, for
instance,in Markov chain Monte Carlo applications , speed becomes an important issue.
The aim of this paperis to present an overview and evaluation of techniquesto simulate the diffusion process with
constant drift rate and variance,and two absorbing boundaries . Such a process is also called a
Wiener process with absorbing boundaries,or a Brownian
motion with drift rate and absorbingboundaries.Hence, if
we speakofadiffusionprocess,wemean theWienerprocess.
In a separate section,we will indicate whetheror not, and if
so, how the proposedsimulationmethods can be adapted to
simulate other types of diffusion processes, but our major
focus is on the Wiener process.
Copyright 2001 Psychonomic Society, Inc.
The first authorwas a research assistant of the Fundfor Scientific Research (Flanders). The research in this paper was also supportedby BOF
Grant GOA/02/2000 from the University of Leuven. We thank the editor and two anonymous reviewers for their comments and suggestions.
Address all correspondence to F. Tuerlinckx, Department of Statistics,
Columbia University, 2990 Broadway MC 4403, New York, NY 10027
(e-mail: ).
A comparison of four methods
for simulating the diffusion process
FRANCIS TUERLINCKX
University of Leuven, Leuven, Belgium
ERIC MARIS
University of Nijmegen, Nijmegen, the Netherlands
ROGER RATCLIFF
Northwestern University, Evanston, Illinois
PAUL DE BOECK
University of Leuven, Leuven, Belgium
Four methods for the simulation of the Wiener process with constant drift and varianceare described.
These four methods are (1) approximating the diffusion process by a random walk with very small time
steps; (2) drawing directly from the joint density of responses and reaction time by means of a (possibly) repeated application of a rejection algorithm; (3) using a discrete approximation to the stochastic
differential equation describing the diffusion process; and (4) a probability integral transform method
approximating the inverseof the cumulativedistribution function of the diffusion process.The fourmethods for simulating response probabilities and response times are compared on two criteria:simulation
speed and accuracy of the simulation. It is concluded that the rejection-based and probability integral
transform method perform best on both criteria, and that the stochastic differential approximation is
worst. An important drawback of the rejectionmethod is that it is applicableonly to the Wiener process,
whereas the probability integral transform method is more general.
TUERLINCKX, MARIS, RATCLIFF, AND DE BOECK
Four methods for simulating the diffusion process are
studied here. The first method, used most commonly, is
based on the approximation of the diffusion process by a
random walk. The second method is built on a rejectionalgorithm for drawing directly from the first-passage time
densities of the diffusion process. The third method is
based on simulating a stochastic differential equation
characterizing the diffusion process. The fourth method
uses the probabilityintegral transform.
Thesemethodshavebeendescribedinotherplacesbefore.
The theory for the first method is described in almost any
textbookon stochasticmodels .The reference to the second method , however, is not readily accessible to psychologists.Moreover,the methodis describedonly for the case
with zero drift rate, and as a consequence,it is not directly
applicable to the most common diffusion process used in
psychology. We thereforepresentan elaboratedand adapted
version of the original algorithm.The third method can be
derived in a straightforward manner from the definitionof
the diffusion process and is elaborated in, for instance,
Bouleau and Lépingle and Fahrmeir (these
references contain onlyinformation aboutthe case without
absorbing boundaries).The fourth method can be found in
almost any textbookon statistics .
The structure of the remainder of this paper is as follows. First, a short overview is given of the type of diffusion process that is considered here. Second,the four simulationmethodswill be presented.Third, thesemethodswill
be evaluated with respect to speed and accuracy of simulation. Fourth, the generality of the methods will be discussed, and finally, some conclusionswill be presented.
OVERVIEW OF THE DIFFUSION PROCESS
In this section, we provide a brief overview of the basic
features of the diffusion process and introduce some notation. A more technical and complete description of the
model and its mathematical properties can be found in
specializedreferencessuch as CoxandMiller ,Karlin
and Taylor , or Ross .
The diffusion process is a stochastic process that develops through time, and it can be represented by a continuousrandom variable X(t) (t  0), denotingthe position
of the process in the state space at time t(t  0; t is also
continuous).In case of a diffusion process with absorbing
boundaries 0 and a, the state space is restricted to the interval [0, a]. The central part of a stochastic process is the
transitionprobabilitydensity functionp(x0, t0; x, t), which
is the density for X(t) = x giventhat the processwas at time
point t0 (t0 < t) at position x0 and that the process did not
reach one of the boundaries by time t.
Assume that the diffusion process starts at z (0 < z < a)
at time 0. The transition probability density function p(z,
0; x, t) should then satisfy the Kolmogorovequations,also
called the forward and backward differential equations
 . Derivations of the Kolmogorov
equations are presented in Cox and Miller and in Ross
 , and their method of solution is explained in Cox
and Miller. The forward equation is
which has to be solved for p(z, 0; x, t) subject to the conditions
The first condition is an initial value condition, which
means that, at time 0, all mass of the transition probability
densityfunctionis concentratedat the starting pointz. The
function d(x
z) is the Dirac delta function, a degenerate
probabilitydensity with all its mass concentratedat 0. The
last two conditionsare boundaryconditions,which impose
the restrictionthat thedensityequalszero at the boundaries,
so that terminated processes disappearfrom the transition
density. The stochastic process described by Equations 1
and 2 is called a diffusion process with constant drift rate,
constant variance, and absorbing boundaries,or a Wiener
process with absorbing boundaries. Since the exact form
of the transitionprobabilitydensityfunction is not needed
in this paper, it will not be presented here.
The parameters m and s2 are theinfinitesimalmean and
variance of the process: m is the mean displacement and
s 2 the variance of the displacement of X(t) given that
t) = x, where t approaches to 0. The parameter m is
called the drift rate of the diffusion process.
Two important events and corresponding random variables originating from the diffusion process {X(t); t  0}
are of particular interest for simulating the diffusion
process in the context of psychological research. First,
there is the event that absorption occurs at the upper
boundary. A random variable Y takes the value 1 if absorption occurs at the upper boundary and value 0 if absorption occurs at the lower boundary. The second important
event is [T £ t|Y = 1], which is the event that the absorption time T is smaller than some value t, given that absorption happensin the upper boundary. We will consider
also the event [T £ t|Y = 0].
In psychological applications, it is impossible to observe the full sample path {X(t); t  0} from start until absorption. Only the boundaryof absorption(i.e., the choice
response) and the time that it takes until absorption (i.e.,
the choiceresponse time) are observed.Therefore, it is not
required that a simulation algorithm return a complete
sample path. Thus, for the simulation,we focus on the random variables Y and [T £ t|Y = 1].
Next, the density functionsfor the random variablesdefined above will be given. First, the probability of hitting
the upper boundary equals
( , ; , ) ,
SIMULATING THE DIFFUSION PROCESS
From the fact that the probability of absorption is a sure
event, it follows that Pr(Y = 0) equals 1 - Pr(Y = 1). The
probability of hitting the lower boundary can also be obtainedfrom Equation3 byreplacingmby -mandz by(a - z).
This operation interchanges the role of the two absorbing
boundaries but yields an otherwise identical diffusion
For the random variable T, we will not consider the
probability Pr(T £ t|Y = 1), but only present the conditionaldensityof first-passagetimes at the upper boundary:
where f(t|Y = 1) is defined for all t > 0. The other conditional density of first-passage times, f(t |Y = 0), can be obtained from Equation 4 by replacing m by - m and z by
Typically, the diffusion process is applied to data from
a two-alternative forced choice (2AFC) paradigm. However, theresponsetimethatisobservedconsistsofmore than
just the decision time. It is often assumed that two components contribute to the response time: one that involves
the decisionprocess,whichcan be modeledby thediffusion
process, and another that involves all the other processes
(encoding, response preparation, and execution). A complete model for response timesin a 2AFC paradigm should
also take into account the second component. For simplicity, it is often assumed that all processes that are unrelated to the decision process consume a constant time Ter.
If this constant time is added to the decision times, the
total response time RT becomes
RT = T + Ter.
Under the assumption of a constant Ter, Equation4 can be
easily adapted: In particular, t should be replaced by the
difference (t - Ter). Equation3 does not change,of course.
If we would make the more realistic approach that Ter is
a random variable ,
then there are no explicitformulas for the conditionaldensities, not even for simple choicesof densitiesfor Ter (e.g.,
uniform, normal, or exponential).However, once we have
a simulationmethod for the diffusion process, the simulation of a model with a random Ter posesno additionalproblems. For simplicity, in the remainder of the paper it will
be assumed that Ter is 0.
In some applicationsof the diffusion process , it is assumed that the drift rate
m and the starting point z show some trial-to-trial variability. The trial-to-trialvariabilityis neededto limit accuracy
(otherwise it grows toward 1 if boundary separation increases) and to fit the error response times .The simulationof such a processcan be accomplishedby drawingthedrift rate and startingpointfrom
the appropriate distributions and then simulating the diffusion process with the drawn values.In the following,we
will assume that m and z are both constant, unless specified otherwise.
FOUR METHODS FOR SIMULATING
THE DIFFUSION PROCESS
In this section, the four methods are explained and an
algorithm for each of them is outlined.
A Random Walk Approximation
In many texts on stochastic processes, the diffusion
process with constant drift rate and absorbing boundaries
is considered as the continuous version of the random
walk processwith absorbingstates . The diffusion process can be derived
mathematically by constructing a random walk with very
small displacements and small time intervals and by letting the length of both steps and time intervals approach
zero. This limiting property is useful for the simulationof
the diffusion process. In particular, it shows that a simulation from the diffusion process can be obtained by simulating a random walk with small time intervals and displacements.
Assume a random walk with state space {0, D, 2D, . . . ,
z - D, z, z + D, . . . , a}, in which 0 and a are the absorbing
states and z is the starting point. At every time interval t,
a change occurs: a displacement D with probabilityp and
a displacement-D with probabilityq = 1 - p. Assume furthermore that the following equalities hold:
Under these conditions,if t convergesto zero, the random
walk convergesto a diffusion process with drift rate m and
variances2. From a given triplet(m, s, t), a triplet(p, q, D)
can be computed from Equation6, and a random walk approximation is easily obtained.
The accuracy of the algorithm depends on the value of
t, which will be denoted as precision in the following. If t
is large, the approximationof the diffusion model will not
be very accurate, but the simulation will be fast. On the
other hand, if t is small, the discrete approximationof the
TUERLINCKX, MARIS, RATCLIFF, AND DE BOECK
concrete process will be accurate, but the simulation time
may take too long to be of practical interest.A good value
for t should return an accurate approximationand the simulation should not take too much time.
To investigate how the simulation time depends on the
value of t, results from the theory of the random walk can
be used. For a random walk with time interval t and state
space {0, D, 2D, . .. ,z - D, z, z + D, .. . , a}, the expected
number of steps before absorption, E(N), in either of the
boundaries is equal to 
With the use of the equalityD = sÖt, it is easy to show that
for the case m = 0, if t is dividedby a factor K, E(N) is multiplied by the same factor K. Stated differently, E(N) is of
1). If m ¹ 0, this is more difficult to prove, but
it can easily be checked numerically. These results show
that if the simulation is more accurate, it is also expected
to take more time.
To summarize: In the random walk approximation,the
continuous time line is divided into small time intervals,
and the position of the process at each time point is simulated. The magnitudeof the displacementD of the process
is a monotonic increasing function of magnitude of the
time intervals(D = sÖt ). Thus, smaller time intervals lead
to smaller displacements.A drawback of the random walk
approximation is that the expected simulation time increases with the accuracy of the approximation.
A Rejection-Based Algorithm
The second method differs from the first in that there is
no attempt to simulate the sample path {X(t); t  0}. Instead, the second method directly simulates the time that
it would take for the process to travel a fixed distance R
from its startingpoint.Thisideawas developedby Lichters
et al. . They described an algorithm for the zero
drift rate case, and this algorithm will be extended here to
the case in which m can take any real value.
The algorithm of Lichters et al. makes use of a
rejection algorithm for simulating a symmetric diffusion
process (i.e.,z = a/2) with absorbingboundaries.With this
algorithm, it is possible to obtain an exact draw from the
first-passage density, givenabsorptionat oneof the boundaries. This rejection algorithm is then used as a component of a more general algorithm for the simulation from
an asymmetric diffusion process (z ¹ a/2).
The algorithm to simulate a diffusion process will be
described in two parts. First, we will discuss the rejection
algorithmfor the symmetric diffusionprocess. Second,we
will give an outline of a simulationalgorithm for the more
general asymmetric case.
Part 1: Rejection Method for the Symmetric
Wiener Process
In the special case of a symmetric Wiener process, the
conditional response time density in Equation 4 simplifies remarkably. See Equation 8 below.
Thus, for a symmetric Wiener process, the conditional
first-passage time distributions are the same. This equation can be simplified further by noting that
where d is a positive integer. Equation 8 can now be
rewritten as seen in Equation 10 below.
For Equation10, it is shown in AppendixA that the following inequalityholds:
SIMULATING THE DIFFUSION PROCESS
Since the inequalityin Equation 11 holds for any t, it may
be used for a rejection algorithm for simulating from
fT|Y (t|Y = 0) or fT |Y (t|Y = 1). The rejection algorithm is
explainedin AppendixB .
In the sampling algorithm for a symmetric diffusion
process, it is first decided whether a realization from
fT|Y(t|Y = 1) or fT|Y(t|Y = 0) has to be simulated. Next, a
realization is drawn from fT|Y (t|Y = 1) or fT |Y (t|Y = 0),
dependent on the value for Y. Assume for simplicity that
the outcome of the first step of the algorithm is 1 (i.e., Y =
1). However, notice that the algorithm is the same for the
case Y = 0, since fT |Y(t|Y = 1) = fT|Y(t|Y = 0).
A rejection algorithm is initiated by sampling from a
candidate-generating distribution. In our case, this is the
exponentialdistributionwithparameterlasdefinedinEquation 13. Sampling a realizationt* from an exponentialdistribution involves the following computation:
where u is a uniform random number from U(0,1) and l
is defined as in Equation 13. The draw t* from the exponential distributionis a candidate draw from fT |Y(t|Y = 1)
and is accepted as a draw from that distributionif
where v is another random number from U(0, 1), and M is
defined as in Equation 12. After some rewriting, the condition in Equation 15 becomes
Convergence of the infinite sum in Equation 16 is fast.
The number of terms will typicallybe lower than 15. Convergence is worst if u is close to zero.
Since the presented algorithm is a rejection algorithm,
the acceptancerate is equal to 1/M. The acceptance rate is
Figure 1. The acceptance rate as a function of drift rate for three values of a. The solid line represents the case a = 0.16; the dashed line, a = 0.12; and the dotted line, a = 0.08 (s = 0.1).
TUERLINCKX, MARIS, RATCLIFF, AND DE BOECK
not constant, since M is a function of m, a, z, and s 2 (see
Equation 12). If m = 0, then the acceptance rate equals
p/4 = 0.785, and for m ¹ 0, it will be always lower than
p/4. In Figure 1, the acceptance rate as a function of drift
rate m (on the abscissa) is shown for three different values
of a (s is always equal to 0.1). Both the range of m and the
different values of a are realistic values, in the sense that
one may encounterthem in real applications(given that s =
0.1); they produce decision times around 1 sec. It can be
seen that in the most extreme case in Figure 1 (a = 0.16
and m = 0.4), the overall acceptance rate is still about 0.3.
In conclusion, a symmetric diffusion process can be
simulated very easily in two steps: (1) Determine the
boundary of absorption, based on the probabilities of
reaching each of the boundaries; and (2) draw a response
time from the conditionalresponse time density, given the
boundary of absorption.
Part 2: Rejection-Based Method for the General
Wiener Process
We now proceed with the general Wiener process, without the requirement of a starting point symmetrically between the absorbingboundaries.The rejection method described in the previous subsection will be applied one or
more times in order to obtain a realization from the more
general process. In particular, given the starting point, a
new diffusion process is defined with symmetric absorbingboundariesthatliebetween theoriginalboundaries,and
the rejection method is applied. If the simulated value is
located at one of the original absorbing boundaries, the
process stops, and if not, again a new symmetric diffusion
process is defined, and this goes on until absorption occurs at one oftheoriginalboundaries.Each timea fixeddistance is traveled (the distance in the symmetric diffusion
process from the starting pointto the absorbing boundary)
andhowlongit takestotravelthefixeddistanceissimulated.
The central property of the diffusion process on which
the algorithm is based is the Markov property: Once it is
determined that the process is at a certain state, x(t) at time
t, thefuture behavioroftheprocessdoesnotdependon how
state x(t) was reached.
The algorithm is explained further in detail on basis of
a flow chart (Figure 2) and an example (Figure 3). First,
the variables of the algorithm are initialized. The integer
k is a counter, t(0) is the simulated time at step 0, and z(0) is
the starting point of the first symmetric diffusion process.
At the start of the algorithm,z(0) equalsz, the startingpoint
of the originaldiffusionprocess. In theexamplein Figure 3,
the absorbing boundaries of the general diffusion process
are 0 and 0.12, and the starting point is 0.04. Therefore,
the starting point of the first symmetric diffusion process
is also 0.04. The other two variables, w and r, are position
and time variables. They will be assigned values in the
course of the algorithm.
Next, a new diffusionprocess with the starting point exactly in between the two absorbing boundaries is defined.
The starting point has already been initialized, and the
lower and upper boundary (l(k) and u(k)) are now chosen so
that one of them equals an absorbingboundaryof the original diffusionprocess, in particularthe absorbing boundary
closest to the new starting point.The drift rate and variance
remain unchanged. In the example, the absorbing boundaries of the originaldiffusionprocessare 0 and 0.12.Therefore, with startingpoint at 0.04,the new absorbing boundaries for step 0 are 0 (the most nearby original absorbing
boundary)and 0.08.Notice that the startingpoint0.04 lies
exactlyhalfway between these boundaries.New absorbing
boundaries are represented by a dotted line in Figure 3.
In a third step, the rejectionalgorithmas describedin the
previoussubsectionis applied to the new symmetrical diffusion process. In the flow chart, the rejectionalgorithm is
denotedby REJ, and the outcomeof the simulationassigns
values to w and r. The position w must equal l(k) or u(k).
After this, the total simulation time is updated. In the example, the first application of the rejection algorithm results in w = 0.08 and r = 0.20 and the observation is denoted by “x” in Figure 3.
If the simulation of the symmetrical diffusion process
leads to an absorptionat one of the boundariesof the originaldiffusionprocess,thenthesimulationstops.In thatcase,
the final boundary of absorption is known, as is the total
simulated first-passage time. However, if absorption occurs at the other boundary, the rejection algorithm will be
appliedanothertime but with the new starting pointw, the
current position in the state space. In the example, the rejection algorithm has to be applied another time, since w
is not equal to 0.0. The new starting point, z(1), is now
equal to 0.08, and the new absorbing boundaries are 0.04
(dotted line) and 0.12. The second application of the rejection algorithm ends up in the upper boundary of the
original diffusionprocess, so that the algorithmstops. The
simulated time in this step was 0.22, so that the total simulated diffusion time is equal to 0.42.
The advantageof the rejection-basedmethod is that the
simulation time is not proportional any more to the physical time to run through the process. Another advantage
over the random walk method is that it does not involve a
discreteapproximationto the continuousdiffusionprocess.
Therefore, the accuracy of the simulationis boundedonly
by thenumericalaccuracyofthe computersystemon which
the simulation takes place.
It is difficult to obtain theoreticalresults about the simulationtime for the rejection-based algorithm in Figure 2.
The simulation time depends on the acceptance rate for
the input parameter values and the number of times that
the absorbing boundaries of the original diffusion process
do not coincide with the chosen boundaries from the rejection algorithm. However, both the acceptance rate and
the expected number of times that a subdivision of the
original diffusion process in a symmetric subprocess has
to be made depend on so many things that it is difficult to
make general assertions.
SIMULATING THE DIFFUSION PROCESS
Simulation of the Stochastic Differential Equation
Another way of defining the diffusion process is via a
stochasticdifferentialequation defined for X(t),
dX(t) = mdt + sdB(t),
under the condition that X(0) = z and where B(t) is a standardBrownianmotionprocess.Foreacht >0, B(t) hasa standard normal distributionwith E[B(t)] = 0 and Var[B(t)] = t.
Moreover, Cov[B(t),B(s)] = min(t,s).
It can be proved that the sample path {X(t); t  0} of a
diffusionprocess is (almost surely) continuousbut the derivative dX(t)/dt (for any t  0) does not exist .Therefore, the
change in X(t) in a small time interval should be represented by a stochastic differential equation instead of by
the usual deterministic differential equation. Intuitively,
Equation 17 states that the change in X(t) in a small time
interval dt is normally distributedwith mean mdt and variance s2dt. The latter follows from inserting Var[B(t)] = t
and Cov[B(t),B(s)] = min(t,s) in the usual formula for the
variance of the difference dB(t) = B(t + dt) - B(t).
A discrete version of the continuousSDE in Equation17
can be defined as follows:
Assume that the time intervals are constant, or, in other
words, Dtk = t (for all k = 1, 2, . . .). It follows from the definition of the Brownian motion that the difference Dbk =
b(tk + 1) - b(tk) is normally distributed with mean 0 and
variance t.
Like the random walk approximation, the discrete version of the SDE is an approximation to the diffusion
process. The stochastic process that is defined in Equation 18 can also be seen as a random walk for time intervals 0, t, 2t, . . . with normally distributed displacements.
The simulationprocess stops if the x(tk)  a or x(tk) £ 0 for
a certain k. Smith has shown that in case that t approaches 0, this random walk process converges to a diffusion process with drift rate m and variance s2.
Figure 2. Flow chart for the rejection-based algorithm to simulate from a diffusion process.
TUERLINCKX, MARIS, RATCLIFF, AND DE BOECK
Wald gives the approximateexpected number of
time intervals needed to reach a boundary, as shown in
Equation 19.
As was the case for the ordinary random walk, the expected simulation time is O(t -1).
A problem with this method and the stopping rule is
that, in the final simulation step, the state variable always
exceeds the boundary,and this leads to inaccuraciesin the
approximationof the theoretical diffusion process, which
can be quite substantial as Luce and Smith 
have noted.The reason why Equation19 gives onlythe approximatenumberofstepsisthatin its derivationtheboundary excess is ignored .
Some ad hocmethodshave been presentedto correct for
thisexcessovera boundary.The correctionmethodofHeath
and Kelly yields the best results. The method corrects for an excess by widening the boundary separation:
a ® a + zs Ït
where z is a constant whose optimal value is 0.586(Smith,
Probability Integral Transform Method
To explain the probability integral transform method,
assume that for a random variable X, gX(x) is a probability density and that GX(x) is its associated cumulativedistributionfunction.SupposeanewrandomvariableU=GX(X)
is defined. It is easy to prove that U is uniformly distributed over (see Appendix C). Conversely, if a realization u from a uniform density is obtained,its transform, x =
Gx 1(u), is a draw from the density gX (x) (see also Appendix C).
To apply this theory to the case of the diffusion process,
let us define Fy(t) = FT|Y(t|Y = y) as the conditionalcumulative distribution function for response y (y = 0, 1). The
formula for F1(t) is as shown in Equation 21.
Obtaining a realization from the diffusion process proceeds, then, as follows. First, decide on the boundary of
absorptionbyusingtheprobabilitiesPr(Y = 0)andPr(Y = 1);
this renders an observed value y. Second, draw a uniform
random number u and compute t = Fy 1(u). The pair (y, t)
is then a realization from the diffusion process.
Computing the inverse of the cumulative distribution
function has to be done numerically. For this purpose, the
Figure 3. An example of the rejection-based method for the simulation of the diffusion process.
SIMULATING THE DIFFUSION PROCESS
function Fy(t) can be approximated by using a grid of
points (nodes). Denote the sequence of N grid points by
t1,.. .,tN. For each grid point ti, the correspondingfunction
value hi = Fy(ti) is calculated.A uniformly distributedrandom variable u is drawn and the associated realization t is
determined as follows:
If N is taken large enough,the approximationwill be highly
accurate. More complex approximationsare also possible,
such as linear interpolationbetween two grid points.
EVALUATION OF THE
SIMULATION METHODS
In thissection,a MonteCarlo study is presentedto evaluate and compare the three simulationmethodson two criteria: speed and accuracy. The speed of the random walk
and SDE approximations depends on the precision parameter t. If a high precision is used (a small value of t), a lot
of small simulationstepsmay be needed,and that will slow
down the methods. Likewise, the speed of the probability
integral transform method depends on the number of tabulatedgrid points,N. For the probabilityintegraltransform
method, setting up the table with function values can be a
large cost, but once that table is available,a value is easily
determined. On the other hand, the speed of the rejectionbased method depends on the amount of time that it takes
to evaluateEquation16. These considerationsshow that it
is difficult to make predictions about which method will
be faster.
Concerning accuracy, some firm statements can be
made, since the rejection-based method is an exact simulation method and hence is by definition better than every
approximation method; therefore it functions as a benchmark (it is neededto evaluatetheaccuracyofthethreeother
methods). It is interesting, however, to compare the performance of the three other methodswith the performance
of the rejection-based algorithm. In particular, we are interested in the precision that is needed for the other methods to be almostas accurate as therejection-basedmethod.
To avoid superfluous notation, we will abbreviate the
names of the three simulation methods. The random walk
approximation will be denoted as the RW method, the
rejection-based method as the RB method, the stochastic
differential equation approximation as the SDE method,
and the probability integral transform method as the PIT
Design and Procedure
Three independent variables are manipulated in the
Monte Carlo experiment: drift rate (m), combination of
boundary separation and starting point (a|z), and, if used
by the algorithm, the precision t. First, there are five levels
for thedrift rate m: 0.0,0.1,0.2,0.3,and0.4.Second,six levels for the combination of absorbing boundary and starting point are chosen (denoted as a|z): 0.08|0.04,
0.12|0.06,0.16|0.08,0.08|0.02,0.12|0.04,and0.16|0.04.
Third,three levels of precisiont are chosen for the RW and
SDE methods:0.01,0.001,and 0.0001(orderedfrom lowto
high precision). For the PIT method, three levels of precision are chosen (operationalized in number of grid
points): 500, 5,000, and 50,000.
The three independentvariablesare completelycrossed.
For each cell of the design, 20 samples of 3,000 observations are simulated. All four methods are programmed in
FORTRAN, and the Monte Carlo experiment is run on a
personalcomputer with a Pentium III 600-MHz processor.
For each criterion,speed and accuracy, we examine two
dependentvariables. First, with respect to speed, we compute the time that it takes to draw 3,000 observations.Second, the mean number of steps taken for the RW and SDE
methods to reach an absorbing barrier is computed, and,
for the RB method, the mean number of applications of
the rejection algorithm before an absorbing barrier is
reached. For the PIT method, no steps have to be taken in
the simulation.
With respectto the accuracy of the simulation,again two
dependent variables are examined. Both response probability and the conditionalresponse time density are simulated, and hence for both aspects the accuracy of approximation is evaluated. First, we examine the proportion of
times that the process hits the upperboundary. Second,for
the processes that hit the upper boundary, a measure of
maximal deviation between the observed and theoretical
conditionalcumulativedistributionfunction is computed:
where ˆF1(t) is the empirical distribution function for the
simulatedvaluesfrom the diffusionprocess,andF1(t) is the
sup | ˆ ( )
TUERLINCKX, MARIS, RATCLIFF, AND DE BOECK
theoretical conditionaldistribution function for the diffusion process (Equation 21). It is expected that H is smallest for the rejection-based algorithm, and it will be investigatedhow closetheothermethodsapproximatethisvalue.
If Equation 23 is multiplied by the square root of the
number of observations Ön), it becomes a Kolmogorov–
Smirnov test statistic . Under the condition that ˆF1(t) converges to F1(t) if the sample size goes
to infinity, the distribution of the test statistic Dn = ÖnH
known. Given that n is large enough, Dn can be used to
test the hypothesisthat a sample of simulated values with
empirical distribution function ˆF1(t) does come from the
target distributionF(t). Under the null hypothesisthat this
is true, the proportion of rejections of the null hypothesis
should not exceed 5% (1%) if the test is performed at the
nominal significance level of a = .05 (a = .01).
In this paper, emphasisis put on the raw value H instead
of on the Kolmogorov–Smirnov statistic, because the outcome of theKolmogorov–Smirnovtestdependsonthesample size. Any method that is not exact will be rejected as
inaccurate if the number of simulations is large enough,
and that is not needed here. Therefore, the Kolmogorov–
Smirnov test will not be considered any more, and onlythe
raw values H are used.
Results for the Speed of Simulation
In Table 1, one can find the mean time (in seconds) the
algorithmsneeded to draw 3,000 realizationsfrom the diffusion process. The RW method with the lowest precision
is the fastest, followed by the RB method. For equal precision levels, the SDE method is the slowest. The results
suggest that for the RW and SDE methods, the simulation
time is O(t
1). The simulation time for the PIT method is
comparable to that of the RW method. However, if the
number of simulations was larger than 3,000, the PIT
method would perform faster than the RW method because, beyond the fixed cost of computing the table with
function values, it takes no time to select values from it.
Table 2 shows the mean number of steps for the RW and
SDE methods, again as a function of the precision level t.
For the RB method, the mean number of times that the rejection algorithm has to be applied is shown in the same
table. The SDE method takes more time, because it takes
more steps than the RW method to reach the boundary and
it requires more complex calculations (one has to draw
normally distributed numbers instead of uniformly distributed ones as in the RW method).The PIT method is not
mentioned in this table, since the selection of a value is
done in one step.
The third column of Table 2 containsthe expectednumber of steps before absorption. (The expected number of
steps is computedfor each combinationof drift rate, a, and
z, and then the mean is taken.) The expected number of
times the rejection algorithm has to be applied for the RB
method is not available, since there is no formula to compute it.For theRW method,the observedand theoreticalresults are very similar, but for the SDE method, the observed and theoretical results differ, especially for the
lowest precision. The reason is that Equation20 is only an
approximatingformula and not the exact one. This discrepancy between the observed and expected number of steps
was also noted by Luce and Smith .
The effects of the different parametervalues (m, a, and z)
on the speed of simulationare not shown in detailhere; we
will only briefly mention some interesting findings. The
mean simulation time for the RW and SDE methods decreases if the (absolute) value of the drift rate becomes
larger. Moreover, if the boundary separation a is large, it
will takelongerto simulatetheprocess.For the RB method,
a drift rate closerto zero leads to a shorter simulationtime.
This is expected,because the acceptance rate of the rejection algorithm attains its maximum at m = 0. Also for the
RB method, the simulation time is larger the more asymmetric the diffusionprocess is. If the startingpointis close
to the lower boundary and the drift rate large, then more
applications of the rejection algorithm are needed than
when thestartingpointliessymmetrically. In the lattercase,
by definition, only one application of the rejection algorithm is necessary. For the PIT method, a larger boundary
separation a and a smaller drift lead to a larger simulation
Results for the Accuracy of the Simulation
First, we checked whetherthe simulationmethodsyield
good estimates of the probability of absorption at the
upper boundary. To do so, the sum of the absolute deviancies between the simulated proportions and theoretical
probabilities(Equation3) is calculated.BecausetheRB and
PIT method do not use approximationsat this stage, there
cannot be accuracy problems. However, this does not hold
for the two other methods(RW and SDE). Only the results
for the highest precision levels of the RW and SDE methods are computed.The approximationfor the RW method
is as good as for the RB and PIT method. In particular, the
sums of absolutedevianciesare 0.0368for the RW method,
0.0279for the RB method,and 0.0352for the PIT method.
The SDE method produces inaccurate results, especially
Mean Time (in Seconds) to Draw 3,000 Realizations from the
Diffusion Process for the Four Simulation Methods
Precision Level
Random walk
Rejection-based
Stochastic differential
Probability integrated
Note—For the RW and SDE method, precision level is t. For the PIT
method, precision level is N, the number of grid values used to approximate F1(t).
SIMULATING THE DIFFUSION PROCESS
for the asymmetric cases. The sum of the absolute deviancies for the SDE methodwas 0.1862,which is clearly larger
than for the other two. For lower precision, the results are
even worse and therefore they are not presented.
Next, it is checked whether the obtained sample of absorption times at the upper boundary can be consideredas
a sample from the conditional density in Equation 4. We
consideronly the conditionaldensityfT|Y(t|Y = 1), but the
conclusions also hold for fT|Y (t|Y = 0).
Table 3 contains the mean deviance value H as defined
in Equation21for the four simulationmethods.For the RW,
SDE and PIT methods, we distinguish between the three
levels of precision.The results in Table 3 show that a precision lower than 0.0001 does not yield accurate simulations
for both the RW and SDE methods. If the precision is
0.0001,the random walk gives results similar to those for
theRB method.Butevenfor the smallesttime intervalsthat
we studied, the SDE method is not as accurate as the other
two methods.For thePIT method,settingupa tableof 5,000
gridpointsalreadygivesan H valuethatisundistinguishable
from the one for the RB method (taking into account the
standard deviation). A fortiori, the same holds of course
for 50,000 grid points. The accuracy of the PIT method
would even be improved if linear interpolation was used.
The lack of accuracy of the SDE method is startling at
first sight. To make sure that the method works but needs
an excessively large precision, the simulations are repeated with t = .000001. With this precision, drawing a
sample of 3,000 realizationstakes more than 20 min. The
sum of absolute deviations between the probability of
upper boundary absorption and the actual proportion of
absorptions drops to .0335, a value close to the reported
onesfor thethree othermethods.Moreover,the mean value
of H is equal to 0.0198 (SD = .0078), and this is also closer
to the values of the three other methods (see Table 3).
Finally, we examine the differences in H for different
conditionsof the design but without showingthe results in
detail. Because interesting results are only to be expected
for the RW, SDE, and PIT methods,those are the onlyones
that are discussed.1 First, the systematic effects of the independentvariablesfor the RW simulationswith the highest precision(t = .0001)are studied.In conditionswith zero
drift rate, the accuracy is always worse than in conditions
with nonzero drift rate. Moreover, conditions with symmetric starting pointsreturn more accurate results than do
conditions with asymmetric starting points.
Second, for the SDE approximation, conditions with a
small boundaryseparationlead tolessaccuratesimulations.
This is understandable,because if the boundariesare close
together,it will be more likely that an excess over a boundary occurs, despite the correction method. Completely in
line with this fact, from the two conditions with a small
boundary separation (0.08), the condition with starting
pointat 0.02 performs worst. It appears that the correction
method does not succeed in completely removing the inaccuracy due to an excess over a boundary. The problem
of excess over a boundary is the reason why the SDE approximation is the least accurate method.
Third, for the PIT method, we looked at the effects for
a table of 5,000 grid values. The most important trend is
that simulations with zero drift rate are the least accurate
ones. There are no systematic effects from starting point
and boundary separation.
GENERALITY OF THE METHODS
The random walk approximation can be generalized to
simulateother types of diffusion processes where the drift
Mean Values of the Deviance Measure H
for the Four Simulation Methods
Random walk
Rejection-based
Stochastic differential
Probability integrated
Mean Number of Steps Needed to Reach a Boundary for the Random Walk (RW)
Method, the Rejection-Based (RB) Method, and the Stochastic Differential
Equation (SDE) Method
Observed Mean Number
Expected Mean
Precision Level
Random walk
Rejection-based
Stochastic differential
Note—For the RW and SDE method, precision level is t. For the PIT method, precision level
is N, the number of grid values used to approximate F1(t).
*This mean number of steps is the
mean number of times a new rejection algorithm has to be initiated. As such, its meaning differs from the other mean number of steps for the RW and SDE methods.
TUERLINCKX, MARIS, RATCLIFF, AND DE BOECK
rate and variance parameter are not just constant but depend on the position the process occupies. Being functions of the state of the process, these parameters are now
denoted by m(x) and s(x). In this more general case, not
the limit of a simple random walk is taken but the limit of
a birth–death process, which is the discrete analogue of
these more general kinds of diffusion processes. However,
the structure of the basic part of the algorithm(Equation6)
remains unchanged. Details about this generalization are
given by Bhattacharya and Waymire , Busemeyer
and Townsend , and Diederich . The method
can also be applied to diffusion processes with reflecting
boundaries. Diffusion models with reflecting boundaries
are used in cognitive research by, for instance, Schwarz
 . The random walk is also easily generalized to nonstationary models where at a fixed time point t, the drift
rate changes from one constant value to another while the
variance remains constant . Such models
are, for instance, applied in Ratcliff and Rouder .
The rejection-based method is not applicable to more
generaldiffusionprocessessuchas theOrnstein–Uhlenbeck
process,since inthatcase thereis no explicitformula for the
conditional first-passage time densities. For other diffusion processes for which these explicitformulas are available, the inequalityin Equation11 may not be true, and so it
is difficult to generalize the method. The method can be
applied,however,to diffusionprocesses with constantdrift
rate and varianceand reflecting boundaries.The rejectionbased method is not applicableto models with a change in
drift rate from oneconstanttoanotherat a certain timepoint.
The same technique of approximating the SDE is also
applicable if m and s depend on the state that the process
is in. For that case, more advanced methods than the one
described in Equation 18 are available. Fahrmeir 
considered one-step methods for solving ordinary differential equations (ODEs), and Equation 18 is the so called
stochasticanalogueof the Euler method for solving ODEs
 . More advanced onestep methods such as Heun, modified Euler, and Runge–
Kutta are more appropriate for variable drift rate and variance diffusion processes (for the simple diffusion process
considered in this paper, these methods give the same expression as Equation 18). Fahrmeir discusses theoretical convergence results of the numerical ODE solvers
and proposes some modifications, but only for the case
without absorbing boundaries;and for that case, some difficulties may rise as aforementioned. The method is easily generalized to the case with reflecting boundaries and
changes in drift rate from one constant value to another at
a certain time point.
It is difficult to apply the probabilityintegral transform
method for the Ornstein–Uhlenbeck process, since no
closed-form expression is availablefor the cumulativedistributionfunction.Changesin drift rate as those introduced
by Ratcliff and applied by Ratcliff and Rouder
 are, however, easy to handle (from time 0 up to t,
one takes the cumulative distribution function of the first
process, and from t on, the cumulative distribution function from the second process). Moreover,random drift rate
and random starting pointmodels can be simulated by inverting the cumulative
distribution function that is obtained by first integrating
over both drift rate and starting point distributions (this
may, however, havean effect ontheaccuracyofthemethod).
The probability integral transform method could be used
in a hybrid construction with some of the other methods.
For instance,a limitednumberof simulationsfrom the random walk methodcould be used to set up the empirical cumulative distribution function of some process, and then,
starting from the empirical cumulative distribution function, the probability integral transform method is used to
generate the remaining simulations.This techniqueis particularlyuseful for simulatingdiffusionprocessesfor which
there is no closed-form expression for the cumulativedistributionfunction available(e.g., the Ornstein–Uhlenbeck
process). It combines the advantages of two methods: the
generality of the random walk method, and the speed and
accuracy of the probabilityintegral transform method.
DISCUSSION
In this paper, four methods for the simulation of a
Wiener processare proposedand compared witheach other
with respect to their simulation speed and the accuracy of
the results. With respect to these two criteria, it turns out
that the two best methods are the rejection-based method
and the probabilityintegral transform method. The advantage of the rejection-basedmethod is that it is exact. However, if a huge sample from the same distributionhas to be
drawn, the probability integral transform method is to be
preferred, since its accuracy is comparable (certainly for
the choiceprobabilitiesbut also for the response times) to
that of the rejection-basedmethod and it will be at least as
fast or even faster.
If the time intervalsare chosen to be small enough(high
precision), also the random walk gives accurate results.
The third method, based on the approximation of a stochastic differential equation, is the slowest and does not
yield accurate results. The fourth method, using the probability integral transform method, performs almost as fast
and as accurately as the rejection-based method.
The poorperformanceof thestochasticdifferentialequation methodis not very surprising,sincethatmethodsuffers
from the boundary excess problem and this is not completely corrected for by widening the boundaries.Perhaps
the problem can be rectified by using an algorithm with
adaptive precision: lower precision in the neighborhood
of the startingpoint,but higher precisionwhen the process
approaches one of the boundaries.
Although the rejection-based method is an exact and
fast method, a drawback of the rejection-based method is
thatit isrestrictedinitsapplication:Onlydiffusionprocesses
with constant drift rate and variance can be simulated.
With only minor adaptations, the random walk method,
SIMULATING THE DIFFUSION PROCESS
stochastic differential equation method, and probability
integral transform method can handle more general diffusion processes.
The algorithms are compared with respect to their
speed of simulation,but they could also be compared with
respect of their “speed of implementing.”The gain in time
by speeding up the simulation may be lost in some situations by implementingthe method.Of course, the speed of
implementingdepends strongly on the expertise of the researcher, but a few general points are worth mentioning.
If the stochastic differential equation method is left aside
because of its inaccuracy, the random walk is certainly the
easiest to implement—after that, the probability integral
transform method,and finallythe rejection-basedmethod.
Hence, if onlya few simulationsare neededfor a quick inspection of the properties of a model, the random walk
may be the most preferable method.