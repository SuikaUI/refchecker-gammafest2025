Vol.:(0123456789)
 
RESEARCH ARTICLE
An ensemble method to forecast 24-h ahead solar irradiance using
wavelet decomposition and BiLSTM deep learning network
Pardeep Singla1   · Manoj Duhan1 · Sumit Saroha2
Received: 5 February 2021 / Accepted: 28 October 2021
© The Author(s), under exclusive licence to Springer-Verlag GmbH Germany, part of Springer Nature 2021
In recent years, the penetration of solar power at residential and utility levels has progressed exponentially. However, due to
its stochastic nature, the prediction of solar global horizontal irradiance (GHI) with higher accuracy is a challenging task;
but, vital for grid management: planning, scheduling & balancing. Therefore, this paper proposes an ensemble model using
the extended scope of wavelet transform (WT) and bidirectional long short term memory (BiLSTM) deep learning network
to forecast 24-h ahead solar GHI. The WT decomposes the input time series data into different finite intrinsic model functions (IMF) to extract the statistical features of input time series. Further, the study reduces the number of IMF series by
combining the wavelet decomposed components (D1-D6) series on the basis of comprehensive experimental analysis with
an aim to improve the forecasting accuracy. Next, the trained standalone BiLSTM networks are allocated to each IMF subseries to execute the forecasting. Finally, the forecasted values of each sub-series from BiLSTM networks are reconstructed
to deliver the final solar GHI forecast. The study performed monthly solar GHI forecasting for one year dataset using one
month moving window mechanism for the location of Ahmedabad, Gujarat, India. For the performance comparison, the
naïve predictor as a benchmark model, standalone long short term memory (LSTM), gated recurrent unit (GRU), BiLSTM
and two other wavelet-based BiLSTM models are also simulated. From the results, it is observed that the proposed model
outperforms other models in terms of root mean square error (RMSE) & mean absolute percentage error (MAPE), coefficient
of determination ­(R2) and forecast skill (FS). The proposed model reduces the monthly average RMSE by range from 26.04–
58.89%, 5.17–31.35%, 23.26–56.06% & 21.08–57% in comparison with benchmark, standalone BiLSTM, GRU & LSTM
networks respectively. On the other hand, the monthly average MAPE is reduced by range from 9 to 51.18%, 12.59–28.14%,
30.43–59.19% & 26.54–58.92% in comparison to benchmark, standalone BiLSTM, GRU & LSTM respectively. Further, the
proposed model obtained the value of ­R2 equal to 0.94 and forecast skill (%) of 47% with reference to the benchmark model.
Keywords  Solar irradiance forecasting · Deep learning · Long short term memory · Gated recurrent unit · Bidirectional
long short term memory · Wavelet transform · Hyperparameters
Introduction
Solar energy is one of the leading renewable energy
resources (RER) to generate electricity with zero carbon
emission and its market is increasing
rapidly from the last decade due to its sustainable & supported characteristics . According to the
international energy agency (IEA), by the end of 2030, the
total capacity of the PV installation will hit the 1700GW
level . However, this power
capacity was 8GW in 2007 and now reported 402 GW in
2017, as per the global energy states report (REN 21) . Moreover, as per numerous investigations, the power grid will be 100% fully operational on
Article Highlights
• A state of the art literature review of deep learning networks.
• Development of conventional LSTM, GRU and BiLSTM along
with naïve predictor.
• Implementation of wavelet transforms to the input data series.
• Selection of best wavelet IMF combinations to improve the
accuracy of model.
• Ensemble of selected wavelet IMF combinations with BiLSTM
deep learning network.
• Performance comparisons of proposed model with naïve, LSTM,
BiLSTM, GRU, WT-BiLSTM (T) & WT-BiLSTM (Mod).
Communicated by: H. Babaie
* Pardeep Singla
 
Extended author information available on the last page of the article
/ Published online: 17 November 2021
Earth Science Informatics 15:291–306
the RER by the end of the year 2050 .
But, due to the direct dependency of solar PV output over
climatic & geographical conditions, the stability of solar
irradiance is always a subject of discussion in regard to grid
management . Its inherent variable characteristics & uncertainties must be accommodated by the
resource planners to make a reliable grid- interconnected
power system . Therefore, the precise and
accurate forecasting of solar components is one of the prime
requirements for two basic reasons. (a) to make the reliable
grid-interconnected system which accommodates volatile,
intermittent & random characteristics of solar generation,
(b) to increase the utilization ratio of solar PV output along
with maximum returns on the capital investment on solar
park development . However, reliable
solar irradiance forecasting is not an easy task as it is very
susceptible to seasonal and climatic effects. A minor fluctuation in the meteorological variables directly affects the stability & reliability of the dependent systems . In such situations, an appropriate forecasting model
is highly requested. Several examinations have already been
conducted on the development of methods to forecast the PV
power or the solar irradiance components .
In general, the forecasting methods can be divided into five
different sections: based on process type, based on prediction method, based on spatial scale forecasting process, time
horizon-based forecasting, prediction form-based forecasting, and method / approach-based forecasting . The different categories are shown in Fig. 1.
An approach-based forecasting is commonly used over
various time horizons, systems, shapes and sizes . The persistence approach assumes the past similar
day/h value of the target vector as the value of the presentday/h. If ‘t’ is the present time, then the value of target vector at ‘t’ time is considered as the value of ‘t + k’ where
‘k’ is the time horizon for which forecasting is being performed . On the other hand, the physical
approach generates the mathematical relationship between
the target GHI to the meteorological & geographical parameters. These models performed the forecasting of solar GHI
by the use of meteorological and geographical variables
instead of historical time series data. However, these models
are not popular due to its high computational cost and worst
precision . European
Centre for Medium-Range Weather Forecasts (ECMWF) &
Weather Research and Forecasting (WRF) models are the
two popular models used for forecasting the atmospheric
& operational services .
Conversely, the statistical approach improves the accuracy and minimizes the error of the model by managing the
correlation mapping between input and output parameters
 . Grey theory , Regression Analysis , Fuzzy method , time-series method 
and machine learning (ML) are the different categories of statistical approach. The regression
Auto Regressive Integrated Moving Average (ARIMA)
techniques , support vector regression
(SVR) , Gaussian Progress Regression (GPR) and ML
approach based models proved to be best in the recent years
in terms of forecasting . ML approach such
as artificial neural network (ANN) , support vector machine (SVM) , and Elman neural network (ENN) were used historical data to learn the pattern which
improves the accuracy of the model. Along with, a standalone model sometimes relies on the limited characteristics
of the data and failed to learn hidden characteristics of data.
This limited learning of the model leads to the poor performance of the model. To overcome this problem, hybrid
models has been developed such as: PLA-k-means-HGWO-
RF , ANFIS-ANN , ECMWF-ANN , SVM-RBF-WT
 , WT-NNMFOA-GMDHMFOA
 , WMIM-ELM , LASSO-ANN etc.
In addition, the deep learning approach emerges with
great advantages with better accuracy for the forecasting of
Fig. 1   different categories of
solar irradiance forecasting
Solar Forecasting Methods
Approach based
Spatial scale based
Form based
Time horizon based
Process based
Ultra short term
Short term
Medium Term
Single Field
Regional Field
Statistical
Persistence
Probabilistic
Earth Science Informatics 15:291–306
solar GHI. Due to its highest accuracy and great power of
data processing abilities, this approach is dominating the
ML approach . Qing X. et al.
forecasted the solar GHI on hourly basis using LSTM network in which weather data was used as an input feature of
the LSTM network. The paper compared the performance
of proposed network with the persistence, linear regression
and back propagation neural network. The designed network
outperformed the other model with RMSE of 122.71 W/m2
and proved that the LSTM is better than ANN and other
regression based models . An ensemble
method of deep learning and extreme gradient boosting was
developed to avoid the problem of over fitting and compared
with the persistence and SVR. The proposed model achieved
the RMSE of 51.35 W/m2 which was lesser in comparison
to other models . Likewise,
the LSTM and convolution neural network (CNN) were
combined by Zang H. et al. to forecast the global solar irradiance. In this study, LSTM network used to acquire temporal features of the input dataset and CNN was used to
fetch the spatiotemporal features . A very
short-term solar forecast using sky images was performed
by Cong Feng et al. where, 20 layers, 13 convolution layers
and five-max pooling layers with two fully connected layers
based CNN model was developed to forecast the solar GHI.
The model achieved 116.82 W/m2 of RMSE, −4.56 W/m2
of MBE and 25.14% of forecast skill score for 1-h ahead
prediction . Further, the combination of a residual network (ResNet) & densed convolution
network (DenseNet) was used by Hanxia et al. to forecast the
1-h ahead PV power. The variational mode decomposition
was used as a preprocessing tool, to decompose the input
dataset into trends, seasonal and random components . The WT along with LSTM was utilized by
Wang F et al. and the results proved that the models accuracy
can be improved by WT . The WT and
LSTM network was also used by M. Mishra et al. The study
predicted the solar power for 1-h to 1-day ahead of time
horizon in which WT was used to decompose the input raw
data series into different frequency components and LSTM
was used to forecast solar power . In
the same line, the GRU network was proposed by B. Gao
et al. to forecast the day ahead solar irradiance. The model
predicted the day ahead solar GHI with the combination of
time series and meteorological data as an input. The GRU
network provided the minimum RMSE of 122.45 W/m2 with
42.01% of forecast skill .
Several other studies on deep learning are also available in the literature and most of them used LSTM, CNN
for PV power forecasting & wind forecasting . But, a few
studies are available with the BiLSTM network to forecast the solar irradiance. However, BiLSTM network
have already been used in electric load 
& price forecasting , tourism demand
forecasting , user’s next location
forecasting , stock & demand forecasting
 , wind speed forecasting as well as covid-19 predictions. With respect to BiLSTM, Li C.
et al. predicted the solar irradiance using the standalone
BiLSTM network. The BiLSTM network utilized the
meteorological data to predict the hourly solar radiation.
The results of the study clearly showed that the BiLSTM
network is superior to the LSTM, SVR and LR models
with RMSE of 98.44 W/m2, MAE of 71.49 W/m2 . Rai A. et al. predicted the solar radiations
for the time horizon of two months using the CNN and
BiLSTM. The CNN was used to extract the features of the
input data time series; whereas, BiLSTM exploited the
dependencies of the time series. This study proved that the
CNN-BiLSTM model performed better than LSTM, GRU,
CNN-LSTM and GRU-LSTM . Therefore, inspired from the above work, this paper proposes an
ensemble model to forecast 24-h ahead solar GHI using
wavelet transform (WT) and BiLSTM with an objective to
improve forecasting accuracy. For the justification of superiority of proposed model, the performance is compared
with the reproduced naïve predictor and other proven deep
learning networks such as: unidirectional LSTM, unidirectional GRU, BiLSTM, traditional wavelet-based BiLSTM
(WT-BiLSTM(T)) and modified wavelet-based BiLSTM
(WT-BiLSTM(Mod)).
In brief, the major contributions are as follows:
• A brief literature of solar forecasting based on deep
learning network by considering almost all important
factors related to forecasting.
• Reproduction of naïve predictor (benchmark), three different standalone deep learning models: unidirectional
LSTM, unidirectional GRU and BiLSTM network.
• With the aim to fill the space of WT-BiLSTM process,
the various scenarios of WT based BiLSTM models are
analyzed. For this, the traditional WT is combined with
BiLSTM (WT-BiLSTM (T)) network to forecast the solar
GHI. In the other scenario, the scope of WT is extended
by combining the different wavelet decomposed subseries (IMF) and fed to BiLSTM network (WT-BiLSTM
(mod)) to forecast solar GHI.
• Implementation of proposed model based on forecasting of wavelet decomposed component using BiLSTM
(WT-BiLSTM(CF)). The proposed model is developed
to improve the forecasting using the best use of WT with
BiLSTM. The model allocates an individual BiLSTM
network to the best combination of wavelet decomposed
subseries. The forecasted value obtained from BiLSTM
Earth Science Informatics 15:291–306
for each subseries are reconstructed to generate the final
• Performance analysis of proposed model in comparison
with other reproduced models along with benchmark
model. The proposed model observed as a best performer
among all models with lesser annual RMSE of 45.61 W/
m2, MAPE of 6.48% and ­R2 of 0.94. The forecast skill
of the proposed model against naïve predictor is also
observed and found 47%.
Therefore, the paper is structured in such a way that the
theoretical context of the wavelet transformation, LSTM
and BiLSTM deep learning network is defined in Section 2.
Section-3 deals with the framework of the suggested model
while Section-4 addresses various experimental scenarios.
All experiments are analyzed as a discussion in section-5.
Finally, the conclusion is drawn in section-6.
Theoretical background
This section provides a brief overview of the pre-processing
i.e. WT and deep learning networks related to the proposed
forecasting model.
Wavelet transform (WT)
It is a tool to process the highly random & time-varying data
signals by which time domain signal can be directly transformed into the time-scaled frequency domain . In other words, WT decomposes nonlinear and the
non-stationary data in to set of different frequency profiles.
These frequency profiles extract the appropriate statistical
characteristics of the input data series. The high frequency
components provide the short term variations in the data and
can be used to improve the forecasting accuracy for short
term prediction. The WT can be categorized into two types
according to the input signal: Continuous wavelet transform
(CWT) and Discrete wavelet transform (DWT) . This CWT can be expressed mathematically as:
where, ‘WCWT​’ is CWT, ‘GHI (t)’ is global horizontal irradiance time series, ‘ψ(t)’is mother wavelet which is scaled &
time shifted by ‘a’ & ‘b’ respectively.
Whereas, the DWT for a time series GHI (t); t = 1, 2 3,
can be expressed as a mother wavelet ‘ψm, k’ & father wavelet
‘φm, k’ and expressed mathematically as :
WCWT(a, b) = a−1∕2
In DWT, the convolution of father wavelet ‘φ’ with
original series ‘GHI(t)’ gives the approximation components ‘Am,k’. Whereas, the convolution of mother wavelet
‘ψ’with original series ‘GHI(t)’ gives the detail components ‘Dm,k’.
Or in simple terms, for a finite length of series with
finite decomposition is :
Where “D1, D2, D3 ,…., Dn” are the detailed components of input time series and “A1, A2, A3,…,An” are the
approximation components of input time series.
Long short‑term memory network (LSTM)
For processing the sequence data, J. J. Hopfield proposed
a structure in 1982, called Recurrent Neural Network
(RNN). Unlike conventional ANN, the output of RNN is
connected back to the input through feedback which acts
as dynamic memory . This network
performed best for the short term forecasting but becomes
unstable for long term forecasting. This instability is due
to exploding of gradient i.e. sudden large variations in
training weights . The
solution of gradient exploding was provided by LSTM network by allowing memory cells in the hidden layer(s).
These memory cells are used to appropriately store the
information or discard the relevant information of the data.
The basic architecture of the LSTM is shown in Fig. 2.
Each cell of the LSTM consists of forget gate (ft),
input gate (it) and output gate (Ot) to accept or discard of
any information . For a forward
movement function, the previous cell state ‘Ct-1’ has been
discarded by the network. At present time ‘t’, the LSTM
휓m,k(t) = (2m)1∕2휓(2m −t)
휑M,k(t) = (2M)1∕2휑(2M −t)
So, AM,k =
GHI(t)휑M,kdt
GHI(t)휓m,kdt
However, GHI(t) =
AM,k휑M,k(t) +
Dm,k휓m,k(t)
GHI(t) = D1 + D2 + D3 + ⋯+ Dn + A1 + A2 + A3 + ⋯+ An
Earth Science Informatics 15:291–306
network have three inputs ‘GHI (t)’, previous memory
cell output ‘ht-1’ and bias ‘bf’ of forget gate . Therefore, the activation values can be
expressed as:
The following equations are used by the network to
decide whether the information about data has to be discarded or retained.
Now, the final output of the memory cell becomes:
where “bi”, “bf,”, “bc” & “bo” are bias vectors of LSTM
network; “Wi”, “Wf”, “Wc” & “Wo” are weight vectors of
LSTM network and σ is sigmoid function ranges from ‘0’
Bidirectional long short‑term memories (BiLSTM)
The BiLSTM network is composed of forward and backward
LSTM in which data can be processed in forward as well as
in backward direction. The backward direction processing
captures the hidden characteristics and pattern of the data
which was generally ignored by LSTM . The
ft = 휎(Wf .[ht−1, GHIi(t)] + bf
it = 휎(Wi.[ht−1, GHIi(t)] + bi
Ct = tanh (Wc.[ht−1, GHIi(t)] + bc
Ct = ft ∗Ct−1 + ii ∗
Ot = 휎(Wo.[ht−1, GHIi(t)] + bo
ht = Ot ∗tanh .
The forward hidden layer ‘Lf’, the backward hidden layer
‘Lb’ and output sequence ‘GHIo(t)’ used to update the network. The network updates iteratively in backward i.e. from
‘T’ to ‘1’ and forward direction i.e. ‘1’ to ‘T’. The updated
parameters of the network can be expressed mathematically
Where, “Lf”, “Lb” & “GHIo(t)” are forward pass, backward pass and final output layers respectively. ‘W’ is the
weights coefficient and ‘ bLf ’, ‘ bLf’& ‘ bGHIo ’ are the biases
 .
Structure of proposed WT based BiLSTM
The basic idea of this work is to improve the forecasting
accuracy of Solar GHI using WT based BiLSTM network
in which different scenarios of WT pre-processing are being
applied. The Fig. 4 shows the pictorial representation of proposed model and description of each step is given below:
A) Quality control of data: Initially, the collected data from
any site is available in the raw form and has a great
influence on the model’s performance. There might be
possibilities of presence of negative or incomplete data
records due to weak pyranometer response. So, these
W1GHIi(t) + W2Lf−1 + bLf
Lb = 휎(W3GHIi(t) + W5Lb−1 + bLb
GHIo = W4Lf + W6L + bGHIo
Fig. 2   LSTM architecture
Fig. 3   BiLSTM architecture
Earth Science Informatics 15:291–306
entries must be removed or corrected before the application to the forecasting model . In
addition to this, the night hours data are also removed
from the dataset due to absence of solar irradiations in
night time. The data just before the sunset and just after
the sunrise is also a culprit factor in the model’s performance due to cosine error of instruments and must be
removed. In a single statement, this process can also be
understood as the removal of data having solar zenith
angle greater than ­80o .
B) Data Stationarity: The majority of the solar data collected from the site is often random and nonlinear in
nature which consists of periodicity and seasonality
 . Therefore, to enhance the model’s
efficiency, the data has to be rendered stationary before
providing to the forecasting model. This paper considers
the clear-sky index (CSI) calculation to render the data
stationary or to turn in the “0–1” range. The CSI can be
calculated as :
where, CSi(t) = Ioexp−
Sinb(h(t)) Sin(h(t))
where h (t) is height of solar (degree).
Io = Extra-terrestrial irradiation.
b = parameter of fitting.
Most research, however, have already shown that the clear
sky GHI is nearly identical to the CS and can be replaced
with each other, so
where, ­GHIcs = clear-sky GHI.
GHICSI(tk) = GHIi(t)
k = GHIi(t)
Fig. 4   Structure of proposed forecasting model
Earth Science Informatics 15:291–306
III) Data decomposition: Using data quality control,
once the time series has been cleaned & converted
into CSI. The WT is applied on the input data series
to decompose into approximation and detail components. This work observed the Daubechies (db7)
wavelet provides the required smoothness of considered data. However, the wavelet decomposition up
to level 1–10 was observed experimentally where
level-7 with db7 found best for the dataset used in
the study. The pictorial representation of level-7
decomposition is shown in Fig. 5; whereas, Fig. 6
represents the wavelet decomposition results for the
original solar GHI time series.
Here, GHI(t) = D1 + D2 + D3 + D4 + D5 + D6 + D7 + A7
IV) Selection of hyperparameters: One of the significant tasks in case of a deep learning algorithm
is the tuning of hyperparameters. However, no
such thumb-rule is present in the literature to
set these hyperparameters at optimal range. But,
the study obtained the optimal hyperparameters
using the grid search algorithm by varying each
parameter’s value with in a specific bound. The
specific process of searching the best hyperparameter is shown in Fig. 7 using a flow graph
whereas, Table 1 provides the best values along
with their corresponding bounds. This study
kept these fine-tuned hyperparameters constant
throughout the work to maintain the fairness in
the comparison of different models. The specific rules to select best hyperparameters are
mentioned below:
1) Set the initial hyperparameter at a default value.
2) Set the optimum learning rate.
3) Choose the perfect epoch with batch size.
4) Choose the relevant optimizer.
5) Select the appropriate activation function.
6) Choose suitable numbers of the hidden layer.
E) Forecasting Process: Input data is decomposed at
level 7 using db7 wavelet in which eight components: A7 and D7-D1 are obtained. So, as input
features, the eight components D1 to D7 and A7
with sufficient time lags are configured. This
study performed a comprehensive experiment to
obtain best solar GHI forecast for different combinations of decomposed components as input to
the predictor for different level’s decomposition
(refer Table 5). For the same, the input dataset
have been divided into two phases: the training
phase and forecasting phase. With the aid of one
year training data, forecasting is performed on
monthly basis up-to next 12 months with moving
window mechanism. The proposed model forecasts
24-h ahead of hourly data for each month. The
output sequence is reconstructed to have the actual
CSI at this stage. Although, using the following
equation, this sequence is further transformed into
real solar GHI from CSI.
Where, “CS(t)” & “CSI” are Clear sky GHI & clear
sky index respectively.
GHI(t) = CS(t) × CSI
Fig. 5   Level-7 decomposition using discrete wavelet transform
Earth Science Informatics 15:291–306
F) Performance Calculations:
Mean absolute percentage error :
where “ GH
I ” is forecasted value of GHI at ‘ith’ level
whereas, GHI is observed value of GHI.
Root Mean Square Error :
Coefficient of determination ­(R2):
It used to represent the goodness of fit of a model and it is
square of correlation coefficient ranges from 0 to 1.
Forecast Score (FS):
The percentage improvement in the forecasting by a developed model w.r.t. reference model is demonstrated by FS.
(GHIi −mean(GHIi
Error Indicatorproposedmethod
Error Indicatorref.method
Simulation results
This work originated with the wavelet & BiLSTM network
in order to enhance the accuracy of forecasts. The performance of proposed model has been compared with some
other standard models such as: naïve predictor, standalone
deep learning networks (LSTM, GRU & BiLSTM) and other
WT based models. The simulation is performed in MAT-
LAB 2020 environment where different scenarios of the
models have been evaluated. To suggest an accurate model,
the various simulations are performed as follows:
1) Naïve predictor, unidirectional LSTM, GRU and BiL-
STM network.
2) Traditional wavelet decomposition technique with BiL-
STM (WT-BiLSTM (T)).
3) Modified wavelet decomposition technique with BiL-
STM (WT-BiLSTM (Mod)).
4) Proposed wavelet decomposition forecasted technique,
which summed all forecasted decomposed components
(WT-BiLSTM (CF)), where CF means for component
forecasted.
5) Evaluation of forecasting performance of proposed
model using RMSE, MAPE, ­R2 & FS and compared
with naïve, LSTM, GRU, BiLSTM, WT-BiLSTM(T)
and WT-BiLSTM(mod) models.
Data description
Because of the large investments in the renewable sector
and exponentially increasing scope in India, this work considers the Indian location data set for the forecasting. This
work utilizes the hourly data gathered from NSRDB, for
Fig. 6   Level-7 wavelet decomposition results
Earth Science Informatics 15:291–306
Ahmadabad city situated in northern Gujarat, India with
latitude / longitude of ­23o.03 N/72o.58E with an average
elevation of 53 m. According to the Koppen climate classification, the studied location has mixed kind of climate with
subtropical hot steppe (‘bsh’) and humid subtropical (‘cwa’).
The collected dataset are the hourly recordings of different
meteorological parameters along with historical solar GHI.
However, a dataset of year 2013 & 2014 have been used
to train, validate and test the proposed model. The entire
dataset was split into different datasets: training dataset
(80%), validation dataset (10%) and test dataset (10%). The
study used the dataset of year 2013 for the training purpose
while the next year data have been carried out to evaluate
the model using monthly forecasting.
Experimental setup
All the developed models including proposed model are
evaluated in terms of error (RMSE, MAPE), coefficient of
determination ­(R2) and forecasting skill (FS). To implement the improved & accurate forecasting model, different
scenarios of experiments have been conducted. The RMSE,
MAPE & ­R2 for all scenarios are recorded in Tables 2, 3,
and 4 and are discussed below:
# Scenario 1: Forecast using naïve, LSTM, GRU & BiL-
This experiment is all about the development of benchmark & standalone deep learning models such as: Naïve,
standalone LSTM, GRU and BiLSTM. The experiment
is conducted for the forecasting of different month-wise
24-h ahead solar GHI where input initialization and finetuning of the hyperparameters of deep learning networks
is one of the important tasks to achieve the better accuracy.
The 15 time lags of input data series are provided to these
deep learning based standalone models as an input features; whereas, the solar GHI is used as an output feature.
Finally, the value of MAPE obtained by naïve, standalone
LSTM, GRU and BiLSTM ranges from 2.41%–30.03%,
3.31–32.97%, 3.66–33.18%, and 2.51–18.96% respectively;
RMSE ranges from 32.02–185.44 W/m2, 40.33–161.84 W/
m2, 32.73–164.01 W/m2 and 30.94–113.06 W/m2 respectively. Moreover, the correlation coefficient ­R2 ranges from
0.33–0.95, 0.40–0.95 and 0.41–0.97 for naïve, standalone
LSTM, GRU and BiLSTM respectively. Figure 8 shows the
annual average RMSE & MAPE comparison of this scenario. From these observations, It is clear that the BiLSTM
Fig. 7   Flow graph for selecting hyperparameters
Table 1   Hyperparameters values used in the study
Hyperparameter
Searched range
Hyperparameter
Searched range
Hidden Units
Initial Learning Rate
0.0001–0.1
adam, sgdm, RMSprop
Learning Rate Drop Period
Learning Rate Drop Factor
Earth Science Informatics 15:291–306
Table 2   RMSE (W/m2) comparison of developed models
WT-BiLSTM (T)
WT-BiLSTM (Mod)
Proposed Model
Table 3   MAPE (%) comparison of developed models
WT-BiLSTM (T)
WT-BiLSTM (Mod)
Proposed Model
Table 4   R2 comparison of
developed models
0.91 0.86 0.95 0.93 0.92
0.78 0.46 0.33 0.56 0.88 0.93 0.92 0.78
0.95 0.92 0.95 0.95 0.90
0.80 0.43 0.40 0.58 0.88 0.90 0.92 0.80
0.96 0.93 0.97 0.97 0.94
0.84 0.43 0.41 0.57 0.90 0.94 0.95 0.82
0.97 0.95 0.97 0.96 0.94
0.87 0.82 0.69 0.86 0.92 0.96 0.97 0.91
WT-BiLSTM (T)
0.97 0.96 0.97 0.97 0.94
0.88 0.84 0.72 0.87 0.93 0.96 0.98 0.91
WT-BiLSTM (Mod) 0.97 0.96 0.98 0.97 0.95
0.89 0.85 0.73 0.89 0.94 0.96 0.98 0.92
Proposed Model
0.97 0.97 0.98 0.98 0.96
0.92 0.86 0.78 0.92 0.95 0.98 0.98 0.94
Fig. 8   Annual average RMSE (W/m2) & MAPE (%) of different models
Earth Science Informatics 15:291–306
network outperforms over LSTM & GRU as is also claimed
in various previous studies .
# Scenario 2: Forecast using traditional WT and BiLSTM
(WT-BiLSTM (T))
The traditional WT is used in this experiment to decompose the input data time series. This experiment utilizes
all the decomposed components of WT along with the fifteen time lags of input data as input features of the BiL-
STM model. The results in the Tables 2, 3 and 4 shows that
the WT-BiLSTM(T) achieved lesser RMSE, MAPE and
improved ­R2 in comparison to standalone LSTM, GRU and
BiLSTM networks. This model achieved MAPE ranges from
2.39–17.77%, RMSE ranges from 25.53–107.17 W/m2 and
­R2 ranges from 0.72–0.98. Moreover, the average annual
RMSE, MAPE and ­R2 obtained from the same is 51.77 (W/
m2), 7.49% and 0.91 respectively.
# Scenario 3: Forecast using Modified wavelet decomposition and BiLSTM (WT-BiLSTM (Mod))
Unlike, the traditional wavelet where all decomposed
components were used as input features to the BiLSTM
network. This experiment employs the different combinations of decomposed components as an input feature with
the time lag input data. A thorough analysis has been done
to observe the effect of these combinations of decomposed
components as an input feature to the performance of model.
Table 5 shows the observations recorded for different combinations of decomposed components as input features. Here,
the observations from these combinations are shown only for
the month of January. It is evident that the BiLSTM network
provides lesser RMSE of 31.91 W/m2 and MAPE of 3.43%
with the combinations A7, D7 and sum (D1-D6). In this
combination, the detail components D1-D6 are added and
resultant subseries is considered as a single input feature to
the model instead of six subseries (D1 to D6).
Finally, A7, D7, sum (D1-D6) with time lag input series
are used as an input features to the BiLSTM network to
forecast the solar GHI. It is evident from Tables 2, 3, 4,
this model obtained MAPE ranges from 2.39–17.46%,
RMSE ranges from 23.78–106.65 W/m2 and ­R2 ranges from
0.73–0.98. Moreover, the average annual RMSE obtained
from the same is 50.36 (W/m2), MAPE is 7.28% and ­R2
is 0.92. From the results, it can be seen that this model
improves the forecasting accuracy in comparison to naïve,
LSTM, GRU, BiLSTM, and WT-BiLSTM (T).
# Scenario 4: Forecast using proposed WT BiLSTM
Model (WT-BiLSTM (CF))
The proposed model is implemented in this scenario
with an aim to achieve credible improvements in the
forecasting accuracy. Unlike, all above experiments, this
experiment allocated the separate BiLSTM network to each
of the resultant decomposed series i.e. A7, D7 and Sum
(D1 to D6) to forecast the future subseries’s values. The
fifteen-time lags of every decomposed component series
are considered as the input features to their respective
networks. The final prediction is obtained by the wavelet
reconstruction process where outputs of each BiLSTM networks are further added to each other. From Tables 2 and
3, the MAPE obtained by the proposed model ranges from
2.02–14.66% whereas RMSE is from 21.24–96.38 W/m2.
Table 4 shows the value obtained for ­R2 which is ranges
from 0.78–0.98. Moreover, this model achieved the lowest
annual average RMSE (45.61(W/m2)), MAPE (6.48%) and
­R2 (0.94).
Discussion
The research has been conducted to forecast the 24-h ahead
solar GHI for the location of Ahmadabad, Gujarat, India
in which various experiments are carried out to obtain the
precise forecast model with improved forecasts. In order
to show the superiority of proposed model, the forecasting
performance has been compared with naïve predictor, unidirectional LSTM, unidirectional GRU, BiLSTM and waveletbased BiLSTM models.
From the prospective of overall results,
Table 5   Analysis of WT components combinations as an input features
Combination
RMSE (W/m2)
Combination
RMSE (W/m2)
A7, D7, D6, D5, D4, D3,D2, D1
A7, D7, D6, D5, D4, D3, Sum(D1-D2)
A7, D7, D6, D5, D4, D3, D2
A7, D7, D6, D5, D4, Sum (D1-D3)
A7, D7, D6, D5, D4, D3
A7, D7, D6, D5, Sum (D1-D4)
A7, D7, D6, D5, D4
A7, D7, D6, Sum (D1-D5)
A7, D7, D6, D5
A7, D7, Sum (D1-D6)
A7, D7, D6
A7, Sum (D1-D7)
Earth Science Informatics 15:291–306
a) Naïve predictor provides the largest annual average
RMSE of 86.33 W/m2 and MAPE of 11.74% due to
poorest RMSE in months of February, June–September.
The ­R2 is also lesser in case of naïve predictor which
represents the worst forecasting accuracy among all
b) As far as, the standalone models are concerned, BiLSTM
is the best performer among the naïve, LSTM & GRU.
The annual average RMSE, MAPE & ­R2 obtained by
BiLSTM is 56.03 W/m2, 8.02% & 0.91% respectively.
Whereas, among naïve, GRU and LSTM; GRU performed well than the LSTM & benchmark model with
annual average RMSE, MAPE & ­R2 of 77.03 W/m2,
12.84% and 0.82 respectively.
c) The traditional WT based BiLSTM model (WT-BiL-
STM (T)) performed better than the standalone deep
learning based & naïve models. It obtained 51.77 W/
m2 of annual average RMSE, 7.49% annual average
MAPE and 0.91 ­R2. However, the WT-BiLSTM
(mod) model achieved the next level lowest annual
average RMSE (50.36 W/m2) and annual average
MAPE (7.28%). This model obtained the ­R2 equals
to the 0.92.
d) Finally, the proposed model performed the best with
lowest annual average RMSE (45.61 W/m2), annual
average MAPE (6.48%). The credible improvement
can also be seen in the coefficient of determination ­R2
(0.94). From the Fig. 9, it is evident that the maximum
percentage improvement is provided by the proposed
model in RMSE & MAPE is 57% & 58.92% respectively
concerning to standalone LSTM model. However, this
improvement is 56.06% & 59.19% respectively against
standalone GRU and 31.35% & 28.14% respectively
against standalone BiLSTM model. Even, the proposed
model also shows a great percentage improvement in
RMSE against the naïve predictor ranges from 26.04%–
58.89%. It provides the great improvements of above
40% in the eight months i.e. Jan, Feb, March, July, Aug,
Sep, Nov and December.
From the month wise prospective,
a) From the literature, no doubt naïve predictor provides
the good accuracy for the shorter time horizon with
lesser variations in the dataset. However, it is not suitable for the larger time horizon as well as the dataset
having larger variations. From the results, it is obvious that the naïve predictor performed better than the
LSTM in the month of April, May & November while
better than GRU in month of April and November with
a minor difference in RMSE. The MAPE obtained by
naïve predictor in month of January, March April, May,
July, September, October, November and December are
better than LSTM & GRU. These lowest results are however, uncertain but due to the variations in the datasets.
b) On the other hand, in comparison to the traditional standalone LSTM, GRU & BiLSTM models, the performance of standalone BiLSTM model is better than the
LSTM & GRU for all months. The standalone BiLSTM
model obtained minimum RMSE of 30.94 W/m2 for the
month of December & MAPE of 2.51% for the month
of April. Moreover, the ­R2 for BiLSTM model is also
better for each month. Even, the naïve predictor, LSTM
& GRU model obtained the worst ­R2 for the month of
July, August & September i.e. 0.46,0.33,0.56 for naïve,
0.43, 0.40, 0.58 for LSTM and 0.43, 0.41, 0.47 for GRU.
The results demonstrated that the ­R2 for these three
months are drastically improved by BiLSTM model i.e.
0.81, 0.69, and 0.86. So, the standalone BiLSTM model
improves the forecasting accuracy as compared to standalone unidirectional LSTM, GRU and naïve predictor
due to its learning capabilities in both directions.
c) By contrast, the wavelet-based models produced high
accuracy with lesser error than the standalone models.
The traditional wavelet based BiLSTM model performed
better than all standalone models including naïve predictor for all months due to extraction of statistical features of input series. It obtained lowest RMSE & MAPE
of 29.86 (W/m2) and 2.39% respectively in month of
Fig. 9   Percentage improvement
by proposed model over different models
Earth Science Informatics 15:291–306
April. The maximum RMSE & MAPE obtained by WT-
BiLSTM (T) is 107.17 (W/m2) and 17.11% in month
of August. The maximum ­R2 (0.98) is achieved by the
WT-BiLSTM (T) for the month of December.
d) It is also evident from the results that the modified
approach of WT with the summation of decomposed
components D1-D6 improved the forecasting accuracy
than a traditional WT. The lowest RMSE is 23.78 W/
m2 for the month of December & maximum RMSE is
106.65 W/m2 for the month of august for the modified
WT i.e. WT-BiLSTM (mod). Whereas, it is 25.53 W/
m2 & 107.17 W/m2 for a traditional WT respectively for
the same months. However, the ­R2 value for the month
December for WT-BiLSTM (mod) is same as WT-
BiLSTM(T) i.e. 0.98 but the improvement was obtained
in month of august i.e. 0.73 for WT-BiLSTM(mod) and
0.72 for WT-BiLSTM(T).
e) Finally, the proposed model where each component
of WT was separately forecasted using BiLSTM, performed better than all other models. The proposed
model obtained lowest RMSE (21.24 W/m2) for month
of December and maximum RMSE (96.38 W/m2) for
the month of August. Whereas, the MAPE obtained by
the proposed model is also lesser than others i.e. minimum MAPE of 2.02% and maximum MAPE of 14.66%.
Moreover, the ­R2 value is also improved in month of
august i.e. 0.78 which was initially 0.33 for naïve predictor. The maximum ­R2 (0.98) is achieved by the proposed
Model for the months of March, April, November and
For a deep look into the results, the Fig. 10 provides
the graphical analysis of real and forecasted GHI for three
consecutive days (2nd to 4th day) of two months (March
& August). These two months are to visualize the results
of month with lesser RMSE (March) and larger RMSE
(August). Nevertheless, for a clear presentation, only real
GHI and forecasted GHI curves of proposed model is presented for selected months. It is clear from the Fig. 10; the
large variations in the real GHI curve provided the larger
error in the results. For instance, the month of March has a
smooth curve due to clear sky conditions and easily traceable by the model. Unlike this month, the real GHI is frequently varying in the month of August due to presence
of cloudy or rainy days, and is hard to trace by the model
results in maximum errors. From these curve traces, it
can be concluded that higher is the variations in real GHI,
lower is the similarity in real and forecasted GHI. Similarly, lower are the variations in the real GHI; higher is the
degree of similarity between real and forecasted GHI. But,
the proposed model also follows uncertainties associated
with real GHI with in tolerance band of error. Therefore,
these observations yield that the proposed model is a suitable forecasting model not only for stable type of seasons
but also for unstable seasons.
For further explanation of forecasting performance,
Table 6 shows the FS% results of proposed model and
WT-BiLSTM (mod) for annual RMSE & MAPE with reference to benchmark model.
Lastly, to validate the performance of the proposed
model against previously reported models is presented in
Table 7. The superiority of the proposed model is shown
in terms of RMSE, MAPE and FS.
According to the Table 7, the proposed model appears
to be the best and excellent model to forecast solar GHI
over latest developed models. The model performed shows
its superiority in terms of lower RMSE & MAPE and
higher forecasting skills over LSTM, GRU, CNN-LSTM,
DFT-PCA-Elman and standalone BiLSTM. Therefore, the
overall results suggested that the proposed model can be a
good choice to forecast solar GHI for practical solar power
systems also.
Fig. 10   a, b Performance of
proposed model for month
March & August respectively
(b) August
GHI (W/m²)
Data Points
Forecasted GHI
GHI (W/m²)
Data Points
Forecasted GHI
Table 6   Annual %FS of proposed model
WT-BiLSTM(mod)
Proposed Model
Earth Science Informatics 15:291–306
Conclusion
In the renewable energy markets, solar energy has its
own space & significance. The stability and efficiency
of solar forecasting are therefore crucial for the regular
operation of interconnected grid systems. Most of the
time, the standalone models are unable to capture the
fluctuating inherent solar time series characteristics. So,
an ensemble model to forecast the 24-h ahead hourly
solar GHI is proposed using the WT and BiLSTM network. The performance of the proposed model is rigorously evaluated by the GHI forecast on monthly basis
for a year 2014 using moving window. The WT is used
to extract the statistical features of the input time series
using low and high frequency time series (IMF) while
BiLSTM network is employed to the forecast. Meanwhile, the forecasting performance of the proposed
model is compared with the naïve predictor, standalone
LSTM, GRU, BiLSTM and two different WT based BiL-
STM model. The results show that the proposed model
outperforms the other models with minimum annual
average RMSE (45.61 W/m2) and MAPE (6.48%). The
forecast skill and the ­R2 for the proposed model are 47%
and 0.94 respectively. Finally, the maximum percentile
improvement in RMSE by proposed model is 58.38%,
58.11%, 56.06% & 31.35% over benchmark model, standalone LSTM, GRU and BiLSTM respectively; whereas,
maximum percentile improvement in MAPE is 51.76%,
58.92%, 59.19% & 28.14% over benchmark model, standalone LSTM, GRU and BiLSTM respectively. Therefore, proposed model is proved to be the best forecasting
model for 24-h ahead solar forecasts with consideration
of all seasonal as well as monthly aspects. However,
the study observed some challenges while designing the
models such as: selection of precise hyperparameters
and simulation time. So, in future by considering these
challenges, more accurate and efficient results can be
obtained within quick simulation time.
Data availability  The data that support the findings of this study are
available from the corresponding author upon reasonable request.
Code availability  The codes of this study are available from the corresponding author upon reasonable request.
Declarations
Not Applicable.
Conflict of interest  On behalf of all authors, the corresponding author
states that there is no conflict of interest.