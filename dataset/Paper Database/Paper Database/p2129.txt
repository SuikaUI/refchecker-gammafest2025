Big Data meets Quantum Chemistry Approximations: The ∆-Machine Learning
Raghunathan Ramakrishnan and Matthias Rupp
Institute of Physical Chemistry and National Center for Computational Design and Discovery of Novel Materials,
Department of Chemistry, University of Basel, Klingelbergstrasse 80, CH-4056 Basel, Switzerland
Pavlo O. Dral
Computer-Chemie-Centrum and Interdisciplinary Center for Molecular Materials,
Department Chemie und Pharmazie, Friedrich-Alexander-Universit¨at Erlangen-N¨urnberg,
N¨agelsbachstrasse 25, 91052 Erlangen, Germany and
Max-Planck-Institut f¨ur Kohlenforschung, Kaiser-Wilhelm-Platz 1, 45470 M¨ulheim an der Ruhr, Germany
O. Anatole von Lilienfeld
Institute of Physical Chemistry and National Center for Computational Design and Discovery of Novel Materials,
Department of Chemistry, University of Basel, Klingelbergstrasse 80, CH-4056 Basel, Switzerland and
Argonne Leadership Computing Facility, Argonne National Laboratory,
9700 S. Cass Avenue, Lemont, IL 60439, USA∗
Chemically accurate and comprehensive studies of the virtual space of all possible molecules
are severely limited by the computational cost of quantum chemistry. We introduce a composite
strategy that adds machine learning corrections to computationally inexpensive approximate legacy
quantum methods. After training, highly accurate predictions of enthalpies, free energies, entropies,
and electron correlation energies are possible, for signiﬁcantly larger molecular sets than used for
training. For thermochemical properties of up to 16k constitutional isomers of C7H10O2 we present
numerical evidence that chemical accuracy can be reached. We also predict electron correlation
energy in post Hartree-Fock methods, at the computational cost of Hartree-Fock, and we establish
a qualitative relationship between molecular entropy and electron correlation. The transferability
of our approach is demonstrated, using semi-empirical quantum chemistry and machine learning
models trained on 1 and 10% of 134k organic molecules, to reproduce enthalpies of all remaining
molecules at density functional theory level of accuracy.
INTRODUCTION
Designing new molecular materials is one of the key
challenges in chemistry, and a major obstacle in solving
many of the pressing issues that today’s society faces,
such as clean and cheap water, advanced energy materials, or novel drugs to ﬁght antibiotic resistant bacteria. Unfortunately, the number of potentially interesting
small molecules is too large for exhaustive screening , even when relying on automated synthesis and combinatorial high-throughput “click-chemistry” . Virtual screening strategies, made feasible by ever increasing compute power, advanced atomistic simulation software, and quantitative structure-property relationships
have already helped in the discovery of new materials,
and provided crucial guidance for subsequent experimental characterization and fabrication . To achieve
the overall goal of de novo in silico molecular and materials design , however, substantial progress is still
necessary , especially regarding prediction accuracy,
computational speed, and transferability of the employed
For quantum chemistry models to attain “chemical accuracy” (≈1 kcal/mol) in the prediction of covalent bind-
∗ 
ing is crucial in many scientiﬁc domains. Examples include the understanding of combustion processes ;
questions relevant interstellar chemistry ; and prediction of reaction rates essential for catalysis.
The latter depend exponentially on energy diﬀerences, implying
that small errors on the order of kBT propagate dramatically.
More generally, reaching chemical accuracy
can be crucial for the detection of new structure property relationships, trends or patterns in Big Data, the
design of new molecular materials with sensitive property requirements, or the energetics of competing reactants and products determining mechanisms and reaction
rates. Control over the accuracy of important thermochemical properties of molecules can be achieved through
application of well-established hierarchies in quantum
chemistry . Calibrated composite methods such as
John Pople’s Gaussian model chemistry exploit the inherent transferability of corrections to electronic correlation, the Born-Oppenheimer approximation, or basis-set
deﬁciencies . This has enabled chemists to routinely achieve chemical accuracy for any non-exotic and
medium-sized organic molecule at substantial yet manageable computational costs .
Unfortunately, such calculations are too demanding for
the routine investigation of larger subsets of chemical
Note, however, that the computationally most
demanding task in a quantum chemistry calculation corarXiv:1503.04987v1 [physics.chem-ph] 17 Mar 2015
responds to an energy contribution that constitutes only
a minor fraction of the total energy, while most of the
relevant physics can already be accounted for through
computationally very eﬃcient approximate legacy quantum chemistry, such as the semi-empirical theory PM7,
Hartree-Fock (HF), or even density functional theory
(DFT). For the water molecule H2O, for example, HF
approximates the experimental ionization potential by
more than 90% . Calculating the remaining ∆with
chemical accuracy using correlated electronic structure
methods requires a disproportionate amount of computational eﬀort due to unfavorable pre-factors and scaling
with number of electrons. In this study, we introduce an
alternative Ansatz to model the expensive ∆using a statistical model trained on reference data requiring only a
fraction of the computational cost. The observed speedup, up to several orders of magnitude, is due to the computational eﬃciency of machine learning (ML) models.
We have validated this idea for several molecular properties, combining quantum chemistry results at several
levels of theory with ∆-ML models trained over comprehensive molecular data sets drawn from 134 kilo organic
molecules published in Ref. 27. While the basic idea to
augment approximate models with ML is not new , we present a generalized ∆-ML-model that achieves
unprecedented chemical accuracy and transferability.
We present numerical evidence for predicted atomization enthalpies, free energies, and electron correlation in
many thousands of organic molecules (reaching molecular weights of up to 150 Dalton) with an accuracy of
≈1 kcal/mol at the computational cost of DFT or PM7.
We validate the ∆-ML model for entirely new subsets
of chemical space, up to two orders of magnitude larger
than the set used for training. Using ∆-ML-based screening, we ﬁnd that within the constitutional isomers of
C7H10O2, molecular entropy and electron correlation energy of atomization are not entirely independent from
each other. This suggests not only signiﬁcant coupling
between electronic and vibrational eigenstates but also
the existence of Pareto fronts that can impose severe limitations with respect to simultaneous property optimization. Finally, we establish transferability by accurately
predicting properties for a much larger molecular dataset
comprising of 134k molecules.
THE ∆-ML APPROACH
b-model of a molecular property corresponds to
a baseline (b) value plus a correction, towards a targetline
(t) value, modeled statistically. More speciﬁcally, given
a property P ′
b, such as the energy Eb, for the relaxed
geometry Rb of a new query molecule, calculated using
an approximate baseline level of theory, another related
property Pt, such as the enthalpy Ht, corresponding to a
more accurate and more demanding target level of theory
can be estimated as
Pt(Rt) ≈∆t
b(Rb) = P ′
αik(Rb, Ri).
The sum represents an ML-model, here a linear combination of Slater-type basis functions, k(Rb, Ri)
e−|Ri−Rb|/σ, centered on N training molecules, and
with global hyperparameter σ—the kernel’s width. The
regression coeﬃcients {αi} are obtained through kernel ridge regression, a regularized nonlinear regression
model that limits the norm of regression coeﬃcients,
thereby reducing overﬁtting and improving the transferability of the model to new molecules. |Ri−Rb| is a quantitative measure of similarity between query molecule and
training molecule i, using the Manhattan-norm (L1) between sorted Coulomb matrix representations .
The latter uniquely encodes (except among enantiomers)
the external potential of any given molecule in a way
that is invariant with respect to molecular translation,
rotation, or atom-indexing.As such Pt of a new molecule,
consistent with its minimum geometry Rt at the target
level of theory, is estimated using exclusively Rb and P ′
as input. Thus, the ∆-model accounts for diﬀerences in
(i) deﬁnition of property observable, e.g. energy →enthalpy, (ii) level of theory, e.g. PM7 →G4MP2, and (iii)
changes in geometry (illustrated in 1).
Two hypothetical property proﬁles connecting two
constitutional isomers of C7H10O2. The ∆-model, Eq. (1),
estimates the diﬀerence between baseline and targetline properties (arrow) which diﬀer in level of theory (b →t), geometry
(Rb →Rt), and property (Eb →Ht).
As a ﬁrst test of our Ansatz, we have trained ∆t
models for HOMO and LUMO eigenvalues calculated at
various levels of theory for the smallest 7k organic
molecules in the GDB-dataset introduced by Reymond
and coworkers .
After training on calculated data
for 1k molecules, the resulting ”1k ∆-model” reduces
the mean absolute error (MAE) in the prediction of GW
HOMO eigenvalues for the remaining 6k molecules from
0.78 to 0.23 eV for the semi-empirical ZINDO baseline
method. Interestingly, while the less empirical DFT hybrid (PBE0) baseline method has an MAE of more than 2
eV, this reduces to less than 0.1 eV when combined with
the 1k ∆-model. Correspondingly, MAEs for predicting
GW LUMO eigenvalues reduce from 0.91 to 0.16 eV and
from 1.3 to 0.13 eV for ∆GW
ZINDO and ∆GW
PBE0, respectively.
This observation suggests that more sophisticated baseline models, albeit occasionally leading to more substantial errors than simpler models, overall are smoother in
chemical space, and therefore easier to learn.
Illustration of chemical diversity and data density of
up to ∼100 molecules per kcal/mol of atomization enthalpy H
(G4MP2 level of theory ), shown in ascending order for
all 6k constitutional isomers of C7H10O2 in the GDB-17 dataset . Seven near degenerate (within ≈0.01 kcal/mol)
molecules in the inset exemplify the chemical diversity.
RESULTS AND DISCUSSION
Chemically accurate prediction of covalent
To demonstrate that the ∆-ML model can reach chemical accuracy, we have investigated the covalent binding
energies of the 6k constitutional isomers of C7H10O2 in
the GDB . Note that any other molecular set could
have been used just as well. We relied on previously calculated highly accurate target level atomization energies
(Et in 1) at the G4MP2 level for these isomers .
G4MP2 is widely considered to be on par with experimental uncertainties .
While structurally highly
diverse, this data-set exhibits many near-degeneracies
with high energy densities of up to ∼100 molecules per
kcal/mol in atomization enthalpy H ( inset of 2).
The ∆-ML model’s systematic improvement of accuracy with increasing training set size is shown as a log-logplot in 3 for the potential energy of atomization. Starting
at diﬀerent oﬀsets, corresponding to the respective error
of the pure baseline methods, the MAE, measured out-ofsample on the remaining molecules in the 6k set, rapidly
decreases. Note the constant decay rate for training set
sizes larger than 1000 for all ∆G4MP2
-ML model errors.
This suggests that for all models the error could be lowered even further if more training data were used.
MAE [kcal/mol]
Mean absolute error (MAE) [kcal/mol] of ML predicted atomization energies compared to G4MP2 reference
values as a function of training set size N for out-of-sample
predictions. The lines correspond to various baselines in the
-model (Eq. ). The MAE at N = 0 represents the
baseline’s error. For comparison, the baseline-free ML model
is shown as well (green); its N=0 value is the standard deviation in the G4MP2 atomization energies of the data set.
The ”chemical accuracy” target of 1 kcal/mol is highlighted
in blue. ∆G4MP2
(brown) and ∆G4MP2∗
(pink) are variants of
(yellow) using reparameterized PM7 as baseline or
an alternative molecular representation, respectively.
While the error of the GGA DFT baseline model
) in 3 starts oﬀslightly higher than the
more accurate hybrid DFT analogue (∆G4MP2
B3LYP ), both
rapidly converge to chemical accuracy (< 1 kcal/mol)
for less than 1k training molecules.
B3LYP reaches
∼0.4 kcal/mol for a 5k training set.
For the substantially faster, yet more approximate PM7 baseline
model (∆G4MP2
) an accuracy similar to pure hybrid DFT
(B3LYP) can be achieved with 2k training molecules, and
for 5k training molecules the error has been quenched
to less than 2 kcal/mol. All ∆-ML models outperform
an ML model trained on the absolute value of Et directly , without a baseline.
We also considered the eﬀect of reparameterizing the
baseline method on the training set before applying ∆-
ML. The arguably simplest model, Benson’s thermochemical bond additivity model (bound counting), has
a prediction error of MAE≈100 kcal/mol for the 6k isomers. After reparameterization of all bond energies to
ﬁt the training data, its MAE reduces to ≈30 kcal/mol,
which is worse than direct ML. Along the same line, we
optimized all semi-empirical parameters in PM7 in order to reproduce G4MP2 atomization enthalpies of up to
128 C7H10O2 isomers, drawn at random. 3 (brown line)
shows that when using this reparameterized (RPM7)
baseline model in ∆G4MP2
it does allow for an improved
oﬀ-set, however the advantage vanishes when increasing
training set size beyond 1k (3). Using the semi-empirical
model OM2 , instead of PM7, we found a similarly
vanishing eﬀect. These ﬁndings indicate the severe limitations inherent in ﬁxed functional forms of electronic
semi-empirical model Hamiltonians used in combination
with globally optimized parameters—no matter the actual combination of parameters.
Statistically learned
∆-corrections, inferred from large numbers of example
molecules, however, seem capable of capturing the more
delicate energy contributions in the G4MP2 energy. We
have also tested the eﬀect of using an alternative molecular representation. The ∆G4MP2∗
model in 3 (pink line)
shows the improvement of performance of the ∆G4MP2
model when replacing the above mentioned Coulombmatrix representation by the bag-of-bond descriptor recently introduced by one of us . Encouragingly, also
for this descriptor one observes similar decay rates, and
an even better performance than for the Coulomb-matrix
based ∆-model, reaching chemical accuracy for a training
set size of 5k.
Chemically accurate thermochemistry
Prediction accuracy for thermochemical properties,
such as internal energies, enthalpies, free energies and
entropies of atomization at 298.15 K, all trained to reproduce G4MP2 target level of theory for the same set
of 6k constitutional isomers of C7H10O2 were investigated. ∆-ML models have been trained for three baselines, ∆G4MP2
, and ∆G4MP2
B3LYP , on subsets of varying sizes. The baseline properties corresponded in this
case simply to the potential energy of atomization, with
the ML model accounting for diﬀerences in level of theory,
in geometry, as well as for the respective thermodynamic
eﬀects. I lists resulting errors and standard deviations of
predicted enthalpies of atomization at 298.15 K for various trainingset sizes. As before, ∆-ML models display
rapid error decay with increasing training set size. Encouragingly the standard deviation also decays rapidly
with training set size. Again, the DFT baseline models
yield MAEs of less than 1 kcal/mol already at 1k training set size, and the error of the 5k-∆G4MP2
B3LYP -ML model
remains below even after addition of the standard deviation. The computationally less expensive PM7 baseline model performs slightly worse than the DFT based
models. The 1k-∆G4MP2
-ML model decreases the pure
PM7 prediction error and standard deviation by more
than ∼50%, and converges to near chemical accuracy
(1.7 kcal/mol) for a 5k training set. Computational effort for out-of-sample predictions is dominated by baseline evaluations. For internal energies, free energies and
entropies of atomization we have observed nearly identical convergence and baseline trends. All these results
indicate that the ∆-ML approach represents an inexpensive strategy to accurately estimate not only diﬀerences
in potential energies due to diﬀerent electronic structure
models, but to also account for thermal contributions to
thermodynamic state functions without having to calculate the corresponding partition functions. Note that the
latter can be prohibitively expensive when using more
accurate theories.
Mean absolute errors ± standard deviations
for predicted out-of-sample enthalpies of atomization H
(T=298.15 K) at G4MP2 level of theory using the ∆G4MP2
ML model for increasing training set size N in Eq. (1). All
values in kcal/mol. Training and test set sizes always add up
to 6095 constitutional isomers of C7H10O2.
6.4±8.6 3.0±4.1 2.5±3.1
0.1k 5.7±7.6 2.2±2.9 1.5±1.9
3.9±4.1 0.8±1.1 0.7±0.9
2.4±3.1 0.6±0.8 0.6±0.7
2.2±2.8 0.5±0.7 0.5±0.6
1.9±2.4 0.5±0.6 0.4±0.6
1.7±2.2 0.5±0.6 0.4±0.5
Electron correlation
To further assess the applicability of the ∆-ML Ansatz,
we modeled electron correlation energies, essential for
achieving chemical accuracy. Within post-HF theory, electron correlation energy can be deﬁned as the
diﬀerence between converged basis-set HF potential energy and its corresponding non-relativistic exact counterpart. Evaluating the many-electron correlation energy at the post-HF level of theory requires substantial
computational eﬀort. The computational complexity of
the simplest post-HF method, second order perturbation
theory (MP2), scales as N 5
e , where Ne is the number of
electrons. The “gold standard” of quantum chemistry,
CCSD(T), even scales as N 7
e . Revisiting the 6k constitutional isomers of C7H10O2 (2), we have calculated the
diﬀerence in the correlation energy part of molecular atomization energies for various correlated methods.
For the 6k isomers MAEs, after accounting for systematic shifts, are shown in 4 for various combinations of HF,
MP2, CCSD, and CCSD(T), along with the reduction of
error due to 1k-∆t
b models. Particularly noteworthy is
the result for the ∆CCSD(T)
model giving the total correlation energy (deﬁned as diﬀerence between HF and
the exact result as approximated by CCSD(T)) between
MAE [kcal/mol]
Mean absolute error (MAE) [kcal/mol] of Eb (blue
bars) and 1k ∆t
b-ML model predictions (red bars) of atomization energies for various combinations of increasingly correlated post-Hartree-Fock methods as target and baseline methods. These values are obtained after subtracting the systematic average shift that exists between methods for the 6k isomers. See Supplementary Information for details.
the least and most expensive method: The MAE is reduced from ∼2.9 to less than 1 kcal/mol. Note that the
model has a larger MAE from MP2 than the
MAE of the 1k-∆CCSD
from CCSD, even though MP2
is more approximate in nature than CCSD. As such, the
MP2 target, albeit less accurate and more approximate
than CCSD, appears to be a more complex function in
chemical space.
Remarkably,
models the MAE amounts in both cases to less
than 0.5 kcal/mol. This suggests the possibility of the
proverbial free lunch modeling the more accurate and
computationally more expensive CCSD(T) level of theory with the same training set size and precision as the
less accurate and less expensive CCSD method.
least approximate baseline, encoded by the 1k-∆CCSD(T)
model, yields a chemically nearly negligible MAE from
CCSD(T), ∼0.1 kcal/mol. For larger training set sizes we
have observed correlation energy errors to decay similarly
to the error of DFT baseline models for thermodynamic
properties.
Applicability: Diastereomers of C7H10O2
We have tested the applicability of the 1k-∆-ML
model, trained on 1k out of the 6k C7H10O2 isomers in
the GDB database, for the identiﬁcation of the most stable diastereomers that can be generated from the parent
isomers. Such screening applications are highly relevant
for spectroscopic or computational experiments aimed at
the discovery and characterization of competing reaction
pathways, recently discussed for an “ab initio nanoreactor” . More speciﬁcally, we applied the 1k ∆G4MP2
model of atomization enthalpy at 298.15 K (I), to screen
all the 9868 unique and stable diastereomers resulting
from inversion of atomic stereocenters in the original
GDB set of 6095 constitutional isomers of C7H10O2 (see
Methods section).
For validation, we have randomly
drawn 3k diastereomers and calculated their computationally demanding G4MP2 enthalpies of atomization.
The 1k-∆G4MP2
B3LYP model yields a MAE of 0.8 kcal/mol for
these 3k diastereomers. We have chosen the DFT baseline for this exercise because cheaper baseline models,
such as 5k ∆G4MP2
and ∆G4MP2∗
(3), exhibit less transferability when validated on the G4MP2 results for the
3k diastereomers, namely MAEs of 3.5 and 2.8 kcal/mol,
respectively.
Out of all the 10k diastereomers, the 1k-∆G4MP2
B3LYP model
predicts 6-oxabicyclooctan-7-one, which is caprolactone
with a methyl bridge between positions 1, and 5. with an
estimated atomization enthalpy H of -1933.5 kcal/mol, to
be the most stable isomer at ambient conditions. A validating G4MP2 calculation yielded the same number. 5
shows this molecule along with its ten enthalpically closest isomers. These span a narrow energetic window of
9 kcal/mol, which is sparse in comparison to the aforementioned 100 molecules/kcal/mol energy density. The
six isomers for which ∆H < 6 kcal/mol correspond to
diastereomers of oxabicyclo[2.2.1]heptan-3-one, methylated at 1,4,5,5,6,7 positions, respectively.
(∆H = 4.3 kcal/mol) and 4 (∆H = 4.5 kcal/mol) differ only by the chirality of the carbon atom at position
1. The next four high-lying isomers, although populating only a narrow ∆H range of 7–9 kcal/mol, exhibit
very diverse chemical structures:
They include a cyclopentane fused with γ-valerolactone, a methyl, ethylsubstituted furanone, a methylated cyclo hexanedione,
and a cyclopentane fused with β−propiolactone and
methylated bridge atom framework. After identiﬁcation
of these isomers, we calculated validating G4MP2 enthalpies (5). The 1k-∆G4MP2
B3LYP ML model estimates the
isomerization enthalpy of these products with a maximal
error of 0.6 kcal/mol for product 10. The ML-model predictions agree with G4MP2 results calculated a posteriori
, and never exceed the threshold of chemical accuracy (1
kcal/mol).
For comparison, 5 also features estimates obtained
from the DFT baseline method B3LYP, which is popular among many computational as well as experimental
chemists. While B3LYP would have predicted the same
global minimum, its reaction enthalpies can deviate substantially, and, sometimes fail spectacularly (isomer 8).
It is interesting to note that the ML-model is apparently
capable to reduce or increase the estimate depending on
its baseline overshooting (isomers 1-6) or underestimating (isomers 7-9). Only in the case of isomer 10, use of the
ML-model would deteriorate the baseline’s prediction error, albeit only from 0.3 to 0.5 kcal/mol. We believe that
such overall agreement of predicted reaction enthalpies
with G4MP2 results obtained a posteriori strongly indicates that the ∆-ML Ansatz is capable to account for
subtle errors made in the prediction of competitive chemical bonding— at the baseline’s computational cost (in
this case DFT).
Interpretation of the ∆-Model:
One can understand the trained corrections as follows:
The ∆CCSD(T)
ML model of atomization energies can be
viewed as a ML model of the correlation energy of atomization. Likewise, when using atomization energies as
baseline properties for free energies, and enthalpies, the
diﬀerence in the resulting ML models cancels the baseline energy and corresponds, after division by T, to the
entropy of atomization
Using a random 1k subset of the 6k C7H10O2 isomers,
we have trained two ML models, one on S of atomization at G4MP2 level of theory, taken as (H −G)/T from
Ref. 27, the other on Ec at CCSD(T) level of theory,
also from Ref. 27. Computationally eﬃcient PM7 equilibrium geometries have been used for training, testing,
and predictions.
We have reapplied the resulting 1k models to screen
the aforementioned 10k diastereomers for those molecular pairs which exhibit maximal isomerization entropies
∆S and correlation energies ∆Ec.
Structures of the
molecules with extreme S and Ec are shown in 6. The
molecular pair with maximal ∆S is consistent with
chemical intuition:
The lowest entropy isomer, 2,5dioxatricyclononane, has a cage-like structure and is very
compact, bearing some resemblance to adamantane, and
void of any conformational degree of freedom. By contrast, the molecule with largest entropy, 5-methoxyhex-
3-ynal, possesses multiple conformational degrees of freedom, made possible through the occurrence of a double
and a triple bond that consume the valences otherwise
accessible for ring or cage formation. The resulting ∆S
estimated by the ML model deviates from the reference
G4MP2 value by only 1 cal/mol/K. Quantitative rationalization of the trend in Ec is less obvious, owing to its
origin in electronic many-body eﬀects. However, Ec can
be intuitively related to the number of interacting electron pairs. This number is small when the molecule is
long since according to the nearsightedness principle ,
electrons localized on one end of the molecule interact less
with those from the other end. In compact molecules by
contrast, more electrons can interact, hence the number of interacting electron pairs, and consequently the
magnitude of Ec, are large. After screening of diastereomers using our Ec model we found among 10k diastereomers 6-methyl-2-oxatricycloheptan-6-ol and 5-methoxy-
2-methylpent-3-ynal to have the maximal reaction electron correlation energy, see 6. The maximal electron correlation energy diﬀerence, 24 kcal/mol, deviates from validating CCSD(T) reference results by 1 kcal/mol. Both
molecules conﬁrm intuition: The most compact molecule
with few degrees of freedom exhibits maximal correlation
while the most elongated corresponds to the least amount
of correlation energy.
In above discussion we notice that for both pairs with
maximal diﬀerence in electron correlation and in entropy, respectively, similar observations hold: Compactness/extension appears to maximize the diﬀerence in
both cases. This observation raises the question whether
S, which arises from the vibrational partition function,
and Ec, due to electronic many-body eﬀects, are interdependent.
An underlying relationship could aid not
only in pin-pointing molecules that pose interesting challenges for benchmarking approximate electronic theories
but might even lead to semi-quantitative estimations of
Ec via S. Thermal molecular properties, such as heatcapacities, could be linked directly to their electronic
structure.
To elucidate their potential relationship, 7
shows a scatter plot of the model-predicted atomization entropy and correlation energies of the 10k diastereomers, as well as the 6k parent isomers of C7H10O2. Albeit hardly quantitative, a qualitative interdependence
is revealed, suggesting a molecular analogue to phononelectron coupling phenomena in solids.
Such a dependency might serve the construction of
rough structure property relationships for the ﬁltering
of compounds using one property as a mutual descriptor for the other. Furthermore, this relationship could
possibly impose severe constraints on how freely S and
Ec can be varied independently within multi-objective
property optimization procedures in chemical compound
space. To further illustrate this point, 7 also highlights
corresponding Pareto fronts.
Note, for example, that
while 6 displays the pairs that maximize the vertical (Ec)
or horizontal (S) axis in 7, the molecular pair that simultaneously maximizes both diﬀers. Other molecules, such
as bullvalene, also happen to fall onto the same linear
relationship. However, for organic molecules with very
diﬀerent sizes, taken from the 134k GDB-9 dataset, this
linear trend breaks down. As such, it might still require
normalization by number of atoms or electrons to hold
in general.
We ﬁnally note that arriving at these observations
exclusively via high-throughput ab initio computations
would have required N 7
e -scaling G4MP2 calculations for
all the 10k diastereomers with an estimated need for compute time of ∼20 CPU years.
The PM7 baseline predictions, by contrast, required only ∼1 CPU day for all
geometry relaxations, and the remaining deviation from
target properties G4MP2-S and CCSD(T)-Ec is given
instantaneously by the ML correction.
Thermochemistry for 134 kilo organic molecules
When dealing with hundreds of thousands of molecules
one typically assumes that it is not necessary to achieve
chemical accuracy for all of them. Instead, hierarchical
procedures where less accurate but computationally more
eﬃcient methods, such as DFT, ﬁlter out the most relevant compounds which subsequently can be studied using more accurate and computationally more demanding
methods, such as G4MP2. DFT calculations, however,
are ordinarily too expensive to be used for ﬁltering hundreds of thousands of molecules. We have investigated
whether the ∆-approach can be used for DFT-quality
ﬁltering at the computational cost of a semi-empirical
quantum chemistry calculation.
Speciﬁcally, based on
PM7 baselines we have predicted DFT targetline enthalpies and entropies of atomization. To more systematically assess transferability, we have trained a 1k and
10k training set drawn at random from the nearly 134k
organic molecules containing up to nine C, N, O, or F
atoms (published as GDB-9 in Ref. 27). For subsequent
validation, we have used the remaining 133k and 124k
molecules, respectively.
On average, PM7 enthalpies of atomization deviate
from B3LYP by 7.2 kcal/mol.
For a randomly drawn
training set of 1k molecules, 1k-∆B3LYP
-ML predicts
B3LYP enthalpies of the 133k additional (out-of-sample)
molecules with an MAE of 4.8 kcal/mol. Increasing the
number of training molecules to 10k leads to an improved
MAE of 3.0 kcal/mol, as measured for the remaining 124k
out-of-sample molecules. We note that such a predictive
accuracy places the 10k-∆B3LYP
-ML model on par with
generalized gradient approximated (GGA) or even hybrid DFT —at the computational cost of PM7. 8
features the corresponding scatter plot of actual versus
predicted B3LYP enthalpies of atomization. The lower
right inset shows that the baseline’s systematic underestimation, as well as its skew, has been removed already
by the 1k-∆B3LYP
-ML model. The error distribution contracts further as the training set size is increased to 10k.
The upper left inset scatter plot illustrates the importance of having a baseline, the pure ML contribution being far from perfect correlation. The molecular structure
on is the most extreme outlier, PM7 underestimates its
stability by 86.0 kcal/mol. Encouragingly, 1k and 10k-
-ML models reduce the error for this outlier to
73.9 and 58.0 kcal/mol, respectively.
We have also analyzed the eﬀect of molecular geometry. It is well known that the faithfulness of common
quantum chemical methods can alter drastically when
changing the geometry of the molecule. Stretching chemical bonds, for instance, can lead to severe errors, even
for methods that predict the energy minimum perfectly
well. To systematically assess the eﬀect of geometry, we
compare the predicted B3LYP atomization enthalpies for
PM7 and 10k-∆B3LYP
for all 134k molecules, as a function of their normalized principal moments of inertia. 9
displays the resulting deviation from B3LYP, spanned
by molecular geometry (rod, disk, or sphere-like). While
PM7 has particularly strong deviations (∼20 kcal/mol)
on the linear to planar edge, as well as close to the lower
part of the linear to spherical edge, use of the ML correction homogeneously quenches the error throughout the
triangle into the 5 kcal/mol error window, with very few
20 kcal/mol outliers persisting on the rod-disk edge. Note
that due to the non-uniqueness of the moments of inertia, error heatmaps in 9 of many molecules superimpose each other in increasing order. To avoid possible
mis-interpretations, the inset with a heat-map of data
density provides a means to visually normalize the error
Regarding the computational speed-up, we note that
on a typical CPU, a single ∆B3LYP
-ML evaluation requires no more than 10 seconds for the largest molecule
Thus, screening of the entire set of 134k
molecules has consumed less than 2 CPU weeks.
contrast, the average computational cost for obtaining a
B3LYP atomization enthalpy amounts to roughly 1 CPU
hour per molecule, implying 15 CPU years for DFT based
screening of the 134k molecules.
Conclusions
We have introduced a composite quantum chemistry/machine learning approach.
It combines approximate but fast legacy quantum chemical approximations with modern big data-based machine learning estimates trained on expensive and accurate reference results throughout chemical space. We have shown that the
∆-ML model can be used to study other, out-of-sample
molecules, not part of training. Eﬀectively one can reach
the accuracy of high-level quantum chemistry at a dramatically lower computational burden which is dominated by the employed baseline method, such as semiempirical quantum-chemistry (PM7), HF, or DFT. Mere
reparameterization of the baseline method’s global parameters for a given training set does not suﬃce, yielding
measurable advantage only for very small and selected
training and test sets. Alternative molecular representations, however, could still lead to faster convergence to
chemical accuracy. Similar learning rates with respect to
training set size among all model-combinations, merely
diﬀering by oﬀ-set, suggest that even very approximate
and computationally inexpensive baseline models can be
used, provided access to suﬃciently large training sets.
For chemically diverse sets of organic molecules we have
presented numerical evidence that chemically accurate
molecular thermochemistry predictions can be made at
a computational cost reduced by several orders of magnitude when compared to the reference method for new
out-of-sample molecules.
For the most stable isomer in the set of 10k diastereomers generated from all 6k molecules with C7H10O2 stoichiometry in GDB-17 , we have demonstrated how
to identify the ten most competitive reaction isomers.
For the same diastereomers we also identiﬁed a qualitative dependency between entropy and correlation energy of atomization, suggesting a molecular equivalent
of electron-phonon coupling. Finally, we have presented
evidence for the transferability of the ∆-ML model by
reducing the error of semi-empirical quantum chemistry
method from 7.2 kcal/mol to the error of generalized
gradient approximated (∼5 kcal/mol) or hybrid density
functional theory (∼3 kcal/mol) for over hundred thousand organic molecules using less than 1 and 10% of them
for training, respectively.
We believe the high predictive accuracy to be due
to the fact that approximate theories already capture
the most important contributions to chemical energetics. The remaining deviations from the reference results
are typically smaller, possibly also smoother, and prove
to be more amenable to statistically trained ML models. Overall, our results suggest that the ∆-ML-model
represents an attractive strategy for augmenting legacy
quantum chemistry with modern big data driven ML
models. For future studies, this strategy might also oﬀer
substantial improvements to predictive accuracy of other
properties such as heat capacities, non-adiabatic energy
corrections, barriers of elementary reaction steps, optical
properties, atomic forces for molecular dynamics calculations, molecule speciﬁc parameters for semi-empirical
theories, or electronic excitations.
Molecular datasets
We have considered four sets of organic molecules. The
ﬁrst set has been used for preliminary testing of the
Ansatz, and consists of the 7211 (7k) organic molecules
and HOMO/LUMO eigenvalues and molecular polarizabilities at diﬀerent levels of theory as published in
Ref. 34. The second set contains 133885 (134k) molecules
with up to 9 heavy atoms (C, O, N, F, not counting H)
in the universe of small organic molecules “GDB” for
which we calculated and published semi-empirical (PM7)
and density functional theory (B3LYP)-based thermochemical properties such as enthalpies and entropies of
atomization . The diversity of this set is shown in
We note at this point that in ∆-ML models other
baseline methods, such as extended H¨uckel, tight-binding
DFT , OM2 , or AM05 could have been used
just as well.
The third set corresponds to a subset of
the second set: For 6095 (6k) constitutional isomers of
C7H10O2 we calculated the same thermochemical properties at signiﬁcantly more sophisticated and computationally demanding level of theory, widely considered to be
of “chemical accuracy” (∼1 kcal/mol). Also this set has
been published in Ref. 27. Finally, the versatility of this
method is assessed for a fourth set of molecules, consisting of 9868 (10k) stable diastereomers that are not part
of the GDB universe, and have been obtained by inverting all atomic stereocenters in the aforementioned third
set of 6k C7H10O2-isomers. This dataset is a part of this
publication, and is available on the authors’ homepage.
Computational details
From Ref. 35, we obtained all SMILES strings
for molecules with up to nine heavy atoms.
excluded cations, anions, and molecules containing S,
Br, Cl, or I, arriving at 133885 molecules.
is presented and analyzed in more depth in Ref. 27.
Cartesian coordinates for the subset of 6095 isomers of
C7H10O2 were determined by parsing the corresponding
SMILES strings using Openbabel software , followed
by a consistency check using the CORINA code .
Structures of 9868 non-enantiomeric stable diastereomers
were obtained through inversions of chiral C atoms in
the SMILES strings followed by conversion to Cartesian coordinates using CORINA. To verify that all theoretical methods preserved topology and chirality, we
transformed the Cartesian coordinates back to SMILES,
and InChI strings using Openbabel.
Using these initial structures, we carried out geometry relaxations
at the PM7 semi-empirical level of theory using
MOPAC .
We used the PM7 equilibrium coordinates as initial geometries and performed DFT and
G4MP2 geometry calculations using Gaussian09 . For
DFT calculations, we employed the Gaussian basis set 6-
31G(2df,p) which is also used in the G4MP2 calculations
in combination with the DFT method B3LYP , for
geometry relaxation and frequency computations.
used the same basis set also in the GGA-PBE calculations. G4MP2 employs harmonic oscillator and rigid
rotor approximations to estimate the entropy of nuclear
degrees of freedom . At all levels of theory, we performed harmonic vibrational analysis for all molecules to
conﬁrm that the predicted equilibrium structures were
local minima on the potential energy surface. HF, MP2,
CCSD, CCSD(T) energies have been computed with the
basis set 6-31G(d) as a part of G4MP2. Further technical
details regarding all quantum chemistry data, including
convergence thresholds employed, are given in Ref. 27.
ACKNOWLEDGEMENT
The authors thank J.-L. Reymond for discussions
and GDB SMILES, J. Stewart and C. H. Schwab
for providing trial licenses for the packages MOPAC
and Corina, respectively.
A. De Vita, K-R. M¨uller,
A. Tkatchenko, and P. W. Ayers are acknowledged
for discussions.
Most calculations were performed at
sciCORE ( scientiﬁc computing core facility at University of Basel.
This research also used resources of the Argonne Leadership
Computing Facility at Argonne National Laboratory,
which is supported by the Oﬃce of Science of the U.S.
DOE under contract DE-AC02-06CH11357. This work
was funded by the Swiss National Science foundation
(No. PP00P2 138932).
 Kirkpatrick P, Ellis C Chemical space. Nature,
 Virshup A. M, Contreras-Garc´ıa J, Wipf P, Yang
W, Beratan D. N Stochastic voyages into uncharted chemical space produce a representative library
of all possible drug-like compounds. J. Am. Chem. Soc.,
135(19):7296–7303.
 von Lilienfeld O. A First principles view on
chemical compound space: Gaining rigorous atomistic
control of molecular properties. Int. J. Quant. Chem.,
113(12):1676–1689.
 Ellman J, Stoddard B, Wells J Combinatorial
thinking in chemistry and biology. Proc. Natl. Acad. Sci.
USA, 94(7):2779–2782.
 Kolb H. C, Finn M. G, Sharpless K. B Click chemistry: Diverse chemical function from a few good reactions. Angew. Chem. Int. Ed., 40:2004–2021.
 Norskov J. K, Bligaard T, Rossmeisl J, Christensen C. H
 Towards the computational design of solid catalysts. Nature Chemistry, 1:37.
 Jorgensen W. L The many roles of computation
in drug discovery. Science, 1:37.
 Kutchukian P. S, Shakhnovich E. I De novo design: balancing novelty and conﬁned chemical space. Expert Opin Drug Discov., 5:789 – 812.
 Hachmann J, et al. The Harvard clean energy
project: Large-scale computational screening and design
of organic photovoltaics on the world community grid. J.
Phys. Chem. Lett., 2:2241–2251.
 Jain A, Ong S. P, Hautieri G, Chen W, Richards W.
D, Dacek S, Cholia S, Gunter D, Skinner D, Ceder G,
Persson K. A The materials project: A materials
genome approach to accelerating materials innovation.
APL Mat., 1(1):011002.
 Yang L, Ceder G Data-mined similarity function
between material compositions. Phys. Rev. B, 88:224107.
 Kuhn C, Beratan D, N Inverse strategies for
molecular design. J. Phys. Chem., 100:10595–10599.
 Franceschetti A, Zunger A The inverse bandstructure problem of ﬁnding an atomic conﬁguration with
given electronic properties. Nature, 402:60.
 von Lilienfeld O. A, Lins R, Rothlisberger U. Variational
particle number approach for rational compound design.
Phys. Rev. Lett., 95:153002.
 Wang M, Hu X, Beratan D. N, Yang W Designing
molecules by optimizing potentials. J. Am. Chem. Soc.,
 Schneider G Virtual screening: an endless staircase? Nature Reviews, 9:273.
 Sarathy S. M, Vranckx S, Yasunaga K, Mehl M, Osswald P, Metcalfe W. K, Westbrook C. K, Pitz W. J,
Kohse-H¨oinghaus K, Fernandes R. X, Curran H. J 
A comprehensive chemical kinetic combustion model
for the four butanol isomers. Combustion and Flame,
159(6):2028 – 2055.
 Merchant S. S, Zanoelo E. F, Speth R. L, Harper M. R,
Van Geem K. M, Green W. H. Combustion and pyrolysis of iso-butanol: Experimental and chemical kinetic
modeling study. Combustion and Flame, 160(10):1907 –
 Tsang W, Hampson R. F Chemical kinetic data
base for combustion chemistry. part i. methane and related compounds. J. Phys. Chem. Ref. Data, 15(3):1087–
 Duley W. W, Williams D. A Interstellar chemistry. Academic Press.
 Friesner R. A Ab initio quantum chemistry:
methodology and applications. Proc. Natl. Acad. Sci.
USA, 102(19):6648–6653.
 Pople J A, Head-Gordon M, Fox D. J, Raghavachari K,
Curtiss L. A Gaussian-1 theory: A general procedure for prediction of molecular energies. J. Chem. Phys.,
90:5622–5629.
 Curtiss L. A, Raghavachari K, Trucks G. W, Pople J. A
 Gaussian-2 theory for molecular energies of ﬁrstand second-row compounds. J. Chem. Phys., 94:7221–
 Curtiss L. A, Redfern P. C, Raghavachari K 
Gaussian-4 theory. J. Chem. Phys., 126:084108.
 Curtiss L. A, Redfern P. C, Raghavachari K 
Gaussian-4 theory using reduced order perturbation theory. J. Chem. Phys., 127:124105.
 Szabo A, Ostlund N. S Modern Quantum Chemistry: Introduction to Advanced Electronic Structure Theory. Dover.
 Ramakrishnan R, Dral P. O, Rupp M, von Lilienfeld O.
A Quantum chemistry structures and properties
of 134 kilo molecules. Scientiﬁc Data, 1:140022.
 Lomakina E. I, Balabin R. M Neural network approach to quantum-chemistry data: Accurate prediction
of density functional theory energies. J. Chem. Phys.,
131:074104.
 LiHong H, Wang X, Wong L, Chen G Combined ﬁrst-principles calculation and neural-network correction approach for heat of formation. J. Chem. Phys.,
119(22):11501.
 Gillan M. J, Alf`e D, Bart´ok A. P, Cs´anyi G. Firstprinciples energetics of water clusters and ice: A manybody analysis. J. Chem. Phys., 139:244504.
 Hastie T, Tibshirani R, Friedman J The Elements
of Statistical Learning. Data Mining, Inference, and Prediction. Springer, New York, 2 edition.
 Rupp M, Tkatchenko A, M¨uller K.-R, von Lilienfeld O.
A Fast and accurate modeling of molecular atomization energies with machine learning. Phys. Rev. Lett.,
108:058301.
 Hansen K, Montavon G, Biegler F, Fazli S, Rupp M,
Scheﬄer M, von Lilienfeld O. A, Tkatchenko A, M¨uller
K.-R Assessment and validation of machine learning methods for predicting molecular atomization energies. J. Chem. Theor. Comput., 9(8):3404–3419.
 Montavon G, Rupp M, Gobre V, Vazquez-Mayagoitia A,
Hansen K, Tkatchenko A, M¨uller K.-R., von Lilienfeld
O. A 
Machine learning of molecular electronic
properties in chemical compound space. New J. Phys.,
15(9):095003–095020.
 Ruddigkeit L, van Deursen R, Blum L. C, Reymond
J.-L Enumeration of 166 billion organic small
molecules in the chemical universe database gdb-17. J.
Chem. Inf. Model., 52:2684.
 Cohen A. J, Mori-S´anchez P, Yang W Challenges for density functional theory. Chemical Reviews,
112(1):289–320.
 Weber W, Thiel W Orthogonalization corrections for semiempirical methods. Theor. Chim. Acta,
103(6):495–506.
 Hansen K, Biegler F, von Lilienfeld O. A, M¨uller K.-R,
Tkatchenko A Interaction Potentials in Molecules
and Non-Local Information in Chemical Space. submitted.
 Wang L-P, Titov A, McGibbon R, Liu F, Pande V. S,
Mart´ınez T. J Discovering chemistry with an ab
initio nanoreactor. Nature Chemistry, 6:1044–1048.
 Prodan E, Kohn W Nearsightedness of electronic
matter. PNAS, 102:11635–11638.
 Koch W, Holthausen M. C A Chemist’s Guide to
Density Functional Theory. Wiley-VCH.
 Elstner M, Porezag D, Jungnickel G, Elsner J, Haugk M,
Frauenheim Th, Suhai S, Seifert G Self-consistentcharge density-functional tight-binding method for simulations of complex materials properties. Phys. Rev. B,
58:7260–7268.
 Armiento R, Mattsson A. E Functional designed
to include surface eﬀects in self-consistent density functional theory. Phys. Rev. B, 72:085108.
 Weininger D SMILES, a chemical language and
information system. 1.Introduction to methodology and
encoding rules. J. Chem. Inf. Comp. Sci., 28(1):31–36.
 O’Boyle N. M, Banck M, James C. A, Morley C, Vandermeersch T, Hutchison G. R Open babel: An open
chemical toolbox. J. Cheminf., 3:33.
 Sadowski J, Gasteiger J From atoms and bonds
to 3-dimensional atomic coordinates - automatic model
builders. Chem. Rev., 93:2567–2581.
 Stewart J. J. P Optimization of parameters for
semiempirical methods vi:
more modiﬁcations to the
nddo approximations and re-optimization of parameters.
J. Mol. Modeling, 19:1.
 Stewart J. J. P MOPAC2012, Version 13.136L,
Stewart Computational Chemistry, Colorado Springs,
CO, U.S.A.
 Frisch M. J et al. Gaussian 09, Revision d.01,
Gaussian, Inc., Wallingford CT, U.S.A.
 Stevens P. J, Devlin F. J, Chabalowski C. F, Frisch M.
J Ab initio calculation of vibrational absorption
and circular dichroism spectra using density functional
force ﬁelds. J. Phys. Chem., 98:11623–11627.
 Perdew J. P, Burke K, Ernzerhof M Generalized
gradient approximation made simple. Phys. Rev. Lett.,
Calculated reaction enthalpies at 298.15 K between the most stable molecule with C7H10O2 stoichiometry , and its ten energetically closest isomers in increasing
order, according to targetline method G4MP2 calculated a posteriori (black). 1k ∆G4MP2
B3LYP ML model predictions are given in
blue. Baseline method B3LYP predictions are shown for comparison (red).
MS = 32 cal/mol/K
(31 cal/mol/K)
MEc = 24 kcal/mol
(23 kcal/mol)
Molecular pairs with maximal reaction entropy (top)
and electron correlation energy (bottom) out of the 10k stable
diastereomers of C7H10O2.
Reaction properties have been
estimated using a 1k-∆G4MP2
B3LYP -ML model for the entropy and
a 1k-∆CCSD(T)
-ML model for the correlation energy (black).
Corresponding reference values calculated for validation are
given in parentheses (blue).
Ec [kcal/mol]
S [cal/mol/K]
Scatter plot of ML-model predicted entropy of atomization at T = 298.15 K versus ML-model predicted electron
correlation contribution to atomization energy for the 16k stable out-of-sample diastereomers of C7H10O2. All predictions
are made using ML models trained on 1k molecules randomly
drawn from set of 6k parent isomers. Training data is shown
in red. Linear regression yields Ec ≈0.445 × TS −175.211
[kcal/mol]. Pareto fronts are indicated by convex hull shown
D [kcal/mol]
Scatter plot of predicted atomization enthalpies H
at 298.15 K for 124k out-of-sample GDB-9 molecules . Estimated H is plotted for PM7 (yellow, MAE = 7.2 kcal/mol)
and 1k (blue) and 10k (red) ∆B3LYP
-ML models (MAE=4.8
and 3.0 kcal/mol, respectively) versus reference B3LYP values. The left side inset shows the ML contribution to the estimated energy diﬀerences between PM7 and reference B3LYP
enthalpies, ∆est, for 1k (blue) and 10k (red) models versus reference diﬀerence, ∆ref. The right side inset shows the error
distribution around B3LYP enthalpies for PM7, 1k, and 10k
models, respectively. The most extreme outlier (top, right),
7-amino-3-oxatricycloheptan-4-one, has error 86, 74, and 58
kcal/mol for PM7, 1k, and 10k models, respectively.
Shape distribution of color-coded absolute deviations between predicted and B3LYP reference atomization enthalpies
of the 134k organic molecules with up to nine atoms (not counting hydrogens) in the GDB-17 data set . Vertical and
horizontal axes correspond to normalized principal moments of inertia I1/I3 and I2/I3, respectively, with I1 ≤I2 ≤I3. (a)
Large PM7 errors (> 25 kcal/mol) are predominantly present for geometries on the rod-disk edge, and in the center of the
triangle. Corners indicate the geometrical shape of molecules with molecular drawings corresponding to examples of linear
(I1 = 0, I2 = I3), planar (2I1 = 2I2 = I3), and spherical (I1 = I2 = I3) cases. (b) 10k-∆B3LYP
-ML errors are systematically
smaller, some outliers at the rod-disk edge persist. A heatmap of the molecular data density is shown for the same coordinate
system in the inset below (b).