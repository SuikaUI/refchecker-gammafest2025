TRANSFORMATIONS AND SEASONAL ADJUSTMENT
By Tommaso Proietti and Marco Riani
Universita` di Roma Tor Vergata and Universita` di Parma
First Version received June 2007
Abstract. We address the problem of seasonal adjustment of a nonlinear transformation of the original time series, measured on a ratio scale, which aims at enforcing two
essential features: additivity and orthogonality of the components. The posterior mean
and variance of the seasonally adjusted series admit an analytic ﬁnite representation only
for particular values of the transformation parameter, e.g. for a fractional Box–Cox
transformation parameter. Even if available, the analytical derivation can be tedious and
diﬃcult. As an alternative we propose to compute the two conditional moments of the
seasonally adjusted series by means of numerical and Monte Carlo integration. The former
is both fast and reliable in univariate applications. The latter uses the algorithm known as
the simulation smoother and it is most useful in multivariate applications. We present
two case studies dealing with robust seasonal adjustment under the square root and
the fourth root transformation. Our overall conclusion is that robust seasonal adjustment under transformations is feasible from the computational standpoint and that the
possibility of transforming the scale ought to be considered as a further option for
improving the quality of seasonal adjustment.
Keywords. Structural time series models; Box–Cox transformation; simulation smoother;
forward search; numerical integration.
1. INTRODUCTION
The linear Gaussian model plays a central role in statistics; it is well understood and
its features depend on the (conditional) ﬁrst and second moments. Transformations
aim at establishing a scale, diﬀerent from the original measurements, for which the
linear Gaussian model holds. For variables measured on a ratio scale with a strictly
positive support, Tukey proposed the power transformation to achieve
a model with a simple structure, normal errors and constant error variance; this
was later modiﬁed by Box and Cox and incorporated into the model
building process, so as to become what is commonly referred to as the Box–Cox
transformation. Since then, transformations have become a key element in
regression analysis . Several
modiﬁcations have been proposed to deal with negative observations and to extend
the support to the transformed observation over the entire real interval .
This article deals with the seasonal adjustment of univariate time series under a
parametric nonlinear transformation of the original scale that depends on a single
0143-9782/09/01 47–69
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd., 9600 Garsington Road, Oxford OX4 2DQ, UK
and 350 Main Street, Malden, MA 02148, USA.
doi:10.1111/j.1467-9892.2008.00600.x
parameter. In particular, we concentrate on the Box–Cox power transformation
for positive time series. Nevertheless, our approach is immediately generalizable
to other parametric transformations that are continuous and invertible, and to
multivariate time series as well. The contribution of this article is twofold: ﬁrst, we
propose a novel implementation of the forward search technique aiming at the robust estimation of the transformation parameter;
secondly, conditional on the latter, we provide a general model-based solution to
the problem of estimating the seasonally adjusted series in the original scale.
Seasonal adjustment rests upon two basic pillars: additivity and orthogonality of
the seasonal and nonseasonal components. This point is made strongly by Bell
and Hillmer , who state that someone who does not want to make
these assumptions is working on a diﬀerent problem. This article focuses on the
situation when the two previous requirements are fulﬁlled on a scale other than
the original scale of measurement and provides a model-based solution to the
adjustment problem. The seasonal eﬀects are deﬁned in terms of deviations from
the underlying level component, so that their average over a yearly span has zero
expectation (this feature will be referred to as the seasonal balance constraint). Our
linear Gaussian workhorse model is an unobserved components model known as
the basic structural model . This speciﬁcation is successfully ﬁtted to
a wide class of economic time series, the same for which the another very popular
model in the analysis of seasonal series, the airline model, is appropriate ; furthermore, it is robust to mis-speciﬁcation of the nonseasonal
part of the model. For instance, Riani shows that, in most cases, the
estimate of the seasonal component inside the basic structural model is virtually
unaﬀected by the omission of a stochastic cycle.
Current seasonal adjustment practice does not fully take into account
the problem of seasonal adjustment under transformation; only the seasonal
adjustment programme of Bell Laboratories (SABL), documented by Cleveland
et al. , performs the selection of a preliminary power transformation
parameter that minimizes the covariance between the level and the seasonal
components. The issue of transforming the seasonally adjusted estimates on the
original scale is not addressed explicitly. Both X-12-ARIMA 
and Tramo-Seats consider the multiplicative and the
additive decompositions of the original series and have in-built procedures to
select between them. In the multiplicative case, they produce seasonally adjusted
series in the original scale. The X-12-ARIMA program allows for the estimation
of an autoregressive integrated moving-average (ARIMA) model with regression
eﬀects under the Box–Cox and the logistic transformation, but with the speciﬁc
purpose of obtaining forecast and backcast extensions by the naı¨ve method, i.e. by
simple inversion of the extrapolations made on the transformed scale.
The question has to be raised as to why the transformation problem has not
received suﬃcient recognition in the current seasonal adjustment practice. We can
envisage three arguments: the ﬁrst deals with the seasonal balance constraint, by
which the expectation of the sum of the seasonal component over a calendar year
is zero. According to a well-established view, the constraint should be enforced on
T. PROIETTI AND M. RIANI
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
the original measurement scale; to put it diﬀerently, the seasonally adjusted
series should have the same expectation (average) as the original series over 12
consecutive monthly observations. This view is held strong by statistical agencies;
it is also at the root of the treatment of the problem of seasonal adjustment under
transformations by Thomson and Ozaki , who propose ad hoc solutions
with the speciﬁc intent of enforcing the seasonal balance constraint on the original
A second argument deals with contemporaneous aggregation: the seasonally
adjusted aggregate should be equal to the aggregated sum of the seasonally
adjusted sub-series. The consistency in aggregation requires that the series are
not transformed as a necessary (though not suﬃcient) condition, and thus
would not hold for the Box–Cox transformation. A third argument concerns the
diﬃculties and the computational burden linked with the detection of inﬂuential
observations and/or of the outliers on the transformed scales.
None of these arguments is compelling. Multiplicative adjustment, which is
used frequently for economic time series already incorporates a diﬀerent seasonal
balance constraint, which refers to the geometric average, rather than the
arithmetic. The view taken in this article is that the stochastic seasonal balance
constraint needs to hold only on the transformed scale. The transformation
parameter uniquely deﬁnes what type of seasonal balance constraint is enforced
on the original scale; roughly speaking, if the power transformation parameter is 1,
then the balance constraint is additive; if the transformation parameter is equal to
0, it is multiplicative; if the transformation parameter is equal to 1, the seasonal
balance constraint is deﬁned on the reciprocal of the series (which corresponds to
the harmonic average). Secondly, the conditions for consistency in cross-sectional
aggregation are so stringent that the indirect seasonal adjustment of an aggregate
is not very often used in practice. In brief, consistency in aggregation requires that
the adjustment is performed additively on the original scale using exactly the same
ﬁlter. As pointed out by one of the referees, a notable example is US
unemployment, which is adjusted indirectly from eight components. As far as
the third argument is concerned, in this article we show how it is possible to
robustly estimate the transformation parameter and at the same way to evaluate
the eﬀect that the diﬀerent seasons exert on this estimate. In general, prior outlier
detection is performed on the original scale before estimating the transformation
parameter. It is clear, however, that observations which seem atypical on the
original scale may ﬁt completely inside the bulk of the data once the observations
have been transformed.
The article is structured as follows: section 2 recalls the basic structural model
for the Box–Cox transformed data. Section 3 deals with the robust estimation of
the transformation parameter, through the use of the forward search algorithm.
The evaluation of the posterior mean and variance of the nonseasonal component
is considered in section 4. The availability of closed-form solutions is investigated
and approximate solutions reviewed. A more general approach is to evaluate
the conditional moments by numerical and Monte Carlo integration using the
simulation smoother . In section 5 the alternative
TRANSFORMATIONS AND SEASONAL ADJUSTMENT
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
estimation methods are applied to a well-known case study concerning the sales of
an engineering company , which calls for the fourth
root transformation, and the Italian industrial production index for leather
and shoes, for which the square root transformation is appropriate. The
assessment of the diﬀerent methods leads to the conclusion that numerical
integration is both fast and reliable in univariate applications. We draw our
conclusions in section 6.
2. THE BASIC STRUCTURAL MODEL UNDER TRANSFORMATIONS
The parametric linear and Gaussian model that we employ for the adjustment is the
basic structural model . The BSM postulates an
additive and orthogonal decomposition of a time series into unobserved
components representing the trend, seasonality and the irregular component.
We assume that the BSM holds for a transformation ut(k) of the original time
series yt, depending on a single transformation parameter k. An important case is
the Box–Cox (BC) transformation:
see Box and Cox . The above transformation is suitable for series measured
on a ratio scale, which take only strictly positive values.
The BSM for the transformed series is formulated as follows:
utðkÞ ¼ lt þ ct þ
dkxkt þ t;
t ¼ 1; . . . ; T;
where lt is the trend component, ct is the seasonal component, the xkt values are
appropriate regressors that account for calendar eﬀects, namely trading days,
moving festivals (Easter) and the length of the month, and t is a normally and
independently distributed irregular component with zero mean and variance
; t  n.i.d: ð0; r2
The trend component has a local linear representation . The
seasonal component can be modelled using a trigonometric representation, such
that the seasonal eﬀect at time t arises from the combination of a set of stochastic
cycles whose common variance is r2
x. Alternatively, it is possible to use the
so-called Harrison and Stevens (HS) speciﬁcation which is formulated directly
in terms of the eﬀect of a particular season, thereby enhancing ﬂexibility needed
heteroscedasticity.
comparison
representations of a seasonal component and a discussion of the implications
for forecasting, see Proietti . One of the purposes of this article is to check
how the presence of seasonal heteroscedasticity may aﬀect the estimate of the
transformation parameter.
T. PROIETTI AND M. RIANI
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
Given the value of the transformation parameter (its estimation will be
dealt with in the next section), the BSM can be cast in state–space form. The
Kalman ﬁlter enables the evaluation of the likelihood via the prediction error
decomposition. The maximum likelihood estimates can be obtained by a quasi-
Newton algorithm, such as the Broyden–Fletcher–Goldfarb–Shanno (BFGS)
algorithm .
Finally, conditional on the parameter estimates, the Kalman smoother provides
the conditional expectations of the latent components, given all the available
observations, along with their conditional variance. These inferences are
employed in section 4 to produce estimates of the seasonally adjusted series on
the untransformed scale.
3. ROBUST ESTIMATION OF THE TRANSFORMATION PARAMETER AND SEASONAL
ADJUSTMENT
As far as the estimation of the transformation parameter is concerned, we can
maximise the proﬁle likelihood corrected so as to take into account the change of
scale of the observations. Equivalently, we can maximize the uncorrected loglikelihood of the normalized observations utðkÞ= Q
 .
An alternative approach, which does not require the computing of the
maximum likelihood estimate of k, is to consider the ﬁrst-order Taylor series
expansion of ut(k) about a maintained value k0 (e.g. 0 or 1): ut(k) ¼
ut(k0) þ (k  k0)wt(k0), with wt(k0) ¼ (out(k)/ok)jk¼k0.
If for some k,
utðkÞ ¼ lt þ ct þ
dkxkt þ t;
then the approximate linear model is
utðk0Þ ¼ lt þ ct þ
dkxkt þ dwtðk0Þ þ t;
with d ¼ k0  k:
The augmented model is estimated including, among the regressors, the
additional variable wt(k0). Signiﬁcant regression denotes the need for a
transformation and provides a preliminary estimate of the correct k as
^k ¼ k0  ^d. The t-test on the additional constructed variable wt(k0) is known
in the statistical literature as score test statistic for transformation .
Nevertheless, it is well known that the estimated transformation and related
test statistic may be sensitive to the presence of one, or several, atypical
observations. In addition, it is important to remark that outliers in one
transformed scale may not be atypical in another scale. Therefore, it is
important to choose a transformation which does not depend on the presence of
TRANSFORMATIONS AND SEASONAL ADJUSTMENT
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
particular observations. In this article, in order to provide a robust estimate of
the transformation parameter, we use the forward search approach in the way
suggested by Atkinson and Riani and extended to time series by Riani
The algorithm is both eﬃcient and robust. It is eﬃcient, because it makes use of
the Gaussian likelihood machinery underlying the Kalman ﬁlter. It is robust,
because the outliers enter in the last steps of the procedure and their eﬀect on the
statistics of interest can be clearly traced. More generally, this approach allows
evaluation of the inferential eﬀect that each time period, either outlying or not,
exerts on the ﬁtted model.
One major advantage of the forward search over other high-breakdown
techniques is that a number of diagnostic measures can be computed and monitored
as the algorithm progresses. In the particular context of transformations, we can
monitor the forward plot of the approximate score statistic for testing the
signiﬁcance of the set of constructed variables for diﬀerent values k0, using a
separate search for each k0. The trajectories of the score tests can be combined in a
single picture named the fan plot . If the number of
observations is not large (i.e. less than 200), generally the ﬁve most common values
of k0 (1,0.5,0,0.5,1) are suﬃcient for selecting the appropriate transformation.
On the other hand, when the sample size is large we have to consider a ﬁner grid of
values of k0. The monitoring of the fan plot for the diﬀerent speciﬁcations of the
seasonal component (trigonometric HS or heteroscedastic HS) inside the basic
structural model enables to appraise how robust is our estimate of the
transformation parameter to the various parameterizations of ct.
An additional novelty of this article is that we implement for the ﬁrst time in
time series the so-called proportional forward search in order to achieve balance
in observations across seasons during the search. More precisely, at each step,
among observations for the seasons least represented in the current set, we add the
observation with the smallest one-step-ahead standardized prediction residual. In
this way in each step the subset has a composition of months, which reﬂects as
much as possible the structure of the overall sample.
4. SEASONAL ADJUSTMENT AND THE BOX–COX TRANSFORMATION
Let us write eqn (2) as
utðkÞ ¼ u
t ¼ lt þ t is the seasonally adjusted series on the transformed scale, and
denote by ~u
t jFTÞ and Vt ¼ varðu
t jFTÞ the posterior mean and variance
t , respectively, Ft being the information set at time t. These inferences are
delivered by the Kalman ﬁlter and smoother applied to the relevant linear state
space model. 
T. PROIETTI AND M. RIANI
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
We deﬁne the seasonally adjusted series on the original scale as the inverse
transformation of the nonseasonal component u
t ¼ u1ðu
t Þ, where u1(Æ) is
the inverse transformation. For the Box–Cox transformation:
The estimator of the seasonally adjusted series is thus:
t jFT Þdu
whereas the conditional variance of the estimation error for the seasonally
adjusted series is deﬁned as:
t jFT Þ  ~y2
The above integrals do have a closed-form solution only in particular cases,
namely k ¼ 0, and k ¼ 1/p, p ¼ 1, 2, 3,. . ., as will be seen shortly.
Notice that the naı¨ve estimator of the SA series,
provides the median of the conditional distribution of y
t , given the observations.
The naı¨ve estimator has an interpretative advantage over eqn (3) in the case
k ¼ 0, as yt can be decomposed exactly as the product of ^yt ¼ expð~u
the exponential of the estimate of the seasonal component,
exp[E(ct þ P
xktjFT)]. Except for the linear-additive case, the minimum mean square estimator
of the seasonally adjusted series (3) cannot be combined with the minimum
mean square estimator of the seasonal component in the original scale to
provide an exact decomposition of the untransformed time series, yt. Thomson
and Ozaki propose ad hoc adjustments to the estimated components that
aim at enforcing the seasonal balance constraint in the original scale; their
proposal may be adapted to the estimators of the components proposed in
this article.
4.1. Analytical solutions
For general k, in the Appendix we prove Theorem 1.
Theorem 1.
The mean and the variance of the seasonally adjusted series in the
original scale are given by the two following expressions:
t jFT Þ ¼ ~y
k2jðtÞajðtÞ
TRANSFORMATIONS AND SEASONAL ADJUSTMENT
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
t jFT Þ¼^y2
j ðtÞajðtÞþ2
kjðtÞkjþ2rðtÞajþrðtÞ
k2jðtÞajðtÞ
ajðtÞ ¼ E ðu
transformation. Notice that for k ¼ 0 kj (t) ¼ (j!)1 and the term of eqn (6) is
simply the expansion of
exp(Vt/2). This method was proposed originally by
Neyman and Scott , who however did not consider explicitly time series
applications and did not give the exact analytical solution for k ¼ 1/p, with p an
integer. An alternative approach for expressing the time-series forecasts on the
original scale, based on Hermite polynomial expansion, was suggested by Granger
and Newbold . The expression (6) was derived by Pankratz and Dudley
 for the simple power transformation yk
t using a diﬀerent argument. For
integer p ¼ 1/k they write the inverse transformation as
wtÞ p ¼ ~up
where wt  Nð0; 1Þ:
They then consider the expansion of the binomial and take the expectation. The
expressions in square brackets in eqns (6) and (7) are the multiplicative correction
terms that have to be applied to the naı¨ve estimator of the SA series or to its
square in order to produce the conditional mean and the conditional variance in
the original scale.
An alternative expression for the variance is derived as follows. Deﬁning ^V 
the naı¨ve as estimate of the variance resulting from the application of the delta
¼ Vt^y2ð1kÞ
then we can rewrite eqn (7) as:
t jFTÞ ¼ ^V 
j ðtÞajðtÞ þ 2
kjðtÞkjþ2rðtÞajþrðtÞ
k2jðtÞajðtÞ
where kjðtÞ ¼ kjðtÞ^yk
and ajðtÞ ¼ ajðtÞ=Vt. According to expression (8), the exact
variance can be seen as the product of the naı¨ve variance resulting from the delta
method and a correction factor.
T. PROIETTI AND M. RIANI
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
k ¼ 1/p, p ¼ 1, 2,. . .,
immediately
k1(t), k2(t),. . . contains only p terms diﬀerent from zero. We give in Table I,
for the most common values of k, the exact correction factors for the mean
and the variance which must be applied to the naı¨ve estimator of the
seasonally adjusted series ^y
t in order to ﬁnd the true conditional mean and
variance in the original scale. This table clearly shows that the correction
term depends on the ratio between the variance (raised to some power) of the
SA series on the transformed scale and the value of the naı¨ve estimator (raised
to some power of k). If this is small, the correction is negligible. More
precisely, we have Corollary 1.
Corollary 1.
The correction factor for the mean which we call wlðk; ^y
satisﬁes the following properties:
(i) wlðk; ^y
t ; VtÞ  1 for k  1 and wlðk; ^y
t ; VtÞ  1 for k  1.
(ii) wlðk; ^y
t ; VtÞ ! 1 when k ! þ1 and wlðk; ^y
t ; VtÞ ! þ1 when k ! 1
t > 1. wlðk; ^y
t ; VtÞ ! 1 when k ! þ 1 and wlðk; ^y
t ; VtÞ ! 1þ when
k ! 1 if ^y
straightforward
Additional
other properties are given in a technical report by the authors .
Figure 1 shows the correction factor as a function of k for six diﬀerent
combinations of values of ^y
t and Vt. It is clear that if the correction factor is
neglected there is negative (positive) bias for k < 1(k > 1) which can be more
or less severe depending on the problem under study. The ﬁrst two left panels
show that if the ratio between the naı¨ve estimator and the value of the
variance of the SA series in the transformed scale is greater than a certain
threshold and if the estimated k is greater (smaller) than 1 and ^y
t is greater
(smaller) than 1, the correction which must be applied to the naı¨ve estimator
can be overlooked.
Exact Correction Factors which have to be Applied to the Naiv¨e Estimator of the
Seasonally Adjusted Series and of the Variance, in Order to Obtain the Conditional Mean
and the Conditional Variance in the Original Scale for the Most Important Fractional
Values of k and for k ¼ 0
Correction factor for ^y
Correction factor for ^V 
9 Vt^y2=3
32 Vt^y1=2
expðVtÞ  ðexpðVtÞ  1Þ
TRANSFORMATIONS AND SEASONAL ADJUSTMENT
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
The correction factor for the naı¨ve variance which we call wrðk; ^y
satisﬁes the following property:
(i) wrðk; ^y
t ; VtÞ ! 1þ when k ! +1 and wrðk; ^y
t ; VtÞ ! þ1 when k ! 1
t > 1. wrðk; ^y
t ; VtÞ ! 1þ when k ! 1 and wrðk; ^y
t ; VtÞ ! þ1 when
k ! þ1 if ^y
which is illustrated graphically in Figure 2.
4.2. Approximate and computational solutions
Taylor proposed an approximate correction for the case k 6¼ 0, which
amounts to neglecting higher order terms in the expansion (6):
2 ð1  kÞ Vt
This estimate is exact only for k ¼ 0.5 (see Table I).
Guerrero proposed a solution which is coincident with the exact solution
in the logarithmic case (k ¼ 0) and is approximate for k 6¼ 0. In our notation, it
can be written as follows:
Figure 1. Correction factor which must be applied to the naı¨ve estimator of the seasonally
adjusted series to obtain the conditional mean in the original scale as a function of k for
combinations
correspondence of k ¼ 0 denotes the value obtained by directly applying the formula given in Table I.
T. PROIETTI AND M. RIANI
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
2 1 þ 2kð1  kÞ Vt
For general k there are three possible ways of evaluating Eðy
t jFTÞ and
• Monte Carlo evaluation using the simulation smoother: the latter is used to
conditional
distribution
1; . . . ; u
Tg, given the available observations.
• Numerical integration with respect to the normal density, f ðu
t jFTÞ, whose
moments ~u
t are provided by the Kalman ﬁlter and smoother.
• Direct application of eqns (6) and (7) truncating the summations to a particular order.
For the Monte Carlo evaluation, we use the method of de Jong and Shephard
 . It achieves computational eﬃciency by sampling from the joint posterior
density of the disturbances in the model. An even more eﬃcient method is the
simulation smoother proposed by Durbin and Koopman .
5. ILLUSTRATIONS
In this section we propose two illustrations dealing with seasonal adjustment
under the square root transformation and k ¼ 1/4. All the computations were
Figure 2. Correction factor which must be applied to the naı¨ve estimator of the variance of the
seasonally adjusted series to obtain the conditional variance in the original scale as a function of k for
six diﬀerent combinations of ^y
t (naive) and Vt (VAR). The symbol of the square which is drawn in
correspondence of k ¼ 0 denotes the value obtained applying directly the formula given in Table I.
TRANSFORMATIONS AND SEASONAL ADJUSTMENT
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
performed using Ox 3.x by Doornik and the library of state–space function
SsfPack 2.3 by Koopman et al. . The numerical integration for eqn (8) is
implemented using the QuadPack function QAGS .
5.1. Sales X data
Our ﬁrst illustration deals with a well-known case study, concerning the monthly
sales of a engineering company (company X), from January 1965 to May 1971,
that was presented and studied by Chatﬁeld and Prothero as a case study
by using Box–Jenkins forecasting methods. The plot of the series (see the ﬁrst
panel of Figure 3) reveals that the amplitude of the seasonal pattern is increasing
over time as the trend increases, but the evidence is that the logarithmic
transformation is overtransforming the series, i.e. the amplitude decreases as the
trend increases on the transformed scale.
Original time series
Profile log−like for transf. parameter
Transformed series and estimated trend
Seasonal and calendar components of ut
Calendar component
Seasonal component
SA series (yt)
Comparison of SA series
Figure 3. Sales of Company X.
T. PROIETTI AND M. RIANI
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
In their discussion of the Chatﬁeld and Prothero paper, Box and Jenkins 
using range-mean plots suggested the value 0.25, which is also the value estimated
by Chatﬁeld and Prothero in their reply. That value is conﬁrmed by Guerrero
 , by a diﬀerent method, which looks at the variance-stabilizing properties of
the transformation.
When the BSM is estimated under the Box–Cox transformation, the proﬁle
likelihood for the parameter k is reported in the second panel of Figure 3. The
horizontal line is drawn at Lmax  0.5v2(0.95), where Lmax is the value of the
corrected proﬁle likelihood evaluated at the maximum and v2(0.95) is the 95th
percentile of the v2 distribution with 1 degree of freedom (3.84).
The logarithmic transformation and the value k ¼ 1 are clearly rejected
and the maximum likelihood estimate is ~k ¼ 0:27. It is worth noticing that
the diﬀerences in results with respect to other authors can be attributed to the
fact that we use a diﬀerent model and that we include a calendar component in
our model, which turns out to be signiﬁcant. As the value 0.27 is not
signiﬁcantly diﬀerent from 0.25, in our subsequent analyses we will use the value
k ¼ 0.25, for which, as we have seen in the previous section, the conditional
mean and the variance of the seasonally adjusted series admit a closed-form
The maximum likelihood estimates of the variance parameters are ~r2
g ¼ 0:1108;
x ¼ 0:0000; and ~r2
 ¼ 0:1728. As a result, the slope is ﬁxed and
seasonality is deterministic. The Bowman and Shenton normality test takes the
value 0.5; some residual correlation is left, as by the Ljung–Box portmanteau test
statistic with 12 autocorrelation, which takes the value 23.34.
The two central panels present the transformed series along with the estimated
trend and the seasonal and calendar component on the transformed scale.
The bottom panel displays the estimates of the seasonally adjusted series on the
original scale, that is ~y
along with their 95% highest density region.
The computations were made by numerical integration, but as we argue below
these are undistinguishable from the exact estimates and from the Monte Carlo
estimates using a suitably large number of replications. It is interesting to notice,
as we have seen theoretically in the previous section, that the width of the
conﬁdence interval of the seasonally adjusted series in the original scale increases
as the trend increases.
The last panel compares the estimates of the SA series arising for the estimated
transformation parameter with that arising in the case of the logarithmic
transformation. The graph highlights that the diﬀerences can be relevant and the
Box–Cox transformation is indeed an issue in seasonal adjustment. Given that an
exact solution exists for ~y
t and varðy
t jFT Þ, we can evaluate the accuracy of the
various estimates that have been proposed. The estimation methods that are
compared are the following.
• The naı¨ve estimate (the conditional median), ~y
t ¼ ð1 þ 0:25~u
• Monte Carlo integration using the simulation smoother: M independent
samples, uðiÞ
; i ¼ 1; . . . ; M; are drawn from the conditional distribution
TRANSFORMATIONS AND SEASONAL ADJUSTMENT
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
t jFT  Nð~u
t Þ, which is done recursively by the simulation smoother.
The seasonally adjusted series is estimated by average
1 þ 0:25uðiÞ
The variance of the SA series is estimated by
t jFT Þ ¼ 1
1 þ 0:25uðiÞ
Results are presented for the number of replications M ¼ 1000 and M ¼
• Numerical integration using the QuadPack function QAGS, available in Ox
3.4; the ﬁnite integration interval is deﬁned as ½~u
~ut and Vt are evaluated by the Kalman ﬁlter and smoother applied to the
transformed observations.
The Taylor estimation method based on a Taylor’s approximation:
The method proposed by Guerrero:
Based on the choice of model and k, Table II reports the mean error of
MEj ¼ T 1 X
Sales X Data: Accuracy of Different Estimation Methods
Mean error
Mean square error
Mean percent error
Estimation of ~y
0.48452941
0.26217669
0.18820985
0.18820985
MC Int 1000
0.00587377
0.00044615
0.00227596
0.00646891
MC Int 10000
0.00173609
0.00003516
0.00060559
0.00175783
0.00000000
0.00000000
0.00000000
0.00000000
0.00007648
0.00000001
0.00003273
0.00003273
0.00003824
0.00000000
0.00001636
0.00001636
Estimation of Varðy
MC Int 1000
MC Int 10000
T. PROIETTI AND M. RIANI
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
where the subtrahend is given by the exact expression given in Table I, the mean
square error,
MSEj ¼ T 1 X
the mean percent error,
MPEj ¼ 100T 1 X
and the mean absolute percent error,
MAPEj ¼ 100T 1 X
In this application, the ratio Vt=
is very small (6 105 on average) and
thus the naı¨ve estimate has a good performance. It should be recalled that the last
two columns present percent values. It is also evident from the table that the
Taylor and Guerrero approximations are very accurate for this application.
Numerical integration is the most accurate; the performance of Monte Carlo
integration depends on the number of replications used. The convergence to the
true conditional mean is not very fast. This is due to the correlation between the
random draws that results from the persistence of the nonseasonal component of
the series. The use of an antithetic variable greatly improves the performance.
The second part of the table displays the same statistics with reference to the
problem of estimating the conditional variance varðy
t jFTÞ. It must be remarked
that the Taylor and Guerrero methods do not provide an estimate of this feature.
Again, numerical integration provides the fastest and most reliable method of
estimating varðy
5.2. Italian industrial production of LS sector
Our second illustration deals with the estimation of the seasonally adjusted series
and of its posterior variance according to eqns (3) and (4) with reference to the
industrial production index for the Leather and Shoes (LS) sector, available for
the period 1981.1–2005.2 , under
the Box–Cox transformation. We notice in passing that the oﬃcial seasonal
adjustment performed by the Italian National Statistical Institute (Istat) is carried
out on the untransformed series (i.e. k ¼ 1) using the software Tramo-Seats.
The plot of the original series (see the left-hand panel of Figure 4) reveals that
the amplitude of the seasonal component decreases with the trend. The dominant
feature is the seasonal trough occurring in August. The likelihood ratio test of
H0 : k ¼ 1
signiﬁcant
likelihood
transformation parameter is ^k ¼ 0:501, corresponding to the square root
TRANSFORMATIONS AND SEASONAL ADJUSTMENT
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
transformation. The proﬁle likelihood for the transformation parameter suggests
values roughly between 0.25 and 0.75.
Clearly, we have to establish whether the square root transformation is due to
the presence of particular observations or it is diﬀused throughout the data.
Finally, we need to know what is the eﬀect on the estimated k of the months of
August or whether there are other months whose variance of the seasonal
movements is much greater than the others, but are obscured by the high
ﬂuctuations of the month of August.
To start answering all these questions in Figure 5 we produce a series of fan
plots for k ¼ (0,0.25,0.5,0.75)0. The top left panel of Figure 5, which uses a
Original and seasonally adjusted series
Difference between SA series:
Figure 4. Index of Industrial Production, Sector DC: Leather and Shoes.
Trigonometric seasonality, non proportional FS
HS homoscedastic seasonality, non proportional FS
Step of the forward search
HS heteroscedastic seasonality, non proportional FS
Step of the forward search
Number of seasons inside subset
Figure 5. Robust estimate of the transformation parameter for diﬀerent speciﬁcations of the seasonal
component using a nonproportional FS.
T. PROIETTI AND M. RIANI
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
trigonometric speciﬁcation for the seasonal component and a nonproportional
forward search, shows that the log transformation is always rejected throughout.
The value 0.75 is strongly rejected during the search until a set of observations
at the end brings the score close to the acceptance region. The same upward
trend is visible in the curves associated with k ¼ 0.25 and k ¼ 0.5. In these
cases, this set of observations brings the values of the score from value 3 to a
value around 3.
The monitoring of the seasons inside subset (bottom right panel) clearly shows
that the units entering the subset in steps 270–290 all belong to the month of August.
The eﬀect of the month of August is even more pronounced if we consider the HS
speciﬁcation for stochastic seasonality (see top right panel in Figure 5).
In order to understand whether this is due to seasonal heteroscedasticity we
redo the fan plot allowing the variance of the month of August to be diﬀerent
from that of the other months. The resulting fan plot, which is given in the bottom
left panel, shows that the presence of heteroscedastic seasonality for the month of
August does not seem to alter our conclusions about the transformation
parameter.
A major beneﬁt of the fan plot is that it clearly enables us to appreciate the
eﬀect that the diﬀerent months and/or diﬀerent subperiods exert on the estimate
of the transformation parameter. As is well known, the FS provides an ordering
of the data from those most in agreement with a suggested model (which enter the
ﬁrst steps) to those least in agreement with it (which are included in the ﬁnal
steps). For example, the bottom right panel shows that the seasons which are most
diﬃcult to model are those associated with the months of November and August.
However, while the eﬀect of the introduction of the months of November (steps
230–260) does not change the value of the score test appreciably, it is clear as
regards the eﬀect that the month of August exerts on the estimated k.
Figure 6 shows the new fan plot for trigonometric (top panel) and HS
speciﬁcation (bottom panel) for a proportional forward search. Both plots show
that if we consider subsets which contain the same proportion of months as that
of the original sample, the curves for the diﬀerent values of k are more stable and
the values associated with the square root transformation in the central and ﬁnal
part of the search always lie inside the conﬁdence bands.
The monitoring of the estimates of the hyperparameters on the square root
scale (not given here for lack of space) show that in this scale the values of the
variances of the underlying components are stable together with the t-statistics for
the trading days and there are no sudden jumps because of the presence of
atypical observations.
As a result of this analysis, the BSM was used on the transformed
observations
ut ¼ 2ðy1=2
trigonometric
speciﬁcation gave the following maximum likelihood estimates of the variance
parameters ~r2
g ¼ 0:01556; ~r2
f ¼ 0:00003; ~r2
x ¼ 0:00079; and ~r2
 ¼ 0:05640.
There is a signiﬁcant calendar component in the series, the coeﬃcients
associated with the working days being positive and those associated with the
week-end being negative. The diagnostics are satisfactory, and normality is
TRANSFORMATIONS AND SEASONAL ADJUSTMENT
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
accepted (the Bowman and Shenton normality test results 3.76, with p-value ¼
0.15). The point estimates of the seasonally adjusted series on the original scale of
measurement are reproduced in the bottom left panel of Figure 4, along with the
95% highest density region of the posterior distribution of y
t . The right-hand
panel of Figure 4 compares the estimates of the seasonally adjusted series on the
original scale with those emerging from the BSM adapted to the untransformed
series (k ¼ 1); on average, the latter display a positive bias, but there are relevant
diﬀerences that go well beyond a level change. In particular, the diﬀerences are
substantial with respect to August.
Given that analytical solutions are available,
t jFT Þ ¼ ^y
we can assess the accuracy of the various estimation methods considered
in section 5.1. It must be stressed that the Taylor method gives only in this case
(k ¼ 0.5) an exact solution. The ME, the MSE, the MPE and the MAPE for the
seasonally adjusted series and its variance (not reported for brevity), show that
the most accurate method is numerical integration, which has an excellent
performance also for the estimation of the conditional variance. Monte Carlo
integration is more accurate than Guerrero’s method and both outperform the
naı¨ve estimate.
Step of the forward search
Trigonometric seasonality, proportional FS
Step of the forward search
HS seasonality, proportional FS
Figure 6. Robust estimate of the transformation parameter for diﬀerent speciﬁcations of the seasonal
component using a proportional FS.
T. PROIETTI AND M. RIANI
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
6. CONCLUDING REMARKS
This article has investigated the issue of seasonal adjustment under the Box–Cox
power transformation of time series which are bounded from below by 0. For lack
of space we could only show example from univariate time series. The reader
interested in the extension of the current approach to multivariate time series and
or to other classes of transformation, such as the Aranda-Ordaz, can refer to a
research report by the same authors .
The rationale behind the transformation is to enhance several desirable features
of the maintained measurement model: linearity, additivity and orthogonality of
components, normality of the disturbances driving the components. In this article
we have concentrated on the Box–Cox transformation applied to the basic
structural model. However, the idea of imposing the seasonal constraint on the
transformed scale, performing seasonal adjustment and then transforming back
into the original series can be applied to any structural or ARIMA model or to the
more complicated models like the so-called transformation/weighting models, where not only the response is transformed,
but also the part used to ﬁt the mean model and the disturbance term to take into
account heteroscedasticity.
This article has documented that transformations of seasonal time series are
both feasible and relevant. It is feasible, since there are computationally eﬃcient
and accurate methods of estimating the conditional mean and variance of the
seasonally adjusted series that are applicable in the absence of a closed-form
solution. It is relevant, since the estimates may diﬀer relevantly from those
obtained using either the untransformed observations or the logarithms. Our case
studies concerned cases when seasonality is the most prominent source of
variation of the data as often occurs for industrial production, tourism and sales.
For univariate analysis numerical integration is both fast and reliable, and is
recommended against the use of approximate methods or Monte Carlo
integration using the simulation smoother. The latter may require a large
number of replications, when the nonseasonal component is highly persistent and
weakly evolutive. However, it can be made as accurate as needed by increasing the
number of replications and by using variance reduction techniques.
While in univariate models it is possible to choose between diﬀerent solutions,
in multivariate applications the use of the simulation smoother is the unique
option available. A multivariate application that we have in mind is indirect
seasonal adjustment, when a cross sectional seasonally adjusted aggregate is
obtained as
In this setting, EðY 
t jFT Þ can be evaluated by Monte Carlo integration, using
the simulation smoother. Applying diﬀerent transformations to the component
series could raise questions about the implied seasonal component; this may
TRANSFORMATIONS AND SEASONAL ADJUSTMENT
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
suggest the restriction ki ¼ k, where k is the transformation parameter of the
aggregate series.
Finally, it is worthwhile to remark that even if the focus of this paper was
seasonal adjustment, our method can be easily extended to ﬁnd the estimate of all
the other components on the original scale (e.g. the detrended series). In other
words, once the two conditional moments of the detrended series in the
transformed scaled are found using the Kalman ﬁlter and smoother, the
detrended series on the original scale can be computed using numerical or
Monte Carlo integration or the exact analytic solution described in the article.
APPENDIX: PROOF OF THEOREM 1
We start considering the Taylor series expansion of the inverse transformation ð1 þ ku
around ~u
t Þ1=k ¼ ð1 þ k~u
t Þ1=k þ ð1 þ k~u
t Þ1=k1ðu
2 ð1  kÞð1 þ k~u
t Þ1=k2ðu
t Þ2 þ   
Now, taking the expectation of both sides with respect to the Gaussian density f ðu
and remembering that the central j-order moment is zero if j is odd, after some manipulation
we obtain that:
t jFT Þ ¼ ~y
If we denote with
ajðtÞ ¼ ð2jÞ!
eqn (9) can be rewritten as:
t jFT Þ ¼ ~y
k2jðtÞajðtÞ
The second noncentral moment is given by
t jFT Þ ¼ ^y2
kjðtÞkrðtÞðu
T. PROIETTI AND M. RIANI
 2009 The Authors
Journal compilation  2009 Blackwell Publishing Ltd.
JOURNAL OF TIME SERIES ANALYSIS Vol. 30, No. 1
Taking the expectation of both sides with respect to the Gaussian density f ðu
t jFT Þ we
t jFT Þ¼^y2
j ðtÞajðtÞþ2
kjðtÞkjþ2rðtÞajþrðtÞþ2
k2jðtÞajðtÞ
On the other hand, the square of the ﬁrst moment can be written as:
k2jðtÞajðtÞ
k2jðtÞajðtÞ
After some manipulations we obtain that:
t jFT Þ¼^y2
j ðtÞajðtÞþ2
kjðtÞkjþ2rðtÞajþrðtÞ
k2jðtÞajðtÞ
ACKNOWLEDGEMENTS
The authors are grateful to A.C. Atkinson, W.R. Bell, V.M. Guerrero, and two
anonymous referees for critically reading the manuscript and providing valuable
suggestions which have led to an improvement in both the presentation and the
content of the article.
1. We adopt the convention that when j ¼ 1 the product in brackets in kj
equals 1, Q0
i¼1 xi ¼ 1.
Corresponding authors: Tommaso Proietti, Dipartimento S.E.F. e ME.Q., Via
Columbia 2, 00133 Rome, Italy. E-mail: ; Marco
Riani, Dipartimento di Economia, Via Kennedy, 6 - 43100 Parma, Italy. E-mail: