A graphical approach for evaluating effective
connectivity in neural systems
Michael Eichler*
Department of Statistics, The University of Chicago, Chicago, IL 60637, USA
The identiﬁcation of effective connectivity from time-series data such as electroencephalogram
(EEG) or time-resolved function magnetic resonance imaging (fMRI) recordings is an important
problem in brain imaging. One commonly used approach to inference effective connectivity is based
on vector autoregressive models and the concept of Granger causality. However, this probabilistic
concept of causality can lead to spurious causalities in the presence of latent variables. Recently,
graphical models have been used to discuss problems of causal inference for multivariate data. In this
paper, we extend these concepts to the case of time-series and present a graphical approach for
discussing Granger-causal relationships among multiple time-series. In particular, we propose a new
graphical representation that allows the characterization of spurious causality and, thus, can be used
to investigate spurious causality. The method is demonstrated with concurrent EEG and fMRI
recordings which are used to investigate the interrelations between the alpha rhythm in the EEG and
blood oxygenation level dependent (BOLD) responses in the fMRI. The results conﬁrm previous
ﬁndings on the location of the source of the EEG alpha rhythm.
Keywords: graphical models; multivariate time-series; Granger causality; causal inference;
spurious causality
1. INTRODUCTION
Recent studies in functional brain imaging have
focused on the investigation of interactions between
brain areas that are activated during certain tasks. Of
particular interest is the determination of directed
interactions and, hence, of the effective connectivity,
which is deﬁned as the inﬂuence one region exerts over
another .
Several approaches have been suggested for modelling
and estimating effective connectivity: structural equation modelling , nonlinear dynamic causal
models and vector autoregressive
modelling .
The latter approach explicitly makes use of the
temporal information in time-resolved fMRI measurements and is closely related to the concept of Granger
causality . This probabilistic
concept of causality introduced by Granger is
based on the idea that causes always precede their
effects and can be formulated in terms of predictability.
In general, inferences about effective connectivity
rely on the assumption that the underlying dependence
structure of the system is correctly speciﬁed by the
statistical model employed for the analysis. In the case
of Granger causality and vector autoregressive modelling, it is well known that omission of relevant factors
can lead to temporal correlations between the observed
components that are falsely detected as causal relationships. Such so-called spurious causalities 
are particularly a problem in brain imaging applications
where typically only a small number of the potential
factors are included in an analysis. This raises the
questions of whether and how effective connectivity of
neural systems can be determined by ﬁtting vector
autoregressive models.
In this paper, we address this question using a new
graphical approach for the investigation of dependence
structures in multivariate dynamic systems. This
approach is motivated by recent work on causal
inference that is based
on graphical models. The idea of graphical modelling is
to represent possible dependencies among the variables
of a multivariate distribution in a graph. Such graphs
can be easily visualized and allow an intuitive understanding of complex dependence structures. For an
introduction to graphical models we refer to the
monographs by Whittaker , Cox & Wermuth
 , Lauritzen and Edwards .
time-series
approaches for deﬁning graphical models; a partial
overview can be found in Dahlhaus & Eichler .
Here, we focus on the approach by Eichler , who linked the notions of graphical modelling
and Granger causality to describe the dynamic
dependencies in vector autoregressions. In §2, we
review the concept of path diagrams associated with
vector autoregressions and multivariate Granger causality. Furthermore, we introduce a similar graphical
representation of the bivariate Granger-causal relationships among multiple time-series. In §3, we discuss the
properties of such multivariate and bivariate path
diagrams and their relation to each other. The results
Phil. Trans. R. Soc. B 360, 953–967
doi:10.1098/rstb.2005.1641
Published online 29 May 2005
One contribution of 21 to a Theme Issue ‘Multimodal neuroimaging
of brain connectivity’.
* Author and address for correspondence: Institute of Applied
Mathematics,
University of
Heidelberg,
Heidelberg,
Germany. ( ).
q 2005 The Royal Society
suggest using a combination of both representations for
the description of dependencies in multiple time-series.
These general path diagrams and the implications for
causal inference from vector autoregressions are
discussed in §4, and an application for simultaneous
recordings from EEG and time-resolved fMRI is
provided in §5.
2. GRANGER CAUSALITY AND
AUTOREGRESSIVE MODELLING
(a) Multivariate Granger causality
The concept of Granger causality is a fundamental tool
for the empirical investigation of dynamic interactions
in multivariate time-series. This probabilistic concept
of causality is based on the common sense conception
that causes always precede their effects. Thus, an event
taking place in the future cannot cause another event in
the past or present. This temporal ordering implies that
the past and present values of a series X that inﬂuences
another series Y should help to predict future values of
this latter series Y. Furthermore, the improvement in
the prediction of future values of Y should persist after
any other relevant information for the prediction
has been exploited. Suppose that the vector time-series
Z comprises all variables that might affect the
dependence between X and Y, such as confounding
variables. Then we say that a series X Granger causes
another series Y with respect to the information given
by the series (X, Y, Z ) if the value of Y(tC1) can be
better predicted by using the entire information
available at time t than by using the same information
apart from the past and present values of X. Here,
‘better’ means a smaller variance of forecast error.
Because of the temporal ordering, it is clear that
Granger causality can only capture functional relationships for which cause and effect are sufﬁciently
separated in time. To describe causal dependencies
between variables at the same time point, Granger
 proposed the notion of ‘instantaneous causality’. In general, it is not possible to attribute a unique
direction to such ‘instantaneous causalities’ and we
contemporaneous
dependencies.
In practice, the use of Granger causality has mostly
been restricted to the investigation of linear relationships. This notion of linear Granger causality is closely
related to the important class of vector autoregressive
processes. More precisely, let XV be a zero-mean,
weakly stationary vector time-series with components
Xv, v2VZ{1,.,d } and assume that XV has an
autoregressive representation of the form
FðuÞXVðt KuÞ C3VðtÞ;
where the matrices F(u) are square summable and
3V (t) is a white noise process with mean zero and nonsingular covariance matrix S. Then, for any b2V, the
linear prediction of Xb(tC1) on the past and present
values of XV is given by
^Xbðt C1Þ Z
FbaðuÞXaðt Ku C1Þ:
It follows that a component Xa is Granger-non-causal
for Xb with respect to the complete series XV if, and
only if, Fba(u)Z0 for all lags u. Furthermore, if SabZ0,
the variables Xa(tC1) and Xb(tC1) are uncorrelated
after removing the linear effects of XVðsÞ, s%t and we
say that Xa and Xb are contemporaneously uncorrelated with respect to XV.
From the deﬁnition of Granger causality in terms of
the autoregressive parameters, it is clear that the notion
of Granger causality depends on the multivariate timeseries XV available for the analysis. If, for example, we
consider only a subset Xs, s2S, of the series in XV, the
vector time-series XS again has an autoregressive
representation
~FðuÞXSðt KuÞ C ~3SðtÞ;
for some white noise series ~3S with covariance matrix ~S,
but the coefﬁcients ~FðuÞ and ~S will generally be different
from those in (2.1). For distinct a, b2V, we say that
Xa does not Granger-cause Xb with respect to XS if
~FbaðuÞZ0 for all lags u. To illustrate this dependence
on the analysed process XV, we consider the following
trivariate system. Let
X1ðtÞ Z aX2ðt K1Þ C31ðtÞ;
X2ðtÞ Z bX3ðt K1Þ C32ðtÞ;
X3ðtÞ Z 33ðtÞ;
where 3v(t), vZ1, 2, 3 are independent and identically
normally distributed with mean zero and variance s2.
Then X3 Granger-causes X2, which in turn Grangercauses X1, whereas X3 is Granger-non-causal for X1
(all with respect to the full trivariate series X{1,2,3}).
On the other hand, in a bivariate autoregressive
representation of X1 and X3, we have
X1ðtÞ Z abX3ðt K2Þ C ~31ðtÞ;
X3ðtÞ Z 33ðtÞ;
~31ðtÞZ31ðtÞCa32ðtK1Þ.
representation
implies that X3 Granger-causes X1 with respect to
the bivariate series X{1,3}.
(b) Path diagrams
The Granger-causal relationships in a vector autoregressive process XV can be represented graphically by a
path diagram in which vertices v correspond to the
components Xv, while directed edges (/) between the
vertices indicate Granger-causal inﬂuences. For a
complete graphical description of the dependence
structure of XV, we also include undirected edges
(---) to depict contemporaneous correlations between
the corresponding components. This leads to the
following deﬁnition of path diagrams associated with
vector autoregressions .
Deﬁnition 2.1. Let XV be a weakly stationary time-series
with the autoregressive representation (2.1). Then the path
diagram associated with XV is a graph GZ(V, E ) with
vertex set Vand edge set E such that for a, b2V with asb
(i) a/b;E5FbaðuÞZ0 for uZ1; 2; .;
(ii ) a - - - b;E5SabZ0.
M. Eichler
Evaluating effective connectivity
Phil. Trans. R. Soc. B 
In other words, the path diagram G contains a
directed edge a/b if, and only if, Xa Granger-causes
Xb with respect to the full series XV. Similarly, an
undirected edge a - -- b is present in the path diagram if,
and only if, Xa and Xb are contemporaneously
correlated with respect to XV.
As an example, we consider the trivariate vector
autoregression in equation (2.2). The associated path
diagram is depicted in ﬁgure 1. Here the directed path
from 3 to 1 via 2 reﬂects the fact that X3 Grangercauses X1 if X2 is not included in the analysis. A more
complicated path diagram is obtained for the following
trivariate system:
X1ðtÞ Z F12X2ðt K1Þ CF13X3ðt K1Þ C31ðtÞ;
X2ðtÞ Z F23X3ðt K1Þ C32ðtÞ;
X3ðtÞ Z F32X2ðt K1Þ CF33X3ðt K1Þ C33ðtÞ;
with S13ZS23Z0. The associated path diagram in
ﬁgure 2 provides a concise summary of the interactions
and shows for example a feedback relation between X2
and X3. Note that the dependence of X3 on past values
of itself is not depicted in the diagram. It follows from
the results in §3 that inclusion of such self-loops v/v
would not change the properties of the graph and we
therefore omit them for the sake of simplicity.
(c) Bivariate Granger causality
Much of the literature on Granger causality has been
concerned with the analysis of relationships between
two time-series (or two vector time-series) and, as a
consequence, relationships among multiple time-series
are still quite frequently investigated using bivariate
Granger causality; examples involving EEG or fMRI
signals can be found in Kamin´ski et al. , Goebel
et al. and Hesse et al. .
For a better understanding of this approach and its
relation to a full multivariate analysis based on multivariate Granger causality, we now introduce a graphical
representation of the bivariate connectivity structure.
Suppose that XV is a weakly stationary process of the
form (2.1). Then for a, b2V the bivariate subprocess
X{a,b} is again a weakly stationary process and has an
autoregressive representation:
~FaaðuÞXaðt KuÞ
~FabðuÞXbðt KuÞ C ~3aðtÞ;
~FbaðuÞXaðt KuÞ
~FbbðuÞXbðt KuÞ C ~3bðtÞ;
where ~3ðtÞZð~3aðtÞ; ~3bðtÞÞ is a white noise process with
covariance matrix
~S. From this representation, it
follows that Xa is bivariately Granger-causal for Xb if,
and only if, the coefﬁcients ~FbaðuÞ are zero for all lags u.
This leads to the following deﬁnition of bivariate path
diagrams that visualize the bivariate connectivities of
Deﬁnition 2.2. Let XV be a weakly stationary time-series
of the form (2.1). Then the bivariate path diagram
associated with XV is a graph GZ(V, E ) with vertex set
Vand edge set E such that for all a, b2V with asb
b;E5 ~FbaðuÞZ0 for uZ1; 2; .,
(ii ) a - - - b;E5 ~SabZ0,
where ~FðuÞ, uZ1, 2,. and ~S are the parameters in the
autoregressive representation (2.4) of the bivariate subprocess X{a,b}.
As an example, we consider again the trivariate
system in (2.2). As noted before, the bivariate
autoregressive representation of X1 and X3 is given by
X1ðtÞ Z abX3ðt K2Þ C ~31ðtÞ;
X3ðtÞ Z 33ðtÞ;
with ~31ðtÞZ31ðtÞCa32ðtK1Þ, which implies that X3
Granger-causes X1. Furthermore, it can be shown that
the bivariate representation of the subprocess X{1,2} is
X1ðtÞ Z aX2ðt K2Þ C31ðtÞ;
X2ðtÞ Z ~32ðtÞ;
with ~32ðtÞZ32ðtÞCb33ðtK1Þ. Hence, X2 Grangercauses X1 in a bivariate analysis. Finally, the
autoregressive representation of X{2,3} is determined
by the second and the third equation in (2.2) and, thus,
X3 Granger-causes X2. The bivariate Granger-causal
relationships between the variables can be summarized
by the path diagram in ﬁgure 3b.
We note that in general the relation between the
bivariate representations (2.4) and the multivariate
representation (2.1) is more complicated than in this
X1 (t) = a X2 (t – 1) + e1 (t)
X2 (t) = b X3 (t–1) + e1 (t)
X3 (t) = e1 (t)
Figure 1. A trivariate VAR(1) model with independent errors
and its associated multivariate path diagram.
  31 =  13 = 0
Figure 2. Multivariate path diagram associated with the
VAR(1) model in (2.3). For each edge that is absent in the
graph the corresponding zero constraint on the parameters is
Figure 3. Graphical representations for the trivariate system
in (2.2). (a) Multivariate path diagram associated with the
autoregressive representation of the trivariate series X{1,2,3}.
(b) Bivariate path diagram associated with autoregressive
representations of bivariate series X{1,2}, X{1,3} and X{2,3}.
Evaluating effective connectivity
M. Eichler
Phil. Trans. R. Soc. B 
example and an analytic derivation of the bivariate
representations would be very difﬁcult to obtain.
3. MARKOV PROPERTIES
The edges in the path diagrams discussed in this paper
represent pairwise Granger-causal relationships with
respect to either the complete process in the case of
multivariate path diagrams or bivariate subprocesses in
the case of path diagrams depicting the bivariate
connectivity structure. The results in this section
show that both types of path diagrams more generally
provide sufﬁcient conditions for Granger-causal
relationships with respect to subseries XS for any
subset S of V. The proofs of the results are technical and
therefore omitted; for multivariate path diagrams the
proofs can be found in Eichler , for bivariate
path diagrams they can be obtained from the author
upon request.
(a) Multivariate path diagrams
We ﬁrst review a path-oriented concept of separating
subsets of vertices in a mixed graph that has been used
to represent the Markov properties of linear structural
equation systems .
Following Richardson , we will call this notion of
separation in mixed graphs m-separation.
Let GZ(V, E ) be a mixed graph with directed edges
/ and undirected edges -- -. A path p between two
vertices a and b in G is a sequence pZhe1,.,eni of edges
ei2E such that ei is an edge between viK1 and vi for
some sequence of vertices v0Za, v1,.,vnZb. We say
that a and b are the endpoints of the path, while
v1,.,vnK1 are the intermediate vertices on the path.
Note that the vertices vi in the sequence do not need to
be distinct and, therefore, that paths may be selfintersecting.
An intermediate vertex c on a path p is said to be a
collider on the path if the edges preceding and
succeeding c on the path both have an arrowhead or a
dashed tail at c, that is, /c), /c-- -, -- -c), -- - c-- -;
otherwise the vertex c is said to be a non-collider on the
path. A path p between vertices a and b is said to be
m-connecting given a set C if
(i) every non-collider on the path is not in C and
(ii) every collider on the path is in C,
otherwise we say the path is m-blocked given C. If all
paths between a and b are m-blocked given C, then a and
b are said to be m-separated given C. Similarly, sets A
and B are said to be m-separated in G given C iffor every
pair a2A and b2B, a and b are m-separated given C.
As an example consider the graph in ﬁgure 4. In this
graph, vertices 1 and 4 are m-separated given SZ{3}.
To show this, we examine all paths between the two
vertices. First, we consider the path 4/3/1. Since 3
is a non-collider on this path, the path is m-blocked
given {3}. Second, we note that every path that passes
through vertex 2 contains this vertex as a collider. Two
examples of such paths are given in ﬁgure 4b,c. Since 2
lies outside SZ{3}, these paths are m-blocked given S.
The only path between 1 and 4 that does not pass
through 2 is the path 4/3/1, which is also m-blocked
given S. Hence, no path exists that is m-connecting
given S and consequently 1 and 4 are m-separated
Now suppose that XV is a weakly stationary timeseries with autoregressive representation (2.1) and let
G be its associated multivariate path diagram. Furthermore, let A, B and C be disjoint subsets of V. Then,
if A and B are m-separated given C, it can be shown
 that XA(t) and XB(tCu)
are uncorrelated at all lags u after removing the linear
effects of the complete series XC. For example, in the
path diagram in ﬁgure 3a associated with the trivariate
process in (2.2), vertices 1 and 3 are m-separated given
SZ{2}. This implies that the components X1 and X3
are uncorrelated conditionally on X2 but not in a
bivariate analysis.
On the other hand, we have shown in §2a that in a
bivariate analysis X3 Granger-causes X1 whereas X1 is
Granger-non-causal for X3 (as indicated by the
bivariate path diagram in ﬁgure 3b). Obviously, the
notion of m-separation is too strong for the derivation
of Granger-non-causal relations from multivariate path
diagrams: the deﬁnition of m-separation requires that
all paths between vertices 1 and 3 are m-blocked
whereas the path 3/2/1 is intuitively interpreted as a
causal link from X3 to X1. Consequently, the path
should not be considered when discussing Granger
causality from X1 to X3.
The example suggests the following deﬁnition.
A path p between vertices a and b is said to be
b-pointing if it has an arrowhead at the endpoint b.
More generally, a path p between A and B is said to be
B-pointing if it is b-pointing for some b2B. In order to
establish Granger non-causality from XA to XB, it
sufﬁces to only consider all B-pointing paths between A
Theorem 3.1. Suppose XV is a weakly stationary timeseries with autoregressive representation (2.1) and let
GZ(V, E ) be the path diagram associated with XV.
Furthermore, let A, B and C be disjoint subsets of V. If every
B-pointing path between A and B is m-blocked given BgC,
then XA is Granger-non-causal for XB with respect to
Similarly, a graphical condition for contemporaneous correlation can be obtained. Intuitively, two
variables Xa and Xb are contemporaneously uncorrelated with respect to XS if they are contemporaneously
uncorrelated with respect to XV and the variables are
not jointly affected by past values of XV\S. For a precise
formulation of the conditions, we need the following
deﬁnition. A path p between vertices a and b is said to
be bi-pointing if it has an arrowhead at both endpoints
Figure 4. Illustration of m-separation in mixed graphs:
vertices 1 and 4 are m-separated given SZ{3} since all
paths between 1 and 4 are m-blocked given S. (a) Path 4/
3/1 is m-blocked by non-collider 3;S. (b) Path 4/2)1
is m-blocked by collider 22S. (c) Path 4/3- - -2)1 is
m-blocked by collider 22S.
M. Eichler
Evaluating effective connectivity
Phil. Trans. R. Soc. B 
a and b. Then the sufﬁcient condition for contemporaneous correlation can be stated as follows.
Theorem 3.2. Suppose XV is a weakly stationary timeseries with autoregressive representation (2.1) and let
GZ(V, E ) be the path diagram associated with XV.
Furthermore, let A, B and C be disjoint subsets of V. If
(i) a - - - b;E for all a2A and b2B and
(ii ) every bi-pointing path between A and B is m-blocked
given AgBgC,
then XA and XB are contemporaneously uncorrelated with
respect to XAgBgC.
As an example, consider the four-dimensional vector
autoregressive process XV with components
X1ðtÞ Z aX4ðt K2Þ C31ðtÞ;
X2ðtÞ Z bX4ðt K1Þ CgX3ðt K1Þ C32ðtÞ;
X3ðtÞ Z 33ðtÞ;
X4ðtÞ Z 34ðtÞ;
where 3i(t), iZ1,.,4 are uncorrelated white noise
processes with mean zero and variance one. The path
diagram associated with XV is shown in ﬁgure 5a. In
this graph, vertices 1 and 3 are connected by the path
3/2)4/1. On this path, vertex 2 is a collider,
whereas vertex 4 is a non-collider. Thus, the path is
m-blocked given the set {2} and it follows from
theorem 3.1 that X3 is Granger-non-causal for X1 in
a bivariate analysis, but not in a trivariate analysis
including X2. Furthermore, vertices 1 and 2 are
connected by the bi-pointing path 1)4/2, which is
only m-blocked given vertex 4. Therefore, it follows by
theorems 3.1 and 3.2 that X1 and X2 Granger-cause
each other and, additionally, are contemporaneously
correlated regardless of whether X3 is included in the
analysis or not. The Granger-causal relationships, with
respect to X{1,2,3}, that can be inferred from the path
diagram in ﬁgure 5a can be summarized by the graph in
More generally, if a mixed graph G encodes certain
Granger-non-causal relations of a process XV, we say
that XV satisﬁes a Markov property with respect to the
Deﬁnition 3.3. We say that a weakly stationary timeseries XV satisﬁes the global Granger-causal Markov
property with respect to a mixed graph G if the following
conditions hold for all disjoint subsets A, B and C of V:
(i) If in the graph G every B-pointing path between A and
B is m-blocked given BgC, then XA is Grangernon-causal for XB with respect to XAgBgC.
(ii) If the sets A and B are not connected by an undirected
edge (- - -) in graph G and every bi-pointing path
between A and B is m-blocked given AgBgC, then
XA and XB are contemporaneously uncorrelated with
respect to XAgBgC.
With this deﬁnition, theorems 3.1 and 3.2 state that
a weakly stationary time-series XV with the autoregressive representation (2.1) satisﬁes the global Grangercausal Markov property, with respect to its multivariate
path diagram G.
For the four-dimensional time-series in (3.1), we
have shown above that the Granger-causal relationships with respect to the trivariate subseries X{1,2,3} are
encoded by the graph in ﬁgure 5b. It follows from
theorems 3.1 and 3.2 that the trivariate subprocess
X{1,2,3} satisﬁes the global Granger-causal Markov
property with respect to the graph in ﬁgure 5b. On the
other hand, it can be shown that X{1,2,3} is given by
1 Cb2 X2ðt K1Þ C abg
1 Cb2 X3ðt K2Þ C ~31ðtÞ;
X2ðtÞ Z gX3ðt K1Þ C ~32ðtÞ;
X3ðtÞ Z 33ðtÞ;
where ~32ðtÞZ32ðtÞCbX4ðtK1Þ and
~31ðtÞ Z 31ðtÞ K
1 Cb2 32ðt K1Þ C
1 Cb2 X4ðt K2Þ:
Simple calculations show that ~3ðtÞZð~31ðtÞ; ~32ðtÞ; 33ðtÞÞ is
indeed a white noise process with uncorrelated
components. Thus, the path diagram associated with
the trivariate process X{1,2,3} is given by the graph in
ﬁgure 5c. Note that this graph is a subgraph of the
graph in ﬁgure 5b, which has been derived from the
path diagram of the complete series XV: theorems 3.1
and 3.2 provide only sufﬁcient, not necessary, conditions for Granger non-causality with respect to
subprocesses.
(b) Bivariate path diagrams
Next, we discuss the properties of the bivariate path
diagrams introduced in §2c. Recall that these path
diagrams may have two kinds of edges, namely dashed
directed edges 
and undirected edges -- -. We note
that the choice of dashed directed edges to represent
bivariate Granger-causal relationships allows the application of the concept of m-separation without further
modiﬁcations. More precisely, let G be a mixed graph
with directed edges 
and undirected edges -- - and
let p be a path in G. Then the intermediate vertices on
p can be characterized as colliders and non-colliders as
in §3a, that is, an intermediate vertex c on the path p is
said to be a collider if the edges preceding and
succeeding c on the path both have an arrowhead or
Figure 5. Illustration of the global Granger-causal Markov
property. (a) Multivariate path diagram G{1,2,3,4} of complete
series X{1,2,3,4} of the system in (3.1). (b) Graphical
representation of those relations with respect to the subseries
X{1,2,3} that are encoded in G{1,2,3,4}. (c) True multivariate
path diagram G{1,2,3} of X{1,2,3} depicting all relations with
respect to the subseries X{1,2,3} that hold for X{1,2,3}.
(d) Bivariate path diagram of X{1,2,3} depicting the bivariate
relations among components X1, X2 and X3.
Evaluating effective connectivity
M. Eichler
Phil. Trans. R. Soc. B 
a dashed tail at c. Since G contains only edges of the
or -- -, it follows that all paths p in G are
pure-collider paths, that is, all intermediate vertices are
colliders.
In §3a, we have shown that the concepts of
m-separation and of pointing paths can be used to
derive Granger-non-causal relations with respect to
subprocesses from multivariate path diagrams. The
same is also true for bivariate path diagrams. More
precisely, we have the following result.
Theorem 3.4. Let XV be a weakly stationary time-series
with autoregressive representation (2.1) and let G be the
bivariate path diagram of XV. Then XV satisﬁes the global
Granger-causal Markov property with respect to G.
As an example, consider the four-dimensional
process in (3.1) and suppose that variable X4 has not
been observed. Simple calculations show that X3 is
bivariately Granger-causal for X2, which, in turn,
bivariately Granger-causes X1. Replacing X4(tK2)
with 34(tK2) in the equation for X1(t) in (3.1), we
ﬁnd on the other hand that X1(t) depends only on 31(t)
and 34(tK2) while X3(t)Z33(t). Since the white noise
processes 3i(t) are assumed to be uncorrelated, it
follows that X1 and X3 are completely unrelated. In
particular, this implies that X3 does not bivariately
Granger-cause X1.
The corresponding bivariate path diagram is shown
in ﬁgure 5d. In this path diagram, the absence of the
1 implies that X3 is bivariately Granger-noncausal for X1. On the other hand, vertices 1 and 3 are
connected by the 1-pointing path 3 
follows from theorem 3.4 that, in a trivariate analysis
based on X{1,2,3}, the series X3 Granger-causes X1.
Similarly, the 2-pointing path 1
 2 indicates that X1 Granger-causes X2 with respect to
X{1,2,3}. Since this path is also bi-pointing, the diagram
also indicates that X1 and X2 are contemporaneously
correlated with respect to X{1,2,3}. Altogether, we ﬁnd
that the bivariate path diagram in ﬁgure 5d implies all
relations that are encoded by the graph in ﬁgure 5b and
additionally that X3 is bivariately Granger-non-causal
(c) Comparison of bivariate and multivariate
Granger causality
The notion of Granger causality is based on the idea
that a correlation between two variables that cannot be
explained otherwise must be a causal inﬂuence; the
temporal ordering then determines the direction of the
causal link. This approach requires that all relevant
information is included in the analysis. Given data from
a multivariate time-series XV, it therefore seems
plausible to discuss Granger causality with respect to
the full multivariate process XV.
As a ﬁrst example, we consider again the trivariate
system in (2.2). Here, the multivariate path diagram
(ﬁgure 3a) describes the effective connectivity among
the components correctly, whereas it is not clear from
the bivariate path diagram (ﬁgure 3b) whether X3 has a
direct inﬂuence on X1 or affects X1 only indirectly via
X2. The situation becomes worse for the following
trivariate system
X1ðtÞ Z aX2ðt K2Þ C31ðtÞ;
X2ðtÞ Z 32ðtÞ;
X3ðtÞ Z bX2ðt K1Þ C33ðtÞ;
where the error series are again assumed to be
uncorrelated. The corresponding path diagrams are
depicted in ﬁgure 6. Here, a bivariate analysis suggests
a causal link from X3 to X1, although the observed
correlation between X1 and X3 is only due to
confounding by X2. A trivariate analysis correctly
shows no direct connections between X1 and X3.
This phenomenon that an observed Granger-noncausal relation between two variables vanishes after
adding variables to the information set is called
spurious causality of type II .
A serious problem that arises in practice is the
omission of relevant variables from the analysis (e.g.
because the variables could not be measured). As an
example, we consider again the situation described in
§3b, where we have examined the connectivity structure
of the trivariate subprocess X{1,2,3} of the fourdimensional system (3.1). Here, the multivariate path
diagram (ﬁgure 5c) indicates the presence of a direct
causal link from X3 to X1 although this Granger-causal
inﬂuence vanishes in a bivariate analysis. In this
situation, the bivariate path diagram (ﬁgure 5d ) clearly
provides a better graphical description of the effective
connectivity among the variables than the multivariate
path diagram. This phenomenon that a Granger-causal
relationship vanishes after the information set has been
reduced is called spurious causality of type I (Hsiao
More generally, consider a system in which all
relationships between the observed variables are due to
confounding by latent variables. It can be shown that
two observed components are unrelated whenever they
are not confounded by the same latent variables.
Conversely, this implies that two observed variables
are dependent only if they are affected by a common
confounder. Thus, the effective connectivity of such a
system can be best investigated by bivariate analyses.
4. LATENT VARIABLES AND SPURIOUS
The discussion in §3 has shown that multivariate path
diagrams are best suited for the representation of
structures that do not involve confounding by latent
variables, while the connectivity of a system where all
relationships between the observed variables are
induced by confounding is best described by a bivariate
path diagram. In practice, however, causal structures
may be a combination of both situations with only a
Figure 6. Graphical representations of the connectivity of the
trivariate system in (3.2). (a) Multivariate path diagram
associated with the autoregressive representation of the
trivariate series X{1,2,3}. (b) Bivariate path diagram associated
with autoregressive representations of bivariate series X{1,2},
X{1,3}, and X{2,3}.
M. Eichler
Evaluating effective connectivity
Phil. Trans. R. Soc. B 
part of the Granger-causal relationships being due to
confounding by latent variables. In such cases neither
graphical representation would provide a correct
description of the dependencies among the observed
variables. As an example, consider the following fourdimensional system:
X1ðtÞ Z aX2ðt K1Þ C31ðtÞ;
X2ðtÞ Z bZðt K2Þ C32ðtÞ;
X3ðtÞ Z gZðt K1Þ CdX4ðt K1Þ C33ðtÞ;
X4ðtÞ Z 34ðtÞ;
where 3i, iZ1,.,4 and Z are independent white noise
series. Simple calculations show that the multivariate
and the bivariate path diagrams are given by the graphs
in ﬁgure 7a,b, respectively. Neither graph depicts the
effective connectivity of the system correctly. Moreover, both graphs describe different aspects of the
dependence structure. From the multivariate path
diagram, we learn that X3 is Granger-non-causal for
X1 with respect to X{1,2,3}, while the same Grangernon-causal relation cannot be derived from the
bivariate path diagram. On the other hand, the
bivariate path diagram implies that X4 is bivariately
Granger-non-causal for X2, which is not encoded in the
multivariate path diagram.
(a) General path diagrams
We now propose a new graphical representation that is
based on the global Granger-causal Markov property
and combines elements of both multivariate and
bivariate representations. More precisely, we consider
graphs that may contain three types of edges, namely
, and - - -. For the previous example, such a
graph is shown in ﬁgure 7c. Unlike the graphs in ﬁgure
7a,b, this graph encodes both that X4 is bivariately
Granger-noncausal for X2 and that X3 is Grangernoncausal for X1 with respect to X{1,2,3}.
Suppose that observations from a multivariate timeseries XS that is part of a larger system XVare available.
A necessary condition for a graph GZ(S, E ) to serve as
a model for the effective connectivity of XS is that it
does not imply any independence relations that do not
hold for XS.
Deﬁnition 4.1. A mixed graph G is consistent with XS if
XS satisﬁes the global Granger-causal Markov property
with respect to G.
Obviously, this condition is not sufﬁcient for the
identiﬁcation of effective connectivity since the Markov
property trivially holds for a saturated graph with all
possible edges included. So how can we determine a
graph that depicts the dependencies between the
observed time-series as closely as possible? We ﬁrst
note that the type of a directed edge, / or 
be determined alone from the pairwise Granger-noncausal relations between the two corresponding variables. For instance, suppose that X{a,b} is a bivariate
process such that Xa Granger-causes Xb but not vice
versa. From this information, it is impossible to decide
between the two graphs a/b and a 
b since both
encode the same Granger-non-causal relations.
On the other hand, consider again the fourdimensional process (3.1) and suppose, as in §3b, that
only the subprocess XSZX{1,2,3} has been observed.
The multivariate path diagram G associated with XS is
depicted in ﬁgure 8a. As noted in §3b, the variable Xa
does not Granger-cause Xb in a bivariate analysis.
While this Granger-non-causal relation cannot be
derived from graph a in ﬁgure 8, it is implied by graphs
c and d. This suggests that the latter two diagrams
might be better representations of the effective
connectivity. Thus, the type of the directed edge from
2 to 1 is determined by the bivariate relationship
between components X3 and X1.
This reasoning can be formalized in terms of socalled minimal consistent graphs, which have been
introduced by Pearl who addressed the problem
of inferring causal effects from multivariate distributions satisfying certain conditional independence
relations. Note that, in contrast to the graphs described
here, the causal structures discussed by Pearl need to be
directed acyclic graphs.
For a mixed graph GZ(S, E ), let J(G) be the set of
all independence relations between the variables in XS
that are encoded in the graph according to the global
Granger-causal Markov property. Then for two mixed
graphs G and G0, we write G7G0 if JðG0Þ4JðGÞ,
that is, the graph G encodes the same or more
independence relations than the graph G0. Furthermore, if G7G0 and G07G then J(G0)ZJ(G) and we
Figure 7. Graphical representations for the four-dimensional
system in (3.3). (a) Multivariate path diagram. (b) Bivariate
path diagram. (c) General path diagram.
Figure 8. Illustration of minimal consistent graphs for
the trivariate subseries X{1,2,3} of the system in (3.3).
(a) Multivariate path diagram G{1,2,3} associated with
X{1,2,3}—this graph is consistent with X{1,2,3} but does
not imply that X3 is bivariately Granger-non-causal for X1.
(b) A graph G0, which is Markov equivalent to G{1,2,3}. (c) and
(d) Two minimal consistent graphs, which both correctly
encode that X3 is bivariately Granger-non-causal for X1.
(e) Two inconsistent graphs which falsely encode that X3 is
Granger-non-causal for X1 with respect to X{1,2,3}.
Evaluating effective connectivity
M. Eichler
Phil. Trans. R. Soc. B 
say that the two graphs are Markov equivalent (with
respect to the global Granger-causal Markov property).
In this case, we will write GwG0.
Now if G and G0 are two consistent graphs such that
G7G0, we prefer G as a graphical representation of the
effective connectivity of XS since it encodes more
information about the dependencies between the
components of XS. Thus, a graphical representation
G is optimal if it is consistent with XS and cannot be
further reduced without violating consistency.
Deﬁnition 4.2. A graph G is minimal in the class of all
graphs consistent with XS if G is consistent and for any other
consistent graph G0 we have G0wG whenever G07G.
In other words, any graph G0 that implies further
Granger-non-causal relations additional to those
implied by a minimal consistent graph G must be
inconsistent with XS.
We illustrate these concepts by application to the
system in (3.1). As before we assume that the
component X4 has not been observed. Figure 8a
displays the corresponding multivariate path diagram
G{1,2,3} associated with the trivariate subprocess
X{1,2,3}, which by theorems 3.1 and 3.2 is consistent
with X{1,2,3}. For the derivation of a minimal consistent
graph G7Gf1;2;3g, we ﬁrst note that the edge 2/1 in
G{1,2,3} can be replaced by the edge 2 
changing the set J(G{1,2,3}) of encoded relations. Thus,
the resulting graph G0 in ﬁgure 8b is Markov equivalent
to G{1,2,3}.
Next, we consider the graph G in ﬁgure 8c, which is
a subgraph of G0 and hence satisﬁes G7G0. Additionally to the relations encoded by G0, this graph G
correctly implies that X3 is bivariately Granger-noncausal for X1 since the only 1-pointing path from 3 to 1
is m-blocked given the empty set. Since it does not
imply any further additional relations among the
components, it is also consistent with X{1,2,3}. The
graph resembles the bivariate path diagram of X{1,2,3}
(ﬁgure 8d), which by theorem 3.4 is also consistent
with X{1,2,3}. Both graphs cannot be further reduced
without violating an existing Granger causality from X3
to X2 or from X2 to X1; therefore, they are minimally
consistent with X{1,2,3}. However, we note that the two
graphs are not Markov equivalent. For example, the bipointing path 1
 2)3/2 in G is m-connecting
given the empty set and hence indicates that X1
bivariately Granger-causes X2. In contrast, the corresponding bi-pointing path 1
bivariate path diagram is m-connecting given {3} and,
hence, indicates that X1 Granger-causes X2 with
respect to X{1,2,3}. In this case, there does not exist
an optimal graphical representation that encodes all
relations that hold for X{1,2,3}.
Finally, we note that the graphs in ﬁgure 8e both
falsely imply that X3 is Granger-non-causal for X1 in a
trivariate analysis and hence are inconsistent with the
process X{1,2,3}.
(b) Identiﬁcation of minimal consistent graphs
In practice, the determination of minimal consistent
graphs must be databased. Recall that if G0 is consistent
with process XS and G0 is another graph such that
G7G0 but G and G0 are not Markov equivalent, then
G implies some Granger-non-causal (or contemporaneous non-correlation) relation that is not encoded in
G0. Thus, we can decide between the two graphs G and
G0 by testing for this relationship. More precisely,
suppose that the graph G implies—in addition to the
relations in J(G0)—that Xa0 is Granger-non-causal for
Xb0 with respect to XA for some A4S and a0, b02A.
Since G0 is consistent with XS, the subseries XA has an
autoregressive representation:
JðuÞXAðt KuÞ C3ðtÞ;
varð3ðtÞÞ Z U;
where the parameters J(u), uZ1,.,p and U are
constrained with respect to the graph G0, that is,
(i) Jba(u)Z0 for uZ1,., p whenever G0 implies that
Xa is Granger-non-causal for Xb with respect to XA
(ii) UabZ0 whenever G0 implies that Xa and Xb are
contemporaneously uncorrelated with respect to
Now, if the graph G is also consistent with XS, we
have additionally that Xa0 is Granger-non-causal for
Xb0 with respect to XA and hence Jb0a0ðuÞZ0 for all
lags uZ1,., p. Thus, we can determine whether G is
consistent with XS by testing the null hypothesis,
H0 : Jb0a0ðuÞ Z 0
for all u Z 1; .; p;
against the alternative:
Ha : Jb0a0ðuÞs0
for some u Z 1; .; p:
Similarly, if G additionally implies that Xa0 and Xb0 are
contemporaneously uncorrelated with respect to XA,
we can test for consistency of G by considering the null
hypothesis H0 : Ua0b0 Z0.
The test is based on ﬁtting a VAR( p) model to the
subseries XA under the constraints (i) and (ii). These
constraints deﬁne a path diagram GAZ(A, EA) for XA
with a/b;EA, if G0 implies that Xa is Granger-noncausal for Xb with respect to XA and a - -- b;EA if G0
implies that Xa and Xb are contemporaneously
uncorrelated with respect to XA. Therefore, the
restricted model can be ﬁtted by using the iterative
procedure for ﬁtting graphical vector autoregressions
described in the Appendix. Noting that for large sample
sizes T the estimates
^JbaZð ^Jbað1Þ; .; ^Jbað pÞÞT are
approximately normally distributed with variance
VJ zvarð ^JabÞ, we obtain, as a test statistic for the
above test problem,
Sba Z T ^J
^V J is an estimate for V. Under the null
hypothesis H0, the test statistic Sba is asymptotically
c 2 distributed with p degrees of freedom.
As an example, we consider again the system (3.1)
which we discussed in the previous section. Recall that
we have found that the graph G0 in ﬁgure 8b is Markov
equivalent to the multivariate path diagram associated
with X{1,2,3} and, thus, is consistent with X{1,2,2}.
Furthermore, we have seen that the graph G in ﬁgure 8c
satisﬁes G7G0. In order to test whether G is consistent
with the data, we note that G0 implies that X1 is
M. Eichler
Evaluating effective connectivity
Phil. Trans. R. Soc. B 
bivariately Granger-non-causal for, and bivariately
contemporaneously uncorrelated with, X3, whereas G
entails that X1 and X3 are completely unrelated. Thus,
the graph G0 leads to the following restricted bivariate
VAR( p) model for X{1,3}
J11ðuÞX1ðt KuÞ
J13ðuÞX3ðt KuÞ C31ðtÞ;
J33ðuÞX3ðt KuÞ C33ðtÞ;
with U13Zcovð31ðtÞ; 33ðtÞÞZ0. For this example, we
hypothesis
H0 : J13ð1ÞZ/Z
J13ð pÞZ0.
Finally, we note that if two graphs G and G0 are
Markov equivalent we cannot decide between the two
graphical representations.
(c) Causal effects and spurious causality
The minimal graphs consistent with a process XS
describe all causal models that can be used for an
explanation of the observed dependencies among the
variables in XS. Therefore, if a directed edge a/b is
present in all minimal consistent graphs, the Grangercausal relationship from Xa to Xb might be in part, but
not completely, attributed to a common explanatory
latent variable. This implies the existence of a causal
inﬂuence of Xa on Xb.
Deﬁnition 4.3 (causal effect). Xa has a causal effect on
Xb if there exists a directed path from a to b in every minimal
causality graph G consistent with XS.
Conversely, if Xa Granger-causes Xb with respect to
some subprocess XS0 of XS (including the case S0ZS),
but there does not exist any directed path from a to b in
all minimal graphs consistent with XS, then this
Granger-causal relationship between Xa and Xb must
be spurious.
Deﬁnition 4.4 (spurious causality). Suppose that Xa
Granger-causes Xb with respect to XS. Then we say that Xa
spuriously causes Xb with respect to XS if no directed path
from a to b exists in any minimal graph consistent with XS.
The concepts presented in this section can be used to
evaluate effective connectivity. We note that it may
happen that the direct and indirect effects of one variable
on another cancel out such that the total effect vanishes.
Under such circumstances, the effective connectivity
differs from the structural connectivity of the system.
Inference about the structural connectivity of a system is
only possible under the assumption that the complete
system XV (including latent variables) is stable
 or faithful with respect
to its associated path diagram GV, that is, a Grangernon-causal relation holds for XV if, and only if, it can be
derived from GV (and the same for contemporaneous
correlation). We note that is not possible to test whether
a system satisﬁes this assumption.
5. APPLICATIONS
(a) Simulated example
For an illustration of the application of the concepts
developed in this paper, we ﬁrst consider simulated
data (lengthZ512) from a four-dimensional system
X1ðtÞ Z a1L1ðt K1Þ C31ðtÞ;
X2ðtÞ Z a2L1ðt K2Þ Ca3L2ðt K1Þ C32ðtÞ;
X3ðtÞ Z a4X4ðt K1Þ Ca5L2ðt K2Þ C33ðtÞ;
X4ðtÞ Z a6X1ðt K1Þ C34ðtÞ;
where the series 3i(t), iZ1,.,4 and Li(t), iZ1, 2 are
independent white noise with mean zero and variance
one. For the simulation, we have set a1Z/Z
In this system, L1 and L2 represent latent
bivariate PDC
multivariate PDC
Figure 9. (a) Multivariate and bivariate partial directed correlations (PDC) for a simulated VAR(2) process X{1,2,3,4}, the
horizontal lines signify pointwise 95% test bounds for the hypothesis that the PDC is zero. (b) Empirically determined
multivariate path diagram for X{1,2,3,4}. (c) Empirically determined bivariate path diagram for X{1,2,3,4}.
Evaluating effective connectivity
M. Eichler
Phil. Trans. R. Soc. B 
variables that were not included in the analysis. For the
remaining four variables X1,.,X4 we have estimated
the partial directed correlations (PDC) pab(u) (cf.
Appendix) with respect to the complete available
information (X{1,.,4}) as well as with respect to
bivariate subprocesses. The estimates are shown in
ﬁgure 9 and suggest that the series can be well
approximated by a VAR model of order 2. Moreover,
the results of the multivariate analysis show ﬁve PDC
that are signiﬁcantly different from zero, which leads to
the multivariate path diagram in ﬁgure 9b. For a
quantitative analysis, we have also performed tests for
Granger causality and contemporaneous non-correlation (table 1), which corroborate the results obtained
from the inspection of the PDC. Similarly, the bivariate
path diagram in ﬁgure 9c has been obtained from the
results of the bivariate analyses. Comparing the two
graphs, we note that all directed edges that are present
in the multivariate path diagram are also included in
the bivariate path diagram. This means that the analysis
of all bivariate subseries does not detect any additional
relations among the components and thus does not
indicate any spurious causalities.
We now examine whether any of the observed
relationships between the variables are due to confounding by latent variables. We ﬁrst consider the
graphs in ﬁgure 10a. Here the left graph G0
a is Markov
equivalent to the multivariate path diagram. Removing
the edge 1/3 we obtain the right graph Ga which,
additionally to the independencies encoded by G0
implies that X1 is Granger non-causal for X3 with
respect to X{1,2,3}. To test whether Ga is consistent with
the data, we follow the procedure described in the
previous section and ﬁt a VAR(2) model to the subseries
X{1,2,3} under the constraints implied be the graph G0
that is, J12ðuÞZJ13ðuÞZJ23ðuÞZ0 for uZ1, 2 and
U12ZU13ZU23Z0. In this model, the null hypothesis
that the subgraph Ga is consistent with the data can
be formulated as H0 : J31ð1ÞZJ31ð2ÞZ0. The corresponding test clearly rejects the null hypothesis (table 2)
and, thus, we conclude that graph Ga is not consistent
with the data.
Table 1. Results of multivariate and bivariate analyses of
simulated data (a) p-values of tests for Granger causality with
respect to X{1,2,3,4}; (b) p-values of tests for bivariate Granger
causality; (c) p-values of tests for multivariate (below
diagonal) and bivariate (above diagonal) contemporaneous
non-correlation.
(a) multivariate Granger causality
(b) bivariate Granger causality
(c) contemporaneous non-correlation
Figure 10. Identiﬁcation of the effective connectivity of the
simulated four-dimensional series X{1,2,3,4}: three graphs
(left) that are Markov equivalent to the multivariate path
diagram in ﬁgure 9b and three subgraphs (right) encoding
that (a) X1 does not Granger-cause X3 with respect to
X{1,2,3}; (b) X1 does not Granger-cause X3 with respect
to X{1,3,4}; and (c) X1 does not bivariately Granger-cause X3.
Table 2. Identiﬁcation of effective connectivity: tests for
consistency of subgraphs Ga and Gb.
test statistic
Figure 11. Partial directed correlations (PDC) between X1
and X3: (a) with respect to X{1,2,3} and (b) with respect to
M. Eichler
Evaluating effective connectivity
Phil. Trans. R. Soc. B 
Alternatively, examination of the PDC between X1
and X3 with respect to X{1,2,3} (ﬁgure 11a) shows a still
signiﬁcant positive inﬂuence of X1 on X3, which
implies that X1 Granger-causes X3 with respect to the
subseries X{1,2,3}. Following the same steps as above
with component X4 substituted for X2 (ﬁgure 10b), we
ﬁnd that the null hypothesis that X1 Granger-causes X3
with respect to X{1,3,4} cannot be rejected (table 2).
This is also indicated by the PDC between X1 and X3
with respect to X{1,3,4}, which vanishes completely
(ﬁgure 11b). Consequently, the graph Gb is consistent
with X{1,2,3,4}. Further examination shows the graph is
also minimally consistent with X{1,2,3,4}.
Finally, we consider the right graph in ﬁgure 10c
which encodes that X1 is bivariately Granger-noncausal for X3. Since this contradicts the results of the
bivariate analysis of X{1,3} it follows that this graph is
inconsistent with X{1,2,3,4}.
From deﬁnitions 4.3 and 4.4, we conclude that the
causality from X2 to X3 is spurious whereas the
association between X4 and X3 is due to a causal effect
of X4 on X3. In contrast, neither a causal effect nor
spurious causality can be established for the directed
edges from 1 to 2 and from 1 to 4, since each of them
may be replaced by a dashed directed edge 
changing the Markov properties of the graph.
(b) Application to fMRI data
In this section, we apply the methods discussed in this
paper to a seven-dimensional time-series obtained from
concurrent recordings from EEG and fMRI. The EEG
was sampled at 200 Hz from an array of 16 bipolar
pairs, with an additional channel for the EEG and scan
trigger. The fMRI series were measured with a time
resolution of 2.5 s at six slice planes (TRZ4 mm, skip
1 mm), with the second most inferior slice oriented
through the anterior commissure–posterior commissure (AC–PC) line. The data and their requisition are
described in detail in Goldman et al. . Informed
consent was obtained from the volunteers based on a
protocol previously approved by the UCLA Ofﬁce for
the Protection of Research Subjects.
For the analysis, the time-varying spectrum of
the EEG has been decomposed by parallel factor
(PARAFAC) analysis into trilinear components (called
atoms), each being the product of spatial, spectral and
temporal factors. The PARAFAC analysis extracted
three signiﬁcant atoms characterized by their spectral
signature. Only the temporal factor of the alpha atom
corresponding to a frequency range of 8–12 Hz was
included in the effective connectivity analysis.
The fMRI data are time-series of length TZ108 for
six regions in the brain whose activation was correlated
with the EEG alpha atom: visual cortex, thalamus, left
and right insulae and left and right somatosensory
areas. The time-series for each region was obtained by
averaging the time-series of all voxels in that region. For
details about preprocessing the data, we refer to
Martı´nez-Montes et al. . The use of PARAFAC
analysis in analysing three-dimensional EEG data
(space, time and frequency) is described in Miwakeichi
et al. .
For the determination of the Granger-causal
relationships among the seven series, a vector autoregressive model of order pZ1 was ﬁtted to the data.
The model order has been determined by minimization
visual cortex
left insula
right insula
left somatosensory
right somatosensory
EEG alpha atom
bivariate PDC
multivariate PDC
Figure 12. Multivariate and bivariate partial directed correlations (PDC) for fMRI and EEG data computed from graphical VAR
models; the horizontal lines signify pointwise 95% test bounds for the hypothesis that the PDC is zero.
Evaluating effective connectivity
M. Eichler
Phil. Trans. R. Soc. B 
of the Akaike’s information criterion (AIC) (Lu¨tkepohl
AICð pÞ Z 1
2 logj ^Spj C r
where ^Sp is the estimate for the covariance matrix of
3(t) and r is the number of parameters for the model.
From the parameter estimates, the corresponding PDC
with respect to the complete series have been computed
(ﬁgure 12, below diagonal). Similarly, estimates for the
bivariate PDC have been obtained by ﬁtting vector
autoregressive models of order pZ2, where the order
has been chosen so that the AIC criterion is minimized
for most bivariate analyses (ﬁgure 12, above diagonal).
For the identiﬁcation of the multivariate path
diagram, we have performed a series of tests for
pairwise Granger non-causality and contemporaneous
non-correlation; the results of the tests are given in
table 3 and the resulting multivariate path diagram is
depicted in ﬁgure 13. Similarly, the bivariate path
diagram could be obtained by testing for bivariate
Granger non-causality and bivariate contemporaneous
non-correlation. Due to the large number of edges in
this graph, it would be difﬁcult to draw any inferences
from the bivariate path diagram and we therefore omit
it. The results of the tests are also given in table 3.
The multivariate path diagram most notably shows
that the EEG alpha atom has a direct inﬂuence on the
thalamus and visual cortex only, while the BOLD
responses in the other regions are only inﬂuenced
indirectly. This indicates that the brain regions involved
in the generation of the ‘EEG alpha rhythm’ are
primarily located in the thalamus and visual cortex and
corroborates previous ﬁndings by Goldman et al.
 and Martı´nez-Montes et al. , who
identiﬁed the parieto-occipital cortex and thalamus as
generators of the ‘alpha brain rhythm’. Comparing
these ﬁndings with the results of the bivariate analysis
in table 3b,c, we ﬁnd that although the EEG alpha atom
shows an inﬂuence on all cortical brain regions, the
positive correlation between the EEG alpha atom and
the BOLD response in the thalamus is no longer
signiﬁcant. This suggests that the Granger causality
from EEG alpha atom to thalamus is spurious.
For a more detailed analysis of the effective
connectivity, we ﬁrst note that neither in the multivariate nor in the bivariate analyses, the EEG alpha
atom, the visual cortex and the thalamus seem to be
affected by the remaining four brain regions. We
therefore may restrict our analysis to these three
components. Figure 14a,b displays the corresponding
Table 3. Results of multivariate and bivariate analyses of simulated data (a) p-values of tests for multivariate Granger causality;
(b) p-values of tests for bivariate Granger causality and (c) p-values of tests for multivariate (below diagonal) and bivariate (above
diagonal) contemporaneous non-correlation.
(a) multivariate Granger causality
(b) Bivariate Granger causality
(c) contemporaneous non-correlation
Figure 13. Multivariate path diagram for concurrent EEG
and fMRI data empirically determined by the tests for
Granger causality and contemporaneous non-correlation in
table 3a,c.
M. Eichler
Evaluating effective connectivity
Phil. Trans. R. Soc. B 
multivariate and bivariate path diagrams G(m) and G(b),
respectively; the former has been obtained following
the same steps as above (order pZ2), while the latter
has been directly derived from the bivariate results in
table 3. Here, the multivariate path diagram G(m)
implies that the thalamus and the visual cortex neither
Granger-cause the EEG alpha atom nor are they
contemporaneously correlated with the EEG component, while the bivariate path diagram G(b) additionally encodes that, ﬁrst, the EEG alpha atom does not
bivariately Granger-cause the thalamus and second, the
visual cortex and thalamus are bivariately contemporaneously uncorrelated. Thus, we have GðbÞ7GðmÞ.
Furthermore, since, according to theorem 3.4, the
bivariate path diagram is consistent with the data and
already encodes all empirically determined relations
among the variables, we conclude that the bivariate
path diagram G(b) is minimally consistent with the data.
Replacing the edge TH 
VC with TH/VC, we
obtain another graph G0 which is Markov equivalent to
G(b) and, hence, is also minimally consistent with the
data (ﬁgure 14c). Simple considerations show that no
further minimally consistent graph exists.
The minimally consistent graphs show that the
correlation between EEG alpha atom and thalamic
BOLD responses observed in a multivariate analysis
attributed
TH mediated by the visual cortex.
This is in line with the results by Martı´nez-Montes et al.
 , who identiﬁed the visual cortex as the source of
the EEG alpha rhythm. However, note that, contrary to
the explanation provided by Martı´nez-Montes et al.
 , we ﬁnd that EEG and visual cortex are
negatively correlated while the PDCs that correspond
to the link from the visual cortex to the thalamus are
positive. Since the intermediate vertex is a collider, the
combined correlation is negated resulting in a positive
correlation for the pathway. This effect of changing
sign can also be observed in ﬁgure 8, where the pathway
3 lead to an overall negative correlation
 .
Finally, we note that the contemporaneous correlation between the thalamus and the visual cortex in a
multivariate
The analysis suggests a causal inﬂuence of the EEG
on the visual cortex. This ‘causal ordering’ is most
likely due to the fact that brain activity, which is
instantaneously reﬂected in the EEG measurements,
takes much longer to be reﬂected in the fMRI. Thus,
the analysis allows no conclusions about the causal
ordering of the EEG and the fMRI component.
Furthermore, we note that it is not possible to
determine whether the link between the EEG alpha
atom and the visual cortex is due to direct confounding
since the Markov properties of the graph would not be
changed if the directed edge between the EEG alpha
atom and the visual cortex were replaced by dashed
directed edge.
A serious limitation of effective connectivity analysis
from time-resolved fMRI data in general is the short
sample size; in the example above only 108 measurements were available. Consequently, only strong
correlations among the components show up signiﬁcantly in an analysis. This particularly affects the
identiﬁcation of indirect pathways as needed for the
distinction between direct and spurious causality. For
instance, in our discussion of the four-dimensional
system (3.1) in §3a, we have derived the autoregressive
representation of the trivariate subseries X{1,2,3}. Here,
the coefﬁcient F13(2), which corresponds to the
m-connecting pathway 3/2)4/1 was of the form
abg/(1Cb2). Since all coefﬁcients were smaller than
one, the Granger-causal effect of X3 on X1 is much
smaller than the other links between the components.
In an analysis with small sample size such correlations
can easily become insigniﬁcant and thus hamper the
identiﬁcation of the effective connectivity of the system.
6. CONCLUSION
In this paper, a new graphical approach for the analysis
of causal relationships in multivariate time-series has
been presented. In particular, this approach allows the
comparison of multivariate and bivariate Granger
causality, both of which are frequently used in brain
imaging to resolve functional relationships between
brain areas from EEG or fMRI time-series data. We
have shown that both concepts may provide useful
information that cannot be obtained by the other.
Our discussion has also shown that the effective
connectivity of systems that may be affected by
unmeasured latent variables cannot be resolved
by multivariate and bivariate analyses alone, but only
by examination of Granger-non-causal relations with
respect to all subseries. To this end, we have generalized
the idea of multivariate and bivariate path diagrams
and introduced mixed graphs that can be used to
visualize the effective connectivity of such systems.
Currently, the identiﬁcation of such graphical
representations is based on a multi-step procedure
where each step requires the ﬁtting of a new
autoregressive model. As a consequence, it is impossible to compare two graphical representations of the
effective connectivity and test between them. Furthermore, the statistical errors in different steps may lead to
contradictory results. Therefore, future research aims
at the development of new graphical time-series models
with dependencies that are constrained by general path
The author wishes to thank Robin Goldman and Mark
Cohen, who conducted the EEG–fMRI experiments discussed in §5, and Pedro Valde´z-Sosa and Eduardo Martı´nez-
Montes for providing the data and many helpful comments.
Figure 14. Identiﬁcation of effective connectivity between the
EEG alpha atom, the visual cortex and the thalamus: (a)
multivariate path diagram; (b) bivariate path diagram; (c)
extended path diagram. The graphs in (b) and (c) are Markov
equivalent and minimally consistent with the data.
Evaluating effective connectivity
M. Eichler
Phil. Trans. R. Soc. B 
APPENDIX A: STATISTICAL INFERENCE
For the analysis of empirical data, VAR(p) models can
be ﬁtted using least-squares estimation. For observations XV (1),.,XV (T ) from a d-dimensional multiple time-series XV, let ^RpZð ^Rpðu; vÞÞu;vZ1;.;p be the
pd!pd matrix composed by submatrices
^Rpðu; vÞ Z
Xðt KuÞXðt KvÞT:
Similarly, we set ^rpZð ^Rpð0; 1Þ; .; ^Rpð0; pÞÞ. Then the
least-squares estimates of the autoregressive coefﬁcients are given by
ð ^RpÞK1ðu; vÞ^rpðvÞ;
for uZ1,.,p, while the covariance matrix S is
estimated by
^3ðtÞ^3ðtÞT;
where ^3ðtÞZXðtÞKPp
uZ1 FðuÞXðtKuÞ are the leastsquares residuals. The estimates are asymptotically
normally distributed; for details we refer to Lu¨tkepohl
The coefﬁcients Fab(u) depend, like any regression
coefﬁcient, on the unit of measurement of Xa and Xb
and, thus, are not suited for comparisons of the
strength of causal relationships between different
pairs of variables. Therefore, Eichler proposes
partial directed correlations as a measure of the
strength of causal effects. For uO0 (uZ0) the partial
directed correlation pab(u) is deﬁned as the correlation
between Xa(t) and Xb(tKu) after removing the linear
effects of
XVðtK1ÞnfXbðtKuÞgð XVðtK1ÞÞ while for
u!0 we have pabðuÞZpbaðKuÞ. It is further shown that
for uO0, estimates for the partial directed correlations
pab(u) can be obtained from the parameter estimates of
a VAR( p) model by rescaling the coefﬁcients Fab(u)
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
^Saa ^tabðuÞ
^tabðuÞ Z ^Kbb C
^FkbðvÞ ^K kl ^FlbðvÞ C
with ^K Z ^S
K1. For uZ0, we obviously have
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
For large sample length T, the partial directed
correlations are approximately normally distributed
with mean pab(u) and variance 1/T.
Tests for Granger causal relationships among the
asymptotic
distribution
parameters
model. More precisely, let
^Vðu; vÞZð ^RpÞK1
bb ðu; vÞ ^Saa
asymptotic
covariance
corresponding p!p matrix. Then the existence of
a Granger causal effect of Xb on Xa can be tested by
evaluation of the test statistic
^FabðuÞ ^FabðvÞð ^V
K1Þðu; vÞ:
Under the null hypothesis that Xb is Granger noncausal for Xa with respect to XV, the test statistic Sab
is asymptotically c2 distributed with p degrees of
More generally, inference on causal structures
should be based on ﬁtting graphical vector autoregressive models. For given graph G and order p, the
parameters of the VAR(p, G) model can be computed
iteratively from the following two steps. First, for the
given estimate ^S, the estimates ^FabðuÞ are determined
as the solution of the linear equation system:
K1FðvÞ ^Rpðu; vÞ
K1 ^Rpð0; vÞÞab;
for uZ1,.,p and a, b2V such that b/a in G under
the constraints that Fab(u)Z0 whenever the directed
edge b/a is absent in the graph G. Second, the
^S is obtained by solving the nonlinear
equation system,
ðSK1Þab Z ðSK1 ^S0SK1Þab;
for a, b2V such that b -- -a in G, where ^S0Z 1
^3ðtÞ^3ðtÞT is the unconstrained estimate for the covariance matrix of the residuals ^3ðtÞ. The second step
corresponds to ﬁtting a covariance model to the
residuals ^3ðtÞ, which is determined by the zero
constraints on the covariance matrix S. An iterative
algorithm for ﬁtting such covariance models has been
introduced by Drton & Richardson . Since the
solutions for both sets of equations are not independent, an iteration of the two steps is needed to obtain a
joint solution. The ﬁtting of graphical vector autoregressive models will be described in more detail in a
forthcoming paper.