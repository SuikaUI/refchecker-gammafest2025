Intermittent Demand Forecasting with Deep Renewal
Ali Caner Türkmen
Department of Computer Engineering
Bo˘gaziçi University
Istanbul, Turkey
 
Yuyang Wang
AWS AI Labs
2100 University Ave
East Palo Alto, CA, US
 
Tim Januschowski
AWS AI Labs
Krausenstrasse 38,
Berlin, Germany
 
Intermittent demand, where demand occurrences appear sporadically in time, is
a common and challenging problem in forecasting. In this paper, we ﬁrst make
the connections between renewal processes, and a collection of current models
used for intermittent demand forecasting. We then develop a set of models that
beneﬁt from recurrent neural networks to parameterize conditional interdemand
time and size distributions, building on the latest paradigm in “deep” temporal point
processes. We present favorable empirical ﬁndings on discrete and continuous time
intermittent demand data, validating the practical value of our approach.
Introduction
Large parts of inventory catalogs in e-commerce, manufacturing, and logistics are plagued by “intermittency,” where positive demand occurs sporadically in time . Concretely, intermittent
demand forecasting (IDF) focuses on demand time series, i.e., instantiations of discrete-time nonnegative stochastic processes, which characteristically contain long consecutive runs of zeroes. Apart from
rendering most standard forecasting methods impractical, IDF raises questions on forecast accuracy
measures, model selection, model ensembling, etc. Moreover, intermittent patterns likely appear in
slow-moving, high-value items that are critical to production processes, such as spare or specialty
parts in aerospace, maritime, and defense . Accurate forecast uncertainty estimates—i.e., having
access to forecast distributions—are markedly important in the context of IDF, where inventory
control is inherently difﬁcult and consequential.
Figure 1: Comparing a non-intermittent count time series (above), and intermittent demand time
series (below).
The standard approach to IDF, and the ﬁrst paper to address it, is the method of Croston . Croston’s
method is a rather simple heuristic, forecasts are generated by independently applying exponential
smoothing to the amounts of consecutive non-zero demand, and to the times elapsed in between
each (i.e., interarrival or interdemand times). Towards developing forecast distributions, models
built on a set of constrained statistical assumptions inspired by Croston’s method were attempted
in . Another important aspect is that, the traidional approach (Croston and others)
is local, meaning that each time series has its own model and thus no information is shared across
 
time series. Our approach is global, learning from all to reach the statistical tail from the sparse
signal that each intermittent demand time series supplies. For more discussions on the paradigm shift
from the traditional to modern approaches for time series forecast, we encourage interested readers
to 
In this work, we ﬁrst focus on the link between renewal processes and existing approaches to IDF.
Interestingly, although these models have appeared in the backdrop of manufacturing and spare
parts (renewals), connections have seldom been drawn. We then point out that many existing IDF
models can be seen as instantiations of marked self-modulating renewal processes in discrete-time.
By replacing the conditional distribution function with recurrent neural networks, we can specify a
family of ﬂexible models for IDF, akin to some continuous-time processes that have appeared recently
in the machine learning literature .
Our contributions are three-fold. First, we show the connections between intermittent demand
problems and renewal processes, two areas in applied statistics that have dealt with temporal sparsity,
and have appeared in the context of planning spare parts inventories in manufacturing. Secondly,
we cast Croston-like models as instances of discrete-time conditional (Markov) renewal processes.
Through this observation, we introduce recurrent neural networks to recover more ﬂexible ways in
which renewal processes are modulated. Finally, we extend our construction in the context where the
individual demand events are observed in continuous time. By making connections to continuous
time renewal processes and deep temporal point processes, we study how these models apply in the
IDF context.
Preliminaries
We consider nonnegative integer-valued processes in discrete-time denoted {Yn}n∈{1,2,··· }, Yn ∈
N≥0, where n indexes demand review periods. As many Yn are zero, we introduce the additional
index i for periods where Yn > 0. More formally, we have the one to one map σ(i) = min{n |
m=1[Yn > 0] ≥i}. We denote interdemand times Qi, as the number of periods between
consecutive demand points, and Mi = Yσ(i) are the corresponding demand sizes. That is, Qi =
σ(i) −σ(i −1) taking σ(0) = 0. Random variables Mi, Qi, both deﬁned on positive integers, fully
determine Yn and vice versa. We will let ˆYn+1 refer to a forecast of Yn+1, i.e., an estimator of the
conditional mean E [Yn+1|Y1:n = y1:n].
Croston heuristically proposed to produce forecasts by separately performing SES on interdemand
times and demand sizes. Concretely,
Mi+1 = αMi+1 + (1 −α) ˆ
ˆQi+1 = αQi+1 + (1 −α) ˆQi.
That is, exponentially weighted moving average (EWMA) are employed separately on the two time
Several authors have taken the same approach—specifying the random process through inter-demand
times and sizes—as the basis of underlying statistical models . Croston’s original
proposed model was taking Mi, Qi as i.i.d., an assumption clearly at odds with the forecast equations
of (1). Others proposed to use the EWMA recursion directly to parameterize the conditional
distributions of Qi, Mi. For example, taking,
Mi+1 ∼PO( ˆ
Qi+1 ∼G( ˆQi),
Mi, ˆQi denote EWMA as deﬁned in (1), and PO, G denote Poisson and geometric distributions
respectively.1
Here, we observe that taking Qi i.i.d. equivalently speciﬁes a renewal process in discrete time.2
In the same light, the model speciﬁed in (2) can be cast as a speciﬁc Markov renewal process in
discrete time , or a self-modulating renewal process where the time to the next event depends on
a function of previous occurrences.
1All distributions in this work are parameterized by their means, which we take as the ﬁrst parameter.
2This is a rare setting for renewal processes. Yet, some of the earlier works on renewal theory are based on
the discrete-time formalism. See, e.g., .
Proposed Models
In this section, we propose a novel framework in both discrete and continuous time scenarios.
Discrete-Time Deep Renewal Processes
We start by extending the generic IDF model, given in (2) along two directions.
Recurrent Neural Networks The EWMA, or exponential smoothing, is a forecast function that
often appears in the forecasting literature. Apart from favorable properties such as ensuring temporal
continuity, and arising as the optimal forecasts to an integrated moving average process; it is just
a functional form that has the important property that it admits recursive computation. Indeed, the
same is true for recurrent neural networks which could equivalently be used to replace the EWMA,
and serve as an approximator for a more general modulating function for the next event’s time.
Furthermore, the RNN could be conditioned on previous demand sizes along with interdemand times,
at a negligible additional computational cost.
Interarrival Time Distributions To the best of our knowledge, previous studies in IDF have relied
on the geometric distribution for modeling interdemand times. Analogously to the case of exponential
interarrival times in Poisson processes, this imposes the assumption that demand arrivals are completely random. Nevertheless, intermittent demand series often exhibit autocovariance . Here, we
use RNNs to parameterize a negative binomial distribution of interdemand times, a choice that affords
ﬂexibility in capturing effects such as aging, negative aging (clustering), and quasi-periodicity—all
of which can reasonably be expected to manifest in demand observations.
Concretely, we propose the following Discrete-Time Deep Renewal Process setting
Qi ∼NN (gq(hi))
Mi ∼NN (gm(hi))
hi = LSTMΘ(hi−1, Qi, Mi),
where hi denotes the state given by a long short-term memory RNN , and NN speciﬁes a generic
probability distribution deﬁned on positive integers (possibly with other parameters), and g. denote
suitable projections from the space of vectors hi to the space of parameters (means) of the respective
distributions.
Continuous-Time Renewal Processes
Demand data is most often available along a discrete, uniformly sampled grid in time, or demand
review periods. For non-intermittent demand, this is a useful abstraction as it provides the required
level of accuracy for most inventory control decisions downstream. However, intermittent demand
data often arises as an artifact of discretizing demand point occurrences, localized in continuous time,
along a dense temporal grid. Here, intuitively, discretization error plays a larger role. Moreover, in
more demand forecasting scenarios, exact timestamps are available for individual purchase events—
such as in e-commerce.
Let j index individual demand events, such as purchase orders or e-commerce transactions, ˜Qj ∈R+
the interarrival times between such events and ˜
Mj ∈N the demand sizes. Analogously to their
discrete-time counterparts, continuous time demand occurrences can be modeled simply by assuming
a nonnegative continuous distribution for interarrival times, such as the exponential or the gamma
distribution, setting
˜Qj ∼NR (gq(hi))
Mj ∼NN (gm(hi))
hi = LSTMΘ(hi−1, ˜Qj, ˜
where NR is a distribution deﬁned on nonnegative reals. This construction recovers recurrent marked
temporal point processes (RMTPP) .3
Our model allows easy implementation, ﬂexibility, and fast computation as self-modulating renewal
processes admit likelihood-based inference in time linear in the number of events (as opposed to
more general conditional intensity point processes). We give a summary of the models tested in this
paper in Table 3.2.
3We should note two differences. RMTPP parameterizes the conditional intensity function of a selfmodulating renewal process, rather than the conditional demand time distribution. Also, their paper deals with
the case of categorical marks, while we cast demand sizes as marks.
Recurrence
Static Croston Model 
N/A (i.i.d.)
Modiﬁed Croston Model 
Discrete Time DRP
Negative Binomial
Negative Binomial
Continuous Time DRP
Negative Binomial
Table 1: Models tested, speciﬁed in terms of interarrival time, demand size distributions and the
recurrence relation used to parameterize these (conditional) distributions
Experiments
We evaluate our model on two real-world datasets. The Parts data set is the standard common task
in IDF , and consists of 1046 aligned time series of 50 time steps each, representing monthly
sales for different items of a US automobile company. We also report results on the UCI retail data
set , in which timestamps of individual demand events (continuous-time data) are available.
We implement and train continuous and discrete-time deep renewal process (DRP) models on Apache
MXNet , using MXNet Gluon Adam optimizer for training. We use a single hidden layer of 10
hidden units, use the softplus function for mapping the LSTM embedding to distribution parameters.
Most importantly, we learn a global RNN, i.e., LSTM parameters are shared across different time
For evaluation, we use the quantile loss to evaluate probabilistic forecasts. For a given quantile
ρ ∈(0, 1), the ρ-quantile loss is deﬁned as
QLρ(Yt, bYt(ρ)) = 2
ρ · (Yt −bYt(ρ))IYt−bYt(ρ)>0 + (1 −ρ) · (bYt(ρ) −Yt)IYt−bYt(ρ)⩽0
We compare our models to static and modiﬁed Croston models, where we take forward samples from
selected models to generate probabilistic forecasts. Table 2 summarizes our results.
Static Croston Model 
Modiﬁed Croston Model 
Discrete Time DRP
Continuous Time DRP
Table 2: Results on benchmark datasets
DRPs signiﬁcantly outperform baseline methods on both losses. The beneﬁt of using continuous-time
DRPs can be tested only on the UCI data set, for which our results are inconclusive.
Conclusion and Future Direction
Our paper addresses intermittent demand forecasting using DRPs, a class of models inspired by
a connection drawn between intermittent demand problems, renewal processes, and existing deep
TPP literature . We ﬁnd encouraging empirical results, partially presented here, on real-world
intermittent demand data. Validating our approach on a broader array of IDF data sets remains a
next step to our work, as well as comparing to other approaches, such as DeepAR (with Negative
Binomial likelihood) , and non-parametric time series models (NPTS) .