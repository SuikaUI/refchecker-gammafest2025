Machine-learning based interatomic potential for amorphous carbon
Volker L. Deringer1, 2, ∗and G´abor Cs´anyi1
1Engineering Laboratory, University of Cambridge, Trumpington Street, Cambridge CB2 1PZ, UK
2Department of Chemistry, University of Cambridge, Lensﬁeld Road, Cambridge CB2 1EW, UK
 
We introduce a Gaussian approximation potential (GAP) for atomistic simulations of liquid and
amorphous elemental carbon. Based on a machine-learning representation of the density-functional
theory (DFT) potential-energy surface, such interatomic potentials enable materials simulations
with close-to DFT accuracy but at much lower computational cost. We ﬁrst determine the maximum accuracy that any ﬁnite-range potential can achieve in carbon structures; then, using a novel
hierarchical set of two-, three-, and many-body structural descriptors, we construct a GAP model
that can indeed reach the target accuracy. The potential yields accurate energetic and structural
properties over a wide range of densities; it also correctly captures the structure of the liquid phases,
at variance with state-of-the-art empirical potentials. Exemplary applications of the GAP model to
surfaces of “diamond-like” tetrahedral amorphous carbon (ta-C) are presented, including an estimate
of the amorphous material’s surface energy, and simulations of high-temperature surface reconstructions (“graphitization”). The new interatomic potential appears to be promising for realistic and
accurate simulations of nanoscale amorphous carbon structures.
INTRODUCTION
Carbon is among the most intriguing elements due to
its structural diversity, and its solid-state forms range
from diamond and graphite via many more complex
allotropes1–3 onward to amorphous phases (a-C). The
atomic structures of a-C samples depend strongly on density and are characterized by the coexistence of threefold
(“sp2”) and fourfold bonded (“sp3”) carbon atoms. In
this sense, low- and high-density forms of a-C are loosely
reminiscent of graphite and diamond, respectively, but
the actual situation is much more complex (Fig. 1).
“Tetrahedral amorphous” carbon (ta-C), the dense, sp3rich form, is of particular technological interest due to its
attractive mechanical properties.4–6
Atomistic simulations have long been providing useful insight into a-C materials.10 Many empirical interatomic potentials exist for carbon, from the original
Tersoﬀ11 and Brenner12 formulations to more recent developments, including an environment-dependent interaction potential (EDIP),13 improved reactive bond-order
(REBO) potentials,14,15 or a recently re-parametrized reactive force ﬁeld (ReaxFF);16 a comprehensive comparative study of such potentials was very recently carried
out.8 These fast potentials make large-scale moleculardynamics (MD) simulations possible, and have been applied to engineering problems such as fracture17 or friction and wear of ta-C coatings;18 they are eﬃcient enough
to perform thin-ﬁlm deposition simulations,19 thus directly mirroring the atomic-scale processes in experiments.
Nonetheless, these potentials remain empirical
in nature, and may have serious shortcomings: prominent examples are an underestimated concentration of
sp3-bonded atoms in ta-C,15 and poor description of surfaces. A general problem of empirical potentials is the
inevitable compromise in accuracy for predicting diﬀerent material properties.
On the other hand, seminal studies based on tightbinding schemes20–22 as well as density-functional theory
(DFT)23–26 early on aﬀorded atomistic structure models of a-C, and more recent DFT-MD studies dealt with
applications in photovoltaics27 or coatings.28 Furthermore, liquid carbon has been of interest—for example,
in ﬁrst-principles studies of the diamond melting line
which is diﬃcult to evaluate experimentally.29 Despite
their usefulness, however, DFT-based methods are limited to quite small system sizes, and even with the computational power available nowadays, they are limited
in practice to a few hundred atoms. This makes many
of the above scenarios simply inaccessible to predictive
DFT-quality simulations.
To bridge the long-standing gap between these two
realms, a novel class of simulation methods has recently
emerged which is based on machine learning (ML). The
key idea is to map a set of atomic environments directly
onto numerical values for energies and forces; these quantities are “trained” from a large and accurate quantummechanical reference database but subsequently interpolated using the ML algorithm.
If training is successful, this makes atomistic simulations close to quantummechanical accuracy accessible but requires less computational eﬀort by many orders of magnitude.
implementations use high-dimensional artiﬁcial neural
networks,30–32 compressed sensing,33 or Gaussian process
regression.34 Interatomic ML-based potentials have been
developed for several prototypical solids30–39 and applied,
e.g., in studies of phase transitions.40 We mention in
passing that ML schemes are currently being developed
to estimate other fundamental properties of molecules
and solids, including atomization energies,41 multipolar
polarization,42 band gaps,43 or NMR parameters.44 A recent tutorial review of the ﬁeld is in Ref. 45.
Previous ML potentials have been created for the crystalline carbon allotropes diamond and graphite,34,36 but
as those were trained on a small region of conﬁguration space, they are not suitable for simulating a-C. InarXiv:1611.03277v1 [cond-mat.mtrl-sci] 10 Nov 2016
2.0 g cm–3
2.5 g cm–3
3.0 g cm–3 (ta-C)
3.5 g cm–3
1.5 g cm–3
open structures
rich in sp/sp2 carbon
dense structures
rich in sp3 carbon
FIG. 1. Exemplary a-C structures at various densities, obtained in 216-atom cells from DFT melt–quench simulations. Note
the gradual transition from open to dense networks, and the coexistence of twofold (“sp”; yellow), threefold (“sp2”; green),
and fourfold (“sp3”; blue) coordinated carbon atoms. The open, low-density structures are metastable and on much further
annealing will form more sp2-rich networks;7,8 here, on purpose, we focus on the as-quenched structures shown, to assess as
diverse local environments as possible. Bonds are drawn up to a maximum interatomic distance of 1.85 ˚A, and coordination
numbers are determined using the same cutoﬀ. Structures were visualized using AtomEye.9
deed, the only reported ML potential dealing with amorphous matter is a neural-network potential for the phasechange data-storage material GeTe46 that enabled largescale simulations of thermal transport47 and atomistic
processes during crystallization.48 Amorphous materials
are structurally much more diverse than their crystalline
counterparts, and despite the lack of long-range translational symmetry, their properties depend crucially on
structural order on the local and intermediate length
scales.49 The required large unit cells and the long relaxation times make it very diﬃcult to use DFT simulations for amorphous materials of practical interest.46,50
The latter are hence particularly promising targets for
high-quality ML potentials.
In this work, we introduce an interatomic Gaussian
approximation potential (GAP) for condensed-phase elemental carbon, with particular focus on liquid and amorphous phases of various densities. First, we systematically determine the maximum accuracy that any ﬁniterange interatomic potential for carbon can achieve as a
function of its neighbor cutoﬀ, independently of how it is
ﬁtted. Then, we show that our GAP does indeed reach
this accuracy, and furthermore provides reliable structural and topological data that agree well with the computationally much more demanding DFT benchmarks.
Finally, we show predictions for energies and structures
of ta-C surfaces, which play a key role in fracture and
wear processes.
The Gaussian approximation potential (GAP)34,51
is an ML approach to atomistic materials modeling,
whereby an interatomic potential for the given material is “trained” from a database of reference quantummechanical data, and is then used to interpolate energies
and forces for arbitrary structures.
In order to make
simulation of large systems feasible, the total energy is
broken down into a sum of local contributions, given by
an local energy function ε.
This function is expanded
in a basis set adapted to the input database; it is generated using a kernel function, or similarity measure of
neighbor environments. The choice of this kernel (and
the symmetries it obeys) is critical for the success of any
ML potential.52
Previous ML potentials for solids used a decomposition into atomic energies, and employed many-body descriptors to represent the atomic neighbor environment—
comprising all neighbors of an atom up to a given cutoﬀradius.34,53–56 However, for a complete description of
these atomic environments one must ﬁt the atomic energy function in a high-dimensional space. This leads to
poor “extrapolation”, that is, to a poor ﬁt in regions of
conﬁguration space far away from any data points. A
long simulation will likely ﬁnd such regions—especially
at high temperatures, and/or when disorder is large. Indeed, in the present case of a-C, we encountered problems early during training when using a single many-body
descriptor only: MD runs driven by such GAP models
showed atoms aggregating at unreasonably small (sub-
˚A) distances. This is a very general challenge during the
development of high-dimensional ML potentials, which
carry the risk of erroneous extrapolation behavior unless
carefully tested and used.
In this work, we generalize the many-body GAP approach for solids: we retain the many-body terms but
augment them with two- and three-body “descriptors”—
distances between atoms and angles in triplets. The latter terms hence represent two- and three-body interactions as in traditional (empirical) interatomic potentials,
but now all descriptors and associated local-energy con-
tributions are part of the same ML framework. Our starting point is thus the following expression for the total
ε(2b)(q(2b)
j ∈triplets
ε(3b)(q(3b)
ε(MB)(q(MB)
where “2b”, “3b”, and “MB” denote two-, three-, and
many-body interactions, respectively.
This is similar
in spirit to the recently introduced Moment Tensor
Potentials,56 and also to another scheme that uses a parametric two-body term in combination with a neural network that describes the many-body interactions57.
In the above expression, the δ are scaling parameters,
and each corresponds to the distribution of energy contributions a given interaction term has to represent. We
choose the largest value for the 2b terms, which describe
the largest share of the total energy; on top of that, we
add a 3b term, and ﬁnally the many-body term with the
smallest δ(d).
The local energy corresponding to each descriptor d ∈
{2b, 3b, MB} is given by a linear combination of kernel
functions34
ε(d)(q(d)) =
t K(d)(q(d), q(d)
where t denotes one of Nt training conﬁgurations qt, each
of which attains a weighting coeﬃcient αt during ﬁtting,
and K is a covariance kernel which quantiﬁes how similar
the input conﬁguration q is to the t-th training conﬁguration, qt. In practice, we sparsify the representation
and only allow the sum to range over a number of “representative points” drawn from the full training database
(Nt ≪Nfull). The number of representative points differs for each descriptor and must be carefully controlled
during training.
Both for 2b and 3b contributions, we use a squared
exponential kernel,34
where ξ is an index running over the components of the
descriptor vector q(d). In the case of pairs, the descriptor
has one single scalar component (namely, the distance r12
between the two atoms involved):
q(2b) = |r2 −r1| ≡r12 ;
for triplets, we do not directly use the natural coordinates
r12, r13, and r23, but a diﬀerent form to enforce symmetry
over permutation of the neighbor atoms 2 and 3:51
(r12 −r13)2
Note that with this choice of descriptors, the ﬁrst term
in Eq. 1 is equivalent to a pair potential, and the second
is a generic three-body potential, but in the GAP framework both do not impose constraints on the speciﬁc functional form.
For the many-body term, we use the recently introduced Smooth Overlap of Atomic Positions (SOAP)52 descriptor, which has proven successful in generating GAP
models for tungsten,39 in classifying diverse molecular
and solid-state structures,58 and very recently in constraining structural reﬁnements of amorphous Si.59 We
brieﬂy review the most pertinent features; detailed formulae and derivations are in Ref. 52. SOAP starts from
the neighborhood density of a given atom a, deﬁned as
−(r −rab)2
× fcut(rab),
where the sum is over neighboring atoms, and the cutoﬀfunction fcut, which ensures compact support, goes
smoothly to zero at rcut over a characteristic width r∆.
The parameter σat ultimately controls the smoothness of
the potential. The neighbor density is expanded into a
local basis of orthogonal radial basis functions gn and
spherical harmonics Ylm,
nlm gn(r)Ylm(ˆr),
and the expansion coeﬃcients are used to form the spherical power spectrum,
which is invariant both to permutations over neighbors
and to 3D rotations of the neighbor environment. We use
the elements of a ﬁnite truncation of the power spectrum
(up to n ≤nmax and l ≤lmax) as components of the
many-body descriptor vector q(MB)
, which furthermore
is normalized to have unit length.
The kernel function for the SOAP term is the simple
dot product,
nn′l = q(MB)
and we ﬁnd it advantageous to raise it to a small integer
power for a sharper distinction between diﬀerent environments. This gives the ﬁnal kernel
K(MB)(q(MB)
This dot product kernel is a natural choice to use with
the power spectrum descriptor, as it makes the kernel
equivalent (up to normalization) to the integrated overlap
of the original neighbor densities,
ρa(r)ρt( ˆRr)
The expression for the total energy in our GAP model
is therefore given by
where all ﬁtting coeﬃcients α enter linearly, and therefore we can obtain them simply using linear algebra. This
is in contrast with the diﬃcult nonlinear parameter optimization required both for traditional interatomic potentials and for some other ML schemes, e.g., artiﬁcial
neural networks.
The above discussion does not include the prescription for obtaining the linear ﬁtting coeﬃcients. In practice, this is complicated due to the fact that the quantum mechanical data is only available in the form of total energies, atomic forces, and virial stresses. The full
formalism simultaneously includes sparsiﬁcation, multiple energy terms, and ﬁtting to total energies and their
derivatives; is is given elsewhere.51
To illustrate the role of the combined descriptors, we
use diﬀerent (and increasingly complex) GAP models to
compute the potential-energy curve for an isolated carbon dimer; these models have been ﬁtted to the full bulk
and surface training set described below that additionally incorporates DFT data points between 0.8 and 3.7 ˚A
in small increments. The results are summarized in Fig.
2: GAP models using 2b descriptors only, or a combination of 2b+3b, reproduce the minimum and the repulsion
at small C–C distances reasonably well, but the longerrange behavior is not yet correctly described. An interesting result is seen when using a many-body descriptor only: the ﬁt is very good for the region where data
points are provided (blue circles), but shows unphysical
behavior at r < 0.8 ˚A; this can, and will, then lead to
bad extrapolation in practical simulations. By contrast,
a GAP model combining all three descriptors (Eq. 12)
gives a highly satisfactory result (red line in Fig. 2).
COMPUTATIONAL METHODS
General protocol for melt–quench simulations
Structural data were obtained from melt–quench MD,
following protocols that are well established for a-C.23,25
C–C distance (Å)
∆Energy (eV)
2b+3b only
2b+3b+SOAP
FIG. 2. Potential-energy scans for an isolated carbon dimer.
This plot, with DFT data as reference (blue), allows us to assess the use of diﬀerent structural descriptors: all three combined are needed for a high-quality ﬁt (see text).
Initial simulations were performed in the DFT framework, subsequent ones with GAP, but both employed
the same temperature protocol. For each simulation, an
(unstable) simple-cubic lattice of carbon atoms was generated at the appropriate density and held at a constant
temperature of 9000 K for 3 ps. The simulation cell was
then held in the liquid state at 5000 K (3 ps), quenched
with an exponentially decaying temperature proﬁle (0.5
ps), and ﬁnally annealed at 300 K (3 ps). The timestep
was 1 fs in all MD simulations.
DFT-based (“ab initio”) molecular dynamics
Structures for initial training, as well as benchmarks
for a-C properties, were generated using DFT-based
ab initio MD, using the Quickstep scheme and a
stochastic Langevin thermostat60 as implemented in
cp2k.61,62 Electronic wavefunctions were described at
the Γ point using a mixed-basis scheme with Goedecker–
Teter–Hutter pseudopotentials63 and a cutoﬀenergy of
250 Ry. Double-ζ quality basis functions were used for
the carbon 2s and 2p levels.
Exchange and correlation were treated in the local density approximation (LDA),64 both during ab initio MD
and training-data generation. This functional, despite its
simplicity, has long been used for atomistic simulations
of a-C and is still the de facto standard for many current applications.15,27,28 Further work may be concerned
with the application of higher-level DFT methods, such
as computationally much more expensive hybrid functionals, or the implementation of dispersion corrections—
these will likely be interesting additions to the GAP
framework, but are beyond the scope of the present study.
Construction of the training database
Our training database contains structural snapshots
from ab initio MD and also, as it is iteratively extended,
from GAP-driven simulations. No matter how generated,
all structures are then subjected to single-point DFT-
LDA computations, to yield well-converged energies and
forces for training.
This was done using CASTEP,65
with dense reciprocal-space meshes (maximum spacing
0.03 ˚A−1),66 a 650 eV cutoﬀfor plane-wave expansions,
and an extrapolation scheme to counteract ﬁnite-basis
errors.67 Gaussian smearing of 0.1 eV width was applied
to electronic levels. The halting criterion for SCF iterations was ∆E < 10−8 eV.
Initial training data were computed for snapshots from
ab initio MD melt–quench trajectories, and a preliminary
GAP was ﬁtted to those data. The resulting potential
reproduced the structure of the 9000 K liquid well, that
of the 5000 K liquid satisfactorily, but not yet that of
the amorphous phase. In retrospect, this is easily understood: the 9000 K liquid is highly diﬀusive, and so one
single 3 ps trajectory apparently contains suﬃciently different atomic environments to sample conﬁguration space
during training.
A quenched amorphous structure, by
contrast, is essentially one single snapshot with thermal
ﬂuctuations but no major changes in connectivity. Training from DFT data alone would thus incur signiﬁcant
expense, as each uncorrelated a-C sample would require
a full melt–quench trajectory (9500 steps) of which only
the last snapshot were of use.
Instead, an initial GAP was used to generate liquid structures at 5000 K, which were then brieﬂy reequilibrated (500 steps) and quenched (500 steps) using
ab initio MD. This was done for ten uncorrelated structures each at 2.0, 3.0, 3.25, and 3.5 g cm−3, thus placing
more emphasis on high-density amorphous phases which
are richer in tetrahedral (“sp3”) motifs and thus structurally most diﬀerent from the liquids.
The resulting, amended database was used to train
a new GAP, which was further extended iteratively by
performing melt–quench simulations fully driven by the
previous GAP version, as is common practice in the development of ML potentials.39,46 Thereby, all GAP-MD
simulations were carried out using a Langevin thermostat
as implemented in quippy (www.libatoms.org), and the
same temperature proﬁles as in the cp2k simulations. A
typical protocol included the generation of 100 independent structures at densities of 1.5–3.5 cm−3, with system
sizes of 27–125 atoms. For one or more snapshots from
each trajectory, a single-point DFT computation was performed and the results were included in the next round
of training.
To add amorphous surfaces to the training set, we generated ta-C structures using GAP, and from these created slabs by adding vacuum regions.
In parallel ab
initio MD runs, amorphous slabs were brieﬂy heated
at up to 5000 K, and structures from both procedures
were added to the database. We reiterate that it is not
TABLE I. Key parameters for the GAP model created in this
work (see Sec. II for deﬁnitions).
nmax, lmax
Sparsiﬁcation
Nt (a-C bulk)
Nt (a-C surfaces)
Nt (crystalline)
Nt (dimer)
Nt (total)
aFor the 2b and 3b descriptors, when specifying training
input, the δ given here is divided by the expected number
of pairs or triplets an atom is involved in.
problematic to generate the training structures with different techniques,68 as their energies and forces are recomputed using the same reference method (tightly converged plane-wave DFT).
Once the training database of liquid and amorphous
structures had been generated, it was further extended
by including randomly distorted unit cells of the crystalline allotropes, diamond and graphite. This combined
database was then split into a training and a test set
(90:10); the latter was not included in the ﬁt but used
for validation. Finally, DFT data for an isolated dimer
were added (cf. Fig. 2). A full description of the training
database is provided as Supplementary Information.
GAP model ﬁtting
Values for the above GAP parameters as used in the
present work are given in Table I.
Furthermore, the
regularization parameters of the Gaussian process corresponding to the expected errors were as follows. For
liquid and amorphous structures we set 0.002 eV (energies) and 0.2 eV ˚A−1 (forces); for the crystalline forms,
we multiplied both values by 0.1, and additionally included virials in the training, with an expected error of
0.2 eV. Sparsiﬁcation was done with the CUR method69
for the SOAP kernel, whereas a simple uniform grid
of basis function locations was used for the 2b and
In the following, unless speciﬁed otherwise,
“GAP model” refers to one with all three terms (2b, 3b,
and SOAP). The potential ﬁles are freely available at
 
Random distortion (≤ 0.1 Å) c
Define fixed sphere
around one atom
Distort atoms outside
rfix (several copies)
σ (rfix) (eV Å–1)
σ (rfix) (eV Å–1)
Random distortion (≤ 0.1 Å)
FIG. 3. (a) Schematic overview of the procedure used here for
locality tests. (b,c) Results for diamond and graphite, respectively, obtained by displacing all atoms outside rﬁx randomly
by up to 0.1 ˚A and inspecting the standard deviation of the
force on the central atom.
RESULTS AND DISCUSSION
Locality and target accuracy
A central assumption of all interatomic potentials is
that of locality: the energy associated with a given atom
or bond depends on its immediate environment (εi ≡
ε(qi)), but not on atoms further away than a given cutoﬀradius (ignoring electrostatic terms and van der Waals
corrections for the moment). A similar assumption follows directly for the forces on atoms. While this approximation is often made implicitly, and tacitly, in the development of empirical potentials, their ML-based counterparts aim at quantitative energy and force accuracy with
respect to the reference potential-energy surface, and so
at the outset we must numerically determine how well the
above assumption holds. This question is very general,
and likely relevant beyond the present study.
Quantum-mechanical models such as DFT are inherently nonlocal: they do not allow for a unique partitioning of the total energy into a sum of local terms.
Nonetheless, quantum models of electronic structure are
nearsighted,70 which means that the reduced one-particle
density matrix decays strongly (at least under the assumption of screening, for insulators, and in general at
ﬁnite temperature).71 This implies locality in the atomic
forces, which we quantify as the decay of the dependence
of an atomic force on a neighboring atom’s position as the
distance between the two atoms grows. A direct manifestation of this is the decay of the dynamical matrix or
a-C (2.0 g cm–3)
ta-C (3.0 g cm–3)
σ (rfix) (eV Å–1)
MD-induced
distortion
MD-induced
distortion
a-C (2.0 g cm–3)
ta-C (3.0 g cm–3)
σ (rfix) (eV Å–1)
Random distortion
Random distortion
FIG. 4. Locality tests for a-C structures. (a) Force locality
in low- and high-density forms, evaluated in the presence of a
small distortion that preserves the major topological features
of the amorphous network. In both panels, data have been
collected over three structural models; for each, ten atoms
were randomly sampled as sphere centers, and ﬁve independent distortions were created for each central atom. (b) Same
but for a large distortion induced by MD at very high temperature such as to erase any structural memory of the initial
cell outside the ﬁxed sphere.
Using our reference quantum-mechanical method, we
can calculate the above decay of the dependence of the
atomic forces, and thus determine a bound on force locality. Conversely, this gives a bound on the force accuracy
of any interatomic potential model based on a local energy decomposition. We stress again that all this applies
only for materials without strong polar interactions—or
for models from which such polar interactions have been
substantially subtracted.
The procedure, as previously employed by Bart´ok et
al.,34 is sketched in Fig. 3a: we select one atom in a
given simulation cell and deﬁne a sphere of radius rﬁx
around this atom in that the atoms are ﬁxed. We then
create many structures which diﬀer in the positions of the
atoms outside the ﬁxed sphere, and for each calculate the
force on the central atom using DFT.72 Locality is then
characterized by plotting the standard deviation of this
force as a function of rﬁx.
We ﬁrst consider the crystalline allotropes and begin by introducing rather modest distortions, moving all
atoms outside rﬁx randomly by up to 0.1 ˚A. Diamond
exhibits strong locality (Fig. 3b): the overall force deviations due to displacements outside the spheres are small,
and they gradually vanish and are practically zero at
rﬁx = 5.5 ˚A. Graphite, by stark contrast, is highly nonlocal (Fig. 3c): the force deviations are much larger than
in diamond, and they do not decay as rapidly.
Turning now to the locality in amorphous carbon, we
focus on two representative densities: a low-density form
(2.0 g cm−3) and an approximant of dense ta-C (3.0 g
cm−3), and again we start by randomly displacing atoms
by up to 0.1 ˚A (Fig. 4a). Qualitatively, the results seem
to be in line with those for the crystalline phases: the
more sp2-rich form (2.0 g cm−3) clearly shows lower
locality.73 Due to the coexistence of sp2/sp3 motifs in
the amorphous forms, however, there is no clear-cut distinction between the two system sizes, and ta-C retains
a notable degree of nonlocality.
The displacements so far have perturbed the atoms
outside rﬁx, but the models still retain a “memory” of the
initial structure even outside the ﬁxed sphere. We therefore next perform TersoﬀMD,11 starting with velocities
that correspond to a very high temperature, and let the
system evolve for 1 ps, again keeping the central sphere
ﬁxed. This leads to a more local picture (Fig. 4b), especially for the dense “diamond-like” form; nonetheless,
the overall σ(3.7 ˚A) values in the latter are much larger
than in the crystalline form .
Summarizing, diamond shows the strong force locality
expected for a covalent semiconductor; graphite, by contrast, is highly nonlocal. The latter holds for the amorphous phases as well, more pronounced so at low density.
As a ballpark measure, for an a-C potential with a cutoﬀ
radius of 3.7 ˚A, we estimate the lowest achievable standard deviation of force components to be ≈1 eV ˚A−1
(Fig. 4). One might increase rcut up to 7.0 ˚A, which is
expected to lower the standard deviation to ≈0.7 eV
˚A−1, but the tradeoﬀin terms of much greater computational expense (both during training and application
of the GAP) does not seem to justify this. Hence, all
that follows will be done in the framework of modest rcut
values as given in Table I.
Energies and forces
With the target errors for a ﬁnite-range potential established, we can now analyze the quality of our GAP.
We therefore test how much the predicted energies and
forces deviate from DFT reference values.
assess diﬀerent combinations of structural descriptors,
and thereby illustrate how hierarchical GAP models can
achieve increasing accuracy.
Correlation plots of energies and force components already make this clear (Fig.
5a): using the 2b descriptor only, there is a certain degree of correlation between the DFT and GAP energies,
but with much scatter, and there is essentially no correlation between DFT and GAP force components (light
gray). A 2b+3b model is clearly better (dark gray), but
ultimately SOAP must be added (red) to achieve the accuracy limit imposed by nonlocality (Fig. 5b). Figure 5c
shows the errors as cumulative distributions: the curves
move left (toward lower errors) and up (to a higher degree
of conﬁdence) as successively more complex descriptors
GAP prediction
Energy error (eV atom–1)
–30 –20 –10
–30 –20 –10
Cumulative (%)
DFT energy (eV atom–1)
Total energies
Force components
DFT force (eV Å–1)
DFT energy (eV atom–1)
DFT force (eV Å–1)
Force error (eV Å–1)
(a) Scatterplots of DFT-computed and GAPpredicted total energies (left; relative to a free singlet atom)
and force components (right) on a test set of 450 conﬁgurations. Results are shown for hierarchical GAP models with
diﬀerent combinations of descriptors (Sec. II). (b) Absolute
errors of the respective quantities, similarly resolved according to diﬀerent sets of descriptors. For the force components
(right), akin to Ref. 34, an estimate of the maximum achievable standard deviation as judged from locality tests (Sec.
IV A) is indicated by a blue line. (c) Cumulative distributions: a given point (x, y) on the curve indicates that y percent of all structures have an error equal to or below x. The
standard deviation estimated from locality tests, σloc, which
should enclose ≈68.3% of the GAP force component errors, is
indicated in blue: indeed, the GAP model with combined 2b,
3b, and MB descriptors (red line) does reach this accuracy.
are added to the GAP model.
For such a heterogenous training database, it is interesting to further break down the GAP’s performance
according to conﬁguration types: slightly distorted diamond conﬁgrations will be easier for an ML potential to
ﬁt than disordered liquid carbon. Indeed, looking back at
Fig. 5 shows that the training points with lowest overall
energy show the lowest ﬁtting errors; these are precisely
the crystalline structures.
In Fig. 6, we show the distribution of errors for conﬁgurations coming from diﬀerent stages of the melt–quench
GAP force component (eV Å–1)
DFT force component (eV Å–1)
Liquid (9000 K)
Liquid (5000 K)
Quench (≈ 3500 K)
Amorphous (300 K)
FIG. 6. DFT-computed versus GAP-predicted force components in a set of 125-atom snapshots of liquid and amorphous
carbon, emphasizing the overall magnitude of forces the GAP
has to learn at various parts of the melt–quench trajectories.
We investigate a set of 100 uncorrelated a-C
structures, with 125 atoms each and randomized densities
over the range 1.5–3.5 g cm−3, created using GAP-MD
and subsequently analyzed using DFT. From each meltquench trajectory, we take one conﬁguration at each key
step—that is, one from the 9000 K and one from the
5000 K liquid, one during quenching, and the ﬁnal one
from the quenched amorphous sample. The force errors
are very similar for all parts of the trajectory, but the
absolute magnitude of forces is much diﬀerent; hence, in
relative terms, the GAP performs much better for forces
in the liquid than in the amorphous phases. A detailed
numerical analysis is in Table II. We estimate how widely
the absolute DFT force components are distributed by
giving their 95-th percentile value P95. We then divide
the GAP force component error by P95; the lower this
ratio, the better. For melt–quench simulations, the situation appears favorable: as the structure is “frozen in”
during quenching, the topology (say, the sp3 count) of
the amorphous phase is largely determined by a correct
description of the liquid.
Structural properties
From energy and force evaluations, we now move on to
probe physical properties as predicted by our GAP. Table III compares its performance to DFT reference data
for the diamond structure. Here and in the following, we
will also make comparison to a state-of-the-art empirical
potential, namely, a screened variant of the Tersoﬀpo-
TABLE II. Energy and force RMS errors of our GAP, computed for a set of 125-atom structures (cf. Fig. 6), and also for
the crystalline structures from the test set. Percentile values
P95 for the absolute DFT values are given; these measure the
range of data the GAP has to “learn”.
Force components
(GAP) (DFT) Ratio
Liquid (9000 K)
Liquid (5000 K)
Crystalline
TABLE III. Structural and elastic properties of diamond,
computed using DFT-LDA and our GAP as well as the
screened Tersoﬀpotential from Ref. 74 (“scrT”).
DFT GAP scrT
3.532 3.539 3.566
BVoigt (GPa)
1101 1090 1073
tential developed by Pastewka and coworkers.15,74 Similar potentials have been successfully applied in recent
studies both to graphene75 and to ta-C,76 and are faster
than GAP by about a factor of 50.
The lattice parameter a of diamond is accurately reproduced by the GAP; the bulk modulus and elastic
constants are reasonable but deviate somewhat from the
DFT reference (Table III). It was shown previously that
a GAP model trained for the crystalline phases exclusively can reproduce the benchmark even better;34 here,
the gain in transferability (being able to model amorphous as well as crystalline phases) comes at a small price
in terms of accuracy.
Similar tests for the graphite c parameter gave 6.625 ˚A
(DFT) and 6.518 ˚A (GAP). Despite this slight overbinding (–1.6%), the agreement is appreciable, especially
given that the Tersoﬀand Brenner potentials are shortranged and cannot describe the interlayer spacing in
graphite at all (rcut < c/2).
We now turn to the main subject of the present work:
the liquid and amorphous phases of carbon. We begin by
inspecting the concentration of sp3 atoms during melt–
quench simulations (Fig. 7), and use this to once more
assess the performance of diﬀerent combined structural
descriptors. The DFT reference (blue) shows that in liquid carbon at 3.0 g cm−3, approximately one-third of
the atoms are in fourfold coordination, and this number
increases strongly when quenching (6.0→6.5 ps in simula-
sp3 atoms in ta-C (%)
Simulation time (ps)
Randomize (3 ps)
Melt (3 ps)
Anneal (3 ps)
FIG. 7. Top: Exemplary temperature proﬁle during a DFT-
MD melt–quench simulation to yield a 216-atom structure
of ta-C. Bottom: Concentration of sp3 atoms during these
cycles, measured by counting atomic neighbors up to a cutoﬀ
distance of 1.85 ˚A. DFT benchmarks are compared to GAP
results using diﬀerent combinations of descriptors; areas of
light shading indicate standard deviations.
tion time). During annealing at 300 K, the DFT average
then levels oﬀat ≈70 %; as only three structures were
created with DFT, ﬂuctuations and standard deviation
(light blue shading) are sizeable. The GAP results, by
comparison, clearly identify the need for combined structural descriptors when aiming to make physically meaningful predictions: using the two- and three-body descriptors only yields systematically too low sp3 concentrations
(gray), whereas both combined with SOAP essentially
reproduce the DFT data for the liquid forms (red); the
sp3 count is still underestimated in the quenched amorphous phase. We performed additional GAP simulations
in which we increased the quenching time from 0.5 to 2.0
ps, but this did not further improve the result. For completeness, we include in Fig. 7 results for a GAP model
that employs two-body descriptors only—but in this case
the atoms clump into unphysical structures within the
ﬁrst few steps (black line), not unexpectedly so.
The simplest measure of short-range order in a liquid or amorphous structure is given by the radial distribution function (RDF). In Fig. 8, we compare GAP
results to those of DFT, and start by noting that both
are very close.
The liquid structures are more diﬀuse
and less strongly ordered, and the RDFs show a nonzero
ﬁrst minimum at ≈1.9 ˚A, whereas the amorphous structures exhibit a gap between their ﬁrst and second RDF
peak. A small but visible asymmetry of the second RDF
peak at ≈2 ˚A for all amorphous structures indicates the
1.5 g cm−3
Liquid (5000 K)
Amorphous (300 K)
2.0 g cm−3
2.5 g cm−3
3.0 g cm−3
Distance (Å)
Distance (Å)
3.5 g cm−3
Radial distribution functions for liquid (left) and
subsequently quenched amorphous (right) carbon structures
(ten independent 216-atom structures were created at each
Results for ﬁve densities are given, spanning the
entire range visualized in Fig. 1. “scrT” denotes the screened
Tersoﬀpotential as introduced in Ref. 74.
presence of fourfold rings. The screened Tersoﬀpotential
(“scrT”) does not predict the existence of such fourfold
rings in a-C (we will return to this below), and other
than DFT and GAP it lowers the ﬁrst RDF minimum to
almost zero in all liquid structures.
Figure 9 shows angular distribution functions (ADFs).
The ADF maxima at low (high) density are centered
around 120◦(109◦), respectively, loosely mirroring the
deﬁning structural features of the crystalline allotropes
(graphite honeycombs and diamond tetrahedra); naturally, this distribution is broader in the highly diﬀuse
liquids than in the quenched amorphous structures. At
low densities, a contribution close to 180◦is seen in the
DFT reference data, due to nearly linearly coordinated
“sp” carbon atoms (yellow in Fig. 1); this is a minor feature at 2.5 and 2.0 g cm−3, but becomes prominent at 1.5
g cm−3, especially so in the quenched amorphous structures (top right panel in Fig. 9). The GAP reproduces
these features very well, both the location and the extent
of the maxima, as well as the overall shape of the ADF
curves. The screened Tersoﬀpotential deviates signiﬁcantly from the DFT and GAP results, and the ADFs
derived from it are zero both at 60◦(absence of three-
1.5 g cm−3
Liquid (5000 K)
Amorphous (300 K)
2.0 g cm−3
2.5 g cm−3
3.0 g cm−3
Angle (deg)
3.5 g cm−3
Angle (deg)
FIG. 9. As Fig. 8, but for angular distribution functions. Thin
vertical lines mark angles of 109.5◦and 120◦, corresponding
to ideal sp3 (diamond-like) and sp2 (graphite-like) motifs, respectively. The scaling of the vertical axes is arbitrary.
fold rings) and at 180◦(absence of linear “sp-bonded”
Coordination statistics and medium-range order
Among the key structural characteristics for a-C is the
concentration of fourfold coordinated (“sp3”) atoms as
function of the sample density.
We assess this in Fig.
10, comparing GAP results to DFT but also to previous
modeling and experimental studies. The empirical Brenner and Tersoﬀpotentials, as is known,15 underestimate
the sp3 count at high density; indeed, one of the breakthrough successes of the screened Brenner and Tersoﬀ
potentials has been their much improved description of
ta-C in this respect.15 In comparison, the GAP data (red
in Fig. 10) are even closer to the DFT reference (blue),
particularly at lower densities. The residual error of the
GAP results is most pronounced at 3.0 g cm−3, and so
using this density for the example in Fig. 7 showed the
worst of all cases.
Looking beyond the ﬁrst nearest-neighbor shell, the
medium-range order in amorphous materials is conventionally characterized by means of ring statistics, which
we evaluate using Franzblau’s shortest-path algorithm.80
sp3 count (%)
Density (g cm–3)
FIG. 10. Count of “sp3” (fourfold coordinated) carbon atoms
in quenched a-C structures as a function of density. Ten independent melt–quench cycles were performed at each density
for the empirical and GAP models; three independent ones
were done for DFT. Data for the Brenner potential are taken
from Ref. 15.
Experimental data have been collected from
Refs. 77–79. Error bars represent standard deviations. Lines
between data points are only guides to the eye.
Again, we compare liquid and quenched amorphous
structures side-by-side, and inspect the entire range from
low to high densities (Fig. 11).
The DFT reference (blue) shows that the distribution
is quite complex: at high densities, the ring sizes center around sixfold (similar to diamond, where n = 6
exclusively), and the distribution decays quickly beyond
that; no large-membered rings are found in ta-C. By contrast, the distribution in the low-density structures is less
clearly deﬁned and does involve higher-order rings, indicative of structural voids.
The results for ta-C at 300 K are very similar with
all three methods. In addition, the GAP model also recovers the three- and four-membered rings that are key
features of the liquid and also prominent in low-density
amorphous structures.23 The screened Tersoﬀpotential,
by contrast, overestimates the average ring size in lowdensity a-C, and does not predict the occurrence of any
three- or fourfold rings, neither in the liquid nor in the
amorphous phases.
So far, all validation of the new potential has been
done against DFT, and therefore necessarily been limited
to rather modest system sizes of 216 atoms. The true
strength of ML potentials, however, is in the application
to larger structures. Figure 12 shows results for an 8,000atom a-C structure at 1.5 g cm−3, which would presently
be impossible to generate with DFT-based MD even on
state-of-the-art supercomputers.
RDFs and ADFs obtained with 216-atom and 8,000atom structures are practically the same and are hence
not shown. The situation for the ring statistics (Fig. 12b)
is more complex. For small- and medium-sized rings, results for the large system (purple) come very close to
1.5 g cm−3
Liquid (5000 K)
Amorphous (300 K)
2.0 g cm−3
2.5 g cm−3
3.0 g cm−3
n-membered rings
n-membered rings
3.5 g cm−3
FIG. 11. Medium-range order in a-C as evaluated through
ring statistics. Top: Structural fragment from one of the DFT
generated a-C structures at 2.0 g cm−3, chosen to visualize
the diversity of ring sizes observed. Rings are indicated by
shading, and their size n is given. Bottom: Ring statistics for
liquid (left) and quenched amorphous (right) carbon structures obtained from DFT (blue), GAP (red), and screened
Tersoﬀpotential (“scrT”; black) simulations.
Data for the
liquid structures have been collected over the last 1 ps of
the respective trajectory; data for the amorphous structures
correspond to the last snapshot only, as the structures are
strongly correlated in this case. For GAP-derived structures,
the standard deviation for the count of each ring size is indicated by error bars.
the average from the 216-atom structures (red). Hence,
while a single 216-atom snapshot will not be suﬃcient to
investigate ring statistics of a-C models, one may instead
collect averages over suﬃciently many smaller structures,
and therefore reproduce the short- and medium-range
structural features without requiring larger simulation
cells. Nonetheless, there is an inherent deviation between
the 216- and 8000-atom structures: namely, at very large
scrT, 8000 atoms
GAP, 8000 atoms
scrT, 216 atoms
GAP, 216 atoms
scrT, 8000 atoms
GAP, 8000 atoms
scrT, 216 atoms
GAP, 216 atoms
Count (1.5 g cm–3)
n-membered rings
Count (3.0 g cm–3)
FIG. 12. Application of the GAP to larger-scale simulations.
(a) Melt-quenched 8,000-atom structure of a-C at 1.5 g cm−3,
shown as stick drawing. (b) Ring statistics for this structure
(purple) and as averaged over 10 diﬀerent 216-atom structures
(red; as in Fig. 11). Purple shading emphasizes ring sizes of
n ≥18 that the smaller systems cannot reproduce. (c) Same
analysis but for ta-C (3.0 g cm−3).
ring sizes (n ≥18; shaded in Fig. 12b), which the 216atom cells cannot reproduce as they are simply too small.
This emphasizes that realistic studies of voids and porosity in a-C will require large structures on the order of at
least several thousand atoms.
We also created an 8,000-atom ta-C structure (Fig.
in this case, no voids are found but a dense,
“diamond-like” network.
Consequently, no large rings
(n > 15) are observed, and the 216-atom simulations already provide a very good estimate of the medium-range
structural order. Likewise, the screened Tersoﬀpotential
here correctly reproduces the maximum at n = 6 as well
as the abundance of larger-membered rings. The latter
drops to zero between n = 12 and n = 15 for all potentials and system sizes investigated.
Density (g cm–3)
Young's Modulus (GPa)
Expt. (Ref. 81)
Expt. (Ref. 82)
Expt. (Ref. 83)
scrT (on DFT structures)
GAP (on DFT structures)
scrT (on scrT structures)
GAP (on GAP structures)
FIG. 13. Young’s modulus of a-C as a function of density.
Experimental values are taken from Ref. 81 (green), Ref. 82
(blue), and Ref. 83 (yellow), respectively. Lines between data
points are guides to the eye.
Elastic properties
We next evaluated the Young’s modulus of a-C which,
like the sp3 count, depends strongly on density.81–83 We
compare results using scrT and GAP, but not DFT, due
to the high expense of fully relaxing the internal degrees
of freedom for several uncorrelated models. In addition,
we disentangle the eﬀect of input structure versus potential performance for the prediction of elastic properties,
and therefore also use both scrT and GAP to evaluate
the Young’s moduli of DFT-generated structures.
To compute the Young’s modulus of a-C, we take previously generated 216-atom structures, perform further
short MD quenches from 300 K to very low temperature,
and ﬁnally a conjugate-gradient relaxation to minimize
the forces on atoms; the cell vectors remain ﬁxed to keep
the density unchanged.
For each optimized structure,
we compute the full 6 × 6 matrix of elastic constants C
without imposing symmetry operations, and invert this
matrix to obtain the compliance matrix S.84 From this,
we calculate the Young’s modulus E (see, e.g., Ref. 85)
by averaging over the three spatial directions:
and subsequently over independent structures (ten from
scrT and GAP melt–quench runs, three for the DFT case;
see above). The GAP results agree very well with experiments at all relevant densities (Fig. 13), and as expected
they predict increased stiﬀness as density and sp3 concentration (“diamond-likeness”) increase. The screened
Tersoﬀpotential correctly captures the same trend, albeit the absolute values are signiﬁcantly overestimated;
this is most pronounced at higher densities.
Simulation time (ps)
γunrel (J m–2)
Slab structure
sp2 atoms (%)
FIG. 14. (a) Exemplary surface slab of ta-C, freshly cleaved
from a 1000-atom bulk structure. (b) Unrelaxed surface energies (Eq. 14) for ﬁve slabs cleaved from the same bulk structure. Lines between data points are guides to the eye. (c)
Course of temperatures in the protocol we use to generate
reconstructed surfaces: the systems are heated over 10 ps to
1000 (green), 2000 (yellow), or 3000 K (red), respectively, and
annealed at this temperature for another 10 ps. The ﬁnal 20
ps then constitute a slower cooling back to 300 K. (d) Concentration of sp2 carbon atoms in 1000-atom slabs versus simulation time. Averages over ten independent structures are
given, and areas of light shading indicate standard deviations.
From the bulk to surfaces
especially
nanoscale, must extend from the bulk to a description
of crystal surfaces and their reactivity.86 Likewise, the
surfaces of amorphous matter are of broad interest but
pose particular and signiﬁcant challenges for modeling.
We here present initial applications of our GAP to amorphous carbon surfaces of the 3.0 g cm−3 phase (ta-C).
This is because dense, diamond-like carbon is used in
coatings6 and it is this form for which surface phenomena are most relevant.
Early studies of ta-C surfaces have been reported at
the DFT level but have necessarily been restricted to
very small system sizes.87 Larger-scale simulations were
made possible by tight-binding schemes88 and EDIP,89
a Unrelaxed surface
b Annealed at 1000 K
c Annealed at 2000 K
d Annealed at 3000 K
sp2 / sp3 count
sp2 / sp3 count
sp2 / sp3 count
Distance from center (Å)
sp2 / sp3 count
FIG. 15. Surfaces of ta-C before (a) and after annealing at diﬀerent temperatures (b–d) as predicted from GAP simulations.
Each panel shows one exemplary slab structure on the left, with sp2 (“graphite-like”) atoms drawn as small dark spheres, and
sp3 (“diamond-like”) atoms larger and light gray. Note how annealing at 3000 K leads to beginning detachment of graphitic-like
sheets, and disintegration of the ta-C regions even in the center of the slab. Histograms for the sp2/sp3 distribution in direction
normal to the surface have been collected over ten independent structures; the count is normalized per simulation cell.
but even high-quality empirical potentials may face problems when it comes to the prediction of surface energies;
this has already been reported for diamond.74
Conventionally, the surface energy, γ, is calculated as
2A [Eslab −N × Ebulk]
for an elemental (or stoichiometrically precise) surface
slab that contains N atoms and exposes equivalent surface areas A at top and bottom; in this expression, Eslab
denotes computed total energies for a slab model per unit
cell, and Ebulk refers to the energy of the underlying bulk
structure per atom.
For amorphous systems, the structure of the surface
is not uniquely deﬁned (there are no distinct cleavage
planes as in crystals), and to calculate γ one must average over many large structures. We assess the suitability
of the GAP model for such studies by computing surface energies of ta-C and comparing to DFT values. We
used a GAP to generate a 1000-atom bulk ta-C structure
and cleaved ﬁve diﬀerent surfaces normal to the 
direction of the simulation cell (cf. Fig. 14a). For each
surface, the unrelaxed surface energy was evaluated using the three methods (Fig. 14b). The GAP model fully
reproduces the stability ordering; for the most stable surface (structure 1), GAP and DFT results diﬀer by less
than 0.01 J m−2. For the two least stable candidates, 4
and 5, this diﬀerence increases slightly but remains small
(below 0.1 J m−2, or 2%). The screened Tersoﬀpotential
yields much lower surface energies, similar to what has
been reported for diamond.74
We ﬁnally perform high-temperature annealing simulations with our GAP, to assess structural relaxations
and reconstructions at ta-C surfaces. These are associated with an increased formation of sp2 atoms (“graphitization”) that has been observed in several ex-situ
experiments90 and also in situ during ﬁlm growth.91 A
discussion of the relevant diﬀerences between experiment
and theory has been given by Marks.89 Higher temperatures than in experiment must be used to overcome
kinetic barriers during simulation—as experiments typically involve up to one hour of annealing.90 In that
sense, the absolute annealing temperature used for simulation is ﬁctious;89 its choice depends on the computational method,8 and a suitable annealing temperature
must therefore be found by trial and error.
In Fig. 14c–d we explore the use of diﬀerent such temperatures, and in particular we analyze the structures
obtained before and after each of the diﬀerent annealing
runs (Fig. 15). In each simulation, the slab is gradually
heated to the target temperature over 10 ps, annealed
for 10 ps, and then cooled back to 300 K over another
20 ps; each structure contains 1000 atoms, and ten independent ones are studied in parallel to improve statistics.
Monitoring the concentration of sp2 atoms during these
simulations provides the most direct insight: heating to
1000 K induces no signiﬁcant changes, albeit it “heals”
the dangling bonds directly at the surface (indicated by a
small jump in sp2 immediately upon initializing the simulation); therefore, the 1000 K annealed structure may
be a useful representative of the non-graphitized surface.
At the intermediate setting of 2000 K, the sp2 concentration in the system rises slightly during annealing and
is then lowered again during cooling; the interior of the
slab and its density remain close to that of bulk ta-C,
whereas reconstructions are observed at the surface. Finally, heating to 3000 K graphitizes the entire system;
this is reminiscent of what was seen earlier by Powles
and co-workers using the EDIP model.7 It also leads to
a strong expansion of the slab interior (Fig. 15d).
A top view best visualizes the atomic-scale processes
at the surface (Fig. 16). The freshly cleaved, unrelaxed
structure shows a number of “dangling bonds” and lowcoordinated atoms, trivially so as the tetrahedra in ta-C
have been cut apart.
These defects largely disappear
N = 3 (“sp2”)
1000 K: Removal
of “dangling bonds”
2000 K: Surface
reconstruction
3000 K: All-slab
graphitization
N = 1 (defect)
N = 2 (“sp”)
N = 4 (“sp3”)
FIG. 16. Top views of the same surface structure before (a)
and after (b–d) diﬀerent degrees of annealing. Only atoms
in the outermost 3 ˚A are shown, and coloring indicates the
coordination number.
during annealing at 1000 K already, but at this temperature the surface stays strongly disordered (Fig. 16b). By
contrast, increasing the annealing temperature to 2000
K leads to graphitized layers of several ˚A thickness at
the surfaces (Fig. 15c): sixfold rings are seen, as well as
pairs of ﬁve- and sevenfold ones that are likely metastable
(Fig. 16c); still, the surface atoms are connected to lowerlying sp3 atoms even within the topmost 3 ˚A, and the
graphitization therefore remains a genuine surface phenomenon. By contrast, during annealing at 3000 K, the
entire slab graphitizes as seen above, and a strongly defective graphene sheet begins to detach from the surface;
no near-surface sp3 atoms are seen any more (Fig. 16d).
CONCLUSIONS
We have developed a machine-learning based GAP
model for atomistic simulations of liquid and amorphous
elemental carbon.
The structural complexity that the
potential has to encompass, as well as the nonlocality
in forces are notable, and larger than in any previous
ML-based interatomic potential model. Nonetheless, our
GAP predicts energies that are largely in the range of
tens of meV/atom; characteristic structural properties,
such as the sp3 count and the medium-range order as
expressed through ring statistics, are faithfully recovered, and surface energies and reconstructions are well
described by the GAP.
The central issue in the development of atomistic
materials modeling remains in the tradeoﬀbetween
accuracy and cost. The GAP model presented here is
many orders of magnitude faster than DFT, but slower
than state-of-the-art empirical potentials (while similarly
linear scaling).
Being thus intermediate between both
realms, GAP models appear to be promising tools for
accurate large-scale atomistic simulations,
amorphous materials and their surfaces.
ACKNOWLEDGMENTS
We thank L. Pastewka, A. P. Bart´ok, J. R. Kermode,
and S. R. Elliott for ongoing valuable discussions and
for helpful remarks on this work. V.L.D. gratefully acknowledges a postdoctoral fellowship from the Alexander
von Humboldt Foundation, as well as support from the
Isaac Newton Trust (Trinity College Cambridge). This
work used the ARCHER UK National Supercomputing Service ( via EPSRC Grant
EP/K014560/1.
∗ 
1 A. Hirsch, Nat. Mater. 9, 868 .
2 V. Georgakilas, J. A. Perman, J. Tucek,
and R. Zboril,
Chem. Rev. 115, 4744 .
3 R. Hoﬀmann, A. A. Kabanov, A. A. Golov,
Proserpio, Angew. Chem. Int. Ed. 55, 10962 .
4 D. R. McKenzie, D. Muller, and B. A. Pailthorpe, Phys.
Rev. Lett. 67, 773 .
5 D. R. McKenzie, Rep. Prog. Phys. 59, 1611 .
6 J. Robertson, Mater. Sci. Eng. R Reports 37, 129 .
7 R. C. Powles, N. A. Marks, and D. W. M. Lau, Phys. Rev.
B 79, 075430 .
8 C. de Tomas, I. Suarez-Martinez, and N. A. Marks, Carbon 109, 681 .
9 J. Li, Model. Simul. Mater. Sci. Eng. 11, 173 .
10 For an overview, see: N. A. Marks, in Computer-Based
Modeling of Novel Carbon Systems and Their Properties:
Beyond Nanotubes, eds. L. Colombo, A. Fasolino , pp. 129–169.
11 J. Tersoﬀ, Phys. Rev. Lett. 61, 2879 .
12 D. W. Brenner, Phys. Rev. B 42, 9458 .
13 N. A. Marks, Phys. Rev. B 63, 035401 .
14 D. W. Brenner, O. A. Shenderova, J. A. Harrison, S. J.
Stuart, B. Ni, and S. B. Sinnott, J. Phys.: Condens. Matter 14, 783 .
15 L. Pastewka,
R. P´erez,
P. Gumbsch,
M. Moseler, Phys. Rev. B 78, 161402 .
16 S. G. Srinivasan, A. C. T. van Duin,
and P. Ganesh, J.
Phys. Chem. A 119, 571 .
17 B. D. Jensen, K. E. Wise, and G. M. Odegard, J. Phys.
Chem. A 119, 9710 .
18 L. Pastewka, S. Moser,
and M. Moseler, Tribol. Lett.
39, 49 ; L. Pastewka, S. Moser, P. Gumbsch, and
M. Moseler, Nat. Mater. 10, 34 .
19 N. Marks, J. Phys.: Condens. Matter 14, 2901 , and
references therein.
20 C. Z. Wang and K. M. Ho, Phys. Rev. Lett. 71, 1184
 ; Phys. Rev. B 50, 12429 .
21 T. Frauenheim, P. Blaudeck, U. Stephan,
and G. Jungnickel, Phys. Rev. B 48, 4823 .
22 T. K¨ohler, T. Frauenheim, and G. Jungnickel, Phys. Rev.
B 52, 11837 .
23 G. Galli, R. M. Martin, R. Car, and M. Parrinello, Phys.
Rev. Lett. 62, 555 .
24 D. A. Drabold, P. A. Fedders, and P. Stumm, Phys. Rev.
B 49, 16415 .
Pailthorpe,
M. Bernasconi,
and M. Parrinello, Phys. Rev. Lett. 76,
768 .
26 D. G. McCulloch, D. R. McKenzie,
and C. M. Goringe,
Phys. Rev. B 61, 2349 .
27 F. Risplendi, M. Bernardi, G. Cicero, and J. C. Grossman,
Appl. Phys. Lett. 105, 043903 .
28 D. Music, R. W. Geyer, and J. M. Schneider, Surf. Coatings Technol. 286, 178 .
29 X. Wang, S. Scandolo, and R. Car, Phys. Rev. Lett. 95,
185701 .
30 S. Lorenz, A. Groß, and M. Scheﬄer, Chem. Phys. Lett.
395, 210 .
31 J. Behler and M. Parrinello, Phys. Rev. Lett. 98, 146401
32 N. Artrith and A. Urban, Comput. Mater. Sci. 114, 135
33 A. Seko, A. Takahashi, and I. Tanaka, Phys. Rev. B 92,
054113 .
34 A. P. Bart´ok, M. C. Payne, R. Kondor,
and G. Cs´anyi,
Phys. Rev. Lett. 104, 136403 .
35 H. Eshet, R. Z. Khaliullin, T. D. K¨uhne, J. Behler,
M. Parrinello, Phys. Rev. B 81, 184107 .
36 R. Z. Khaliullin, H. Eshet, T. D. K¨uhne, J. Behler,
M. Parrinello, Phys. Rev. B 81, 100103 .
37 N. Artrith, T. Morawietz, and J. Behler, Phys. Rev. B 83,
153101 .
38 N. Artrith and J. Behler, Phys. Rev. B 85, 045439 .
39 W. J. Szlachta, A. P. Bart´ok, and G. Cs´anyi, Phys. Rev.
B 90, 104108 .
40 J. Behler, R. Marton´ak, D. Donadio,
and M. Parrinello,
Phys. Rev. Lett. 100, 185501 ;
R. Z. Khaliullin,
H. Eshet, T. D. K¨uhne, J. Behler, and M. Parrinello, Nat.
Mater. 10, 693 .
41 M. Rupp, A. Tkatchenko, K.-R. M¨uller,
and O. A. von
Lilienfeld, Phys. Rev. Lett. 108, 058301 ;
Faber, A. Lindmaa, O. A. von Lilienfeld, and R. Armiento,
117, 135502 .
42 M. G. Darley, C. M. Handley,
and P. L. A. Popelier, J.
Chem. Theory Comput. 4, 1435 ; C. M. Handley,
G. I. Hawe, D. B. Kell, and P. L. A. Popelier, Phys. Chem.
Chem. Phys. 11, 6365 .
43 J. Lee, A. Seko, K. Shitara, K. Nakayama, and I. Tanaka,
Phys. Rev. B 93, 115104 .
44 M. Rupp, R. Ramakrishnan, and O. A. von Lilienfeld, J.
Phys. Chem. Lett. 6, 3309 ; J. Cuny, Y. Xie, C. J.
Pickard, and A. A. Hassanali, J. Chem. Theory Comput.
12, 765 .
45 M. Rupp, Int. J. Quantum Chem. 115, 1058 .
46 G. C. Sosso, G. Miceli, S. Caravati, J. Behler,
M. Bernasconi, Phys. Rev. B 85, 174103 .
47 G. C. Sosso, D. Donadio, S. Caravati, J. Behler,
M. Bernasconi, Phys. Rev. B 86, 104301 .
48 G. C. Sosso, G. Miceli, S. Caravati, F. Giberti, J. Behler,
and M. Bernasconi, J. Phys. Chem. Lett. 4, 4241 .
49 S. R. Elliott, Nature 354, 445 .
50 J. Akola and R. O. Jones, Phys. Stat. Sol. B 249, 1851
W. Zhang, V. L. Deringer, R. Dronskowski,
R. Mazzarello, E. Ma,
and M. Wuttig, MRS Bull. 40,
856 .
51 A. P. Bart´ok and G. Cs´anyi, Int. J. Quantum Chem. 115,
1051 .
52 A. P. Bart´ok, R. Kondor,
and G. Cs´anyi, Phys. Rev. B
87, 184115 .
53 J. Behler, Phys. Chem. Chem. Phys. 13, 17930 .
54 Z. Li, J. R. Kermode,
and A. De Vita, Phys. Rev. Lett.
114, 096405 .
55 V. Botu and R. Ramprasad, Phys. Rev. B 92, 094306
56 A. Shapeev, Multiscale Model. Simul. 14, 1153 .
57 P. E. Dolgirev, I. A. Kruglov,
and A. R. Oganov, AIP
Adv. 6, 085318 .
58 S. De, A. P. Bart´ok, G. Cs´anyi,
and M. Ceriotti, Phys.
Chem. Chem. Phys. 18, 13754 .
59 M. J. Cliﬀe, A. P. Bart´ok, R. N. Kerber, C. P. Grey,
G. Cs´anyi, and A. L. Goodwin, arXiv:1609.00668 .
60 G. Bussi, D. Donadio, and M. Parrinello, J. Chem. Phys.
126, 014101 .
61 J. VandeVondele, M. Krack, F. Mohamed, M. Parrinello,
T. Chassaing,
and J. Hutter, Comput. Phys. Commun.
167, 103 ; J. Hutter, M. Iannuzzi, F. Schiﬀmann,
and J. VandeVondele, Wiley Interdiscip. Rev.–Comput.
Mol. Sci. 4, 15 ; www.cp2k.org.
62 T. D. K¨uhne, M. Krack, F. R. Mohamed,
and M. Parrinello, Phys. Rev. Lett. 98, 066401 .
63 S. Goedecker, M. Teter, and J. Hutter, Phys. Rev. B 54,
1703 .
64 W. Kohn and L. J. Sham, Phys. Rev. 140, A1133 .
65 S. J. Clark, M. D. Segall, C. J. Pickard, P. J. Hasnip, M. J.
Probert, K. Refson, and M. C. Payne, Z. Krist. 220, 567
66 H. J. Monkhorst and J. D. Pack, Phys. Rev. B 13, 5188
67 G. P. Francis and M. C. Payne, J. Phys. Condens. Matter
2, 4395 .
68 This can even turn out as an advantage—namely, if two
techniques lead to diﬀerent and simultaneously relevant
regions of conﬁguration space.
69 M. W. Mahoney and P. Drineas, Proc. Natl. Acad. Sci. U.
S. A. 106, 697 .
70 W. Kohn, Phys. Rev. Lett. 76, 3168 .
71 F. Q. Nazar and C. Ortner, arXiv:1509.06753 .
72 For the locality tests, we used CASTEP as described in the
Methods section; the reciprocal-space grids were reduced
to make the computational workload tractable.
73 One is tempted to correlate this with the more metallic
nature of lower-density a-C (see, e.g., Ref. 27); a deﬁnitive
answer would require sampling over a much larger number
of structures, though, especially given the large error bars
74 L. Pastewka, A. Klemenz, P. Gumbsch, and M. Moseler,
Phys. Rev. B 87, 205410 .
75 A. Klemenz, L. Pastewka, S. G. Balakrishna, A. Caron,
R. Bennewitz,
and M. Moseler, Nano Lett. 14, 7145
76 T. Kunze, M. Posselt, S. Gemming, G. Seifert, A. R. Konicek, R. W. Carpick, L. Pastewka, and M. Moseler, Tribol.
Lett. 53, 119 .
77 P. J. Fallon, V. S. Veerasamy, C. A. Davis, J. Robertson,
G. A. J. Amaratunga, W. I. Milne, and J. Koskinen, Phys.
Rev. B 48, 4777 .
78 J. Schwan, S. Ulrich, H. Roth, H. Ehrhardt, S. R. P. Silva,
J. Robertson, R. Samlenski, and R. Brenn, J. Appl. Phys.
79, 1416 .
79 A. C. Ferrari, A. Libassi, B. K. Tanner, V. Stolojan,
J. Yuan, L. M. Brown, S. E. Rodil, B. Kleinsorge,
J. Robertson, Phys. Rev. B 62, 11089 .
80 D. S. Franzblau, Phys. Rev. B 44, 4925 .
81 B. Schultrich, H.-J. Scheibe, G. Grandremy, D. Drescher,
and D. Schneider, Diam. Relat. Mater. 5, 914 .
82 B. Schultrich, H.-J. Scheibe, D. Drescher, and H. Ziegele,
Surf. Coatings Technol. 98, 1097 .
83 A. C. Ferrari, J. Robertson, M. G. Beghi, C. E. Bottani,
R. Ferulano, and R. Pastorelli, Appl. Phys. Lett. 75, 1893
84 J. F. Nye, Physical Properties of Crystals: Their Presentation by Tensors and Matrices .
85 W. A. Brantley, J. Appl. Phys. 44, 534 .
86 V. L. Deringer and R. Dronskowski, Angew. Chem. Int.
Ed. 54, 15334 , and references therein.
87 J. Dong and D. A. Drabold, Phys. Rev. B 57, 15591 ;
C. Chen and J. Robertson, Diam. Relat. Mater. 15, 936
 ; C. W. Bauschlicher, Jr. and J. W. Lawson, Chem.
Phys. 374, 77 ; M. A. Caro, R. Zoubkoﬀ, O. Lopez-
Acevedo, and T. Laurila, Carbon 77, 1168 .
88 R. Haerle, G. Galli, and A. Baldereschi, Appl. Phys. Lett.
75, 1718 .
89 N. A. Marks, M. F. Cover, and C. Kocer, Appl. Phys. Lett.
89, 131924 ; N. Marks, M. Cover,
and C. Kocer,
Mol. Simul. 32, 1271 .
90 T. A. Friedmann, K. F. McCarty, J. C. Barbour, M. P. Siegal, and D. C. Dibble, Appl. Phys. Lett. 68, 1643 ;
J. P. Sullivan, T. A. Friedmann, and A. G. Baca, J. Electron. Mater. 26, 1021 ; A. C. Ferrari, B. Kleinsorge,
N. A. Morrison, A. Hart, V. Stolojan, and J. Robertson,
J. Appl. Phys. 85, 7191 .
91 M. Chhowalla, J. Robertson, C. W. Chen, S. R. P. Silva,
C. A. Davis, G. A. J. Amaratunga,
and W. I. Milne, J.
Appl. Phys. 81, 139 .
Supplementary Information
COMPOSITION OF TRAINING DATABASE
The database is kept in extended xyz format, which allows us to store data for atomic positions and forces, as
well as total energies and virials, all in the same ﬁle. Individual conﬁgurations are concatenated, and identiﬁed
by two custom keywords, config type and detailed ct,
respectively. The ﬁrst is used for grouping the data during training.
The second, more detailed conﬁguration
type indicates how exactly the training data have been
obtained. A description is provided in the following.
For all parts of the dataset, the number of points
given here refers to the structures that in the (randomly sampled) training set, which comprised 90%
of the total database.
For example, for the “step0”
a total of 500 structures were computed,
and from these a random number generator selected
462 entries for the training and 38 entries for the test set.
structures
(config type=bulk amo)
• detailed ct=step0 (462 points, 64 at./cell):
carbon at 9000 K; ﬁve cp2k trajectories at densities
of 1.5, 2.0, 2.5, 3.0, and 3.5 g cm−3, respectively. Each
trajectory had 3000 steps, from which every 30 steps a
snapshot was taken and added to the database.
• detailed ct=LDL (166 points, 64 at./cell): Low-density
liquid: additional cp2k snapshots at densities of 1.50
and 2.00 g cm−3, taken both at 9000 K and 5000 K.
These were added at an intermediate stage during training, to prevent the GAP from predicting too many “sp”
chains in the low-density liquids.
• detailed ct=qu cp2k (88 points, 64 at./cell): Liquid
structures created with a preliminary GAP (trained on
step0) that were then equilibrated at 5000 K (0.5 ps)
and quenched (0.5 ps) to 300 K using cp2k. Ten uncorrelated structures were generated at 2.0 cm−3, and ten
at 3.0 cm−3.
• detailed ct=qu tetra (107 points, 64 at./cell): Melt–
quench trajecories with a focus on higher densities
(richer in tetrahedral motifs). We repeated the above
for high-density structures, generating ten structures
each at 3.25 and 3.5 g/cm−3, respectively; this was done
to include structures more rich in tetrahedra early on.
• Iterative training: Iteration 2
– detailed ct=iter2 1 (274 points, 27–64 at./cell):
Using an intermediate GAP (with distance, angle, and SOAP descriptors, the latter employing 1000 sparse points; hence denoted das1000),
trained using a part of the above data, 100 independent melt–quench trajectories were performed
with randomized densities between 1.5 and 3.5
From each, three structures were extracted: one from the equilibrated 5000 K liquid
(at 6.00 ps), one during the quench (at 6.15 ps),
and one ﬁnal step representing the equilibrated
amorphous phase (at 9.50 ps). For each, a singlepoint computation was performed and added to
the database.
– detailed ct=iter2 2 (86 points, 27–64 at./cell):
Same but using a GAP model with a larger number of SOAP sparse points (das2000); 100 independent trajectories from each of which only the
ﬁnal step was taken.
– detailed ct=iter2 3 (186 points, 64 at./cell): As
before but using a smaller GAP model (das0250);
200 independent melt–quench trajectories from
each of which only the ﬁnal step was taken.
– detailed ct=iter2 4
at./cell): Starting structures increased to include
4×4×5 (80 at.), 4×5×5 (100 at.), and 5×5×5
(125 at.) expansions.
• Iterative training: Iteration 3
– detailed ct=iter3 1 (260 points, 27–64 at./cell):
Using the previous data including the second iteration, a new GAP model was ﬁtted and this was
in turn used to generate structures as described
for iter2 1.
– detailed ct=iter3 2 (87 points, 27–64 at./cell):
As before, but with a GAP model using slightly
modiﬁed parameters compared to iter3 1; in this
case, only the last step from each trajectory was
• Iterative training: Iteration 4
– detailed ct=iter4 1 (272 points, 27–64 at./cell):
Iterative training as before, generating structures
as described for iter2 1.
– detailed ct=iter4 2 (356 points, 27–64 at./cell):
Iterative training as before, generating structures
as described for iter2 1, with slightly modiﬁed
GAP parameters compared to iter4 1.
• Iterative training: Iteration 5
– detailed ct=iter5 1 (178 points, 125 at./cell):
Iterative training as before, now increasing the
system size; 100 independent melt–quench runs
were performed, from which one snapshot from
the 9000 K liquid and one from the amorphous
structure was taken.
– detailed ct=iter5 2 (178 points, 125 at./cell):
As before, but using one snapshot from the 5000
K liquid and one during quenching.
four structures were thus extracted from each 125atom melt–quench trajectory.
• detailed ct=iter6 1 (91 points, 64 at./cell): Iterative
training as before. In this case, once the amorphous
structures had been generated, the lattice parameters
of the simulation cells were scaled uniformly by a randomized factor between 0.95 and 1.02 (to sample structures further away from equilibrium); subsequently,
the atomic positions were relaxed using a conjugategradient scheme, and both scaled unrelaxed and scaled
relaxed structures were added to the training database.
• detailed ct=iter7 1 (88 points, 64 at./cell): Iterative
training as before. In this case, amorphous structures
were generated and relaxed, and then one of the lattice
parameters was scaled by a randomized factor between
0.95 and 1.05; this strained cell was then added to the
Amorphous surfaces (config type=surf amo)
• detailed ct=asurf cp2k from5k
at./cell):
Two bulk liquid structures generated with
cp2k (64 atoms each) were cleaved at ﬁve equidistant
planes to generate ten slabs in total; each of the latter
was subjected to 3 ps of cp2k MD at 1000, 2000, and
5000 K in parallel.
This leads to highly disordered
surface structures with beginning disintegration, and
therefore allows us to sample a large diversity of
near-surface structures. In total, 30 runs were hence
performed, from which ten structures (every 300 steps)
were extracted and added to the training database.
• detailed ct=surf from iter4 216 (81 points, 216 at./
cell): Bulk 216-atom ta-C structures (3.0 g cm−3) were
created, and subsequently cleaved to yield surface slabs;
the latter (but not the bulk structures) were added to
the database.
• detailed ct=surf unrel iter4 (92 points,
cell): Bulk 64-atom ta-C structures were cleaved normal to , and these slab structures were added to
the database.
• detailed ct=surf unrel iter4 x (91 points, 64 at./
cell): Same but with cleavage normal to .
• detailed ct=surf unrel iter4 y (86 points, 64 at./
cell): Same but with cleavage normal to .
Bulk crystal structures (config type=bulk cryst)
• detailed ct=dist dia (182 points, 8 at./cell):
Distorted conﬁgurations starting from the DFT-optimized
structure of diamond. We generated 50 structures each
with all lattice parameters scaled by factors of 0.94,
0.97, 1.00, or 1.03. For each cell, none, one, or more
of the lattice parameters were randomly changed by
±5%, and none, one, or more of the angles was randomly changed by ±5 degrees; the other parameters
were kept ﬁxed. The atomic positions in each cell were
randomly either (i) ﬁxed, (ii) displaced randomly by
±0.02 ˚A, or (iii) relaxed using the Tersoﬀpotential.
• detailed ct=dist graphite (174 points):
above, but for graphite.
Isolated dimer (config type=cluster)
• detailed ct=dimer (30 points, 4 at./cell): DFT computations for C2 dimers with bond lengths of 0.8–3.7
˚A (in increments of 0.1 ˚A). In this case, a large cell
of 20 × 15 × 15 ˚A3 was used, and reciprocal space was
sampled at Γ.
ERRORS FOR TEST VERSUS TRAINING SET
To test the performance of an ML potential outside its
training range, it has been advocated to take a certain
subset from the structural database as “test set” that is
not included in the training. Here, doing so evidences
that the errors in both subsets are practically superimposable (Fig. S1): this is encouraging with regard to the
quality of the potential, but also to the completeness
of the underlying database, as the test set is randomly
drawn from the training data and hence structurally similar to them. In other words, Fig. S1 addresses not the
extrapolation but the interpolation behavior of our GAP.
DFT energy (eV atom−1)
GAP prediction
Training set
−30 −20 −10
DFT force (eV ˚A−1)
Training set
Energy error (eV atom−1)
Cumulative (%)
Training set
Force error (eV ˚A−1)
Training set
FIG. S1. Scatterplot of DFT-computed and GAP-predicted
total energies and force components for all 4050 structural
models in the training set (blue) and for a separate test set of
450 structures (red) not included in the training. Below, the
cumulative error distributions are given, which are very close
for the energies, and practically indistinguishable for the force
components.
TRIMER POTENTIALS
Albeit the GAP model reported here is trained for bulk
and surface (that is, extended) structures, we performed
additional tests for isolated trimers to assess the extrapolation behavior of the GAP. This case study allows us to
more clearly pinpoint the eﬀect of diﬀerent training data,
and the large improvement in potential quality that can
be achieved by including dimer data during the ﬁt.
Therefore, we place two carbon atoms in a large box,
at a ﬁxed distance of d(C −C) = 1.5, 2.0, or 2.5 ˚A. We
then place a third atom in the box on ﬁnely meshed grid
points; the energy of each system is then evaluated as
∆E = E(trimer) −E(dimer) −E(atom).
These interaction energies are characterized in Fig. S2
and compared to DFT reference data. A GAP model for
which the ﬁt did not include any dimer or trimer data
(leftmost column) shows erroneous extrapolation, including an energy barrier at intermediate distances; no such
barrier is seen in DFT. A GAP model ﬁtted to dimer
but not to trimer training data reproduces the trimer
potential-energy surface qualitatively very well; however,
small deviations remain (middle column).
tested the performance of a model where the DFT datapoints for the trimer have been included during training: not surprisingly, this improves the description of the
trimer further.
fit without dimer
and without trimer data
fit with dimer,
but without trimer data
GAP models
d(C–C) = 1.5 Å
d(C–C) = 2.0 Å
d(C–C) = 2.5 Å
fit with dimer
and trimer data
FIG. S2. Potential-energy scans for isolated carbon trimers, computed using diﬀerent GAP models (left-hand side) and DFT
(right-hand side). Two carbon atoms (marked as ×) are placed in the center of a simulation box, and a third atom is placed
on ﬁnely meshed grid points in the surrounding; at each point, the energy is computed relative to a free “× ×” dimer at the
given spacing plus a free atom. (In other words, as soon as the third atom is outside the cutoﬀradius for both central carbon
atoms, the energy drops to zero.)
d┴ = 0.5 Å
d┴ = 1.0 Å
d┴ = 1.5 Å
d┴ = 2.0 Å
GAP model,
no dimers,
no trimers
GAP model,
with dimers,
no trimers
GAP model,
with dimers,
with trimers
FIG. S3. Line cuts through the datasets shown in the above
colormaps: relative energies are given for a line parallel to
the dimer (× −×) bond axis, and for diﬀerent spacings perpendicular to this bond axis (see schematic at the top left for
deﬁnitions). The C–C distance in the central dimer is 1.5 ˚A.
Blue symbols show DFT data points, whereas lines denote
GAP results; these have been ﬁtted using DFT data for the
extended structures only (dashed gray line), using a dataset
including dimers but not trimers (as in the main text; yellow),
and ﬁnally using a dataset that includes DFT data for both
dimers and trimers (red).