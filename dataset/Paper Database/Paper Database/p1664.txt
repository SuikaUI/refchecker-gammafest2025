The GW method
F. Aryasetiawan1 and O. Gunnarsson2
1Department of Theoretical Physics,
University of Lund,
S¨olvegatan 14A,
S-223 62 Lund, Sweden
2Max-Planck-Institut f¨ur Festk¨orperforschung,
Heisenbergstrasse 1,
70569 Stuttgart,
Federal Republic of Germany
Calculations of ground-state and excited-state properties of materials have been
one of the major goals of condensed matter physics. Ground-state properties of
solids have been extensively investigated for several decades within the standard
density functional theory. Excited state properties, on the other hand, were relatively unexplored in ab initio calculations until a decade ago. The most suitable
approach up to now for studying excited-state properties of extended systems is
the Green function method. To calculate the Green function one requires the selfenergy operator which is non-local and energy dependent. In this article we describe the GW approximation which has turned out to be a fruitful approximation
to the self-energy. The Green function theory, numerical methods for carrying out
the self-energy calculations, simpliﬁed schemes, and applications to various systems
are described. Self-consistency issue and new developments beyond the GW approximation are also discussed as well as the success and shortcomings of the GW
approximation.
Introduction
Problems with the LDA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Theories beyond the LDA
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Gradient corrections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Self-interaction correction (SIC) . . . . . . . . . . . . . . . . . . . . . . . . .
A generalized KS scheme . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
The optimized eﬀective potential method . . . . . . . . . . . . . . . . . . . .
Motivations for the GWA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
A short historical survey . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
The Green function and the self-energy . . . . . . . . . . . . . . . . . . . . . . .
The polarization and response function . . . . . . . . . . . . . . . . . . . . . . .
The Hedin equations
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Quasiparticles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
The GW approximation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Numerical methods
Plane-wave basis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Localized basis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
The plasmon-pole approximation
. . . . . . . . . . . . . . . . . . . . . . . . . .
The space-time method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Simpliﬁed GW
The static Coulomb-hole and screened-exchange (COHSEX) approximation . . .
Improving the COHSEX approximation . . . . . . . . . . . . . . . . . . . . . . .
Extreme tight-binding models
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
Quasiparticle local density approximation (QPLDA) . . . . . . . . . . . . . . . .
LDA + δΣCOHSEX . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Applications
Alkali metals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Semiconductors and Insulators: sp systems . . . . . . . . . . . . . . . . . . . . .
Core polarization
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Transition metals
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Nickel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Nickel Oxide . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Manganese Oxide . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3d semicore states . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Jellium surface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Si(1 0 0) surface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Fullerenes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Self-consistency
Vertex corrections
Direct evaluation of the second-order self-energy . . . . . . . . . . . . . . . . . .
Vertex corrections based on the LDA exchange-correlation potential . . . . . . .
The cumulant expansion
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
VIII Summary and conclusions
Acknowledgment
I. INTRODUCTION
The Hamiltonian for a many-electron system is given by (in atomic units ¯h = m = e = 1)
2∇2(ri) + V (ri)] + 1
where V is a local external potential such as the ﬁeld from the nuclei. Solving the above Hamiltonian has been a major problem in molecular and condensed matter physics.
The Coulomb
interaction in the last term makes the Hamiltonian diﬃcult to solve. For a small system, such as
an atom or a small molecule, it is possible to obtain the many-particle ground-state wavefunction
by means of the conﬁguration interaction (CI) method . In this method
the wavefunction is expanded as a sum of Slater determinants whose orbitals and
coeﬃcients are determined by minimizing the total energy. A very accurate ground state wavefunction and energy can be obtained. The computational eﬀort, however, scales exponentially with the
system size so that applications to large molecules or solids are not feasible. For excited states, the
computational eﬀort becomes very large already for a small system. Fortunately, in practice we are
interested in quantities which do not require the full knowledge of the wavefunctions. For example,
we are interested in the total energy, excitation spectra and expectation values of single-particle
operators which can be obtained from the Green function described in a later section.
Approximate theories are usually concerned with ﬁnding a good single-particle approximation
for the Coulomb term. The earliest of these theories is the Hartree approximation where
the non-local Coulomb term is replaced by an average local Coulomb potential (Hartree potential)
from all the electrons. Although it gives reasonable results, due to a cancellation between exchange
and correlation, the Hartree theory is not accurate enough in many cases. An extension of the
Hartree theory which takes into account the fermionic nature of the electrons leads to the Hartree-
Fock approximation (HFA) where in addition to the average local Coulomb potential
there is a non-local exchange potential which reﬂects the Pauli exclusion principle. For systems
with an energy gap in their excitation spectra, the HFA gives a qualitatively reasonable result. In
fact the HFA works quite well for atoms but for insulating solids, the energy gap is in most cases
too large. The reason for this can be traced back to the neglect of correlations or screening which
is not too important in atoms but crucial in solids. The HFA already takes into account to a large
extent correlation between electrons of the same spin since the Pauli exclusion principle (exchange)
prevents them to get close together. Two electrons of opposite spin on the other hand are allowed
to occupy the same single-particle state at the cost of a large Coulomb energy. Correlations keep
electrons away from each other, creating a screening hole around each electron which reduces
the interaction with the other electrons and thereby the Coulomb energy. The energy cost of
transferring an electron from one site to a neighbouring site is substantially reduced by screening.
In the tight-binding limit, i.e. for localized states, the energy gap is approximately given by U and
this is essentially the eﬀective Coulomb energy of the states that form the gap. Thus, correlation
or screening reduces the gap from its Hartree-Fock value. In metals, the absence of correlations in
the HFA leads to qualitatively wrong results such as zero density of states at the Fermi level due
to a logarithmic singularity in the derivative of the single-particle spectra with respect to k at kF
 .
To simulate the eﬀect of correlations, Slater introduced the Xα method where the exchange
potential is modelled by a local potential of the form V x = αn1/3, derived from the electron gas
and scaled by a constant α to simulate correlations. n is the local electron density . This method has been quite successful in calculating ground-state properties
and excitation spectra but it is semiempirical. The Xα theory may be regarded as a precursor of
the modern density functional theory (DFT) 
which has become a standard method for calculating ground-state properties of molecules and
solids. Recent reviews on DFT may be found in Jones and Gunnarsson and Dreizler and
Gross . In DFT, the ground-state energy can be shown to be a functional of the ground-state
density and satisﬁes the variational principle with respect to the density. The explicit form of the
functional in terms of the density is not known and such an explicit functional may not exist. Using
the variational property of the energy functional, one arrives at a set of single-particle equations,
the Kohn-Sham (KS) equations , to be solved self-consistently:
2∇2 + V H + V xc]φi = εiφi
where V H and V xc are the Hartree and exchange-correlation potential respectively. In practical
applications, the functional containing the eﬀects of exchange and correlations is approximated by
the local density approximation (LDA) where the density in the exchange-correlation potential of
the electron gas is replaced by the local density of the real system . The KS
eigenvalues εi have no clear physical meaning except for the highest occupied which corresponds
to the ionization energy . Although there is no theoretical justiﬁcation, they are often interpreted as single-particle excitation energies corresponding to excitation
spectra of the system upon a removal or addition of an electron. In many cases, in particular in sp
systems, the agreement with photoemission spectra is quite good but as will be described in the
next section, there are also serious discrepancies.
A proper way of calculating single-particle excitation energies or quasiparticle energies is provided by the Green function theory .
It can be shown that the quasiparticle energies Ei can be obtained from the quasiparticle equation:
2∇2(r) + V H(r)]Ψi(r) +
d3r′ Σ(r, r′; Ei)Ψi(r′) = EiΨi(r)
The non-local and energy dependent potential Σ, or the self-energy, contains the eﬀects of exchange
and correlations. It is in general complex with the imaginary part describing the damping of the
quasiparticle. It can be seen that the diﬀerent single-particle theories amount to approximating
the self-energy operator Σ. Calculations of Σ are unfortunately very diﬃcult even for the electron
gas. We must resort to approximations and this review describes the GW approximation (GWA)
 which is the simplest working approximation beyond the HFA that takes screening
into account.
A. Problems with the LDA
The LDA has been very successful for describing ground-state properties such as total energies
and structural properties. There is no clear theoretical justiﬁcation why the LDA KS eigenvalues
should give excitation energies, and even the exact V xc is not supposed to give the exact quasiparticle energies. Nevertheless, the LDA KS eigenvalues are often found to be in good agreement with
the quasiparticle energies measured in photoemission experiments. Despite of its success, there are
serious discrepancies already in sp-systems and they become worse in d- and f-systems:
• The band width in Na is 10-20 % too large, 3.2 eV in LDA vs 2.65 eV experimentally (see,
however, section V-A for the experimental band width).
• The band gaps in semiconductors Si, GaAs, Ge, etc. are systematically underestimated, as
much as 100 % in Ge.
• The band width in Ni is ∼30 % too large, 4.5 eV in LDA vs 3.3 eV experimentally 
• In f-systems, the LDA density of states is in strong disagreement with experiment.
• In the Mott-Hubbard insulators of transition metal oxides the LDA band gap is much too
small and in some
cases the LDA gives qualitatively wrong results. For example, the Mott-Hubbard insulators
CoO and the undoped parent compound of the high Tc material La2CuO4 are predicted to
be metals 
• The magnetic moments in the transition metal oxides are systematically underestimated
 
• In alkali-metal clusters, the ionization energies calculated within the LDA are too low compared to experiment .
• In the LDA, the image potential seen by an electron in the vacuum far from a surface decays
exponentially instead of the expected −1/4(z −z0) decay where z is the coordinate normal
to the surface and z0 is the position of the image plane .
Strictly speaking, one should not blame the LDA for all of these discrepancies since many of
them are related to excited state properties which are outside the domain of DFT. However, excited
state properties of ﬁnite systems can be calculated within the time-dependent extension of DFT
 .
B. Theories beyond the LDA
When discussing theories beyond the LDA, a distinction should be made between theories which
attempt to ﬁnd better energy functionals but which lie within DFT and those theories which
attempt to mimic the self-energy in order to obtain better quasiparticle energies but which are
then usually outside DFT. The GWA belongs to the latter.
1. Gradient corrections
Since the LDA is based on the homogeneous electron gas, it is natural to take into account
the inhomogeneity in the charge density of real systems by including gradient corrections in the
energy functional. There are two main approaches. The ﬁrst is a semiempirical approach where
the exchange-correlation functional is modelled by a functional containing parameters which are
adjusted to give the best ﬁt to the cohesive energies of a number of ”standard molecules”. The most
successful of these models are due to Becke . The other approach attempts to
calculate the coeﬃcients in the gradient expansion from ﬁrst principles . While in general gradient corrections give a signiﬁcant improvement in the total energy there is almost no major improvement for quasiparticle energies
 .
One of the problems with the LDA is the absence of orbital dependence in the exchangecorrelation potential.
Since the potential does not distinguish between orbitals with diﬀerent
m-quantum numbers, for systems containing a partially ﬁlled d- or f-shell one obtains a corresponding partially ﬁlled band with a metallic type electronic structure unless the exchange and
crystal ﬁeld splitting create a gap between the up and down channel. Thus, the late transition
metal oxides, which are insulators, are predicted to be metals by the (nonspin-polarized) LDA. In
the LDA+U method and its generalization , an orbital dependent potential U acting only on localized
d- or f-states is introduced on top of the LDA potential. For Mott-Hubbard insulators or rare earth
metal compounds where the partially ﬁlled 3d or 4f bands are split by the Coulomb interaction,
forming the upper and lower Hubbard band, the LDA+U works reasonably well . The bandstructure, however, is unsatisfactory. Another problem with the method arises for
systems with partially ﬁlled 3d shells which are metallic, like the transition metals. In this case,
the LDA+U would produce unphysical results since it would split the partially ﬁlled band.
3. Self-interaction correction (SIC)
Apart from the problem with orbital dependence in the LDA, there is another problem associated
with an unphysical interaction of an electron with itself.
In DFT, only the highest occupied
state is free from self-interaction but in LDA, there is in general self-interaction for all states.
This self-interaction is explicitly subtracted out in the SIC formalism resulting in an orbitaldependent potential .
Self-interaction is signiﬁcant for localized states and it tends to zero for extended states since in
the latter case the charge is spread over the crystal and therefore the Coulomb interaction of an
electron with itself is of order 1/N. Since self-interaction is usually positive, one would expect the
LDA eigenvalues for localized states to be too high, as is indeed the case. For atoms, SIC therefore
lowers the LDA eigenvalues giving better agreement with experiment.
The orbital-dependent
potential in SIC can describe Mott-Hubbard insulators although the bandstructure is not likely to
be satisfactory. SIC predicts all the 3d monoxides to be insulators except VO which is correctly
predicted to be a metal . SIC however fails to give a delocalized paramagnetic solution for the doped
high TC compounds and a similar problem is anticipated in LDA+U. For more itinerant systems,
SIC does not give localized solutions, and it then reduces to the LDA. Accordingly, application to
semiconductors, e.g. Si, does not increase the LDA gap.
4. A generalized KS scheme
A recent attempt to improve the LDA description of quasiparticle energies is to choose a noninteracting reference system having the same ground-state density as the real system, like in the
conventional KS scheme, but with a non-local potential . Since the potential is
non-local, the choice is not unique, diﬀerent non-local potentials may generate the same groundstate density. A particular choice is a non-local screened exchange potential minus its local form.
By deﬁnition, the functional from which this potential is derived, is zero at the correct density. The
KS equations consist of the usual LDA exchange-correlation potential plus the chosen non-local
potential. For semiconductors Si, GaAs, Ge, InP and InSb, this method improves the values of the
band gap. Applications to other systems have not been performed so far.
Another recent scheme proposed by Engel and Pickett incorporates part of the correlation
energy into the kinetic energy functional which may be thought of as mass renormalization. This
scheme is shown to improve the description of band gaps in silicon and germanium but it gives
negligible correction for diamond and carbon.
5. The optimized eﬀective potential method
A natural way of improving the LDA would be to calculate the exchange energy exactly and
to generate a local exchange potential by taking a functional derivative of the exchange energy
functional with respect to the density . The correlation energy can be approximated by the LDA value. The original idea of this
method is due to Talman and Shadwick in their work on atoms where the Hartree-Fock
total energy is minimized with orbitals restricted to be solutions to single-particle Hamiltonians
with local potentials.
The scheme is also known as the optimized eﬀective potential method.
Applications of this approach to several semiconductors and insulators (C, Si, Ge, MgO, CaO,
and MnO) yields encouraging results regarding the band gaps which in most cases are improved
from the corresponding LDA values. However, the scheme is still within the density functional
formalism and it is intended to improve the energy functional rather than the self-energy. One
advantage of this scheme is the possibility to systematically improve the energy functional. With
regard to GW calculations, the scheme may provide better starting points than the LDA. The
scheme may be extended to include correlations by using a screened interaction potential.
C. Motivations for the GWA
The theories described above have drawbacks when applied to calculating quasiparticle energies.
Gradient corrections attempt to improve total energies but do not address the problem of improving quasiparticle energies. Indeed, applications to transition metal oxides, where the gap is zero
or grossly underestimated by the LDA, do not give any signiﬁcant improvement. SIC theory only
applies to localized occupied states and numerical calculations show that the resulting eigenvalues
are too low. The LDA+U is designed for systems with localized states split by the Coulomb correlation, forming the upper and lower Hubbard band. Applications to transition metals, however,
would lead to unreasonable results. The generalized KS scheme using screened exchange, like the
other theories discussed above, has no energy dependence which can be important in some cases.
Moreover, the choice of the non-local potential is rather arbitrary. Since the theory has not been
applied extensively, it is diﬃcult to judge its usefulness. The exact exchange approach should
in principle improve total energies when correlations are also taken into account but it does not
address the LDA problems with quasiparticles.
The GWA is derived systematically from many-body perturbation theory. The form of the selfenergy in the GWA is the same as in the HFA but the Coulomb interaction is dynamically screened,
remedying the most serious deﬁciency of the HFA. The self-energy in the GWA is therefore nonlocal and energy dependent. The GWA is physically sound because it is qualitatively correct in
some limiting cases which allows applications to a large class of materials, metals or
insulators.
• In atoms, screening is small and the GWA approaches the HFA which is known to work well
for atoms.
• In the electron gas, screening is very important which is taken into account in the GWA and
for semiconductors it can be shown that the GWA reduces the Hartree-Fock gaps.
• For a core electron excitation, the GWA corresponds to the classical Coulomb relaxation
energy of the other electrons due to the adiabatic switching-on of the core hole potential,
which is just what is to be expected physically.
• For a Rydberg electron in an atom, the GWA gives the classical Coulomb energy of the
Rydberg electron due to the adiabatic switching-on of an induced dipole in the ion core.
• For the decay rate and the energy loss per unit time of a fast electron in an electron gas, the
GWA gives the correct formula.
The GWA has been applied with success to a wide class of systems ranging from simple metals to
transition metals and their compounds.
So far, the GWA has been applied mainly to calculate single-particle excitation spectra, but
it is also possible to calculate the total energy and the expectation value of any single-particle
operator in the ground state.
D. A short historical survey
The earliest attempt to include correlations beyond the HFA in the form of GW theory was
probably the work of Quinn and Ferrell for the electron gas. Their calculations, however,
were limited to states around the Fermi energy and several approximations were made. DuBois
 also calculated the self-energy of the electron gas within a GW type theory but his
calculations were only for small values of the electron gas parameter rs < 1 or for high densities
since (4π/3)r3
s = ρ, where ρ is the electron density. His results have therefore received less attention
because they are not directly relevant to real metals which have rs ∼2 −5 (Al rs ∼2, Cs rs ∼
5). The ﬁrst full calculation of the self-energy within the GWA for the electron gas was performed
by Hedin . He also showed in a systematic and rigorous way how the self-energy can be
expanded in powers of the dynamically screened Coulomb interaction, with the GWA as the ﬁrst
term in this expansion. Later on, Lundqvist did extensive calculations of the
self-energy of the electron gas for various densities and studied the spectral functions. Rice 
used a diﬀerent version of what is conventionally known as the GWA, including vertex corrections
(corrections beyond the GWA). His results are similar to those of Hedin. Later on, Mahan and
his group performed extensive self-energy
calculations for the electron gas using various forms of the GW-type approximations, studying the
importance of vertex corrections.
Due to computational diﬃculties, the GWA was not applied to real materials until the mid
eighties starting with the work of Hybertsen and Louie on semiconductors
with encouraging results. At about the same time, Godby, Sham and Schl¨uter 
did the same calculations and their results are in good agreement with those of Hybertsen and
Louie . We should also mention an earlier calculation for diamond using the tight-binding
approach by Strinati, Mattausch, and Hanke although it is superseded by later calculations.
The good results for semiconductors encouraged further applications to more complicated systems,
transition metals and their compounds, jellium surface, sodium clusters and to f-systems. By now
the GWA has become a standard method for including correlations beyond the HFA.
II. THEORY
In this section we describe a brief summary of the Green function theory and derive the GWA.
More details on the Green function theory may be found in standard text books on many-body
theory and in the review
article by Hedin and Lundqvist .
A. The Green function and the self-energy
To study the electronic excitation spectrum of a solid, one performs photoemission experiments
where photons with a certain energy ω are used as projectiles to knock out electrons. By measuring the kinetic energy of the photoemitted electrons along a certain direction k and using the
conservation of energy and momentum, the excitation spectrum E(k) of the solid can be obtained:
ω = K.E. + E(k)
A photoemission experiment then measures the excitation spectrum of a solid with the presence of
a hole (occupied density of states). An inverse photoemission experiment or BIS uses electrons as
probes to measure the unoccupied density of states or the excitation spectrum with an additional
In the limit of large kinetic energy (”sudden approximation”) of
the photoemitted or probing electron, the spectrum is directly related to the one-particle Green
function which is deﬁned as
iG(x, x′) = ⟨N|T [ ˆψ(x) ˆψ†(x′)]|N⟩
⟨N| ˆψ(x) ˆψ†(x′)|N⟩for t > t′ (electron)
−⟨N| ˆψ†(x′) ˆψ(x)|N⟩for t < t′ (hole)
|N⟩is the exact N-electron ground state, ˆψ(x) is a ﬁeld operator in the Heisenberg representation which annihilates an electron at x = (r, t), and T is the time-ordering operator which arises
naturally from the time development operator deﬁned later in equation (14). The physical interpretation of the Green function is that for t′ > t it is is the probability amplitude that a hole created
at x will propagate to x′ and for t > t′, the probability amplitude that an electron added at x′ will
propagate to x. Thus, the Green function describes the photoemission and inverse photoemission
processes.
From the Green function we can obtain
• The expectation value of any single-particle operator in the ground state.
• The ground-state energy.
• The one-electron excitation spectrum.
In this review, we are mainly interested in the excitation spectra. The ﬁrst and the second
properties have not been explored for real systems.
From the Heisenberg equation of motion for the ﬁeld operator
= [ ˆψ(x), ˆH]
where the Hamiltonian is given by
d3r ˆψ†(x)h0(x) ˆψ(x) + 1
d3rd3r′ ˆψ†(x) ˆψ†(x′)v(r −r′) ˆψ(x′) ˆψ(x)
we obtain the equation of motion for the Green function:
G(x, x′) −
dx′′M(x, x′′)G(x′′, x′) = δ(x −x′)
where the mass operator (Hartree potential + self-energy) M is deﬁned to be such that
dx1M(x, x1)G(x1, x′) = −i
d3r1v (r −r1)
ˆψ†(r1, t) ˆψ(r1, t) ˆψ(r, t) ˆψ†(r′, t′)
h0 is the kinetic energy operator plus a local external potential. The quantity on the right hand
side is a special case of a two-particle Green function:
G2(1, 2, 3, 4) = (i)2⟨N|T
ˆψ(1) ˆψ(3) ˆψ†(4) ˆψ†(2)
where 1 ≡x1 = (r1, t1) etc.
The self-energy may be evaluated in at least two ways, either by using Wick’s theorem or by Schwinger’s functional derivative method . We follow the latter. This is done by introducing a time varying
ﬁeld φ(r,t) which is used as a mathematical tool for evaluating the self-energy and it will be set to
zero once the self-energy is obtained. Working in the interaction (Dirac) picture we have
|ψD(r, t)⟩= ˆU(t, t0)|ψD(r, t0)⟩
The time development operator ˆU is given by
ˆU(t, t0) = T exp
d3rφ(r, τ) ˆψ†
D(r, τ) ˆψD(r, τ)
The relationship between operators in the Heisenberg and Dirac representations is
ˆψ(r, t) = ˆU †(t, 0) ˆψD(r, t) ˆU(t, 0)
The ﬁeld operator ˆψD satisﬁes
ˆψD, ˆH(φ = 0)
so it is the same as the unperturbed (φ = 0) Heisenberg operator. The Green function can now be
written as
iG(1, 2) =
ˆU(∞, −∞) ˆψD(1) ˆψ†
⟨N 0| ˆU(∞, −∞)|N 0⟩
By taking functional derivative of G with respect to φ we get
= G(1, 2)G(3, 3+) −G2(1, 2, 3, 3+)
Using the above result for G2 in the deﬁnition of M in equation (11) the term GG gives the Hartree
potential V H and we deﬁne
Σ = M −V H.
The equation of motion for the Green function becomes
G(x, x′) −
dx′′Σ(x, x′′)G(x′′, x′) = δ(x −x′)
H0 = h0 + V H + φ
Using the identity
δφ(G−1G) = G−1 δG
δφ = −GδG−1
and evaluating δG−1/δφ, where from equation (21)
∂t −H0 −Σ,
Σ(1, 2) = i
d3d4G(1, 3+)W(1, 4)Λ(3, 2, 4)
W is the screened Coulomb potential
d3ǫ−1(1, 3)v(3 −2),
ǫ−1(1, 2) = δV (1)
where V is the sum of the Hartree and the external potential:
V = V H + φ
Λ is the vertex function
Λ(1, 2, 3) = −δG−1(1, 2)
= δ(1 −2)δ(2 −3) + δΣ(1, 2)
= δ(1 −2)δ(2 −3) +
d(4567) δΣ(1, 2)
δG(4, 5)G(4, 6)G(7, 5)Λ(6, 7, 3)
The second line is obtained from equation (24) and the last line by using the chain rule δΣ/δV =
(δΣ/δG)(δG/δV ) and by using the identity in equation (23) and the deﬁnition of Λ.
Fourier transformation of equation (21) gives (with φ now set to zero)
[ω −H0 (r)] G (r, r′, ω) −
d3r′′Σ(r, r′′, ω)G(r′′, r′, ω) = δ(r −r′)
If G0 is the Green function corresponding to Σ = 0, then we have the Dyson equation
G = G0 + G0ΣG
The ﬁrst term G0(1, 2) is a direct propagation from 1 to 2 without exchange-correlation interaction
and Σ contains all possible exchange-correlation interactions with the system that an electron can
have in its propagation from 1 to 2.
In practical application, G0 corresponds to H0 = HHartree + V xc where V xc is some local and
energy-independent exchange-correlation potential, e.g. V xc
LDA. In this case, the Dyson equation
G = G0 + G0∆ΣG
where ∆Σ = Σ −V xc.
B. The polarization and response function
The response function is an important quantity in the evaluation of the self-energy. It is related
to the inverse dielectric function ǫ−1 as follows:
= 1 + v δρ
= 1 + v δρ
The response function is deﬁned as
R(1, 2) = δρ(1)
which gives the change in the charge density upon a change in the external ﬁeld. We note that the
above response function is a time-ordered one which is related to the physical (causal) response
function RR by 
ReR(ω) = ReRR(ω),
ImR(ω)sgnω = ImRR(ω)
The polarization function is deﬁned as
P(1, 2) = δρ(1)
which gives the change in the charge density upon a change in the total (external + induced) ﬁeld.
Noting that
ρ(1) = −iG(1, 1+)
we can write
P(1, 2) = −i
d3d4G(1, 3)Λ(3, 4, 2)G(4, 1+)
In summary we have
ǫ−1 = 1 + vR
R = P + PvR
W = v + vPW
C. The Hedin equations
Summarizing the results in the previous sections, we arrive at the well-known set of coupled
integral equations . From equations (25), (31), (29), and
(42) we have
Σ(1, 2) = i
d(34)G(1, 3+)W(1, 4)Λ(3, 2, 4)
G(1, 2) = G0(1, 2) +
d(34)G0(1, 3)Σ(3, 4)G(4, 2)
Λ(1, 2, 3) = δ(1 −2)δ(2 −3) +
d(4567) δΣ(1, 2)
δG(4, 5)G(4, 6)G(7, 5)Λ(6, 7, 3)
W(1, 2) = v(1, 2) +
d(34)v(1, 3)P(3, 4)W(4, 2)
where P is given in equation (38).
Like G, Λ and W satisfy Dyson-like equations.
from a given approximation for Σ the above set of equations can be used to generate higher
order approximations. Although the equations are exact, a straightforward expansion for the selfenergy in powers of the screened interaction may yield unphysical results such as negative spectral
functions . In fact, the expansion itself is only
conditionally convergent due to the long-range nature of the Coulomb potential. So far there is
no systematic way of choosing which diagrams to sum. The choice is usually dictated by physical
intuition.
D. Quasiparticles
From the classical theory of Green functions the solution to equation (30) can be written in a
spectral representation:
G(r, r′, ω) =
Ψi(r, ω)Ψ†
where Ψi are solutions to the quasiparticle equation:
H0 (r) Ψi (r, ω) +
d3r Σ(r, r′, ω)Ψi(r′, ω) = Ei(ω)Ψi(r, ω)
In a crystal, the index i may be associated with the Bloch wave vector and band index. The
eigenvalues Ei are in general complex and the quasiparticle wavefunctions are not in general orthogonal because Σ is not Hermitian but both the real and imaginary part of Σ are symmetric.
Suppose at some ω = ωi we ﬁnd that ωi = ReEi(ωi). If ImEi(ωi) is small, then the imaginary
part of G is expected to have a peak at this energy (quasiparticle peak) with a life-time given by
1/ImEi(ωi). It may happen that ω −ReEi(ω) is zero or close to zero at some other energies and
if the corresponding ImEi(ω) are small, then we get satellites. For a non-interacting system, Σ is
Hermitian and therefore Ei is real so that the quasiparticle has an inﬁnite life-time.
The spectral representation can also be obtained directly from the deﬁnition of G by inserting
a complete set of (N ± 1)-electron states in between the ﬁeld operators and performing Fourier
transformation, keeping in mind that the ﬁeld operators are in the Heisenberg representation, i.e.
ˆψ(t) = exp(iˆHt) ˆψ(0)exp(−iˆHt).
G(r, r′, ω) =
dω′ A(r, r′, ω′)
ω −ω′ −iδ +
dω′ A(r, r′, ω′)
ω −ω′ + iδ
The spectral function or density of states A is given by
A(r, r′, ω) = −1
π Im G(r, r′, ω)sgn(ω −µ)
i (r′)δ[ω −µ + e(N −1, i)]
i (r)pi(r′)δ[ω −µ −e(N + 1, i)]
hi(r) = ⟨N −1, i| ˆψ(r, 0)|N⟩
pi(r) = ⟨N + 1, i| ˆψ†(r, 0)|N⟩
|N ± 1, i⟩is the ith eigenstate of the N ± 1 electrons with an excitation energy
e(N ± 1, i) = E(N ± 1, i) −E(N ± 1)
which is positive and E(N ± 1) is the ground-state energy of the N ± 1 electrons. The quantity µ
is the chemical potential
µ = E(N + 1) −E(N)
= E(N) −E(N −1) + O(1/N)
The physical meaning of the poles of G is therefore the exact excitation energies of the N ± 1
electrons. Since the poles of G in equations ( 47) and ( 49) must be the same, it follows that the
real part of Ei(ωi) are also the excitation energies of the N ± 1 electrons. For a very large system,
the poles are usually so close together that it is meaningless to talk about the individual poles, and
in an inﬁnitely large system, the poles form a branch cut. In this case, it is more meaningful to
interpret the excitation spectrum in terms of quasiparticles with energies ReEi(ωi) and life-times
1/ImEi(ωi).
From equation (31), the spectral function A is schematically given by
|Im Gi(ω)|
|Im Σi(ω)|
|ω −εi −Re ∆Σi(ω)|2 + |Im Σi(ω)|2
where Gi is the matrix element of G in an eigenstate ψi of the non-interacting system H0. A is
usually peaked at each energy Ei = εi + Re∆Σi(Ei) (quasiparticle peak) with a life-time given by
1/|Im Σi(Ei)| and renormalization factor (weight of the Lorentzian)
1 −∂Re ∆Σi(Ei)
At some other energies ωp, the denominator may be small and A(ωp) could also show peaks or
satellite structure which can be due to plasmon excitations or other collective phenomena.
If we start with a single-particle Hamiltonian which is in some sense close to the true interacting
Hamiltonian, the quasiparticles of the former Hamiltonian are just a set of δ-functions centred
at the single-particle eigenvalues. If the interaction is switched on, typically the delta functions
become broadened since the single-particle states can now decay to other excitations and lose some
weight which might appear as collective excitations or satellite structures. The term quasiparticle
is arbitrary but we usually refer to quasiparticle as an excitation originating from a single-particle
state and to satellite as an excitation not contained in the approximate non-interacting system.
The quasiparticle energy can also be calculated to ﬁrst order in Ei −εi as follows:
Ei = εi + Re ∆Σi(Ei)
= εi + Re ∆Σi(εi) + (Ei −εi)∂Re ∆Σi(εi)
= εi + ZiRe ∆Σi(εi)
E. The GW approximation
The GWA may be regarded as a generalization of the Hartree-Fock approximation (HFA) but
with a dynamically screened Coulomb interaction. The non-local exchange potential in the HFA
is given by
Σx(r, r′) = −
kn(r′)v(r −r′)
In the Green function theory, the exchange potential is written as
Σx(r, r′, t −t′) = iG(r, r′, t −t′)v(r −r′)δ(t −t′)
which when Fourier transformed yields equation (59). The GWA corresponds to replacing the bare
Coulomb interaction v by a screened interaction W :
Σ(1, 2) = iG(1, 2)W(1, 2)
This is physically well motivated especially in metals where the HFA leads to unphysical results
such as zero density of states at the Fermi level, due to the lack of screening. Formally, the GWA
is obtained by neglecting the second term in the vertex function in equation (29), i.e. setting
Λ(1, 2, 3) = δ(1 −2)δ(2 −3). Fourier transforming equation (60) we get
Σ(r, r′, ω) = i
dω′G(r, r′, ω + ω′)W(r, r′, ω′)
For a non-interacting G0 the imaginary part of the correlation part of the self-energy can be
evaluated explicitly:
Im Σc(r, r′, ω ≤µ) = π
kn(r′) Im W c(r, r′, εkn −ω)θ(εkn −ω)
Im Σc(r, r′, ω > µ) = −π
kn(r′) Im W c(r, r′, ω −εkn)θ(ω −εkn)
W c = W −v
is the frequency-dependent part of W. The above results are obtained by expressing G and W c in
their spectral representations. The spectral representation of G is given in equation (49). For W c
it is given by
W c(r, r′, ω) =
dω′ D(r, r′, ω′)
ω −ω′ −iδ +
dω′ D(r, r′, ω′)
ω −ω′ + iδ
D is proportional to the imaginary part of W and deﬁned to be anti-symmetric in ω:
D(r, r′, ω) = −1
π Im W c(r, r′, ω)sgn(ω)
D(r, r′, −ω) = −D(r, r′, ω)
The spectral representation of the correlation part of the self-energy is
Σc(r, r′, ω) =
dω′ Γ(r, r′, ω′)
ω −ω′ −iδ +
dω′ Γ(r, r′, ω′)
ω −ω′ + iδ
Γ(r, r′, ω) = −1
π Im Σc(r, r′, ω)sgn(ω −µ)
The real part of Σc can be obtained by performing the principal value integration (Kramers-Kronig
relation or Hilbert transform).
A physically appealing way of expressing the self-energy is by dividing it into a screened-exchange
term ΣSEX and a Coulomb-hole term ΣCOH (COHSEX) .
It is straightforward to verify that the real part of the self-energy can be written as
ReΣSEX (r, r′, ω) = −
i (r′)ReW (r, r′, ω −εi)
ReΣCOH (r, r′, ω) =
dω′ D (r, r′, ω′)
The physical interpretation of ΣCOH becomes clear in the static approximation due to Hedin
 . If we are interested in a state with energy E close to the Fermi level, the matrix element
⟨ψ|ReΣCOH(E)|ψ⟩picks up most of its weight from states with energies εi close to E in energy.
We may then assume that E −εi is small compared to the main excitation energy of D, which is
at the plasmon energy. If we set E −εi = 0, we get
ReΣCOH (r, r′) = 1
2δ (r −r′) W c (r, r′, 0)
This is simply the interaction energy of the quasiparticle with the induced potential due to the
screening of the electrons around the quasiparticle. The factor of 1/2 arises from the adiabatic
growth of the interaction. In this static COHSEX approximation, ΣCOH becomes local.
The polarization function needed to evaluate W is calculated within the random phase approximation (RPA) which corresponds to neglecting the second term in the vertex
function and using a non-interacting G0 :
P(r, r′, ω) =
kn(r)ψk′n′(r)ψ∗
k′n′(r′)ψkn(r′)
ω −εk′n′ + εkn + iδ −
ω + εk′n′ −εkn −iδ
We have used the fact that for every ψkn there is ψ∗
−kn with the same eigenvalue due to the timereversal symmetry. The wavefunction ψkn is normalized to unity in the entire space. The physical
meaning of the RPA is that the electrons respond to the total ﬁeld (external + induced ﬁeld) as if
they were non-interacting.
III. NUMERICAL METHODS
One of the main computational problems is to calculate the polarization in equation (73). Since
P can be long-ranged for crystals, the conventional method of calculating it is to use Bloch basis
functions. Noting that P(r + T, r′+T) = P(r, r′) , P can be expanded in general as follows
P(r, r′, ω) =
Bqi(r)Pij(q, ω)B∗
where {Bqi} is a set of Bloch basis functions large enough to describe P and the sum over q is
restricted to the ﬁrst Brillouin zone. The matrix elements of P in the basis are given by
Pij(q, ω) =
⟨Bqiψkn|ψk+q n′⟩⟨ψk+q n′|ψknBqj⟩
ω −εk+q n′ + εkn + iδ −
ω + εk+q n′ −εkn −iδ
Similarly, the Coulomb potential v can be expanded as in equation (74). The screened potential
W can then be calculated from equation (42).
The matrix element of the imaginary part of the self-energy in a state ψqn is given by
⟨ψqnψk−q,n′|Bki⟩ImW c
ij(k, ω −εk−q,n′)
× ⟨Bkj|ψk−q,n′ψqn⟩θ(ω −εk−q,n′)
If we are only interested in quasiparticle energies, it is more favourable to perform the frequency
integration in the expression for the self-energy in equation (61) along the imaginary axis . In this case, W must also be calculated along the imaginary axis which
is advantageous since the pole structure along the real axis is avoided. For states away from the
Fermi level, there is in addition a contribution to the self-energy from the poles of the Green
The choice of basis functions depends on the type of materials we are interested in. For sp
systems, plane waves are appropriate especially when used in conjunction with pseudopotentials.
For systems containing rather localized states such as the 3d and 4f systems, a large number of
plane waves would be needed and therefore localized basis functions are more suitable.
A. Plane-wave basis
In this case Bkj →exp [i(k + G) · r] /
Ωwhere the index j is represented by the reciprocal
lattice vector G and Ωis the unit cell volume.
This is probably the simplest basis with the
following advantages:
• Programming ease: The matrix elements can be calculated easily particularly when the
wave-functions are also expanded in plane waves.
• The Coulomb potential is diagonal with matrix elements given by 4π/|k + G|2.
• Good control over convergence.
The disadvantages are:
• It is not feasible to do all-electron calculations. In many cases, it is essential to include core
electrons. For example, the exchange of a 3d valence state with the 3s and 4p core states in
the late 3d transition metals is overestimated by the LDA by as much as 1 eV which would
lead to an error of the same order in the pseudopotential method.
• The size of the response matrix becomes prohibitively large for narrow-band systems due to
a large number of plane waves.
• No direct physical interpretation.
B. Localized basis
For systems containing 3d or 4f electrons, plane-wave basis becomes very costly. Methods based
on the linear-muﬃn-tin-orbital (LMTO) basis or Gaussian basis are more appropriate. In the
LMTO method , the wave functions are expanded as follows
χRL(r, k)bkn(RL)
where χ is the LMTO basis which in the atomic sphere approximation (ASA) for r in the central
cell is given by
χRL(r, k) = φRL(r) +
φR′L′ (r)hR′L′,RL(k)
φRL(r) = ϕRl(r)YL(Ω) is a solution to the Schr¨odinger equation inside a sphere centred on an
atom at site R for a certain energy ǫν, normally chosen at the centre of the band.
φRL is the
energy derivative of φRL at ǫν. One advantage of the LMTO method is that φRL is independent
of k. When forming the polarization function in equation (73) we have products of wave functions
for r or r′ of the form
ψψ = [φφ + since the latter can be
written as
R = P + PvP + PvPvP + . . .
so that the basis for R is completely determined by that of P. Although this product basis is not
complete for the Coulomb potential, it is of no consequence since v is always sandwiched between
two P’s. It can be easily shown that the product basis is also complete for the self-energy. Thus
schematically
Σ(kn, ω) = ⟨ψkn|iGW|ψkn⟩
= ⟨ψknψ|v|ψψkn⟩+ ⟨ψknψ|vRv|ψψkn⟩
which shows that it is suﬃcient to expand v in the product basis and the latter is therefore a
complete basis for the self-energy.
The energy loss spectra of Ni for q = (0.25, 0 0) 2π/a, a = 6.654a0. The large dots correspond
to the experimental spectrum taken from Feldcamp, Stearns, and Shinozaki . The solid line and small
dots are respectively the loss spectra with and without local ﬁeld corrections due to the inhomogeneity in
the charge density. Both spectra are calculated with 4s, 4p, 3d, 4d, 4f, and 5g orbitals, including an empty
sphere at (0.5, 0.5, 0.5)a and core excitations. After Aryasetiawan and Gunnarsson .
The number of product functions is still large, with nine spd orbitals we have 2[9(9 + 1)/2]
products of φφ and ˙φ ˙φ and 9 × 9 products of φ ˙φ giving in total 161 product functions. With spdf
orbitals the number of product functions is 528. It can be reduced considerably without too much
loss of accuracy by neglecting the
φ terms since they are small. Moreover, in the polarization
function there are no products between conduction states. Therefore in sp and d systems products
of φdφd and φfφf respectively can be neglected. After these eliminations, the remaining product
functions turn out to have a signiﬁcant number of linear dependencies, typically 30-50 %, which
can be eliminated further giving ∼100 optimized product functions per atom for spdf orbitals. A
product function is given by
eBα(r) = φRL(r)φRL′(r)
= ϕRl(r)ϕRl′(r)YL(Ω)YL′(Ω)
where α ≡(R,LL′). This function is non-zero only inside an atomic sphere centred on atom R.
There are no products between orbitals centred on diﬀerent spheres. The optimization is performed
by calculating the eigenvalues of the overlap matrix Oαβ = ⟨eBα| eBβ⟩and subsequently neglecting
eigenvectors with eigenvalues less than a certain tolerance. The optimized product functions are
then linear combinations
where z are the eigenvectors of the overlap matrix: Oz = ez. Due to the localized property of
the basis, the calculation of the dielectric matrix scales as N3. This approach has been used with
success to calculate loss spectra and self-energy for 3d
systems . The loss spectra of Ni calculated using the product
basis is shown in ﬁgure 1.
Another approach using a localized basis set is based on Gaussian functions . The wave functions and the dielectric matrix are expanded in this basis.
For Si, for example, the number of Gaussian orbitals needed to perform GW calculation is 40-60
whereas 350 plane waves are needed in the conventional approach. This approach has been applied
with success to a number of semiconductors and insulators and to semicore states in Si, Ge, and
CdS as well as to the Si surface.
C. The plasmon-pole approximation
One of the major computational eﬀorts in self-energy calculations is the calculation of the
screened interaction W. The physical features of W are well known; the imaginary part of W
is characterized by a strong peak corresponding to a plasmon excitation at the plasmon frequency.
This is particularly evident in the case of the electron gas or the alkalis such as Na and Al. The
plasmon-pole approximation assumes that all the weight in Im W resides in the plasmon excitation .
In the case of the electron gas, this is strictly true in the limit of long wave length q →0. For
ﬁnite q, the spectrum contains also particle-hole excitations at lower energies. The particle-hole
spectrum eventually merges with the plasmon excitation as q gets larger. Thus, in the simplest
form, the plasmon-pole approximation is given by 
Im ǫ−1 (q,ω) = Aqδ (ω −ωq). The two parameters Aq and ωq are determined from the static- and
f-sum rules. In the generalized plasmon-pole approximation due to Hybertsen and Louie ,
each matrix component of the inverse dielectric function is written (for positive frequency)
GG′ (q,ω) = AGG′ (q) δ (ω −ωGG′ (q))
The corresponding real part is given by
GG′ (q, ω) = δGG′ +
Comparison between the numerically calculated inverse dielectric function and the corresponding plasmon-pole results for Si. After Hybertsen and Louie .
The eﬀective bare plasma frequency ΩGG′ is deﬁned below. The unknown parameters AGG′ (q)
and ωGG′ (q) are determined from the static limit of ǫ−1:
GG′ (q, 0) = δGG′ + 2
GG′ (q, ω)
and the f-sum rule:
dω ω Im ǫ−1
GG′ (q, ω) = −π
Thus, there are no adjustable parameters. The f -sum rule is true for the exact response function
since it is obtained from the double commutator [[H, ˆρq+G] , ˆρq+G′] which yields
⟨0|ˆρq+G|s⟩⟨s|ˆρ†
q+G′|0⟩+ c.c.
= (q + G) ·
The states |s⟩are the exact many-body excited states and ρ (G) is the Fourier component of the
electron density. It can also be shown from the deﬁnition of the linear response dielectric function
in terms of the ground-state matrix element of the commutator of the density operators that
dω ω Im ǫ−1
GG′ (q,ω) = −π
2 v (q + G)
⟨0|ˆρq+G|s⟩⟨s|ˆρ†
q+G′|0⟩+ c.c.
The f-sum rule follows immediately from the last two equations recalling that ωp = 4πρ(0). The quality of the plasmon-pole approximation is illustrated in ﬁgure
One drawback of the Hybertsen and Louie model is that the plasmon frequency may become
complex, which is somewhat unphysical. A diﬀerent model proposed by von der Linden and Horsch
 circumvents this problem by using the dielectric-bandstructure approach. Here one deﬁnes
a Hermitian dielectric matrix
ǫGG′ (q, ω) = δGG′ +
GG′ (q, ω)
GG′ (q, ω) =
⟨k,n|ei(q+G)·r|k + q, m⟩⟨k + q, m|e−i(q+G′)·r|k, n⟩
ω −εkn + εk+q,m
The inverse static dielectric matrix is expressed in its eigen representation
GG′(q, 0) = δGG′ +
The matrix U is formed by the eigenvectors of the inverse dielectric matrix. The plasmon-pole
approximation is then obtained by introducing the frequency dependence in the eigenvalues:
i (q,ω) −1 =
ω2 −[ωi(q) −iδ]2
The eigenfunctions for ω ̸= 0 are approximated by the static eigenfunctions . As in the Hybertsen and Louie approach, the unknown quantities zi and ωi are
determined from the static limit of ǫ−1 and the f-sum rule. These give
zi(q) = ω2
q,i(G)(q + G) · (q + G′)
ρ(G −G′)Uq,i(G′)
It can be shown that the pole strength zi can be expressed in terms of the real-space eigenpotentials
zi(q) = ω2
d3rρ(r) |∇Ψqi(r)|2
Uqi(G)e−i(q+G)·r
so that the pole strength is positive deﬁnite. The eigenvalues d−1
of the static dielectric matrix
lies between (0,1) which implies that the plasmon frequencies ωi are all real . A generalization of the plasmon-pole model has been proposed by Engel et al 
and Engel and Farid .
One drawback of the plasmon-pole approximation is that the imaginary part of the self-energy
is zero except at the plasmon-poles. As a consequence, the life-time of the quasiparticles cannot
be calculated. Another drawback is its limited applicability to other than sp systems. For more
complex systems where the plasmon excitations merge with the particle-hole excitations, it is not
clear anymore if the plasmon-pole approximation is appropriate.
D. The space-time method
Conventional ways of performing self-energy calculations express all quantities in frequency and
reciprocal space. This is natural because in solids the Bloch momentum is a good quantum number
and by working in reciprocal space, one takes advantage of the lattice translational symmetry. In
the extreme case of the electron gas, the self-energy becomes diagonal in k. In fact, it has been
found numerically that in the Bloch-state representation, the self-energy is almost diagonal even
in systems that bear little resemblance to the electron gas . The reason for this has been clariﬁed recently by Hedin . The frequency
representation is also natural because most experiments generally focus on energy-dependent measurements.
For example, photoemission spectra are measured as functions of momentum and
energy. Theoretically, however, the self-energy becomes a multidimensional convolution when expressed in momentum-energy space which is computationally very expensive as may be seen in
equation (75). In space-time representation, on the other hand, the self-energy in the GWA takes
a simple multiplicative form
Σ (r, r′, t) = iG (r, r′, t) W (r, r′, t)
The response function also has a simple form
P 0 (r, r′, t) = −iG0 (r, r′, t) G0 (r′, r, −t)
and the non-interacting Green function G0 is given by
G0 (r, r′, t) =
kn ψkn (r) ψ∗
kn (r′) eiεknt,
ψkn (r) ψ∗
kn (r′) e−iεknt,
Evaluation of G0 in real time is not advantageous due to the oscillatory exponential term. In
imaginary time this exponential term decays rapidly and the summation can be performed easily.
G0 becomes 
G0 (r, r′, iτ) =
kn ψkn (r) ψ∗
kn (r′) e−εknτ,
ψkn (r) ψ∗
kn (r′) e−εknτ,
This is obtained by analytically continuing the expression for G0 in equation (49) from real to
imaginary energy and taking Fourier transform from imaginary energy to imaginary time. From
translational and lattice symmetry, r can be restricted to lie in the irreducible wedge but r′ must
run over all grid points which are located inside a large sphere of radius Rmax centred on r. The
method was tested for jellium and Si and typical values for the grids are ∆r = 0.5 a.u., ∆τ = 0.3
a.u., Rmax = 18 a.u., and τmax = 10 a.u., which give convergence in the quasiparticle energy
diﬀerences to 0.05 eV and absolute values to 0.1 eV .
Although the polarization function P 0 takes a particularly simple form in space-time representation, calculating ǫ−1 in real space is still computationally prohibitive because of the large size of
matrices in inverting the dielectric function. In practice, one performs six-dimensional fast Fourier
transform from (r, r′) to
 k, G, G′
and one-dimensional Fourier transform from imaginary time
to imaginary energy and solves for ǫ−1 as a matrix equation in G, G′ for each k and iω. After
forming WGG′(k, iω) one Fourier transforms back to real space and to imaginary time representation. The advantages of this method are that the computational eﬀort is much reduced compared
to the conventional techniques since the double summation over k points and bands are avoided
and there is no need for a plasmon-pole approximation.
For comparison with experiment, the self-energy has to be calculated at real frequencies. This
is achieved by ﬁrst calculating the self-energy and the matrix element of the self-energy correction
directly in real space ⟨ψkn|Σ (iτ) −V xc|ψkn⟩and then Fourier transforming the result from imaginary time to imaginary energy. The imaginary energy representation can then be analytically
continued to real energies by ﬁtting the self-energy to the multipole form
where the parameters ai and bi are in general complex. A good ﬁt is obtained with only n = 2
with an RMS error of 0.2 %. An example is shown in Fig. 3. The advantage of calculating the
self-energy along the imaginary axis is that one avoids the sharp pole structures in both G and W.
For quantities which require frequency integration, it is then useful to perform the integration along
the imaginary axis whenever possible. However, when the detailed structure of the self-energy is
required along the real axis, knowledge of it at a few points along the imaginary axis is not likely
to be suﬃcient.
The real part of the matrix elements of the self-energy operator of Si continued onto the real
axis for the ﬁrst 8 bands at k = 0. Inset: The matrix elements calculated along the imaginary axis for
band 4 (the valence band maximum) together with the ﬁtted form (with two poles). After Rojas, Godby,
and Needs .
One important aspect of the space-time method is its scaling with respect to the system size . It is found numerically that the range of W and Σ is rather material
independent so that the parameters Rmax and ∆r do not change with system size. This means that
the information stored as well as the computational time for the non-interacting response function
should scale linearly with the system size. However, the calculation of the dielectric function involves matrix inversions which scale as N3. It is still favourable compared with the conventional
plane-wave basis approach which scales as N4 but comparable to the localized basis approach which
also scales as N3 .
An interesting mixed-space approach for calculating the polarization function was recently proposed by Blase et al . The polarization function is written as
P(r, r′, ω) =
exp[iq · (r −r′)]Pq(r, r′, ω)
Pq(r, r′, ω) =
kn(r)uk+qn′(r)u∗
k+qn′(r′)ukn(r′)
ω −εk+qn′ + εkn + iδ −
ω + εk+qn′ −εkn −iδ
The function Pq(r, r′, ω) is periodic in r and r′ separately and it need be calculated within a
unit cell only which distinguishes this approach from the direct real-space method where one of
the position variables is not restricted to the central cell.
The former approach scales as N3,
similar to localized-basis methods. It was found that the crossover between the mixed-space and
reciprocal-space methods occurs for unit cells as small as that of Si.
The real-space or the mixed-space approach is suitable for systems with large unit cells and a
large variation in the electron density, or open systems.
IV. SIMPLIFIED GW
GW calculations are computationally expensive and therefore it is desirable to ﬁnd simpliﬁcations
which reduce the numerical eﬀort but still maintain the accuracy of the full calculations. So far
there is no simpliﬁed GW theory that is applicable to all systems. Most simpliﬁed theories are for
semiconductors and insulators. Although some success has been achieved, none of these models
is very reliable.
While band gaps can be reasonably well reproduced by these models, details
of bandstructures are not satisfactorily described. It is a major challenge to construct a good
approximation for the self-energy which includes both non-locality and energy dependence but
which is simple enough to be applicable to complex systems without signiﬁcant loss of accuracy.
A. The static Coulomb-hole and screened-exchange (COHSEX) approximation
One of the earliest attempts to simplify GW self-energy is the static COHSEX approximation
 . It is obtained formally by setting E −εkn = 0 in equations (70) and (71) yielding
ΣSEX(r, r′) = −
kn(r′)W(r, r′, ω = 0)
ΣCOH(r, r′) = 1
2δ(r −r′) [W(r, r′, ω = 0) −v(r −r′)]
The ﬁrst term is the exchange self-energy but with a statically screened interaction. The second
term is the Coulomb-hole term which is the interaction energy between the quasiparticle and the
potential due the Coulomb hole around the quasiparticle, as a result of the rearrangement of the
electrons (screening). Both the screened-exchange and the Coulomb-hole terms in equations (70)
and (71) are energy dependent and non-local respectively but in the static COHSEX approximation
they are energy independent and the Coulomb-hole term is local. The validity of the COHSEX
approximation relies on whether E −εkn is small compared to the energy of the main excitation
in the screened interaction which is essentially the plasmon energy. Comparison to the results
of the full calculations shows that the COHSEX approximation consistently overestimates the
magnitude of the self-energy, by about 20 % in Si, resulting in larger band gaps in semiconductors
 . For E corresponding to an occupied state, most of the error resides
in the Coulomb-hole term. The approximation E −εkn = 0 is more severe for the Coulomb-hole
term than for the screened-exchange term because the Coulomb-hole term involves a sum over
unoccupied states as well as over occupied states whereas the screened-exchange term involves a
sum over occupied states only.
Another source of error comes from the neglect of dynamical renormalization or Z-factor in
equation (57). When taking the matrix element ⟨φkn|Σ|φkn⟩and setting E −εkn = 0, this approximately corresponds to calculating the self-energy at E = εkn but the true self-energy should be
calculated at the quasiparticle energy, leading to the formula in equation (58). Indeed, a signiﬁcant
improvement can be obtained if the Z-factor is taken into account when the self-energy itself is
calculated within the COHSEX approximation.
B. Improving the COHSEX approximation
An attempt to include dynamical renormalization into a simpliﬁed GW scheme was made by
Bechstedt et al . In this scheme, the energy dependent part of the self-energy is expanded
to linear order around the LDA eigenvalue. A proper calculation of the self-energy derivative, or
equivalently the Z-factor, requires unfortunately a full frequency dependent response function. It
is not suﬃcient to calculate the static response function and its energy derivative at ω = 0. For
the screened-exchange term, on the other hand, knowledge of the ﬁrst energy derivative of the
response function at ω = 0 is suﬃcient to expand ΣSEX to ﬁrst order around the LDA eigenvalue.
To take into account the energy dependence of the self-energy, the screened interaction W is
calculated within the plasmon-pole model. The static dielectric function is modelled by 
ǫ(q, ρ) = 1 +
(ǫ0 −1)−1 + α
where kF and qT F are the Fermi and Thomas-Fermi wave vectors respectively which depend on
the average electron density ρ. This model for ǫ interpolates between the free-electron gas result
1 + (2ωp/q2)2 at high q, 1 + α(qT F /q)2 at small q (Thomas-Fermi theory) and the q = 0 value
ǫ0 for the semiconductor. It allows analytical calculation of the screened Coulomb interaction.
The coeﬃcient α is obtained by ﬁtting the model dielectric function to a full RPA calculation for
ω = 0. The values of α turn out to be material independent for those semiconductors considered
(Si, GaAs, AlAs, and ZnSe).
To take into account local ﬁeld eﬀects due to the inhomogeneity in the charge density, an LDA
ansatz is used 
W(r, r′, ω = 0) = 1
W h(r −r′, ρ(r)) + W h(r −r′, ρ(r′))
where W h is the screened interaction for the electron gas. The sum rule, that the total induced
charge around a test charge is −1 + 1/ǫ0, is fulﬁlled but the induced charge density is allowed
to vary according to the local density. Using this model, the static Coulomb-hole term can be
calculated analytically 
VCOH(r) = −
2 qT F (r)
1 + qT F (r)
It is interesting to observe that the matrix element of Σdyn = Σ −ΣCOHSEX and its energy
derivative can be shown to be independent of the state if local ﬁeld eﬀects are neglected. The state
dependence thus comes from the local ﬁeld eﬀects and it is found to be rather weak. We note
also the dependence on qT F ∼ρ1/3 as in the LDA. Σdyn gives an upward shift of ∼1.4 eV for all
the materials mentioned above. This means that good values for the band gaps are obtained by
using Σ = ΣCOHSEX but taking into account the dynamical renormalization factor Z. The results
for Si, GaAs, AlAs, and ZnSe show agreement with the full GW calculations to within 0.2 eV for
most of the states considered. Application was also made to GaN recently .
This scheme reduces the computational eﬀort by two orders of magnitude. Further tests on a
wide range of semiconductors and insulators are desirable to evaluate the validity of the number
of approximations used in the model.
C. Extreme tight-binding models
One of the major problems in GW calculations is the calculation of the response function. In
electron-gas-like materials such as the alkalis, it is reasonable to model the dielectric function with
a single plasmon and to neglect oﬀ-diagonal elements.
In semiconductors, however, local ﬁeld
eﬀects, which are described by the oﬀ-diagonal elements of the dielectric matrix, are important.
The local ﬁeld is dominant at distances on the interatomic scale so that high Fourier components
are needed to describe it in plane wave basis resulting in a large matrix. It is therefore advantageous
to calculate the dielectric matrix and its inverse directly in real space. Real-space approach is also
useful for systems with low symmetry.
Ortuno and Inkson proposed an extreme tightbinding model where the valence and conduction bands were assumed to be ﬂat so that the band
gap Eg is the only parameter entering the model. Due to its simplicity, the model allows analytic
evaluation of the dielectric function to a certain degree.
The wavefunctions are expanded in localized Wannier functions
eik·Tφnν (r −T) cnν (k)
where φnν is a Wannier function localized in bond ν and T is a lattice translational vector. In the
two-ﬂat-band model, the coeﬃcients cnν are equal to one. Since φnν is localized in each cell and
in each bond, we have
d3r φnν (r −T) φnµ
Using this expansion in the expression for the polarization function and using the ﬂat-band approximation, εk′n′ −εkn = Eg, one arrives at a simple expression for the dielectric function:
ǫ (r, r′, ω) = δ (r −r′) −N (ω)
d3r′′v (r −r′′) Aν (r′′ −T) A∗
ω2 −(Eg −iδ)2
Aν (r −T) = φcond,ν (r −T) φ∗
val,ν (r −T)
This has the form of a separable matrix ǫ = 1 −BC 
whose inverse is given by ǫ−1 = 1 + B (1 −CB)−1 C. Under certain approximations, the matrix ǫ
can be inverted giving a screened interaction 
W (r, r′, ω) =
d3r′′ǫ−1 (r, r′′, ω) v
= v (r −r′) −
E2g + ω2p −ω2
Dν (r −T) D∗
Dν (r −T) =
d3r′v (r −r′) Aν (r′ −T)
and ωp is the plasmon energy. The approximation is good in the limit Eg ≫ωp. The screened
potential is eﬀective at ω = Eg and approaches a bare value at ω = ωp. The quantity Dν (r −T)
represents a dipole moment at r due to bond ν in cell T. The physical interpretation of the second
term in equation (114) is that an electron on a site interacts with other electrons through the
Coulomb interaction, inducing dipole moments on the other sites. These dipoles in turn produce
a potential which is screened by other induced dipoles by the frequency-dependent factor arising
from the inversion of the dielectric function .
Using the above screened interaction, the self-energy can be evaluated analytically. Deﬁning a
state-dependent local potential
d3r′Σ (r, r′, ω = En) ψkn (r′) = V xc
gives two potentials for the valence and conduction states respectively 
COHSEX (r) = −ρ1/3 (r) γ
COHSEX (r) = −ρ1/3 (r) γ
ν (r −T) v (r −r′) Aν′ (r′ −T)
is an on-site exchange interaction and
Comparison with the LDA exchange-only potential, V LDA
= −[3/π]1/3 ρ1/3, gives a value for
 2π21/3 . It is interesting to observe that although the potentials have been derived
from extreme tight-binding picture, one arrives at a formula similar to that obtained from the
electron gas .
The method has been applied to C, Si, GaAs, Ge, and ZnSe (Jenkins, Srivastava, and Inkson
Good agreement with the full GW calculations are obtained for Si and GaAs but not
for the other two materials. Perhaps this is not surprising in view of the ﬂat extremal bands in
Si and GaAs, making them ideal for the present approach. Moreover, the pseudopotentials used
in the LDA calculations are better for the ﬁrst two materials than for the last two so that the
eigenfunctions used to calculate the matrix elements of the self-energy are correspondingly better.
The LDA exchange only gap is 0.41 eV whereas the calculated value is 1.25 eV (experimentally
1.17 eV). The direct gap at the Γ point is also improved from 2.49 eV to 3.32 eV (experimentally
3.35 eV). In the case of Ge the improvement is not as good as in the case of Si but while the
LDA predicts Ge to be a metal with a negative band gap of -0.19 eV, the method gives a gap of
0.34 eV albeit too low compared to experiment (0.89 eV). In diamond, the method improves the
gap at the Γ point from 5.46 eV in the LDA (exchange only) to 7.87 eV (experimentally 7.4 eV).
Similar improvement is also obtained across the Brillouin zone. Finally, the results for ZnSe are
rather poor. The band gap is overestimated by ∼1 eV (3.77 eV vs 2.82 eV). The problem could
be related to the diﬃculties of treating 3d states within the pseudopotential approach resulting in
relatively poor wavefunctions.
A similar tight-binding approach was also proposed by Hanke and Sham and Bechstedt
and Del Sole . They derived an analytical model for Σ, V xc, and the gap correction in
insulators. They arrived at a similar ρ1/3 formula for the exchange-correlation potential but they
also included a term corresponding to the bare conduction-band exchange which is neglected in the
Sterne and Inkson model. The method was applied to Si, diamond, and LiCl and the results are
within a few percent of the more elaborate calculations. A more recent work uses orthogonalized
linear combination of atomic orbitals with applications to diamond, Si, Ge, GaAs, GaP, and ZnSe.
The gaps are generally within 10 % of the experimental values .
D. Quasiparticle local density approximation (QPLDA)
This approximation is based on the work of Sham and Kohn who
showed that for a system with a slowly varying density the self-energy is short range in |r −r′|
although for larger energies the self-energy is expected to be long range since screening is not very
eﬀective at large energies. Numerical calculations by Hedin show that the self-energy of
the homogeneous electron gas quickly vanishes beyond |r −r′| = 2rs for ω ≈EF and it depends
therefore on the density in the vicinity of (r + r′) /2 which suggests the following approximation
 
Σ (r, r′, ω) ≈Σh (r −r′, ω −∆µ (n) ; n)
where Σh (r −r′, E; n) is the self-energy operator of the homogeneous electron gas with density n,
n = n [(r + r′) /2] , and ∆µ = µ −µh (n) is the diﬀerence between the true chemical potential and
that of the homogeneous electron gas of density n. The local density approximation for the selfenergy is obtained by assuming the quasiparticle wavefunction in equation (48) as a superposition
of locally plane-wave-like functions 
Ψ (r,ω) ≈A(r)eik(r,ω)·r
which when inserted into the quasiparticle equation gives the solution ω (E) = E if k satisﬁes the
local-density condition k = kLD with
LD + V H (r) + Σ (kLD, E −∆µ (n) ; n) = 0
In obtaining the above equation, the r dependence of A and k has been neglected. For a slowly
varying density, the local change in the chemical potential from its homogeneous value is simply
given by the electrostatic potential (Thomas-Fermi) :
V H (r) = ∆µ [n (r)]
and by deﬁnition
µh (n) = 1
F (n) + µxc (n)
F (n) + Σ (kF , µh (n) , n)
Using the last two expressions, the condition for the local-density wave vector becomes
= (E −µ) −[Σh (kLD, E −∆µ (n) ; n) −Σh (kF , µh (n) ; n)]
When operating on the locally plane-wave function, the eﬀect of the non-local operator
Σh (r −r′, E) can be reproduced exactly by a local operator Σh (kLD, E; n) δ (r −r′) . The local density approximation for the self-energy operator consists of using this local operator when
operating on the actual wave function at energy E. It may happen that for some values of E
equation (126) has no solution for positive k2
LD. In this case, one should analytically continue the
self-energy operator into complex momentum. An early work of approximating the self-energy by
a local potential using information from the local density is given by Hedin and Lundqvist .
Instead of calculating the full self-energy Σh (k, E; n) it is useful to write 
Σh (k, E; n) = µxc (n) + Σh (k, E; n) −Σh (kF , µh; n)
= µxc (n) + ∆(k, E; n)
since µxc has been calculated rather accurately for the electron gas. The GWA is then used to
calculate the relatively small quantity ∆. Hedin and Lundqvist calculated ∆(kLDA) and for
metals, the self-energy corrections in the local-density approximation turn out to be very small.
∆is of the order of a few ×10−2 eV. For Ni, for example, the corrections are smaller than 0.1 eV
 . The main reason for such small corrections is probably due to the weak energy
dependence of the electron-gas self-energy. Furthermore, most of the eﬀect of the self-energy is
already accounted for by the local term µxc. The QPLDA self-energy is dominated by a constant
contribution and the assumption of slowly varying density is probably not good enough in many
Above, the homogeneous electron gas was used to obtain an approximate self-energy for inhomogeneous systems. For semiconductors and insulators one can also use a homogeneous insulator
model for this purpose which turns out to give a signiﬁcant improvement. The presence of an
energy gap in these systems brings in new physics not presence in the electron gas. The response
function needed to calculate the screened interaction is obtained from a model semiconducting
homogeneous electron gas. One simply introduces a gap in the otherwise metallic spectrum of the
electron gas, that is to say 
ǫ2 (k, ω) =
(k, ω−) , |ω| > λEF
F sgn ω. This function satisﬁes the f-sum rule. The dielectric gap λEF ,
which is in general larger than the minimum direct gap, is determined from the experimental value
of the static, long-wavelength dielectric constant ǫ0,
where ωp =
4πn is the plasmon frequency. The single-particle spectrum has a gap Eg
2Egsgn (k −kF )
The gap Eg is taken to be the average value across the Brillouin zone of the direct gap and it
is numerically diﬀerent from λEF . It can be shown that the valence bands are lowered and the
conduction bands are raised by the self-energy corrections, independently of the density sampled
by the wave functions. This means, the QPLDA will always lead to an increase in the gap over
the LDA value .
The QPLDA was applied to Si and diamond with considerable success. For Si, the zone-boundary
transitions X4 →X1, L′
3 →L3, and L′
3 →L1 are well reproduced by the QPLDA. The zone-centre
transition Γ25′ →Γ15 is underestimated by 0.25 eV, which is the worst case but the transition
Γ25′ →Γ15 is reproduced well. The calculated indirect gap of 0.93 eV still underestimates the
experimental value by 0.24 eV. The QPLDA gives a valence-band width of 12.5 eV, in good
agreement with the experimental data 12.4 ± 0.6 eV and 12.6 ±
0.6 eV . For diamond, the QPLDA gives an indirect gap of 5.74 eV, which is
a slight overestimate compared to the experimental value of 5.47 eV. The LDA value is 4.05 eV.
The Γ25′ →Γ15 gap is experimentally about 7.3 eV and the QPLDA gives 7.36 eV (compared
to the LDA value of 5.51 eV). The valence-band width is 23.4 eV, in good agreement with the
experimental data of McFeely et al. (24.2 ± 1.0 eV) but in disagreement
with the data of Himpsel et al (21 eV) . The LDA
band width is 20.4 eV.
E. LDA + δΣCOHSEX
In metals, the screened interaction W decreases rapidly for |r −r′| > k−1
T F but in insulators and
semiconductors, it decreases as 1/ǫ0 |r −r′| for large |r −r′| since the screening is not complete.
Accordingly, one writes 
W (r, r′, ω) = W IEG (r, r′, ω) + δW (r, r′, ω)
where W IEG is the short-range interaction potential of a metallic inhomogeneous electron gas and
δW has the same long-range behaviour as W. The self-energy arising from the ﬁrst term in W has
been shown by Sham and Kohn to be short ranged and depends only on the density in the
vicinity of r and r′, and is therefore approximated by a local potential:
ΣGW (r, r′, ω) = µxc (r, ω) δ (r −r′) + i
dω′G (r, r′, ω + ω′) δW (r, r′, ω′)
Pickett and Wang found that the inclusion of energy dependence in the local exchangecorrelation potential had very little eﬀects on the eigenvalues obtained with an energy-independent
LDA potential. It is then assumed that for states close to the Fermi level, µxc takes its value at
the Fermi level µxc
LDA (r) . Furthermore, it is assumed that δW depends only on |r −r′| , which is
strictly valid only when |r −r′| →∞, but it has been found numerically that in non-metals the
local ﬁeld eﬀects become negligible as |r −r′| exceeds the interatomic distance . One now makes the COHSEX approximation on
δΣ, rather than on the full self-energy:
δΣ (r, r′) = −ρ (r, r′) δW (r −r′) + δΣCOH
where the ﬁrst term is the screened exchange contribution and
is the Coulomb hole contribution which is a constant, shifting all eigenvalues by the same amount.
The Fourier transform of δW is given by
δW (q) = 4π
SC (q, q,ω = 0) −ǫ−1
M (q, ω = 0)
SC (q, q,0) is the diagonal part of the inverse dielectric matrix for the semiconductor calculated in the RPA and ǫ−1
M (q, 0) is the inverse of the static Lindhard dielectric function of a homogeneous electron gas.
Applications to diamond, Si, Ge, GaAs, AlAs, and GaP give in general agreement to within 0.2
eV with the results of the full calculations. Larger deviations (0.3-0.4 eV) occur for the X4v →X1c
gap in diamond and the Γ25′v →Γ2′c gaps in Ge. The Coulomb-hole contribution δECOH is positive
and cancels approximately the eﬀect of the screened exchange term in the valence bands. As a
result, the net eﬀect of the self-energy correction is to shift the conduction band upwards and leave
the valence bands essentially unchanged. This is also in agreement with the full calculations.
V. APPLICATIONS
A. Alkali metals
The early calculations in the GWA were performed for the electron gas, because of its simplicity.
 . The alkali metals are therefore of particular interest,
being the systems which are the closest approximation to the electron gas. For these systems the
correlation eﬀects are only moderately strong, and the GWA could therefore be expected to be
relatively accurate. It therefore created a lot of interest when the ﬁrst high-resolution angular
resolved photoemission experiments for the alkali metals appeared . Two unexpected observations were made. First
the band width was smaller than expected. For Na the occupied part of the band was found to
be 2.65 eV broad . This is consistent with an old angular-integrated
measurement by Kowalczyk et al . This band width is substantially smaller than the width
3.2 eV predicted by nearly free electron (NFE) theory. Figure 4 shows the experimental peak
position (crosses) as a function of the photon energy together with the prediction of NFE theory
(dashed line).
The band narrowing is about a factor of two larger than the narrowing (0.27
eV) predicted by GW calculations for the electron gas of the appropriate density .
Although this error is not very large in absolute terms, it raised questions about the accuracy of
the GWA for these systems. In addition a set of essentially dispersionless states were observed
close to the Fermi energy, which was completely unexpected according to the NFE band structure.
This raised the interesting issue that the alkali metals may have charge density waves for Na metal and by Surh et al
 for K, using a generalized plasmon pole approximation. These calculations gave essentially
the same band narrowing (0.31 eV) for Na as a GW calculation for the electron gas. A much
better agreement with experiment was, however, obtained by using an improved dielectric function
 
ǫ−1 = 1 + v[1 −P(v + Kxc)]−1P,
where P is the independent particle polarizability and Kxc = δV xc/δρ with V xc the (LDA)
exchange-correlation potential and ρ the density.
Equation (136) gives the appropriate dielectric function within the density functional formalism. Using this ǫ instead of the RPA ǫ, the band
width narrowing increased from 0.31 eV to 0.57 eV. Finally, a calculation was performed using a
Green function with a certain self-consistency, namely with the LDA eigenvalues replaced by the
quasi-particle energies. This led to a further increase of band width narrowing to 0.71 eV. Lyo and
Plummer also observed large eﬀects of including the corrections to the dielectric function
in equation (136).
The theoretical justiﬁcation for including such corrections without simultaneously adding vertex
corrections is, however, weak. We notice that the total energy of the system can be expressed in
terms of the dielectric function. The quasi-particle energies can then be obtained by diﬀerentiating
with respect to the occupation numbers . If the dielectric function has the form of
equation (136), it was shown that there is also a vertex correction of the type 
Mahan and Sernelius have extensively tested various corrections to the dielectric function,
including the corresponding vertex corrections when calculating the self-energy. They found that
for the electron gas the vertex corrections cancel most of the eﬀects of the corrections of the
dielectric function, and the ﬁnal results are rather close to the original GWA. Del Sole, Reining,
and Godby obtained similar conclusions for Si. The results for the electron gas suggest that
there are discrepancies between appropriate self-energy calculations and the peak positions in the
photoemission experiments.
Peak position as a function of photon energy for photoemission at normal angle from the Na
(110) surface. The crosses show experimental results , the ﬁlled circles show
the photoemission calculations of Shung and Mahan , the full line the quasi-particle energies and
the dashed lines the NFE theory. .
The relation between the peak position in photoemission and the quasiparticle energies was
studied by Mahan and coworkers in a series of papers, focussing on surface and quasiparticle
life-time eﬀects . They studied a model which
includes the rapidly varying potential in the surface region as well as lattice potential in the
bulk. The eﬀects of these potentials on the photoemission process were included, while the lattice
part of the potential was neglected when calculating the states. The self-energy was calculated
using the Rayleigh-Schr¨odinger perturbation theory, which gives results that diﬀer slightly from
the traditional GW results. For instance, the Na band width is reduced by 0.37 eV due to this
self-energy. Mahan and coworkers furthermore included the eﬀects of the imaginary part of the
self-energy of the emitted electron, by using wave function φ> for these electrons which decayed
exponentially inside the surface. Finally, the self-energy of the initial state was included as well.
Due to the exponential decay of φ>, the electron momentum perpendicular to the surface is not
conserved, and there are nonvertical (non k⊥-conserving) transitions.
Mahan and coworkers found that the broadening of the initial state and the instrumental resolution as well as the interference between bulk and surface photoemission shift the apparent peak
positions towards lower binding energies relative to the quasiparticle energies by about 0.2-0.4 eV
 . Including these eﬀects as well as the quasiparticle self-energy shifts leads
to the ﬁlled circles in ﬁgure 4. There is a substantial band narrowing relative to the quasiparticle
energies (full line) and the agreement with experiment is generally quite good. This suggests that
the GWA gives good quasiparticle energies for Na, and that the main reason for the discrepancy
between these energies and the photoemission peak positions can be explained by considering the
details of the photoemission process.
Mahan and coworkers also gave an explanation for the unexpected features close to the Fermi
energy (see the essentially dispersionless structure in ﬁgure 4). These features occur for photon
energies for which there are now vertical, energy-conserving transitions available.
Due to the
exponential decay of φ>, nonvertical but energy-conserving transitions are available. It was shown
that interference between surface and bulk emission puts most of the weight of these transitions
close to the Fermi energy . ﬁgure 4 illustrates that the theory can almost
completely explain the experimental features, with just a few experimental points at larger photon
energy unexplained. Thus there seems to be no need to assume a charge-density wave to explain
this structure.
B. Semiconductors and Insulators: sp systems
The LDA systematically underestimates the band gaps in semiconductors and insulators. In
table I the calculated LDA band gaps of some materials are compared with the experimental gaps.
The discrepancies range from 30-100 % and for Ge the LDA conduction and valence bands in fact
overlap when relativistic corrections are included. Also, individual bands away from the Fermi
level can be in error up to 50 %. It is natural to ask if the band-gap problem originates from the
error in the LDA. Exchange-correlation potentials V xc calculated from GW self-energies turn out
to be similar to the LDA V xc which indicates that even the
exact V xc probably does not give the correct gap but this is still an open question. The V xc may
be a non-analytic function of the particle number . That is to say, V xc with an extra electron, V xc
N+1, may have
an additional constant compared to V xc
and this constant may be large. Moreover, experience
with empirical potentials shows that a local potential cannot in general give both the correct band
structure and the ground-state electron density .
In table I the band gaps of some materials calculated within the GWA are shown. The agreement
with experiment is very good, in most cases to within 0.1 eV. Although it is not strictly true, the
self-energy correction is approximately an upward rigid shift of the conduction band relative to the
valence band, the so called scissor operator, i.e. cutting the band structure along the band gap
and shifting the conduction band rigidly upwards. The scissor operator is accurate to 0.1, 0.2, 0.2,
and 0.4 eV in Si, GaAs, AlAs, and diamond respectively . The
validity of the scissor operator in Si is somewhat fortuitous, due to an almost complete cancellation
between the strong energy dependence and non-locality.
The experimental values are obtained from optical measurements or photoemission and inverse
photoemission experiments. The latter corresponds closer to the theoretical values whereas the
former may contain excitonic binding energy which should be subtracted oﬀbut unfortunately it is
unknown. In optical experiments, the excited electron does not leave the system and may therefore
form an exciton with the corresponding hole.
To discuss in more details the features in the self-energy which are important for the quasiparticle energies, we consider Si as a prototype since it has been studied extensively. The main
features are energy dependence and non-locality. We ﬁrst consider non-locality within the COH-
SEX approximation. A measure of non-locality in the self-energy is its range, the distance |r −r′|
beyond which the self-energy is approximately zero. This range rh is approximately given by the
corresponding value for a jellium with the average density of Si (rs = 2) and rh ∼2rs. In Si
more than 99 % of the matrix element of the self-energy in a state ψ, ⟨ψ|Σ|ψ⟩, originates from
|r −r′| < rh. One expects non-locality to be important when rh is comparable to or greater than
the extent or wavelength of the wavefunction which is the case in Si. The matrix element in a
non-local potential can be very sensitive to the nodal structure of ψ. This is contrary to the case
when Σ is local such as V xc since it is then |ψ|2 that enters into the integral. In Si, non-locality
has the eﬀect of widening the gap. This can be understood as follows. The top of the valence band
is bonding p whereas the bottom of the conduction band is antibonding p. Therefore non-locality
has a larger eﬀect on the conduction band than on the valence band since the antibonding state
has an extra node which means a smaller wavelength than that of the bonding state. The presence
of an extra node in the antibonding state reduces the matrix element ⟨ψ|Σ|ψ⟩relative to ⟨ψ|V xc|ψ⟩
and therefore the conduction band is pushed upwards. Non-locality has a smaller eﬀect on the
valence state so the net eﬀect is a widening of the gap .
(a) and (c) show the screening potential in response to a single electron at r′ (indicated by +)
in the (1¯10) plane of Si in units of Ry. (b) and (d) show the contribution from local ﬁelds only. The bond
chain is indicated by a straight line. After Hybertsen and Louie .
The non-locality arises from the density matrix (exchange charge)
ρx(r, r′) =
and the screened potential W(r, r′, ω). In semiconductors, the screening is not complete because
due to the gap, a ﬁnite energy is required to excite a particle-hole pair. The range of the screened
interaction and its nodal structure are then determined by ρx. Apart from non-locality, anisotropy
also plays an important role. In a homogeneous system, ρx and W only depend on |r −r′|. In an
inhomogeneous system, the screening potential W −v as a function of r′ may strongly depend on
the location r of the test charge. In Si, for example, there is a large accumulation of charge in
the bonding region as opposed to the antibonding region. It is to be expected that the screening
potential of a test charge located in the bonding and antibonding regions will be very diﬀerent,
as shown in ﬁgure 5. This local ﬁeld eﬀect , which is entirely missing in the homogeneous case, is
very important in covalent materials. Local ﬁelds are crucial in determining the strength of the
screening hole but not its shape and they contribute directly to the diﬀering strengths of Σ at
diﬀerent points in the unit cell and therefore to the band-gap correction ﬁgure 5 . In Si local ﬁelds account for more than one-third of the screening potential in the
region around the bond as can be seen in ﬁgure 5.
Contour plots of the self-energy Σ(r, r′, ω=midgap) in eV a.u.−3 for r ﬁxed at the bond centre
and r′ shown in the (110) plane for (a) Si, (b)GaAs, (c) AlAs, and (d) diamond. For Si the corresponding
plots with r ﬁxed at the tetrahedral interstitial site is also shown (e). For comparison, the self-energy
operator of jellium with rs = 2.0 (the average electron density of Si) is shown in (f) ).
After Godby, Schl¨uter, and Sham .
The local ﬁelds shift the centre of the screening potential and increase it in the bonding region
and reduce it in the interstitial. The local ﬁeld eﬀect is one important feature in Si which distinguishes covalent-bond semiconductors from the alkalis. The screening potential in these materials
is therefore considerably more complex than in the alkalis. Calculations for Si show that the local
ﬁeld eﬀect in W is conﬁned to a region near r as shown in ﬁgure 5. This is not surprising since
the long-range part of the potential is contained in the diagonal element W(q) corresponding to
small q. In the plane-wave basis, the local ﬁelds are described by the oﬀ-diagonal elements of the
dielectric matrix. Nevertheless, Σ(r, r′, ω = 0) is almost spherical as a function of r′ for a ﬁxed
r and it is reasonably well reproduced by jellium Σ with the same average density as that of Si.
This is illustrated in ﬁgure 6. However, the interaction of the wavefunction with the non-locality
in Σ is not contained within the jellium model.
The local ﬁeld eﬀect has a large inﬂuence on ΣCOH. In fact, in a homogeneous system ΣCOH
is a constant within the COHSEX approximation (equation (105)). Thus, if local ﬁeld eﬀect is
neglected, ΣCOH has no eﬀects on the band dispersion. ΣCOH is deeper in the bonding region and
shallower in the antibonding region as shown in ﬁgure 7. Since the valence state is concentrated
in the bonding region and the conduction state in the antibonding region, ΣCOH makes a large
contribution to the gap. ΣCOH is, however, a local potential within the COHSEX approximation,
a feature which is common to V xc as opposed to ΣSEX which is non-local. This mechanism of gap
opening by ΣCOH could in principle be accounted for by V xc. The local ﬁeld eﬀect on ΣSEX, on
the other hand, is small, since the local ﬁeld eﬀect is rather localized and ΣSEX is dominated by
the large bare Coulomb interaction for small |r −r′|. The local ﬁeld contribution to ΣSEX is about
25 % of that to ΣCOH but of opposite sign . Non-locality is essential
in determining the correct quasiparticle energies and in particular the band gap.
The local potential corresponding to the Coulomb hole part of the electron self-energy in the
COHSEX approximation in the (1¯10) plane of Si in units of Ry. After Hybertsen and Louie .
The COHSEX approximation is a static approximation to the self-energy. Strictly speaking, the
quasiparticle energy should be obtained from the position of the peak in the spectral function.
This procedure requires knowledge of the energy dependence of the self-energy at least around the
quasiparticle energy. The degree of the energy dependence is related to the renormalization factor
Z (weight of the quasiparticle, equation (57)): the smaller Z, the stronger the energy dependence.
The value of Z for semiconductors is 0.7-0.8 . The slope of the real
part of the self-energy around the chemical potential is negative and the renormalization factor Z
reduces the self-energy correction, as shown in equation (58). Thus, if the energy dependence of the
self-energy is neglected, that is if the self-energy were calculated at the LDA instead of quasiparticle
energy, the band-gap correction would be overestimated. This is in agreement with the results of
the COHSEX approximation which approximately corresponds to neglecting the renormalization
factor Z. A similar conclusion is reached if the self-energy is approximated by its value at ω = 0.
In this case the self-energy correction for the valence state would be underestimated whereas for
the conduction state overestimated, leading again to an overestimated band gap. A much better
agreement is obtained if the self-energy correction (ΣCOHSEX −V xc) is simply multiplied by Z. We
note that the COHSEX approximation without local ﬁeld eﬀect generally gives a gap in better
agreement with experiment, although not for Si. This means that local ﬁeld eﬀect, or in a certain
sense non-locality, tends to cancel energy dependence. The importance of energy dependence is
illustrated by plotting ⟨ψkn|Σ(Ekn) −V xc|ψkn⟩and ⟨ψkn|Σ(0) −V xc|ψkn⟩as a function of Ekn.
The ﬁrst quantity is very much like a step function (scissor operator) while the second quantity
shows a strong energy dependence . The
eﬀect of energy dependence is therefore to alter greatly the dispersion of the individual bands.
In general, the energy dependence of Σ leads to a strongly state-dependent self-energy correction
∆Σ = Σ −V xc within each band as well as across the gap. The weak state dependence of ∆Σ
for Si within a band, resulting in a scissor operator, is therefore a coincidence. In diamond, for
instance, the scissor operator approximation is not as good as in Si.
(a) and (c): The exchange charge in the (1¯10) plane of Si with r′ ﬁxed (indicated by +) in units
of electrons/cell. (b) and (d): The screened-exchange part of the self-energy ×|r −r′| in the COHSEX
approximation in units of a.u. Ry./cell and the contours increase in powers of 2. After Hybertsen and
Louie .
The highest occupied state in the exact DFT gives the exact ionization energy . Assuming that the LDA V xc is close to the exact one, we expect the self-energy
correction to shift the conduction band but not the top of the valence band. If the RPA is used
to obtain the electron gas data , it is indeed found that the the
top of the valence band is almost the same within the LDA and the GWA . More accurate electron gas data obtained from GW calculations or Quantum Monte Carlo simulations , however,
shift the top of the valence band upward by about 0,5 eV. Thus, vertex corrections (corrections
beyond the GWA) may shift the GW bandstructure by 0.5 eV upwards or the LDA may not be suﬃciently accurate.
Other authors have also repeated GW calculations for Si band structure with similar results
 . Calculations of the
quasiparticle bandstructure and the band gap of many semiconductors and insulators have been
performed by a number of authors. Quasiparticle band structures of six II-VI compounds ZnS,
ZnSe, ZnTe, CdS, CdSe, and CdTe have been calculated by Zakharov et al . We list in
table I the results of these calculations. Quasiparticle energies for the F-center defect in LiCl have
also been calculated by Surh, Chacham, and Louie and self-energy calculations of carrierinduced band-gap narrowing in Si may be found in the work of Oschlies, Godby, and Needs . Berggren and Sernelius also studied the band-gap narrowing in doped Si and Ge
as a function of impurity concentration. Application of the GWA to metal-insulator transition
of Si in the diamond structure suggests that the metalization occurs
at a much smaller volume than in the LDA which in turn indicates that the the Fermi surface
obtained from the Kohn-Sham DFT is not necessarily the same as that of the real system as
shown by Sch¨onhammer and Gunnarsson for model systems. Recently, application to a
two-dimensional crystal found good agreement between the quasiparticle energies in the GWA and
Quantum Monte Carlo results .
Al0.5Ga0.5As
AlN (wurtzite)
AlN (zinc-blende)
CdS (zinc-blende)
1.37i, 0.83g
2.83i, 2.45g
CdS (wurtzite)
CdSe (zinc-blende)
CdSe (wurtzite)
CdTe (zinc-blende)
CdTe (wurtzite)
5.6a, 5.33b, 5.67c
1.58b, 1.32c, 1.22e
1.52α, 1.63γ
GaN (wurtzite)
GaN (zinc-blende)
3.2δ, 3.3ǫ
0.75a, 0.65c
In0.53Ga0.47As
1.29a, 1.24b, 1.25c
ZnS (zinc-blende)
ZnS (wurtzite)
ZnSe (zinc-blende)
ZnSe (wurtzite)
ZnTe (zinc-blende)
ZnTe (wurtzite)
Minimum band gaps of semiconductors and insulators which have been calculated within
the GWA. The energy is in eV.
αNumerical Data and Functional Relationships in Science and Technology 1982
βBaldini and Bosacchi 1970
γAspnes 1976
δLei et al 1992a,b, Eddy et al 1993
ǫPaisley et al 1989, Sitar et al 1992
ζWhited, Flaten and Walker 1973
ηCardona, Weinstein, and Wolﬀ1965
θRauch 1940
aHybertsen and Louie 1986
bGodby, Schl¨uter, and Sham 1988
cRohlﬁng, Kr¨uger, and Pollman 1993
dRubio et al 1993
eZhu and Louie 1991 (The number in the bracket corresponds to a calculation using a model dielectric matrix)
fSch¨onberger and Aryasetiawan 1995
gRohlﬁng, Kr¨uger, and Pollmann 1995a
hAlbrecht, Onida, and Reining 1997
iZakharov et al 1994
1. Core polarization
A disadvantage of using pseudopotentials is a diﬃculty of including the core states in the calculation of the exchange potential as well as the polarization. Within a pseudopotential scheme, it
is inevitable that core electrons are treated in an approximate manner. The core electron charge
densities are frozen at their atomic values in the reference conﬁguration used for constructing the
pseudopotential. The core electrons and their potential are then eliminated so that there is no
possibility for them to relax. Core relaxation gives rise to crystal ﬁeld distortion and strong mixing
between 3d and 3p states. These single-particle eﬀects are small and can be included a posteriori
by comparison with all-electron calculations. It is, however, important to take into account manybody eﬀects arising from core relaxation since they can be large. In atoms with easily polarizable
core the inclusion of core relaxation leads to an increase in the ionization energies, a contraction
of the valence shell, a reduction of polarizabilities and oscillator strengths of the valence electrons.
The self-energy may be broken up into three terms :
Σ = iGcW + iGvWv + iGvvRcv
where W = Wv +vRcv. The ﬁrst term is the core-valence and core-core (screened) exchange which
is essentially the same as the bare exchange since screening is ineﬀective for small distance. The
second term is the self-energy of the valence electron and the last term is the screened polarization
potential due to the core electrons acting on the valence electrons. In pseudopotential calculations,
the ﬁrst and last term together are approximated by the LDA. The absolute contribution from
these terms is estimated to be ∼1 eV for atomic Na and solid Al
 but the diﬀerence Σ −V xc, which is a more relevant quantity, is
much smaller. For s-p semiconductors, this diﬀerence can be signiﬁcantly larger. As a result, the
calculated direct gaps and also the orderings and splittings of the conduction bands in Ge and
GaAs, materials of technological interest, are in disagreement with experiment. It is important
to get the orderings of the conduction band right since they aﬀect the transport properties and
life-time of thermally excited carriers. Atomic calculations in Ge estimate the error for the 4s and
4p states to be 0.3 and 0.04 eV respectively . If this error is taken
into account, the result for the band gap becomes even better. In transition metals it is crucial to
include the core electrons in the calculations of the bare exchange since the error can be as large
While the core-valence exchange can be treated straightforwardly in the Hartree-Fock theory,
core-valence correlation is more complicated. A good approximation for taking into account core
polarization is provided by the core polarization potential (CPP) method used in quantum chemistry . The physical idea behind this method is that core polarization functions are characterized by sharp high-frequency excitations and rather insensitive to the
valence environment. This allows evaluation of the core polarization function for isolated atoms
and neglect of frequency dependence. Consider a valence electron in the presence of a core. The
electron polarizes the core resulting in polarization p =αc∇(1/r) where r is the position of the
electron with respect to the core. From classical theory of electrostatic, the electric ﬁeld arising
from this polarization at r′ is given by
E (r′) = 3 (p · r′) r′ −r′2p
The potential experienced by another electron at r′ due to core polarization is then
Ve−e (r, r′) = −αc
assuming that both r and r′ are large. For a set of cores and many valence electrons, the core
polarization potential is
VCP P = −1
where fc is the electric ﬁeld acting on core c due to the valence charges at i and all other cores.
where C is a cut-oﬀfunction, Zc′ is the net charge of core c′ and Rcc′ = Rc′ −Rc. Inserting fc
into equation (142) yields 
VCP P = −1
C2 (rci) +
C (rci) C(rcj)
rci · Rcc′
cc′ Zc′C(rci) +
Rcc′ · Rcc′′
cc′′ Zc′Zc′′
The ﬁrst term is the CPP in atoms with a single valence electron. Without the cut-oﬀfunction,
it would diverge at small r. The cut-oﬀfunction C is semi-empirical with a parameter related to
the size of the core . The ﬁrst term is a
one-particle operator which is added to the pseudopotential. The second term is the two-electron
interaction which was qualitatively discussed above. The third term is an indirect interaction of
a valence electron with another core. This term is repulsive and cancels the attractive potentials
from the ﬁrst and last term. The latter is a core-core interaction and, together with the third term,
essential to make sure vanishing long-range interaction with a neutral atom.
The eﬀective interaction among the valence electrons is given by 
WC = v + v
Rc′v + . . .
Rc is the full or self-consistent response function of core c given by
vRcv = Ve−e
Thus, the screened interaction becomes
1 −WCP 0−1 WC
where P 0 is the valence RPA polarization function. Using this CPP formalism, various transition
energies for Si, Ge, AlAs, and GaAs were calculated by Shirley, Zhu, and Louie . The results
for the fundamental bandgaps of Si, Ge, AlAs, and GaAs shown in table II are in systematically
better agreement with experiment compared with previous calculations where core relaxation effects were taken into account within the LDA only. The correction can be as large as 0.4 eV for
the fundamental gap in GaAs. Notable also (not shown in the table) is the correct L −Γ −X
ordering of conduction-band states in Ge obtained in the CPP approach. X −L and X6c −X7c
splittings in GaAs are also improved .
The CPP formalism is relatively easy to implement in many-body valence calculations without increasing computational cost signiﬁcantly. Apart from its use within the pseudopotential
approach, it can also be used in all-electron calculations with frozen core.
Γ8v →0.85X5c
Fundamental bandgaps of Si, Ge, AlAs, and GaAs calculated within the LDA and the
GWA including core polarization within the CPP formalism compared with
experiment . Energies are in eV.
C. Transition metals
The success of the GWA in semiconductors has encouraged applications to more complicated
systems of transition metals and their compounds. From numerical point of view, transition metals
require a new approach for calculating the response function and the self-energy. The conventional
plane-wave basis is not suitable in this case because the localized nature of the 3d states results
in a prohibitively large number of plane waves. From theoretical point of view, it has been argued
that the localized nature of the 3d states makes atomic approach as more suitable for explaining
the characteristic properties of transition metals. The presence of a Fermi surface as shown by de
Haas-van Alphen measurements, on the other hand, strongly suggests that the itinerant character
of the 3d electrons should be taken into account. Moreover, the band widths in transition metals
are not too small and the ratio between the Hubbard U and the band width is of order one.This is
crucial when we consider screening of a photoemission hole where 3d electrons from neighbouring
cells can take part in the screening whereas such possibility is absent in the atomic case.
seems then that RPA-type of approach such as the GWA is meaningful for these systems. GW
calculations for transition metals have not been extensively performed. We concentrate therefore on
two materials Ni and NiO for which full GW calculations have been done in some details and on MnO
for which a model GW calculation has been performed .
Among the transition elements, Ni is the most anomalous case in many respects. The LDA
bandstructure deviates signiﬁcantly from angle-resolved photoemission data. The occupied 3d-band
width is 30 % smaller than that of the LDA (3.3 eV vs 4.5 eV) and the experimental exchange splitting is half the LDA value (0.25-0.30 eV
vs 0.6 eV) . Furthermore there is the famous 6 eV satellite below
the Fermi level which
is entirely missing in the LDA or in any single-particle theory. These discrepancies are related
to excited-state properties. An indication that single-particle theories would have diﬃculties in
describing quasiparticle properties in Ni is the fact that the two lowest atomic conﬁgurations 3d94s
and 3d84s2 are almost degenerate, diﬀering by only 0.025 eV . Another indication
of many-body eﬀects in Ni is the unusually large quasiparticle widths - up to 2 eV at the bottom of the 3d band - which implies strong interaction between the
quasiparticles and the rest of the system resulting in short life-times. The photoemission process
introduces an additional 3d hole to an already existing one, causing on-site many-body correlations
not amenable to a single-particle treatment. This is in contrast to Cu where there is only one 3d
hole after photoemission and where the LDA bandstructure is good, apart from a somewhat too
high position (0.4 eV) of the 3d band relative to the 4s band .
Ground-state properties such as equilibrium lattice constant, bulk modulus, and magnetic moment
are well reproduced by the LDA with the exception of the cohesive energy where the LDA value
is about 1 eV too small .
The GW results for Ni may be summarized as follows : The LDA bandstructure is much improved, in particular the 3d-band width is
narrowed by almost 1 eV, as shown in ﬁgure 9. The quasiparticle life-times are also given rather
well by the GWA but the exchange splittings remain essentially unchanged from their LDA values
and the 6 eV satellite is not reproduced.
The self-energies show a number of interesting features. As an illustration, the self-energy as a
function of frequency for the Γ′
25 state is shown in ﬁgure 10. The imaginary part of the self-energy
is signiﬁcantly more complicated compared with those of the alkalis or semiconductors. The latter
are typically characterized by a large peak associated with a plasmon excitation but they otherwise
show no other distinct structures. The frequency structure of the imaginary part of the self-energy
is determined essentially by the imaginary part of the screened interaction W, as may be seen in
equation (62). In alkalis or s −p semiconductors Im W is dominated by a plasmon peak which is
then mirrored in Im Σc. Similarly in Ni, there is a strong similarity between Im W (ﬁgure 1) and
Im Σc. In transition metals, there is no well-deﬁned plasmon excitation, rather it merges with the
single-particle excitations forming a broad spectrum. There is a two-peak structure at about 20
and 30 eV which is probably due to plasmon excitation. An estimate based on the electron gas
formula gives a plasmon energy of 30.8 eV when the 3d electrons are included in the density. This
coincides rather well with the second large peak in the two-peak structure. A smaller structure at
around 5-6 eV originates from transitions from the occupied valence band to states just above the
Fermi level which constitute a large density of states. Interesting to observe is the behaviour of
Im Σc at large frequencies. The hole and particle parts show similar behaviour and they therefore
tend to cancel each other when one performs a Hilbert transform to obtain the real part of the
self-energy. This justiﬁes the use of energy cut-oﬀin the calculation of the response function. It
also agrees with our physical intuition that the main contribution to the self-energy should come
from energies up to the plasmon energy. For states lying a few eV below the Fermi level, the hole
part (negative energy) of Im Σc has larger weight than the particle part (positive energy). This
simply reﬂects the fact that the hole (occupied) states have larger overlap and correlation with
other occupied states resulting in larger correlated part of the self-energy for the hole part. As
we go towards the Fermi level, the hole and particle parts become of almost equal weight. This is
the reason why the self-energy correction for states at the bottom of the band is larger than for
those at the top of the band, resulting in band narrowing. Im Σc around the Fermi level shows a
quadratic Fermi liquid behaviour but it becomes linear rather quickly.
The real part of the self-energy is obtained by Hilbert transforming the imaginary part.
notable feature is a large derivative at around the Fermi level which implies large renormalization
of the quasiparticle weights. Typical values for the renormalization factor is 0.5 for the 3d states
 .
This is signiﬁcantly smaller than in the electron gas (0.7) or semiconductors (0.8) which reﬂects a larger loss of
single-particle character of the quasiparticles. The s states on the other hand have renormalization
factor ∼0.7, comparable to those in the alkalis and semiconductors. It is in agreement with our
physical picture that the 3d states are more correlated than the 4s-4p states.
In comparison with semiconductors, the self-energy corrections in Ni is considerably more complicated. While in semiconductors the self-energy correction is approximately a scissor operator
which increases the band gap by shifting the conduction band upwards and leaving the valence band
unchanged, the self-energy correction in Ni shows a rather strong state and energy dependence.
The self-energy correction can be positive or negative depending on the state and its magnitude
varies throughout the Brillouin zone. For example, at the X-point the bottom of the 3d band
experiences a self-energy correction of 0.8 eV while the top of the band is almost unchanged. The
correction to the state Γ′
25 is positive whereas at L′
2 state it is negative. The state dependence of
the self-energy correction is demonstrated clearly in ﬁgure 9 by the lowest valence band which is of
4s character at the bottom and a mixture between s and d at the top. The self-energy correction is
approximately zero at the bottom of the band and positive at the band edges. The free-electronlike s states are well described by the LDA but the description of the more localized d states is
less satisfactory.
As can be seen in ﬁgure 9, the 3d band width is reduced by almost 1 eV. The exchange splittings
on the other hand remain essentially unchanged from their LDA values. The discrepancy between
the LDA exchange splitting and the experiment is rather small, 0.3 eV, which is slightly larger
than the numerical accuracy (0.1-0.2 eV) but the results seem to indicate inadequacy in the GWA
itself. GW calculations on transition metal atoms also show that strong correlations among 3d
electrons of opposite spin are not well accounted for by the GWA . The
quasiparticle widths or the inverse life-times are in reasonable agreement with available experimental data . The large width at the bottom of the 3d band indicates a strong
interaction between the quasiparticles and the rest of the system.
The band structure of Ni along Γ = (0, 0, 0) and X = (1, 0, 0) and along Γ and
L = (0.5, 0.5, , 0.5).
The solid curves are the experiment and the dotted curves are the LDA . The ﬁlled circles are the quasiparticle energies in the GWA. After Aryasetiawan and Aryasetiawan and von Barth .
As mentioned before, the 6 eV satellite is not reproduced in the GWA. That the 6 eV satellite is
missing in the GWA can be seen directly in the imaginary part of the self-energy. For the existence
of a satellite, there should be a strong peak at around 5-6 eV reﬂecting the presence of a stable
excitation. But as can be seen in ﬁgure 10, such peak is missing.
3p-resonance photoemission measurements at 67 eV photon energy corresponding to the binding
energy of the 3p core exhibit an asymmetric (Fano) resonant enhancement of the satellite and the
main 3d line shows a strong antiresonance . This is explained as an Auger
process where a 3p core electron is excited to ﬁll the empty 3d states followed by a super Coster-
Kronig decay
3p63d94s + ¯hω →3p53d104s →3p63d84s + e
Although there is some indication that the 6 eV structure might arise from single-particle states
 the 3p resonance photoemission provides a strong evidence of
the many-body character of the 6 eV satellite. The standard explanation for the presence of the
satellite is that a 3d hole created in a photoemission experiment
introduces a strong perturbation due to its localized nature, causing another 3d electron to be
excited to an empty state just above the Fermi level. In atomic picture, the state with two 3d
holes correspond to the conﬁguration 3d74s2 which is separated from the main line conﬁguration
3d84s by more than 6 eV but which is reduced considerably by metallic screening. The two holes
scatter each other repeatedly forming a ”bound state” at 6 eV. In a simple picture, the photon
energy is used to emit a d electron and to excite another into an empty d state so that the emitted
electron appears to have a lower binding energy (satellite). The excited electrons mainly come
from the bottom of the d band since they have the largest mixing with the s-p states and therefore,
according to the dipole selection rule, a large transition to the empty d states. This then has been
argued as the source of band narrowing. The GW calculations, however, show that the largest
contribution to band narrowing comes mainly from screening rather than two-hole interactions.
The real and imaginary parts of the correlation part of the self-energy for the minority and
majority spin state Γ′
25 (The lowest 3d state at the Γ point). The units are in a.u. (Hartree=27.2 eV).
After Aryasetiawan .
The reduction in the exchange splittings is related to the satellite. For simplicity we consider
a two-level model with fully occupied majority channel and one occupied minority channel. A
photoemission hole in the majority channel can induce another hole in the minority channel but
not vice versa since the majority channel has no empty states.
Thus, the eﬀects of two-hole
interactions are larger for the majority than for the minority channel resulting in a reduction in
the exchange splitting. Calculations based on the Hubbard model within the t-matrix approach
 conﬁrm this picture . These model calculations
also assign the reduction in the band width as originating from the two-hole interactions which is
not in complete agreement with the GW calculations. These results may be reconciled as follows.
In the t-matrix calculations, it was found that there was no value of U that gave the correct
satellite position and the band width. To get the correct band width, the value of U was such
that the satellite energy became too large . If we assume that the t-matrix theory
gives the correct physical description for the satellite, the appropriate value of U would not give
a large reduction in the band width, but this is taken care of by the GWA. Thus one concludes
that self-energy calculations which include the diagrams of the GWA and t-matrix theory may give
both the correct band width and the satellite structure. Diagrammatic comparison between the
GWA and the t-matrix theory reveals that hole-hole interactions described by the t-matrix are not
included in the GWA except to second order only. Direct comparison between GW calculations
on real systems and Hubbard model calculations is, however, diﬃcult if not impossible. This is
because the Hubbard U cannot be easily related to the screened interaction in theGW calculations.
An extension of the t-matrix theory including Fadeev’s three-body interaction 
was made by Igarashi and by Calandra and Manghi . The theory has
been applied to Ni and NiO .
2. Nickel Oxide
NiO is a prototype of the Mott-Hubbard insulators. It was pointed out by Mott in the late forties
that a system with an on-site Coulomb energy larger than the single-particle bandwidth tends to
become an insulator and that single-particle theory is bound to give a wrong prediction for the
state of the system . Indeed, the LDA predicts NiO to be a metal when the calculation
is performed in a paramagnetic state . Slater suggested that a gap could
be opened by an interplay between antiferromagnetism and crystal-ﬁeld splittings. A detailed work
along this direction can be found in a paper by Terakura et al . The LDA does
produce a gap in an antiferromagnetic state but of only 0.2 eV in contrast to the experimental gap
of 4.0 eV . As expected, the
free-electron like O p band is well described by the LDA but the magnetic moment is too small (1.0
µB) compared to experiment (1.7-1.9 µB) . Clearly there is something seriously wrong with the LDA. A more convincing evidence is
provided by CoO, where the number of electrons in the paramagnetic structure is odd, making it
impossible for any single-particle theory to predict CoO as an insulator without doubling the unit
cell. Experimentally, CoO is an antiferromagnetic insulator so that one might argue like Slater
that single-particle theory could still give the correct prediction if the calculation is performed
in an antiferromagnetic structure. One realizes, however, that the diﬀerence in magnetic energy
distinguishing the paramagnetic and antiferromagnetic states is only a fraction of an eV, which
is much smaller than the band gap. This means that the result of a theoretical calculation for
the band gap should not depend on whether the calculation is performed in a paramagnetic or an
antiferromagnetic structure.
The basic physics of the Mott-Hubbard insulators was explained by Mott several decades ago
 .
From the tight-binding limit, switching on hopping matrix elements causes the
formation of a band of width w centred around the atomic eigenvalue. The possibility of occupying
states with lower energy favours electron hopping but it costs a Coulomb energy U for an electron
to hop from one site to the neighbouring site. If U is larger than w, the gain in kinetic energy is
overwhelmed by the loss in Coulomb energy and the system prefers to be an insulator with a gap
approximately given by U, splitting the lower and upper Hubbard bands. While the Mott picture
is essentially correct, there are a number of experimental data which cannot be explained. The
value of U, for instance, is estimated to be 8-10 eV which is much larger than the experimental gap.
More recent studies initiated by Fujimori, Minami, and Sugano and Sawatzky
and Allen based on the cluster approach and Anderson impurity model
show that the gap in NiO is a charge-transfer gap. If an electron is removed from a Ni site the
number of holes increases leading to a state with high energy due to an increase in the Coulomb
interaction among the holes. The hole created on the Ni site may be ﬁlled by the transfer of
an electron from an O site. Although it costs some energy transfer this leads to a state with
a small binding energy . The states at the top of the valence band therefore have a large O p
character. The lowest conduction state is of d character as in the Mott picture and the gap is
therefore formed between the valence O p and conduction Ni d states. Much of the Ni d weight
goes into a satellite located below the O p, opposite to the Mott and the Slater pictures. This
model is able to explain experimental data which would otherwise be diﬃcult to explain by the
Mott and Slater pictures. The most convincing evidence supporting the charge-transfer picture is
the 2p resonant photoemission experiment in CuO which has a similar electronic
structure as that of NiO. In this experiment, a 2p core electron is excited and the remaining hole is
subsequently ﬁlled by a valence electron. Since dipole transition matrix element is largest between
p and d states, resonance in the valence energy region can be identiﬁed as the position of d states
which turns out to be below the O p band, rather than above as in the Mott and Slater pictures.
(a) Comparison between the LDA (solid line) and the experimental band structure of Antiferromagnetic II NiO. From Shen et al . (b) Comparison between the LDA band structure
(solid line) and the quasiparticle band structure in the GWA (ﬁlled circles) for NiO. After Aryasetiawan
and Gunnarsson .
The LDA antiferromagnetic bandstructure is shown in ﬁgure 11. The highest valence state is
formed by the majority eg and minority t2g Ni states and the lowest conduction band is formed
by the minority eg state. GW calculation for NiO gives a gap of ∼5.5 eV . Starting from the LDA antiferromagnetic bandstructure with a gap of 0.2
eV, a GW calculation shifts the Ni eg conduction upwards, increasing the gap to ∼1 eV. This
upward shift of the eg conduction band leads to a substantial change of the character of the
wavefunctions, reducing the amount of minority eg character in the occupied states. To include
a limited self-consistency, we introduce a new non-interacting Hamiltonian H0 with a non-local
potential ∆|eg⟩⟨eg| where ∆is chosen so that the band gap obtained from H0 agrees with the
gap obtained from the previous GW calculation. This H0 is then used to generate a new G0
and a new self-energy in the GWA. This procedure is iterated to self-consistency. The non-local
potential modiﬁes the eigenvalues as well as the wave functions used to construct the zeroth order
Green function G0. The raising of the unoccupied majority eg band by the self-energy correction
reduces the hybridization with the O p band and has the eﬀects of raising the bottom of the O
p band and pushing down the top of the O p band at the Γ -point resulting in better agreement
with photoemission data.
In addition, the width of the unoccupied eg band is reduced.
reduction in hybridization also reduces the magnitude of the exchange interaction of the eg band
with the occupied states which has the consequence of widening the gap. Thus, it is important
that the wave functions are also modiﬁed in the self-consistent procedure. The ﬁnal position of the
unoccupied eg band is just below the Ni 4s. As a check, the calculation has also been performed
in the ferromagnetic state. A gap of ∼5.2 eV was obtained, close to the antiferromagnetic value.
In contrast to the Slater model, the gap does not depend on the antiferromagnetic ordering and
the results correctly predict that NiO remains an insulator above the N´eel temperature.
GW calculation clearly improves the LDA gap markedly and it is in reasonable agreement with
the experimental value of 4.0 eV. An estimate of the magnetic moment yields a value of 1.6 µB
 in good agreement with the experimental value of 1.7-1.9
The spectral function of antiferromagnetic NiO at k =
3(1 0 0)2π/a within the GWA
projected on the O p orbitals (solid line) and the Ni d orbitals (The dotted line corresponds to the
majority spin and the dashed line the minority spin). After Aryasetiawan and Gunnarsson .
To study the character of the states at the top of the valence band, the spectral function has
been calculated. Projection of the spectrum into the Ni 3d and O p orbitals shows that there is an
increase of the O p character at the top of the valence band but the main character is primarily Ni
3d. The satellite at -8 eV is not reproduced
at the ﬁnal self-consistent spectrum but a more detailed study of the satellite structure reveals
that it is rather sensitive to the starting Hamiltonian . Starting
from the LDA Hamiltonian in fact gives a satellite at about -10 eV but this satellite diminishes
in intensity as the gap opens up. The origin of this behaviour can be traced back to the presence
of a plasmon-like peak at low energy which is related to the incorrect LDA bandstructure. As
the gap opens up, this peak structure becomes broadened and consequently the satellite structure
diminishes. As in the case of Ni, it appears that the satellite structure is due to short-ranged
correlations which are not properly taken into account by the RPA. T-matrix approach could be
appropriate and might remove some Ni d weight from the top of the valence band to the satellite
region but it is not clear how this could increase the charge transfer from the O p.
3. Manganese Oxide
A calculation on MnO based on a simpliﬁed GW scheme described in section 4 has been performed by Massidda et al . The electronic structure of MnO is the simplest among the
transition metal oxides and in some respects similar to NiO. As in the case of NiO, the LDA gives
a too small band gap of 1.0 eV compared with the experimental value of 3.8-4.2 eV. The magnetic
moment is also somewhat too small (LDA 4.3 µB, experiment 4.6-4.8 µB) although the relative
discrepancy is not as large as in NiO. The larger LDA band gap is due to the fact that in MnO
the majority spin is fully occupied and the minority spin is empty resulting in a large magnetic
moment so that the exchange splitting is also large and dominates the ligand-ﬁeld splitting and
band broadening due to intersublattice coupling. In NiO the magnetic moment is smaller and the
exchange splitting is comparable to the ligand-ﬁeld splitting and band broadening.
The semiempirical model GW calculation gives a gap of 4.2 eV which compares well with the
experimental value of 3.8-4.2 eV. The LDA magnetic moment is also improved to 4.52 µB. There is
an increase of O p character and a decrease of Ni 3d character at the top of the valence band, which
are percentagewise large but small in absolute term, so that the main character is still primarily
Ni 3d. The results are qualitatively similar to the full GW calculations on NiO described above.
Calculation on CaCuO2 using the model GW scheme was also done recently .
4. 3d semicore states
It is well-known that the LDA eigenvalues for localized states are usually too high compared to
experiment. The discrepancies can be several eV. For example, the Zn semicore 3d states in ZnSe
are too high by 2.5 eV, the Ga semicore 3d states in GaAs by 4 eV and the Ge 3d semicore states
by as much as 5 eV. In free atoms these deviations are even larger and in, for instance, a free Zn
atom the 3d eigenvalue is about 6.5 eV too high. This raises interesting questions about whether
or not GWA can describe these shallow core levels and why the LDA eigenvalues are substantially
worse for free atoms than for solids, although the semicore states are almost completely localized.
For deep core levels, an important contribution to the GWA self-energy comes from the polarization (relaxation) of the more weakly bound electrons .
This relaxation is a classical electrostatic eﬀect, which can be described in ∆SCF calculations, performing ground-state calculations with and without the core hole. Explicit ∆SCF calculations for
free atoms were performed by Hedin and Johansson , who obtained quite accurate results.
This suggests that GWA may be rather accurate for such deep core levels, since it includes similar
physics as the ∆SCF calculations.
Partial densities of spin-up states of antiferromagnetic MnO. Top panel: the total O 2p
projection into the O spheres. Second and third panels: d projection into the two inequivalent Mn spheres.
Solid (dashed) lines correspond to the model GW (spin polarized LDA) calculations. Bottom panel, upper curves: Inverse photoemission spectrum and the diﬀerence between the
on- and oﬀ-resonance photoemission spectra , representing the Mn contribution. Lower curves: GW d-projected density of states into both Mn spheres. Dotted lines illustrate the
integrated-intensity background. After Massidda et al.
It is not a priori clear that GWA can describe semicore states. Unlike the deep core states, the
shallow core states are screened by states which are almost degenerate with the hole, which may
introduce new eﬀects. Calculations for semicore states in ZnSe, GaAs and Ge showed, however, that GWA improves the LDA eigenvalues signiﬁcantly also
for these core states, leaving a discrepancy of only 0.5-1.0 eV to experiment . This leads to an ionization energy which is
too small. In addition relaxation eﬀects are neglected, which tends to overestimate the ionization
energy and therefore partly cancels the error from the self-interaction. As discussed above, essential
relaxation eﬀects are included in ∆SCF calculations. In addition, the LDA total energies are rather
accurate and the self-interaction errors are rather small. This is due to an exact sum-rule satisﬁed
by the LDA . While this sum-rule is very important for total
energy calculations, it does not necessarily imply a good exchange-correlation potential or accurate
eigenvalues. It is therefore crucial that ∆SCF calculations involve total energy diﬀerences rather
than eigenvalues.
To understand the diﬀerent accuracy of the LDA eigenvalues for a solid and a free atom, Aryasetiawan and Gunnarsson performed transition state calculations in the Slater transition state
approach . These calculations showed that in the solid the creation of a core hole leads
to a substantial charge transfer to the site where the hole was created . Due to this charge transfer the relaxation energy is larger than for a
free atom. The cancellation of the error in the eigenvalues due to the self-interaction and the error
due to the neglect of relaxation eﬀects therefore becomes more complete in the solid than in a free
atom. This explains why the errors in the eigenvalues are much smaller in the solid .
The ∆SCF gave ionization energies for the 3d semicore states which were about 1 eV too large.
The discrepancy between ∆SCF and GWA may be due to an error in the LDA, which tends to
overestimate the exchange-correlation energy between a 3d electron and the 3s-3p core which is about 1 eV in the series K-Cu . It could also
be due to the diﬀerence in the RPA screening and the static LDA screening. Transition state
calculations for a number of Zn compounds have also been performed by Zhang, Wei, and Zunger
 . We observe, however, that the Slater transition state approach requires that the semicore
states are suﬃciently localized to form a bound state in the transition state calculations. The
bound state has no dispersion, in contrast to the GW results which show the full band structure.
Thus, if a bound state is not formed in the transition state calculation, the result would be identical
to that of the LDA. The problem can be illustrated for Cu metal where the 3d band is 0.5 eV too
high. The transition state would give a single number rather than a band assuming that a bound
state is formed in the ﬁrst place. A GW calculation on the other hand lowers the position of the
band by 0.2-0.3 eV while maintaining the LDA band structure also improved the LDA result from
-5.4 eV to -6.4 eV but a signiﬁcant error remains when compared to experimental results -8.6 eV
and -7.5 eV.
D. Surfaces
1. Jellium surface
GW calculations for a model jellium-vacuum interface have been done in some details. The
problem of interest here is how the surface barrier looks like. According to classical electrostatic,
the image potential seen by an electron in the vacuum far from the surface behaves like
Vimage = −
where z is the coordinate normal to the surface and z0 is the position of the eﬀective image plane.
In the LDA, the image potential is known to decay exponentially . This
unphysical behaviour is due to the fact that in the LDA the exchange-correlation hole is determined
by the local density and it does not feel the surface directly. The exchange-correlation hole obeys
a sum-rule that it must integrate to one but since the density is small outside the surface it means
that the hole becomes very extended. In fact about half the hole resides far inside the surface.
Due to the very extended structure of the hole, the resulting V xc decays exponentially outside
the surface. The situation is similar to the atomic case where the LDA V xc decays exponentially
instead of decaying as 1/r as in the exact V xc. . Similarly, the
exact DFT exchange-correlation potential should be capable of reproducing the correct behaviour
of the image potential which is important in many applications. For example, the LDA potential
cannot produce the Rydberg series of image states.
Binding energies and life-time of surface
states bound by image potential depend crucially on the 1/z dependence as do tunneling currents
in the scanning-tunneling microscope and positions of alkali ions adsorbed on metal substrates.
Interpretation of inverse photoemission data relies on the existence of the image tail of the surface
By calculating the self-energy for the surface, a V xc can be derived simply by taking the trace
of the following Dyson equation 
G = GDF + GDF (Σ −V xc) G
and noting that the exact density is equal to the exact DF density (i.e. the trace of G is equal to
the trace of GDF ). This yields
d3r1V xc (r1)
dωGDF (r, r1, ω) G (r1, r,ω)
dωGDF (r, r1, ω) Σ (r1, r2, ω) G (r2, r, ω)
The exchange-correlation potential obtained from the above equation using the GW self-energy
exhibits the correct asymptotic behaviour as can be seen in ﬁgure 14. It can also be seen from the
ﬁgure that it is the correlation potential originating from the Coulomb correlation that determines
the asymptotic behaviour of the image potential. The exchange potential, on the other hand, is
numerically found to decay as vx ∼−a/z2 and to contribute signiﬁcantly to the determination of
z0. The position of the eﬀective image plane z0 deduced from V xc is therefore diﬀerent from the
one for a classical test charge. Thus, for rs = 2.07 the value of z0 deduced from the image tail of
V xc is z0 = 0.72 ± 0.1 a.u. measured from the jellium edge while the value obtained from a linear
response calculation is z0 = 1.49 a.u. .
The Kohn-Sham eigenvalues calculated from the V xc deduced from ΣGW turn out to very close
to the quasiparticle energies obtained from the Dyson equation .
The diﬀerence EQP −EKS = 0.02 eV for q∥= 0 which is much smaller than the binding energy
of the state - about 0.5 eV. Furthermore, the Kohn-Sham and quasiparticle eigenfunctions are
practically identical (the overlap is > 0.999 ). This does not, however, imply that the physics of
the self-energy at the surface can be completely described by a local potential. The imaginary
part of the self-energy associated with damping is intrinsically non-local and energy dependent. It
cannot be mimicked by a local complex potential. As the electron moves away from the surface,
the maximum of Im Σ remains at the surface, reﬂecting a high degree of non-locality. The range of
this non-locality is comparable with the decay length of the electron density in the vacuum . It was also found that Im Σ deviates from the quadratic behaviour
≃(E −EF )2 when the electron is in the vacuum outside the surface and the departures grow as the
electron-surface separation increases. The eﬀect is attributed to the suppression of one-electron
decay channels near the Fermi level .
V xc(z) at a jellium surface for rs = 3.93 (λF = 12.9 a.u.). The solid curve is the solution
to equation (151) using the GWA for Σ, and the dotted curve is the corresponding LDA potential. The
dashed curve is the image potential V im(z) = −1/4(z −z0). After Equiluz et al .
2. Si(1 0 0) surface
There have also been studies for more detailed microscopic models of surfaces. In particular,
the Si(100) surface has been extensively studied experimentally and theoretically, because of the
technological importance of Si. At room temperature there is a 2 × 1 reconstruction which at low
temperatures goes over in a c(4 × 2) reconstruction (see, e.g., Johansson et al. for references to
experiment). The surface atoms are believed to form buckled dimers, where one atom moves out
of the surface and the other into the surface. The room temperature photoemission spectrum has
been measured by Johansson et al. .
The electronic structure has been calculated in the GWA by Northrup (c(4 × 2)), by
Kress, Fiedler, and Bechstedt 1994 (2 × 1) and by Rohlﬁng et al. (2 × 1). In ﬁgure 15 we
show the results of Rohlﬁng et al. . These calculations were performed using a Gaussian
basis set and a super cell containing eight Si layers. The ﬁgure shows the LDA bulk bands (dashed)
and GW surface states. The GW surface band agrees rather well with an experimental band, while
another experimental band has no correspondence in the theoretical calculation. It is interesting
that the calculation of Northrup, using the low temperature structure, produced two bands in
close agreement with experiment. Actually, the experimental samples may have some domains
with this c(4 × 2) structure . The GW calculation shifts the conduction
band by about +0.50-+0.65 eV relative to the valence band . According to
optical experiments, the bottom of the valence band at Γ is 1.1 eV above the top of the valence
band in good agreement with the theoretical result 0.95 eV. For the indirect band gap there are
experimental estimates in the range 0.44 eV to 0.9 eV compared with the theoretical result 0.7 eV
 .
Calculated dangling-bond bands. Solid lines, GWA energies, dashed lines LDA energies. The
experimental results are shown by diamonds and circles (ﬁlled and open) . .
In this context we also mention that there has been work within the GWA for interfaces, e.g.,
for calculating Schottky barriers. This work will not be discussed further here, but we refer the
reader to Charlesworth et al. and Godby and Sham for an example of such work
and further references. For other work on semiconductor surfaces we refer to Hybertsen and Louie
 and Bechstedt and Del Sole . Rohlﬁng, Kr¨uger, and Pollmann performed
calculations on clean, H and S terminated Ge(001) surface and Zhang et al have calculated
the valence band oﬀ-set of AlAs-GaAs(001).
E. Clusters
Electronic excitations and optical spectra in clusters have been studied mainly within the con-
ﬁguration interaction approach . While it gives accurate results, its applications are limited to systems containing a small number of electrons, typically less than 10. GWA provides an alternative for calculating
excitation properties in clusters with relatively large number of electrons which cannot be handled
by the CI method.
GW calculations have been performed for a jellium-sphere model for alkali metals and more recently for the real cluster Na4 . In alkali-metal clusters, it is
known that the ionization energies calculated within the LDA are too low compared to experiment
 and the discrepancy becomes worse
the smaller the cluster. The size dependence of the ionization energy in the LDA is too weak.
This discrepancy is attributed to self-interaction which is not taken into account properly in LDA
eigenvalues. That the discrepancy gets worse for smaller clusters is intuitively clear since the larger
the clusters the more they resemble electron gas on which the LDA is based. On the other hand,
the LDA gives the correct sequence of eigenvalues for the valences states in the jellium-sphere
model which is 1s, 1p, 1d, 2s, 1f, 2p, etc. .
In the jellium-sphere model, the ionic charges are smeared to form a sphere of a uniform positive
background.
GW calculation for this model corresponding to Na20 lowers the occupied LDA
eigenvalues and increases the unoccupied ones, thus increasing the energy gap similar to the results
for bulk semiconductors and insulators. The ionization energy as a function of cluster size is also
in better agreement with experiment although the absolute values are somewhat too large . This could be due to the absence of core polarization in the jellium-sphere model which
gives a positive contribution to the self-energy. The GW results are actually rather close to the
HF results, the reason being that screening due to long-range correlations is much less important
in a small ﬁnite system than in a solid .
GW calculation for real Na4 yields similar results . The unoccupied states
are raised by between 0.75 and 0.90 eV while the highest occupied molecular orbital (HOMO) and
the lowest occupied molecular orbital (LUMO) state are lowered by 1.55 and 1.40 eV respectively
giving a HOMO-LUMO gap of 3.0 eV compared with the LDA value of 0.55 eV. Again the GW
result is close to the HF value of 3.4 eV for the reason discussed above. Indeed calculation of the
static dielectric function for this cluster shows a metallic behaviour for small distances but it drops
to less than unity starting at about 6 a.u.. For comparison, the value of the dielectric function
for metallic sodium at 5 a.u. is about 50 whereas in the cluster it is 1.2. This phenomenon of
antiscreening is typical of a small system. If a positive test charge is introduced at the centre of the
cluster, say, electrons will surround the test charge and the surface of the cluster will therefore be
positively charged. Thus as the distance from the centre increases, the screening quickly vanishes
and becomes negative . A similar behaviour is also observed in the C60 molecules
 .
Calculated absorption spectra of Na4 including self-energy and excitonic eﬀects (dotted
line) in arbitrary units and using a Gaussian broadening of 0.06 eV. The solid line is the experimental
photodepletion cross sections from Wang et al . The vertical bars show the unbroadened spectrum
and the inset shows the LDA results. After Onida et al .
F. Fullerenes
Solid C60 (fullerite) is a molecular solid, where the orbitals of a free C60 molecule essentially
keep their character and the hopping between the molecules only leads to a small broadening of
the discrete molecular states. The band structure of C60 is shown in ﬁgure 17. In undoped C60
the Hu band is occupied and the T1u band is empty. The LDA (left part of the ﬁgure) band
gap is about 1 eV ,
which is substantially smaller than the experimental value, 2.3 eV , obtained from
photoemission and inverse photoemission.
LDA (a) and GW (b) band structures for solid C60 in the Fm¯3 structure
 .
Shirley and Louie have performed a GW calculation for solid C60 on a fcc lattice with all
molecules having the same orientation (Fm¯3 structure). This diﬀers somewhat from the experimental T = 0 structure Pa3, where the molecules take four diﬀerent orientations. This diﬀerence
should not be important for the present discussion. Shirley and Louie used the Levine and
Louie model for the static dielectric function together with a plasmon pole approximation.
Their results are shown in ﬁgure 17. The band gap is increased to 2.15 eV in good agreement
with the experimental results. The band widths were also increased by about 30 %. There are
no reliable experimental results for the dispersional band widths. It was concluded that undoped
solid C60 is a standard band insulator with dispersive bands.
The calculation by Shirley and Louie was performed for the undoped C60 solid. In A3C60 (A=
K, Rb) the T1u band is half-ﬁlled. The Hubbard U ∼1.5 eV , describing the
interaction between two electrons on the same molecule, is large compared with the width (W ∼0.6
eV) of the partly ﬁlled T1u band. One may therefore expect strong correlation eﬀects for these
systems. Although it is not clear if the GWA can describe such strong correlation eﬀects, it is
interesting to perform such a calculation.
To screen the Hubbard U, Gunnarsson considered a model dielectric function
ǫ(q, ω) = ǫ0 −
which describes the coupling to a plasmon at ω = ω0p/√m∗ǫ0.
This plasmon is due to the
oscillations of the three electrons donated by the alkali atoms to the T1u band. The model (152) is
therefore complimentary to the calculation of Shirley and Louie , since this T1u plasmon does
not exist for the undoped system, while the physics considered by Shirley and Louie is neglected
in Eq. (152). This model of the dielectric function was combined with a tight-binding (TB) model
 for the band structure, which reproduces the LDA T1u band well.
First a Hartree-Fock (HF) calculation was performed for this model. It was found that in HF
the width of the T1u band is increased by about 75 %. Next a GW calculation was performed.
Including the coupling to the T1u plasmons was found to reduce the T1u width to a value 35 %
smaller than the original TB width. Actually for a model of this type one can show under rather
general assumptions that the band width is always reduced if there are no other bands above or
below the band considered . The density of the T1u electrons is very small
and corresponds to the electron gas parameter rs ∼7. Thus the density is substantially smaller
than for the free-electron like metals. It is then not too surprising that the quasi-particle weight
Z ∼0.4 −0.5 is also smaller than for these metals. This means that much of the spectral weight
appears in satellites. If the narrowing of the T1u band due to the coupling to the T1u plasmon is
combined with the broadening found by Shirley and Louie due to other couplings, the net result
is a small change of the band width.
VI. SELF-CONSISTENCY
The set of Hedin’s equations (43,44,45,46), in the original formulation of the self-energy expansion
in powers of the screened interaction W constitutes a self-consistent cycle . Within the GWA, starting from a (usually) non-interacting Green function G0
one calculates the polarization function P0 = −iG0G0 and the corresponding screened interaction
W0. The self-energy is then obtained from Σ0 = iG0W0. In most GW calculations that have
been performed so far, Σ0 is taken to be the ﬁnal self-energy. The interacting Green function
G obtained from the Dyson equation G = G0 + G0Σ0G is, however, not necessarily the same
as G0. To achieve self-consistency, the Green function obtained from the Dyson equation should
be used to form a new polarization function P = −iGG, a new screened interaction W, and a
new self-energy Σ which in turns yields a new Green function through the Dyson equation. This
process is continued until G obtained from the Dyson equation is the same as G used to calculate
the self-energy. Self-consistency is evidently an important issue since it guarantees that the ﬁnal
results are independent of the starting Green function. Moreover, according to the Baym-Kadanoﬀ
theory , a self-consistent GW scheme ensures conservation of particle number and energy
when the system is subjected to an external perturbation. Conservation of particle number means
that the continuity equation
−∂tn(r, t) = ∇·j(r, t)
is satisﬁed.
Conservation of energy means that the energy change when an external potential
is applied to the system is equal to the work done by the system against the external potential
when calculated using the self-consistent G . Moreover,
self-consistency ensures that
dω Im G(ω)
gives the correct total number of particles. when n and j is obtained from the self-consistent Green
function. The ﬁrst self-consistent GW calculation was probably by de Groot, Bobbert, and van
Haeringen for a model quasi-one dimensional semiconducting wire. The relevance of this
model to real solids is, however, unclear.
Five aspects may be distinguished in relation to self-consistency :
1. Modiﬁcation of quasiparticle wavefunctions.
2. Shift of quasiparticle energies.
3. Modiﬁcation of quasiparticle weights (Z factors).
4. Modiﬁcation of quasiparticle life-times.
5. Modiﬁcation of the screening properties of the system.
These aspects were recently studied in detail by von Barth and Holm and by Shirley
 for the electron gas. Naturally, the ﬁrst aspect cannot be addressed for the electron gas
since the quasiparticle wavefunctions remain plane waves. The results of these studies are
• The band width is increased from its non-self-consistent value, worsening the agreement with
experiment.
• The weight of the quasiparticles is increased, reducing the weight in the plasmon satellite.
• The quasiparticles are narrowed, increasing their life-time.
• The plasmon satellite is broadened and shifted towards the Fermi level. In fact, it almost
disappears at full self-consistency.
The quasiparticle dispersion for the electron gas for rs = 2 and 4 from partial self-consistent
GW0 calculations (W0 is held ﬁxed at the RPA whereas G is allowed to vary to self-consistency) compared
with the free-electron dispersion. The largest change in the band width occurs for rs = 4. After von Barth
and Holm .
As discussed below, the main eﬀects of self-consistency are caused by allowing the quasiparticle
weight to vary . These results are true for the case when the screened
interaction W is ﬁxed at the RPA level (calculated using the non-interacting G0) and only the
Green function is allowed to vary to self-consistency and also for the case when both G and W are
allowed to vary (full self-consistency case). The increase in the band width is disturbing and can
be understood as follows. Let us consider the ﬁrst case with ﬁxed W = W0 for simplicity. First
we note that the GW result for the band width after one iteration is close to the free electron one.
This means that there is almost a complete cancellation between exchange and correlation. After
one iteration the quasiparticle weight is reduced to typically 0.7 and the rest of the weight goes
to the plasmon satellite. Correspondingly, when the new G is used to calculate a new Im Σc, its
weight is transferred away from low energy to high energy, due to the sum rule 
dω|ImΣc (k, ω) | =
dω|ImW0 (q, ω) |
which shows that the left-hand-side is a constant depending only on the prechosen W0 but independent of k and self-consistency. For a state at the Fermi level, this has little eﬀect since Im Σc
has almost equal weights for the hole (ω ≤µ) and the particle part (ω > µ) which cancel each
other when calculating Re Σc, as can be seen in equation (68). But for the state at the bottom of
the valence band, Im Σc has most of its weight in the hole part so that the shifting of the weight in
Im Σc to higher energy causes Re Σc to be less positive than its non-self-consistent value. A similar
eﬀect is found for the exchange part which becomes less negative but because the bare Coulomb
interaction has no frequency dependence, the renormalization factor has a smaller eﬀect on Σx so
that the reduction in Σx is less than the reduction in Σc. The net eﬀect is then an increase in the
band width. The shifting of the weight in ImΣc to higher energy has immediate consequences of
increasing the life-time and the renormalization weight Z (through a decrease in | ∂ReΣc/∂ω|) of
the quasiparticles and of broadening the plasmon satellite, compared to the results of one iteration
 .
When W is allowed to vary (full self-consistency) the results become even worse: the band width
becomes even wider and the plasmon satellite becomes broad and featureless, in contradiction to
experiment. The quasiparticle weight is increased further. These results can be explained by the
disappearance of a well-deﬁned plasmon excitation in W. The quantity P = −iGG no longer has
a physical meaning of a response function, rather it is an auxiliary quantity needed to construct
W. Indeed, it does not satisfy the usual f−sum rule. The equations Reǫ(q, ωp) = Imǫ(q, ωp) = 0
determining the plasmon energy are not satisﬁed any more since the Green function now always
has weight around ω = ωp. This has the eﬀect of transferring even more weight in Im Σc to higher
energy with the consequences discussed in the previous paragraph. Shirley included the
second order self-energy diagram (vertex correction) and found that it cancelled the eﬀects of
self-consistency to some degree.
The spectral function from a partial self-consistent GW0 calculation (see previous ﬁgure)
compared to that of the ﬁrst iteration for k = 0.5kF and rs = 4. The self-consistent quasiparticle energy
is lowered (band broadening) compared to the non-self-consistent one whereas the satellite position is
somewhat improved. After von Barth and Holm .
A very interesting outcome of the full self-consistent calculation is
that the total energy calculated with the Galitskii-Migdal formula turns out to be strikingly
close to the total energy calculated from a much more elaborate quantum Monte Carlo technique
 . For rs = 2 and 4 quantum Monte-Carlo gives 0.004 and -0.155 Rydberg
respectively while the self-consistent GW gives 0.005 and -0.156 Rydberg. This unexpected result
may be related to the fact that the self-consistent GW scheme is energy conserving and it is partly
explained by consideration of the Luttinger-Ward energy functional which is variational
with respect to G and its minimum is equal to the value obtained from the Galitskii-Migdal
What is not clear is why the ﬁrst order energy diagram (giving the GW self-energy
upon taking functional derivative with respect to G) appears to represent a very good energy
functional. Furthermore, the chemical potential calculated from µ = ∂E/∂N is in agreement with
the value obtained from µ = k2
F /2 + Σ(kF , µ) and the particle density n = 2 P
−∞dωA(k, ω)
yields n = k3
F /(3π2) , i.e. particle number is conserved, as proven by Baym . It has also
been proven that with a ﬁxed W = W0 particle number is also conserved argued that H0 should be chosen so that its ground-state
density is the same as the one resulting from the GW calculation. It could be more favourable
to perform partially self-consistent calculations by, for instance, ﬁxing W at the RPA level and
modifying the quasiparticle energies in G0, or by choosing a single-particle Hamiltonian such that
the resulting quasiparticle energies obtained from a GW calculation are the same as the those
of the single-particle Hamiltonian. In any case, eﬀorts should be directed towards ﬁnding vertex
corrections (beyond GW ).
VII. VERTEX CORRECTIONS
By vertex corrections we mean corrections to the self-energy beyond the GW-RPA approximation
and corrections to the response function beyond the RPA. Vertex corrections to the RPA response
function naturally involve interaction between screening electrons not taken into account in the
RPA. This interaction must include the eﬀect of exchange and correlation, which makes the interaction depend upon the relative spin states of the electrons. Vertex corrections to the self-energy
on the other hand involve interaction of the hole with its surroundings not taken into account in
the GWA. A consistent treatment should include vertex corrections in both the response function
and the self-energy . This preserves conservation laws and is a natural outcome of
the perturbation expansion of the self-energy in the functional derivative technique of Baym and
Kadanoﬀ and Baym . For example, calculations of the optical spectra of Si indicate
a cancellation between vertex corrections in the response function and the renormalization of the
quasiparticle energies . Mahan and Sernelius
 found a similar eﬀect in the calculations of band widths of the electron gas. Conserving
approximations including vertex corrections with exchange eﬀects only have been considered by
Hong and Mahan for the electron gas.
In the GWA, the screened interaction is calculated within the RPA which takes into account
primarily long-range correlation which gives rise to collective excitations (plasmons). The photoemission hole is coupled to one plasmon only in the GWA. Vertex corrections may be loosely
divided into the short-range and long-range parts.
Short-range vertex corrections improve the
description of the quasiparticles and low-energy satellites whereas long-range vertex corrections
improve description of high-energy satellites (plasmons).
The RPA pair distribution function, which is the probability of ﬁnding another electron at a
certain distance from a given electron, is negative for small distances, which is unphysical (Pines
Exchange and correlations should therefore increase the probability of ﬁnding another
electron at small distances. The same applies to holes. For a test charge, the screening becomes
more eﬀective when the eﬀects of exchange and correlations are taken into account. But for an
electron, the RPA screening is reduced when the eﬀects of exchange and correlations between the
screened electron and the surrounding electrons are taken into account. The physical interpretation
of vertex corrections is as follows: an electron pushes away other electrons in its vicinity creating a
screening hole around the electron. Taking into account exchange and correlations of the screening
holes increases the screening since the probability of the holes getting closer together is increased
leading to more screening holes. If we now take into account the eﬀects of exchange and correlations
between the screened electron and the other electrons, then screening will be reduced because the
probability of ﬁnding electrons at small distances to the screened electron is increased, leading to
stronger eﬀective interactions between the electrons. The net eﬀect is that the RPA screening is
reduced. Thus, vertex corrections for electrons will in general reduce screening. Vertex corrections
in the response function can also take the form of interaction between electrons and holes in
electron-hole pairs created by the perturbation in the system due to the presence of a photoemission
hole. This interaction may actually create an additional bound state (exciton) much lower in energy,
of the order of a few eV, than the plasmon energy.
Vertex corrections to the self-energy are particularly important for systems with localized states,
such as those containing 3d and 4f orbitals. This is because the electron-hole pairs created in
the screening process can be rather localized and therefore interact strongly with the localized
photoemission hole. This interaction can signiﬁcantly modify the quasihole energy and its weight
as well as creating new collective excitations appearing as low energy satellites.
This type of
vertex corrections is short range in nature. Long-range vertex corrections modify the structure of
the plasmon satellites and may create multiple plasmons as observed in the alkalis. In the GWA,
the photoemission hole only couples to one plasmon, resulting in one-plasmon satellite. The hole,
however, can in general interact with several plasmons during its propagation, producing multiple
plasmon satellites.
A. Direct evaluation of the second-order self-energy
Formally, the GWA is the ﬁrst-order term in the expansion of the self-energy in the screened
interaction W. It is then thought that the simplest vertex correction is the second-order self-energy.
This procedure, however, warrants some precautions. First, the physical meaning of the secondorder term is not clear. Second, this second-order term when evaluated with a frequency-dependent
interaction can give a self-energy with wrong analytic properties which result in a negative density
of states, as shown in the electron-gas case .
This type of vertex correction was calculated for the band gap of Si both with a bare and a
screened interaction . The second-order self-energy with the bare Coulomb interaction was found to be factors
18 and 37 smaller than the ﬁrst-order self-energy for Γ15 and Γ
25 states, which correspond to a
correction of ∼1 % with respect to the Hartree-Fock direct gap. A calculation using a screened
interaction yields a correction to the gap of the order of ∼4 %. Since this calculation was performed
for the gap states only, it is not clear if the density of states became negative for some energies.
Both calculation indicate in any case that the second-order term is small. This is encouraging since
it suggests that higher-order terms are probably small too since the GWA already gives results in
agreement with experiment. An interesting result is that the second-order vertex correction does
not shift the absolute position of the LDA valence-band maximum which in the approximation
used is too low by 0.5 eV. It is speculated that higher order vertex corrections could account for
the required shift .
B. Vertex corrections based on the LDA exchange-correlation potential
The set of equations (43,44,45,46) derived by Hedin provides a systematic way of developing
a perturbation series for the self-energy in powers of the screened interaction W. In the original
derivation, the zeroth-order Green function is taken to be the Hartree one. However, the band
structure and wavefunctions in the Hartree theory are less accurate compared with those of the
LDA, making Hartree Green function a poor starting point. In practical calculations, one uses a
Green function constructed from the LDA band structure. The response function is also calculated
using the LDA Green function.
Consistent vertex corrections were derived by Rice in relation to the dielectric function
as discussed in the alkali section. A similar approach was also made Ting, Lee, and Quinn 
and Mahan . Alternatively, consistent vertex corrections can also be derived from the the
set of equations (43, 44, 45, 46) where one regards V xc
LDA as a self-energy correction to the Hartree
approximation, albeit an ad hoc one (not based on a systematic diagrammatic expansion). Based
on this starting point, the vertex function Λ can be easily evaluated yielding 
Λ(1, 2, 3) = δ(1, 2)δ (1, 3) −i
d (5, 6, 7)Kxc (1, 5) G (5, 6) G (7, 5) Λ (6, 7, 3)
Kxc (1, 5) = δV xc (1)
remembering that ρ (1) = −iG (1, 1+). The new self-energy with vertex corrections has the form
of the GWA but with a new screened potential
1 −P 0 (v + Kxc)
corresponding to a dielectric function
eǫ = 1 −P 0 (v + Kxc)
The same result was already discussed in section V.A where the self-energy was expressed as a
corrected dielectric function ǫ (equation (136)) and a vertex correction Γ (equation (137)). The
product ǫ−1Γ is equal to ˜ǫ−1 with ˜ǫ given above. This dielectric function may also be derived
straightforwardly from time-dependent LDA and may therefore be interpreted as the dielectric
function that screens the external potential felt by an electron, as opposed to a test charge . This distinguishes itself from the RPA (time-dependent Hartree) dielectric function in that the induced charge does not only generate the Hartree potential but also an
exchange-correlation potential. It is clear that one could start with a diﬀerent local zeroth-order
self-energy other than V xc
LDA and arrive at a similar formula. Note that in the formula for the
self-energy in equation (43), the vertex function Λ enters both W (through P) and Σ. A problem
with starting with a local zeroth-order self-energy is that the self-energy with the vertex corrections
becomes asymmetric in r and r′.
Application of such scheme to the electron gas gives small changes compared with the original
GWA . Similarly, for Si it yields practically the same gap (0.70 eV)
and valence band width (11.4 eV) as those of the standard GW calculation . However, the absolute position of the top of the valence band is shifted 10 meV
upwards by the GW+vertex corrections and 400 meV downwards by the standard GW calculation.
This could improve the calculations of band oﬀ-sets at interfaces. A calculation with the vertex
corrections in the response function R only but not in Σ, that is with
1 −P 0 (v + Kxc)
1 −P 0 (v + Kxc)
gives a smaller gap (0.57 eV) and a smaller band width (10.9 eV) . The latter result is similar to the case of the alkalis . The top of the valence band is shifted downward by 0.4 eV
like in the standard GWA. The result for the band width should be taken with caution because
the plasmon-pole approximation used in the calculations. The worse results obtained by including
vertex corrections in R only, is consistent with the violation of conservation laws.
C. The cumulant expansion
A diagrammatic approach for including vertex corrections is provided by the cumulant expansion
method. One of the ﬁrst applications of the cumulant expansion method was in studying the X-ray
spectra of core-electrons in metals . Later on the
method was extended to valence states by Bergersen, Kus, and Blomberg and Hedin .
The core-electron problem is modelled by a Hamiltonian consisting of a core electron interacting
with a set of plasmons:
H = εc†c +
where c is the annihilation operator for the core electron with energy ε, b†
q is the creation operator
for a plasmon of wave vector q and energy ωq. and the last term is the coupling of the core electron
to the plasmon ﬁeld. The Hamiltonian can be solved exactly and it can be shown that the cumulant
expansion also gives the exact solution :
δ (ω −ε −∆ε ∓nωp)
where + refers to absorption spectrum and −to emission spectrum. a = P
p and ∆ε = aωp
is the shift in core energy due to the interaction with the plasmon ﬁeld. It is assumed that the
plasmon excitations have no dispersion although this assumption is not necessary. The spectra
consist therefore of the main quasiparticle peak at ω = ε + ∆ε and a series of plasmon excitations
at multiples of the plasmon energy below the quasiparticle peak which is in accordance with
experiment. This is in contrast to the GW spectra which only has one plasmon excitation located
at too high energy, typically 1.5 ωp below the quasiparticle peak . More recently the cumulant expansion method was applied to a model Hamiltonian with
electron-boson interaction and the cumulant was calculated to higher order .
In the cumulant expansion approach, the Green function for the hole (t < 0) is written as 
G (k, t < 0) = iθ (−t) ⟨N|ˆc†
k(0)ˆck(t)|N⟩
= iθ (−t) e−iεkt+Ch(k,t)
and the hole spectral function is
A (k, ω ≤µ) = 1
π ImG (k, ω ≤µ)
dteiωt⟨N|ˆc†
k(0)ˆck(t)|N⟩
dt eiωte−iεkt+Ch(k,t)
where k denotes all possible quantum labels and Ch (k, t) is deﬁned to be the cumulant. Expanding
the exponential in powers of the cumulant we get
G (k, t) = G0 (k, t)
1 + Ch (k, t) + 1
2[Ch (k, t)]2 + . . .
where G0 (k, t) = i exp (−iεkt) . In terms of the self-energy, the Green function for the hole can be
expanded as
G = G0 + G0ΣG0 + G0ΣG0ΣG0 + . . .
To lowest order in the screened interaction W, the cumulant is obtained by equating
G0Ch = G0ΣG0
where Σ = ΣGW = iG0W. If G0 corresponds to, e.g. GLDA, then Σ = ΣGW −V xc. The ﬁrst-order
cumulant is therefore = i
dτ eiεkτΣ (k, τ)
The cumulant may be conveniently divided into a quasiparticle part and a satellite part: Ch =
QP (k, t) = (iαk + γk) + (−i∆εkt + ηk)t
dω ei(εk−ω−iδ)t
(εk −ω −iδ)2 Γ (k, ω)
iαk + γk = ∂Σ (k, ω)
dω Γ (k, ω)
ηk = πΓ (k, εk) = |ImΣ(k, εk)|
ηk is the inverse life-time of the quasiparticle and Γ(k, ω) is the spectral function of the self-energy
which is proportional to ImΣ(k, ω). A similar derivation can be carried out for the particle Green
G (k, t > 0) = −iθ (t) e−iεkt+Cp(k,t)
The result is
Cp (k, t) = −i∆εkt −ηkt + ∂Σ (k, ω)
dω ei(εk−ω+iδ)t
(εk −ω + iδ)2 Γ (k, ω)
It is physically appealing to extract the quasiparticle part from the Green function:
QP (k, t) = iθ (−t) eiαk+γke(−iEk+ηk)t ,
Ek = εk + ∆εk
The spectral function for this quasiparticle can be calculated analytically (Almbladh and Hedin
AQP (k, ω < µ) = e−γk
ηk cos αk −(ω −Ek) sin αk
(ω −Ek)2 + η2
From equation (165) we have ⟨N|ˆc†
k(0)ˆck(t)|N⟩= e−iεkt+Ch(k,t) for t < 0. By analytically continuing to t > 0 the spectral function in equation (165) can be rewritten as
A (k, w) = 1
dt eiωte−iεkt+Ch(k,t)
where for t > 0 we have Ch(k, t) = Ch∗(k, −t). The total spectra can be written as a sum of AQP
and a convolution between the quasiparticle and the satellite part:
A (k, ω) = AQP (k, ω) + 1
dt eiωte(−iEk+ηk+Ch(k,0))t h
= AQP (k, ω) + AQP (k, ω) ∗AS (k, ω)
AS (k, ω) = 1
S (k, t) + 1
2 + . . .
The second term AQP ∗AS is responsible for the satellite structure. The Fourier transform of Ch
can be done analytically 
S (k, ω < 0) = Γ (k, εk + ω) −Γ (k, εk) −ωΓ′ (k, εk)
As follows from equations (177) and (179), the quasiparticle energy in the cumulant expansion
is essentially determined by Ek, which is the quasiparticle energy in the GWA.
FIG. 20. Diagrammatic expansion for the Green function
to second order in the GWA and the cumulant expansion
respectively. The solid lines represent non-interacting Green
functions G0, and the wiggly lines represent the screened
interaction W .
(a) The experimental spectral function of Na (dots). The solid line is a synthetic spectrum
obtained by convoluting the density of states from a band structure calculation and the experimental
core level spectrum. BG is the estimated background contribution. From Steiner, H¨ochst, and H¨ufner
 . (b) The calculated total spectral function of Na for the occupied states. The solid and dashed
lines correspond to the cumulant expansion and the GWA, respectively. After Aryasetiawan, Hedin, and
Karlsson .
By comparing the diagrammatic expansions in the GWA and the cumulant expansion we can
get some idea about the vertex corrections. In ﬁgure 20 the Green function diagrams are shown
to second order in the screened interaction, which should be suﬃcient for our purpose.
cumulant expansion diagrams are obtained by considering the three possible time-orderings of the
integration time variables t′ in Ch2 (k, t) with Ch (k, t) given by equation (169). The cumulant
expansion contains second-order diagrams which are not included in the GWA. It is these additional
diagrams that give rise to the second plasmon satellite and they are quite distinct from the secondorder diagram common to both approximations. The interpretation of the latter diagram is that a
hole emits a plasmon which is reabsorbed at a later time and the hole returns to its original state
before plasmon emission. This process is repeated once at a later time. Thus there is only one
plasmon coupled to the hole at one time. In contrast, the other two diagrams, not contained in
the GWA, describe an additional plasmon emission before the ﬁrst one is reabsorbed, giving two
plasmons coupled to the hole simultaneously. Similar consideration can be extended to the higherorder diagrams. If self-consistency is taken into account then the second second-order diagram is
also included in the GWA.
The cumulant expansion contains only boson-type diagrams describing emission and reabsorbtion of plasmons but it does not contain diagrams corresponding to interaction between a hole and
particle-hole pairs. For this reason, the cumulant expansion primarily corrects the satellite description whereas the quasiparticle energies are to a large extent determined by the GWA as mentioned
before. Interaction between hole-hole and particle-hole is described by the ladder diagrams which
in a Hubbard model study were found to improve the low-energy satellite .
The cumulant expansion was applied recently to calculate the photoemission spectra in Na and
Al . The experimental spectra consist of a quasiparticle
peak with a set of plasmon satellites separated from the quasiparticle by multiples of the plasmon
energy. The spectra in the GWA shows only one plasmon satellite located at a too high energy,
approximately 1.5 ωp below the quasiparticle which is similar to the core electron case.
cumulant expansion method remedies this problem and yields spectra in good agreement with
experiment regarding the position of the satellites. The relative intensities of the satellites with
respect to that of the quasiparticle are still in discrepancy. This is likely due to extrinsic eﬀects
corresponding to the interaction of the photoemitted electron with the bulk and the surface on
its way out of the solid resulting in energy loss. These are not taken into account in the sudden
approximation.
When applied to valence electrons with band dispersions the cumulant expansion does not yield
the exact result anymore as in the core electron case. Surprisingly, the numerical results show
that the cumulant expansion works well even in Al with a band width of ∼11 eV. Considering its
simplicity, it is a promising approach for describing plasmon satellites.
VIII. SUMMARY AND CONCLUSIONS
The GWA has been applied by now to a large number of systems, ranging from atoms, simple
metals, semiconductors, transition metals, clusters, and surfaces and interfaces. In practically all
of these systems, the GWA improves the quasiparticle energies relative to the LDA eigenvalues.
The reason for the success of the GWA may be understood qualitatively by the fact that it is
correct in some limiting cases as described in the introduction. The GWA includes an important
physical ingredient in extended systems, namely screening or polarization of the medium which
is absent in the HFA. It is well known that the neglect of screening leads to unphysical results
in metals such as zero density of states at the Fermi level and in semiconductors and insulators
to too large band gaps. Even in atoms, the inclusion of polarization eﬀects lead to a signiﬁcant
improvement on the HF eigenvalues. Since screening is a common feature in all electronic systems,
it is perhaps not surprising that the GWA works in a wide variety of materials. It is also known
empirically that second order perturbation theory often takes into account most of the physical
eﬀects, in particular the shifting of quasiparticle energies.
Despite of the success of the GWA, it has naturally some shortcomings. One of these is related
to satellite structure in the photoemission spectra. Since the GWA describes a coupling of the
electrons to one plasmon excitation, represented by W, multiple plasmon excitations observed in the
alkalis are clearly beyond scope of the GWA. This problem is remedied by the cumulant expansion
theory described in section VII-C. Apart from plasmon-related satellites, there are also satellite
structure originating from short-range interactions.
This type of satellites appears in strongly
correlated materials containing 3d or 4f orbitals. The GWA is based on the RPA screening which
takes into account the dominant part of long-range (small momentum) screening. Short-range
(large momentum) intrasite interactions of multiple holes usually present in strongly correlated
systems are therefore not well described by the GWA. Here a T-matrix type approach may be
appropriate as has been shown by model calculations. Apart from problems with satellite, there
are also in some cases discrepancies in the quasiparticle energies. For example, the band width in
Na is ≈10 % too large within the GWA compared with experiment but these discrepancies are
relatively small.
Another shortcoming is the absence of spin-dependence in the screened interaction W since
the screening is purely Coulombic. The spin dependence enters only through the Green function.
One would therefore expect some problems when applying the GWA to magnetic systems where
spin-spin correlations are important as indicated by GW calculations on transition metal atoms.
This area of research has not been explored extensively and it would require inclusion of vertex
corrections to take into account spin-spin correlations. A T-matrix approach may be a ﬁrst step
in this direction.
Most GW calculations performed so far are not self-consistent, i.e. the Green function used to
calculate the self-energy is not equal to the Green function obtained from the Dyson equation with
the very same self-energy. Only very recently such self-consistent calculations were performed for
the electron gas. The results turn out to be worst than the straight GW calculations (one iteration)
and clearly show a cancellation between the eﬀects of self-consistency and vertex corrections. In
some way it is a blessing since fully self-consistent calculations are numerically diﬃcult to perform
for real systems. One interesting aspect of the self-consistent calculations is that the total energies
are in very good agreement with the QMC results. A recent ﬁnding shows that when the total
energies are calculated within the Luttinger-Ward functional and its extension using approximate G and W the results are almost equally good,
which circumvents the need for self-consistent calculations . This could be due to
the variational property of the functional and the fact that the self-consistent GWA is conserving
in the sense of Baym and Kadanoﬀ.
Calculating total energies within the GWA could be an
alternative to the QMC method, particularly for extended systems.
Due to computational diﬃculties, applications of the GWA to large and complex systems are
still not feasible. Simpliﬁed GW schemes, which are computationally eﬃcient and yet maintain the
accuracy of the full calculations, are therefore very desirable. Many schemes have been proposed
but most of them are designed for semiconductors. While they give reliable band gaps, details
of the band structure are not fully accounted for.
Reliable schemes must probably take into
account non-locality as well as energy dependence of the self-energy. With eﬃcient schemes, many
interesting problems can then be tackled. These include chemisorption at surfaces, 3d impurities in
semiconductors, interfaces, band oﬀ-sets in heterojunctions, and exotic materials such as fullerenes
in their diverse forms.
IX. ACKNOWLEDGMENT
It is a pleasure to thank Professor Lars Hedin and Dr. Ulf von Barth for their many valuable
comments and careful reading of the manuscript.