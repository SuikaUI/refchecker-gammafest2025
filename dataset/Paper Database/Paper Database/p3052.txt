Inference with interference between units
in an fMRI experiment of motor inhibition
Xi Luo, Dylan S. Small, Chiang-shan R. Li, Paul R. Rosenbaum1
University of Pennsylvania, Philadelphia
Abstract. An experimental unit is an opportunity to randomly apply or withhold a treatment.
There is interference between units if the application of the treatment to one unit may also aﬀect
other units.
In cognitive neuroscience, a common form of experiment presents a sequence of
stimuli or requests for cognitive activity at random to each experimental subject and measures
biological aspects of brain activity that follow these requests.
Each subject is then many
experimental units, and interference between units within an experimental subject is likely, in
part because the stimuli follow one another quickly and in part because human subjects learn
or become experienced or primed or bored as the experiment proceeds. We use a recent fMRI
experiment concerned with the inhibition of motor activity to illustrate and further develop
recently proposed methodology for inference in the presence of interference.
A simulation
evaluates the power of competing procedures.
Attributable eﬀects; interference between units; placements; randomized experiment.
1Address for correspondence:
Xi Luo is assistant professor in the Department of Biostatistics at Brown
University. Dylan S. Small is associate professor and Paul R. Rosenbaum is professor in the Department of
Statistics, The Wharton School, University of Pennsylvania, 473 Jon M. Huntsman Hall, 3730 Walnut Street,
Philadelphia, PA 19104-6340 US. Chiang-Shan R. Li is associate professor of psychiatry and neurobiology,
Department of Psychiatry, Yale University, CMHC S103, 34 Park Street, New Haven, CT 06519 US. This
work was supported by grants from the Measurement, Methodology and Statistics Program of the U.S.
National Science Foundation. Imaging data were collected under the support of NIH grants R01DA023248,
K02DA026990 and R21AA018004. 11 August 2011 E-mail: .
 
Introduction: An Application of Inference with Interference
What is interference between units?
If treatment eﬀects are deﬁned as comparisons of the two potential responses that an experimental unit would exhibit under treatment or under control , then an implicit premise of this deﬁnition is
“no interference between units,”as discussed by Cox : “There is no ‘interference’between diﬀerent units if the observation on one unit [is] unaﬀected by the particular
assignment of treatments to the other units;”see also Rubin .
For instance, widespread use of a vaccine may beneﬁt unvaccinated individuals because they are less likely
to encounter an infected individual, a form of interference known as herd immunity; see
Hudgens and Halloran . In agriculture, the treatment applied to one plot may also
aﬀect adjacent plots; see David and Kempton .
In social experiments, people talk,
and changing the treatment applied to one person may change what she says to someone
else, altering his response to treatment; see Sobel .
In some contexts, interference is of central interest in itself – this can be true of
herd immunity or of social interaction, for example – but in many if not most contexts,
interference is principally an inconvenience, depriving us of both independent observations
and a familiar deﬁnition of treatment eﬀects.
We apply and extend a recent, general
approach to inference with interference in the context of a cognitive
neuroscience experiment in which the brains of a moderate number of subjects are studied
using fMRI while faced with a rapid ﬁre sequence of randomized stimuli. In this context,
interference is likely to be widespread and diﬃcult to model with precision.
is a simple, sturdy, valid method of inference whose conclusions about the magnitude of
treatment eﬀects are intelligible when the interference may be complex in form.
Three themes: randomization inference, conﬁdence intervals with interference,
ineﬀective trials
In this case-study, we reanalyze a randomized experiment in cognitive neuroscience with a
view to illustrating three ideas, one very old idea, one somewhat new idea, and one idea
that has evolved gradually over more than half a century. In many cognitive neuroscience
experiments, a moderate number of subjects are repeatedly exposed to many randomly
selected stimuli intended to elicit cognitive activity of a speciﬁc type together with its
characteristic neurological activity visible with, say, fMRI. Three dilemmas arise in these
experiments.
First, because a few thoughtful, complex human subjects are observed
many times performing simple repetitive tasks, subjects become familiar with the tasks,
perhaps increasingly bored or skillful or distracted or fatigued or aware of the purpose
of the experiment, so the situation is unlike a study of a single response elicited from
each of many separated, unrelated subjects, and also unlike a stationary time series or a
repeated measures model with dependence within subjects represented by additive subject
parameters. In such a context, one might wish to draw inferences about treatment eﬀects
on many brain regions without relying on a model ﬁtted to just a few people.
for reasons both biological and cognitive, rapid-ﬁre stimuli are likely to interfere with
one another, in part because the neurological response to one stimulus is expected to
last well beyond the presentation of the next stimulus, and in part because learning and
boredom and surprise are global cognitive responses to long segments of a sequence of
stimuli not responses to a single stimulus. If 100 treatment/control tasks are presented to
one subject in ten minutes, then it is unrealistic to characterize the eﬀect of the treatment
versus control in terms of response to single trials, because the response to each trial
is aﬀected by many previous trials.
We need to characterize the diﬀering responses to
treated and control stimuli without assuming the mind and brain are born anew after
each stimulus.
Third, the experimenter controls the stimuli, the requests for cognitive
activity, but requests for cognitive activity may not produce the requested activity, and
hence not produce the neurological activity characteristic of that cognitive activity.
is familiar from conversation: a speaker asks a question only to receive the reply: “Would
you repeat that? I wasn’t listening.” If a statistical test is used that expects every stimulus
to elicit its intended cognitive activity, the test may have much less power to detect actual
activity than a test which acknowledges distraction and boredom and error in addition to
the requested activity.
The old idea, due to Sir Ronald Fisher , is that randomization can form the
“reasoned basis for inference” in randomized experiments, creating without modeling assumptions all of the probability distributions needed to test the null hypothesis of no
treatment eﬀect. In his introduction of randomized experimentation, Fisher pointedly used a single-subject randomized experiment – the famed lady tasting tea
– precisely because modeling and sampling assumptions seemed so inadequate to describe
a single-subject experiment. In particular, there was no need to model the lady’s evolving
cognitive activity to test the null hypothesis that she could not discern whether milk or
tea had ﬁrst been added to the cup.
Although it sometimes receives less emphasis in
the statistics curriculum of 2011, Fisher’s theory of randomization inference was viewed as
one of the ﬁeld’s celebrated results.
This method of using random assignment to replace
modelling assumptions was described by Jerzy Neyman as “a very brilliant
one due to Fisher,”and in retrospect Neyman wrote: “Without randomization there is no guarantee that the experimental data will be free from a bias that no
test of signiﬁcance can detect.” In a similar vein, John Tukey recommended:
“using randomization to ensure validity – leaving to assumptions the task of helping with
stringency.” (Stringency is decent power in diﬃcult situations, in the spirit of the formal
notion of a most stringent test which minimizes the maximum power loss over a class of
alternatives.)
The newer idea addresses a limitation of Fisher’s method when used in the presence
of interference.
Fisher’s method yields a valid test of the null hypothesis of no eﬀect.
If a treatment eﬀect has a simple form, say an additive constant eﬀect or shift, then it is
possible to invert Fisher’s test of no eﬀect to yield a conﬁdence statement for the magnitude
of this constant eﬀect ; however, by its nature, interference precludes
such a simple form for an eﬀect. The newer idea is to invert the randomization test of no
eﬀect to yield a conﬁdence interval for an attributable eﬀect in the presence of interference
that contrasts the results seen with an active treatment to the results that would have
been seen in an experiment of identical design but with no active treatment, a so-called
“uniformity trial”common in the early years of randomized agricultural experimentation
 .
This newer idea is applicable with distribution-free statistics whose
distribution in the uniformity trial is known without conducting the uniformity trial. The
classes of distribution-free statistics and of rank statistics overlap substantially but are not
the same, and it is the distribution-free property that is needed here.
The third, gradually evolving idea made a ﬁrst appearance in a paper by Lehmann
 concerned with the power of rank tests.
After showing that Wilcoxon’s test was
the locally most powerful rank test for a constant, additive eﬀect in the presence of logistic
errors, Lehmann went on to show that it was also locally most powerful against a very
speciﬁc mixture alternative in which only a fraction of subjects respond to treatment.
Conover and Salsburg generalized the mixture alternative and derived the form
of the corresponding locally most powerful test; this was no longer Wilcoxon’s test, but
rather a test that gave greater emphasis to larger responses. Although they substantially
increase power when some trials fail to elicit the intended eﬀect, the ranks used by Conover
and Salsburg have no obvious interpretation, so they cannot be used as the basis for an
attributable eﬀect.
It turns out, however, that Conover and Salsburg’s ranks are almost
the same as ranks proposed by Stephenson ; see also related work by Deshpande and
Kochar and Stephenson and Gosh . Using Stephenson’s ranks, a conﬁdence
interval for attributable eﬀects becomes available , thereby permitting
inference about the magnitude of the eﬀect in the presence of interference.
Although the main goal is to illustrate these three ideas in the context of an fMRI
experiment, along the way a technical issue arises.
The experiment is not a perfectly
balanced design, and for unbalanced designs the attributable eﬀect has a more natural
interpretation if it is not formulated in terms of a linear rank statistic, but rather in terms
of a linear placement statistic in the sense of Orban and Wolfe , which is a form
of nonlinear rank statistic.
Because perfect balance is diﬃcult to achieve in cognitive
neuroscience experiments, we develop the formalities in terms of the placement statistics
that are most likely to be useful in practice.
A randomized experiment in the cognitive neuroscience of motor inhibition
In the experiment by Duann, Ide, Luo and Li , each of 58 experimental subjects
was observed in four experimental sessions that were each about ten minutes in length.
At random times during a session, a trial began, with a median of 97 trials per session.
With probability 3
4, the trial was a “go trial:”a dot was presented on a screen, and after a
interval of time of random length, the dot became a circle signifying that the subject was
to quickly press a button. With probability 1
4, the trial was a “stop trial:”the trial began
as a go trial, but brieﬂy after the circle appeared it was replaced by an X signifying “do
not press the button.” In a stop trial, the subject is instructed to do something, and then
the instruction is cancelled.
Here, an experimental unit is a trial, with stop trials called
‘treatment’and go trials called ‘control.’ During an experimental session, brain activity
was recorded using fMRI at two second intervals.
The experiment sought to determine
how the brain reacted diﬀerently to go and stop trials, where stop trials call for inhibition
of a previously requested motor response from the subject.
Figure 1 shows one session for one subject.
The vertical grey lines are go trials.
The vertical black lines are stop trials.
Based on fMRI, Figure 1 shows activity in the
subthalamic nucleus (STN). Aron and Poldrack and Li et al. suggested that
the STN plays an important role in response inhibition. In the lower portion of Figure 1,
the STN activity is ﬁltered without use of the stop/go distinction. The ﬁlter is a high-pass
ﬁlter of 128s: it removes slow, low frequency drifts, leaving behind the high frequency ups
and downs thought to reﬂect brain activity. The eﬀects of the ﬁlter are somewhat visible
in Figure 1.
For the STN, we analyze unﬁltered and ﬁltered data in parallel, obtaining
similar conclusions.
In eﬀect, the experiment produces 58 × 4 = 232 ﬁgures analogous to
Figure 1, one for each subject in each session, and does this for many regions of the brain.
The assumption of “no interference between units”is not at all plausible in Figure 1.
A typical session has about a hundred trials or experimental units in about 600 seconds.
There is interference if the response of a subject at a given trial is aﬀected by treatments at
other trials. Interference is likely for at least two reasons. First, the brain has a measurable
response to a stimulus for many seconds after the stimulus has been withdrawn, so a subject
is still responding to one trial when the next trial begins.
Second, the response to a stop
trial preceded by a long string of go trials may be diﬀerent from the response to a stop trial
preceded by another stop trial.
In addition, as time goes by, subjects are experiencing
the normal responses people have when performing a repetitive task: they become familiar
with the task, or bored by the task, or less distracted by the recording equipment and more
focused on the task, or distracted by something else, and each of these is a response to their
entire past experience. The 22,440 trials in this experiment are nothing like a randomized
clinical trial with 22,440 unrelated people who do not interfere with each other.
nonetheless, a randomized trial and randomization can form the basis for inference, as it
did in Fisher’s prototype trial of one lady tasting eight cups of tea.
The trial has a second important feature.
Not all trials are “successful.” In the
ﬁrst instance, in a stop trial, the subject is instructed ﬁrst to “go” – press the button
– and then the instruction is cancelled.
In a stop trial, if the random time between
the circle and the X is longer than usual and the subject is quicker than most, then she
may press the button before the instruction is cancelled.
In this case, even though the
trial is randomized to be a stop or treated trial, her brain should exhibit the response
typical under the control condition, because nothing she experienced distinguished the
trial from a go trial.
In addition to the situation just described, it may also happen
that the subject is unambiguously told to press the button but does not do so, or is
unambiguously told not to press the button but does so anyway, perhaps because the
subject is momentarily distracted.
Also, a subject may exhibit correct behavior with
erroneous thoughts, say failing to press the button because of distraction or fatigue rather
than inhibition. Expressed diﬀerently, whether or not a trial is successful is not generally
a visible property of the trial, yet we are conﬁdent that human subjects do not always
think the thoughts an experimenter requests.
If a trial is not successful in any of these
senses, then the requested cognitive activity may not take place, so there may not be
the change in blood oxygenation that would typically accompany the requested cognitive
Although a stimulus asks for a cognition, we cannot tell whether the cognition
took place or not, because we see only behavior and neurological response, but it is unlikely
that every stimulus elicits its intended cognition. We might think of responses as a mixture
of successful and unsuccessful trials, where successful trials produce a speciﬁc pattern of
fMRI response.
Salsburg , Conover and Salsburg and Rosenbaum 
consider rank tests that are particularly eﬀective when only a subset of experimental units
respond to treatment.
These rank tests score the ranks in such a way that little weight
is given to lower ranks.
In the current paper, a similar approach is taken in studies with
interference between units.
When a region of the brain is stimulated to activity, the change in blood oxygenation
measured by fMRI is not immediate. There is a brief delay, perhaps a dip, for about 2 seconds, followed by a sharp rise, a sharp fall to slightly below baseline, followed by a gradual
return to baseline; see Lindquist . This curve is known as the hemodynamic
response function (HRF). We use the form developed by Friston et al. , speciﬁcally
a weighted diﬀerence of two gamma densities, γ (x; ω, ϑ) = ϑωxω−1 exp (−ϑx) /Γ (ω), both
with parameter ϑ = 1/16, and with shape parameters ω1 = 6 and ω2 = 16, speciﬁcally the
function hrf (x) = γ (16x; 6, 1/16) −γ (16x; 16, 1/16) /6 where x is in seconds.
we do not report these results, we tried a second form for the HRF with a similar shape
but built from inverse logit functions , obtaining qualitatively
similar results in a table parallel to Table 2.
Recall that the measurements in Figure 1 occur at two second intervals. Evaluating the
hemodynamic response function, hrf (x), at two-second intervals, we computed 17 weights
for 17 two-second intervals that follow each trial, that is, for the 2 × 17 = 34 seconds
that follow a trial.
These weights sum to one.
The ﬁrst weight is zero, the third and
fourth weights are the largest (.375 and .385), and beginning at the eighth the weights
turn slightly negative (weight eight is −0.031) gradually returning to zero (weight 17 is
−0.0001). At the end of a session, if fewer than 17 two-second intervals remained, we used
the remaining intervals and renormalized the weights so that they again summed to one.
For a region such as STN in Figure 1, after each trial, we computed the sum of the HRF
weights multiplied by the fMRI measurements. If a region of a subject’s brain has become
unusually active, we expect this weighted average to become unusually large.
Figure 2 is
a pair of boxplots of this weighted average for the one session and one subject in Figure
1. In Figure 2, there is some indication that the responses in the stop or treated trials in
Figure 1 are elevated.
Although the analysis uses the responses in Figure 2 weighted by the hrf (x) function,
the method is applicable with any method of scoring the trials that produces one number
per trial.
For instance, a response that is sometimes used is the correlation between the
hrf (x) function and the sequence of responses that immediately follow a trial.
Section 2 reviews notation from Rosenbaum for treatment eﬀects when interference
may be present. In §3.1, a nonlinear rank statistic TZ is proposed for a randomized block
design with blocks of unequal block sizes; in particular, TZ is intended to perform well
when not all treated trials are successful in eliciting the intended cognitive activity. Under
the null hypothesis of no treatment eﬀect there is, of necessity, no interference among the
treatment eﬀects, and §3.2 uses ideas from Orban and Wolfe to obtain the null
randomization distribution of the test statistic TZ.
A conﬁdence statement about the
magnitude of eﬀect with interference is then obtained by a pivotal argument in §3.3: it
measures the magnitude of the diﬀerence between the actual trial and the uniformity trial.
In §4, the method of §3.3 is applied to activation of the subthalamic nucleus in §1.3.
simulation in §5 evaluates the power of TZ in experiments with interference using a mixture
model in which not all trials elicit the intended cognitive activity.
Notation: The Randomized Trial and the Uniformity Trial
Blocked randomized trial with interference between units
There are B ≥1 blocks, b = 1, . . . , B, and Nb ≥2 units bi in block b, i = 1, . . . , Nb, with
N = P Nb units in total.
In §1, there are B = 58 × 4 = 232 blocks consisting of the four
sessions for each of 58 subjects, N = 22, 440 units or trials in total, with 87 ≤Nb ≤104 and
a median Nb of 97. In block b, nb units are picked at random for treatment, 1 ≤nb < Nb,
the remaining mb = Nb −nb ≥1 units receive control.
In §1, the probability that a unit
was a “stop trial” was 1
4, resulting in 13 ≤nb ≤37 and a median nb of 24.
If unit i in
block b was assigned to treatment, write Zbi = 1, and if this unit was assigned to control
write Zbi = 0, and let Z = (Z11, Z12, . . . , ZB,NB)T be the N-dimensional vector in the
lexical order.
For a ﬁnite set A, write |A| for the number of elements of A.
for the set containing the |Ω| = QB
possible values z of Z, so z ∈Ωif and only
if zbi = 0 or zbi = 1 and nb = PNb
i=1 zbi for b = 1, . . . , B.
Write n = (n1, . . . , nB)T and
m = (m1, . . . , mB)T .
Write rbiz for the response that the ith unit in block b would have if the treatment
assignment Z equalled z for z ∈Ω.
In §1.3, for trial i of subject/session b, the response
rbiz is the HRF weighting of either the unﬁltered or ﬁltered activity in the subthalamic
nucleus (STN).
Each unit has |Ω| potential responses, only one of which is observed,
namely rbiZ. Figure 2 plots rbiZ for Zbi = 0 and Zbi = 1 for one b and i = 1, . . . , Nb.
Unlike the notation of Neyman and Rubin , the response of the ith unit
in block b may depend on the treatments Z assigned to all the units; that is, this notation
permits interference .
In §1, it is quite plausible that a previous
treatment for one subject may aﬀect later responses of this same subject.
Indeed, it is
possible that interference extends across the four blocks or sessions for a given subject.
Write R for the unobservable array with N rows and |Ω| columns having entries rbiz. The
unobservable R describes what would happen under all possible treatment assignments
z ∈Ω, but R does not change when actual randomized treatment assignment Z is selected.
In contrast, the observable responses rbiZ are one column of R, and which one column that
is does, of course, depend upon the randomized treatment assignment, Z. Fisher’s 
sharp null hypothesis H0 of no treatment eﬀect asserts that rbiz = rbiz′ for all z, z′ ∈Ω
and all b, i, so within each row bi of R all |Ω| columns have the same value for rbiz.
No interference between units means that rbiz = rbiz′ whenever zbi = z′
bi, that is, the
response in block b at trial i depends on the treatment zbi assigned in block b at trial i,
but it does not depend on the treatments z assigned at other trials. As discussed in §1.3,
no interference between units is not plausible in Figure 1, and because of the overlapping
of HRF functions is virtually impossible in Figure 2 if H0 is false.
By a randomized block experiment, we mean that
Pr (Z = z | R, n, m) = 1
|Ω| for each z ∈Ω.
In §1, the timing of trials and hence also the number Nb of trials was determined by a
random process; then, with probability 1
4 the trial was a “stop trial”and with probability
4 the trial was a “go trial;” hence, n and m were random variables, but the conditional
probabilities given R, n, m of particular patterns of stop or go trials was completely randomized within each block in the sense that (1) was true. Importantly, (1) says treatment
assignments were determined by a truly randomized mechanism that ensured the unobservable potential responses R were not predictive of treatment assignment Z; this is, of
course, the essential element of randomized treatment assignment. In a randomized experiment, any association between treatment assignment Z and the observed responses, rbiZ,
is due to an eﬀect caused by the treatment expressed in R; because of (1), an association
between Z and rbiZ cannot result from biased selection into treated and control groups if
the treatment has no eﬀect, that is if Fisher’s H0 is true.
The uniformity trial
As mentioned previously, in the absence of interference, it is natural to ask how a unit
would have responded if that one unit had received the treatment and or if that one unit
had received the control and to deﬁne eﬀect of the treatment on this unit as a comparison
of these two potential responses; see Neyman , Welch and Rubin for
discussion of this standard way of deﬁning treatment eﬀects in randomized experiments.
This formulation does not work when there is interference between units because a unit
may be aﬀected by treatments applied to or withheld from other units.
Some deﬁnition
of the treatment eﬀect with interference is needed if a randomization test of the null
hypothesis of no eﬀect is to be inverted to obtain a conﬁdence interval for the magnitude
of eﬀect. In principle, the treatment eﬀect is characterized by the N × |Ω| array R, where
; however, that array is mostly not observed, and it is so large and detailed
that it would be beyond human comprehension even if it were observed.
We would like
to deﬁne the treatment eﬀect as a summary of R, but in such a way that the summary is
intelligible and usable in inference.
We deﬁne the treatment eﬀect with reference to a uniformity trial of the type that, in
a certain era, was commonly used as an aid to designing experiments; see Cochran .
For instance, uniformity trials were once used to study the performance of competing
experimental designs, such as complete randomization or randomized blocks or randomized
Latin squares.
In a uniformity trial, treatment assignment Z is randomized as if an
actual experiment were about to be performed, but instead Z is ignored and the standard
treatment is applied in all cases.
In its original use, a uniformity trial divides a farm
into plots, assigns plots to a new treatment or a standard control at random, ignores
the random assignment Z and applies in all cases the standard fertilizer, insecticide, etc.,
and ultimately harvests the crops recording yields in each plot.
Essentially, the farmer
cooperated in setting up an experiment and recording results, but he work the farm in the
usual way, harvesting the usual crops for sale. This produced a simulated experiment with
real crops in which the null hypothesis of no treatment eﬀect is known to be true.
instance, by comparing two uniformity trials, perhaps at the same farm, one might discover
that the estimated standard error is smaller from a uniformity trial designed as a Latin
square than another uniformity trial designed as randomized blocks.
In a certain era,
statisticians did this, so in our era it is easy to imagine something that was once actually
We deﬁne the treatment eﬀect with interference with reference to a uniformity trial.
Stated informally, the eﬀect a treatment with interference is a comparison of what happened
in the actual experiment with its active treatment to what would have happened in a
uniformity trial with the same treatment assignment Z but no active treatment. As in an
era gone by, it is a comparison of two whole experiments, rather than a comparison of a
treated and a control group. With interference, both treated and control units are aﬀected
by treatments applied to other units, so a comparison of a treated and a control group is not
a comparison of a treated and an untreated situation. A comparison of an experiment with
an active treatment and a uniformity trial is a comparison of a treated and an untreated
situation.
In §1.3, this is a comparison of an experiment with randomized stop and go
trials and an experiment of identical structure with only go trials.
Conveniently, using a
few technical tools in §3.3 that were not available in 1937, we can make inferences about
a uniformity trial that was never performed with the aid of a distribution-free pivotal
Write erbi for the response of unit i in block b in the uniformity trial.
There is only
one such erbi, not one for each z ∈Ω, because the realized treatment assignment Z that
was recorded in an oﬃce has no way to aﬀect the biological response of unit i in block
Because the uniformity trial was not actually performed, none of the erbi are observed.
Generally, erbi need not equal any of rbiz, z ∈Ω.
If there were no interference between
units, then erbi would equal rbiz for every z ∈Ωwith zbi = 0, because without interference
the response of unit bi depends only on the treatment zbi assigned to bi; however, with
interference, it can happen that erbi ̸= rbiz for every z ∈Ω. Write er = (er11, . . . , erB,NB)T .
In the presence of interference between units, the magnitude of the treatment eﬀect is
understood not as a comparison of treated and control groups both of which are aﬀected
by the treatment, but as a comparison of the actual experiment and the uniformity trial.
Inference with Interference
Preliminaries: a nonlinear rank statistic; testing no treatment eﬀect
Fix an integer k ≥2, with k ≤minb∈{1,...,B} mb + 1. As will be seen, the familiar choice is
k = 2, and it yields the Mann-Whitney U-statistic, but there are reasons to prefer a larger
value of k when only some treated units respond to treatment. Ties among responses are
not an issue in the fMRI experiment of §1.3, where blood oxygenation is recorded to many
digits. We assume no ties in the discussion that follows.
The technical material that follows is not diﬃcult but does require a certain amount of
To simplify, the reader may consider the special case of a single block (B = 1)
with the parameter k set to k = 2; then, one is considering a single-subject completely
randomized trial, like the lady tasting tea, using the Mann-Whitney-Wilcoxon statistic,
which happens to be the only linear placement statistic that is also a linear rank statistic
 .
For a speciﬁc treatment assignment, z ∈Ω, consider a subset Sbz = {i1, . . . , ik} of k
units from the same block b with one treated unit, zbi1 = 1, and k−1 control units, zbij = 0,
j = 2, . . . , k.
Write Kbz for the collection of all nb
such subsets Sbz for block b, so
Sbz ∈Kbz if and only if Sbz ⊆{1, . . . , Nb} with |Sbz| = k and 1 = P
i∈Sbz zbi.
The set Sbz compares one treated unit to k −1 control units.
Write v (Sbz) = 1 if
the treated unit, say i1, in Sbz = {i1, . . . , ik} has the largest response under assignment
z, that is, if rbi1z > maxj∈{i2,...,ik} rbjz, and write v (Sbz) = 0 otherwise.
For k = 2, the
set Sbz = {i1, i2} has one treated unit and one control and v (Sbz) = 1 if the treated unit
has a higher response than the control under assignment z.
Also, let wb be a weight to
be attached to block b where wb is a function of n and m.
In the current paper, wb = 1
for all b, but another reasonable deﬁnition of wb will be given in a moment.
treatment assignment z, the quantity Tz = PB
Sbz∈Kbz v (Sbz) is a weighted count of
the number of sets Sbz such that the treated unit had a higher response than k−1 controls.
With wb = 1, the quantity Tz is a count, and a count is reasonable if the Nb and nb do not
vary much, as is true in §1.3.
If the nb and mb varied greatly with b, then wb given by
1/wb = B nb
makes Tz the unweighted average over the B blocks, b = 1, . . . , B, of the
proportion of sets Sbz ∈Kbz in which the treated unit had a higher response than k −1
controls, v (Sbz) = 1.
For most z, the quantity Tz depends upon parts of R that are not
observed, so Tz cannot be computed from the observed data.
If the randomized treatment assignment Z replaces the speciﬁc treatment assignment
z, then needed parts of R are observed, and TZ is a statistic that can be computed from
Indeed, if B = 1, k = 2, and w1 = 1, then TZ is the Mann-Whitney U-statistic
and is linearly related to Wilcoxon’s rank sum statistic.
More generally, for k = 2 and
B > 2, TZ is a weighted sum of B Mann-Whitney statistics; see Lehmann and
Puri who discuss weights intended to increase power against shift alternatives in
the absence of interference.
For k ≥2, if nb = 1 and Nb = N/B does not vary with b, then TZ is the statistic
discussed in Rosenbaum .
Taking k > 2 tends to increase power when only a
subset of treated units respond to treatment, as seems likely here for reasons discussed
in §1.3. Indeed, with k > 2, the ranks are scored in a manner that closely approximates
Conover and Salsburg’s locally most powerful ranks for an alternative in which
only a fraction of treated units respond, and the scores are identical to those proposed by
Stephenson .
In these special cases of the two previous paragraphs, TZ is a stratiﬁed linear rank statistic. In general, TZ is a function of the ranks, but not a linear function; however, it is a
sum of B linear functions of the placements within blocks in the sense of Orban and Wolfe
 . For B = 1, the statistic with k ≥2 has been discussed by Deshpande and Kochar
 and Stephenson and Gosh as an instance of Hoeﬀding’s U-statistics
under independent sampling of two distributions. Because interference precludes independent observations, inferences must be based on the random assignment of treatments, and
for this the combinatorial development in Orban and Wolfe is particularly helpful.
Orban and Wolfe deﬁne the placement mbUbj of the jth treated unit in block b
to be the number of controls in block b who have a response less than or equal to the response of this treated unit. A linear placement statistic for one block b is then of the form
i=1 Zbi φnb,mb (Ubj) for some function φnb,mb (·).
If there are no ties among responses
within blocks, then taking φnb,mb (u) = wb
expresses TZ = PB
SbZ∈Kbz v (SbZ)
as a sum of linear functions of placements of the treated units, TZ = PB
j=1 φnb,mb (Ubj),
is deﬁned to equal zero for ℓ< k −1.
Consider testing Fisher’s null hypothesis H0 of no eﬀect which asserts that rbiz = rbiz′
for all z, z′ ∈Ωand all b, i.
If H0 were true, then the observed response rbiZ is the
same no matter what Z ∈Ωis randomly selected, so R is known and the distribution
of Pr (TZ ≥t | R, n, m) is determined by the known ﬁxed R and the randomized treatment assignment (1).
Indeed, in part because no eﬀect entails no interference in eﬀects,
testing no eﬀect H0 is a straightforward application of randomization inference. Orban
and Wolfe determine the null distribution of their linear placement statistic
j=1 φnb,mb (Ubj) under independent sampling from a continuous distribution; however,
their argument is entirely combinatorial, and it is easily seen that if responses with blocks
are not tied then their argument and results give the exact null randomization distribution
j=1 φnb,mb (Ubj).
Moreover, given R, n, m, under H0 and (1), TZ is the sum of B
conditionally independent terms each with the known null distribution in Orban and Wolfe
 .
Importantly, in the absence of ties, this null distribution of TZ depends upon
n, m, but not on R.
The distribution of the test statistic in the uniformity trial
In the uniformity trial of §2.2, the null hypothesis of no eﬀect on erbi is known to be
true because, following a concealed randomization Z, no treatment was applied.
be the value of the statistic of §3.1 computed from the erbi in the uniformity trial when
Z = z ∈Ω, with value eTZ under the realized random assignment Z.
Speciﬁcally, write
ev (Sbz) = 1 if the treated unit, say i1, in Sbz = {i1, . . . , ik} has the largest response under
assignment z, that is, if erbi1 > maxj∈{i2,...,ik} erbj, and write ev (Sbz) = 0 otherwise, so
that eTz = PB
Sbz∈Kbz ev (Sbz).
Even though erbi is not aﬀected by the treatment
assignment Z, the statistic eTZ is generally a nondegenerate random variable because the
value of the statistic depends jointly on the responses of units, erbi, which do not ﬂuctuate,
and on the treatments they receive, Zbi, which are random.
In point of fact, neither eTZ nor eTz can be computed from observed data, because the
uniformity trial was not performed and none of the erbi are observed.
Nonetheless, in
the absence of ties, the distribution of eTZ is known, because the null distribution in §3.1
depends upon n and m but not on R; speciﬁcally, it is the convolution of B random
variables whose exact distributions are given by Orban and Wolfe and (2.2)), with expectation and variance
nb φnb,mb where φnb,mb =
nb (nb + mb + 1)
(mb + 1) (mb + 2)
−(mb + 1) φ
moreover, for reasonable choices of weights, wb, as B →∞,
where Φ (·) is the standard Normal cumulative distribution.
To emphasize, because the
null hypothesis of no eﬀect is known to be true in the uniformity experiment, and because
the null distribution of eTZ depends upon n and m but not on the erbi’s, it follows that we
know the distribution of eTZ in the uniformity trial even though we did not perform the
uniformity trial and even if the treatment did have an eﬀect with interference in the actual
randomized experiment.
This fact turns out to be useful with the aid of the concept of
attributable eﬀects .
Attributable eﬀects
Consider a speciﬁc treatment assignment z ∈Ωand the speciﬁc comparison Sbz = {i1, . . . , ik} ∈
Kbz of one treated unit, say i1 with zbi1 = 1, and k −1 control units, ij with zbij = 0 for
j = 2, . . . , k. If rbi1z > maxj∈{i2,...,ik} rbjz then i1 had the highest response in this compar-
ison, contributing a 1 rather than a 0 to Tz; however, this might or might not be an eﬀect
caused by the treatment, because even under the null hypothesis of no eﬀect H0, one of
the k units will have the highest response among the k units. If rbi1z > maxj∈{i2,...,ik} rbjz
but erbi1 ≤maxj∈{i2,...,ik} erbj then treatment assignment z in the actual experiment does
cause unit i1 in block b to have a higher response than units {i2, . . . , ik} in block b in the
sense that unit i1 in block b would not have had the highest response in this comparison
in the uniformity trial of §2.2 in which no unit was treated. In §1.3, this would mean that
in block b, stop trial i1 caused activity in the STN region to exceed the level in go trials
i2, . . . , ik in the sense that the activity was higher in the actual experiment and would
not have been higher in the uniformity trial.
Conversely, if rbi1z ≤maxj∈{i2,...,ik} rbjz but
erbi1 > maxj∈{i2,...,ik} erbj then treatment assignment z in the actual experiment prevented
treated unit i1 from having the highest response in Sbz, in the sense that i1 would have
had the highest response in the uniformity trial but did not have the highest response in
the actual experiment. The third possibility is that treatment assignment z does not alter
whether or not i1 has the highest response in Sbz.
Concisely, these three situations are:
(i) v (Sbz) = 1 and ev (Sbz) = 0, (ii) v (Sbz) = 0 and ev (Sbz) = 1, and (iii) v (Sbz) = ev (Sbz).
For treatment assignment z ∈Ω, the attributable eﬀect
Az = Tz −eTz =
{v (Sbz) −ev (Sbz)}
is the net increase in the number of times (weighted by wb) that a treated response in
the actual experiment exceeded k −1 control responses because of eﬀects caused by using
treatment assignment z.
So Az is a real valued function of z, er and R.
In contrast,
AZ is the attributable eﬀect for the Z randomly chosen according to (1), so AZ is the
diﬀerence between an observed statistic, TZ, that describes the actual experiment, and an
unobservable random variable eTZ that describes the uniformity trial in §2.2; however, the
distribution of eTZ is known, as discussed in §3.2.
In brief, AZ is an unknown random
quantity which provides a reasonable measure of the eﬀects of the treatment despite the
presence of interference between units. More precisely, AZ compares the aggregate eﬀects
of the treatment in the presence of interference to the pattern that would be exhibited in
the uniformity trial in which no one is treated. If Fisher’s null hypothesis of no eﬀect H0
is true, then E (AZ) = 0. For discussion of attributable eﬀects in randomized experiments
without interference, see Rosenbaum .
Let etα be the smallest value such that Pr
eTZ ≤etα | R, n, m
≥1 −α. From (2), for
large B, we may approximate etα as
+ Φ−1 (1 −α)
The following fact parallels a result in Rosenbaum for a diﬀerent family of statistics.
In particular, Proposition 1 yields a one-sided 1 −α conﬁdence interval for the unobserved
random variable AZ in terms of the observed random variable TZ and the known quantity
etα. See Weiss for general discussion of conﬁdence intervals for unobservable random
variables.
Proposition 1 In a randomized experiment with interference in which (1) holds and there
are no ties,
 AZ ≥TZ −etα | R, n, m
The proof of Proposition 1 is immediate:
 AZ ≥TZ −etα | R, n, m
TZ −eTZ ≥TZ −etα | R, n, m
eTZ ≤etα | R, n, m
The attributable eﬀect AZ depends upon the sample sizes, n and m, and the choice of k.
Dividing AZ by E
can aid interpretation. Then 100 × AZ/E
is the (weighted)
percent increase above chance in the number of times a treated unit had a higher response
than k −1 controls due to eﬀects caused by the treatment, and with conﬁdence 1 −α, the
unobserved 100 × AZ/E
is at least 100 ×
We are suggesting that the unobservable random variable AZ/E
is a useful measure of the magnitude of the treatment eﬀect when interference may be present; however,
it is a new measure, and its magnitude is unfamiliar. To build some intuition about magnitudes of AZ/E
, consider its behavior in a familiar context, namely a single block,
B = 1, independent observations without interference and a treatment eﬀect that is an
additive shift, δ.
In this case, as n1 →∞and m1 →∞, the quantity TZ/
converges in probability to the probability that a treated response exceeds k −1 control
responses and AZ/E
converges in probability the percent increase in this probability
above the chance level of 1/k.
Table 1 evaluates these limits for the standard Normal
distribution and the t-distribution with 2 degrees of freedom.
For instance, with a shift
δ in a Normal that equals a full standard deviation, δ = 1, the probability that a treated
response exceeds nine control responses in 0.341 which is 241% above the chance level of 0.1
for δ = 1. The quantity AZ/E
has the advantage that it continues to be meaningful
with interference where shift models are inapplicable.
Proposition 1 refers to an analysis of responses, but it is possible in a randomized experiment to use the same approach with residuals from a robust covariance adjustment which
controls for measured disturbing covariates such as head motion.
See Rosenbaum 
for general discussion of randomization inference for covariance adjustment in randomized
experiments, and see Rosenbaum for its application with interference.
procedure is illustrated in §4 in Table 4.
Table 1: In the absence of interference and dependence, the upper table gives the probability that one treated response is higher than k −1 independent control responses when
the treatment eﬀect is an additive shift δ and the errors are independently drawn from
either a standard Normal distribution or the t-distribution with 2 degrees of freedom. The
lower table gives the percentage increase in this probability above chance; for example,
14% = (0.57 −0.50)/0.50.
Probability a treated response is
higher than k −1 controls
t with 2 df
Percentage increase above chance
t with 2 df
To what extent do stop trials activate the subthalamic nucleus?
Is activity in the subthalamic nucleus (STN) elevated following stop trials? Figures 1 and
2 depict STN activity for one subject in one session, but there are 58 subjects, each with
4 sessions, making 58 × 4 = 232 blocks, with a total of N = 22, 440 randomized go-or-stop
Table 2 performs the analysis in §3 three times, for k = 2, 5 and 10.
Recall that
for k = 2, the statistic TZ is the sum of 232 Mann-Whitney-Wilcoxon statistics.
deviates for testing the null hypothesis of no eﬀect H0 are extremely large, particularly
for the ﬁltered data with k = 5 or k = 10.
In the uniformity trial, we expect that when
comparing a treated unit to nine controls, one time in ten the treated unit will have the
highest response.
For ﬁltered STN, k = 10, the point estimate of AZ/E
a 53.0% increase above this chance expectation due to eﬀects caused by the treatment,
but we are 95% conﬁdent of only a 46.4% increase.
Again, in the presence of arbitrary
interference between units, these are correct statements about the relationship between the
actual trial, with its unobserved attributable eﬀect AZ, and the uniformity trial that was
not actually performed.
In addition to the subthalamic nucleus, other regions of the brain are suspected to
be involved in motor response inhibition, including the right inferior frontal cortex and the presupplementary motor area . In analyses parallel to Table 2, we found smaller
but signiﬁcantly elevated activity in both the rIFC and preSMA. Using ﬁltered data for
rIFC with k = 5, we obtained a P-value testing no eﬀect of 0.0030, a point estimate for
of 0.059 and a 95% conﬁdence interval of AZ/E
≥0.024. Using ﬁltered
data for preSMA with k = 5, we obtained a P-value testing no eﬀect of 0.000053, a point
estimate for AZ/E
of 0.084 and a 95% conﬁdence interval of AZ/E
Table 2: Randomization test of no treatment eﬀect H0 and randomization-based conﬁdence
interval for the attributable eﬀect AZ in the presence of interference between units.
Test of No Eﬀect
Fractional Increase AZ/E
Deviate Testing H0
Point Estimate
(TZ −E( eTZ))
TZ −E( eTZ)
Unﬁltered STN
Filtered STN
Although the point estimates of 5.9% above chance for rIFC and 8.4% above chance for
preSMA are signiﬁcantly larger than zero, they are substantially smaller than the point
estimate of 29.5% above chance for ﬁltered STN with k = 5 in Table 2.
For k > 2, the statistic TZ and unmeasurable attributable eﬀect AZ handle the treated
and control groups in diﬀerent ways: one treated unit is compared to k −1 controls.
one expected successful stop trials to suppress rather than elevate activity, one needs to
apply TZ to −rbiZ rather than to rbiZ.
For instance, we might expect reduced activity in
the primary motor cortex (M1) during stop trials, because motor activity is not requested
in a stop trial.
Applying TZ to −rbiZ for ﬁltered data from M1 with k = 5, we obtain a
P-value testing no eﬀect of 0.000011, a point estimate for AZ/E
of 0.092 and a 95%
conﬁdence interval of AZ/E
≥0.056, consistent with reduced activity in M1 in stop
The inferences just described are appropriate in the presence of interference of arbitrary
But is there interference?
Here, we look at one very simple possible form for
interference, namely interference from the immediately previous trial.
Recall that trials
Table 3: Testing for a simple form of interference: comparison of go-go trials and stop-go
trials for STN.
Test of No Lingering Eﬀect
Fractional Increase AZ/E
Point Estimate
are randomly go or stop trials, where go trials occur with probability .75 and stop trials with
probability 0.25. Aside from the ﬁrst trial in a session, the remaining trials may be classiﬁed
into four groups based on the current and previous trial as go-go with probability 0.752 =
0.5625, stop-go with probability 0.25×0.75 = 0.1875, go-stop with probability 0.75×0.25 =
0.1875, and stop-stop with probability 0.252 = 0.0625. If there is no interference, then the
treatment at the current trial may have an eﬀect, but not the treatment at the previous
trial, so go-go should have the same eﬀect as stop-go, and go-stop should have the same
eﬀect as stop-stop.
Table 3 compares the two common cases, go-go to stop-go trials,
ignoring other cases, using the same methods as in Table 2, reporting only results for
ﬁltered data. In Table 3, a diﬀerence indicates a very speciﬁc form of interference, namely
a lingering eﬀect from a previous stop trial on a current go trial. There is clearly evidence
in Table 3 of a lingering eﬀect of a previous stop trial, but the magnitudes of eﬀect are much
smaller than in Table 2 for the eﬀect of the treatment in the current trial.
Importantly,
the inferences in Table 3 are appropriate for comparing go-go and stop-go trials even if
other forms of interference are also present.
Head movements during the experiment may distort fMRI readings.
As discussed
and illustrated in Rosenbaum , instead of studying the attributable eﬀect for
the responses themselves, the method in Rosenbaum may be used as the basis for
randomization inference about the attributable eﬀect on residuals from a robust covariance
Table 4: Comparison of STN activity with robust covariance adjustment for head movement.
Test of No Eﬀect H0
Fractional Increase AZ/E
Point Estimate
adjustment.
Table 4 applies the method of Table 2 to residuals of STN levels after
adjustment for six covariates describing translation and rotation of the head as estimated
from three-dimensional images of each session, the residuals being obtaining using the
default settings of the R function rlm which implements Huber’s m-estimation.
is generally similar to Table 2, so covariance adjustment for head motion did not greatly
alter the results.
A Simulation of the Size and Power of Competing Tests in the Presence of
Interference Between Units
Description of the simulation
Tables 5 and 6 report a simulation study of power with and without interference between
Both tables refer to a completely randomized experiment; that is, there is a single
block, B = 1. In Table 5, there are N = 250 trials, whereas in Table 6 there are N = 1000
trials. Each trial is randomly assigned to be a treated trial or a control trial with probability
2. As in the actual experiment in §1.3, only some treated trials elicit the intended cognitive
activity and brain response. In Table 5, λ = 50% of treated trials are successful, whereas
in Table 6, λ = 10% of treated trials are successful.
A control trial yields a response
drawn from a distribution F (·), and in Tables 5 and 6 this distribution F (·) is either the
standard Normal distribution or the t-distribution on 2 degrees of freedom. In the absence
of interference, a successful treated trial yields a response from F ν (·) and an unsuccessful
trial yields a response from F (·), so an unsuccessful treated trial looks like a control trial,
but a successful treated trial looks like the maximum of ν independent control trials;
see Lehmann , Salzburg and Conover and Salzburg for discussion and
history of this mixture model. Formally, in the absence of interference, the Salzburg model
yields control responses from F (·) and treated responses from (1 −λ) F (·)+λF ν (·), where
Lehmann had considered ν = 2, and Conover and Salzburg had determined the locally most
powerful ranks as λ →0, which are essentially Wilcoxon’s ranks for ν = 2. In this mixture
model, successful treated trials are from F ν (·) and unsuccessful treated trials are from
F (·), but trials are not labeled as successful or unsuccessful.
We introduce interference
into this model by assuming that a successful trial samples from F ν (·) rather than F (·)
only if certain additional conditions hold deﬁned in terms of treatments assigned to the
previous few trials.
In Table 5, ν = 10, but in Table 6, ν = 20; that is, a larger ν in Table 6 oﬀsets a smaller
λ so that the power remains in an interesting range. The maximum of ν = 10 independent
observations from a Normal distribution will often be smaller and more stable than the
maximum of ν = 10 observations from a t-distribution with 2 degrees of freedom, and this
may aﬀect diﬀerent tests in diﬀerent ways.
Four types of interference were simulated.
With interference of type A, a successful
treated trial that immediately follows a control trial has a response drawn from F ν (·), but
all unsuccessful trials and all treated trials that immediately follow other treated trials have
responses drawn from F (·).
With interference of type B, a successful treated trial that
immediately follows a treated trial has a response drawn from F ν (·), but all unsuccessful
trials and all treated trials that immediately follow control trials have responses drawn
Table 5: Simulated power with interference in a randomized experiment in a single block,
B = 1, of size N = 250, when 50% of trials are successful, λ = 0.5. The case ν = 1 is
the null hypothesis of no eﬀect and hence no interference among eﬀects, so the simulation
is estimating the true size of a test with nominal level 0.05. The statistic k = 2 is the
Mann-Whitney-Wilcoxon statistic. The highest power in a non-null row is in bold.
λ = 0.5, N = 250
No Autoregressive Errors Added
F(.) is Normal
ν = 1, No eﬀect
ν = 10, No interference
ν = 10, Interference A
ν = 10, Interference B
ν = 10, Interference C
ν = 10, Interference D
F(.) is the t-distribution, 2 df
ν = 1, No eﬀect
ν = 10, No interference
ν = 10, Interference A
ν = 10, Interference B
ν = 10, Interference C
ν = 10, Interference D
Autoregressive Errors Added
F(.) is Normal
ν = 1, No eﬀect
ν = 10, No interference
ν = 10, Interference A
ν = 10, Interference B
ν = 10, Interference C
ν = 10, Interference D
F(.) is the t-distribution, 2 df
ν = 1, No eﬀect
ν = 10, No interference
ν = 10, Interference A
ν = 10, Interference B
ν = 10, Interference C
ν = 10, Interference D
Table 6: Simulated power with interference in a randomized experiment in a single block,
B = 1, of size N = 1000, when 10% of trials are successful, λ = 0.1. The case ν = 1 is
the null hypothesis of no eﬀect and hence no interference among eﬀects, so the simulation
is estimating the true size of a test with nominal level 0.05. The statistic k = 2 is the
Mann-Whitney-Wilcoxon statistic.
λ = 0.1, N = 1000
No Autoregressive Errors Added
F(.) is Normal
ν = 1, No eﬀect
ν = 20, No interference
ν = 20, Interference A
ν = 20, Interference B
ν = 20, Interference C
ν = 20, Interference D
F(.) is the t-distribution, 2 df
ν = 1, No eﬀect
ν = 20, No interference
ν = 20, Interference A
ν = 20, Interference B
ν = 20, Interference C
ν = 20, Interference D
Autoregressive Errors Added
F(.) is Normal
ν = 1, No eﬀect
ν = 20, No interference
ν = 20, Interference A
ν = 20, Interference B
ν = 20, Interference C
ν = 20, Interference D
F(.) is the t-distribution, 2 df
ν = 1, No eﬀect
ν = 20, No interference
ν = 20, Interference A
ν = 20, Interference B
ν = 20, Interference C
ν = 20, Interference D
from F (·).
Interference C and D resemble interference A, except that in C a successful
treated trial only has a response drawn from F ν (·) if it follows 2 or more control trials,
and in D if it follows 3 or more control trials.
Interference between units creates one type of dependence over successive trials, but
there can also be other types of dependence that are present in the absence of interference,
indeed present in the absence of any treatment eﬀect. The upper half of Tables 5 and 6 is
dependent over successive trials only due to interference. In the lower half of Tables 5 and
6, the responses above are added to stationary autoregressive errors with standard Normal
marginal distributions and autocorrelation 0.5.
Each situation was simulated 5000 times, so the simulated power has a standard error
of at most
.25/5000 = 0.007.
Results of the simulation
Tables 5 and 6 contrast the size and power of four test statistics, namely the conventional
pooled variance t-statistic and TZ for three values of k, k = 2, k = 5, and k = 10.
that k = 2 corresponds with the Mann-Whitney-Wilcoxon statistic, and k = 5 is similar to
the suggestion of Salzburg and Conover and Salzburg .
The case of ν = 1 in Tables 5 and 6 is the null hypothesis: it suggests that all four tests
have size close to their nominal level of 0.05 in all sampling situations. This is expected
for TZ because it is a randomization test applied under the null hypothesis of no eﬀect
in a randomized experiment.
For related results about the randomization distribution
of statistics such as the t-statistic, see Welch .
Notice that, because this is a
randomization test in a randomized experiment, it has the correct level even in the case of
autocorrelated errors.
In brief, because all four tests appear to be valid, falsely rejecting
true hypotheses at the nominal rate of 5%, it is reasonable to contrast the tests in terms
In the non-null cases, ν > 1, the test with the highest power is in bold.
test is uniformly best in the situations considered in Tables 5 and 6, but the t-test and
the Mann-Whitney-Wilcoxon test are never much better than k = 5 and are often much
The statistic with k = 10 performs well only in Table 6 where successful trials
occur only 10% of the time.
The permutational t-statistic performs well only when both
F (·) and the autoregressive errors are Normal, and it performs poorly when the F (·) is
the t-distribution with 2 df. When F (·) is Normal and there are no autoregressive errors,
the permutational t-statistic typically had less power than k = 5.
Tables 5 and 6 exhibit many patterns. It is not surprising that the addition of Gaussian
autoregressive errors reduces power: the power in the top half of Tables 5 and 6 is typically
quite a bit higher than the corresponding power in the lower half of the tables. Both types
of interference, A and B, reduce power when compared with no interference, but in Tables
5 and 6 interference A and B had similar eﬀects on power. Interference patterns C and D
reduce the number of responses that diﬀer from control, so they reduce power relative to
case A, but the suggestion of Conover and Salsburg, namely k = 5, exhibits decent relative
performance in most if not all cases.
Comparison with SPM
A common approach to the analysis of fMRI data is the statistical parametric map (SPM)
approach of Friston et al. . Using responses convolved with a hemodynamic response
function (HRF) as in Figure 2, the SPM approach entails testing a hypothesis of the equality
of two regression coeﬃcients in a generalized least squares analysis.
We simulated this
analysis with and without interference, with and without autoregressive errors, and with
mixtures of successful and unsuccessful trials.
The SPM approach uses a parametric
model and is not a randomization inference, so there is no reason to expect that it will
have the correct level when there is no treatment eﬀect but the parametric model is false.
Indeed, in nominal 0.05 level tests in our simulation, true null hypotheses of no eﬀect were
rejected more often than 5% of the time, in some cases with probabilities as high as 30%.
In light of this, a power comparison is not appropriate.
It is not a fault of the SPM
method that it does not control the type one error rate when the null hypothesis of no
eﬀect is true but the model itself is false; that type of error control is not expected from
standard parametric inference.
Presumably, a careful user of the SPM approach would
check for model failures using residuals and diagnostics, and alter the parametric model in
appropriate ways.
Nonetheless, it is convenient that the randomization inferences in §3
do control the type one error rate at 5% in the presence of autocorrelation, interference
between units, unsuccessful trials and error distributions (such as the t-distribution with 2
degrees of freedom) that lack a ﬁnite variance.
Alternative designs and power
The simulation has compared the power of diﬀerent statistics in given situations with
interference. Another potential source of increased power entails alternative experimental
designs which alter the degree of interference by altering the time interval between trials.
In the absence of interference, we generally expect more power with more trials, so naively
we might expect increased power from ever more trials ever more rapidly paced. However,
in cross-over designs, it is also commonly said that interference should be reduced by
allowing time for a wash-out period between trials.
In particular, it is possible that few
trials with more time between them would yield less interference and fMRI activity that is
more sharply distinct following treatment or control.
If one were using a statistic that is
valid only in the absence of interference, then the power in these two situation could not be
compared, because a broader range of validity is being weighed against possibly reduced
In contrast, using the randomization distribution of TZ to test H0, the test is
valid, with correct level, for both rapid-ﬁre designs with many trials and widely-spaced
designs with fewer trials, and a comparison of power is possible.
For instance, a smaller
number of trials with more successful trials and less interference (N = 250, λ = .5, case
A in Table 3) yields greater power than more trials with fewer successful trials and more
interference (N = 1000, λ = .1, case D in Table 4), so it is clear that increasing the number
of trials must be weighed against potential harms from increasing the pace at which trials
are conducted.
Randomized experiments in cognitive neuroscience of the type described in §1.3 have three
attributes that were important in the current discussion.
First, with about 100 randomized stimuli for a single brain in a session of 600 seconds, interference is likely: the stimulus
applied in one trial is likely to aﬀect the response measured for other trials.
Interference
that is local in time is almost inevitable because the measurable response to one stimulus lasts for more than six seconds, but additionally as the trial progresses a subject is
growing more familiar and experienced with the tasks and equipment, so interference may
have a complex form that can extend across diﬀerent sessions for the same subject. The
use of the HRF function in passing from Figure 1 to Figure 2 is a standard attempt to
pick out the response to a particular stimulus, and useful though this is, it is at best an
approximation. Second, with rapid ﬁre trials of this sort, not every trial will be successful
in eliciting the intended cognitive activity.
This is quite evident in the experiment in
§1.3, because subjects responded inappropriately to some go or stop trials, but inattention,
distraction or confusion can also occur without visible evidence.
Some exposures to a
stimulus stimulate the intended thought process, some don’t.
Third, because this is a
randomized experiment, randomization can form the basis for inference, thereby avoiding
assumptions of independence and non-interference. Within this context, we have proposed
and illustrated a straightforward, robust methodology that (i) yields a conﬁdence interval
for the magnitude of eﬀect despite interference between units, and (ii) often has greater
power than procedures based on Wilcoxon’s statistic when only some treated trials are
successful.