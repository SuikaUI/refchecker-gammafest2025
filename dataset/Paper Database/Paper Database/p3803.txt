Analyzing Multiple Nonlinear Time Series
with Extended Granger Causality
Yonghong Chen
Xi’an Jiaotong University, Xi’an 710049, P.R. China
Center for Complex Systems and Brain Sciences, Florida Atlantic University,
Boca Raton, FL 33431, USA
Govindan Rangarajan
Department of Mathematics and Centre for Theoretical Studies, Indian Institute of
Science, Bangalore 560 012, India
Jawaharlal Nehru Centre for Advanced Scientiﬁc Research, Bangalore, India
Jianfeng Feng
Department of Informatics, Sussex University, Brighton BN1 9QH, United
Mingzhou Ding
Center for Complex Systems and Brain Sciences, Florida Atlantic University,
Boca Raton, FL 33431, USA
 
6 February 2008
Identifying causal relations among simultaneously acquired signals is an important
problem in multivariate time series analysis. For linear stochastic systems Granger
proposed a simple procedure called the Granger causality to detect such relations. In
this work we consider nonlinear extensions of Granger’s idea and refer to the result
as Extended Granger Causality. A simple approach implementing the Extended
Granger Causality is presented and applied to multiple chaotic time series and other
types of nonlinear signals. In addition, for situations with three or more time series
we propose a conditional Extended Granger Causality measure that enables us to
determine whether the causal relation between two signals is direct or mediated by
another process.
Key words: Granger Causality, Extended Granger Causality, nonlinear time
series, vector autoregressive models, delay embedding reconstruction
Email addresses: (Yonghong Chen),
 (Govindan Rangarajan),
 (Jianfeng Feng), (Mingzhou Ding).
Introduction
Given the deluge of multi-channel data generated by experiments in both
science and engineering, the role of multivariate time series analysis, especially nonlinear time series processing, has become crucial in understanding
the patterns of interaction among diﬀerent elements of nonlinear systems. In
particular, identifying causal relations among signals is important in ﬁelds
ranging from physics to biology to economics. One approach to evaluating
causal relations between two time series is to examine if the prediction of
one series could be improved by incorporating information of the other. This
was originally proposed by Wiener and later formalized by Granger in the
context of linear regression models of stochastic processes . Speciﬁcally, if
the variance of the prediction error of the second time series at the present
time is reduced by inclusion of past measurements from the ﬁrst time series in
the linear regression model, then the ﬁrst time series is said to have a causal
inﬂuence on the second time series. The roles of the two time series can be
reversed to address the question of causal inﬂuence in the opposite direction.
From this deﬁnition it is clear that the ﬂow of time plays a vital role in making
direction related inference from time series data.
Since Granger causality was formulated for linear models, its direct application to nonlinear systems may or may not be appropriate, depending on the
speciﬁc problem. In some cases, the linear Granger causality is able to identify
the correct patterns of interaction for multiple nonlinear time series, but in
some other cases, as will be shown later in this paper, it fails to do so. We
deal with this issue by extending Granger’s idea to nonlinear problems. Our
starting point is the standard delay embedding reconstruction of the phase
space attractors. Clearly, a full description of a given attractor requires a
nonlinear set of equations. But, locally, one can approximate the dynamics
linearly. Applying Granger’s causality idea to each local neighborhood and
averaging the resulting statistical quantity over the entire attractor results in
Extended Granger Causality Index (EGCI). We examine the eﬀectiveness of
this idea on numerically generated nonlinear time series with known patterns
of interaction.
Works related to the identiﬁcation of interdependence in nonlinear systems
have appeared in the literature . Particularly relevant for the work
in this paper are works based on delay coordinate embedding reconstruction
of phase space. Along this direction a number of methods of detecting nonlinear interdependence or coupling based on nonlinear prediction theory have
appeared in the past few years . The basic ideas
in these papers are similar, all involving the use of the points in a neighborhood in the reconstructed space to predict future dynamical behavior. In
 , time indices of neighborhood points in the space X
reconstructed from one time series (x) are used to predict the dynamics in
space Y reconstructed from the second time series y. If this prediction is good
enough, then it implies a dependence from x to y. Similarly, the reverse dependence can be found. Diﬀerent authors deﬁne diﬀerent criteria to quantify the
goodness of the prediction, but the common assumption that nearby points
in one reconstructed space X map to nearby points in another reconstructed
space Y is adopted. These methods tend to detect strong interactions such
as synchronization, phase synchronization or generalized synchronization. In
order to detect weak interactions, a modiﬁcation was made by presenting
a mixed-state prediction method where a reconstruction of mixing two time
series was employed. It is important to note that all these nonlinear prediction
based methods employ the same kind of predictor (a zeroth order predictor)
which takes the mean or weighted mean as the prediction value. Since points
in a given neighborhood come both from the past and the future of the reference point this kind of prediction does not account properly for the ﬂow of
time. Our idea diﬀers from the previous methods in two main respects: (a)
an linear regression predictor is employed for each local neighborhood and (b)
as a consequence the ﬂow of time is explicitly incorporated in the predictor
which is an essential element of inferring causal relations in multiple time series . A nonlinear approach that shares a number of similarities with ours
has appeared in .
In this section we will ﬁrst review the basic idea of Granger Causality formulated for analyzing linear systems and then propose a generalization of
Granger’s idea to attractors reconstructed with delay coordinates.
Granger Causality: The method of detecting causal relations among multiple
linear time series is based on linear prediction theory. For a stationary time series x(t), consider the following AutoRegressive (AR) prediction of the current
value of x(t) based on m past measurements:
αjx(t −j) + εx(t).
Here εx(t) is the prediction error whose magnitude can be evaluated by its variance var(εx(t)). Suppose that simultaneously we have also acquired another
stationary time series y(t). Consider the following prediction of the current
value of x(t) based both on its own past values and the past values of y(t):
ajx(t −j) +
bjy(t −j) + εx|y(t).
If the prediction improves by incorporating the past values of y(t), that is,
var(εx|y(t)) < var(εx(t)) in some suitable sense, then we say that y(t) has a
causal inﬂuence on x(t). Similarly, we may consider
βjy(t −j) + εy(t),
cjx(t −j) +
djy(t −j) + εy|x(t).
and say that x(t) has a causal inﬂuence on y(t) if var(εy|x(t)) < var(εy(t)). We
note that Eqs. (2) and (4) together form the following Vector AutoRegressive
model (VAR):
ajx(t −j) +
bjy(t −j) + εx|y(t),
cjx(t −j) +
djy(t −j) + εy|x(t),
where standard techniques exist to estimate such models from time series data.
Extended Granger Causality: Consider two nonlinear time series x(t) and y(t).
The joint dynamics is reconstructed with the following delay vector 
z(t) = (x(t)T, y(t)T)T,
where x(t) = (x(t), x(t −τ1), · · ·, x(t −(m1 −1)τ1))T,
y(t) = (y(t), y(t −
τ2), · · ·, y(t −(m2 −1)τ2))T, mi is embedding dimension and τi is time delay
for i = 1, 2. Usually, the embedding dimensions and time delays for diﬀerent
series can be diﬀerent. However when we investigate Granger causality, the
time delays must be equal so that causal inferences can be made. Hereafter
we take τ1 = τ2 = τ.
In the delay embedding space, there exists a function f that maps a given
point z(t) to its observed image z(t + τ). Usually, this function has no known
analytical form but can be locally approximated by a linear map around some
reference point : z(t+τ) = Az(t)+r(t), where A is (m1+m2)×(m1+m2)
coeﬃcient matrix which can be determined by the least-squares technique and
r(t) is the error vector. Substituting Eq.(6) in the above relations, we get the
following equations:
· · · + Am
x(t −(m −1)τ)
y(t −(m −1)τ)
where Ai =
, εx|y and εy|x are the error terms, and we have
assumed m1 = m2 = m for simplicity. If m1 ̸= m2, some diagonal terms of Ai
would turn out to be zero.
We note that Eq. (7) is just another form of Eq. (5) for non-unit time step.
Therefore, in Eq. (7), εx|y(or εy|x) actually gives the prediction error of x (or
y) after incorporating y (or x). To proceed further, we also reconstruct each
series independently around the x and y parts of the same reference point
using linear regression approximations to obtain
x(t + τ) =
αjx[t + (j −1)τ] + εx,
y(t + τ) =
βjy[t + (j −1)τ] + εy.
We can now apply the ideas from Granger causality to these local linear systems. Thus, if the ratio of the errors var(εx|y)
var(εx) (or var(εy|x)
var(εy) ) is less than 1,
it implies y (or x) has causal inﬂuence on x (or y). So far, this procedure
only involves data in one local neighborhood around a given reference point.
Clearly, for nonlinear systems the coeﬃcient matrix in the linear approximation is a function of the local neighborhood. We repeat the process above for
a set of chosen neighborhoods scattered over the entire attractor and average
the error ratios from all the neighborhoods to obtain the Extended Granger
Causality. See below for a more formal formulation.
The idea above is actually very similar to other ideas of detecting directional
interdependence based on nonlinear mutual prediction .
The diﬀerence is that the previous work used the average or weighted average
value of the images of the points in a given neighbor as the basis for predic-
tion. Thus they suﬀer from the lacuna that points in the neighborhood of the
reference point have no explicit time relations to the reference point itself.
On the other hand, we employ a linear model which preserves explicit time
relations and are therefore able to derive unambiguous causality relationships.
Summarizing, we propose the following four-step procedure to evaluate causal
relations between two nonlinear time series:
(1) Reconstruct the attractor using the delay coordinate embedding technique [cf. Eq. (6)].
(2) Fit an autoregressive model for all the points in the neighborhood Θ of
a reference point z0 in the reconstructed space Rm1+m2, where Θ = {z :
|z −z0| ≤δ}.
(3) Perform the reconstruction and ﬁtting process on the individual x and y
time series in the same neighborhood and compute the error ratio deﬁned
earlier. Average the error ratio over a number of local neighborhoods in
order to sample the full attractor adequately. Compute the Extended
Granger Causality Index (EGCI) deﬁned as ∆y→x = ⟨1 −var(εx|y)
var(εx) ⟩,
where ⟨·⟩stands for averaging over the neighborhood sampling the entire
attractor.
(4) Compute EGCI as a function of the neighborhood size δ. For linear systems this index will stay roughly the same as δ becomes smaller. For
nonlinear systems this index, in the small δ limit, reveals the true nonlinear causal relation which may or may not be captured at the full attractor
level (i.e. taking δ to be the size of the whole attractor).
To reconstruct the attractor, the embedding dimension and time delay have
to be determined. Usually the embedding dimension is determined by the
false nearest neighbor technique and the time delay is obtained as the
ﬁrst minimum of the mutual information function . If the reconstructed
attractor is a ﬁxed point with some noise, then a criterion such as AIC for
linear stochastic processes can be used to determine the order of the model. A
diﬃcult issue for the present work is to determine the optimal neighborhood
size δ. The number of points in the neighborhood should be large enough
to establish good statistics. On the other hand, the size of the neighborhood
should be small enough so that linearization is valid. In step (4) above we seek
a compromise by examining the EGCI as a function of δ in the attempt to
get to the true nonlinear eﬀect when δ becomes small enough. We refer to this
step as a zooming-in procedure. For suﬃciently large dataset, the usual rule
is that, the smaller the neighborhood size, the better the nonlinear prediction
achieved .
Conditional Extended Granger Causality: The above analysis for two time series can be extended to more than two time series by analyzing them pairwise.
However, pairwise analysis of more than two time series cannot detect indirect
causal inﬂuences, an issue that has been addressed in linear time series analysis . For example, consider three time series A, B and C. Two possible
causal relations among them are shown in Figures 1(a) and (b). In Figure
1(a), the causal inﬂuence or driving from A to C is indirect and mediated by
B. In Figure 1(b), both direct and indirect inﬂuences exist. Pairwise analysis
would show an arrow from A to C and thus cannot separate these two cases.
We propose the following procedure for the case of three time series which,
as we show in the next section, is able to reveal the true patterns of causal
interactions.
Suppose sA(t), sB(t), sC(t) are the given three time series, we reconstruct vector z in whole space as :
z(t) = (sA(t)T, sB(t)T, sC(t)T)T,
where sA(t) = (sA(t), sA(t−τ), · · · , sA(t−(m1−1)τ))T, sB(t) = (sB(t), sB(t−
τ), · · · , sB(t−(m2−1)τ))T, sC(t)T = (sC(t), sC(t−τ), · · · , sC(t−(m3−1)τ))T.
Then the vector autoregression obtained from a local linear approximation is
sA(t + τ) =
11sA[t −(i −1)τ] +
12sB[t −(i −1)τ]
13sC[t −(i −1)τ] + εA|BC,
sB(t + τ) =
21sA[t −(i −1)τ] +
22sB[t −(i −1)τ]
23sC[t −(i −1)τ] + εB|AC,
sC(t + τ) =
31sA[t −(i −1)τ] +
32sB[t −(i −1)τ]
33sC[t −(i −1)τ] + εC|AB.
The term εC|AB is the prediction error of the series sC after incorporating
both sA and sB. If this prediction is no better than the prediction obtained
by incorporating only the series sB, it means sA has no direct causal inﬂuence
on sC. Therefore we can deﬁne a Conditional Extended Granger Causality
Index (CEGCI) as ∆A→C|B = ⟨1 −var(εC|AB)
var(εC|B) ⟩. This can be used to distinguish between direct and indirect causal relations. Conditional causality
indices between other time series pairs can be similarly deﬁned.
It is worth mentioning that for more than three time series, if the causality
between any two time series is indirect, then taking one additional series or
more than one additional series in the causality chain as the conditional one(s)
will not make the results any diﬀerent. Therefore analysis of three time series
is suﬃcient to detect the intrinsic causal inﬂuences in any multiple time series
Numerical Simulations and Discussion
In order to make the whole discussion concrete, we study some examples. The
number of reference points around the attractor is 100 for all the examples.
Example 1: Let’s consider two time series generated from unidirectionally coupled 2D maps. Two diﬀerent coupling schemes, one linear and one nonlinear,
are examined. The system with linear coupling is written as
x(n) = 3.4x(n −1)(1 −x2(n −1))e−x2(n−1) + 0.8x(n −2),
y(n) = 3.4y(n −1)(1 −y2(n −1))e−y2(n−1) + 0.5y(n −2) + cx(n −2),
and the system with nonlinear coupling is
x(n) = 3.4x(n −1)(1 −x2(n −1))e−x2(n−1) + 0.8x(n −2),
y(n) = 3.4y(n −1)(1 −y2(n −1))e−y2(n−1) + 0.5y(n −2) + cx2(n −2).
It is obvious that y is driven by x in both systems. In order to make the
simulations realistic, some system noise and measurement noise are added to
the time series. The attractor reconstructed from the x time series is given in
Figure 2(a). Figures 2(b) and 2(c) give the reconstructed attractors from the
y time series driven linearly and nonlinearly by x with the coupling strength
Both these cases are analyzed using our procedure in the previous section with
m = 2 and τ = 1. We obtain the EGCI as a function of the neighborhood size
δ in Figure 3. For both linear driving [Fig. 3(a)] and nonlinear driving [Fig.
3(b)], ∆y→x (shown as the thicker curve) is seen to be zero. Thus x is not
inﬂuenced by y as expected from the construction of our model. In Fig. 3(a),
∆x→y is non-zero starting from large neighborhood sizes δ and increases as δ
decreases. This implies that x has a causal inﬂuence on or drives y. Further,
since ∆x→y is non-zero even for large δ values, this means that even a linear
causality analysis would have detected the correct causal relations in this case.
On the other hand, in Figure 3(b) (for nonlinear driving), ∆x→y becomes nonzero only when δ is suﬃciently small. In this case, a linear causality analysis
would fail to detect the correct pattern of driving. This example illustrates
the importance of nonlinear causality analysis in such cases.
Example 2: We consider two time series generated by two coupled two-dimensional
ODEs where the ﬁxed point in the origin is stable:
˙x1 = −0.25x1 + x2 −x3
˙x2 = x1 −x2 −x1x2,
˙y1 = −0.25y1 + y2 −y3
˙y2 = y1 −y2 −y1y2.
Adding some system noise and measurement noise and taking x1 and y1 as
the acquired signals, we get two modiﬁed time series x and y. Clearly in this
case x series drives y series. Reconstructing the attractors from these two
time series with τ = 2, ﬁnding the neighborhood of every reference point
and ﬁtting a second order AR model (m = 2) in every neighborhood, we
obtain the Extended Granger Causality Index (EGCI) as a function of the
neighborhood size δ for diﬀerent coupling strengths as shown in Figure 4(a).
We make three observations. First, ∆y→x ≈0, whereas ∆x→y is non-zero,
clearly demonstrating that the x series drives the y series but not vice-versa.
Second, the level of EGCI is proportional to the coupling strength. Third,
since the processes here are linear, the EGCI is not a function of δ.
Example 3: Next we look at an ODE system exhibiting chaotic behaviors. The
following two coupled R¨ossler oscillators are considered:
˙x1 = −(y1 + z1),
˙y1 = x1 + 0.2y1,
˙z1 = 0.2 + z1(x1 −4.7).
˙x2 = −(y2 + z2) + cx1,
˙y2 = x2 + 0.2y2,
˙z2 = 0.2 + z2(x2 −4.7).
As done earlier, some system noise and measurement noise are added to the
two time series x1 and x2 to obtain x and y time series. Reconstructing the
attractors with m = 3 and τ = 2 and ﬁtting linear models in every local
neighborhood, we obtain EGCI shown in Figure 4(b). It is seen that x has
a causal inﬂuence on y as expected. Besides, ∆x→y is non-zero even for large
neighborhood sizes. Thus, a linear causality analysis would detect the correct
causal relations in this strongly nonlinear system.
Example 4: To show how to distinguish the pattern of interaction shown in
Figure 1(b) from that shown in Figure 1(a), let us consider three time series.
Both linear systems and nonlinear systems are considered.
For a linear stochastic system the following three coupled AR(1) models are
considered:
x(n) = 0.2x(n −1) + ε1,
y(n) = 0.5y(n −1) + 0.5x(n −1) + ε2,
z(n) = 0.4z(n −1) + 0.3y(n −1) + cx(n −1) + ε3.
For chaotic time series, the following three coupled 1-d maps are considered:
x(n) = 3.4x(n −1)(1 −x2(n −1))e−x2(n−1),
y(n) = 3.4y(n −1)(1 −y2(n −1))e−y2(n−1) + 0.5x(n −1),
z(n) = 3.4z(n −1)(1 −z2(n −1))e−z2(n−1) + 0.3y(n −1) + cx(n −1).
Here x, y and z correspond to A, B and C in Figure 1. In addition, c = 0
simulates the indirect causality case (Fig. 1(a)) and c = 0.5 simulates the
direct causality case (Fig. 1(b)).
Numerical results for the linear case are shown in Figure 5 and results for the
chaotic time series are shown in Figure 6. Figures 5(a) and 6(a) display results
obtained using pairwise analysis. Similar plots are obtained for both c = 0 and
c = 0.5. As we can see, based on just pairwise analysis, one would conclude
that Figure 1(b) is the pattern of interaction for both c = 0 and c = 0.5.
That is, the direct and indirect causal relationships cannot be separated by
pairwise analysis alone. Figures 5(b) and 6(b) give the results obtained by
simultaneously analyzing all three time series using conditional EGCI. In this
case, for c = 0 we obtain ∆x→z|y ≈0 (solid curve) indicating that no direct
causal relation exists between x and z. Thus the correct causality graph [Figure
1(a)] is obtained. On the other hand, for c = 0.5, ∆x→z|y is non-zero (dotted
curve) indicating direct causality between x and z and the causality graph
shown in Figure 1(b) is obtained.
Conclusions
We have extended the Granger causality theory to nonlinear time series by
incorporating the embedding reconstruction technique for multivariate time
series. A four-step algorithm was presented and used to analyze various linear
and nonlinear coupled systems. The following conclusions were found:
(1) Linear Granger causality analysis may or may not work for nonlinear time
series. On the other hand, our method of applying the Extended Granger
Causality Index to nonlinear time series always gives reliable results.
(2) When three or more time series have to be analyzed, the Conditional
Extended Granger Causality Index proposed here can distinguish between
direct and indirect causal relationships between any two of the time series.
This is not possible using simple pairwise analysis.
As with other methods for analyzing nonlinear time series, the amount of data
required for reliable analysis can be large. Possible improvements along this
direction are being studied.
Acknowledgments
The work was supported by ONR, NSF and NIMH. GR is also supported by
DRDO, India and the Homi Bhabha Fellowship.