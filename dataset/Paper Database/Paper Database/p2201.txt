Full Terms & Conditions of access and use can be found at
 
The London, Edinburgh, and Dublin Philosophical
Magazine and Journal of Science
ISSN: 1941-5982 (Print) 1941-5990 (Online) Journal homepage: 
LIII. On lines and planes of closest fit to systems of
points in space
Karl Pearson F.R.S.
To cite this article: Karl Pearson F.R.S. LIII. On lines and planes of closest fit to systems
of points in space , The London, Edinburgh, and Dublin Philosophical Magazine and Journal of
Science, 2:11, 559-572, DOI: 10.1080/14786440109462720
To link to this article: 
Published online: 08 Jun 2010.
Submit your article to this journal
Article views: 1232
View related articles
Citing articles: 2761 View citing articles
LIII. On Lines and lJlanes of Closest Fit to S.qstems of ]Points
By KARL P~,ARSOS, F.R.S., University College,
(1) -]IN many physical, statistical, and biological investi-
gations it is desirable to represent a system of
points in phme, three, or higher dhnensioned space by the
" best-fits
straight line or plane.
Analytically this
consists in taking
Z=ao+alx+b,y ,
z = a o + a~xl + a2x 2 + aaxa +
9 + at, xn,
where y, x, z, xl, x,~,.., x~ are variables, and determining the
"best" values for the constants a0, a,, bl, a0, al, a2, as,
in relation to the observed corresponding values of the
variables.
]n nearly all the cases dealt with in the text-books
of least squares, the variables on the right of our equations
are treated as the independent, those on the left as the de-
pendent variables.
The result of this treatment is that we
get one straight line or plane if we treat some one variable as
independent, and a quite different one if we treat another
variable as the independent variable.
There is no paradox
about this ; it is, in ihct, an easily understood and most im-
portant feature of the theory of a system of correlated
variables.
The most probable value of y for a given value
of x, say, is not given by the s~me relation as the most pro-
bable value of x tbr a given value of y. Or, to take a concrete
example, the most probable stature of a man with a given
length of leg I being s, the most probable length of leg for a
man of stature s will not be I.
The "best-fitting" lines and
planes for the cases of z up to n variables for a correlated
system are given in my memoir on regression t.
depend upon a determination of the means~ standard-devia-
tions, and correlation-coefficients of the system.
cases the values of the independent variables are supposed to
be accurately known, and the probable value of the dependent
variable is a~certained.
(2) In many cases of physics and biology, however, the
" independent" variable is subject to just as much deviation
or error as the ~' dependent" variable.
We do not, for
example, know x accurately and then proceed to find y, but
both x and y are found by experiment or observation.
observe x and y and seek tbr a unique functional relation
between them.
Men of given stature may have a variety
9 Communicated by the Author.
t Phil. Trans. re1. clxxxvii. A, pp. 301 et ~e~[.
Prof. K. Pearson ot~ Liltes and Planes of
of leg-lengths; but a point at a given time will have
one position only, although our observations of both time
and position may be in error, and vary t'roul experiinent to
experim0nt.
In the case we are about to deal with, we sup-
pose the observed variables--all subject to error--to be plotted
in plane, three-dimensioned or higher space, and we endeavour
to take a line (or plane) which ~vill be the "best fit" to such
a svsteln of points.
Of course the term " best fit" is really arbitrary; but a
good fit will clearly be obtained if we make the sum of the
squares of the perpendiculars fl'om the system of points upon
the line or plane a minimum.
For example :--Let P1, P~,.-
9 P, be the system of points
with coordinates xl, yj ; x2, ,Y2 ;.
9 x, y~, and perpendicular
distances pl, 192,... p, from a line A B.
Then we shall make
U=S(p ~) =a minimum.
If y were the dependent variable, we should have made
S (y'--y) ~ = a minimum
(y' being the ordinate of the theoretical line at the point
x which corresponds to y), had we wanted to determine the
best-fitting line in the usual manner.
Now clearly U=S(p ~) is the moment of momentum, the
second moment of the system of points, supposed equally
loaded, about the line AB.
But the second moment of a
system about a series of parallel lines is always least for the
Closest Tit to Systems of Points in STaee.
line going through the centroid.
Hence: The best-fittlng
straight line for a S~lStem of points in a space of any order goes
th~'ough the cent~'oid of t],e system.
Now let there be n points each fixed by q variables
x b Xz... Xq, and let
~,=S(.,)/n,
:r~=S(.,)/n...
~q=S(.q)/~.
fix the eenfroid, or the mean values of the variables ;
~.,=S(.,")/n-:~,~,
~'~.. = S(*:~)/n-- ~,...
~%q-=S(xq~)/n--~ ~-,
fix the sta'ndard-deviations (errors of mean square), or in-
directly the moments of inertia or second-mom~mts about the
axes of coordinates, through the ceutroid parallel to the axes
of the variables xl, x~...Xq.
And, las|ly, let
S(x~x,) --,,J,,x~
t~ O-Xu~,Tv
for all pairs of values of u and v from 1, 2, 3 .... 7, fix the
correlations of the variables, or indirectly the products of
inertia or product-moments about the axes.
Now let Ii, 1.2, l a. . . lq be the generalized direction-cosines
of a plane at perpendicular distance p from the origin.
shall have
ll~+l:2+la2+...+/q:=l .
Further, if U be the stun of the squares of the i)erpendicular
distances of the system of n points from the plane
t,., + l~.~ + t~., +... + lq.q=p, . . . .
we require to make a minimum of
U = S (llx 1 + 12x2 + lax3 +.
9 + lqx~--p)~, .
by variation of Ii, 12,... lq, p subject to (iv.).
Differentiate
first with regard to p and we have
/,S(x,) +/2S(x2) +/.~S (x3) +... + lqS(xq) --np=0;
p= l~2et + l~ +... + lq~, . . . .
which shows us from (v.) that : the best-fitting plane passes
through the centroid of tl, e system.
Now vary (vi.) and add to it Q times the variation of (iv.),
Q being an undetermined multiplier.
We hav% by equating
to zero the coefl3cient of dl,,
l,S(x,x,,) + l~S(x,.~,u) +... + l,S(x, ~) +... + ZqS(xq,,,,)
-pS(x,) + Qt, = 0.
Prof. K. Pearson on Lines and Planes of
Or, substituting for p from (vii.) and using (it.) and (iii.) :
lvrx~ ~x~rx~x. + l~ax,Fxurx.~x ~ +...luO-x, 2 +... + ~qO'xqXx.rXuXq
is the type equation.
Now (vi.) may be written :--
9 + 21q-tlqaxq-laxqrx,l-lxq}
(viii.) bis
Multiplying each type equation by its corresponding l,,
adding together and remembering (iv.), we find
U_~m+ Q-=0,
where Um is the minimmn value of U.
:Now let Z~ be the mean square oi" the residuals, or
E~__ S(llx~ + l~x 2 +... + lqxq--p) "~
and a physical meaning has been given to Q, ~/-Q/n is the
"mean square residual,"--/, e., the quantity, the square of
which is the mean square of the residuals.
The type equation (viii.) may now be written :
I la~x.r~`x. + 12ax~a~,r~,~ +... + l, (~, -- X 2)
+ lqo'xqO'xurxqxu = 0..
We can eliminate the l's and dividing out row and column
of resulting determinant by the corresponding a, we have:
~ Z2,T' 3 ,
as a determiuantal equation to find Z 2.
We must choose the
least root of this equation, for the mean square residual must
Closest Fit to Systems of Points in Space.
be as small as possible.
Substitute this value of' ~
type equations (viii.), and we find the required values of
9 lq, using (iv.).
This is the complete analytical solution of the problem of
drawi~,g the best-fitting plane through n non-eoplanar points.
We see that it depends only on a knowledge of the means,
standard-deviations, and correlations of the q variables.
Whenever we may suppose that variation is due to errors of
observation or measurement,--/, c., is not organic, but there
exists a unique functional relation between the true values
of the variables,--then, assuming it of the first degree, we may
determine the best values of the constants in the manner given
(3) A geometric.d interpretation is of course to be found
from (viii.) bis.
Consider the quadric
O'2XlXl 2 -4- O'2~a222 --~... "4- q22~Xq 2 "~- 2a'xlo'xzrxli~,~lX ~
9 .~_ 2axq_lO.xq,rXq_lXq;Sq_lXq
where e is any line.
Then this quadric will be " ellipsoidal "
since the coefficients of xl 2 ... Xq "2 are all positive quantities.
Let R be its radius-vector measured in the direction Ii, 12 .... lq,
or perpendicular to the plane from which we are measuring
the residuals ; then clearly:
U=nci/R 2,
Ex=e4/R ~ . . . . . . .
Thus the inverse square of the radius of this "ellipsoid"
measures the square of the mean square residual.
speak of the ellipsoid as the ellipsoid of residuals.
Since Z is
to be a minimum, R must be a maximum ; or we conclude :
that the best-fitting plane is perpendicular to the greatest axis
of the ellipsoid of residuals and the minimum mean square
residual varies inversely as the length of this axis.
A case of failure can only arise if the ellipsoid of residuals
degenerates into an " oblate spheroid," i.e., when every plane
through its shorter axis is one of " best fit," or into a sphere,
when every plane through the centroid of the system of points
is an equally good fit.
This sphericity of distribution of
points in space involves the vanishing of all the correlations
between the variables and the equality of all their standard-
deviations.
It.corresponds to isotropic inertia in the theory
of moments in dynamics.
(4) The theory of the best-fitting straight line need not
Prof. K. Pearson on Lines and Planes of
detain us long.
Let its equation be
x,--xl' _ x2--x2' _ x3--x~'
Draw the plane perpendicular to this line through xt', x~',
a,~t; i. e,~
llxl + l~.~': + 18xs +.
9 + lq~:q = H,
where H = llxl' + l~x~' + l~x3' +..
9 + lq.vq'.
Then if p be the perpendicular from any point in space on
the line (xiii.):
t, ~ = (x~- x~') ~ + (x2- x2') ~ +... + (xq-xq')2
-- { li (xl--xt') + l~ ( x.a--.v~') + la (xa-- Xa t) +... + lq(xq--xq') } ~.
Now xl', x2'... Xq' and l,, 12... lq, subject to the rel~ltion
l~ + l~ z + l~Z +... + lq*-- 1, are the constants at our disposal.
Sump * and differentiate to find when U=S(2r ) is a minimmn.
We have for type equation
S(xu-xu t)-lu[S{ll(xi -xt r + l~(x: --x2') +... + lq(xq--Xq') }] = 0,
whence we see:
S(,~)-,,.~,,'
= symmetrical thnction of x's.
Or, we must have
5;l--Xl' __ X2--X2 t
~.q--dCq t
which show us that the strMght line passes (as we have already
noted) through the centroid of the system.
We can accord-
ingly take xl',xJ..
9 Xq" to be that eentroid~ and we find :
X,~= U = S(p~) =o~, +02,.~+... +~r~
But the expression in square brackets is precisely the square
of the mean square residual with regard to the plane~
1,(x,- &) + ~(,~- a,,) +... + ~q (x~- ~) = 0,
Thus we have :
Now clearly d~x+q~x+...+q'~xq
is a constant.
X ~ will be a minimum when s is a maximum, or when the
Closest .Fit to Systems oJ Points in Space.
plane perpendicular to the best-fitting line is perpendicular
to the least axis of the ellipsoid of residuals.
Thus we find :
That the line which fits best a system of n points in q-fold space
passes throuflh the centroid of the system and coincides in
direction with the least axis of the ellipsoid of residuals.
The mean square residual (which measures of course the
closeness of the fit) is given by
+... + ~2 _ ~2,
where R is the least radius of the ellipsoid of residuals.
The direction-cosines of the line can be found from (ix.) by
giving ~2 the least value among the roots of (x.).
Clearly the plane of best fit passes through the line of best
fit, and is further perpendicular to the greatest radius, the
maximmn axis of the ellipsoid of residuals.
(5) While the geometry of lines and planes of best fit is
thus seen to be very simple from the standpoint of inertia
ellipsoids,--particularly from the consideration of the surface
which, for the theory of errors, I have termed the ellipsoid of
residuals,--they most frequently occur, perhaps, in the case
of correlated variations or errors, and it is thus of interest to
consider them in relation to the ellipses and ellipsoids which
arise as " contours '" in correlation surfaces.
Now take the case of two variables x and y only, the
type-ellipse of the contours of the correlation surface is~
when referred to its centroid as origin :
Compare this with the ellipse of residuals
a~x xt~ _{. aug yt~ + 2o'x ~ry rxy Xty t: e 4.
Clearly if we take xt-'y, yr= -x, and ea~O'~xa~y the ellipse of
residuals becomes the correlation type-ellipse.
.~t~ +y,~_x~ +y~, or the two ellipses have equal rays, but they
are at right-angles to each other.
Thus the best-fitiing
straight line for the system of points coincides in direction
with the major axis of the correlation ellipse, and the mean
square residual for this line
product of standard deviations
semi-major axis of correlation ellipse
.Phil, Mag. S. 6. Vol..2. ~o. 11. Nov. 1901.
Prof. K. Pearson on Lines and Planes 07
The geometry of these results is indicated in the accompanying
diagram :--
EE' is found by making S(y'--y) ~ a minimum,
S(,~"-x) ~
The equation to EE' referred to C is y= rxYo'Yx,
The angle 8 wkich AA' makes with Ox is determined by
tan 28= 2rxy ~:: a.v
(Mean sq. resldual)~=a~= ~"y/cot~ 8
+ ~'y) - ~ V (~.- ~y)~ + 4~
,,~. o-'~,.
....................
Physically the axes of the correlation type-ellipse are the
directions of independent or uncorrelated variation.
the line of best fit is a direction of uncorrelated variation.
Closest Fit to Systems of Pdnts in Space.
We turn to the correlation type-" ellipsoid" for q
9 It is* :
]1 q~xxl + A:s
9 taqq qSXq T
-{- ......
O'~vq_lO'~ q
where A11 , A22 ~ A1~... hq_lq , Aqq are the minors correspond-
ing to the constituents marked by the same subscripts of the
determinant :
rps ...... r:g
Now let us find the directions and magnitudes of the
principal axes of this ellipsoid
9 We must make
u g- xl 2 4- x2 ~ +
a maximum.
Or if Q be an indeterminate multiplier, we
(Au+Qa~x,) x._s +A1 x~ +A~a xs + ... +Alq x--~q----0,
Alq~+Apq~+A3q:;
3 +...+ (Aqq+Qr162162
----0(xvii.)
Multiply the last q--1 of these equations by rn, r13~.., rlq
respectively and add them to the first, then we know that :
AltTrl~ A12+r13 513-1-
9 +rlqAlg --_A~
and ifubenot 1:
Alu + rl~ " A:u + r13 Aau + . . . + rlq Aq~ ~ O.
+ Phil. Trans. vol. clxxxvii. A, p. 302.
Prof. K. Pearson on Lines and _Planes of
ax 2 + riaQ~
xa +"" + rlqQa~xq ~7 = o,
which may be written :
Or system (xvii.) may be replaced by :
rl~xlax~ax~ Jr x~a2x~ 1-- _T-| Jr r~xa~x3(rx~ +
9 jr r2qxqqxqo'x 2 = 0,
rlqXlaXqO'x 1 jr r~x2o'x2qx q Jr r~qxaa~aax jr
+ x~2q~x (1 --
9 (xviii.)
For multiplying (xvii.) by xl, x~,.., xq respectively and
adding, we find
or if R be a maximum or minimum value of u, Q-- -1/R 2.
~Tow-compare these equations with those we obtain tbr the
directions and magnitudes of axes of the ellipsoid of residuals:
a~xlXt t~ "k a~x2X~ I~ Jr
9 jr ~xqXq
t~ -I- 2rt2o'xl o'x2xlt x~ ! +
-{- 2r~l--lqaxq--laxqXlq--lx~
= e 4 . (xix.)
These are :
) "~ r12x~tqx2O'x~ +
+ rlqXqt~rXqqXt
, t O-xqO-xa_O~-
9 Jr ruqxq
rl2ZltO'x~rx2
Jr 22t~r~xa\l
rlq21/(~xlff.vq § r, qx2tqxaqxq Jr . . . +Xq'a'x,(1-- R~)=0
Now eliminate the x's from (xviii.)and the xt's from (xx.)
and we have precisely the same determinant to find
Closest Fit to S//stems of Poi~ts in Space.
AR t and e~/R '~.
Hence for the semi&xes or max.-min.
Equations (xviii.] and (xx.) will now give the same values for
the ratios of the x's and of the x's, or for any axis :
xl/xl'=x2/x:
But (xxii.) combined with (xxi.) gives us :
x,= ~--SR,~,
x2= v'~R*'
.... z~= V,-AR,~
Ill other words, if we define points given by (xxiii.) to be
corresponding points,--/, e., if corresponding points lie on the
same line at distances inversely as each other from the origins--
then the ends of the principal axes of the two ellipsoids ~re
corresponding points.- Thus the principal axes of the correld-
tion ellipsoid coincide with those of the ellipsoid of re'siduals
in direction, and a minimum axis of the one is a maximum
axis of the other and vice versa.
We therefore conclude :
(i.) That the best fitting plane to a system of points is
perpendicular to the least axis of the correlation ellipsoid, and
that if 2 Rmin. be th~ length of this axis the mean square
residual = v'~ x R rain. where A is the well-known deter-
minant of the correlation coefficients.
(ii.) The best-fitting straight line to a system of points
coincides in direction with the maximum axis of the correla-
tion ellipsoid, and the mean square residual
~. R~max.,
= V I ~r x~ Jr ~r x 2 + r x a + . . . + a~xq--
where 2 R m~x. is the length of the maximum axis.
We have thus the properties of the best-fitting plane and
line in terms of the correlation ellipsoid, which is the one
generally adopted for variation problems. At the same time
our investigation shows us that the q directions of independent
variation and the standard-deviations of the independent
variables may be found from the ellipsoid of residuals~ which
will usually be a process involving much simpler arithmetic.
(7) Numerical
Illustrations.
Case (i.). Find the best fitting straight line to the following
system of points supposed of eclual weight :
Prof. K. Pearson on Lines and _Planes of
We have at once :
ae= 2"3'748
o'y"- 1"31225
rxy= --'9765
tan 20---- 2rxy~x~y/(~x ~- ~y~) = -- 1"5535.
tansy--'54556,
or the best-fitting line passes
through the poi,,t:3"82, 3"70 at a slope of -'546.
is ~hown in the accompanying diagram by AB.
square residual is "2484. Had we made S(y--y')2a minimam,
the slope of the "best-fitting" line would have been --'5396
and the mean square residual "2828 ; had we made S(x--x') ~
a minimum, the slope of the " best-fitting" line would have
been --'5659, and the mean square residual
lines are of course the regression lines of slopes rxyay/crx and
a#/(rxyax) to the horizontal and mean square vertical and
horizontal residuals of ~ry ~/1--r ~ and ax ~/1--r~respectively
lllustrotlon (2).--The following system gives four values
of a certain function z :
Closest Fit to Systems of Points in Space.
Let us find the best-fitting plane, treating these as four
points in three-dimensioned space.
We have at once
erz-= 50"0275
rzy~y~= 182"5~ rxzo'x~z= --30"5,
r~(r~y----O.
Thus the ellipsoid of residuals is:
x ~ + 25y ~ + 2502" 75z ~ + 365gz -- 61x: = e 4.
The equations to find the direction-cosines are :
(2+ 2?)lx + 0. l~--61 .l~=O,
-6111+3651,+(5oo5.5+2Q)13=o.
Whence writing 2 ~ =X (n=number of points=4) the cubic
C=X 3 + 5057'5Z 2 + 123,440 X + 48~050 =0.
We want the least root:
x=O, C=+; X=--'5, C=--; X=-100, C= +; X=-~,
Thus the required root lies between 0 and --'5.
It is easily found to be
Xj= -'395,660.
Thus -- -Q ='197830, and the mean square residual
We easily deduce :
38"02187 ---
Thus the best-fitting plane is:
38'02187 (x--3) --7"35823 (y--21) +z--209"5=0,
z+38"02187x- 7"35823y--169"03778=0.. (xxv.)
If we find the values for z for given x and y, say those of the
four points, which are
211"7, 135"7, 283"3, 207"3,
we should not be impressed by the goodness of the "fit. But
On Lines and Plane.~ of Closest .~Tt.
the small value of the mean square residual shows how close
to each of the points the plane really goes when we measure
its distance from a point not by the vertical intercept, but by
the perpendicular from the point on the plane.
vertical distance fi'om x=4, y----16, z=]27, to the plane is
8"7, but the perpendicular distance is only "1988.
If X~ and Xa be the other two roots of the cubic C we easily
X~Xa =1"21,44 2" 65,
X~+Xa= --5057"1043~.
Thus we have the quadratic to find X~ and X~
X ~ + 5057"10434 X + 121,442"65-- 0,
X~=--24"12895, X3= 45032"97445.
%~ gives the least axis of the ellipsoid of residuals ; hence the
direction-cosines of this axis are given by
--'0127125
---- '0737249 -- 1"
We have accordingly for the equation of the best-fitting
straight line to the four points :
#--~1 _ z-209"5
- 12"125 - 75"249
The mean square residual for this line Z I is given by (xiv.)
V';~521J'75-- 2516"487225
This again is remarkably small, considering how far our
four points are from being co-linear.
The reader will easily prove directly that the best line
(xxvi.) really lies in the best plane (xxv.).
These two illustrations may suffice to show that the methods
of this paper can be easily applied to numerical problems;
the labour is not largely increased if we have a considerable
number of points.
It becomes more cumbersome if we have
four~ five, or more variables or characters which involve the
determination of the least (or greatest) root (as the case may
be) or an equation of the fourth, fil~h~ or higher order.
Still~ the coefficients being numerical and all the roots real
and negative, it is not very difficult to localize them.