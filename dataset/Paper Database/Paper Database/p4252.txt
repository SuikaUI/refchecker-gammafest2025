Incorporating Copying Mechanism in Sequence-to-Sequence Learning
Jiatao Guâ€ 
Zhengdong Luâ€¡
Victor O.K. Liâ€ 
â€ Department of Electrical and Electronic Engineering, The University of Hong Kong
{jiataogu, vli}@eee.hku.hk
â€¡Huawei Noahâ€™s Ark Lab, Hong Kong
{lu.zhengdong, hangli.hl}@huawei.com
We address an important problem in
sequence-to-sequence (Seq2Seq) learning
referred to as copying, in which certain segments in the input sequence are
selectively replicated in the output sequence.
A similar phenomenon is observable in human language communication.
For example, humans tend to repeat entity names or even long phrases
in conversation.
The challenge with regard to copying in Seq2Seq is that new
machinery is needed to decide when to
perform the operation. In this paper, we
incorporate copying into neural networkbased Seq2Seq learning and propose a new
model called COPYNET with encoderdecoder structure. COPYNET can nicely
integrate the regular way of word generation in the decoder with the new copying mechanism which can choose subsequences in the input sequence and put
them at proper places in the output sequence. Our empirical study on both synthetic data sets and real world data sets
demonstrates the efï¬cacy of COPYNET.
For example, COPYNET can outperform
regular RNN-based model with remarkable margins on text summarization tasks.
Introduction
network-based
sequence-tosequence learning (Seq2Seq) has achieved remarkable success in various natural language processing (NLP) tasks, including but not limited to
Machine Translation , Syntactic Parsing , Text Summarization 
and Dialogue Systems .
Seq2Seq is essentially an encoder-decoder model,
in which the encoder ï¬rst transform the input sequence to a certain representation which can then
transform the representation into the output sequence. Adding the attention mechanism to Seq2Seq, ï¬rst proposed
for automatic alignment in machine translation,
has led to signiï¬cant improvement on the performance of various tasks . Different from the canonical encoderdecoder architecture, the attention-based Seq2Seq
model revisits the input sequence in its raw form
(array of word representations) and dynamically
fetches the relevant piece of information based
mostly on the feedback from the generation of the
output sequence.
In this paper, we explore another mechanism
important to the human language communication,
called the â€œcopying mechanismâ€.
Basically, it
refers to the mechanism that locates a certain segment of the input sentence and puts the segment
into the output sequence.
For example, in the
following two dialogue turns we observe different patterns in which some subsequences (colored
blue) in the response (R) are copied from the input
utterance (I):
Hello Jack, my name is Chandralekha.
R: Nice to meet you, Chandralekha.
This new guy doesnâ€™t perform exactly
as we expected.
R: What do you mean by "doesnâ€™t perform
exactly as we expected"?
Both the canonical encoder-decoder and its
variants with attention mechanism rely heavily
on the representation of â€œmeaningâ€, which might
not be sufï¬ciently inaccurate in cases in which
the system needs to refer to sub-sequences of input like entity names or dates.
In contrast, the
 
copying mechanism is closer to the rote memorization in language processing of human being,
deserving a different modeling strategy in neural
network-based models. We argue that it will beneï¬t many Seq2Seq tasks to have an elegant uniï¬ed
model that can accommodate both understanding
and rote memorization. Towards this goal, we propose COPYNET, which is not only capable of the
regular generation of words but also the operation
of copying appropriate segments of the input sequence. Despite the seemingly â€œhardâ€ operation
of copying, COPYNET can be trained in an end-toend fashion. Our empirical study on both synthetic
datasets and real world datasets demonstrates the
efï¬cacy of COPYNET.
Background: Neural Models for
Sequence-to-sequence Learning
Seq2Seq Learning can be expressed in a probabilistic view as maximizing the likelihood )
of observing the output (target) sequence given an
input (source) sequence.
RNN Encoder-Decoder
RNN-based Encoder-Decoder is successfully applied to real world Seq2Seq tasks, ï¬rst by Cho et
al. and Sutskever et al. , and then
by .
In the Encoder-Decoder framework, the source sequence X = [x1, ..., xTS] is converted into a ï¬xed
length vector c by the encoder RNN, i.e.
ht = f(xt, htâˆ’1);
c = Ï†({h1, ..., hTS})
where {ht} are the RNN states, c is the so-called
context vector, f is the dynamics function, and Ï†
summarizes the hidden states, e.g. choosing the
last state hTS. In practice it is found that gated
RNN alternatives such as LSTM or GRU often perform much better than vanilla ones.
The decoder RNN is to unfold the context vector c into the target sequence, through the following dynamics and prediction model:
st = f(ytâˆ’1, stâˆ’1, c)
p(yt|y<t, X) = g(ytâˆ’1, st, c)
where st is the RNN state at time t, yt is the predicted target symbol at t (through function g(Â·))
with y<t denoting the history {y1, ..., ytâˆ’1}. The
prediction model is typically a classiï¬er over the
vocabulary with, say, 30,000 words.
The Attention Mechanism
The attention mechanism was ï¬rst introduced to
Seq2Seq to release the
burden of summarizing the entire source into a
ï¬xed-length vector as context. Instead, the attention uses a dynamically changing context ct in the
decoding process. A natural option (or rather â€œsoft
attentionâ€) is to represent ct as the weighted sum
of the source hidden states, i.e.
eÎ·(stâˆ’1,hÏ„)
Ï„ â€² eÎ·(stâˆ’1,hÏ„â€²)
where Î· is the function that shows the correspondence strength for attention, approximated usually
with a multi-layer neural network (DNN). Note
that in the source sentence is encoded with a Bi-directional RNN, making each hidden state hÏ„ aware of the contextual
information from both ends.
From a cognitive perspective, the copying mechanism is related to rote memorization, requiring
less understanding but ensuring high literal ï¬delity. From a modeling perspective, the copying
operations are more rigid and symbolic, making
it more difï¬cult than soft attention mechanism to
integrate into a fully differentiable neural model.
In this section, we present COPYNET, a differentiable Seq2Seq model with â€œcopying mechanismâ€,
which can be trained in an end-to-end fashion with
just gradient descent.
Model Overview
As illustrated in Figure 1, COPYNET is still an
encoder-decoder (in a slightly generalized sense).
The source sequence is transformed by Encoder
into representation, which is then read by Decoder
to generate the target sequence.
Same as in , a
bi-directional RNN is used to transform the source
sequence into a series of hidden states with equal
length, with each hidden state ht corresponding to
word xt. This new representation of the source,
{h1, ..., hTS}, is considered to be a short-term
memory (referred to as M in the remainder of the
paper), which will later be accessed in multiple
ways in generating the target sequence (decoding).
hello , my name is Tony Jebara .
Attentive Read
hi , Tony Jebara
<eos> hi , Tony
for â€œTonyâ€
Selective Read
for â€œTonyâ€
(a) Attention-based Encoder-Decoder (RNNSearch)
(c) State Update
Vocabulary
Prob(â€œJebaraâ€) = Prob(â€œJebaraâ€, g) + Prob(â€œJebaraâ€, c)
(b) Generate-Mode & Copy-Mode
Figure 1: The overall diagram of COPYNET. For simplicity, we omit some links for prediction (see
Sections 3.2 for more details).
An RNN that reads M and predicts
the target sequence. It is similar with the canonical RNN-decoder in , with
however the following important differences
â€¢ Prediction: COPYNET predicts words based
on a mixed probabilistic model of two modes,
namely the generate-mode and the copymode, where the latter picks words from the
source sequence (see Section 3.2);
â€¢ State Update: the predicted word at time tâˆ’1
is used in updating the state at t, but COPY-
NET uses not only its word-embedding but
also its corresponding location-speciï¬c hidden state in M (if any) (see Section 3.3 for
more details);
â€¢ Reading M: in addition to the attentive read
to M, COPYNET also hasâ€œselective readâ€
to M, which leads to a powerful hybrid of
content-based addressing and location-based
addressing (see both Sections 3.3 and 3.4 for
more discussion).
Prediction with Copying and Generation
We assume a vocabulary V = {v1, ..., vN}, and
use UNK for any out-of-vocabulary (OOV) word.
In addition, we have another set of words X, for
all the unique words in source sequence X =
{x1, ..., xTS}.
Since X may contain words not
in V, copying sub-sequence in X enables COPY-
NET to output some OOV words. In a nutshell,
the instance-speciï¬c vocabulary for source X is
V âˆªUNK âˆªX.
Given the decoder RNN state st at time t together with M, the probability of generating any
target word yt, is given by the â€œmixtureâ€ of probabilities as follows
p(yt|st, ytâˆ’1, ct, M) = p(yt, g|st, ytâˆ’1, ct, M)
+ p(yt, c|st, ytâˆ’1, ct, M)
where g stands for the generate-mode, and c the
copy mode. The probability of the two modes are
given respectively by
p(yt, g|Â·)=
Z eÏˆg(yt),
Z eÏˆg(UNK)
p(yt, c|Â·)=
j:xj=yt eÏˆc(xj),
where Ïˆg(Â·) and Ïˆc(Â·) are score functions for
generate-mode and copy-mode, respectively, and
Z is the normalization term shared by the two
modes, Z = P
vâˆˆVâˆª{UNK} eÏˆg(v) + P
xâˆˆX eÏˆc(x).
Due to the shared normalization term, the two
modes are basically competing through a softmax
function (see Figure 1 for an illustration with example), rendering Eq.(4) different from the canonical deï¬nition of the mixture model . This is also pictorially illustrated in Figure 2. The score of each mode is calculated:
( exp ğœ“- ğ‘£/
exp ğœ“6 ğ‘¥8 | ğ‘¥8= ğ‘¦4
| ğ‘¥8 = ğ‘¦4,ğ‘£/ = ğ‘¦4
( exp [ğœ“- unk ]
*Z is the normalization term.
Figure 2: The illustration of the decoding probability p(yt|Â·) as a 4-class classiï¬er.
Generate-Mode:
The same scoring function as
in the generic RNN encoder-decoder is used, i.e.
Ïˆg(yt = vi) = vâŠ¤
vi âˆˆV âˆªUNK
where Wo âˆˆR(N+1)Ã—ds and vi is the one-hot indicator vector for vi.
Copy-Mode:
The score for â€œcopyingâ€ the word
xj is calculated as
Ïˆc(yt = xj) = Ïƒ
where Wc âˆˆRdhÃ—ds, and Ïƒ is a non-linear activation function, considering that the non-linear
transformation in Eq.( 8) can help project st and hj
in the same semantic space. Empirically, we also
found that using the tanh non-linearity worked
better than linear transformation, and we used that
for the following experiments. When calculating
the copy-mode score, we use the hidden states
{h1, ..., hTS} to â€œrepresentâ€ each of the word in
the source sequence {x1, ..., xTS} since the bidirectional RNN encodes not only the content, but
also the location information into the hidden states
in M. The location informaton is important for
copying (see Section 3.4 for related discussion).
Note that we sum the probabilities of all xj equal
to yt in Eq. (6) considering that there may be multiple source symbols for decoding yt. Naturally
we let p(yt, c|Â·) = 0 if yt does not appear in the
source sequence, and set p(yt, g|Â·) = 0 when yt
only appears in the source.
State Update
COPYNET updates each decoding state st with
the previous state stâˆ’1, the previous symbol ytâˆ’1
and the context vector ct following Eq. (2) for the
generic attention-based Seq2Seq model. However,
there is some minor changes in the ytâˆ’1âˆ’â†’st path
for the copying mechanism.
More speciï¬cally,
ytâˆ’1 will be represented as [e(ytâˆ’1); Î¶(ytâˆ’1)]âŠ¤,
where e(ytâˆ’1) is the word embedding associated
with ytâˆ’1, while Î¶(ytâˆ’1) is the weighted sum of
hidden states in M corresponding to yt
K p(xÏ„, c|stâˆ’1, M),
where K is the normalization term which equals
Ï„ â€²:xÏ„â€²=ytâˆ’1 p(xÏ„ â€², c|stâˆ’1, M), considering there
may exist multiple positions with ytâˆ’1 in the
source sequence.
In practice, ÏtÏ„ is often concentrated on one location among multiple appearances, indicating the prediction is closely bounded
to the location of words.
In a sense Î¶(ytâˆ’1) performs a type of read to
M similar to the attentive read (resulting ct) with
however higher precision.
In the remainder of
this paper, Î¶(ytâˆ’1) will be referred to as selective
read. Î¶(ytâˆ’1) is speciï¬cally designed for the copy
mode: with its pinpointing precision to the corresponding ytâˆ’1, it naturally bears the location of
ytâˆ’1 in the source sequence encoded in the hidden
state. As will be discussed more in Section 3.4,
this particular design potentially helps copy-mode
in covering a consecutive sub-sequence of words.
If ytâˆ’1 is not in the source, we let Î¶(ytâˆ’1) = 0.
Hybrid Addressing of M
We hypothesize that COPYNET uses a hybrid
strategy for fetching the content in M, which combines both content-based and location-based addressing. Both addressing strategies are coordinated by the decoder RNN in managing the attentive read and selective read, as well as determining
when to enter/quit the copy-mode.
Both the semantics of a word and its location
in X will be encoded into the hidden states in M
by a properly trained encoder RNN. Judging from
our experiments, the attentive read of COPYNET is
driven more by the semantics and language model,
therefore capable of traveling more freely on M,
even across a long distance. On the other hand,
once COPYNET enters the copy-mode, the selective read of M is often guided by the location information. As the result, the selective read often
takes rigid move and tends to cover consecutive
words, including UNKs. Unlike the explicit design for hybrid addressing in Neural Turing Machine ,
COPYNET is more subtle: it provides the architecture that can facilitate some particular locationbased addressing and lets the model ï¬gure out the
details from the training data for speciï¬c tasks.
Location-based Addressing: With the location
information in {hi}, the information ï¬‚ow
âˆ’âˆ’âˆ’âˆ’â†’Î¶(yt)
provides a simple way of â€œmoving one step to the
rightâ€ on X. More speciï¬cally, assuming the selective read Î¶(ytâˆ’1) concentrates on the â„“th word
in X, the state-update operation Î¶(ytâˆ’1)
acts as â€œlocation â†location+1â€, making st
favor the (â„“+1)th word in X in the prediction
âˆ’âˆ’âˆ’â†’yt in copy-mode. This again leads to
the selective read Ë†ht
âˆ’âˆ’âˆ’âˆ’â†’Î¶(yt) for the state update of the next round.
Handling Out-of-Vocabulary Words Although
it is hard to verify the exact addressing strategy as
above directly, there is strong evidence from our
empirical study. Most saliently, a properly trained
COPYNET can copy a fairly long segment full of
OOV words, despite the lack of semantic information in its M representation. This provides a
natural way to extend the effective vocabulary to
include all the words in the source. Although this
change is small, it seems quite signiï¬cant empirically in alleviating the OOV problem. Indeed, for
many NLP applications (e.g., text summarization
or spoken dialogue system), much of the OOV
words on the target side, for example the proper
nouns, are essentially the replicates of those on the
source side.
Although the copying mechanism uses the â€œhardâ€
operation to copy from the source and choose to
paste them or generate symbols from the vocabulary, COPYNET is fully differentiable and can
be optimized in an end-to-end fashion using backpropagation. Given the batches of the source and
target sequence {X}N and {Y }N, the objectives
are to minimize the negative log-likelihood:
<t , X(k))
where we use superscripts to index the instances.
Since the probabilistic model for observing any
target word is a mixture of generate-mode and
copy-mode, there is no need for any additional
labels for modes. The network can learn to coordinate the two modes from data. More specifically, if one particular word y(k)
can be found
in the source sequence, the copy-mode will contribute to the mixture model, and the gradient will
more or less encourage the copy-mode; otherwise,
the copy-mode is discouraged due to the competition from the shared normalization term Z. In
practice, in most cases one mode dominates.
Experiments
We report our empirical study of COPYNET on the
following three tasks with different characteristics
1. A synthetic dataset on with simple patterns;
2. A real-world task on text summarization;
3. A dataset for simple single-turn dialogues.
Synthetic Dataset
Dataset: We ï¬rst randomly generate transformation rules with 5âˆ¼20 symbols and variables x &
a b x c d y e f âˆ’â†’
with {a b c d e f g h m} being regular symbols
from a vocabulary of size 1,000. As shown in the
table below, each rule can further produce a number of instances by replacing the variables with
randomly generated subsequences (1âˆ¼15 symbols) from the same vocabulary. We create ï¬ve
types of rules, including â€œx â†’âˆ…â€. The task is
to learn to do the Seq2Seq transformation from
the training instances. This dataset is designed to
study the behavior of COPYNET on handling simple and rigid patterns. Since the strings to repeat
are random, they can also be viewed as some extreme cases of rote memorization.
Examples (e.g. x = i h k, y = j c)
a b c d x e f â†’c d g
a b c d x e f â†’c d x g
a b c d x e f â†’x d x g
a b y d x e f â†’x d i g
a b y d x e f â†’x d y g
Experimental Setting: We select 200 artiï¬cial
rules from the dataset, and for each rule 200 instances are generated, which will be split into
training (50%) and testing (50%). We compare
the accuracy of COPYNET and the RNN Encoder-
Decoder with (i.e. RNNsearch) or without attention (denoted as Enc-Dec). For a fair comparison, we use bi-directional GRU for encoder and
another GRU for decoder for all Seq2Seq models,
with hidden layer size = 300 and word embedding
dimension = 150. We use bin size = 10 in beam
search for testing. The prediction is considered
Table 1: The test accuracy (%) on synthetic data.
correct only when the generated sequence is exactly the same as the given one.
It is clear from Table 1 that COPYNET signiï¬cantly outperforms the other two on all rule-types
except â€œx â†’âˆ…â€, indicating that COPYNET can effectively learn the patterns with variables and accurately replicate rather long subsequence of symbols at the proper places.This is hard to Enc-Dec
due to the difï¬culty of representing a long sequence with very high ï¬delity. This difï¬culty can
be alleviated with the attention mechanism. However attention alone seems inadequate for handling
the case where strict replication is needed.
A closer look (see Figure 3 for example) reveals that the decoder is dominated by copy-mode
when moving into the subsequence to replicate,
and switch to generate-mode after leaving this
area, showing COPYNET can achieve a rather precise coordination of the two modes.
705 502 X 504 339 270 584 556
510 771 581 557 022 230 X 115
102 172 862 X 950
* Symbols are represented by
their indices from 000 to 999
** Dark color represents large
The Source Sequence
The Target Sequence
Example output of COPYNET on the
synthetic dataset. The heatmap represents the activations of the copy-mode over the input sequence
(left) during the decoding process (bottom).
Text Summarization
Automatic text summarization aims to ï¬nd a condensed representation which can capture the core
meaning of the original document.
It has been
recently formulated as a Seq2Seq learning problem in , which
essentially gives abstractive summarization since
the summary is generated based on a representation of the document.
In contrast, extractive
summarization extracts sentences or phrases from
the original text to fuse them into the summaries,
therefore making better use of the overall structure of the original document. In a sense, COPY-
NET for summarization lies somewhere between
two categories, since part of output summary is actually extracted from the document (via the copying mechanism), which are fused together possibly with the words from the generate-mode.
We evaluate our model on the recently
published LCSTS dataset , a large
scale dataset for short text summarization. The
dataset is collected from the news medias on Sina
Weibo1 including pairs of (short news, summary)
in Chinese. Shown in Table 2, PART II and III are
manually rated for their quality from 1 to 5. Following the setting of we use Part
I as the training set and and the subset of Part III
scored from 3 to 5 as the testing set.
no. of pairs
no. of score â‰¥3
Table 2: Some statistics of the LCSTS dataset.
Experimental Setting: We try COPYNET that is
based on character (+C) and word (+W). For the
word-based variant the word-segmentation is obtained with jieba2. We set the vocabulary size to
3,000 (+C) and 10,000 (+W) respectively, which
are much smaller than those for models in . For both variants we set the embedding dimension to 350 and the size of hidden
layers to 500. Following , we
evaluate the test performance with the commonly
used ROUGE-1, ROUGE-2 and ROUGE-L , and compare it against the two models in
 , which are essentially canonical
Encoder-Decoder and its variant with attention.
ROUGE scores on LCSTS (%)
 
RNN context
 
Testing performance of LCSTS, where
â€œRNNâ€ is canonical Enc-Dec, and â€œRNN contextâ€
its attentive variant.
It is clear from Table 3 that COPYNET beats
the competitor models with big margin.
et al. reports that the performance of a
word-based model is inferior to a character-based
1www.sina.com
2 
Input(1): ä»Šå¤©ä¸Šåˆ9 ç‚¹åŠï¼Œå¤æ—¦æŠ•æ¯’æ¡ˆå°†åœ¨ä¸Šæµ·äºŒä¸­é™¢å…¬å¼€å®¡ç†ã€‚è¢«å®³å­¦ç”Ÿé»„æ´‹çš„äº²å±å·²ä»å››å·æŠµè¾¾ä¸Šæµ·ï¼Œå…¶çˆ¶ç§°å¾…åˆ‘äº‹éƒ¨åˆ†ç»“æŸåï¼Œå†ææ°‘äº‹èµ”å¿ï¼Œé»„æ´‹92 å²çš„å¥¶å¥¶ä¾ç„¶
ä¸çŸ¥æƒ…ã€‚ä»Šå¹´4 æœˆï¼Œåœ¨å¤æ—¦ä¸Šæµ·åŒ»å­¦é™¢è¯»ç ”ç©¶ç”Ÿçš„é»„æ´‹ç–‘é­å®¤å‹æ—æ£®æµ©æŠ•æ¯’ï¼Œä¸å¹¸èº«äº¡ã€‚æ–°æ°‘ç½‘
Today 9:30, the Fudan poisoning case will be will on public trial at the Shanghai Second Intermediate Court. The relatives of the murdered student Huang Yang has arrived at Shanghai from Sichuan. His father said that they will start
the lawsuit for civil compensation after the criminal section. HuangYang 92-year-old grandmother is still unaware of his death. In April, a graduate student at Fudan University Shanghai Medical College, Huang Yang is allegedly
poisoned and killed by his roommate Lin Senhao. Reported by Xinmin
______________________________________________________________
Golden: æ—æ£®æµ©æŠ•æ¯’æ¡ˆä»Šæ—¥å¼€å®¡92 å²å¥¶å¥¶å°šä¸çŸ¥æƒ…
the case of Lin Senhao poisoning is on trial today, his 92-year-old grandmother is still unaware of this
RNN context: å¤æ—¦æŠ•æ¯’æ¡ˆï¼šé»„æ´‹ç–‘é­å®¤å‹æŠ•æ¯’å‡¶æ‰‹å·²ä»å››å·é£å¾€ä¸Šæµ·ï¼Œçˆ¶äº²å‘½æ¡ˆå¦æœ‰4äººè¢«é€šçŸ¥å®¶å±ä¸æ²»ï¼Ÿ
CopyNet: å¤æ—¦æŠ•æ¯’æ¡ˆä»Šåœ¨æ²ªä¸Šå…¬å¼€å®¡ç†
the Fudan poisoning case is on public trial today in Shanghai
Input(2): åè°Šå…„å¼Ÿï¼ˆ300027 ï¼‰åœ¨æ˜¨æ—¥æ”¶ç›˜åå‘å¸ƒå…¬å‘Šç§°ï¼Œå…¬å¸æ‹Ÿä»¥è‡ªæœ‰èµ„é‡‘3.978 äº¿å…ƒæ”¶è´­æµ™æ±Ÿæ°¸ä¹å½±è§†è‚¡ä»½æœ‰é™å…¬å¸è‹¥å¹²è‚¡ä¸œæŒæœ‰çš„æ°¸ä¹å½±è§†51 % çš„è‚¡æƒã€‚å¯¹äºæ­¤é¡¹æ”¶è´­ï¼Œ
åè°Šå…„å¼Ÿè‘£ç§˜èƒ¡æ˜æ˜¨æ—¥è¡¨ç¤ºï¼šâ€œ å’Œæ°¸ä¹å½±è§†çš„åˆå¹¶æ˜¯å¯¹åè°Šå…„å¼Ÿç”µè§†å‰§ä¸šåŠ¡çš„ä¸€ä¸ªåŠ å¼ºã€‚
Huayi Brothers (300027) announced that the company intends to buy with its own fund 397.8 million 51% of Zhejiang Yongle Film LTD's stake owned by a number of shareholders of Yongle Film LTD. For this acquisition, the
secretary of the board, Hu Ming, said yesterday: "the merging with Yongle Film is to strengthen Huayi Brothers on TV business".
______________________________________________________________
Golden: åè°Šå…„å¼Ÿæ‹Ÿæ”¶è´­æ°¸ä¹å½±è§†ï¼•ï¼‘ï¼…è‚¡æƒ
Huayi Brothers intends to acquire 51% stake of Zhejiang Yongle Film
RNN context: åè°Šå…„å¼Ÿæ”¶è´­æ°¸ä¹å½±è§†51%è‚¡æƒï¼šä¸æ°¸ä¹å½±è§†åˆå¹¶ä¸ºâ€œå’Œå”â€å½±è§†åˆå¹¶çš„â€œUNKâ€å’Œâ€œUNKâ€çš„åŒºåˆ«ï¼Ÿ
CopyNet: åè°Šå…„å¼Ÿæ‹Ÿ3.978 äº¿æ”¶è´­æ°¸ä¹å½±è§†è‘£ç§˜ç§°åŠ å¼ºç”µè§†å‰§ä¸šåŠ¡
Huayi Brothers is intended to 397.8 million acquisition of Yongle Film secretaries called to strengthen the TV business
Input(3): å·¥å‚ï¼Œå¤§é—¨ç´§é”ï¼Œçº¦20 åå·¥äººæ•£ååœ¨æ ‘è«ä¸‹ã€‚â€œ æˆ‘ä»¬å°±æ˜¯æ™®é€šå·¥äººï¼Œåœ¨è¿™é‡Œç­‰å·¥èµ„ã€‚â€ å…¶ä¸­ä¸€äººè¯´é“ã€‚7 æœˆ4 æ—¥ä¸Šåˆï¼Œè®°è€…æŠµè¾¾æ·±åœ³é¾™ååŒºæ¸…æ¹–è·¯ä¸Šçš„æ·±åœ³æ„¿æ™¯
å…‰ç”µå­æœ‰é™å…¬å¸ã€‚æ­£å¦‚ä¼ è¨€ä¸€èˆ¬ï¼Œæ„¿æ™¯å…‰ç”µå­å€’é—­äº†ï¼Œå¤§è‚¡ä¸œé‚¢æ¯…ä¸çŸ¥æ‰€è¸ªã€‚
The door of factory is locked. About 20 workers are scattered to sit under the shade. â€œWe are ordinary workers, waiting for our salaryâ€ one of them said. In the morning of July 4th, reporters arrived at Yuanjing Photoelectron
Corporation located at Qinghu Road, Longhua District, Shenzhen. Just as the rumor, Yuanjing Photoelectron Corporation is closed down and the big shareholder Xing Yi is missing.
______________________________________________________________
Golden: æ·±åœ³äº¿å…ƒçº§LED ä¼ä¸šå€’é—­çƒˆæ—¥ä¸‹å·¥äººè‹¦ç­‰è€æ¿
Hundred-million CNY worth LED enterprise is closed down and workers wait for the boss under the scorching sun
RNN context: æ·±åœ³â€œ<UNK>â€ï¼šæ·±åœ³<UNK><UNK>ï¼Œ<UNK>ï¼Œ<UNK>ï¼Œ<UNK>
CopyNet: æ„¿æ™¯å…‰ç”µå­å€’é—­20 åå·¥äººæ•£ååœ¨æ ‘è«ä¸‹
Yuanjing Photoelectron Corporation is closed down, 20 workers are scattered to sit under the shade
Input(4): æˆªè‡³2012 å¹´10 æœˆåº•ï¼Œå…¨å›½ç´¯è®¡æŠ¥å‘Šè‰¾æ»‹ç—…ç—…æ¯’æ„ŸæŸ“è€…å’Œç—…äºº492191 ä¾‹ã€‚å«ç”Ÿéƒ¨ç§°ï¼Œæ€§ä¼ æ’­å·²æˆä¸ºè‰¾æ»‹ç—…çš„ä¸»è¦ä¼ æ’­é€”å¾„ã€‚è‡³2011 å¹´9 æœˆï¼Œè‰¾æ»‹ç—…æ„ŸæŸ“è€…å’Œç—…äººæ•°ç´¯
è®¡æŠ¥å‘Šæ•°æ’åœ¨å‰6 ä½çš„çœä»½ä¾æ¬¡ä¸ºäº‘å—ã€å¹¿è¥¿ã€æ²³å—ã€å››å·ã€æ–°ç–†å’Œå¹¿ä¸œï¼Œå å…¨å›½çš„75.8 % ã€‚ã€‚
At the end of October 2012, the national total of reported HIV infected people and AIDS patients is 492,191 cases. The Health Ministry saids exual transmission has become the main route of transmission of AIDS. To September
2011, the six provinces with the most reported HIV infected people and AIDS patients were Yunnan, Guangxi, Henan,Sichuan, Xinjiang and Guangdong, accounting for 75.8% of the country.
______________________________________________________________
Golden: å«ç”Ÿéƒ¨ï¼šæ€§ä¼ æ’­æˆè‰¾æ»‹ç—…ä¸»è¦ä¼ æ’­é€”å¾„
Ministry of Health: Sexually transmission became the main route of transmission of AIDS
RNN context: å…¨å›½ç´¯è®¡æŠ¥å‘Šè‰¾æ»‹ç—…æ‚£è€…å’Œç—…äºº<UNK>ä¾‹è‰¾æ»‹ç—…æ‚£è€…å å…¨å›½<UNK>%ï¼Œæ€§ä¼ æ’­æˆè‰¾æ»‹ç—…é«˜å‘äººç¾¤ï¼Ÿ
CopyNet: å«ç”Ÿéƒ¨ï¼šæ€§ä¼ æ’­å·²æˆä¸ºè‰¾æ»‹ç—…ä¸»è¦ä¼ æ’­é€”å¾„
Ministry of Health: Sexually transmission has become the main route of transmission of AIDS
Input(5): ä¸­å›½åå„æ–­è°ƒæŸ¥é£æš´ç»§ç»­å¸­å·æ±½è½¦è¡Œä¸šï¼Œç»§å¾·å›½è½¦ä¼å¥¥è¿ªå’Œç¾å›½è½¦ä¼å…‹è±æ–¯å‹’â€œ æ²¦é™·â€ ä¹‹åï¼Œåˆæœ‰12 å®¶æ—¥æœ¬æ±½è½¦ä¼ä¸šå·å…¥æ¼©æ¶¡ã€‚è®°è€…ä»ä¸šå†…äººå£«è·æ‚‰ï¼Œä¸°ç”°æ——ä¸‹çš„
é›·å…‹è¨æ–¯è¿‘æœŸæ›¾è¢«å‘æ”¹å§”çº¦è°ˆã€‚
Chinese antitrust investigation continues to sweep the automotive industry. After Germany Audi car and the US Chrysler "fell", there are 12 Japanese car companies involved in the whirlpool. Reporters learned from the insiders
that Toyota's Lexus has been asked to report to the Development and Reform Commission recently.
______________________________________________________________
Golden: å‘æ”¹å§”å…¬å¸ƒæ±½è½¦åå„æ–­è¿›ç¨‹ï¼šä¸°ç”°é›·å…‹è¨æ–¯è¿‘æœŸè¢«çº¦è°ˆ
the investigation by Development and Reform Commission: Toyota's Lexus has been asked to report
RNN context: ä¸°ç”°é›·å…‹è¨æ–¯é­å‘æ”¹å§”çº¦è°ˆï¼šæ›¾è¢«çº¦è°ˆä¸°ç”°æ——ä¸‹çš„é›·å…‹è¨æ–¯é­å‘æ”¹å§”çº¦è°ˆè´Ÿäººè¢«çº¦è°ˆ
CopyNet: ä¸­å›½åå„æ–­ç»§ç»­å¸­å·æ±½è½¦è¡Œä¸š12 å®¶æ—¥æœ¬æ±½è½¦ä¼ä¸šè¢«å‘æ”¹å§”çº¦è°ˆ
Chinese antitrust investigation continues to sweep the automotive industry. 12 Japanese car companies are asked to report to he Development and Reform Commission
Input(6): é•ç¦»å­ç”µæ± ç›¸æ¯”é”‚ç”µæ± èƒ½é‡å¯†åº¦æå‡äº†è¿‘ä¸€å€ï¼Œè¿™æ„å‘³ç€ä½¿ç”¨äº†é•ç”µæ± çš„ç”µåŠ¨è½¦ï¼Œçº¯ç”µç»­èˆªä¹Ÿå°†æœ‰è´¨çš„æå‡ã€‚ä½†ç›®å‰ç”±äºç”µè§£è´¨ç­‰æŠ€æœ¯å£å’ï¼Œè¦å¤§è§„æ¨¡é‡äº§å¹¶å–ä»£é”‚ç”µæ± è¿˜ä¸ºæ—¶è¿‡æ—©ã€‚
The energy density of Magnesium ion batteries almost doubles that of lithium battery, which means that for the electric vehicles using of magnesium batteries will last longer even at pure electric power. But currently due to the
technical barriers to the electrolyte, it is still too early for the mass production of it and replacing lithium batteries..
______________________________________________________________
Golden: é”‚ç”µæ± æˆ–å°†è¢«æ·˜æ±°èƒ½é‡å¯†åº¦æ›´é«˜çš„é•ç”µæ± äº¦å¤§åŠ¿æ‰€è¶‹
Lithium batteries will be phased out, magnesium battery with energy density higher will be the future trend
RNN context: <UNK>ã€<UNK>ã€<UNK>ã€<UNK>ã€<UNK>ã€<UNK>ã€<UNK>ã€<UNK>ã€<UNK>ã€<UNK>ã€<UNK>ã€<UNK>ç”µæ± äº†
CopyNet: é•ç¦»å­ç”µæ± é—®ä¸–ï¼šå¤§è§„æ¨¡é‡äº§å–ä»£é”‚ç”µæ± 
Magnesium ion battery is developed : mass production of it will replace lithium batteries
Input(7): 1 . æŒæ¡æŠ€å·§èä¼šè´¯é€šï¼›2 . å­¦ä¼šèèµ„ï¼›3 . æ‡‚æ³•å¾‹ï¼›4 . ä¿æŒè‡ªä¿¡ï¼›5 . æµ‹è¯•+ å°è¯•ï¼›6 . äº†è§£å®¢æˆ·çš„éœ€æ±‚ï¼›7 . é¢„æµ‹+ è¡¡é‡+ ç¡®ä¿ï¼›8 . åšå¥½ä¸å„ç§å°bug åšæ–—äº‰çš„å¿ƒæ€ï¼›9 .
å‘ç°æœºé‡ä¿æŒåˆ›ä¸šæ¿€æƒ…ã€‚
1. master the skills; 2 Learn to finance ; 3. understand the law; 4. Be confident; 5. test+ trial; 6. understand the need of customers; 7 forecast + measure + ensure; 8. mentally prepared to fight all kinds of small bugs ; 9 discover
opportunities and keep the passion of start-up.
______________________________________________________________
Golden: åˆæ¬¡åˆ›ä¸šè€…å¿…çŸ¥çš„10 ä¸ªæŠ€å·§
The 10 tips for the first time start-ups
RNN context: 6ä¸ªæ–¹æ³•è®©ä½ åˆ›ä¸šçš„6ä¸ª<UNK>ä¸<UNK>ï¼Œä½ æ€ä¹ˆçœ‹æ‡‚ä½ çš„åˆ›ä¸šæ•…äº‹å—ï¼Ÿï¼ˆ6å®¶ï¼‰
CopyNet: åˆ›ä¸šæˆåŠŸçš„9 ä¸ªæŠ€å·§
The 9 tips for success in start-up
Input(8): 9 æœˆ3 æ—¥ï¼Œæ€»éƒ¨ä½äºæ—¥å†…ç“¦çš„ä¸–ç•Œç»æµè®ºå›å‘å¸ƒäº†ã€Š2014 - 2015 å¹´å…¨çƒç«äº‰åŠ›æŠ¥å‘Šã€‹ï¼Œç‘å£«è¿ç»­å…­å¹´ä½å±…æ¦œé¦–ï¼Œæˆä¸ºå…¨çƒæœ€å…·ç«äº‰åŠ›çš„å›½å®¶ï¼Œæ–°åŠ å¡å’Œç¾å›½åˆ†åˆ—ç¬¬äºŒ
ä½å’Œç¬¬ä¸‰ä½ã€‚ä¸­å›½æ’åç¬¬28 ä½ï¼Œåœ¨é‡‘ç –å›½å®¶ä¸­æ’åæœ€é«˜ã€‚
On September 3, the Geneva based World Economic Forum released â€œ The Global Competitiveness Report 2014-2015â€. Switzerland topped the list for six consecutive years , becoming the worldâ€˜s most competitive country. Singapore
and the United States are in the second and third place respectively. China is in the 28th place, ranking highest among the BRIC countries.
______________________________________________________________
Golden: å…¨çƒç«äº‰åŠ›æ’è¡Œæ¦œä¸­å›½å±…28 ä½å±…é‡‘ç –å›½å®¶é¦–ä½
The Global competitiveness ranking list, China is in the 28th place, the highest among BRIC countries.
RNN context: 2014-2015å¹´å…¨çƒç«äº‰åŠ›æŠ¥å‘Šï¼šç‘å£«è¿ç»­6å¹´å±…æ¦œé¦–ä¸­å›½å±…28ä½(é¦–/3â€”â€”â€”è®¿æ¦œé¦–)ä¸­å›½æ’åç¬¬28ä½
CopyNet: 2014 - 2015 å¹´å…¨çƒç«äº‰åŠ›æŠ¥å‘Šï¼šç‘å£«å±…é¦–ä¸­å›½ç¬¬28
2014--2015 Global Competitiveness Report: Switzerland topped and China the 28th
Examples of COPYNET on LCSTS compared with RNN context. Word segmentation is
applied on the input, where OOV words are underlined. The highlighted words (with different colors)
are those words with copy-mode probability higher than the generate-mode. We also provide literal
English translation for the document, the golden, and COPYNET, while omitting that for RNN context
since the language is broken.
One possible explanation is that a wordbased model, even with a much larger vocabulary
 ), still has a large
proportion of OOVs due to the large number of entity names in the summary data and the mistakes
in word segmentation. COPYNET, with its ability
to handle the OOV words with the copying mechanism, performs however slightly better with the
word-based variant.
Case Study
As shown in Figure 4, we make the following
interesting observations about the summary from
COPYNET: 1) most words are from copy-mode,
but the summary is usually still ï¬‚uent; 2) COPY-
NET tends to cover consecutive words in the original document, but it often puts together segments far away from each other, indicating a sophisticated coordination of content-based addressing and location-based addressing; 3) COPYNET
handles OOV words really well: it can generate acceptable summary for document with many
OOVs, and even the summary itself often contains many OOV words. In contrast, the canonical
RNN-based approaches often fail in such cases.
It is quite intriguing that COPYNET can often
ï¬nd important parts of the document, a behavior with the characteristics of extractive summarization, while it often generate words to â€œconnectâ€ those words, showing its aspect of abstractive summarization.
Single-turn Dialogue
In this experiment we follow the work on neural
dialogue model proposed in , and
test COPYNET on single-turn dialogue. Basically,
the neural model learns to generate a response to
userâ€™s input, from the given (input, response) pairs
as training instances.
We build a simple dialogue dataset
based on the following three instructions:
1. Dialogue instances are collected from Baidu
Tieba3 with some coverage of conversations
of real life e.g., greeting and sports, etc.
2. Patterns with slots like
hi, my name is x â†’hi, x
are mined from the set, with possibly multiple responding patterns to one input.
3 
3. Similar with the synthetic dataset, we enlarge
the dataset by ï¬lling the slots with suitable
subsequence (e.g. name entities, dates, etc.)
To make the dataset close to the real conversations,
we also maintain a certain proportion of instances
with the response that 1) do not contain entities or
2) contain entities not in the input.
Experimental Setting: We create two datasets:
DS-I and DS-II with slot ï¬lling on 173 collected
The main difference between the two
datasets is that the ï¬lled substrings for training and
testing in DS-II have no overlaps, while in DS-I
they are sampled from the same pool. For each
dataset we use 6,500 instances for training and
1,500 for testing. We compare COPYNET with
canonical RNNSearch, both character-based, with
the same model conï¬guration in Section 5.1.
Table 4: The decoding accuracy on the two testing
sets. Decoding is admitted success only when the
answer is found exactly in the Top-K outputs.
We compare COPYNET and RNNSearch on
DS-I and DS-II in terms of top-1 and top-10 accuracy (shown in Table 4), estimating respectively
the chance of the top-1 or one of top-10 (from
beam search) matching the golden. Since there
are often many good responses to an input, top-
10 accuracy appears to be closer to the real world
As shown in Table 4, COPYNET signiï¬cantly
outperforms RNNsearch, especially on DS-II. It
suggests that introducing the copying mechanism
helps the dialogue system master the patterns in
dialogue and correctly identify the correct parts of
input, often proper nouns, to replicate in the response. Since the ï¬lled substrings have no overlaps in DS-II, the performance of RNNSearch
drops signiï¬cantly as it cannot handle words unseen in training data. In contrast, the performance
of COPYNET only drops slightly as it has learned
to ï¬ll the slots with the copying mechanism and
relies less on the representation of the words.
Case Study
As indicated by the examples in Figure 5, COPY-
NET accurately replicates the critical segments
from the input with the copy-mode, and generates
Input(1): æˆ‘å‡ºç”Ÿåœ¨ä¸Šæµ·ã€‚
/I was born in Shanghai
Golden: çœŸå·§ï¼Œæˆ‘ä¹Ÿæ¥è‡ªä¸Šæµ·ï¼Œè€ä¹¡å•Š! /What a coincidence, I also come from Shanghai, we are fellow townsman!
RNNSearch: çœŸå·§ï¼Œæˆ‘ä¹Ÿæ¥è‡ªæµ·å—ï¼Œè€ä¹¡å•Š! /What a coincidence, I also come from Hainan, we are fellow townsman!
CopyNet: çœŸå·§ï¼Œæˆ‘ä¹Ÿæ¥è‡ªä¸Šæµ·ï¼Œè€ä¹¡å•Š! /What a coincidence, I also come from Shanghai, we are fellow townsman!
Input(2): ä»Šå¤©å»çˆ¬é»„å±±å—ï¼Ÿ
/Shall we climbing Huangshan?
Golden: å»çˆ¬æ³°å±±å§ï¼Œé»„å±±æ²¡æ„æ€!
/Climb Taishan. Huangshan is boring!
RNNSearch: å»çˆ¬é•¿ç™½å±±å§ï¼Œè¡¡å±±æ²¡æ„æ€! /Climb Changbaishan, Hengshan is boring!
CopyNet: å»çˆ¬åµ©å±±å§ï¼Œé»„å±±æ²¡æ„æ€!
/Climb Songshan, Huangshan is boring!
Input(3): ä½ å–œæ¬¢å–é›ªç¢§è¿˜æ˜¯å–œæ¬¢å¯ä¹ï¼Ÿ
/Would you like to drink Sprite or Coke?
Golden: éƒ½ä¸å–œæ¬¢ï¼Œè°¢è°¢! /Not at all, thanks!
RNNSearch: æˆ‘å–œæ¬¢å–èœ‚èœœ!
/I like to drink honey!
CopyNet: æˆ‘å–œæ¬¢å–å¯ä¹!
/I like to drink coke!
Input(4): æˆ‘å¤§é’å²›å››å­£å®œäºº
/Our great Qingdao has a good weather!
Golden: å£®æˆ‘å¤§é’å²›ï½ï½ï½
/Our Qingdao is great~~~
RNNSearch: å£®æˆ‘å¤§å“ˆå°”æ»¨ï½ï½ï½
/Our Harbin is great~~~
CopyNet: å£®æˆ‘å¤§é’å²›ï½ï½ï½
/Our Qingdao is great~~~
Input(5): å¥³å„¿ä¼šæ¸¸è¶æ³³
/Daughter can swim butterfly?
Golden: æˆ‘è¿æ¸¸æ³³éƒ½ä¸ä¼šT^T /I cannot swim at all T^T
RNNSearch: æˆ‘è¿æ¸¸æ³³éƒ½ä¸ä¼šT^T
/I cannot swim at all T^T
CopyNet: æˆ‘è¿æ¸¸æ³³éƒ½ä¸ä¼šT^T
/I cannot swim at all T^T
Input(6): è‹æœ‰æœ‹æ˜¯è°?
/Who is Su You Peng?
Golden: è‹æœ‰æœ‹æ˜¯ä¸€ä¸ªç”·æ˜æ˜Ÿã€‚
/Su You Peng is a male star.
CopyNet: è‹æœ‰æ˜¯ä¸€ä¸ªç”·æ˜æ˜Ÿã€‚
/Su You is a male star
RNNSearch:
å´äº¦å‡¡æ˜¯ä¸€ä¸ªç”·æ˜æ˜Ÿã€‚
/Wu Yifan is a male star.
Figure 5: Examples from the testing set of DS-II shown as the input text and golden, with the outputs
of RNNSearch and CopyNet. Words in red rectangles are unseen in the training set. The highlighted
words (with different colors) are those words with copy-mode probability higher than the generate-mode.
Green cirles (meaning correct) and red cross (meaning incorrect) are given based on human judgment on
whether the response is appropriate.
the rest of the answers smoothly by the generatemode. Note that in (2) and (3), the decoding sequence is not exactly the same with the standard
one, yet still correct regarding to their meanings.
In contrast, although RNNSearch usually generates answers in the right formats, it fails to catch
the critical entities in all three cases because of the
difï¬culty brought by the unseen words.
Related Work
Our work is partially inspired by the recent work
of Pointer Networks , in
which a pointer mechanism (quite similar with the
proposed copying mechanism) is used to predict
the output sequence directly from the input. In addition to the difference with ours in application,
 cannot predict outside of
the set of input sequence, while COPYNET can
naturally combine generating and copying.
COPYNET is also related to the effort to solve
the OOV problem in neural machine translation.
Luong et al. introduced a heuristics to postprocess the translated sentence using annotations
on the source sentence. In contrast COPYNET addresses the OOV problem in a more systemic way
with an end-to-end model. However, as COPY-
NET copies the exact source words as the output, it
cannot be directly applied to machine translation.
However, such copying mechanism can be naturally extended to any types of references except
for the input sequence, which will help in applications with heterogeneous source and target sequences such as machine translation.
The copying mechanism can also be viewed as
carrying information over to the next stage without
any nonlinear transformation. Similar ideas are
proposed for training very deep neural networks in
 for classiï¬cation tasks, where shortcuts are built between
layers for the direct carrying of information.
Recently, we noticed some parallel efforts towards modeling mechanisms similar to or related
to copying. Cheng and Lapata devised a
neural summarization model with the ability to extract words/sentences from the source. Gulcehre
et al. proposed a pointing method to handle the OOV words for summarization and MT. In
contrast, COPYNET is more general, and not limited to a speciï¬c task or OOV words. Moreover,
the softmaxCOPYNET is more ï¬‚exible than gating
in the related work in handling the mixture of two
modes, due to its ability to adequately model the
content of copied segment.
Conclusion and Future Work
We proposed COPYNET to incorporate copying into the sequence-to-sequence learning framework. For future work, we will extend this idea to
the task where the source and target are in heterogeneous types, for example, machine translation.
Acknowledgments
This work is supported in part by the China National 973 Project 2014CB340301.