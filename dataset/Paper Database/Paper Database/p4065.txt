Springer Series in Statistics
P. Bickel, P. Diggle, S. Fienberg, K. Krickeberg,
I. Olkin, N. Wermuth, S. Zeger
Springer Science+Business Media, LLC
Springer Series in Statistics
Andersen!Borgan/Gili/Keiding: Statistical Models Based on Counting Processes.
Atkinson/Riani: Robust Diagnotstic Regression Analysis.
Berger: Statistical Decision Theory and Bayesian Analysis, 2nd edition.
Bolfarine!Zacks: Prediction Theory for Finite Populations.
Borg/Groenen: Modem Multidimensional Scaling: Theory and Applications
Brockwell/Davis: Time Series: Theory and Methods, 2nd edition.
Chen!Shaollbrahim: Monte Carlo Methods in Bayesian Computation.
David/Edwards: Annotated Readings in the History of Statistics.
Devroye/Lugosi: Combinatorial Methods in Density Estimation.
Efromovich: Nonparametric Curve Estimation: Methods, Theory, and Applications.
Fahrmeirffutz: Multivariate Statistical Modelling Based on Generalized Linear
Models, 2nd edition.
Farebrother: Fitting Linear Relationships: A History of the Calculus of Observations
1750-1900.
Federer: Statistical Design and Analysis for Intercropping Experiments, Volume I:
Two Crops.
Federer: Statistical Design and Analysis for Intercropping Experiments, Volume II:
Three or More Crops.
Fienberg/Hoaglin/Kruska/ffanur (Eds.): A Statistical Model: Frederick Mosteller's
Contributions to Statistics, Science and Public Policy.
Fisher/Sen: The Collected Works ofWassily Hoeffding.
Glaz/Naus/Wallenstein: Scan Statistics.
Good: Permutation Tests: A Practical Guide to Resampling Methods for Testing
Hypotheses, 2nd edition.
Gourieroux: ARCH Models and Financial Applications.
Grande/1: Aspects of Risk Theory.
Haberman: Advanced Statistics, Volume I: Description of Populations.
Hall: The Bootstrap and Edgeworth Expansion.
Hiirdle: Smoothing Techniques: With Implementation in S.
Hart: Nonparametric Smoothing and Lack-of-Fit Tests.
Hartigan: Bayes Theory.
Hedayat!Sloane/Stujken: Orthogonal Arrays: Theory and Applications.
Heyde: Quasi-Likelihood and its Application: A General Approach to Optimal
Parameter Estimation.
Huet/Bouvier/Gruet/Jolivet: Statistical Tools for Nonlinear Regression: A Practical
Guide with S-PLUS Examples.
Kolen/Brennan: Test Equating: Methods and Practices.
Katz/Johnson (Eds.): Breakthroughs in Statistics Volume I.
Katz/Johnson (Eds.): Breakthroughs in Statistics Volume II.
Kotz/Johnson (Eds.): Breakthroughs in Statistics Volume III.
Kiichler/Serensen: Exponential Families of Stochastic Processes.
Le Cam: Asymptotic Methods in Statistical Decision Theory.
Le Cam/Yang: Asymptotics in Statistics: Some Basic Concepts, 2nd edition.
Longford: Models for Uncertainty in Educational Testing.
(continued after index)
Ludwig Fahrmeir
Gerhard Tutz
Multivariate Statistical
Modelling Based on
Generalized Linear Models
Second Edition
With contributions from Wolfgang Hennevogl
With 51 Figures
Ludwig Fahrmeir
Department of Statistics
University of Munich
Ludwigstrasse 33
D-80539 MUnchen
Gerhard Tutz
Department of Statistics
University of Munich
Akademiestr. 1
D-80799 MUnchen
Library of Congress Cataloging-in-Publication Data
Fahrmeir, L.
Multivariate statistic ai modelling based on generaiized linear models I Ludwig
Fahrmeir, Gerhard Tutz.-2nd ed.
(Springer series in statistics)
Includes bibliographical references and index.
ISBN 978-1-4419-2900-6
ISBN 978-1-4757-3454-6 (eBook)
DOI 10.1007/978-1-4757-3454-6
1. Multivariate anaiysis.
2. Linear models (Statistics).
1. Tutz, Gerhard.
II. Title.
III. Series.
QA278.F34 2001
519.5'38-dc21
Printed on acid-free paper.
© 2001, 1994 Springer Seienee+Business Media New York
Originally published by Springer-Verlag New York, Ine in 2001
Softcover reprint ofthe hardeover 2nd edition 2001
AH rights reserved. This work may not be translated or copied in whole or in part without the
written permission of the publisher Springer Science+Business Media, LLC,
except for brief excerpts in connection with reviews or scholarly
anaiysis. Use in connection with any form of information storage and retrievai, electronic
adaptation, computer software, or by similar or dissimilar methodology now known or hereafter developed is forbidden.
The use of general descriptive names, trade names, trademarks, etc., in this publication, even
if the former are not especially identified, is not to be taken as a sign that such names, as
understood by the Trade Marks and Merchandise Marks Act, may accordingly be used freely
Production managed by Allan Abrams; manufacturing supervised by Jerome Basma.
Photocomposed copy prepared from the authors' LaTeX files.
9 8 7 6 5 4 3 2 1
ISBN 978-1-4419-2900-6
SPIN 10789428
Preface to the Second Edition
Since our first edition of this book, many developments in statistical modelling based on generalized linear models have been published, and our
primary aim is to bring the book up to date. Naturally, the choice of these
recent developments reflects our own teaching and research interests.
The new organization parallels that of the first edition. We try to motivate and illustrate concepts with examples using real data, and most data sets
are available on http:/ fwww.stat.uni-muenchen.de/welcome_e.html, with a
link to data archive. We could not treat all recent developments in the main
text, and in such cases we point to references at the end of each chapter.
Many changes will be found in several sections, especially with those
connected to Bayesian concepts. For example, the treatment of marginal
models in Chapter 3 is now current and state-of-the-art. The coverage of
nonparametric and semiparametric generalized regression in Chapter 5 is
completely rewritten with a shift of emphasis to linear bases, as well as new
sections on local smoothing approaches and Bayesian inference. Chapter 6
now incorporates developments in parametric modelling of both time series
and longitudinal data. Additionally, random effect models in Chapter 7
now cover nonparametric maximum likelihood and a new section on fully
Bayesian approaches. The modifications and extensions in Chapter 8 reflect
the rapid development in state space and hidden Markov models. Monte
Carlo techniques, in particular MCMC, are described in greater detail in
the text and in a new appendix. New sections in Chapter 8 extend the main
ideas from state space models with time series or longitudinal data into
models that can accommodate spatial and spatio-temporal data.
We are grateful to Brian Marx for his many helpful suggestions and comments. Tom Santner is also gratefully acknowledged for his careful reading
and corrections. Our thanks are further extended to Michael Schindler for
the typesetting andto Jochen Einbeck, Ludwig Heigenhauser, Andrea Hennerfeind, and Stefan Lang for computational assistance.
Preface to the Second Edition
The support of the Deutsche Forschungsgemeinschaft in the form of
the Sonderforschungsbereich Analysis of Discrete Structures has helped this
second edition into its final form.
Miinchen, Germany
November 23, 2000
Ludwig Fahrmeir
Gerhard Tutz
Preface to the First Edition
Classical statistical models for regression, time series, and longitudinal data
provide well-established tools for approximately normally distributed variables. Enhanced by the availability of software packages, these models dominated the field of applications for a long time. With the introduction of
generalized linear models (GLM), a much more flexible instrument for statistical modelling has been created. The broad class of GLMs includes some
of the classical linear models as special cases but is particularly suited for
categorical discrete or nonnegative responses.
The last decade has seen various extensions of GLMs: multivariate and
multicategorical models have been considered, longitudinal data analysis has
been developed in this setting, random effects and nonparametric predictors
have been included. These extended methods have grown around generalized linear models but often are no longer GLMs in the original sense. The
aim of this book is to bring together and review a large part of these recent
advances in statistical modelling. Although the continuous case is sketched
sometimes, throughout the book the focus is on categorical data. The book
deals with regression analysis in a wider sense, including not only crosssectional analysis but also time series and longitudinal data situations. We
do not consider problems of symmetrical nature, like the investigation of
the association structure in a given set of variables. For example, loglinear models for contingency tables, which can be treated as special cases of
GLMs, are totally omitted. The estimation approach primarily considered
in this book is likelihood-based.
The book is aimed at applied statisticians, graduate students of statistics, and students and researchers with a strong interest in statistics and
data analysis from areas like econometrics, biometrics, and social sciences.
It is written on an intermediate mathematical level with emphasis on basic ideas. Technical and mathematical details are often deferred to starred
sections, and for rigorous proofs the reader is referred to the literature.
In preliminary versions of this book Wolfgang Hennevogl was the third
author. A new job and its challenges reduced his involvement. Nevertheless,
he made valuable contributions, in particular to parts of Section 2.3, Section
4.2, Chapter 7, Section 8.3, Appendices A.3, A.4, and A.5, and to many of
Preface to the First Edition
the examples. in the final stage of the manuscript Thomas Kurtz made
helpful contributions by working out examples and Appendix B.
We are grateful to various colleagues and students in our courses for discussions and suggestions. Discussions with A. Agresti were helpful when the
second author visited the University of Florida, Gainesville. We would like
to thank Renate Meier-Reusch and Marietta Dostert for the skillful typing
of the first version. Moreover, we thank Wolfgang Schneider, Clemens Biller,
Martin KrauB, Thomas Scheuchenpflug, and Michael Scholz for the preparation of later versions. Further we acknowledge the computational assistance
of Christian Gieger, Arthur Klinger, Harald Nase, and Stefan Wagenpfeil.
We gratefully acknowledge support from Deutsche Forschungsgemeinschaft.
For permission to use Tables 1.5, 3.12, 3.13, and 6.1, we are grateful to the
Royal Statistical Society and Biometrika Trust.
We hope you will enjoy the book.
Miinchen and Berlin, Germany
February 2, 1994
Ludwig Fahrmeir
Gerhard Tutz
Wolfgang Hennevogl
Since the first printing of this book, several very readable books and other
important works have been published. We have included some remarks at
the end of each chapter.
Miinchen and Berlin, Germany
May 28, 1997
Ludwig Fahrmeir
Gerhard Tutz
Preface to the Second Edition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Preface to the First Edition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . vii
List of Examples ............................................... xvii
List of Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xxi
List of Tables .................................................. xxv
1. Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.1 Outline and Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Remarks on Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
1.3 Notes and Further Reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
Modelling and Analysis of Cross-Sectional Data: A Review
of Univariate Generalized Linear Models ................ 15
Univariate Generalized Linear Models . . . . . . . . . . . . . . . . . . . . 16
2.1.1 Data........................................... 16
Coding of Covariates. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
Grouped and Ungrouped Data . . . . . . . . . . . . . . . . . . . . 17
2.1.2 Definition of Univariate Generalized Linear Models . . 18
2.1.3 Models for Continuous Responses . . . . . . . . . . . . . . . . . 22
Normal Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
Gamma Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
Inverse Gaussian Distribution . . . . . . . . . . . . . . . . . . . . . 24
2.1.4 Models for Binary and Binomial Responses . . . . . . . . . 24
Linear Probability Model . . . . . . . . . . . . . . . . . . . . . . . . . 25
Probit Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
Logit Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
Complementary Log-Log Model . . . . . . . . . . . . . . . . . . . 26
Complementary Log-Model ....................... 26
Binary Models as Threshold Models of Latent
Linear Models . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
Parameter Interpretation . . . . . . . . . . . . . . . . . . . . . . . . . 29
Overdispersion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
2.1.5 Models for Count Data. . . . . . . . . . . . . . . . . . . . . . . . . . . 36
Log-linear Poisson Model . . . . . . . . . . . . . . . . . . . . . . . . . 36
Linear Poisson Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
2.2 Likelihood Inference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
Maximum Likelihood Estimation . . . . . . . . . . . . . . . . . . 38
Log-likelihood, Score Function and Information Matrix 39
Numerical Computation of the MLE by
Iterative Methods . . . . . . . . . . . . . . . . . . . . . . . . 41
Uniqueness and Existence of MLEs* . . . . . . . . . . . . . . . 43
Asymptotic Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
Discussion of Regularity Assumptions* . . . . . . . . . . . . . 46
Additional Scale or Overdispersion Parameter . . . . . . . 4 7
2.2.2 Hypothesis Testing and Goodness-of-Fit Statistics . . . 47
Goodness-of-Fit Statistics . . . . . . . . . . . . . . . . . . . . . . . . 50
2.3 Some Extensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
Quasi-likelihood Models . . . . . . . . . . . . . . . . . . . . . . . . . . 55
Basic Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
Variance Functions with Unknown Parameters . . . . . . 58
Nonconstant Dispersion Parameter . . . . . . . . . . . . . . . . 59
2.3.2 Bayesian Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
2.3.3 Nonlinear and Nonexponential Family Regression
Models* ........................................ 65
2.4 Notes and Further Reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
Models for Multicategorical Responses: Multivariate
Extensions of Generalized Linear Models . . . . . . . . . . . . . . . . 69
Multicategorical Response Models ........ : . . . . . . . . . . . . . . 70
Multinomial Distribution . . . . . . . . . . . . . . . . . . . . . . . . . 70
3.1.2 Data. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
3.1.3 The Multivariate Model . . . . . . . . . . . . . . . . . . . . . . . . . . 72
3.1.4 Multivariate Generalized Linear Models . . . . . . . . . . . . 75
3.2 Models for Nominal Responses . . . . . . . . . . . . . . . . . . . . . . . . . . 77
3.2.1 The Principle of Maximum Random Utility......... 77
3.2.2 Modelling of Explanatory Variables: Choice of
Design Matrix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
3.3 Models for Ordinal Responses........................... 81
Cumulative Models: The Threshold Approach....... 83
Cumulative Logistic Model or Proportional
Odds Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83
Grouped Cox Model or Proportional Hazards Model . 86
Extreme Maximal-value Distribution Model. . . . . . . . . 86
3.3.2 Extended Versions of Cumulative Models . . . . . . . . . . . 87
3.3.3 Link Functions and Design Matrices for Cumulative
Models ......................................... 88
3.3.4 Sequential Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92
Generalized Sequential Models . . . . . . . . . . . . . . . . . . . . 95
Link Functions of Sequential Models . . . . . . . . . . . . . . . 98
3.3.5 Strict Stochastic Ordering* . . . . . . . . . . . . . . . . . . . . . . . 99
3.3.6 Two-Step Models ................................ 100
Link Function and Design Matrix for
Two-Step Models ........................ 102
3.3. 7 Alternative Approaches .......................... 103
3.4 Statistical Inference .................................... 105
Maximum Likelihood Estimation .................. 105
Numerical Computation .......................... 107
3.4.2 Testing and Goodness-of-Fit ...................... 107
Testing of Linear Hypotheses ..................... 107
Goodness-of-Fit Statistics ........................ 107
3.4.3 Power-Divergence Family* ........................ 109
Asymptotic Properties under Classical "Fixed Cells"
Assumptions ............................ 111
Sparseness and "Increasing-Cells" Asymptotics ...... 112
3.5 Multivariate Models for Correlated Responses ............. 112
Conditional Models .............................. 114
Asymmetric Models ............................. 114
Symmetric Models ............................... 116
3.5.2 Marginal Models ................................ 119
Marginal Models for Correlated Univariate Responses 120
The Generalized Estimating Approach for Statistical
Inference ............................... 123
Marginal Models for Correlated
Categorical Responses .................... 129
Likelihood-based Inference for Marginal Models ..... 135
3.6 Notes and Further Reading ............................. 136
Bayesian Inference ............................... 136
Selecting and Checking Models .......................... 139
4.1 Variable Selection ..................................... 139
4.1.1 Selection Criteria ................................ 140
4.1.2 Selection Procedures ............................. 142
All-Subsets Selection ............................. 142
Stepwise Backward and Forward Selection .......... 143
4.2 Diagnostics ........................................... 145
Diagnostic Tools for the Classical Linear Model ..... 146
4.2.2 Generalized Hat Matrix .......................... 147
4.2.3 Residuals and Goodness-of-Fit Statistics ........... 151
4.2.4 Case Deletion ................................... 156
4.3 General Tests for Misspecification* ...................... 161
Estimation under Model Misspecification ........... 162
4.3.2 Hausman-type Tests ............................. 165
Hausman Tests .................................. 165
Information Matrix Test ......................... 166
4.3.3 Tests for Nonnested Hypotheses ................... 167
Tests Based on Artificial Nesting .................. 168
Generalized Wald and Score Tests ................. 168
4.4 Notes and Further Reading ............................. 170
Bayesian Model Determination .................... 170
Robust Estimates ............................... 172
Model Tests Against Smooth Alternatives .......... 172
Semi- and Nonparametric Approaches to
Regression Analysis ..................................... 173
5.1 Smoothing Techniques for Continuous Responses .......... 17 4
5.1.1 Regression Splines and Other Basis Functions ....... 17 4
Regression Splines ............................... 176
Other Basis Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 78
Regularization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179
5.1.2 Smoothing Splines ............................... 181
5.1.3 Local Estimators ................................ 183
Simple Neighborhood Smoothers .................. 183
Local Regression ................................ 184
Bias-Variance Trade-off .......................... 187
Relation to Other Smoothers ..................... 189
5.1.4 Selection of Smoothing Parameters ................ 190
5.2 Smoothing for Non-Gaussian Data ....................... 193
5.2.1 Basis Function Approach ......................... 193
Fisher Scoring for Penalized Likelihood* ............ 194
5.2.2 Penalization and Spline Smoothing ................ 195
Fisher Scoring for Generalized Spline Smoothing* ... 196
Choice of Smoothing Parameter ................... 197
5.2.3 Localizing Generalized Linear Models .............. 198
Local Fitting by Weighted Scoring ................. 201
5.3 Modelling with Multiple Covariates ...................... 202
Modelling Approaches ........................... 207
Generalized Additive Models ...................... 207
Partially Linear Models .......................... 208
Varying-Coefficient Models ....................... 208
Projection Pursuit Regression ..................... 209
Basis Function Approach ......................... 210
5.3.2 Estimation Concepts ............................. 213
Backfitting Algorithm for Generalized
Additive Models ......................... 213
Backfitting with Spline Functions .................. 217
Choice of Smoothing Parameter ................... 220
Partial Linear Models ............................ 220
5.4 Semiparametric Bayesian Inference for
Generalized Regression ................................. 221
5.4.1 Gaussian Responses ............................. 221
Smoothness Priors Approaches .................... 221
Basis Function Approaches ....................... 227
Models with Multiple Covariates .................. 228
5.4.2 Non-Gaussian Responses ......................... 231
Latent Variable Models for Categorical Responses ... 234
5.5 Notes and Further Reading ............................. 239
6. Fixed Parameter Models for Time Series and
Longitudinal Data ....................................... 241
6.1 Time Series ........................................... 242
Conditional Models .............................. 242
Generalized Autoregressive Models ................ 242
Quasi-Likelihood Models and Generalized Autoregression Moving Average Models ........... 246
6.1.2 Statistical Inference for Conditional Models ......... 249
6.1.3 Marginal Models ................................ 255
Estimation of Marginal Models .................... 258
6.2 Longitudinal Data ..................................... 260
Conditional Models .............................. 261
Generalized Autoregressive Models, Quasi-Likelihood
Models ................................. 261
Statistical Inference .............................. 262
Transition Models ............................... 264
Subject-specific Approaches and
Conditional Likelihood ................... 264
6.2.2 Marginal Models ................................ 267
Statistical Inference .............................. 268
6.2.3 Generalized Additive Models for Longitudinal Data .. 274
6.3 Notes and Further Reading ............................. 278
Random Effects Models ................................. 283
7.1 Linear Random Effects Models for Normal Data ........... 285
Two-stage Random Effects Models ................ 285
Random Intercepts .............................. 286
Random Slopes ................................. 287
Multilevel Models ............................... 288
7.1.2 Statistical Inference .............................. 289
Known Variance-Covariance Components ........... 289
Unknown Variance-Covariance Components ......... 289
Derivation of the EM algorithm* .................. 291
7.2 Random Effects in Generalized Linear Models ............. 292
Generalized Linear Models with Random Effects .... 293
Examples ...................................... 294
7.3 Estimation Based on Posterior Modes .................... 298
7.3.1 · Known Variance-Covariance-components ........... 298
7.3.2 Unknown Variance-Covariance Components ......... 299
7.3.3 Algorithmic Details* ............................. 300
Fisher Scoring for Given Variance-Covariance
Components ............................ 300
EM Type Algorithm ............................. 302
7.4 Estimation by Integration Techniques .................... 303
7.4.1 Maximum Likelihood Estimation of Fixed Parameters 303
Direct Maximization Using Fitting Techniques for
GLMs ..... : ............................ 305
Nonparametric Maximum Likelihood for Finite Mixtures ................................... 308
7.4.2 Posterior Mean Estimation of Random Effects ...... 310
7.4.3 Indirect Maximization Based on the EM Algorithm*. 311
7.4.4 Algorithmic Details for Posterior Mean Estimation* . 315
7.5 Examples ............................................. 318
7.6 Bayesian Mixed Models ................................ 321
Bayesian Generalized Mixed Models ............... 321
Generalized Additive Mixed Models ............... 322
7.7 Marginal Estimation Approach to Random Effects Models .. 325
7.8 Notes and Further Reading ............................. 328
State Space and Hidden Markov Models ................. 331
8.1 Linear State Space Models and the Kalman Filter ......... 332
8.1.1 Linear State Space Models ........................ 332
8.1.2 Statistical Inference .............................. 337
Linear Kalman Filtering and Smoothing ............ 338
Kalman Filtering and Smoothing as Posterior Mode
Estimation* ............................. 340
Unknown Hyperparameters ....................... 342
EM Algorithm for Estimating Hyperparameters* .... 343
8.2 Non-Normal and Nonlinear State Space Models ........... 345
8.2.1 Dynamic Generalized Linear Models ............... 345
Categorical Time Series . . . . . . . . . . . . . . . . . . . . . . . . . . 34 7
8.2.2 Nonlinear and Nonexponential Family Models* ...... 349
8.3 Non-Normal Filtering and Smoothing .................... 350
8.3.1 Posterior Mode Estimation ....................... 351
Generalized Extended Kalman Filter and Smoother* . 352
Gauss-Newton and Fisher-Scoring Filtering and
Smoothing* ............................. 354
Estimation of Hyperparameters* .................. 356
Some Applications ............................... 356
8.3.2 Markov Chain Monte Carlo and Integration-based
Approaches ..................................... 361
MCMC Inference ................................ 362
Integration-based Approaches ..................... 365
8.4 Longitudinal Data ..................................... 369
State Space Modelling of Longitudinal Data ........ 369
8.4.2 Inference For Dynamic Generalized Linear
Mixed Models ................................... 372
8.5 Spatial and Spatia-temporal Data ....................... 376
8.6 Notes and Further Reading ............................. 383
Survival Models ......................................... 385
9.1 Models for Continuous Time ............................ 385
Basic Models ................................... 385
Exponential Distribution ......................... 386
Weibull Distribution ............................. 387
Piecewise Exponential Model ..................... 388
9.1.2 Parametric Regression Models .................... 388
Location-Scale Models for log T ................... 388
Proportional Hazards Models ..................... 389
Linear Transformation Models and Binary
Regression Models ....................... 390
9.1.3 Censoring ...................................... 391
Random Censoring .............................. 391
Type I Censoring ................................ 392
9.1.4 Estimation ..................................... 393
Exponential Model .............................. 394
Weibull Model .................................. 394
Piecewise Exponential Model ..................... 395
9.2 Models for Discrete Time ............................... 396
9.2.1 Life Table Estimates ............................. 397
9.2.2 Parametric Regression Models .................... 400
The Grouped Proportional Hazards Model. ......... 400
A Generalized Version: The Model of Aranda-Ordaz . 402
The Logistic Model .............................. 403
Sequential Model and Parameterization of the
Baseline Hazard ......................... 403
9.2.3 Maximum Likelihood Estimation .................. 404
9.2.4 Time-varying Covariates ......................... 408
Internal Covariates* ............................. 411
Maximum Likelihood Estimation* ................. 412
9.3 Discrete Models for Multiple Modes of Failure ............. 414
Basic Models ................................... 414
9.3.2 Maximum Likelihood Estimation .................. 417
9.4 Smoothing in Discrete Survival Analysis .................. 420
9.4.1 Smoothing Life Table Estimates ................... 420
9.4.2 Smoothing with Covariates ....................... 422
9.4.3 Dynamic Discrete-Time Survival Models ........... 423
Posterior Mode Smoothing ....................... 423
Fully Bayesian Inference via MCMC ............... 425
9.5 Remarks and Further Reading .......................... 429
. ........................................................ 433
A.l Exponential Families and Generalized Linear Models ....... 433
A.2 Basic Ideas for Asymptotics ............................. 437
A.3 EM Algorithm ........................................ 442
A.4 Numerical Integration .................................. 443
A.5 Monte Carlo Methods .................................. 449
B. Software for Fitting Generalized Linear Models
and Extensions .......................................... 455
Bibliography .................................................. 467
Author Index .................................................. 505
Subject Index ................................................. 512
List of Examples
Caesarian birth study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Credit-scoring . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Cellular differentiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Job expectation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Breathing test results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Visual impairment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Rainfall data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Polio incidence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
IFO business test . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
Ohio children . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
Duration of unemployment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
Caesarian birth study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
Credit-scoring . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
Cellular differentiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
Caesarian birth study (Example 2.1, continued) . . . . . . . . . . . . . 51
Credit-scoring (Example 2.2, continued) . . . . . . . . . . . . . . . . . . . . 53
Cellular differentiation (Example 2.3, continued) . . . . . . . . . . . . . 53
Cellular differentiation (Examples 2.3, 2.6, continued) . . . . . . . 59
Caesarian birth study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
Breathing test results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
Job expectation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
Breathing test results (Example 3.2, continued) . . . . . . . . . . . . . 89
Job expectation (Example 3.3, continued) . . . . . . . . . . . . . . . . . . 91
Tonsil size . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93
Tonsil size (Example 3.6, continued) . . . . . . . . . . . . . . . . . . . . . . . 96
Breathing test results (Examples 3.2 and 3.4, continued). . . . . . 96
Rheumatoid arthritis .................................... 100
Rheumatoid arthritis (Example 3.9, continued) ............. 101
Caesarian birth study (Example 3.1, continued) ............. 108
Reported happiness ..................................... 115
Visual impairment ...................................... 127
List of Examples
Forest damage .......................................... 131
Credit-scoring (Examples 2.2, 2.5, continued) ............... 144
Vaso constriction ....................................... 148
Job expectation (Examples 3.3, 3.5, continued) ............. 149
Vaso constriction (Example 4.2, continued) ................. 154
Job expectation (Examples 3.3, 3.5, 4.3, continued) ......... 156
Vaso constriction (Examples 4.2, 4.4, continued) ............ 160
Job expectation (Examples 3.3, 3.5, 4.3, 4.5, continued) ...... 161
Credit-scoring (Examples 2.2, 2.5, 4.1, continued) ........... 170
Motorcycle data ........................................ 174
Rainfall data ........................................... 197
Short-term unemployment ................................ 202
Rainfall data (Example 5.2, continued) .................... 202
Vaso constriction data (Examples 4.2, 4.4, continued) ........ 204
Chronic bronchitis ....................................... 210
Women's role in society .................................. 211
Vaso constriction data (Example 5.5, continued) ............ 220
Rental rates ............................................ 230
Credit scoring revisited .................................. 236
Polio incidence in the United States ....................... 252
Polio incidence in the United States (Example 6.1, continued) 259
IFO business test ....................................... 265
Ohio children ........................................... 271
A longitudinal study on forest damage ..................... 275
Ohio children data (Example 6.4, continued) ............... 292
Bitterness of white wines ................................ 292
Ohio children data (Example 7.1, continued) ............... 318
Bitterness of white wines (Example 7.2, continued) .......... 319
Longitudinal study on forest damage (Example 6.5, continued) 323
Rainfall data (Example 5.2, continued) ..................... 356
Advertising data ........................................ 358
Phone calls ............................................. 360
Rainfall data (Example 8.1, continued) .................... 367
Weekly incidence of AHC ................................. 368
Business test (Example 6.3, continued) .................... 373
Rents for flats (Example 5.9, continued) .................... 381
List of Examples
Duration of unemployment ............................... 399
Duration of unemployment (Example 9.1, continued) ........ 407
Duration of unemployment (Example 9.2, continued) ........ 418
Duration of unemployment: A spatia-temporal analysis ....... 425
Head and neck cancer ................................... 428
List of Figures
Number of occurences of rainfall in the Tokyo area for each calendar day 1983-1984. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Monthly number of polio cases in the United States from 1970
to 1983. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
The gamma distribution: G(f..l = 1, v). . . . . . . . . . . . . . . . . . . . . . . . . 24
Response functions for binary responses. . . . . . . . . . . . . . . . . . . . . . 27
Response functions for binary responses adjusted to the logistic
function (that means linear transformation yielding mean zero
and variance 1r2 /3). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
2.4 Log-likelihood and quadratic approximation for Wald test and
slope for score test. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
Densities of the latent response for two subpopulations with
different values of x (logistic, extreme minimal-value, extreme
maximal-value distributions). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85
3.2 Frequency distribution of damage classes ...................... 132
Index plot of hii for vasoconstriction data .................... 150
4.2 Index plot of tr(Hii) and ( Hii) for grouped job expectation data. 151
4.3 Index plot of rf, rfs, and rf for vaso constriction data ......... 155
4.4 N(O, !)-probability plot of rfs for vasoconstriction data ........ 155
Relative frequencies and response curve of the fitted cumulative
logistic mode .............................................. 157
4.6 Index plot of (rf,8 )' (r[8 ) for grouped job expectation data ....... 158
4.7 x2(2)-probability plot of (rf,8 )'(r[s) for grouped job expectation
data ...................................................... 159
4.8 Index plot of Ci,l and ci for vaso constriction data .............. 160
4.9 Index plot of ci,l and Ci for grouped job expectation data ....... 162
Smoothed estimates for motorcycle data showing time and head
acceleration after a simulated impact ......................... 175
List of Figures
5.2 Illustration of B-splines bases, one isolated and several overlapping ones for degree 1 and degree 2. . ........................ 177
5.3 Smoothed probability of rainfall A = 4064 ..................... 199
5.4 Smoothed probability of rainfall A = 32 ....................... 199
5.5 Generalized cross-validation criterion, with logarithmic scale for A.200
5.6 Probability of short-term unemployment estimated by the parametric logit model, P-splines, smoothing splines, and local likelihood with the smooth estimates determined by the AIC criterion. 203
5.7 Number of observations of unemployment data for given age
groups .................................................... 203
5.8 Probability of short term unemployment with same degree of
smoothing for smooth estimates. . ........................... 204
5.9 Local fit of logit model for Tokyo rainfall data ................. 205
5.10 Cross-validation for local fit for Tokyo rainfall data ............. 205
5.11 Response surface for the nonoccurrence of vaso constriction
based on the local fit of a logit model. ........................ 206
5.12 Response surface for the nonoccurrence of vaso constriction
based on a fitted logit model. ............................... 206
5.13 Effects of concentration of dust and exposure time on the probability of chronic bronchitis for the generalized additive logit
model. ................................................... 211
5.14 Local linear fit of f(dust,years) with nearest neighborhood to
probability of chronic bronchitis. . ........................... 212
5.15 Local likelihood estimates of intercept and slope for gender varying across years of education compared with estimates for the
linear model within each gender group ........................ 214
5.16 Fitted probabilities for women and men based on local likelihood
and parametric model with pointwise error bands 1.96 * standard
error ..................................................... 215
5.17 Nonoccurrence of vaso constriction of the skin smoothed by an
additive model with A1 = A2 = 0.001. ........................ 222
5.18 Nonoccurrence of vasoconstriction of the skin smoothed by an
additive model with Al = A2 = 0.003. . ....................... 222
5.19 Estimated effects of floor space and year of construction for the
rent data. Shown are the posterior means within 80% credible
regions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 232
5.20 Estimated effects of duration and amount of credit ............. 238
Monthly number of polio cases in the United States from 1970
to 1983 ................................................... 254
6.2 Predicted polio incidence fJt based on a log-linear AR(l = 5)model fit .................................................. 255
6.3 Damage class distribution by time. . ......................... 277
List of Figures
6.4 Estimated global odds ratios (lines) and empirically observed
global odds ratios (points). Note that there is a different scale
for the combination l = 2, r = 1. ............................. 279
6.5 Estimated thresholds A(t) (left plot) and ]2(t) (right plot) with
pointwise standard error bands (model based - dashed line, robust- boundary of shaded region) ........................... 280
6.6 Estimated effects of age and pH value with pointwise standard
error bands ............................................... 280
6.7 Estimated probabilities pr(Yi = l),pr(Yi = 2), and pr(Yi = 3)
for age. From top to bottom: up to 50 years; between 50 and 120
years; above 120 years ...................................... 281
Relative frequency of the response "damage state" over the years. 324
7.2 Estimated nonparametric functions for the forest damage data.
Shown are the posterior means with 80% credible regions. . ..... 324
Number of occurrences of rainfall in the Tokyo area for each
calendar day during 1983-1984 .............................. 357
8.2 Smoothed probabilities it of daily rainfall, obtained by generalized Kalman and Gauss-Newton smoothing .................... 357
8.3 Smoothed trend and advertising effect ........................ 359
8.4 Advertising data and fitted values ............................ 359
8.5 Number of phone calls for half-hour intervals .................. 360
8.6 Observed and fitted values .................................. 362
8. 7 Tokyo rainfall data ......................................... 368
8.8 AHC data. Data and fitted probabilities (posterior median within
50%, 80%, and 95% credible regions) ......................... 370
8.9 Estimates of trends and thresholds ........................... 376
8.10 Plot of the estimates of bi1 against bi2 for each unit ............ 377
8.11 Estimated time-changing covariate effects. Dashed vertical lines
represent the month January of each year. .................... 377
8.12 Estimated time-changing covariate effect of G+. Dashed vertical
lines represent the month January of each year ................ 378
8.13 Posterior means of spatial effects ............................. 381
9.1 Life table estimate for unemployment data .................... 400
9.2 Estimated survival function for unemployment data ............ 401
9.3 Life table estimate for duration of unemployment with causes
full-time job (category 1) or part-time job (category 2) ......... 420
9.4 Estimated nonparametric functions and seasonal effect. Shown
are the posterior means within 80% credible regions ............ 426
List of Figures
9.5 Posterior mean and posterior probabilities of the district-specific
effect ..................................................... 427
9.6 Cubic-linear spline fit for head and neck cancer data and posterior mode smoother with ± standard deviation confidence bands.431
9. 7 Smoothed kernel estimate for head and neck cancer data ........ 431
List of Tables
1.1 Data on infection from 251 births by Caesarian section . . . . . . . . .
1.2 Cellular differentiation data. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.3 Grouped data for job expectations of psychology students in Regensburg . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.4 Breathing results of Houston industrial workers . . . . . . . . . . . . . . .
1.5 Visual impairment data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.6 Presence and absence of respiratory infection. . . . . . . . . . . . . . . . . . 12
Simple exponential families with dispersion parameter.. . . . . . . . . 21
2.2 Grouped data on infection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
2.3 Cellular differentiation data. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
2.4 Logit model fit to Caesarian birth study data . . . . . . . . . . . . . . . . . 51
2.5 Logit model fit to credit-scoring data . . . . . . . . . . . . . . . . . . . . . . . . 54
2.6 Log-linear model fits to cellular differentiation data based on
Poisson-likelihoods. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
2.7 Log-linear model fits to cellular differentiation data based on
quasi-likelihoods... . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
3.1 Breathing results of Houston industrial workers . . . . . . . . . . . . . . . 81
3.2 Grouped data for job expectations of psychology students in Regensburg . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
3.3 Estimates of cumulative models for breathing test data (p-values
in each second column)..................................... 90
3.4 Cumulative model for job expectation data (p-values are given
in brackets) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92
3.5 Tonsil size and Streptococcus pyogenes 93
3.6 Fits for tonsil size data. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97
3. 7 Sequential logit models for the breathing test data (p-values in
brackets) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
3.8 Clinical trial of a new agent and an active control ............. 100
3.9 Analysis of clinical trial data on rheumatoid arthritis .......... 102
List of Tables
3.10 Cross classification of gender, reported happiness, and years of
schooling ................................................. 115
3.11 Estimates for the cross classification of gender, reported happiness and years of schooling .................................. 117
3.12 Visual impairment data .............. 127
3.13 Estimation results for visual impairment data ................. 128
3.14 Parameter estimates and standard errors ..................... 133
4.1 Logit model fit to credit-scoring data ........................ 144
4.2 Vasa constriction data ..................................... 149
4.3 Logit model fit to vasa constriction data ...................... 150
5.1 Estimates of selected covariate effects ........................ 231
5.2 Estimates of constant parameters for the credit-scoring data .... 237
6.1 Monthly number of poliomyelitis cases in the United States for
1970 to 1983 .............................................. 253
6.2 Log-linear AR(5) model fit to polio data ...................... 254
6.3 Log-linear AR(l) model fits to polio data ..................... 256
6.4 Marginal model fit for polio data ............................ 260
6.5 Variables and questions of the IFO business test ............... 266
6.6 Estimates of main effects ................................... 267
6. 7 Presence and absence of respiratory infection .................. 271
6.8 Marginallogit model fits for Ohio children data ............... 272
6.9 Main effects model fits for Ohio children data ................. 273
6.10 Effects of canopy density ................................... 278
7.1 Bitterness of wine data ...................... 293
7.2 Random intercept logit model for Ohio children data (effect coding of smoking and age, standard deviations in parentheses) .... 318
7.3 ML estimates for Ohio children data based on finite mixtures ... 319
7.4 Estimation results of bitterness-of-wine data .................. 320
7.5 Estimates of constant parameters for the forest damage data .... 325
9.1 Duration of unemployment ................................. 409
9.2 Estimates of cause-specific logistic model for duration of unemployment data ............................................. 419
9.3 Estimates of constant parameters in the unemployment data .... 429
9.4 Head and neck cancer .......................... 430