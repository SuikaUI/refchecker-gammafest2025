Error mitigation for short-depth quantum circuits
Kristan Temme, Sergey Bravyi and Jay M. Gambetta
IBM T.J. Watson Research Center, Yorktown Heights NY 10598
 
Two schemes are presented that mitigate the effect of errors and decoherence in short-depth quantum circuits.
The size of the circuits for which these techniques can be applied is limited by the rate at which the errors in
the computation are introduced. Near-term applications of early quantum devices, such as quantum simulations,
rely on accurate estimates of expectation values to become relevant. Decoherence and gate errors lead to wrong
estimates of the expectation values of observables used to evaluate the noisy circuit. The two schemes we
discuss are deliberately simple and don’t require additional qubit resources, so to be as practically relevant in
current experiments as possible. The ﬁrst method, extrapolation to the zero noise limit, subsequently cancels
powers of the noise perturbations by an application of Richardson’s deferred approach to the limit. The second
method cancels errors by resampling randomized circuits according to a quasi-probability distribution.
From the time quantum computation generated wide spread
interest, the strongest objection to its viability was the sensitivity to errors and noise. In an early paper, William Unruh
 found that the coupling to the environment sets an ultimate time and size limit for any quantum computation. This
initially curbed the hopes that the full advantage of quantum
computing could be harnessed, since it set limits on the scalability of any algorithm. This problem was, at least in theory,
remedied with the advent of quantum error correction .
It was proven that if both the decoherence and the imprecision
of gates could be reduced below a ﬁnite threshold value, then
quantum computation could be performed indeﬁnitely .
Although it is the ultimate goal to reach this threshold in an
experiment that is scalable to larger sizes, the overhead that is
needed to implement a fully fault-tolerant gate set with current codes seems prohibitively large . In turn, it is
expected that in the near term the progress in quantum experiments will lead to devices with dynamics, which are beyond
what can be simulated with a conventional computer. This
leads to the question: what computational tasks could be accomplished with only limited, or no error correction?
The suggestions of near-term applications in such quantum devices mostly center around quantum simulations with
short-depth circuit and approximate optimization algorithms .
Furthermore, certain problems in material
simulation may be tackled by hybrid quantum-classical algorithms . In most such applications, the task can be abstracted to applying a short-depth quantum circuits to some
simple initial state and then estimating the expectation value
of some observable after the circuit has been applied. This estimation must be accurate enough to achieve a simulation precision comparable or exceeding that of classical algorithms.
Yet, although the quantum system evolves coherently for the
most part of the short-depth circuit, the effects of decoherence
already become apparent as an error in the estimate of the observable. For the simulation to be of value, the effect of this
error needs to be mitigated.
In this paper we introduce two techniques for quantum
error mitigation that increase the quality of any such shortdepth quantum simulations.
We ﬁnd that the accuracy of
the expectation value can be increased signiﬁcantly in the
presence of noise.
We are looking for error mitigation
techniques that are as simple as possible and don’t require
additional quantum resources. Both techniques require that
some noise parameter taken together with system size and
circuit depth can be considered a small number.
scheme does not make any assumption about the noise model
other than it being weak and constant in time. In comparison,
the second scheme can tolerate stronger noise; however, it
requires detailed knowledge of the noise model.
Extrapolation to the zero noise limit: It is our goal to estimate the expectation value of some quantum observable A
with respect to an evolved state ρλ(T) after time T that is
subject to noise characterized by the parameter λ in the limit
where λ →0. To achieve this, we apply Richardson’s deferred approach to the limit to cancel increasingly higher orders of λ .
Although gates are typically used to describe quantum circuits, for our analysis it is more convenient to consider the
time-dependent Hamiltonian dynamics implementing the circuit. The time-dependent multi-qubit Hamiltonian is denoted
It can be expanded into N - qubit Pauli operators Pα ∈⟨1, Xj, Yj, Zj⟩j=1...N, where Xj, Yj, Zj acts as a
single-qubit Pauli matrix on site j and trivially elsewhere. We
allow for time-dependent coupling coefﬁcients Jα(t) ∈R.
The circuit is encoded as K(t) = P
α Jα(t)Pα. The total
evolution of the open system with initial state ρ0 will be described by an equation of the following form:
∂tρ(t) = −i[K(t), ρ(t)] + λL(ρ(t))
for time t ∈[0, T]. We do not specify the exact form of the
generator L(ρ) but only require that it is invariant under time
rescaling and independent from the parameters Jα(t) in K(t).
The noise term L(ρ) could be given as a Lindblad operator, or
it could correspond to a Hamiltonian that couples to a bath
to model non-Markovian dynamics. We ask that there is a
parameter λ ≪1 that indicates a weak action of the noise and
that we can bound ∥LI,t1 ◦LI,t2 ◦. . .◦LI,tn(ρ)∥1 ≤ln, where
at most ln = O(N n). The map LI,t is short-hand notation for
the transformation of L into the interaction frame generated
 
The expectation value of the observable A is obtained from
the ﬁnal state ρλ(T) as EK(λ) = tr (Aρλ(T)). The function
EK(λ) can be expressed as a series in λ where the contribution with λ0 corresponds to the noise-free evolution. This
can be seen by transforming the evolution into the interaction frame w.r.t K(t) and expanding the Born series, c.f.
supp. mat. sec I. Starting from the noise-free expectation value
E∗= tr (Aρ0(T)), the expansion is given by
EK(λ) = E∗+
akλk + Rn+1(λ, L, T).
The ak are model-speciﬁc constants typically growing like
Here Rn+1(λ, L, T) is the remainder of
the expansion and can be bounded by |Rn+1(λ, L, T)| ≤
∥A∥ln+1(λT)n+1/(n + 1)! by standard arguments. Since we
assumed an extensive scaling of ln, such an expansion is only
meaningful whenever NTλ is small. We are of course interested in limλ→0 EK(λ) = E∗; however, we are faced with
a small but ﬁnite parameter λ. Since we only have access to
EK(λ), our estimate of E∗will be off by O(λ).
This estimate can be improved by Richardson’s deferred
approach to the limit . To explain the idea, let us assume we can run the quantum circuit at different noise rates
λj, with j = 0, . . . , n and obtain experimental estimates
ˆEK(λj) = EK(λj)+δj. Here the λj = cjλ are appropriately
rescaled values of the experimental noise rate λ. The estimate
deviates from the actual expectation value due to experimental inaccuracies and ﬁnite sampling errors by an error δj. The
estimate of E∗can be signiﬁcantly improved by considering
the approximation ˆEn
K(λ), which is written as the linear combination
γj ˆEK(cjλ).
Here we require the coefﬁcients γj to satisfy the linear system
of equations .
for k = 1 . . . n.
The linear combination Eq. (3) will be an approximation to
E∗up to an error of order O(λn+1).
To obtain estimates at different noise rates λj, we use a
rescaling trick. We run the same circuit n + 1 times with
rescaled parameters in K(t). We follow the protocol:
1. For j = 0, . . . , n
(a) choose a rescaling coefﬁcient cj > 1 (c0 = 1)
and evolve ρ0 with rescaled Hamiltonian Kj(t) =
α(t)Pα, where
α(t) = c−1
for time Tj = cjT.
(b) Estimate observable A to obtain ˆEK(cjλ).
2. Solve equations (4) and compute ˆEn
K(λ) as in Eq. (3).
A rescaling of the equations shows that the state ρj
which evolves under ˙ρj
λ = −i[Kj(t), ρj] + λL(ρj) for time
Tj, satisﬁes ρj
λ(Tj) = ρcjλ(T), c.f. supp. mat. sec. II. Hence
the estimates ˆEK(cjλ) = tr
+ δj can be obtained
from the n + 1 runs rescaled according to the protocol.
If the protocol is performed for n + 1 steps, the error
between the exact expectation value E∗and the estimator
K(λ) can be bounded by
δ∗+ ∥A∥ln+1(λT)n+1
Here Γn = Pn
j=0 |γj|cn+1
and δ∗= maxj |δj| is the largest
experimental error.
This follows from repeated application of the triangle inequality,
c.f. supp. mat. sec. III. The equations
(4) can be solved, and one ﬁnds that the coefﬁcients
m̸=j cm(cj −cm)−1, so that the constant Γn can
be evaluated.
In the literature , several choices for
progression of cj are common. The two most frequent series
are exponential decrease (Bulirsch - Stoer) and harmonic
decay. In our experiments we are actually increasing the noise
rate starting from the optimal value, wheres it is common in
the numerical literature to improve the small parameter. The
result is, of course, the same.
Examples : To demonstrate this method we will consider
three numerical examples.
In all the examples the time
evolution is given by a Hamiltonian K(t) that encodes a
control problem.
For a single drift step we evolve with a
Hamiltonian KR(t) = UN(θ)K0U †
N(θ), where the single
qubit product unitary UN(θ) ∈SU(2)⊗N is chosen Haarrandom, and the drift Hamiltonian K0 = P
i,j Ji,jXiZj is
chosen with respect to a random graph and Gaussian distributed couplings Ji,j. The evolution is subject to three different noise models: ﬁrst Fig 1(a), we evolve in the presence of depolarizing noise described by the sum of single
qubit generators Li = −λ(2−1tri (ρ) −ρ) acting on all
Second, Fig 1(b), we consider dephasing and
amplitude damping noise on every qubit, where we have
chosen a ratio of λ1/λ2
= 1.5 with a generator Li
+ λ2 (ZiρZi −ρ) and σ±
2−1(Xi ± iYi). Third, Fig 1(c), we consider a highly non-
Markovian setting, where each of the N qubits i is coupled
to its own single-qubit bath bi via the Hamiltonian Vi =
1/2 Xi ⊗Xbi + 1/2 Zbi and the bath is prepared in the initial
state ρB = (2 cosh(β/2))−N exp(−β P
bi). Then, after
the evolution of each noisy circuit T = td we measure a randomly chosen multi-qubit Pauli operator Pα.
The graphs in Fig 1 show that with modest effort very high
precisions can be obtained. In the low noise range ϵ ∼10−3
Depolarizing noise
Ampl. Damp / Dephasing
non - Markovian
FIG. 1. (color online) The plots show a random Hamiltonian evolution for N = 4 system qubits and d = 6 drift steps, each for time
t = 2. For all systems plot the error ∆E = |E∗−ˆEn
n = 0, 1, 2, 3. Here λ1, n = 0 corresponds to the uncorrected error. The noise parameter λ = −1/2 log(1 −ϵ) is chosen so that
all plots have the same perturbation measured in the depolarizing
strength ϵ = 10−3 . . . 10−2. The plot shows the mitigation of (a)
Depolarizing noise (b) Amplitude damping / dephasing noise and (c)
non-Markovian noise, for {cj} chosen as random partition of in the
interval .
the relative error can be reduced to ∆E ∼10−6 −10−11.
The precision is then essentially determined by the sampling
error δ∗, which we have neglected in the plots.
Probabilistic error cancellation: Here we discuss a noise
reduction scheme for quantum circuits subject to a Markovian noise. First let us state our assumptions on the noise
model. A noisy N-qubit device will be described by a basis set of noisy operations Ω= {O1, . . . , Om} that can be
implemented on this device. Each operation Oα is a tracepreserving completely positive (TPCP) map on N qubits that
acts non-trivially only on a small subset of qubits, say at
most two. For example, Oα could be a noisy unitary gate
applied to a speciﬁed pair of qubits or a noisy qubit initialization.
We assume that noise in the system can be fully
characterized such that the map Oα is known for each α. A
circuit of length L in the basis Ωis a sequence of L operations from Ω. Let ΩL be a set of all length-L circuits in
the basis Ω. A circuit α = (α1, . . . , αL) implements a map
Oα = OαL · · · Oα2Oα1. The expectation value of an observable A on the ﬁnal state produced by a noisy circuit α is
A Oα(|0⟩⟨0|⊗n)
For simplicity, we ignore errors in the initial state preparation
and in the ﬁnal measurement. Such errors can be accounted
for by adding dummy noisy operations before each measurement and after each qubit initialization. Furthermore, we shall
assume that A is diagonal in the Z-basis and ∥A∥≤1.
Below we show that under certain conditions the task of
simulating an ideal quantum circuit can be reduced to estimating the expectation value E(α) for a suitable random ensemble of noisy quantum circuits α. Moreover, the ideal and
the noisy circuits act on the same number of qubits and have
the same depth.
Let Γ = {U1, . . . , Uk} be a ﬁxed basis set of ideal gates.
Each gate Uβ(ρ) = UβρU †
β is described by a unitary TPCP
map on N qubits that acts non-trivially on a small subset of
qubits. An ideal length-L circuit in the basis Γ is a sequence
of L gates from Γ. A circuit β = (β1, . . . , βL) implements a
map Uβ = UβL · · · Uβ2Uβ1. Deﬁne an ideal expectation value
E∗(β) = Tr
A Uβ(|0⟩⟨0|⊗n)
We consider a simulation task where the goal is to estimate
E∗(β) with a speciﬁed precision δ.
The key idea of our scheme is to represent the ideal circuit
as a quasi-probabilistic mixture of noisy ones. Let us say that
a noisy basis Ωsimulates an ideal circuit β with the overhead
γβ ≥1 if there exists a probability distribution Pβ(α) on the
set of noisy circuits α ∈ΩL such that
Pβ(α)σβ(α)Oα
for some coefﬁcients σβ(α) = ±1. We also require that the
distribution Pβ(α) is sufﬁciently simple so that one can ef-
ﬁciently sample α from Pβ(α). The coefﬁcients γβ, σβ(α)
must be efﬁciently computable. We shall refer to Eq. (41) as a
quasi-probability representation (QPR) of the ideal circuit β.
Note that γβ ≥1 because Uβ and Oα are trace-preserving.
Quasi-probability distributions have been previously used to
construct classical algorithms for simulation of quantum circuits . Our work can be viewed as an application of
these methods to the problem of simulating ideal quantum circuits by noisy ones.
Substituting Eq. (41) into the deﬁnition of E∗(β) gives
E∗(β) = γβ
Pβ(α)σβ(α)E(α).
Let α ∈ΩL be a random variable drawn from Pβ(α) and x ∈
{0, 1}n be the ﬁnal readout of the noisy circuit α obtained by
measuring each qubit of the ﬁnal state Oα(|0⟩⟨0|⊗n) in the
Z-basis. Note that ⟨x|A|x⟩is an unbiased estimator of E(α)
with the variance O(1). Thus from Eq. (42) one infers that
γβσβ(α)⟨x|A|x⟩is an unbiased estimator of the ideal expectation value E∗(β) with the variance O(γ2
β). We can now
estimate E∗(β) with any desired precision δ by the Monte
Carlo method. Deﬁne
M = (δ−1γβ)2
and generate M samples α1, . . . , αM ∈ΩL drawn from
Pβ(α). By Hoeffding’s inequality, E∗(β) is approximated
within error O(δ) w.h.p. by a random variable
ˆE(β) = γβ
σβ(αa)⟨xa|A|xa⟩,
where xa ∈{0, 1}n is the ﬁnal string of the noisy circuit
αa. Computing the estimator ˆE(β) requires M runs of the
noisy circuits, with each run producing a single readout string
xa. Estimating E∗(β) with a precision δ in the absence of
noise by Monte Carlo method would require approximately
δ−2 runs. Thus the quantity γ2
β determines the simulation
overhead (see Eq. (9)).
A systematic method of constructing QPRs with a small
overhead is given in supp. mat. sec. IV. Here we illustrate the
method using toy noise models usually studied in the quantum
fault-tolerance theory: the depolarizing noise and the amplitude damping noise. For concreteness, we choose the ideal
gate set Γ as the standard Clifford+T basis.
Let Dk be the depolarizing noise on k = 1, 2 qubits that
returns the maximally mixed state with probability ϵ and does
nothing with probability 1 −ϵ. Deﬁne a noisy version of a kqubit unitary gate U as DkU. The noisy basis Ωis obtained by
multiplying ideal gates on the left by arbitrary Pauli operators
and adding the depolarizing noise. Thus Ωis a set of operations Oα = DkPU, where U ∈Γ is a k-qubit ideal gate and
P ∈{I, X, Y, Z}⊗k is a Pauli TPCP map. The random ensemble of noisy circuits Oα that simulates an ideal circuit Uβ
is constructed in three steps: (1) Start from the ideal circuit,
Oα = Uβ. (2) Modify Oα by adding a Pauli X, Y, Z after
each single-qubit gate with probability p1 = ϵ/(4 + 2ϵ). The
gate is unchanged with probability 1−3p1. (3) Modify Oα by
adding a Pauli IX, IY, . . . , ZZ after each CNOT with probability p2 = ϵ/(16+14ϵ). The CNOT is unchanged with probability 1 −15p2. The resulting circuit is then implemented on
a noisy device (which adds the depolarizing noise after each
gate) and the ﬁnal readout string x is recorded. By generating
M samples of x one can estimate E∗(β) from Eq. (10). The
sign function σβ(α) is equal to (−1)r, where r is the number of Pauli operators added to the ideal circuit Uβ. As shown
in supp. mat. sec. IV, the above deﬁnes a QPR of the ideal
circuit Uβ with the overhead γβ ≈1 + ϵ(3L1/2 + 15L2/8),
where L1 is the number of single-qubit gates and L2 is the
number of CNOTs in the ideal circuit. The method has been
tested numerically for random noisy Clifford+T circuits, see
A more interesting example is the noise described by
the amplitude-damping channel A that resets every qubit
to its ground state with probability ϵ. A noisy version of a
k-qubit unitary gate U is deﬁned as A⊗kU. In contrast to the
previous example, noisy unitary gates A⊗kU alone cannot
simulate any ideal unitary gate since A is not a unital map. To
overcome this, we extend the noisy basis Ωby adding noisy
versions of single-qubit state preparations AP|ψ⟩, where P|ψ⟩
maps any input state to |ψ⟩⟨ψ|. Our scheme requires state
preparations for single qubit states |ψ⟩= |+⟩, |−⟩, |0⟩, |1⟩
that can be performed at any time step (not only at the
beginning). In supp. mat. sec. V we show how to construct
a QPR of the ideal Clifford+T circuit Uβ with the overhead
γβ ≈1 + ϵ(2L1 + 4L2). The examples considered above
suggest that well-characterized noisy circuits can simulate
ideal ones with overhead γ ≈(1+cϵ)L, where ϵ is the typical
error rate and c is a small constant. The value of c can be
determined by performing quantum process tomography 
Simulation precision
Number of simulated circuits
mitigation off
mitigation on
FIG. 2. Simulation precision δ(β) = | ˆE(β) −E∗(β)| for 500 randomly generated ideal Clifford+T circuits on N = 6 qubits with
depth d = 20. The gates are subject to single- and two-qubit depolarizing noise ϵ = 10−2. The ﬁgure shows results for simulations without (a) and with (b) error cancellation. In both cases each
ideal circuit was simulated by M = 4000 runs of the noisy circuit. For each circuit Uβ we deﬁned the observable A as a projector
Πout onto the subset of 2N−1 basis vectors with the largest weight
in the ﬁnal state. The results are consistent with γβ ≈4.3 so that
γβM −1/2 ≈0.07.
and ﬁnding the QPR for each ideal gate.
Using Eq. (9),
one can estimate the number of noisy circuit runs of length
L as M ∼exp (2cϵL). Assuming error rates in the range
ϵ ∼10−3, it may be possible to simulate ideal circuits with
O(103) gates.
Conclusions: Both error mitigation schemes require no
additional quantum hardware such as ancilla or code qubits
and work directly with the physical qubits. The zero-noise extrapolation requires sufﬁcient control of the time evolution to
implement the rescaled dynamics and hinges on the assumption of a large time-scale separation between the dominant
noise and the controlled dynamics. For the probabilistic error
cancellation a full characterization of the noisy computational
operations is necessary.
To obtain this to a precision of
∼10−3 is challenging in practice. However, if one is willing
to sacriﬁce optimality, a Pauli- or Clifford-twirling 
can be applied that converts any noise channel into a simple
mixture of Pauli errors or depolarizing noise, making the
characterization task much more manageable. A very recent
independent paper by Li and Benjamin discusses similar
issues to those addressed here.
Acknowledgements: We thank Antonio Mezzacapo for insightful discussions, and we acknowledge support from the
IBM Research Frontiers Institute
 W. G. Unruh, Physical Review A 51, 992 .
 P. W. Shor, Physical review A 52, R2493 .
 A. M. Steane, Physical Review Letters 77, 793 .
 A. R. Calderbank and P. W. Shor, Physical Review A 54, 1098
 D. Aharonov and M. Ben-Or, in Proceedings of the twenty-ninth
annual ACM symposium on Theory of computing 
pp. 176–188.
 A. Y. Kitaev, Russian Mathematical Surveys 52, 1191 .
 A. G. Fowler, M. Mariantoni, J. M. Martinis, and A. N. Cleland, Physical Review A 86, 032324 .
 N. C. Jones, R. Van Meter, A. G. Fowler, P. L. McMahon,
J. Kim, T. D. Ladd, and Y. Yamamoto, Physical Review X 2,
031007 .
 S. J. Devitt, A. M. Stephens, W. J. Munro, and K. Nemoto,
Nature communications 4 .
 A. Peruzzo, J. McClean, P. Shadbolt, M.-H. Yung, X.-Q. Zhou,
P. J. Love, A. Aspuru-Guzik, and J. L. O?Brien, Nature communications 5 .
 J. R. McClean, J. Romero, R. Babbush, and A. Aspuru-Guzik,
arXiv preprint arXiv:1509.04279 .
 D. Wecker, M. B. Hastings, and M. Troyer, Physical Review A
92, 042303 .
 E. Farhi, J. Goldstone,
and S. Gutmann, arXiv preprint
 
 B. Bauer, D. Wecker, A. J. Millis, M. B. Hastings,
M. Troyer, arXiv preprint arXiv:1510.03859 .
 L. F. Richardson and J. A. Gaunt, Philosophical Transactions of
the Royal Society of London. Series A, containing papers of a
mathematical or physical character 226, 299 .
 A. Sidi, “Practical extrapolation methods: Theory and applications, volume 10 of cambridge monographs on applied and
computational mathematics,” .
 H. Pashayan, J. J. Wallman, and S. D. Bartlett, Physical review
letters 115, 070501 .
 N. Delfosse, P. A. Guerin, J. Bian, and R. Raussendorf, Physical Review X 5, 021003 .
 M. Mohseni, A. Rezakhani, and D. Lidar, Phys. Rev. A 77,
032322 .
 M. Silva, E. Magesan, D. W. Kribs, and J. Emerson, Physical
Review A 78, 012347 .
 E. Magesan, J. M. Gambetta, and J. Emerson, Physical Review
A 85, 042311 .
 Y. Li and S. C. Benjamin, arXiv preprint arXiv:1611.09301
 G. Lindblad, Communications in Mathematical Physics 48, 119
 H.-P. Breuer and F. Petruccione, The theory of open quantum
systems .
 C. Schneider, Numerische Mathematik 24, 177 .
SUPPLEMENTAL MATERIAL
Reducing noise by Richardson extrapolation
In numerical analysis, Richardson extrapolation is a sequence acceleration method, used to improve the rate of
convergence of a sequence. We use the same technique to extrapolate to the zero-noise limit in short-depth quantum circuits in
the presence of noise. We assume that the noise process is constant in time and does not depend on the rescaling of the system
Hamiltonian parameters. We consider various noise models in continuous time.
It is our goal to estimate the expectation value of some observable A with respect to the evolved state ρλ(T). The actual
computation is now encoded in the time-dependent Hamiltonian K(t), and the full evolution is given by the equation
∂tρ = −i[K(t), ρ] + λL(ρ).
Here we have that
is some multi-qubit Pauli Hamiltonian with time-dependent coupling constant Jα(t) ∈R and Pauli operators Pα
⟨1, Xi, Yi, Zi⟩i. Starting from some initial state ρ0 the system is evolved for some time T. We consider different forms of
noise L(ρ). As the simplest form of noise, we assume a time-independent Lindblad operator of the form
However, we can also imagine other forms of errors, such as
L(ρ) = −i[V, ρ],
where V is some Hamiltonian. This setting in useful when we want to consider more general, possibly non-Markovian noise
models, or a noisy evolution derived from ﬁrst principle . One can make the assumption that the initial state is given by
ρ0 = ρS(0) ⊗ρB(0) and give the most general form of an interaction Hamiltonian between system and bath, such as
Sα ⊗Bα + HB.
Here we take the point of view that a small λ indicates a separation of time scales, and ρS(0) = |ψ0⟩⟨ψ0| may be the initial
state of the computation. We assume that ρ(0) = ρS(0) ⊗ρB, where the bath state is a steady state w.r.t the bath Hamiltonian
[HB, ρB] = 0. The observable we want to estimate A = AS ⊗1 is then only supported on the system degrees of freedom.
We assume that ρλ(T) is the state we obtain after the noisy evolution for time T. From this state we can estimate the
expectation value of the observable A by various methods. Typically we will sample the expectation value
EK(λ) = tr (Aρλ(T))
so that an additional sampling error δ is introduced, and we obtain from out measurement the statistic ˆEK(λ) = EK(λ) + δ.
The error can assumed to be asymptotically Gaussian δ = O
tr (ρλ(T)(A −EK(λ))2)
since one typically repeats
the experiment M ≫1 times and the i.i.d hypothesis holds.
I Series expansion in the noise parameter
We now show that the function EK(λ) can be expressed as a series in λ where the contribution with λ0 corresponds to the
noise-free evolution. We also provide a bound on the error term. To this end, we transform into the interaction picture of K(t).
We deﬁne UK(t) = T
0 K(t′)dt′)
, where T {·} deﬁnes the time order expansion. We deﬁne the interaction picture
ρI(t) = UK(t)ρ(t)U †
LI,t(◦) = UK(t)L
K(t) ◦UK(t)
where now the generator LI,t has become time-dependent. The evolution equation in the interaction picture now reads
∂tρI(t) = λLI,t (ρI(t)) .
Recall that every ﬁrst-order differential equation can be reformulated as an integral equation
ρI(T) = ρI(0) + λ
LI,t (ρI(t)) dt.
This equation can be recursively solved to increasing order in λ so that
ρI(T) = ρI(0) + λ
LI,t (ρI(0)) dt + λ2
LI,t ◦LI,t′ (ρI(0)) dtdt′
LI,t ◦LI,t′ ◦LI,t′′ (ρI(0)) dtdt′dt′′ . . . .
Recall that ρI(0) = ρ(0).
Furthermore, we can conjugate the full expression on both sides with the unitary UK(T).
Let us for notational convenience deﬁne ρλ(T) as the resulting state after evolution with noise rate λ.
We observe that
UK(T)†ρ(0)UK(T) = ρ0(T), whereas UK(T)†ρI(T)UK(T) = ρλ(T), so that we obtain the expression in the Schr¨odinger
picture as
ρλ(T) = ρ0(T) +
K(T)LI,t1 ◦LI,t2 ◦. . . ◦LI,tk (ρ(0)) UK(T)dt1dt2 . . . dtk
K(T)LI,t1 ◦LI,t2 ◦. . . ◦LI,tn+1 (ρI(tn+1)) UK(T)dt1dt2 . . . dtn+1.
The expectation value EK(λ) = tr (Aρλ(T)) for the observable A can immediately be expanded in a series with parameter λ of
EK(λ) = tr (Aρ0(T)) +
akλk + Rn+1(λ, L, T),
where the constants ak and the remainder Rn+1(λ, L, T) are obtained by pairing the integrals with the trace tr (A·) and
tr (Aρ0(T)) = E∗corresponds to the noise-free evolution to which we seek to extrapolate. We read off that
K(T)LI,t1 ◦LI,t2 ◦. . . ◦LI,tk (ρ(0))
dt1dt2 . . . dtk,
as well as
Rn+1(λ, L, T) = λn+1
K(T)LI,t1 ◦. . . ◦LI,tn+1 (ρI(tn+1))
dt1 . . . dtn+1.
We can bound |Rn+1(λ, L, T)| by a simple application of Cauchy’s mean value theorem and H¨older’s inequality. We observe
by ﬁrst applying the midpoint Theorem that there exist ξ1, . . . , ξn+1 so that
Rn+1(λ, L, T) = λn+1T n+1
(n + 1)! tr
K(T)LI,ξ1 ◦. . . ◦LI,ξn+1 (ρI(ξn+1))
We can then of course immediately bound the inner product
K(T)LI,t1 ◦. . . ◦LI,tn+1 (ρI(tn+1))
| ≤∥A∥∥LI,tξ1 ◦. . . ◦LI,ξn+1 (ρI(ξn+1)) ∥1
by a direct application of H¨older’s inequality. Note that all Schatten norms are unitarily invariant, so when the map L is bounded,
we can apply the subsequent operator norm inequalities
∥LI,tξ1 ◦. . . ◦LI,ξn+1 (ρI(ξn+1)) ∥1 ≤∥L∥n+1
It is safe to assume that a Lindblad operator L acting on a ﬁnite dimensional system, such as a collection of qubits, is bounded.
However, we also consider the case of a ﬁrst-principle noise model that can even be non-Markvoian. In this setting the operator
L(ρ) = −[V, ρ] is expected to couple to an arbitrary large bath and V may contain unbounded operators, such as bosonic
operators. In such a setting an upper bound in terms of an operator norm of L is a moot point. Yet, in this case we can transform
the evolution into the Heisenberg picture L∗, for the observable A(0) = AS ⊗1, and look at the equations for A(t) instead. The
almost identical analysis as performed above can be carried through, but this time we can obtain a bound on
I,ξn+1 ◦. . . ◦L∗
I,tξ1(A(t))
| ≤∥A(t)∥∥LI,tξ1 ◦. . . ◦LI,ξn+1 (ρI(0)) ∥1.
We obtain almost the same type of bound from H¨older’s inequality since ∥A(t)∥≤∥A∥for contractive evolutions, where the
sole difference is now that ∥LI,tξ1 ◦. . . ◦LI,ξn+1 (ρI(0)) ∥1 ≤ln+1 only depends on the initial state. Since we now consider the
action of the operators in V on a well-behaved initial state ρ(0), we can assume that ln+1 is a reasonable bound. In either case,
we will now write for the bound on |Rn+1(λ, L, T)| from now on:
|Rn+1(λ, L, T)| ≤∥A∥ln+1
(n + 1)! .
The coefﬁcients ak can be bounded in a similar fashion. Note that, if we assume that noise acts locally on each qubit, such as
for instance, when the dissipator L corresponds to single-qubit depolarizing noise, so that L(ρ) = PN
2tr[i] (ρ) −ρ). We
have that ||L||1→1 = O(N) is extensive in the system size. A similar argument holds for the case when the individual qubits
couple to a bath. From this we can deduce that for local noise we typically ﬁnd lk = O(N k) as mentioned in the main text, and
that |ak| ≤O((N T)k).
It is also worthwhile to point out the following observation. For different types of error terms L it may happen that not all
powers of λ are present in the expansion. It is conceivable that some system bath interactions could lead to an expansion in only
even powers of λ. If this occurs, the Richardson extrapolation method is particularly efﬁcient, since a higher order of precision
can be obtained with fewer values of λj.
II Experimental rescaling of the noise parameter
In order to apply Richardson extrapolation, we have to be able to evaluate EK(λ) for different values of λ. In an actual
experiment, we can’t directly control the parameter λ: however, we may control the evolution K(t). To this end, we introduce a
rescaling. We redeﬁne
T →T ′ = cT
as well as
α(t) = c−1Jα(c−1t)
from which also
ρ(t) →ρ′(t) = ρ(c−1t).
We claim that this rescaling maps ρ′
λ(T ′) = ρcλ(T) if the noise operator L does not depend on the Hamiltonian couplings Jα(t)
and is constant in time. This rescaled density matrix then leads to a new evaluation E′
K(λ) →EK(cλ) of the expectation value.
To see that the rescaling has the desired effect, we again make use of the integral representation of ρλ(T), for which we can
write now in the Schr¨odinger picture
ρλ(T) = ρ(0) −i
[K(t), ρ(t)]dt + λ
L(ρ(t))dt.
We can now choose a re-parametrization of the evolution c−1Jα(c−1t) and an increased runtime cT, and write
λ(T ′) = ρ(0) −i
[K′(t), ρ′(t)]dt + λ
L(ρ′(t))dt
with K′(t) = P
α c−1Jα(c−1t)Pα. If we now substitute the integration variable according to t = ct′, we have that dt = cdt′,
which leads to
λ(T ′) = ρ(0) −i
c−1Jα(t′)[Pα, ρ(t′)]cdt′ + λ
L(ρ′(t))cdt′
[K(t′), ρ(t′)]dt′ + λc
L(ρ(t′))dt′
Hence, rescaling the evolution according to equation (30) leads to an effective rescaling of the dissipative rate λ. This can be
done for any constant dissipator L and allows the experimenter to evaluate EK(λ) for different values of cλ so that we can
apply the Richardson extrapolation procedure.
Note that for different experimental circumstances, other rescaling methods of the parameter λ may actually be easier to
implement. For example, in an optical experiment that is plagued by photon loss, it may be suitable to consider different
methods of directly changing the photon loss rate. The only requirement is that the modiﬁcation of λj can be performed
sufﬁciently accurately so the extrapolation can be performed.
III Error bounds on the noise-free estimator
Let us now show that the protocol leads to the desired error bound on the estimated expectation value as claimed in the main
text. Recall that we ﬁrst choose a set of n+1 rescaling parameters c0 = 1 < c1 < . . . < cn, to evolve with respect to the rescaled
Hamiltonian Kj(t) for time Tj = cjT. As discussed in the previous section, this evolution leads to a state ρj
λ(Tj) = ρcjλ(T),
c.f. Eq. (33) as was discussed in section II. If we now measure the observable A on these states we obtain for j = 0 . . . n + 1
the estimates ˆEK(cjλ) = EK(cjλ) + δj. Recall the set of equations for γj deﬁned in and given in the main text, which
requires for the {cj} that
for k = 1 . . . n.
Now we observe that estimators ˆEK(cjλ) can be expressed as
ˆEK(cjλ) = E∗+
j λk + R(cjλ, L, T) + δj
due to the expansion (22) discussed in section I. Recall now the deﬁnition of our improved estimator ˆEn
K(λ) as given in the
main text, ˆEn
j=0 γj ˆEK(cjλ), for which then
j λk + R(cjλ, L, T) + δj
γjR(cjλ, L, T) + δj
Recall the equations for γj from which we can then infer after the application of the triangle inequality
|γj| (|R(cjλ, L, T)| + |δj|) .
After the application of the bound |R(cjλ, L, T)| ≤∥A∥ln+1 cn+1
λn+1T n+1((n + 1)!)−1 and the observation that cj ≥1, we
can bound the difference with Γn = Pn
j=0 |γj|cn+1
and obtain the ﬁnal bound
δ∗+ ∥A∥ln+1λn+1T n+1
with δ∗= maxj |δj|.
In the Richardson extrapolation literature , two types of sequences cj are considered frequently. In the Bulirsch - Stoer
series the rescalings are chosen so that cj = hjc0 constitutes an exponential series, which is typically chosen at base h = 1/2;
but harmonic series have also been frequently applied, e.g. for parameters q > 1, η ≥0 one can choose cj = (j + η)−qc0.
Note that in our experiments we are actually increasing the noise rate starting from the optimal value, whereas it is common
in the numerical literature to improve the small parameter, so that cj+1 ≤cj. The result here is of course the same, and just
corresponds to a reordering of the labels when n is ﬁnite. For both of the aforementioned cases, a bound on Γn has been derived.
One is mostly interested in the asymptotic behavior of Γn as n →∞in order to analyze the numerical stability of the method.
In current experiments we only expect to go to third or forth order, making the stability analysis less relevant.
Probabilistic error cancellation by resampling
The key idea of our scheme is to represent the ideal circuit as a quasi-probabilistic mixture of noisy ones. Central to this
approach is the quasi probability representation (QPR) of the noise-free circuit Uβ. We note that quasi-probability distributions
have been previously used to construct classical algorithms for simulation of quantum circuits . Our work can be viewed
as an application of these methods to the problem of simulating ideal quantum circuits by noisy ones.
The general approach to constructing a QPR for a quantum circuit is the following: Suppose you are given a set of noisy
operations Ω= {O1, . . . , Om} that can be implemented on a noisy N-qubit device. We assume that we can perform gate
tomography to specify the gates with an accuracy that is comparable to the desired accuracy of the ideal circuit. These
noisy operations are noisy versions of ideal quantum gates and are assumed to form a full basis of TPCP operations, i.e. an
element Ok ∈Ωis always of the form
i,kOi,k = 1.
A crucial condition is that the set of noisy operators Ωconstitutes a basis in the space of TPCP operations that is sufﬁciently
large, so that any ideal, unitary gate U(ρ) = UρU † can be expressed as a linear combination of noisy gates in Ω. Hence, there
have to be coefﬁcients ηα ∈R, and noisy operations in Oα ∈Ωso that we can write for any ideal gate in the circuit
This linear expansion of U can then be cast into the form of a quasi-probability representation.
On real quantum devices we can only apply the noisy operations Ω. We say that a circuit of length L in the basis Ωis
a sequence of L operations from Ω. Such a circuit, c.f. Fig 3(b), indexed by α = (α1, . . . , αL) implements a noisy map
Oα = OαL · · · Oα2Oα1.
The expectation value of an observable A on the ﬁnal state produced by a noisy circuit α is
A Oα(|0⟩⟨0|⊗n)
For simplicity, we ignore errors in the initial state preparation and in the ﬁnal measurement. Such errors can be accounted for by
adding dummy noisy operations before each measurement and after each qubit initialization. Furthermore, we shall assume that
A is diagonal in the Z-basis and ∥A∥≤1.
The task of simulating an ideal quantum circuit Uβ, c.f. Fig. 3(a), of ideal gates Uβ = UβL . . . Uα2Uα1, can be reduced to
estimating the expectation values E(α) for a suitable random ensemble of noisy quantum circuits α. That is, we can obtain
estimates for the ideal expectation values
E∗(β) = Tr
A Uβ(|0⟩⟨0|⊗n)
after the application of the circuit Uβ by estimating noisy circuit outputs. Moreover, the ideal and the noisy circuits act on the
same number of qubits and have the same length.
We say that the noisy basis Ωsimulates an ideal circuit β if there exists a probability distribution Pβ(α) on the set of noisy
circuits α ∈ΩL such that
Pβ(α)σβ(α)Oα
for some coefﬁcients σβ(α) = ±1. We require that the distribution Pβ(α) is sufﬁciently simple so that one can efﬁciently
sample α from Pβ(α). The coefﬁcients γβ, σβ(α) must be efﬁciently computable.
(color online) The ﬁgure (a) represents the ideal circuit we want to simulate.
It is comprised of single- and two-qubit gates
{U12, . . . , U5}. We assume that a complete set of noisy gates exist Ω= {Oα12
12 , . . . , Oα5
5 }, which serve as an operator basis in which
the action of the ideal set can be expanded. It is then sufﬁcient to sample circuits, as given in ﬁgure (b), where the gates are drawn from the
probability distribution Pβ in Eq. (41).
We can see that the estimates of the noisy circuit are related to the ideal circuit probability by substituting Eq. (41) into the
deﬁnition of E∗(β). This gives
E∗(β) = γβ
Pβ(α)σβ(α)E(α).
The construction of QPRs with optimal overhead of general operation-dependent noise is an interesting open problem. A
preliminary analysis shows that a noisy basis Ωthat includes noisy versions of all single-qubit and two-qubit Clifford gates,
T-gates, and noisy qubit initializations in the X, Y, Z basis can simulate any ideal gate Uβ from the Clifford+T gate set with
the overhead γβ ≤1 + O(ϵ), provided that each noisy operation is ϵ-close to its ideal analogue. Unfortunately, the constant
coefﬁcient in this upper bound is far too large to have any practical implications.
Furthermore, the full Clifford group on two-qubits contains 11520 gates. It may not be feasible to perform process tomography
for each of those gates. We shall see that for certain noise models, such as the amplitude damping noise, QPRs can be constructed
only if the noisy basis Ωincludes some qubit initialization maps. In particular, noisy circuits α that appear in Eq. (41) may apply
qubit initializations at intermediate time steps, even though the ideal circuit β initializes all the qubits at the very ﬁrst step. All
QPRs constructed below preserve the circuit depth. That is, if the ideal circuit β has depth d then all noisy circuits α in Eq. (41)
have depth at most d.
IV Minimal overhead decomposition of noise free circuit
Let us discuss how to construct QPRs with a small overhead. For concreteness, we choose the ideal gate set Γ as the Clifford+T
basis. It includes the identity gate I, the Hadamard gate H, phase-shift gates S = diag[1, i] and T = diag[1, eiπ/4], and
the CNOT. For technical reasons, we shall assume that each CNOT is followed by single-qubit gates (that could be identity
gates). We shall consider toy noise models usually studied in the quantum fault-tolerance theory: the depolarizing noise and the
amplitude damping noise.
First let us describe product QPRs that can be constructed independently for each gate in the ideal circuit. Consider a ﬁxed
ideal gate Uβ ∈Γ. Let O1, . . . , Op ∈Ωbe the list of all noisy operations whose support is contained in the support of Uβ.
Consider the following linear program with 2p real variables µ1, . . . , µp, η1, . . . , ηp.
subject to
Suppose {µα, ηα} is the optimal solution of the program. Note that µα = |ηα| for all α since otherwise the objective function
can be decreased. Deﬁne γβ = Pp
α=1 µp, Pβ(α) = µα/γβ, and σβ(α) = sgn(ηα). Then
Pβ(α)σβ(α)Oα,
which is a gate-wise version of the QPR Eq. (41). We shall say that a noisy basis Ωsimulates a gate Uβ with the overhead γβ if
the linear program Eqs. (43,44) has a feasible solution with value γβ. A product QPR of the ideal circuit β is deﬁned as a product
of all gate-wise QPRs Eq. (45). It gives γβ = γβ1 · · · γβL, Pβ(α) = Pβ1(α1) · · · PβL(αL) and σβ(α) = σβ1(α1) · · · σβL(αL).
The assumption that all noisy operations Oα in Eq. (44) act non-trivially only within the support of Uβ allows one to restrict
Eq. (44) to operations acting on at most two qubits. Such operations can be represented by real matrices of size 16 × 16 by
computing matrix elements of Oα and Uβ in the Pauli basis. Thus the program Eqs. (43,44) can be solved in time O(1). Since
the ideal gate set has size O(n2), product QPRs can be computed in time O(n2). Furthermore, if two ideal gates have disjoint
supports, then the gate-wise QPRs deﬁned in Eq. (45) have disjoint supports. Thus product QPRs preserve the circuit depth.
V Depolarizing noise cancellation and numerical results
Let us illustrate the construction of product QPRs using the depolarizing noise as an example. Let Dk be the ϵ-depolarizing
channel on k qubits that returns the maximally mixed state with probability ϵ and does nothing with probability 1 −ϵ. Deﬁne
a noisy version of a k-qubit unitary gate U as DkU. Deﬁne a noisy basis Ωby multiplying ideal gates on the left by arbitrary
Pauli operators and adding the depolarizing noise. Thus Ωis a set of operations Oα = DkPU, where U ∈Γ is a k-qubit
ideal gate and P ∈{I, X, Y, Z}⊗k is a Pauli TPCP map. A Pauli map P corresponding to a Pauli operator P ∈{I, X, Y, Z}
is deﬁned by P(ρ) = PρP. Here k = 1, 2. We claim that Ωsimulates ideal single-qubit gates Uβ ∈Γ with the overhead
γβ = (1 + ϵ/2)/(1 −ϵ) and simulates CNOTs with the overhead γβ = (1 + 7ϵ/8)/(1 −ϵ).
Indeed, suppose Uβ ∈Γ is a single-qubit gate. Let us look for a solution of Eq. (44) in the form Oα = D1PUβ, where
P ∈{I, X, Y, Z}. Then Eq. (44) is equivalent to
= η1I + η2X + η3Y + η4Z.
One can easily check that the optimal solution minimizing P
α |ηα| is η1 = 1 + 3ϵ/4(1 −ϵ) and ηα = −ϵ/4(1 −ϵ) for
α = 2, 3, 4. Therefore γβ = P
α |ηα| = (1 + ϵ/2)/(1 −ϵ). The CNOT is simulated in a similar fashion by representing D−1
a linear combination of two-qubit Pauli maps. The random ensemble of noisy circuits Oα that simulates an ideal circuit Uβ is
constructed in three steps:
1. Start from the ideal circuit, Oα = Uβ.
2. Modify Oα by adding a Pauli X, Y, Z after each single-qubit gate with probability p1 = ϵ/(4+2ϵ). The gate is unchanged
with probability 1 −3p1.
3. Modify Oα by adding a Pauli IX, IY, . . . , ZZ after each CNOT with probability p2 = ϵ/(16 + 14ϵ). The CNOT is
unchanged with probability 1 −15p2.
The resulting circuit is then implemented on a noisy device (which adds the depolarizing noise after each gate) and the ﬁnal
readout string x is recorded. By generating M samples of x one can estimate E∗(β) using Eq. (10) of the main text. The sign
function σβ(α) is equal to (−1)r, where r is the number of Pauli operators added to the ideal circuit Uβ to obtain Oα.
Numerical simulations
The error cancellation method was tested numerically for small Clifford+T circuits subject to the depolarizing noise. We
choose the ideal circuit Uβ as a composition of d alternating layers of gates, with each layer being either a tensor product of n
single-qubit gates I, H, S, T (for odd layers) or a tensor product of n/2 CNOTs (for even layers). The resulting circuit Uβ has
depth d. Simulations were performed for 500 random circuits Uβ as above with the initial state |+⟩⊗n. Each single-qubit gate
was picked randomly from the set {I, H, S, T}. Control and target qubits for each CNOT were picked at random.
For each ideal circuit Uβ we choose the observable A as a projector onto the subset of 2n−1 basis states x ∈{0, 1}n whose
probability in the ﬁnal state of Uβ is above the median value. In other words,
⟨x|Uβ(|+⟩⟨+|⊗n)|x⟩.
By construction, E∗(β) ≥1/2 for any circuit β. Furthermore, we observed that E∗(β) is well separated from 1/2 for most of
the circuits see Fig. 4. Recall that we deﬁne a noisy version of a k-qubit unitary gate U as DkU, where
Ideal output probability
Number of simulated circuits
FIG. 4. Distribution of the ideal circuits according to their output probability E∗(β).
Dk(ρ) = (1 −ϵ)ρ + ϵI
is the depolarizing channel on k qubits. Noise was added after all gates including the identity gates. In this case the total
simulation overhead γβ depends only on the number of qubits and the circuit depth, namely
Consider a ﬁxed ideal circuit Uβ and let Pβ(α), Oα be the random ensemble of noisy circuits obtained from Uβ by inserting
random Pauli operators and adding noise as described in the main text. Instead of using the estimate Eq. (10) of the main text
for the ideal output probability E∗(β) we opted for a slightly optimized estimate. It is deﬁned by dividing the total budget of M
runs into K groups such that the j-th group contains Mj runs
Deﬁne a random variable
ˆE(β) ≡γβK−1
where α1, . . . , αK are independent samples drawn from the distribution Pβ(α) and xa
j ∈{0, 1}n are readout strings obtained
by measuring each qubit of the ﬁnal state Oαj(ρin) in the Z-basis. We prepare a fresh copy of the ﬁnal state to generate each
j . Thus computing ˆE(β) requires M runs of the noisy circuits with each run producing a single readout string. One can
easily check that ˆE(β) is an unbiased estimator of E∗(β) for any choice of {Mj}. Our goal is to choose {Mj} that minimize
the variance of ˆE(β) for a ﬁxed M. One can easily check that the optimal choice is
j = E(αj) −E(αj)2. In order to choose optimal values of Mj, one has to run each circuit αj at least a few times,
which gives a rough estimate of E(αj) and thus σj. Numerical simulations were performed for the following parameters:
number of qubits
circuit depth
error rate
total number of runs M = 4, 000
simulation overhead
Our results are presented on the left panel of Figure 5. For each of ≈500 ideal circuits β generated at random we computed a
simulation precision δ(β) ≡| ˆE(β) −E∗(β)| where ˆE(β) is the estimate deﬁned in Eq. (46). The plot on Figure 5, left, shows
distribution of the ideal circuits β according to their simulation precision δ(β). The median value of δ(β) is approximately 0.05.
This is consistent with the estimate
4000 ≈0.07.
We also computed a simulation precision δ0(β) that one would obtain by running the circuit β directly on a noisy device
without error cancellation, see the right panel of Figure 5. It is deﬁned as δ0(β) ≡|E(β) −E∗(β)|. For each circuit the output
probability E(β) was estimated using M = 4, 000 circuit runs. Thus the simulations presented on the left and the right panels
of Figure 5 have access to exactly the same resources. The median value of δ0(β) is approximately 0.15. We conclude that error
cancellation signiﬁcantly improves the simulation precision.
VI Quasi-probability representation for amplitude-damping noise
A more interesting example is the noise described by the amplitude-damping channel A(ρ) = A0ρA†
0 (1 −ϵ)1/2
A noisy version of a k-qubit unitary gate U is deﬁned as A⊗kU. In contrast to the previous example, noisy unitary gates A⊗kU
alone cannot simulate any ideal unitary gate. Indeed, assume the contrary. Suppose Uβ is a single-qubit gate that has a QPR
Eq. (45) with Oα = AVα for some unitary maps Vα. Rewrite Eq. (45) as
Pβ(α)σβ(α)VαU−1
Simulation precision
Number of simulated circuits
Simulation precision
Number of simulated circuits
FIG. 5. Simulation precision for ≈500 randomly generated ideal Clifford+T circuits on n = 6 qubits with depth d = 20. The left and the
right panels show results for simulations with and without error cancellation. In both cases each ideal circuit was simulated by M = 4000
runs of the noisy circuit.
Since the maps VαU−1
are unital, we infer that A−1 and A are unital which is false. Thus Eq. (45) has no solutions.
To overcome this problem we shall extend the noisy basis by adding state preparations. Also we shall employ non-product
QPRs. Given a single-qubit state |ψ⟩, deﬁne a state preparation map
P|ψ⟩(ρ) = Tr(ρ) · |ψ⟩⟨ψ|.
Let S(ρ) = SρS−1 be the S-gate considered as a TPCP map. Deﬁne a noisy basis Ωthat includes noisy state preparations
AP|ψ⟩with |ψ⟩= |+⟩, |−⟩, |0⟩, |1⟩, noisy single-qubit gates AUβ, AS±1Uβ for each ideal single-qubit gate Uβ ∈Γ, and noisy
two-qubit gates
y, z ∈{0, ±1}
where c, t are the control and the target qubits of a CNOT gate Ucnot ∈Γ. Here the subscripts indicate qubits acted upon by each
map. We claim that this noisy basis Ωsimulates any ideal Clifford+T circuit β with the overhead
γβ ≤γL1+2L2,
where Lk is the number of k-qubit gates in β. The corresponding QPR Eq. (41) preserves the circuit depth, although it does not
have a simple product form as above.
Indeed, consider a single-qubit gate Uβ ∈Γ. Let us look for a solution of Eq. (44) with p = 4 and
O1 = AUβ, O2 = ASUβ, O3 = AS−1Uβ, O4 = P|0⟩.
Note that P|0⟩∈Ωsince AP|0⟩= P|0⟩. Furthermore, since P|0⟩= AP|0⟩Uβ, one can rewrite Eq. (44) as
A−1 = η1I + η2S + η3S−1 + η4P|0⟩.
One can easily check that the optimal solution minimizing P
√1 −ϵ, η2 = η3 = 1 −√1 −ϵ
2(1 −ϵ) , η4 = −
Therefore, Ωsimulates Uβ with the overhead P
α |ηα| = γ, where γ is deﬁned in Eq. (48).
Next consider the CNOT gate Ucnot ∈Γ. Consider a decomposition of A−1
obtained by applying Eq. (49) twice.
Multiplying this decomposition on the right by Ucnot and on the left by AcAt one obtains
where Oα = AcAtSy
t Ucnot ∈Ωis a valid noisy operation and O′
α is either identity or a state preparation map P|0⟩applied
to the control and/or target qubits. Here we noted that AP|0⟩= P|0⟩A. Although O′
αOα might not be a valid noisy operation
from Ω, we may merge O′
α with the next gate applied after the CNOT. Indeed, by assumption, each CNOT in the ideal circuit
is followed by some single-qubit gates Uc and Ut applied to the control and the target qubits. The gates I, S, T can be absorbed
into P|0⟩since they act trivially on the state |0⟩. The only non-trivial case is when P|0⟩is merged with the Hadamard gate. In
this case the latter is replaced by the state preparation P|+⟩.
Since P|+⟩can now appear in the ideal circuit, we must be able to use noisy operations from Ωto simulate P|+⟩. Let us look
for a solution of Eq. (44) with Uβ ≡P|+⟩in the form
P|+⟩= η1AP|+⟩+ η2AP|−⟩+ η3AP|1⟩.
Note that the righthand side of Eq. (51) contains only noisy operations from Ω. One can rewrite Eq. (51) as
|+⟩⟨+| = η1A(|+⟩⟨+|) + η2A(|−⟩⟨−|) + η3A(|1⟩⟨1).
The optimal solution minimizing P
√1 −ϵ ± 1 −2ϵ
Therefore Ωsimulates the ideal state preparation P|+⟩with the overhead γ′ = P
α |ηα| ≤γ, where γ is deﬁned in Eq. (48).
A QPR of the ideal circuit β with the overhead Eq. (48) is constructed in two steps. First, one applies the decomposition
Eq. (50) to each CNOT of β and merges state preparation maps P|0⟩that appear in O′
α (if any) with the single-qubit gates of β
following the CNOT. Now all CNOT gates are replaced by noisy gates from Ω. The rest of the circuit consists of single-qubit
gates Uβ ∈Γ and state preparations P|+⟩. At the second step, each of these ideal operations is replaced by its QPR constructed
above. Note that each CNOT contributes γ2 to the total overhead γβ, see Eq. (50). Each single-qubit gate Uβ ∈Γ or a state
preparation P|+⟩contributes at most γ to the total overhead. This proves Eq. (48).