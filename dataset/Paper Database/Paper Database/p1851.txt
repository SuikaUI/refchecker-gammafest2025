Optimal Approximations by
Piecewise Smooth Functions and
Associated Variational Problems
Mumford, David Bryant, and Jayant Shah. 1989. Optimal approximations by piecewise
smooth functions and associated variational problems. Communications on Pure and
Applied Mathematics 42(5): 577-685.
Published version
 
 
Terms of use
This article was downloaded from Harvard University’s DASH repository, and is made
available under the terms and conditions applicable to Other Posted Material (LAA), as set
 
Accessibility
 
Share Your Story
The Harvard community has made this article openly available.
Please share how this access benefits you. Submit a story
Optimal Approximations by Piecewise Smooth
Functions and Associated Variational Problems’
DAVID MUMFORD
Harvard University
JAYANT SHAH
Northeastern University
1. Introduction and Outline
The purpose of this paper is to introduce and study the most basic properties
of three new variational problems which are suggested by applications to com-
puter vision. In computer vision, a fundamental problem is to appropriately
decompose the domain R of a function g(x, y) of two variables. To explain this
problem, we have to start by describing the physical situation whch produces
images: assume that a three-dimensional world is observed by an eye or camera
from some point P and that gl(p) represents the intensity of the light in this
world approaching the point P from a direction p. If one has a lens at P
focussing this light on a retina or a film-in
both cases a plane domain R in
which we may introduce coordinates x , y-then
let g(x, y) be the strength of
the light signal striking R at a point with coordinates ( x , y); g ( x , y) is
essentially the same as gl( p)-possibly
after a simple transformation given by
the geometry of the imaging system. The function g(x, y ) defined on the plane
domain R will be called an image. What sort of function is g? The light reflected
off the surfaces Sj of various solid objects 0; visible from P will strike the
domain R in various open subsets Ri.
When one object 0, is partially in front of
another object 0, as seen from P, but some of object 0, appears as the
background to the sides of 0,, then the open sets R, and R, will have a common
boundary (the ‘edge’ of object 0, in the image defined on R ) and one usually
expects the image g(x, y ) to be discontinuous along this boundary: see Figure 1
for an illustration of the geometry.
Other discontinuities in g will be caused by discontinuities in the surface
orientation of visible objects (e.g., the ‘edges’ of a cube), discontinuities in the
objects albedo (i.e., surface markings) and discontinuities in the illumination
‘A preliminary version of this paper was submitted by invitation in 1986 to “Computer Vision 1988”,
L. Erlbaum Press, but it has not appeared!
Communications on Pure and Applied Mathematics, Vol. XLII 577-685 
Q 1989 John Wiley & Sons, Inc.
CCC 0010-3640/89/050577-107$04.00
D. MUMFORD AND J. SHAH
Figure 1. An huge of a 3D scene.
(e.g., shadows). Including all these effects, one is led to expect that the image
g ( x , y ) is piece-wise smooth to a first approximation, i.e., it is well modelled by a
set of smooth functions f i defined on a set of disjoint regions R i covering R. This
model is, however, far from exact: (i) textured objects such as a rug or frag-
mented objects such as a canopy of leaves define more complicated images; (ii)
shadows are not true discontinuities due to the penumbra; (iii) surface markings
come in all sorts of misleading forms; (iv) partially transparent objects (e.g.,
liquids) and reflecting objects give further complications; (v) the measurement of
g always produces a corrupted, noisy approximation of the true image g.
In spite of all this, the piece-wise smooth model is serviceable on certain
scales and to a certain approximation. Restating these ideas, the segmentation
problem in computer vision consists in computing a decomposition
R = R, U . * * UR,
of the domain of the image g such that
(a) the image g vanes smoothly and/or slowly within each R;,
(b) the image g varies discontinuously and/or rapidly across most of the
From the point of view of approximation theory, the segmentation problem
may be restated as seeking ways to define and compute optimal approximations of
a general function g(x, y ) by piece-wise smooth functions f ( x , y), i.e., functions
f whose restrictions fi to the pieces Ri of a decomposition of the domain R are
differentiable. Such a problem arises in many other contexts: the perception of
speech requires segmenting time, the domain of the speech signal, into intervals
boundary r between different R ;.
OPTIMAL APPROXIMATIONS
during which a single phoneme is being pronounced. Sonar, radar or laser
“range” data, in which g(x, y) represents the distance from a fixed point P in
direction (x, y) to the nearest solid object, are other computer vision signals
whose domains must be segmented. CAT scans are estimates of the density of the
body at points ( x , y, z) in three-space: segmentation is needed to identify the
various organs of the body.
To make mathematics out of this, we must give a precise definition of what
constitutes an optimal segmentation. In this paper we shall study three function-
als which measure the degree of match between an image g(x, y) and a
segmentation. We have a general functional E which depends on two parameters
p and v and two limiting cases E, and E, which depend on only one parameter
v and correspond to the limits of E as the parameter p tends to 0 and 00,
respectively.
We now define these three functionals and motivate them in terms of the
segmentation problem. In all these functionals, we use the following notation: the
R, will be disjoint connected open subsets of a planar domain R each one with a
piece-wise smooth boundary and r will be the union of the part of the
boundaries of the Ri inside R, so that
R = R, u ... UR, u r.
(Conversely, we could start from a closed set I‘ made up of a finite set of singular
points joined by a finite set of smooth arcs meeting only at their endpoints, and
let the R, be the connected components of R - r.) For the functional E, let f
be a differentiable function on U Ri, which is allowed to be discontinuous across
where lI‘l stands for the total length of the arcs making up r. The smaller E is,
the better (f, r) segments g:
(i) the first term asks that f approximates g,
(ii) the second term asks that f - and hence g - does not vary very much
(iii) the third term asks that the boundaries I’ that accomplish this be as short
Dropping any of these three items, inf E = 0: without the first, take f = 0,
r = 0 ; without the second, take f = g, r = 0 ; without the third, take r to be
a fine grid of N horizontal and vertical lines, Ri = N 2 small squares, f = average
of g on each Ri. The presence of all three terms makes E interesting.
The pair (f, r) has an interesting interpretation in the context of the original
computer vision problem: (f, I‘) is simply a cartoon of the actual image g; f
may be taken as a new image in which the edges are drawn sharply and precisely,
on each Ri,
as possible.
D. MUMFORD AND J. SHAH
the objects surrounded by the edges are drawn smoothly without texture. In other
words, (f, r) is an idealization of a true-life complicated image by the sort of
image created by an artist. The fact that such cartoons are perceived correctly as
representing essentially the same scene as g argues that this is a simplification of
the scene containing many of its essential features.
We do not know if the problem of minimizing E is well posed, but we
conjecture this to be true. For instance we conjecture that for all continuous
functions g , E has a minimum in the set of all pairs (f, I?), f differentiable on
each Ri, r a finite set of singular points joined by a finite set of C1-arcs.
A closely related functional defined for functions g and f on a lattice instead
of on a plane domain R was first introduced by D. and S. Geman , and has
been studied by Blake and Zisserman , J. Marroquin [lo] and others. The
variational problem 6E = 0 turns out to be related to a model introduced
recently by M. Gurtin in the study of the evolution of freezing/melting
contours of a body in three-space.
The second functional E, is simply the restriction of E to piecewise constant
functions f: i.e., f = constant u i on each open set Ri.
Then multiplying E by
pP2 we have
where v, = v/p*. It is immediate that this is minimized in the variables a, by
a, = meanR,(g) = JJ gdxdy
so we are minimizing
As we shall see, if r is fixed and p + 0, the f whch minimizes E tends to a
piecewise constant limit, so one can prove that E, is the natural limit functional
of E as p + 0. E, may be viewed as a modification of the usual Plateau problem
functional, length (r), by an external force term that keeps the regions R j--soap
bubbles in the Plateau problem setting-from
collapsing. Whereas the two-
dimensional Plateau problem has only rather uninteresting extrema with r made
up of straight line segments (cf. Allard-Almgren [l]),
the addition of the pressure
term makes the infimum more interesting. Having the powerful arsenal of
geometric measure theory makes it straightforward to prove that the problem of
minimizing E, is well posed: for any continuous g , there exists a r made up of a
finite number of singular points joined by a finite set of C2-arcs on which E,
OPTIMAL APPROXIMATIONS
Figure 2. Continuous vs. discrete segmentation.
attains a minimum. E, is also closely related to the energy functional in the Ising
model. For this, we restrict f even further to take on only two values: +1 and
- 1, and we assume g and f are functions on a lattice instead of functions on a
two-dimensional region R. In this setting, I' is the path made up of lines between
all pairs of adjacent lattice points on which f changes sign (see Figure 2). Then
E, reduces to
which is the Ising model energy.
The third functional Em depends only on
and is given by
where vm is a constant, ds is arc length along r and d/an is a unit normal to r.
Using dx, dy as coordinates on the tangent plane to R , so that ds = {w,
Em may be rewritten as the integral along r of a generalized Finder metric
p(dx, dy, x, y ) (a function p such that p(tdx, tdy, x, y ) = It1 p(dx, dy, x, y)),
D. MUMFORD AND J. SHAH
Figure 3. Curvilinear coordinates r , s.
Intuitively, minimizing E,
is then a generalized geodesic problem. It asks for
paths I‘ such that (i) length (I?) is as short as possible while (ii) normal to r, g
has the largest possible derivative. Looking at the graph of g as a landscape, r is
the sort of path preferred by mountain goats-short
but clinging to the face of
cliffs wherever possible.
At first glance, E, looks completely unrelated to E. In fact, like E, it is
essentially E with a special choice of f:
We consider only smooth parts of r and take f = g outside an infinitesimal
neighborhood of r. Near r, set
where r, s are curvilinear coordinates defined by normals of r (see Figure 3),
and E is infinitesimal. Then if p = 1/~,
v = ~ E V , , it can be checked that
We shall see, moreover, that for fixed r, if p is very large, the f which minimizes
E is very close to the above f with E = 1/p, so this E, is a natural limit
functional of E as p .+ 00.
Minimizing Em ouer all r is not a well-posed problem in most cases: if
(Ivg1I2 5 v, everywhere, then E, 2 0 and the simple choice r = 0 minimizes
E,. But if llvg112 > v, on a non-empty open set U, then consider r made up of
many pieces of level curves of g within U. On such r’s, E, tends to - 00. For p
large but not infinite, the pair (f, r) which minimizes E itself presumably has a
r made up of many components in this open set U. Minimizing Em on a suitably
restricted class of r’s can, however, be a well-posed problem.
We finish this introduction by giving an outline of the results of each section.
The proofs in the later sections will sometimes be quite technical and hence it
seems useful to describe the main results here before plunging into detail.
In Section 2, we analyze the variational equations for the functional E. Fixing
I?, standard calculus of variations shows that E is a positive definite quadratic
OPTIMAL APPROXIMATIONS
function in f with a unique minimum. The minimum is the function f which
solves the elliptic boundary value problem on each R;,
Here aRj is the boundary of R;, and a / a n is a unit normal vector to aRi. The
second condition means that a f / a n is zero on both sides of r and on the inside
of aR, the boundary of the whole domain R. Writing fr for this solution, E
reduces to a function of r alone:
Next, we make an infinitesimal variation of r by a normal vector field
X = a(x, y ) d / a n defined along r and zero in the neighborhood of the singular
points of I’. We prove:
n E ( f r , r) = Ja(e+- e-+ v curv(I’)) ds,
f : = boundary values of fr.
Therefore if E(f,, r) is minimized at r, I‘ must satisfy the variational equation
Finally, we look at possible singular points of I‘. Here the situation is
complicated by the fact that although the minimizing fr is pointwise bounded:
its gradient may be unbounded in a neighborhood of the singular points of I’.
However, the behavior of the solutions of elliptic boundary value problems in
domains with “corners” has been studied by several people, starting with a classic
paper of Kondratiev and recently surveyed in a book of Grisvard . Using
these bounds, and assuming that the singular points are given by a finite number
of Cz-arcs with a common endpoint, it is easy to show, by elementary compar-
isons of E(f,, r) with E on modified r’s, that if E( f r , r) attains a minimum at
D. MUMFORD AND J. SHAH
some r, then the only possible singularities of I‘ are:
(i) “triple points” P where three C2-arcs meet with 120°-angles,
(ii) “crack-tips” P where a single C2-arc ends and no other arc meets P.
Moreover, on the boundary of the domain R, another possibility is:
(iii) “boundary points” P where a single C2-arc of r meets perpendicularly
There is a wrinkle here though: assuming that E has a minimum when r
varies over some reasonable set of possible curves, it is not clear that the
minimizing r will have singular points made up of C2-arcs. Instead there might
well be a larger class of nastier singular points that can arise as minima. In
Section 3, we look more closely at crack-tips with this possibility in mind. First of
all, assuming the crack-tip is C2 we calculate the first variation of E with respect
to infinitesimal extensions or truncations of I’ at the crack tip. We find a new
restriction on minimizing r’s, which is the analogue of Griffiths’ law of cracks in
solid mechanics. Secondly, we consider the possibility that the crack-tip might be
a smooth point of JR.
y = (ux3’2 + +(x),
x 2 0, + a C2-function.
Such singular points are called cusps in algebraic geometry. We give several
arguments to make it plausible that such a singularity will occur on minimizing
r ’s. Moreover, in the natural world, approximate cusps certainly look like they
appear at the ends of arcs in other situations which may be modelled by free
boundary value problems. For example, consider sand bars that stick out into an
area with a strong transverse current. Sand may be washed away or may accrete,
hence the boundary is free to shift in both directions, and its tip may likewise
erode or grow. Figure 4 shows a chart of Cape Cod and of Monomoy Island,
whose outlines are strongly reminiscent of cusps.
In Section 4, we study E for small p. We use the isoperimetric constant A r
which gets small only if some component W of R - I’ has a narrow “neck” (see
Figure 5). By definition, A, is the minimum of S/min(A,, A,) over all diagrams
as in the figure. We prove that
where vo = v/p2. We then study the first variation of Eo(r). We show firstly that
the first variation of E( fr, r) also tends to the first variation of E,( r). Secondly,
the equation for the first variation of E , ( r ) being zero turns out to be the
second-order differential equation for r:
OPTIMAL APPROXIMATIONS
Figure 5. Definition of the isoperimetric constant.
D. MUMFORD AND J. SHAH
where g; and gr are the means of g on the components of R - to each side
Section 5 is devoted to the proof that min E,(r) exists for a r which is a
finite union of C2-arcs joining a finite number of triple points or border points.
We dip deeply into the toolkit of geometric measure theory, using especially the
results in Simon . The fundamental idea is to enlarge the set of allowable r’s
until one of the compactness results of geometric measure theory can be applied
to show that min E, exists for a possibly very wild r. And once this I? is in hand,
use the vanishing of its first variation to show that r is in fact very nice. More
precisely, what we do is to shift the focus from r to a decomposition of R into
disjoint measurable sets:
and define
For this to make sense, Ri must be a so-called Cucciopoii set, a measurable set
whose boundary as a current aRi has finite length, laR,I. Then, for each n, we
show that En attains its minimum, and that at ths minimum, R, is an open set
(up to a measure zero set) with piecewise C2 boundary. We show finally that as n
increases, the minimum eventually increases if all R j have positive measure. How
should Cacciopoli sets be visualized? Note that the boundaries of Cacciopoli sets
are not fractals: their Hausdorff dimension is 1 since their length is finite, but
they will, in general, be made up of infinitely many rectifiable arcs with finite
total length. A good way to imagine what Cacciopoli sets are like is to look at the
segmentation of the world into sea and land. Some coastlines are best seen as
fractals: Richardson’s data on the indefinite growth of the length of rocky coasts
with the scale of the yardstick was one of the inspirations of Mandelbrot’s theory
of fractals. But other coasts are mixtures of smooth and ragged parts, and may
serve as models (see Figure 6).
In Section 6 we study E for large p . The first step is to use Green’s theorem
and rewrite E as an integral only over r: let g,, and fr be the solutions of
Then we show that
OPTIMAL APPROXIMATIONS
are the boundary values of fr along I' and a/an points from the -
side of r to the + side. Moreover, if 1/p is small, we prove that, away from the
singularities of r,
while uniformly on R
from which we deduce that
D. MUMFORD AND J. SHAH
= 3pv. We then study the first variation of Em(r).
We show firstly that
the variation of E( fr, r) also tends to the first variation of Em( r). Secondly, the
equation for the first variation of Em( I-) being zero turns out to be a second-order
differential equation for r. Let Hg be the matrix of second derivatives of g, let tr
and nr be the unit tangent vector and unit normal vector for r. Then the
equation is
(To read this equation properly, note that vg, Ag and Hg play the role of
coefficients, tr and nr are 1-st derivatives of the solution curve and curv(I') is its
2-nd derivative.)
Finally, in Section 7, we look briefly at this equation, noting that like the
equation for geodesics in a Lorentz metric, it has two types of local solutions:
" space-like" solutions which locally minimize E, and " time-like" solutions
which locally maximize Em. A general solution flips back and forth between the
two types, with cusps marking the transition. Discussion of existence theorems
for solutions of this differential equation is postponed to a later paper.
We use the following standard notations throughout this paper:
(a) For k 2 0 an integer and 1 5 p
functions f on D with norm
is the Banach space of
(b) Ck is the class of functions with continuous derivatives through order k,
and Ck,' of those whose k-th derivatives satisfy a Lipshitz condition. The
boundary of a domain D is said to be in one of these classes if D is
represented locally by y < f ( x ) (or y > f ( x ) or x < f( y ) or x > f( y)),
where f belongs to the class.
2. The First Variation
As described in Section 1, we fix a region R in the plane with compact closure
and piecewise smooth boundary and we fix a continuous function g on x. We
also fix positive constants p and v. We consider next a subset r c R made up of
a finite set { y,} of curves. We shall assume for our analysis initially that the y,
are simple C','-curves meeting aR and meeting each other only at their end-
points. Finally, we consider a function f on R - I' which we take initially to be
OPTIMAL APPROXIMATIONS
C’ with first derivatives continuous up to all boundary points.2 For each f and
r, we have the functional E defined in Section 1:
The fundamental problem is to find f and r which minimize the value of E.
Note that by a scaling in the coordinates x , y in R and by a multiplicative
constant in the functions f, g, we can transform E with any constants p, Y into
the E for any other set of constants p, v. Put another way, if p is measured in
units of inverse distance in the R- plane, and the constant v is measured in units
of (size of g)’/distance, then the three terms of E all have the same “dimension”.
So fixing p, v is the same as fixing units of distance in R and of size of g. The
purpose of this section is to study the effect of small variations of f and r on E
and determine the condition for the first variation of E to be 0. These are, of
course, necessary conditions for f and I’ to minimize E.
The first step is to fix r as well as g and vary f. This is a standard variational
problem. Let Sf represent a function of the same type as f. Then
E ( f + t Sf, r> - E(f, r)
Integrating by parts and using Green’s theorem3 we obtain
2We shall weaken these conditions later to include certain f’s with more complicated boundary
behavior, but this will not affect the initial arguments. Appendix 1 contains a full discussion of how
regular the minimizing functions f will be at different points of R.
’For Green’s theorem to be applicable, we must assume that f E 5’’.
some p 2 1. Alternatively, by
the last equation, a minimum f is a weak solution of o’/= p 2 ( f - g) and, by the results in
Appendix 1, f in fact has L P second derivatives locally everywhere in R - r.
D. MUMFORD AND J. SHAH
where B is the entire boundary of R - r, i.e., aR and each side of r. Now
taking 6f to be a “test function”, non-zero near one point of R - r, zero
elsewhere, and taking the limit over such 6 f , we deduce as usual that f satisfies
on R - r. Now taking 6f to be non-zero near one point of B, zero elsewhere, we
also see that
= 0 on dR, and on the two sides y,’ of each y,.
As is well known, this determines f uniquely: the operator p 2 - v 2 is a
positive-definite selfadjoint operator, and there is a Green’s function K ( x , y ; u, u )
which is C” except on the diagonal ( x , y) = (u, u ) where it has a singularity like
log( p / ( x - u)’ + ( y - u )2 )
such that, for each component Ri of R - r, and for each g,
satisfies (*) and (* *) on Ri. Further regularity results for this boundary value
problem especially on the behavior of f near I’ are sketched in Appendix 1 and
will be quoted as needed.
If there were no boundaries at all, then Green’s function for this operator and
the whole plane is obtained from the so-called “modified Bessel’s function of the
second kind” KO (cf. Whittaker and Watson , Section 17.71, pp. 373-374):
where K,(r) (defined for r > 0) is the solution of
K,”+ T K , ’ - K , = O
K o ( r ) - log(I/r)
for r small,
~ , ( r ) - m e - r for r large.
Its graph is depicted in Figure 7.
OPTIMAL APPROXIMATIONS
Figure 7. Graph of the Green’s function and its asymptotes.
Another way of characterizing K is that it is the Fourier transform of
evaluated at (x - u, y - u).
Now look at the variation of E with respect to r. First consider moving r
near a simple point P of r. Such a P lies on exactly one y, and, as y, is C1*’,
can write it in a small neighborhood U of P either as a graph y = h ( x ) , or as a
graph x = h(y). Assume the former; then we can deform y, to
y = h ( x ) + t S h ( x ) ,
where Sh is zero outside a small neighborhood of x ( P ) (see Figure 8). If t is
small, the new curve y,(t) does not meet any other ys’s except at its endpoints
= ya(t) u U
is an allowable deformation of r. Now we cannot speak of leaving f$xed while
r moves, because f must be C’ on R - I? but will usually be discontinuous
across r. Instead do this: Let f+ denote the function f in
u+= ((X,Y)lY
’ h ( X ) }
and let f- denote f in
D. MUMFORD AND J. SHAH
Figure 8. Deformation of r
and choose C’ extensions of f’ from U+ to U and of f- from U- to U. By the
results in Appendix 1, f is C’ on both sides of r at all simple points of r, hence
this is possible. Then for any small t, define
if P E U , P below y,(
if P E U , P above y,(t),
extension of f-
+ v / [ / l + ( h + t8h)” - 4-1
OPTIMAL APPROXIMATIONS
Since y, is in C’.’, it has a curvature almost everywhere which is bounded and is
(x, h (x)) =
(1 + h f ( X ) 2 ) 3 ’ 2 ’
where curv > 0 means that y, is convex upwards (i.e., U , is convex, U- is not)
while curv < 0 means y, is convex downwards (i.e., U- is convex, U, is not).
Integrating by parts, we get
(ds = infinitesimal arc length on y,). Note that the coefficient Sh/ 41 + h” has
the simple interpretation as the amount of the displacement of the deformed r
along the normal lines to the original r. Since this formula for GE/Sy holds for
any Sh, at an extremum of E we deduce that, along each y,,
[ p 2 ( f + - g)2 + ,,,+,I2]
- [r2(f-- d2
+ llof-1121
+ v curv(y,) = 0.
The terms in square brackets can be simply interpreted as the energy density
corresponding to the functional E just above and just below the curve. In fact,
write the energy density as e:
then ( * * *) says
e ( f + ) - e ( f - ) + v curv(y,) = 0 on y,.
D. MUMFORD AND J. SHAH
(Note that if we fix f’ and f-, then what we have here is a 2-nd order ordinary
differential equation for y,.)
Next, we look at special points P of I‘:
(a) points P where r meets the boundary of the region R,
(b) “corners” P where two y,’s meet,
(c) “ vertices” P where three or more y,’s meet,
(d) “crack-tips” P where a y, ends but does not meet any other ys or aR.
Before analyzing the restrictions at such points implied by the stationarity of E,
we should reconsider what assumptions may reasonably be placed on f . We saw
above that for each fixed I’, there was a unique minimizing f: the f satisfying the
elliptic boundary value problem (*), (* *). If I? is C’,’ and g is continuous, then
the standard theory of elliptic operators sketched in Appendix 1 implies that f is
C’ on the open set R - r and that, at all simple boundary points of I‘ and aR,
f extends locally to a C’-function on the region plus its boundary. This shows
that (* * *) certainly holds along each y,. However, at corners, p is not always
such a nice function. In fact, the typical behavior of f at a corner point with
angle a is shown in the following example:
Let z, w be complex variables and consider the conformal map w = z”’~
between R, and R, (see Figure 9). Let z = reie and let
Then f is a real-valued function on R, with
af = O on a ~ , .
Figure 9. Straightening of a comer by a conformal map.
OPTIMAL APPROXIMATIONS
But note that
has an infinite limit as r + 0 if a > IT.
V. A. Kondratiev discovered that this type of singularity characterizes
what happens to the solutions of elliptic boundary value problems at corners or
even in “conical singular points” of n-dimensional domains. We have collected
the results we shall use in Appendix 1, where it is shown that
(a) f is bounded everywhere,
(b) f is C1 at comers P of R - r whose angle a satisfies 0 < a < T,
(c) at corners P such that n < a 5 2a, including the exterior of crack (i.e., P
is the endpoint of a C’*’-arc which is not continued by any other arc), f has the
where fl is C’, (r, 6) are polar coordinates centered at P and c, 6, are suitable
constants.
Using these estimates, let us first show that if E(f, r) is minimum, then r
has no kinks, i.e., points P where two edges y, and yj meet at an angle other than
n. To do this, let U be a disc around P of radius E and let yi U yj divide U into
sectors U- with angle a d > n and U’
with angle a + < n (see Figure 10). We
assume 0 < a+< n and hence n < a-< 2n. Fix a C”-function q ( x , y ) such
Figure 10. A comer in r.
D. MUMFORD AND J. SHAH
that 0 5 17
and let q, denote 17 “adapted” to U,
(so that qu = 1 outside U, q , = 0 in the concentric disc U’ of radius 4~).
shrinking Ut
and expanding U-;
define a new f on the new U+ by restriction; and define a
new f on the new U- by f - ( O ) + q,(f--
f-(0)). Let us estimate the change in
E(f, r). To make this estimate we can assume that f - ( O ) = 0 by replacing f by
f - f-(O), g by g - f ( O ) , which does not affect E. Then we have:
What we will do is to “cut” the corner at P at a distance
(a) Change in 1-st term:
JJ (17ur- d2 - JJ (f-- g)’
(b) Change in 2-nd term:
But JIvq,JI 5 C / E . Moreover, the estimates just discussed show that
Taking into account that vqU = 0 outside the annulus between E, +E, we can
OPTIMAL APPROXIMATIONS
Figure 11. “Cutting” a comer on r
bound the above expression:
= C3&2T/a-*
(c) Change in 3-rd term:
Asymptotically, we are replacing the equal sides of an isosceles triangle with
angle a+ at apex by the 3-rd side (see Figure 11) which decreases the length term
in E from E to E sin(ia+).
Note that terms 1 and 2 increase by order E~ and E * “ / ~ - , respectively (and
27r/a-> l), while term 3 decreases by order E which shows that if E is small, E
decreases.
The same argument gives us more results. Consider next points P where an
arc y, of I‘ meets the boundary of the region R where the problem is posed. At a
minimum of E , we claim that y, must meet aR perpendicularly. Let U be the
intersection of a disc around P of radius E and R, and suppose instead that y,
divides U into a sector U+ with angle a+< $7 and a sector U- with angle
a-> $7 (see Figure 12). We modify I‘ and f as follows: replace y, by a new
curve which, when it hits U,
has a corner and follows a straight line meeting aR
perpendicularly; replacef’by its restriction, and f- by f-( P) + qu *(f - f-( P)),
extended by
f-(P). The above estimates show that
the first two
terms go up by order at most E’, while the 3-rd decreases by order E, hence E
decreases.
Look next at triple points P where three arcs y,, y,,
yk meet with angles a,,,
aJk, akr (see Figure 13). We claim that, at a minimum of E , a,, = aJh = (Yk, = 3..
If not, then one of the three angles is smaller than $T: say aJk < f~
diagram. Then modify I? by extending y, along the bisector of angle aJk and
joining it by straight lines to the points where y, and yk first meet U (see Figure
13). The new triple point is chosen so that its three angles are each f r . A little
trigonometry will show that the old segments of y, and yk of total length
D. MUMFORD AND I. SHAH
Figure 12. r meets the boundary of R
asymptotically equal to 2~ are then replaced by three new straight segments of
total length exactly
which is clearly less than 2~ if txJk < $r. This linear decrease in length is greater
than the increase in the 1-st and 2-nd terms of E by the same argument as
Finally, we can apply this argument to show that at a minimum of E there
are no points where four or more y, meet at positive angles; simply choose the
smallest angle (Y at the intersection. Then a 5 5..
and replace the 4-fold
intersection by two 3-fold intersections as in Figure 14.
In all of this, we have ignored “cuspidal corners”, i.e., corners where the two
arcs yi and y, are tangent. Our argument breaks down for cusps, but we can
show that these do not occur by another argument. We cut off the end of one of
Figure 13. Modifying a triple point in r.
OPTIMAL APPROXIMATIONS
Figure 14. Splitting a 4-fold point into 2 triple points.
the arcs y,, join it to the nearest point of yj and leave the end of yj as a
"crack-tip" (see Figure 15). To extend f - from the old U- to the new bigger
U-= U - crack yj, we simply extend it from y, by asking that f- be constant on
circles with center P. Again the length decreases by order E. To check the increase
in the 1-st and 2-nd terms, note the estimate on f-:
f - = f - l @ ) + o(fi),
Write y, in polar coordinates as B = d,(r) and yj by B = Bj(r), so that B, - Bj =
O(r). Thus the new part of the second term is estimated like this:
This proves:
2.1. If ( f , I?) is a minimum of E such that r is a finite union of
simple C','-curues meeting aR and meeting each other on& at their endpoints, then
Figure 15. Eliminating cuspidal comers in r.
D. MUMFORD AND J. SHAH
__________
Figure 16. An image leading to a r with a crack
the only vertices of r are:
(a) points P on the boundary of R where one y, meets aR perpendicularly,
(b) triple points P where three y, meet with angles 4m,
(c) crack-tips P where a y, ends and meets nothing.
3. Cuspidal Crack Tips
Considering the original variational problem, we would first like to argue
heuristically that “cracks”, i.e., arcs in r that end at a point P without any
continuation, are likely to occur in minima of E. Take g to be a function of the
type shown in Figure 16. If v is set carefully, it will “pay” in terms of decreasing
E to have an arc of r in strip A separating the g --= 0 and g = 1 regions but it
will not pay to have arcs of l? in strips B and C: this is because g has been
concocted so that its gradient is much larger in strip A than in B or C; so putting
I’ along A saves a big penalty in jlll~f11~
but putting I? along B or C does not.
We expect that in this case the optimal r will run along A to a crack-tip
somewhere in the middle.
However, if I(vgll is somewhat larger in B than C, the crack will be expected
to bend to the left into B at its tip. Consider the rule which determines when r is
in balance between bending left or right:
At the crack-tip itself, (f,- g)2 is bounded, but llvfJ2 is not. Ilvf+l12 grows
like l / r , where r is the distance to the crack-tip. Some cancellation takes place in
l l ~ f + 1 1 ~ - l l ~ f - 1 1 ~ . Suppose for instance that the crack-tip is the positive x-axis
OPTIMAL APPROXIMATIONS
and f is approximated by
f*= * c 9 &
(which satisfies ( d f / d n ) + - = b',f/dy = 0). Then
which still grows unboundedly near the crack-tip. Thinking of (*) as an O.D.E.,
one would expect that this growth would, in general, force curv(r) to grow like
also. Curves that do this are curves with cusps at their endpoints:
cuW(r) = (1 + y,2)3'2
For this reason, it seems logical to expect that crack-tips have cusps at their
end. To confirm that such I' were consistent, we have made a careful calculation
to produce functions f and g and a cuspidal crack r satisfying the variational
equations (*) and Af = p 2 ( f - g). In outline this goes as follows.
We work backwards:
(i) Start with r given by
y = x3l2 + A,x2 + A2x5I2,
where A,, A, will be chosen later.
(ii) Choose f of the form
f = fsing + fsrnooth,
3pr cosh( pr ) - 3 sinh( p r )
p2 ( r ) 3/2
sin( $ 0 )
(Y will be chosen later, and fsmooth is a C"-function. It is easy to verify that
D. MUMFORD AND J. SHAH
(iii) Choose
g = f smooth -p.
v *fsmooth.
Then by the choice of f and g, it is clear that
A f = P2(f - g ) .
Also, the leading term of f is
hence the extra variational condition, Griffith's law of cracks, derived later in this
section is satisfied. We must check that for suitable A,,
A,, a and suitable f
smooth, we also get
(a) af/anl, = 0,
(b) e+- e-= v curv(I').
Tahng into account that
f+ = fsmooth + fsing 3
f - = fsmooth - fsing ,
and the definition of g, (b) simplifies to
v curv( I?)
4pL-2 v 'fsmooth
fsing + '-
(where a/at is the directional derivative along r). The construction of fsmooth is
rather tedious and the values of the constants messy, but in outline, we may see
that a solution is possible like this: Parametrize r by x. Then (1,' 6)(
d / d n ) fsing
is a power series in fi beginning with
and curv(r) is a Laurent series in 6 beginning with
+ 2A1 + @A2 - g ) 6 + *
and (1/ G)( a/at)fSing is a Laurent series in 6
beginning with
OPTIMAL APPROXIMATIONS
So we must solve the partial differential equations
= (2 + 2h,G + -
Looking at low-order coefficients, it turns out that fsmmth
has three too few
coefficients: in fact, if
fsmooth = 16
+ higher order terms,
then the constant terms in (a) and (b') are OK, but to make the &-coefficients
cancel we must set A, = 3/77 and a = 3(1 + & r 2 ) / p
Likewise the three
quadratic coefficients in fsmooth and A, are needed to make the x- and x3/2-
coefficients cancel. Thereafter the four terms x", x " - l y , xn-'y2 and x"-3y3 in
fsmooth are sufficient to satisfy (a) and (b') mod x n . To see that convergence is not
a problem, note that as soon as fJ:&th
satisfies (a) and (b) mod x3, we can set
Substituting in (a), we solve for unique f l , f2 by dividing:
(noting that ( a/an)(y2 - x3)Ir = 2x3/2 + . . . , so this is OK so long as x 3 I 2
divides the numerator). Substituting in (b), we solve similarly for f3 and f4,
dividing this time by
In Section 1, we derived extra variational equations at triple points and
boundary points of r. There is also a new variational equation at crack-tips. It is
the analogue of Griffiths' law of cracks well known in solid mechanics; see .
The difference is that in our case, cracks can be "sewn" back together as well as
D. MUMFORD AND J. SHAH
extended, hence we get an equality at critical points of E , not just an inequality.
The result is this:
THEOREM 3.1. Let f,
be a critical point of E , and assume r includes an arc
ending at P of the form
y = ax3/, + g ( x ) ,
g ( x ) E C 2 , g(O) = g'(O) = O
in suitable coordinates x , y where a may or may not be zero. Then if, near P ,
we must haue
To derive Griffiths' law of cracks and at the same time check for possible
further conditions on a solution (f, I?) related to sideways perturbation of
crack-tips, we use the general technique for deriving the first variation whxh is
employed in geometric measure theory for highly singular r's. Let X be a
Coo-vector field on R , tangent to aR and let a, be the one-parameter group of
diffeomorphisms from R to R obtained by integrating X . We want to compare
E( f a a,, @;'(I?))
with E( f, r) and, especially, compute
For simplicity, we shall assume that X is locally constant near crack-tips in I?.
First, write
length @,-'r - length I'
Call these terms T,, T, and T,. To evaluate the first integral TI, let
OPTIMAL APPROXIMATIONS
be the band swept out by r while moving from r to @,-l(I?)
This follows from the Lebesgue bounded convergence theorem, plus the
LEMMA 3.2. Near a. crack-tip P,
Ih,(x, u ) I 5 C / O ?
where d is distance from (x, y ) to the line { @, ( P ) It E R }.
Proof: The leading term in f 0 @, is
where z is a suitable complex coordinate centered at P , a E C, c E R. The
corresponding term in h, is
1- - cger-
z - a t + h '
But in R - B,,
(let z = rl exp( idl}, z - at = r2exp{ id2}. Then, if 18, - 8,1 5 T,
= rl + r2 + \Ir,r,cos(f(e, - e,)) 2 rl.
In R - B,, 113, - d21 r n (see Figure 17). Therefore the leading term in h , is
bounded by c/ m, hence c/ 0.
The remainder S in f satisfies S E o( rl-'),
D. MUMFORD AND J. SHAH
Figure 17. The function 0, -
E ~ ( r - ' ) for all E > 0, hence the remainder Sr in h , satisfies
ISt( Z ) 1
SUP llVRll( z - U S ) 5 Cd-'.
This proves the lemma.
The rest of the first integral is
which equals
( f, - = boundary values of f along I?).
the crack-tips P of
translation on D and
To evaluate the second integral T2, let D be a union of discs D, around all
of small radius 8. Since X is constant in D, @t is a
Therefore the second integral equals:
OPTIMAL APPROXIMATIONS
As above, define
Then it is easy to check that
llvfl12 - JJ
where ( r , 8 ) are polar coordinates at P and 0, is the direction of X( P). At each
crack-tip P, write
f = C P 9 & + sp.
where S i E ~ ( r - ' ' ~ - ~ ) .
Therefore,
D. MUMFORD AND J. SHAH
Finally the thrd term T3 is easily evaluated as
where K ( P ) is the curvature of r at P , iip, 7', are the unit normal and tangent
vectors to I?. Putting this together, we get
K d s + c 2 /
+ c c V ( X Q * G ) +0(6).
singular branches
Now let 6 -+ 0. Use the fact that A f = p2(f - g) on R - I?, and that e + - ec+
V K = 0 along r, as proved in Section 1. Moreover, at all singular points Q other
than crack-tips, it follows as before that either Q is a triple point with 120"
angles, hence
or Q is a point where r meets aR perpendicularly, hence ( XQ G)
= 0. Thus all
terms drop out as expected except for those at crack-tips, where we have
At each P, take coordinates such that r is tangent to the positive x-axis, and
OPTIMAL APPROXIMATIONS
write f = C, 986 + S,. Suppose X = a a / a x + j3 a/ay. Then
from which it follows easily that
4. Approximation when p is Small
We derive here limiting forms of the energy and its first variation when p is
small. As before, let fr minimize E(f, r) for fixed r. Let R, be the components
R - r = R, u ... UR,
function constant on each R ,
g r = ( with value mean,, ( g ).
We shall prove that fr is very close to 8, when p is small. Throughout this
section, we assume that r is a finite union of C’,’-arcs meeting at corners with
angles a, 0 c a c 2 ~ ,
or ending at crack-tips.
The error term depends on the smallest “necks” of each component R,. For
any region W, define the isoperimetric constant h( W ) by
y is a curve dividing W
sets W, and W2
into 2 disjoint open
h ( W ) = inf
where IyI = length of y and IK.1 = area of W, (compare Figure 5). Note that we
have excluded cuspidal corners on the components Ri of R - r so h(Ri) is
positive. A bad case is shown in Figure 18. Let
A, = minh(R,).
D. MUMFORD AND J. SHAH
Figure 18. A domain with zero isopenmetric constant.
As in the introduction, we write
We now set vo = v/p2.
Proof: Let f, = fr - 8,. and g, = g - 8,. Then fi satisfies the equation
v 'f, = p2( fl - g,) in R - r and homogeneous Neumann boundary condition
along r u aR. By Green's identity for each component W of R - r,
fig1 = JJ-V2f1
+ P2f1)fl = J lVfiI2 + P2J r: - J ant,.
Since the last integral is zero,
(4 llvrlll:,2, w + cL211fl11:,2.
5 P2llf1llo,2. w Ilg1ll0,2, w
by Cauchy-Schwarz inequality. By Cheeger's inequality (see ),
OPTIMAL APPROXIMATIONS
Since lwg1 = 0 and, by Green’s identity,
Therefore,
llvflll;,2, w 1 ah2(W)llflll;,2, w 2 a ~ ~ l l f l l l ~ , 2 ,
Combining (a) and (b), we have
Squaring these inequalities and summing over the components of R - I‘, we
obtain the same inequalities with W replaced by R - I?. Finally,
= 2P2Jf1& - P2/f: - J IVfll’
= P2/f&-1,
by Green’s identity as above,
so the theorem follows.
D. MUMFORD AND J. SHAH
We consider now the first variation of E ( f r , r). Let Ck(I’) be the space of
continuously differentiable functions on y which vanish in a neighborhood of the
singular points of r. For each cp E Ci(I’) and all sufficiently small r > 0 define
nearby curves rTq as follows: let ( x ( s ) , y(s)) be a local parapletrization of r by
arc length. Then rTq is the curve
( x ( s ) , A s ) ) + .cp(s)(-Y’(sL
x ‘ ( 4 ) .
where J/o = (g,‘- g,)(g; + g, - 2g), K = curvature of r.
(ii) There exists a constant C, independent of p (but which depends on r) such
Proof: Since 8,
minimizes E(f, r) over the space of locally constant
functions over R - I‘, the first variation formula in part (i) follows in the same
way as in the general case, derived in Section 1.
Define fi and g, as in the proof of Theorem 4.1. Let
The left-hand side in the inequality in part (ii) equals
We need to estimate ~ ~ f l ~ l l , 2 , aw. The boundary value problem
OPTIMAL APPROXIMATIONS
has a solution provided that jwu = 0 for all components W of R - r. The
solution is unique if we require that jwu = 0 for every W. In this case, since r
has no cuspidal corners, u E Wt(R - r) for every p , 1 5 p < $, by Appendix
Ilu112,p, R - T 5 clllullO,p, R-T,
where C, is a constant which depends on r. Applying this to the equation
v 'fl = P2(fl - gl), we get
llhllz,p,w 4 P2cl(llfillo,p,w + Ilglllo,p,w).
Since L2( W ) embeds in Lp( W) and we know from the proof of Theorem 4.1
IlflllO,Z, w 5
+ 4p2 Ilglll0*2, w,
ll.fll12,p,w 5 P2C211g1110,2, W'
By the trace theorem (see ), the restriction of u E Wp?(W) to dW defines a
continuous linear map
w,"(w) -+ w;(aw) c w;(aw).
Therefore there exists a constant C, depending on F such that
l l ~ l l l l , 2 , aw 5 C3P llg1lIo,2, W'
Going back to the energy density el(I'), we have
5. Existence of Solutions when p = 0
In case p = 0, our free boundary value problem is not much more compli-
cated than minimal-but
singular-soap bubble problems. This is an especially
easy case since we are dealing with singular sets r which have dimension as well
D. MUMFORD AND J. SHAH
as codimension equal to one. The main result of this section is
5.1. Let R be an open rectangle4 in the plane and let g be a
continuous junction on R U aR. For all one-dimensional sets I’ c R such that
r U 8R is made up ofafinite number of el*’-arcs, meeting each other only at their
end-points, and, for all locally constant functions f on R - I?, let
Then, there exist an f and a r which minimize E,.
Geometric measure theory approaches problems of this sort by embedding
them in larger minimizing problems in which extremely singular ’s are allowed,
then showing that in this larger world, a “weak solution” I‘ exists and finally
arguing that any weak solution r must be of the restricted type envisioned in the
original formulation. As a weak version of our problem, we consider segmenta-
tions of R by Cacciopoli sets which are measurable subsets of R with finite
“perimeter”. Our standard reference for geometric measure theory is the book by
L. Simon . We let L2 denote the Lebesgue measure on W 2 and H1 denote the
one-dimensional Hausdorff measure on W ’.
We begin by recalling De Giorgi’s theory of Cacciopoli sets (see Section 14 in
 ). A bounded subset F of W 2 is called a Cacciopoli set if it is L2-measurable
and has finite “perimeter”; that is, the characteristic function x F of F has
bounded variation. For such a set F, there exists a Radon measure pF on W 2 and
a pF-measurable function qF: W 2 -, W 2 with IqFI = 1 pF-a.e. such that
for all C’-functions g’: R 2 + W 2 with compact support. We call p F the “gener-
alized boundary measure” and qF the “generalized inward unit normal”. Let
D x F denote the gradient of xF in the sense of distributions. Then, DxF = qF dpF
and q,, p F can be recovered from DxF by
4The restriction to a rectangle R is not essential, but simplifies some technical aspects of the proof.
OPTIMAL APPROXIMATIONS
where Bp(x) denotes the ball of radius p, centered at x. The “perimeter” of F is
defined to be equal to pF(R2). Notice that if Fl = F2 L2-a.e., then p4(W2) =
We may restate these results in the language of currents. Let F‘ be the
2-current defined by F:
for all C“ 2-forms cp with compact support. Let aFdenote the current boundary
for all C” 1-forms cp with compact support. Then
For any set S, let as be the topological boundary s - Int(S) of S. Then the
topological boundary aF of a Cacciopoli set F may have positive L2-measure and
hence, infinite H’-measure, even though F still will have finite perimeter.
Fortunately, it is possible to define the reduced boundury a*F so that the
perimeter of F equals the H’-measure of a*F:
qF( x ) as defined above exists
and has length 1
By De Giorgi’s theorem (cf. , Section 14):
(i) a*F is 1-rectifiable.
(ii) pF = H’La*F (i.e., H’ restricted to d*F).
(iii) For any set S c R2, x E W2, p > 0, let
Then for every point x E a*F, the approximate tangent space Tx,a.F exists and is
given by { E W21
v F ( x ) = 0}, i.e.,
D. MUMFORD AND J. SHAH
for all continuous j with compact support. Moreover,
lim j jdL2=
( YIY'?F(x)'o)
for all j E L'(w~).
orient the 1-rectifiable set d*F, we obtain a 1-current a s u c h that
(iv) Rotating q, by 90" defines a unit tangent vector t, to d*F. Using t , to
d ( F ) = ( d * F )
In particular, for all bounded open subsets U c R2, the mass Mu( dF') equals
H'(U n a*F).
We next reformulate E, using Cacciopoli sets. Note that if r has an arc y
which is surrounded by a single component of R - r, we can reduce the energy
E , simply by removing y. Hence, we might as well assume in our original
formulation that the boundary of each component of R - r consists of piecewise
C1.'-loops which mutually intersect in only finitely many points (see Figure 19).
Therefore, for each component F of R - I?, and each arc y in aF, y is the
boundary of F from only one side; hence using the notion of the mass of a
length( J F ) = M( d F ) .
2 length( I?) + length( dR) =
( y R y P . )
length(I') = 7
(;E;Rc:y.)
Figure 19. Removable arcs y,.
OPTIMAL APPROXIMATIONS
This motivates the following new functional: fix some positive integer n , and
consider sets of n Cacciopoli sets, U,,
U2; * *, U,, such that
U , c R for lsisn,
For such { U,) and for all constants al; . ., an, define
E,({U,, a ; } ) =
)voMR( 8 q ] + 1
( g - ai)2dL2
This is our “weak” formulation. Note that to make a reasonable “weak”
problem, we have to fix n. However, the V, are required to be neither connected
nor nonempty. Hence,
We shall show:
5.2. (a) For each n 2 1, En takes on a minimum value for some
(b) If { U,, a , ) minimizes En, then each U, is an open set with aJinite number
(c) There exists an integer no such that
of components and piecewise C2 boundary.
for all n 2 no.
if n > no and each
is nonempty.
Clearly, this will prove Theorem 5.1. Now consider Theorem 5.2. Part (a) is an
immediate consequence of the compactness theorem for functions of bounded
variation (see , Section 6). In fact, if { U,., a:} is a minimizing sequence so
limEn( { v,
a : } ) = inf En,
then, by the compactness theorem, for each i , there exists a subsequence of { w)
D. MUMFORD AND I. SHAH
which converges to a Cacciopoli set U, (i.e., the integral of any L'(W2) function
converges to its integral on U,) such that
d * q ) 5 IiminfH'( d * v ) .
Moreover, minimizing with respect to a, is seen immediately to mean
Hence, we may assume that 0
suitable subsequence, all v
and a: converge, and
maxlg) for all i and a. Therefore, on a
inf E,, 5 En( { V,, a , } ) 5 liminfE,,( { Up, u p } ) = inf En.
The identity ZY-,
Part (b) is the hardest to prove. Our method is essentially a generalization of
the theory of minimizing currents of codimension 1. In outline, the proof is as
follows: Let
= R' passes to the limit so that Z:=, U, = R.
r* = U ( R n a*Q.
r* is the weak version of the set of curves I' specified in Theorem 5.1. We rewrite
E,, in terms of I'* and then consider the first variation of E,, with respect to r*.
This shows that I'* has generalized mean curvature and hence the monotonicity
formula of geometric measure theory applies. We conclude that if { V,, a , }
minimizes En, then I'* equals its closure r H'-a.e. in R. Hence, we may assume
that the U, are open and r is the union of their topological boundaries in R. We
next study the singularities of r. To do this, we first show that tangent cones
exist everywhere on r and that they have multiplicity away from the origin. We
conclude that the singularity set of r is discrete. Allard's theorem implies that r
is C2 away from singularities. The rest of the proof now follows easily.
Before giving the details of the proof, we introduce a construction which will
be used several times in the proof to handle the behavior of I'* along dR. This is
to consider a larger region R" built out of four copies of R centered around one
of the corners P of R; see Figure 20. The function g is extended to a continuous
function g" on R" by reflection. Thus suppose P = (0,O) after a translation.
Then in the situation of the figure
OPTIMAL APPROXIMATIONS
Figure 20. A segmentation reflected around a comer P.
Define q# to be the union of V, and its three mirror images in R#. Note that
MR+(dC*) = 4M,(aG). In fact,
R# = R, U R 2 U R , U R , U A,
where A is the part of the horizontal and vertical axes through P which is in R".
M,#( aG#) =
+ H'( a*zp n A ) .
a*G# = a$) + a Q 2 ) + a @ 3 ) + a@4)
and if a*U,# were to include a portion of A of positive H'-measure, it would
occur in two boundaries a*qca),
but with the opposite normal vectors 7:"). Thus
it would have to cancel out in a(@). This shows that in fact
En( { q#, u i } ) = 4 ~ n ( { ~ , ,
If (q, u i } minimizes En and if { V;, b,} is any other decomposition of R#, then
En({V;,biI) L C ' n ( { Y n R a y b i > )
B 4En({ V,, a i > )
= En( { q#, a , } ) ;
D. MUMFORD AND J. SHAH
hence { L$*, a , } minimizes En for g'
on R#. Finally, the curve I'#. * defined by
{ q*, a , } is obtained from r* and its three reflections and a set of H'-measure
zero in A.
We now begin the detailed proof.
F= 6 + G. Then,
Let Fl, F2 be Cacciopoli sets. Let F = F, U F2 and assume that
d*F = d*Fl U d*F2 - d*Fl n d*F2
Hence, for all open bounded subsets U c W2,
H'(U n d * F ) = [H'(u n d*F,) - H'(U n d*Fl n a * ~ , ) ]
Proof: Let M denote d*Fl U d*F2 and N denote d*Fl n d*F2. We shall
(i) N n d*F is empty,
(ii) M - N c d*F
(iii) d*F C M - N
(i) Let x E N. For p > 0, let
Fx, P = { p - ' ( y - x): y E F }
By De Giorgi's theorem, limpLo(4)x,p
= Hi, where H, is an open half-space in
W '. Hl and H2 must be disjoint. For, if Hl n H2 is non-empty, there exists a ball
B c Hl n H2 and f E C:(B) such that, for i = 1,2,
= 2 I 2 f d L 2 .
OPTIMAL APPROXIMATIONS
Therefore, there exists p > 0 such that
j fdL2 > j fdL2
which is absurd. It follows that Hl and H2 are complementary half-spaces; hence
limp .1 F,, = W and thus x 4 a*F by De Giorgi's theorem.
(ii) Let x E M - N, say x i a*Fl - N. Outside a set of H'-measure zero,
we may assume that the upper density @*(H', a*F2, x ) = 0. Write out qF(x):
Since @(H', a*F,, x ) = 1 and O*(H1, a*F2, x ) = 0,
Since Dx = Dx F, + Dx F2 it also follows that
Hence v F ( x ) exists and has length 1, i.e., x E a*F.
(iii) If x E a*F - M, we may assume that
o*(H', a*e., .)
Then, @*(H', a*F, X) 5 O*(H', a*F,, x ) + O*(H', a*F,, x ) = 0 and so
H'(a*F - M) = 0.
(a) for H'-a.e., x E r* betongs to precisely two a*qis,
Let Ul, U,, . * -, U, be Cacciopoli sets such that Cy-la = 2. Then,
(b) HILr* = +C;-',,H~L(R n a*u&
In particular,
Proof: (a) Suppose x E R n a*q for some i. Let u = ujZiq.
z - $ a q = a i ? - a v ' a n d h e n c e
R n a*y = R n a*u
D. MUMFORD AND J. SHAH
By Lemma 5.3,
R n a * u = U ( R n d * q )
- { y : y E (a*%) n (a*U,) n R for j , k # i } H'-a.e.
= { y : y E R n a*u, for some unique j z i }
(b) Let p = H'Lr* and pi = H'L(R n d*q):
D~ C pi(.)
by part (a).
Part (b) now follows from Theorem 4.7 in .
5.5. Let {Q,
ai} minimize En. Let r = closure of I?* in 2. Let qi
denote the generalized inward unit normal in R corresponding to the Cacciopoli set
V,. Letting q i be zero on I'* - a*q, deJine K : r* + R 2 by
(a) I?* has the generalized curvature K. That is, for all C'-vector Jields X on 3
tangent to i?R along aR, if DX is the 2 X 2 matrix of derivatives of the components
of X and if t : r* -, W 2 is a unit tangent vector (with any choice of signs),
t ) dH' = - i*(
(b) Monotonicity: Dejine a function E on 2 by
x is acorner of 2.
x E aR, but x is not a corner,
OPTIMAL APPROXIMATIONS
Then the density @( H', r*, x ) exists for all x E I', EO is greater than or equal
(c) r = r* H'-a.e. SO that tC;,,Mk(ag) = H1(I').
(d) We may assume that the U, are open and that r equals the union of their
to 1, and is upper semi-continuous.
topological boundaries in R .
Proof: (a) By Lemma 5.4,
En = voH'( I?*) +
Consider the first variation SxEn of En with respect to a C'-vector field X on R,
tangent to aR along aR. The formula
S,H'( r*) = 1
(t' DX t ) dH1
is standard, and
8 x 1 ( g -
dL2 = 1 div(( g - a,)'X) dL2
by direct computation,
( g - a,)'( vi X ) dH' by De Giorgi's theorem.
Since { V,, a,} minimizes En, SxEn = 0; hence
0 = y o k e ( t'
DX t ) dH' - 1 ( g - ai)*(vi X ) dH'
= yo[ L J i ' DX t ) dH' + 1
X d H 1 ] .
(b) The fact that @(H', r*, x ) exists at every point of R and that it is upper
semicontinuous follows from the monotonicity formula (see Corollary 17.8 in 
or Almgren-Allard [l]). Since I?* is rectifiable, O(H', r*, x ) =.1 H'-a.e. on
r*. (This follows from Lemma 5.4.) Hence, @(H', r, x ) 2 1 for all x E r n R
by upper semicontinuity. To extend this argument to R, we use the reflection
technique explained in the beginning of this proof. Then @(H', I'#. *, x ) exists,
is at least 1 and is upper semi-continuous on R#. But it is easy to See that
8(H1, I?*,
X ) = E(x)@(H', r*,
X) for x E R# n R , i.e., along edges of R, r*
is half of r". *, and at corners, r* is a quarter of r#. *.
(c) This follows from part (b).
(d) Let U = R - r. Since LZ(r) = 0, we may replace V, by q. n U witkout
altering En({V,, a,}). Let { V,} be the set of components of U. Then V, =
Xi( V, n V,):. hence, by the constancy theorem,
= Qca, n V,'for
exactly one
i( a). Therefore we may replace V, by U ,{ V,li( a) = i }.
D. MUMFORD AND J. SHAH
We now consider the tangent cones of r. Let
E r EO( H I , r, X ) = I}
By Theorem 6.3 in , for any sequence pk 40, there exists a subsequence
P k W 40 and Cacciopoli sets{V,} such that, for 1 5 i s n , (U,)x,Pk,,)
+ V, in the
L'(R 2, sense.
LEMMA 5.6. Suppose { U,, a i } minimizes En. Let x E r n R. Let Pk 40 be a
a*V,. and let
sequence such that, for 1 5 i 5 n, (U,.)x,p, -+ V,. Let N* = U
N = (closure of N* in R2). Then:
(a) J?x,pk -+ N*; that is, for all f E L'(R2) with compact support,
(b) N* is stationary in R2; that is, for all C'-vector fields X on R 2 with
compact support,
( t & D X tN*) dH' = 0.
Hence, we may assume that the V, are open and N is the union of their topological
boundaries.
(c) N is a finite union of rays and each K. is a finite union of sectors of R '.
(d) O(H', I?, x) E SH.
(e) If { t i } is the set of unit tangent vectors along the rays of N , pointing away
from the origin, then Cti = 0.
Finally, i f x E r n aR, (a) and (b) hold for the extension { U,", r"} described
above; hence (c) holds, E(x)O(H', r, x) E ti! and, along edges of R, Cti is
normal to the edge.
Proof: To simplify notation in this proof, let
so that, for any set S,
by a large factor p i ' .
is the same as f k ( S ) : the set S expanded around x
To prove (a), it is enough to show that
(i) for all w c w2 open, H'(N* n W ) 5 liminf, H'( fk(r) n w);
(ii) for all K c R2 compact, H'(N* n K ) 2 lim supk H'( fk(r) n K ) .
OPTIMAL APPROXIMATIONS
Since afk (U,) + a c, M w( a c) lim inf M w(fk( U,)) for all open W. Hence
(i) follows. Now fix K c R 2 compact and E > 0. Choose a smooth function
rp : R + such that
rp = 1 on K ,
SUPP(rp) = {YIdiSt(Y? K ) < E l .
Let k, be an integer such that
SUPP(rp) C f k ( R ) for k 2 k,.
Wa = { Y I F ( Y )
<(“) = q - f k ( q)
(difference of 2- currents).
Then M,(*(&)) + 0 for all open W C R2. By the slicing theorem, we may
choose 0 < a < 1 such that for 1 5 k 5 n and k 2 k,:
d(@k)LW,) = ( a p ’ ) L W , + Q!”,
Gik) = “slice” of @ k ) by a W,,
lim, M( Qik)) = 0.
Moreover, for suitable a, we may assume
M( afk(i7.) L aW,) = M(
L dW,) = 0.
The main idea is to define, for all k, a modified decomposition of R into
Cacciopoli sets { u,‘“)), namely:
u,(,) nfi1(w,) =f;l(v,),
n ( R - ti1(
w,)) = u,,
or alternately, define q(k)
as a current by
D. MUMFORD AND J. SHAH
Figure 21. Modifying a decomposition via its tangent cone.
But now EN({ q(k),
a,}) >= E,({ U,,
a , } ) by hypothesis, so
o 5 H’(N* n w,) - H1(fk(r) n wa)
It follows that
H’( N* n w,) >= lim sup H’( f k ( r) n w,)
H’(N* n {y:dist(y, K ) c E } ) 2 limsupH’(f,(r) n K ) .
Letting E 10, we get
H’(N* n K ) 2 limsupH1(f,(r) n K ) .
It follows that fk(r) -, N*.
OPTIMAL APPROXIMATIONS
To prove (b), note that f k ( r ) has generalized curvature K~ such that lKk(y)I
= p L I ~ ( p k y + x)l. Therefore, N is stationary by lower semicontinuity of varia-
tion measures (Theorem 40.6 in ). The rest of part (b) now follows as in
Lemma 5.5. Part (c) follows from Theorem 19.3 in . (d) holds because
O(H', r, x ) = O(H', N, (0)). Part (e) follows from part (b). The extension to
aR follows immediately by reflection.
a i } minimizes En, then rsing
Proof: Suppose that rsing is not finite. Let xl, x2, - . - be a sequence of
points in rsing - { x } converging to x. If x E aR, replace { U,, a i } by { U,#, a,}.
Let pk = Ixk - XI. If we replace { p k } by a suitable subsequence, then rx,pk
converges to a cone N as in Lemma 5.6. The points [ k = p;l(xk - x ) are on
aBl(0) and hence converge to a point [ E aB,(O). By monotonicity and Lemma
5.6, O(H1, N , 5 ) 2 limsupQ(H', rx,pk,
t k ) 2 l$.
Therefore, [ E N - (0). But,
O(H', N, y) = 1 for all y E N - {0} by Lemma 5.6. Contradiction!
If { U,, a i } minimizes En, then rre, is C2.
Proof: By Allard's regularly theorem (see Theorem 24.2 in ), rreg
Its curvature K is Co along r,, since g is. It follows from the standard regularity
theory of elliptic differential equations that r,,, must be C2.
Proof of Theorem 5.2:
Parts (a) and (b) have already been proven. Note that
the theory of Section 1 now applies and we have a classification of the singulari-
ties of I?. The key point in proving (c) is to show that
for all components W of R - r. Notice that the inequality does not depend on n.
To prove the inequality, suppose that there is a W for which the inequality is
false. First consider the case when one of the components y of aW is wholly
contained in R, i.e., does not meet aR. Let m be the number of singular points
on y. We claim that m 5 6. To see this, orient y and let { Oi} be the set of angle
changes in the tangent directions at the singular points of y (see Figure 22).
By the Gauss-Bonnet formula,
where K is the curvature vector and n is the inward unit normal. By the results of
D. MUMFORD AND J. SHAH
di positive when counter-clockwise
Figure 22. Conventions for the exterior angle 6,.
Section 1, 0, = f n for all i. By Lemmas 5.4 and 5.5,
It follows that
Therefore y contains a C2-arc I of length greater than or equal to ilyl. Suppose
1 c V, n U;, where Q meets 1 along the side interior to y. Let W' be the
component of U, meeting 1. Consider a new segmentation { U,'} of R so that
U,'= q- *,
v,'= q+ *,
U,l = U, if
k # i, j .
A E , = E , , ( { U , , a i } ) - En({U,',ui}) 1 vol- 21gl;,*area(W').
By the isoperimetric inequality,
area(W') 5 -
Therefore,
> ivolul(i) > 0
which is a contradiction since { V,, ai} minimizes En.
OPTIMAL APPROXIMATIONS
If R n aW does not contain a loop, then it must have a component y
meeting aR twice. Moreover, since ( R n dWI < width(R), y cannot meet the
opposite sides of R. Now we apply the reflection construction where R" is
obtained by reflecting R across the two sides met by y. Let W" be the set in R#
corresponding to W, obtained by reflecting W. Then 8 W" must contain a loop
y*. We argue now as before to get a contradiction again.
Observe that
5 En({ y , b i } ) , where V, = R , 6, = 0 and r/: = 0 for i > 1,
area( R ) .
Therefore,
(2/vo)lglL
[number of components of R - I'] 5 min{ vv/12(glk,, width( R)} .
Part (c) of Theorem 5.2 now follows.
6. Approximation when p is Large
We derive here limiting forms of the energy and its first variation (along
smooth portions of r) as p + 00. When p is large, the effect of r on the energy
is essentially confined to a narrow strip along r. We can even express the
contribution of r to the energy as an integral along r and analyze the first
variation in the form of variation of this line integral. The whole approach is
based on the following:
LEMMA. Suppose gp satisfies the equation V 'g, = p2(gp - g ) everywhere in R
and ag,/anlaR = 0. Let fr minimize E( f , r) with r fixed. Let hr = fr - g,,.
where the superscripts + and - distinguish between the values of a variable on the
two sides of r and a/an is the normal derivative in the direction from the - side to
the + side.
D. MUMFORD AND J. SHAH
by Green’s identity.
The lemma follows since the first integrand in the last step is zero and ahr+/an
= a h f / d n = -ag,,/an along r.
Thus r minimizes E ( f r , r) if and only if it maximizes the line integral
h-) - v] ds,
where h is the solution to the boundary value problem
v 2 h = p2h on R - I-,
To understand the limiting behavior of this integral as p + 00, we need to
describe the asyinptotic behavior of hr as p + 00. This involves considerable
technical details, which we have put in Appendices 2 and 3. Appendix 2 is
devoted to proving that
SUP Ihr(P)I = O(l/p)
as p -+ 00.
This estimate is very simple away from I‘ and near smooth points of r, but to
prove this near singularities of r seems harder (in fact, we had to exclude cusps
on I’). Appendix 3 is devoted to studying hr near smooth points of I‘ and
OPTIMAL APPROXIMATIONS
deriving the precise asymptotic form. Introduce coordinates r and s along r,
where r ( P ) is the distance from P to the nearest point F on I' and s ( P ) is arc
length on r from some origin to F (see Figure 3, Section 1). We can prove that if
I? is sufficiently smooth, e.g. C3q1, then
where K(S) is the curvature of I' at s. The proof is rather long, however, but the
essence of it, a careful application of Green's theorem, is given in Appendix 3 for
the points on I?, where we shall use it. It is easy to derive the form of this
expansion for hr by examining the case r = circle, and using the explicit
expression for hr in terms of Bessel functions of the 2-nd kind (cf. ,
An interesting question is to find the asymptotic expansion of hr for large p
near the singularities of r. We were quite puzzled looking for appropriate
"elementary" functions from which to construct this expansion. In the case where
r is the positiue x-axis, John Myers found a beautiful explicit formula for the h ,
satisfying
(a) V 2 h r = p2hr,
(b) ahr/dn = 1 along I',
(c) hr(x, y) = sgn(y) e-Py/p if x >> 0, lyl 5 C,
(d) hr = O(e-Pr) if 0 < 8, 5 8 5 27 - 0,.
Using ths: error function, he introduces
One can check that (a) and (d) hold for g and that (b) and (c) also hold for
h r ( x , Y ) = g ( x , Y ) - g ( x , -v)-
Using this special hr, one should be able to construct good asymptotic approxi-
mations to the general h, near crack-tips, as p + bo.
Applying the estimates for hr in Appendices 2 and 3, we can estimate the
behavior of E( fr, r) when p + 60 and r is Jixed. As in the introduction, we
We now set vm = ipv. Then we have
6.1. Suppose that g is C'.' and that r is the union of Jiniteb many
C'.'-arcs. Assume that I' U dR has no cusps. Then, as p 4
D. MUMFORD AND J. SHAH
Proof: We first construct g,, and derive estimates for it. Pave R 2 by
successive reflections of R about edges and thus extend g to all of IF2. The
solution g,, can then be expressed as
for all P E W2. Here KO is the zeroth-order modified Bessel function of the
second kind.
We need estimates on gp and its first and second derivatives:
~ ~ g p ~ ~ l , c o ,
R 5 const'llgllO,m, R.
Proof: To see this, we first note that, for n 2 0 and i = 0 or l5
K f ( p r ) = 2 r / rK,(pr) dr = F /
z K , ( z ) dz
by Lemma 3 in Appendix 3,
if pd >= 3log(plaRI).
OPTIMAL APPROXIMATIONS
Let d = dist(P, J R ) and let U, be the disc of radius d with center at P . Since
by Green’s identity,
- const.(pd)-”2e-~~llg((0,m,
by Lemma 3, Appendix 3,
D. MUMFORD AND J. SHAH
Therefore,
The remaining estimates may be proved in the same way.
We proceed now with the proof of the theorem. If r contains arcs which
terminate in free ends (i.e., crack-tips), extend these arcs in some C'x' way until
they meet I' u aR (without creating cusps, however). Let I; denote the extended
r. In order to apply the theorem in Appendix 3, we need to define several
constants which depend only on r. If y c y* c I? are curves, let
00, if y* is a connected closed curve;
arc length between y and the end points of y*,
min,d( y,, y,* ), in general, where y, are the components of y and
d ( y , y * ) =
if y and y* are connected and open;
y,* is the component of y* containing y,.
OPTIMAL APPROXIMATIONS
For some E > 0, we introduce constants:
= singular points of r U dR (including the crack-tips) ,
A p = the diameter of the largest circle through P
contained in a single component of R - ?;,
ye = { P E rldist( P, rsing)
A, = minA,.
Since there are no cusps and since each arc of r is C'.', there exist constants C,,
C2 and C, such that
A, 2 C ~ E ,
dist( y,, dR) 2 C2e,
arc length( - ye) 5 C3&.
Let C = fin{&, tC,, $C,}, LY, be the C2-norm of the i-th arc of r and
LY = max (xi. Let p be the universal constant as defined in Lemma 2 of Appendix
Now fix p 2 p o and let E = (6/pC)log(pldRI). Let y = y, and y* =
d(y, y*) 2 f e and if
8 = min( $, h d ( y , y*), $A,,,),
D. MUMFORD AND J. SHAH
Let hr = fr - gp as above. We now apply Part A of the theorem in Appendix
3. This shows that, for each component 51 of R - T‘,
Substitute the following estimates in this formula:
IIhrllo,m,
S IIgplIo,m, aa + Ilfrllo.m, an 5 2IlglI0,~.
Note that ahr/an must be estimated on i? - I’ as well as on r and it will
certainly have singularities at crack-tips. To deal with the last term, recall that
hr E W,”( R - I?) for 1 5 p c 4 by the results in Appendix 1. Therefore, by
Theorem 2.3.3.6 in Grisvard (applied to gp and f r separately),
I I ~ ~ I I ~ , ~ , R - - ~
5 ~ ~ g ~ ~ O , p . R - ~ o ( ~
) s ~ ~ g ~ ~ 0 , m , R o ( ~ 2 ) ~
by the trace formula in Sobolev spaces (see , Section 1.5). We get
By the theorem in Appendix 2,
OPTIMAL APPROXIMATIONS
It follows that
This finishes the proof of Theorem 6.1. Note that, by a similar argument, we can
also prove
We derive now the asymptotic form of the equation of first variation. We
show that the first variation of Em(r) agrees with that of E( fr, I?), at least when
is kept fixed. For simplicity, we assume that r consists of C2*l arcs only. We
shall work with an oriented piece y c I7 - rsing
and then label the left side of y
, the right side "+". This fixes the sign of the unit tangent vector t to y, the
unit normal n (let it point from the - side to the + side) and the curvature K of
y via its definition:
6.2. Assume that g is C2,'. Let y be an oriented C2,'-curve
contained in r, not meeting the singularities of I' U aR. Then for all C1-jields X of
normal vectors along r with support contained in y :
(i) The first variation is given by
D. MUMFORD AND J. SHAH
Proof: Let 9, = (X n). Let F(s) denote the parametrization of y by its arc
length. Let F,,(s) = F(s) + AX(s). For small 1x1, FA parametrizes curves y,, near
y. Let sA, t, and n,, denote, respectively, the arc length, unit tangent vectors and
unit normal vectors along y,,:
Hence, up to the first-order terms in A, we have
ds, = (1 - A ~ K )
t,, = to + A x n o ,
n,, = no - A-to.
Therefore,
( v g ) - S x n ] d s
(where a2g/an an means that, at each point of y, we take the 2-nd derivative of
g along the straight line normal to y at that point). But
(here a2g/as2 means the 2-nd derivative of g restricted to y ) and
so we get part (i) by substitution.
To prove part (ii), we now apply Part B of the theorem in Appendix 3. If r
has arcs terminating in free ends, extend these arcs to meet I' U aR without
creating cusps. Pick y* such that y c y* c r, dist(y, y*) > 0 and y* does not
meet the singularities of r U aR. Let 6 be the constant specified in the theorem
in Appendix 3. (We may choose S so that it serves all the components of R - F).
OPTIMAL APPROXIMATIONS
Let E = dist(y*, aR). Let pv = min{S, E } . Let R, = { P
E Rldist(P, 8R) 2 E } .
Following the method used in the proof of the lemma in Theorem 4.1, we can
extend the estimates for gp as follows. For all P E Re and for all p 2
3 log(PlaRo/P,,
(i) for 0 5 k 5 3, Ilg,,llk,m, R, 5 (const.)~~g~Ik.m,
(ii> \18,,1\4,m,
l\g\l3,co, R O(P),
(iii) Since
- fr - g,, as before. From Appendix 3 we get, for each component Ci
D. MUMFORD AND J. SHAH
Therefore,
( !!E)2 - ( 2)2]
= p2(h+- h-)(2gp - 2g + h++ h - )
as )( 2 - + -
Part (ii) of the theorem follows by substitution.
7. The Case p = 00
In the last section, we have argued that, in a certain sense, Em is the limiting
functional of E when p + 00 and S,uv has a finite limit vm. However, the sense
in question involves Jixing r while p increases. To see if this is reasonable,
consider the problem of minimizing the limit functional
over all r. There are two cases:
(a) suP,llvgl12 5 vm.
(b) For some P E R , IIVg(P)I12 > vm.
In the first case, Em is clearly minimized by r = 0. In the second case, we may
make I”s with more and more components each of which is a short arc from a
OPTIMAL APPROXIMATIONS
Figure 23. Conjectural form of I', p large.
level curve of g in the region R, where llvgJ12
> u,. On such r's, inf E, = - m,
so no minimum exists!
On the other hand, we conjecture that minimizing E itself is a well-posed
problem. The explanation of this is that for p >> 0 and pv fixed, the minimum of
E( fr, I') will presumably be taken on for a r supported in R, and made up of a
curve which locally has more and more components, these being smooth nearly
parallel curves with a separation of about c/p (see Figure 23). The limit of such
r should be taken as a current, not a curve.
Instead, the reason we are interested in the limit E, is the hope that an
approximate solution to minimizing E can sometimes be obtained by a very
different procedure, involving two steps:
(a) smoothing g by convolution with a suitable kernel of size c / p , so as to
create a modified problem in which l/p is already small compared to
fluctuations in f,
(b) solving for a curve r which maximizes Em(r) for this smoothed g and
with respect to all small deformations of r (as in Section 3).
Unfortunately, it is still unclear whether there is a natural class of g's for
which r's satisfying (b) can be found. We hope to clarify this in a subsequent
paper, and will only make a few preliminary remarks here. As we have seen in
Section 4, requiring that the first variation of Em vanishes on a smooth curve I?
is equivalent to asking that, along r,
Now g is a given function and this is not a PDE for g: instead it is a 2-nd order
ODE for I?! To see this, let ( x ( t ) , y(r)) be a parametrization of I? and let O ( t ) be
D. MUMFORD AND J. SHAH
the angle between the tangent line to r and the positive x-axis. Then
a = -j(z)x
a + i ( t ) - @ a
If we let t be the arc length s, then
3 ) = (cos 0 , sin #),
a' - -sine*g,+cosa*g,,
a = cose g, + sine g,,
ag = -(-sine*g,+cos8*gy)
= cos6sin8(gyy - gxx) + (ms2e - sin2B)g,,
- (cos e g, + sin e g, ) K.
With these formulae we can rewrite the requirement on r as the system of
first-order ODE'S for (x, y , e):
d ; ( ~ ) A g + d , ( B ) - ( ~ s i n 2 8 ( g y y - g x , ) + ~ 0 ~ 2 8 * g , , )
dg( e) = g,cos 8 + g,, sine,
d,*(8) = -g,sinB + gycose,
T(8) = d,(B)' - fd;(B) - iv,.
OPTIMAL APPROXIMATIONS
However, we see immediately that these equations may be singular if the
denominator ~ ( 6 )
in the expression for 4 is 0. It is better not to use arc-length
parametrization, but to rewrite the equations by multiplying each equation by
and then choose a new “time” t so that
3 = 7(6)sin6,
d - (Ag) d,*(6) + ((gYy - gx,)$sin26 + gx,,cos26) .d,(6)
This form shows that the solutions are the integral curves of a smooth vector field
on the unit tangent bundle T to R. (Note that d, : T
W is the function on T
defined by the differential dg and d: is the function on T defined by the
differential (*dg).)
However, we may divide the unit tangent bundle T into two zones:
“space-like” zone:
T ( 6) < 0,
“ time-like” zone:
T ( 6) =- 0.
On the boundary between these two zones, 1 = 3 = 0, i.e., the vector field is
“ vertical”. Integral curves of this field will, in general, be smooth curves on T,
crossing from space-like to time-like and back again. But they project to curves
on R with smooth space-like segments that end in cusps, at which they turn into
smooth time-like segments. A computer-generated example of such a curve is
shown in Figure 24. It corresponds to the case g(x, y) = eY and v,
which all solutions are identical up to translation.
It can be shown that along its time-like segments, an integral curve locally
maximizes E, whereas along its space-like segments, it locally minimizes E,. For
instance, if v, = 0, the gradient curves of g are time-like integral curves (on
gradient curves, a g / d n = 0, hence (*) is satisfied) and these give the absolute
maximum, namely 0, of the functional
Therefore, the existence problem for v = 00 becomes:
Find criteria for the existence of closed everywhere space-like integral
curves of (* *), or singular curves, as in Section 2, whose smooth pieces
are everywhere space-like integral curves of (* * ).
Unfortunately, the requirement of being everywhere space-like is rather unstable.
D. MUMFORD AND J. SHAH
Figure 24. A solution of the ODE with ‘‘space’’-and “ time”-like segments.
Appendix 1
Boundary Behavior of the Solutions of Neumann Problems in
Non-smooth Domains
A. We want to study the problem: given a bounded open set 51 in W 2 and a
function g(x, y ) , continuous on a, solve for a function f ( x , y ) such that
If fd has a smooth, e.g., C’*l-boundary, it is well known that (*) has a unique
solution f which is C’ and has second derivatives which are in L, for all
p < 00. If g and dfd are a bit smoother, then so is f. Unfortunately we need the
OPTIMAL APPROXIMATIONS
solution f for domains Q with corners and slits and even with cusps at the end of
the slits. We can find no standard reference for the existence and regularity of the
solutions f in this case, hence we must summarize “standard” theory here.
Grisvard contains all the basic ideas that we need, but they must be adapted
to our particular case.
B. First of all, we use the Hilbert space Wi(Q) defined in the introduction
and consider the positive definite continuous quadratic function on W:( Q ) :
By the Lax-Milgram lemma, E has a unique minimum, i.e., the function f such
for all functions + E W,’(Q). This f exists because + - p2/J+ g is a bounded
linear functional on W;(Q), hence is given by dot product with some f.
C. Secondly, as a distribution on Q , f satisfies A f = p2(f - g ) . Putting Q
inside a large domain R with C’3’-boundary, let fR be the solution of (*) for this
domain R. fR is C’ with LP-second derivatives for all p . But then, on Q,
A( f - fR) = p 2 ( f - fR), i.e., f - fR is in the kernel of the elliptic operator
A - p2. Thus f - fR is C“O. Therefore f is also C’ on Q with LP-second
derivatives. Thus f is a strong solution of A f = p2( f - g) on Q, i.e., we have
equality a.e. of A f with p2( f - 8).
D. Thirdly, note that f is bounded on Q by the max and min of g:
ming g f ( x ) 5 maxg for all x E 9.
To see this, let
Then at almost all points of Q either f2 = f or f2 is locally constant, hence, at
D. MUMFORD AND J. SHAH
almost all x E Q ,
Ilvf21I2(x) s llvf1I2(x).
Moreover, at every x E Q,
- g ( x ) ) 2 s (fb)
Therefore,
hence f = f 2 since f is the unique minimum of E.
E. Fourthly, look at points P E aQ such that d Q n U is C'.' for some
neighborhood U of P. We claim f is C' on a n U and that il f/a n I aQ ,-, = 0. To
see this, introduce a subdomain Up of Q which is C',' and whose boundary
coincides with that of Q near P (see Figure 25). Let q be a C1*'-function which is
1 near P, which is zero on aUp - (aQ n dUp) and such that aq/iln such that a$/dvIaUp = 0.
This follows from applying the basic property ( * *) of f with cp = q$ and
some juggling with Green's theorem. We apply the weak existence theorem,
Proposition 2.5.2.3 in Grisvard 171, to deduce that f l ~
W,'(Vp). We can soup this
up a bit, because now we know that af;/ax and df;/ay are in the space W:(Up),
hence they are in L,(Up) for all p, by the Sobolev inequalities. Now repeat the
argument with f= q2f, but starting with
A f - p 2 f l = q 2 p 2 g + 4 q ( ~ q * v f ) +fA(q2) = L p ( U p ) .
By the same result in Grisvard, f~ Wp?(Up) for all p. This tells us that f is C'
on 0 near P, by the Sobolev inequalities, and now the weak Neumann condition
becomes a strong Neumann condition:
F. Before studying the behavior of u in corners of Q, we must make a
digression on C','-coordinate changes that straighten comers. We claim that for
any two C'.'-arcs meeting at (0,O) with distinct tangent lines, in a neighborhood
of (0, 0), there is a C'.'-diffeomorphism Q, such that
(a) Q, maps the two arcs to straight rays through (O,O),
(b) dQ, is the identity at (O,O),
(c) d@ carries normals to the two arcs to normals to the corresponding rays.
We prove this in two steps. In the first, we satisfy (a) and (b) but not (c). In
Let the two arcs be
the second, we satisfy (c) while preserving conditions (a) and (b).
p = g'(0) where f ( x ) > g ( x ) if
Define Q1 : W 2 + W 2 by
carries vertical lines to vertical lines. It carries y = f(x) to the line y = Ax
D. MUMFORD AND J. SHAH
and y = g( x ) to the line y = p x and d@',(O, 0) = Z2. Therefore cPl is a CIT'-dif-
feomorphism in some neighborhood of (0,O). Next for any Co,'-function h ( x )
such that h ( x ) = 0 if x
0 and for any Y > 0, define \kh.u by
especially
Thus 'kh, is a C'.' diffeomorphism near (0,O) which maps the sector 0 < y < vx
to itself, preserves perpendiculars along y = vx, but maps the perpendiculars
a / a y to y = 0 to the vectors a / a y + ~ ( Y x )
a/ax. q h , may be extended to any
sector bounded by y = 0, x > 0 at one edge and including 0 < y < vx by setting
it equal to the identity at the new points: it is still C'".
We may then use a conjugate
where A is a rotation or reflection, to modify the field of normal vectors to any
sector at one edge without changing those at the other. Two such maps then will
modify the two fields of normal vectors by arbitrary Co,'-maps, so long as the
normals of the apex do not move. The resulting a2
0 (Dl can be made to have
property (c).
Finally note that this argument can be extended to map the exterior sector of
arcs tangent at (0,O) or the complement of one C'-'-arc to the
complement of a single ray by a diffeomorphism iP with properties (a), (b) and
(c) above. Let the arcs be given by
y = f ( x ) and
y = g ( x ) ,
OPTIMAL APPROXIMATIONS
The exterior sector is given by ( y > f ( x ) ) U ( y < g( x ) ) U ( x < 0). The comple-
ment of the C1,’-arc is just the special case f ( x ) = g ( x ) . To construct CP, we first
use the map
and then “correct” the fields of normal vectors as before.
G. We next look at singular points P E ail which are corners with convex
angles a, 0 < a < B. At such points P, we claim that f is still C’ in
suitable neighborhood U of P, and since the two arcs of ail at P have distinct
tangent lines, (vf )( P) = (0,O). To prove this we use the techniques in Grisvard,
Section 5.2, together with a C’*’-map c9 of the type just constructed. More
precisely, we assume CP is a mapping of a neighborhood W of P in R 2 to a
neighborhood of (0,O) in W 2 carrying W n Q to an acute triangle d in R and
such that d @ ( P ) = identity, and CP carries normals to W n as2 to normals to ad
(see Figure 26). Let r, be the two sides of d through (0, 0), and r2 the third side.
Let 9 be a C“-function of (IzJI on 0 which is 1 near (0,O) and 0 on r,. Consider
the function
fl(4 = m f ( W 4 )
satisfies a variable coefficient elliptic problem on h:
Figure 26. Straightening a comer of 51.
D. MUMFORD AND J. SHAH
for suitable bounded functions b,,, bi, c and S on 0, bij continuous with
bi,(O, 0) = 0, g continuous. Next choose p such that
and consider the family of operators
As in Grisvard, B, are bounded operators, B, is an isomorphism by Theorem
4.4.3.7. Therefore B,, is an isomorphism. This shows f E w,”(n) C C’(0) using
the Sobolev inequalities and the assumption p > 2.
H. We may extend this last argument to cover corners P of aQ with angles a
such that ?T < a
2n. Here a = 2n includes both the exterior sector to “cuspidal
corners”, pairs of C’.’-arcs tangent at P and the exterior of a single C1.’-arc
ending at P. However, the result is different: f is not generally C’ on a near P.
Instead f has a singular leading term.
Let z = x + Q be a complex coordinate on W 2 and let 4, 62 be the angles
with the positive x-axis of the tangent lines to the arcs of
at P (6, = e2
allowed); see Figure 27. Let
Figure 27. Orienting the sides at a comer of Cl
OPTIMAL APPROXIMATIONS
Then we claim that, near P,
f = Cfsing + frrgr
f,, a C'-function.
To prove this, use a Q, carrying a neighborhood Wof P to a polygon b, an q zero
on aW n Q and consider f= qf 0 Q,-' as a function on d satisfying an elliptic
boundary value problem with mixed Dirichlet-Neumann boundary conditions.
Take p slightly larger than 2 and use Theorem 4.4.3.7 plus the methods of
Section 5.2 to deduce that, on Wp,
this boundary value problem has index 1, i.e.,
the map B, defined in subsection G has index 1.
What we have to verify is that fsing fills in the required range, i.e.,
(ii) af&@(,
E w;-l/p(rl).
But Lhg is harmonic and continuous, so (i) follows.
To show (ii), let r, 0 be polar coordinates at P and use r as a coordinate on
the arcs of r,. Take one of these and, assuming for simplicity that it is tangent to
the x-axis, write it as
(0 (A - P2)fsing E Lp(Q)9
Y = f ( r ) ,
f E c'.', f(0) = f'(0) = 0,
Let g ( r ) = sin-'( f(r)/r). Now if f(r) is C'.' and f(0) = 0, then f(r)/r is
Co,', hence g ( r ) E Co,'. Moreover,
which is in C0v1 also. Now, in these coordinates,
= (CO*'-function) rw/a-l.
D. MUMFORD AND J. SHAH
We use the following easy calculation:
LEMMA. I f g ( x ) is a Co*'-function on , then g ( x ) x k E W:-'/"([O,
k z - $ a n d p < 4 .
Differentiating fsing, we also note:
I. Another case that we need is a point P E dsl such that i2 is the comple-
If 1 4 p < f, then fsing and hence f belongs to Wi(sl).
ment of an arc ending at P with a cusp at P, i.e., an arc I' given by
y = aX3'2 + g(x), g f c',', g(0) = g'(0) = 0, a E R, a # 0,
after a rotation. This is a C1*1/2-boundary point and cannot be straightened by a
C1.'-map a. Nevertheless we claim that, near P , the solution f ( x , y) has the
f = a, + a,\/;cos(:d)
R E O(r'-e),
l\vR\l E ~ ( r - ' ) for all
In particular, f has a continuous extension to a near P (where the two sides of
r are considered as distinct points of a).
This can be shown by considering
f7 u , u ) = f( u2 - u2, 2uu)
defined on 8, one of the two components of
{(u,u)((u2- u2,2uv) E Q ) .
In complex coordinates, we are letting x + y = ( u + iu)2. This opens up the cusp
into C'*'-boundary (with a discontinuity in the curvature at (0,O)); see Figure 28.
On a, {satisfies
4p2( u2 + u')( f- g),
OPTIMAL APPROXIMATIONS
Figure 28. Smoothing a cuspidal crack by complex square root.
Therefore, as in subsection G, fE W,'( Q), but for all p < 00. Thus f can be
written as
f= a,, + alu + ii,
j ( 0 , O ) = IlvRll(0,O) = 0.
By the Sobolev inequalities,
E C'** and vt? E Co*" for all a < 1; hence
Going back to f , this gives us the expansion above.
J. One estimate is missing from our analysis: it would be nice to state it
inside a cuspidal corner, i.e., in a domain
the solution to the Neumann problem is C' at the corner (O,O), or at least Co.
We do not know how to prove this. Fortunately we do not need it either.
Appendix 2
Estimation of Neumann Problems via Brownian Motion
Let D be a domain in W 2 bounded by a finite number of C','-curves, meeting
at comers with various angles ai or ending at crack-tips. Thccase ai = 0, ie.,
cusps sticking out from B, is excluded, but a, = 2n, i.e., cusps sticking in, is
D. MUMFORD AND J. SHAH
allowed. Let g E C'(B). We are interested in solving
Af,. = P 2 ( f , - g ) ,
a f p / a n l , D
for various p's. The main result of this appendix is
all g and all p,
Given a domain D as above, there is a constant CD such that, for
We know two proofs of this result. One that we found and that seems very
intuitive to us which uses Brownian motion, but does require some painful
estimates. The other was found by S.-T. Yau after we posed the problem to him,
which is based on iterating the Sobolev inequality infinitely often to estimate
I( f p - gl), for higher and higher p in terms of
(1 f,. - gl12. Yau's proof demon-
strates once again that things that can be proven with Brownian motion can
generally be done directly. We give here our original proof because it seems so
natural however.
We need Brownian motion $(t) with reflection on the boundary of D. The
simplest way to define this process is to use the Riemann mapping theorem: Let
@ : D + unit disk A be the conformal map. Then @ extends homeomorphically
to &, provided that boundary curves of D which meet D on both sides
(e.g., edges ending in crack-tips) are counted twice as boundary curves. By a
theorem of ordinary Brownian motion, $(t) on D becomes Brownian motion
& ( t ) on A run with a new clock 7(r):
7 ( t ) = J'p(P(S))J*ds.
(See e.g. [ll].)
On A, define Brownian motion with reflection in the usual way
and carry it back to D by
Note that although @' = 0 or 00 at the comers of D,
& t ) hits the image of these
OPTIMAL APPROXIMATIONS
comers with probability zero; hence there is no difficulty defining T* on almost
all paths, and F(t) also hits a comer with probability zero.
The solution to the boundary value problem is now given by
f ( x ’ ) = E[/mp2g(p(t))exp{ - p 2 t ) dt( p(0) = x’ .
For details on the construction of F(t), see [ll], especially Sections 3.9, 4.3 and
4.6, or , Section 1.6. For a proof of the formula, see , Section 2.5, Theorem
We need a version of Ito’s lemma to calculate the expected position of F( t):
ITO’S LEMMA. Let f be a C1”-function on a subdomain Do in 5 such that
where b is a one-dimensional Brownian motion.
Proof: This is Ito’s lemma applied to f( p( t)): cf. [ll], Section 2.9 and , p.
96 (note: formula C there has a misprint.)
Using Ito’s lemma, we now prove
2. Fix the domain D. Then there is an ro > 0 and a constant C,
such that, for all r 6 ro, all t 2 0 and all P E D,
Proof: First of all, we need coordinates adapted to D. Near the A-th edge r,
of D, let dh( P) equal distance from P to r, and let s,( P) equal arc length along
FA from the initial point of r, to the nearest point on r, to P (cf. Figure 3,
Section 1). Note that, since FA is C1*’,
S, and d, are C’.’.
Secondly, near each comer Q, of D, let 0, be a diffeomorphism of a
neighborhood of Q, to a neighborhood of (0,O) as in Appendix 1:
carries the
two edges of D abutting at Q, to two rays in W2, it carries vectors perpendicular
to these edges to vectors perpendicular to the rays and its differential at Q, is the
D. MUMFORD AND J. SHAH
identity. Choose ro 5 rl as follows:
(i) (s,, d,) are coordinates on a neighborhood U, of r, defined by d, 5 rot
(ii) the (x, y)-metric and the (sA, d,)-metric differ by at most 1.1 on this
neighborhood, i.e.,
dx2 + dy2 5 1.1 (dsf + dd:)
1.21 (dx2 + dy2),
(iii) U, n U, f 0 only if I?,, I’,meet at avertex Q, and then U, n Up c B,,(Q,),
(iv) @a is defined in B,,(Q,) and the ( x , y)-metric differs from the
Define y as the max of
( x , = x 0 @,,
y, = y 0 @,)-metric by at most 1.1.
IAdil in UA
where p: = x: + y,.
Now to prove the theorem, we distinguish three cases:
Case (i). B2r,5(P) C Int D.
Case (ii). The connected component of (B2r,5 n D ) containing P meets
Case (iii). The above component meets two edges I?,, r, of D.
exactly one edge r, of D and no comer.
In case (i), we have a small square S:
x ( P ) - +r 5 x 5 x ( P ) + +r,
y ( P ) - )r 5 x $ y ( P ) + i r ,
with S c B2,,5( P ) c B,( P) and S c Int( D). We estimate the probability that
P‘((r) leaves S in time t by adding the probabilities of it hitting the four edges
I - 4exp{ - r 2 / 5 0 t } .
OPTIMAL APPROXIMATIONS
We use here and below the simple bound (for any a 2 0):
dy 5 $ exp{ - + a 2 } .
In case (ii), we have a curvilinear rectangle S around P:
Again, in this case, S C B2,/5(P) C Br(P), because the furthest point of S from
P in d,, s,-coordinates has distance \/zJ/5, and IlVdAll, llVsx1l 6 1.1 in S, hence
these points have distance at most 4r from P in x , y-coordinates. Now there are
really two subcases:
Case (iia). d,(P) > fr.
Case (iib). d,(P) 5 ir.
In case (iia), S is in the interior of D and we estimate the probability of a
large excursion of d, or sA using Ito’s lemma. Since
(hdxl 5 y in S ,
and since llvdxll 5 1.1, the lemma tells us that
exp{ -x2/2.42t} dx .
d,( F ( S ) ) = d,(P) 4- f r
P for som+eO 5 s 5 t,
given ~ ( 0 )
(Note that we are adjusting for a worst case of Brownian clock speed 1.21 times
normal and a maximum possible drift yt-so
that the Brownian faeor must have
an excursion of at least f r - yt.) A similar estimate holds for d,(P(s)) = dh( P )
- +r and for s,(P) Ifi fr. Thus
?(s) 4 s for
exp{ -x2/2.42t}
P s o m e o s s s t 5 8 1
given P(0) = P i
I - 4exp{ -(r - 5yt)2/60.5t)
D. MUMFORD AND J. SHAH
Now either r 2 25yt or r 5 25yt. If f r 25yt, then r - 5yt 2 0.8r; hence
P( ) 5 4exp{ -r2/100t}.
If r 5 25yt, then r2/100t 5 fyr, and hence
P( ) 5 1 s exp{ :yore} exp{ -r2/100t};
thus in all cases
P( ) 5 max(4, exp{ fyr,})exp{ -r2/100t}.
In case (iib), F( t) can leave S in only 3 out of its 4 sides, and bounces off the
4-th. We must use d i instead of d, in order to satisfy d/dnl,, = 0. The
modified calculation shows that
which follows from the lemma, using lA(d:)l 5 y and
The right side is estimated by
< 2 exp( - (4r - 5 ~ t / r ) ~ / 9 . 6 8 t ) .
As in case (iia), separating the cases r2 2 125yt and r 2 5 125yt, we deduce that
P( ) 5 const.exp{ -r2/400t}.
In case (iii), by the choice of r,, the two edges r, and r, meet at a corner Q,
Case (iiia). Q,
Case (iiib). Q, E BZr/5(P).
of D. Again we distinguish two subcases:
OPTIMAL APPROXIMATIONS
Figure 29. Neighborhoods of a point P near a comer.
If the angle at the comer Q, of D is greater than T, we must be in case (iiib).
We use the diffeomorphism 0, defined near Q, in both cases. Let p, = 110,,11.
case (iiia), let S be the domain defined by
see Figure 29. We claim that
S c Br(P),
so that if F(t) leaves B,(P), it must also leave S and therefore p,($((t)) must
equal p,(P) f f r at some point. To check this, use the fact that @a changes
distances by at most a factor of 1.1 and some elementary geometry for the sector
@,(S), depicted in Figure 30. In the figure, it is easy to check that the length of
the dotted line is at most tr, so that
@ A S ) = B&,5(@,(f9*
Going back, S C Br(P) follows.
Figure 30. Estimate of certain distances.
D. MUMFORD AND J. SHAH
We now apply the lemma to the function p:. (Since Ap, + 00 at Q,, we use
p: instead of pa.) Note that
IA(P:)I 5 Y,
IlV(P2) 11 = 2PaIlVP,ll 5 2.2(P,(P) + $4-
(pa( P) + ir)’ - pa( P)’ - yt
pa( P)’ - (pa( P) - ir)’ - yt
for the outer boundary,
for the inner boundary.
We get as above
But one checks that
B 41.- 7 for both boundaries,
so, as in case (iib)
P( ) 5 const. e-r2/400r.
Finally, in case (iiib), let S be the domain
Pa 5 P,(P) + hr.
Note that pa(Q) 5 p,(P) + &r implies
IIP - Qll S IIP - Qall + IlQ, - Qll
5 3r + l.l(p,(P) + & r )
- (+ + 1.1 ‘(1.1 -5 + & ) ) r < r;
hence S C B,(P). There is only one way to leave S now. Use p: as in case (iiia),
OPTIMAL APPROXIMATIONS
and get the estimate
P(1eaving S) 5 const. exp{ -r2/1600t}:
The main result of this appendix can now be proven using Theorem 2 and the
formula for the solution f of the Neumann Boundary Value Problem:
Proof: Note that
hence, by the formula,
For fixed P and t, let
h ( r ) = p[((Z(t) - F(o)((
2 r ifF(0) = P I .
= i m h ( r ) dr
6 c C l exp{ - r2/1600t } dr
C, exp{ -r:/1600t} dr,
+ Ldism(D)
by Theorem 2,
+ C, &am( D)exp( -r:/1600t}.
D. MUMFORD AND J. SHAH
Therefore,
Jf(P) - g ( P ) I s s u p ~ ~ v g ~ ~ C ~ / m ( 1 0 6
+ (diam D)exp{ -$/16OOr})
*p2 exp{ - p 2 r } dr.
Appendix 3
Boundary Estimates with p Large
Let 51 be a bounded domain in R 2 with Lipschitz boundary, af2. In
particular, 51 has no cracks. This is not a serious restriction since we can split
cracked domains along the cracks and apply the results derived here to each piece
separately.
For a curve y c 351, let a y be the set of end points of y and Iy1 be arc length
of y. For any point P on y, let
A, = the diameter of the largest circle through P, contained
in a single component of R~ - as2.
A, = minh,.
OPTIMAL APPROXIMATIONS
If y is connected and contained in another connected curve y*, let
60 if y* is a closed curve,
arc distance between y and ay* otherwise.
If y is C'.', define curvilinear coordinates in a tubular neighborhood of y in GI as
shown in Figure 3, Section 1: r is the normal distance from y and s is the arc
length along y. Let n and t denote the unit (inward) normal and tangent vectors
along y. Let 8 be the angle that t makes with the positive x-axis. If y is C2, the
curvature K along y is defined by the equation
where Lip,,( 8) and Lip,( K) are the Lipschitz constants. For p > 1, let Vy, p , c
Hj(52) denote the subspace of all functions u such that
(a) v2u - p2u = 0 in 52 (in the weak sense),
(b) u is bounded on d o ,
(c) au/ar is COT' along y.
If y is C2,' and au/dr is C'.' along y, let
THEOREM. Let y c y* be Connected C'll-curues c dP such that a y n dy* is
empty. Then, there exists a universal constant p such that with
D. MUMFORD AND J. SHAH
for all p satisfying p6 2 6log(pldal) 2 1 and for all u E Vv.,p,F, we have
where Ieo(s)l is bounded by a universal constant.
B. If y* is C2,' and av/ar is C',' along y*, then
where I E ~ ( s ) ( and 1e2(s)I are bounded by universal constants.
constant A depending only on 6, laQl and I I K I J ~ , ~ , ~ . such that, for all r < 6,
C. Suppose that y* is C3*' and av/dr is C'" along y*. Then there exists a
where, for 1 4 i 5 3,
In order to make the proof more readable we give a proof only for Part B of
the theorem. The proof of Part A is essentially contained in the proof of Part B
except that we have to replace all the C2"-estimates of y* by C'.'-estimates and
develop the error terms up to one order of l/p less. Part C is not needed in our
OPTIMAL APPROXIMATIONS
application of the theorem in this paper. Its proof is analogous to the proof of
Part B involving a few more calculations of the same type.
The theorem is proved by estimating the integrals in Green's integral repre-
sentation formula which we now recall. By Sobolev imbedding theorem,
u E Hi(Q2) where
and by the trace theorems (see ),
The assumption that (- v2 + p2)u = 0 in the weak sense means that
- + 7 = 1.
Fix a point P E W 2 and let + = Ko(plPQl), where KO is the zeroth-order
modified Bessel function of the second kind and Q E W2. We get
J (vQu VQKO + P2'QKO)
KO satisfies the equation
in the weak sense, where up is the delta function concentrated at P. Therefore,
for all u E Vy,p,c,
If P 4 aQ or if P E aQ where it is at least C1*', then aKo/anQ is bounded in
a neighborhood of P and hence, by applying the Green's formula to Q -
(&-neighborhood of P) and then taking the limit as E + 0, we get
for all u E Va,p,c
and all P in whose neighborhood aQ is C'.'. Subtracting (1)
D. MUMFORD AND J. SHAH
from (2), we get
since u is continuous at P.
( 3 ) m p u ( P ) = %/
a U + aK"u(Q)) where rnp = b;,.
Our task is to estimate the integrals in the integral equation above and solve
explicitly for u in terms of a u / a n . The key point is that KO and its derivatives
decrease exponentially with increasing plPQl and hence the values of the inte-
grals when p is large depend essentially on a small segment of aSl near P which
may be approximated by a circle.
We prove a series of lemmas first. In Lemma 1, we derive geometric estimates
which depend only on Q. We use these estimates in Lemma 2 to specify 6. In
Lemma 3, we derive some basic formulae for KO, Lemma 4 lists estimates for the
basic integrals that arise when we try to estimate the integrals in the Green's
formula and their derivatives.
Define R : R 2 x as2 + W L o by setting R ( P , Q ) = distance between P E Q
and Q E 80. If P and Q lie in a tubular neighborhood of a connected curve
y C a Q so that P and Q have coordinates ( r , s p ) and (0,
sQ), respectively, then
R becomes a function of r, sp and so. Define u : y X y + R,,
by setting
u ( P , Q ) = IsQ - spl. Let a, denote the symmetric operator a/as, + a/asQ. Let
t , and K~ denote the normal vector, tangent vector and the curvature at the
point (0, s,).
Let nQ, tQ and K Q be the corresponding quantities at Q. In what
follows, if an estimate contains an order term O(E") in variable E, then ~O(E")/E"I
is bounded by a universal constant.
LEMMA 1. I. Let xl, x2 be the coordinates in R2 and let D, denote the
operatord/axi. Let q E as2 besuch that nQ isde$ned. Then forall P E R 2 - { Q } ,
OPTIMAL APPROXIMATIONS
i = 1,2 andj = 1,2,
IDipRI s 1,
aR/anQl s z.
11. Suppose that P belongs to a tubular neighborhood of a connected C2-l-curve
y c aQ and Q E y. Then, for all r, u
l/ky, we have the following estimates:
~2 = r2 + a2(1 - Kpr) + k : [ r 0 ( u 3 ) + o ( u ~ ) ] ,
R- ar = r - + K ~ u ~
+ k , 2 0 ( ~ ~ ) ,
= -(1 - Kpr)(SQ - s p ) + k $ O ( u 3 ) ,
(If y is only C1gl, the corresponding estimates may be obtained by dropping
the terms containing K,, and replacing k$O(a"') by k,O(u"-'). We leave it to
the reader to verify this.)
Part I may be proved directly by differentiating R. (It is convenient
to let the x,-axis coincide with nQ.)
D. MUMFORD AND J. SHAH
Consider now Part 11. Let Po be the point with coordinates (0, sp) and let m
be the point on y with coordinates (0, f(sp + sQ)).. From the error formulae for
divided differences, we obtain the following estimates in which k;O(u“) is
abbreviated as 01(
where t , is the tangent vector at m and Ol(u2) is a vector of magnitude Ol(u2),
From these estimates, we obtain, in turn, the following:
1 - n p nQ = + K $ J ~ + k,0,(a3).
OPTIMAL APPROXIMATIONS
The estimates in Part I1 now follow by substituting the above estimates into
the following formulae for R2 and its derivatives:
R2 = ( -rnp + P,Q) - ( -rnp + P,Q),
= -(1 - K p r ) m 0 t,,
= -rnp tQ +
LEMMA 2. There exists a universal constant p 5 f such that if y is a connected
(a) for all points P in a tubular neighborhood of y for which r 5 6 and
C'yl-curve c as2 and if we choose 6 6 P/k,,, then
{ Q E a q a 5 46) c y, we have
r2 + 4a2 2 R2 2 r2 + $a2,
(b) If, furthermore, 6 5 :Ay, then R 2 26 whenever u 2 46 or Q 4 y.
Proof: The estimates for R2 and R aR/asQ in Lemma 1 imply the existence
of p such that the inequalities in part (a) are satisfied. Suppose now that
6 5 an,. Let S be the circle with radius 26 and center at P. Let Q1,
Q2, ql, q2
be the points as shown in Figure 31. Since R 2 26 when u = 46, IsQi - spl 5 46
for i = 1,2. Therefore, Q, and Q2 lie on y. For i = 1,2, the arc Qiqi must lie
inside the circle of diameter A,,,, tangent to y at Qi, since 46 < A,. The rest of
D. MUMFORD AND J. SHAH
Figure 31. Definition of Q, and q,, i = 1 and 2.
the circle S must cut any normal to a point on y between Q, and Q2 at a
distance at most 46 < A,. It follows that d Q n S = {Q,, QZ).
Any ray from P
to a point on d Q with u 2 46 must intersect S first and hence, has length at
Let KO( z ) be the zeroth-order modrJed Bessel function of the second
kind. Let L denote the operator -(l/z) d/dz. Then:
(i) L ~ * L K , ( ~ )
(ii) There exists a constant c such that, for 0
(iii) For any integers m,
n 2 0, there exist constants c, and dm," such that,
for all z 2 1,
~ m z m L " K o (
dm, , , z " - " - ~ / ~
Part (i) follows from the identities
z K o ( z ) = - K d 4
OPTIMAL APPROXIMATIONS
where K , ( z ) is the first-order modified Bessel function of the second kind. (For a
collection of formulae involving Bessel functions, see the Handbook of Mathe-
matical Functions, , vol. 55.) For proving part (ii), use the polynomial
approximations for z1l2K0( z) and zK,(z) in the range 0
2 and 2 4 z < 00.
The last part follows from (i) and (ii) by differentiation and integration by parts.
LEMMA 4. Let y be a connected C2”-curve C 80. Let j be an integer,
0 s j 5 2. Choose 6 5 @/ky where p is the constant as in Lemma 2. Let P with
coordinates ( r , s p ) be a point in a tubular neighborhood of y with r < 6. Let
Np = { Q E a0lo < 46) and assume that Np c y. Let @ E L,( d0) be a function
on 80 which is CJ-l*l in y. Let
Let Y denote the operator - ( l / R ) d/dR. Then, there exist universal constants
C,, C2; . *, Ci, C;; . -, C”, C;l, C;’,. . ., ao, and polynomials al(pr) and a3(pr)
of degrees 1 and 3 in variable &, respectively, with universal coeflcients such that
the following estimates hold for all p satisfying p6 2 6 log(p1aQI) 2 1:
D. MUMFORD AND J. SHAH
with absolute error g
% lNTKO( ) a2@ dsQ
2/41 - Kp')3'2
with absolute error 5
If r = 0, then for m, n 2 0, j = 0,
OPTIMAL APPROXIMATIONS
For m, n 2 0 and j = 1,
If, additionally, S 5 $A,, then for n 2 0 andj = 0,
Proof: Estimate (4.11) follows from the estimate for (d"/dz")Ko(z) and
L"K,(z) in Lemma 3. For the rest, first consider the special case where
upper half-plane in W 2, N, = aQ is the y-axis in W 2, r is measured along the
x-axis and cf, = 1.
Then, u satisfies the equation -v2u + p2u = I, where I is the line potential of
unit density along the y-axis; i.e.,
The equation is solved easily by reducing to the one-dimensional case:
u ( r ) = G e - p ' .
Therefore,
Differentiation of this formula and integration by parts show that estimates
(4.1) through (4.8) hold such that the error terms in the first five estimates are
actually zero. To obtain (4.9), just note that R = u =
which does not depend on p and the integrand, at worst, has only logarithmic
pole at ye = y,. The integrand in (4.10) has a pole of the order 1/(yQ - y p )
when m = r = 0 and hence the integral is defined only as a limit as indicated.
D. MUMFORD AND J. SHAH
The numerator is an even function of yQ while the denominator is odd. There-
fore, the integral is zero for all r > 0.
Consider now the general case. The estimates in the lemma follow by
performing a change of variables as follows. We let
As before, we abbreviate ky” O(um) and ky” O(qm) as O,(um) and Ol(qm),
respectively. By Lemma 1,
- /(I - K p T ) + T O , ( U ) -k 0 , ( U 2 ) .
By Lemma 2, a 6 q2/a2 5 4 and 5 6 q/(sQ - sp)
ible function of sQ:
2. Hence, qQ is an invert-
Note also that, if 1171 2 26,
OPTIMAL APPROXIMATIONS
We also need three more integral estimates:
Finally, note that if j = 1,
Q, = Q,P + Cpl,O(q)
and if j = 2,
Consider now the first estimate in the lemma with j = 2. Perform the change
of variables and substitute the above estimates for drQ/dqQ and 0. Let q - and
TJ+ be the limits of qQ corresponding to the limits of sQ in Np. We get
D. MUMFORD AND J. SHAH
OPTIMAL APPROXIMATIONS
Putting all of the above estimates together, we get the first estimate in the lemma.
The other estimates are obtained in the same way.
Proof of the Theorem (Part B): For 1 5 k 5 4, define
yk = { P E y*larc distance( P,
y ) 5 4k8) c y * .
For a point P E y3, define its 48-neighborhood Np in asl as in Lemma 4. We
We begin with the Green’s formula:
keep Np fixed when we differentiate with respect to sp.
First, consider these integrals over asl - Np, where P is a point in y3. R2 and
R aR/anQ are CZs1-functions of sp. Moreover, by Lemma 2, R 2 26 over
as2 - Np. Therefore, R and dR/anQ are C*”-functions of sp. Ko(pR) is an
analytic function of R if R # 0. Therefore, Ko(pR) and aKo(pR)/anQ are
C2*’-functions of sp over asl - Np. We may compute their derivatives by
differentiating inside the integral sign. Let + denote d u / a n . Let
By estimate (4.11) in Lemma 4,
where laR/dspl 5 1 by Lemma 1. Therefore,
Consequently,
D. MUMFORD AND J. SHAH
By Lemma 2,
Therefore,
Consider now the same integrals over Np. Since KO(@) has a logarithmic
pole, differentiation inside the integral sign produces divergent integrals in most
cases. Hence we proceed as follows. Let TP,& = [0, S] X Np. If an integral has the
where G is a function on TP,8 X Np and @ is a function on Np, then
= - [G(P, Q)@(Q)]$'+
where Q * are the end points of the arc Np. aaG( P, Q) will turn out to have
singularity no worse than the singularity of G( P, Q). Therefore, everything in the
last step is convergent if the original integral is. If any of the integrals in any of
the steps above turn out to be divergent we consider the integral
where P* is a point in Tp,
8 with coordinates (r, sp), carry out the above steps
and then take the limit as r + 0.
OPTIMAL APPROXIMATIONS
Let u l ( P ) = -(l/n)jNpKo(pR)+(Q)
ds,. By (4.1) in Lemma 4,
Consider u,(P#) = -(l/a)fNpKo(pR")+(Q) hQ where R" = 1P"Ql
where O= - ( l / R ) d/dR.
By Lemma 1,
Since 9 K o ( p R ) has singularity like l/a2 at R = 0, the last integral is conver-
gent when r = 0. Therefore,
By Lemma 3, the first term equals
Consider now the second term. Since aaR2 = k$0(a3), the term equals
k$)l+)lO,oo,
Np O(l/p2) by (4.9) in Lemma 4. By (4.1) again,
D. MUMFORD AND J. SHAH
Putting all the pieces together, we get
Since u appears on both sides of the equation, we have to bootstrap the result,
successively shrinking the neighborhood of y, from y4 to yl, during the process.
Start with P E y3. Since R a R / a n , = ky.0(a2),
U2(p) = 11U110,m,y*ky* O( $)*
Hence, for all P E y3,
d p ) = WAP) + w2(p) + 0)
Restrict P now to y2 so that Np c y3. Then,
= III~lllo,y* o( i
Next, restrict P to y1 so that Np c y2. Then,
u ( P ) = --
+ ( P I + lllullll,y* .(
OPTIMAL APPROXIMATIONS
which essentially proves Part A of the theorem. Finally, restrict P to y. Let
u = u + +/p. Then,
PK,(pR)[ - + K ~ u ~ + k : . 0 ( u 3 ) ] [ - P
+ u ( Q ) ] ds,
thefirstintegral = --+(P)
+ k,*C,Jy.O
the third integral = ky.llullo,w, Np
Therefore,
By Lemmas 1 and 2,
= k:.0(a2).
OPTIMAL APPROXIMATIONS
Therefore, by (4.3) and (4.6),
O( u)k,. O( u')
= k,. O( a),
D. MUMFORD AND J. SHAH
In the second integral,
= - ( [ U 2 +
k 7 . 0 ( U 4 ) ] [ K p ( S Q - S p ) + K $ 0 ( U 2 ) ]
Therefore,
the second integral = ~ $ ( ~ u I J ~ , ~ ,
Adding up all the estimates, we get
+' + 1114112,7* o( ;)
Acknowledgment. The first author gratefully acknowledges the Army Re-
search Office and the National Science Foundation for support under grants
DAAL03-86-K-0171 and IST-85-12736. The second author gratefully acknowl-
edges the support of the National Science Foundation under grant IRI-8704467.