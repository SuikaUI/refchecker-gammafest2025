Received June 14, 2020, accepted July 10, 2020, date of publication July 20, 2020, date of current version July 30, 2020.
Digital Object Identifier 10.1109/ACCESS.2020.3010287
Can AI Help in Screening Viral and COVID-19
Pneumonia?
MUHAMMAD E. H. CHOWDHURY
1, (Member, IEEE), TAWSIFUR RAHMAN
AMITH KHANDAKAR
1, (Senior Member, IEEE), RASHID MAZHAR2,
MUHAMMAD ABDUL KADIR
3, ZAID BIN MAHBUB4, KHANDAKAR REAJUL ISLAM5,
MUHAMMAD SALMAN KHAN
6,8, (Member, IEEE),
ATIF IQBAL
1, (Senior Member, IEEE), NASSER AL EMADI1,
MAMUN BIN IBNE REAZ
7, (Senior Member, IEEE),
AND MOHAMMAD TARIQUL ISLAM
7, (Senior Member, IEEE)
1Department of Electrical Engineering, Qatar University, Doha, Qatar
2Thoracic Surgery, Hamad General Hospital, Doha, Qatar
3Department of Biomedical Physics and Technology, University of Dhaka, Dhaka 1000, Bangladesh
4Department of Mathematics and Physics, North South University, Dhaka 1229, Bangladesh
5Department of Orthodontics, Bangabandhu Sheikh Mujib Medical University, Dhaka 1000, Bangladesh
6Department of Electrical Engineering (JC), University of Engineering and Technology, Peshawar 25120, Pakistan
7Department of Electrical, Electronic and Systems Engineering, Universiti Kebangsaan Malaysia, Bangi 43600, Malaysia
8Artiﬁcial Intelligence in Healthcare, Intelligent Information Processing Laboratory, National Center for Artiﬁcial Intelligence, University of Engineering and
Technology, Peshawar 48550, Pakistan
Corresponding author: Muhammad E. H. Chowdhury ( )
This work was supported by the Qatar National Research Fund, a member of Qatar Foundation, Doha, Qatar, under Grant
NPRP12S-0227-190164. The statements made herein are solely the responsibility of the authors.
Coronavirus disease (COVID-19) is a pandemic disease, which has already caused
thousands of causalities and infected several millions of people worldwide. Any technological tool
enabling rapid screening of the COVID-19 infection with high accuracy can be crucially helpful to the
healthcare professionals. The main clinical tool currently in use for the diagnosis of COVID-19 is the
Reverse transcription polymerase chain reaction (RT-PCR), which is expensive, less-sensitive and requires
specialized medical personnel. X-ray imaging is an easily accessible tool that can be an excellent alternative
in the COVID-19 diagnosis. This research was taken to investigate the utility of artiﬁcial intelligence (AI)
in the rapid and accurate detection of COVID-19 from chest X-ray images. The aim of this paper is to
propose a robust technique for automatic detection of COVID-19 pneumonia from digital chest X-ray
images applying pre-trained deep-learning algorithms while maximizing the detection accuracy. A public
database was created by the authors combining several public databases and also by collecting images from
recently published articles. The database contains a mixture of 423 COVID-19, 1485 viral pneumonia, and
1579 normal chest X-ray images. Transfer learning technique was used with the help of image augmentation
to train and validate several pre-trained deep Convolutional Neural Networks (CNNs). The networks
were trained to classify two different schemes: i) normal and COVID-19 pneumonia; ii) normal, viral
and COVID-19 pneumonia with and without image augmentation. The classiﬁcation accuracy, precision,
sensitivity, and speciﬁcity for both the schemes were 99.7%, 99.7%, 99.7% and 99.55% and 97.9%, 97.95%,
97.9%, and 98.8%, respectively. The high accuracy of this computer-aided diagnostic tool can signiﬁcantly
improve the speed and accuracy of COVID-19 diagnosis. This would be extremely useful in this pandemic
where disease burden and need for preventive measures are at odds with available resources.
INDEX TERMS Artiﬁcial intelligence, COVID-19 pneumonia, machine learning, transfer learning, viral
pneumonia, computer-aided diagnostic tool.
The associate editor coordinating the review of this manuscript and
approving it for publication was Xin Zhang
I. INTRODUCTION
Coronavirus disease (COVID-19) is an extremely contagious
disease and it has been declared as a pandemic by the World
VOLUME 8, 2020
This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see 
M. E. H. Chowdhury et al.: Can AI Help in Screening Viral and COVID-19 Pneumonia?
Health Organization (WHO) on 11th March 2020 considering the extent of its spread throughout the world .
The pandemic declaration also stressed the deep concerns
of the alarming rate of spread and severity of COVID-19.
It is the ﬁrst recorded pandemic caused by any coronavirus.
It is deﬁned as a global health crisis of its time, which has
spread all over the world. Governments of different countries
have imposed border restrictions, ﬂight restrictions, social
distancing, and increasing awareness of hygiene. However,
the virus is still spreading at very rapid rate. While most of
the people infected with the COVID-19 experienced mild
to moderate respiratory illness, some developed a deadly
pneumonia. There are assumptions that elderly people with
underlying medical problems like cardiovascular disease,
diabetes, chronic respiratory disease, renal or hepatic diseases
and cancer are more likely to develop serious illness .
Until now, no speciﬁc vaccine or treatment for COVID-19
has been invented. However, there are many ongoing clinical
trials evaluating potential treatments. More than 7.5 million
infected cases were found in more than 200 countries until
11th June 2020, among which around 421 thousand deaths,
3.8 million recovery, 3.2 million mild cases and 54 thousand
critical cases were reported , .
In order to combat with the spreading of COVID-19,
effective screening and immediate medical response for the
infected patients is a crying need. Reverse Transcription
Polymerase chain reaction (RT-PCR) is the most used clinical
screening method for the COVID-19 patients, which uses
respiratory specimens for testing . RT-PCR is used as a
reference method for the detection of COVID-19 patients,
however, the technique is manual, complicated, laborious
and time-consuming with a positivity rate of only 63% .
Moreover, there is a signiﬁcant shortage of its supply,
which leads to delay in the disease prevention efforts .
Many countries are facing difﬁculties with incorrect number
of COVID-19 positive cases because of not only due to
the lack of test kits but also due to the delay in the
test results . These delays can lead to infected patients
interacting with the healthy patients and infecting them in
the process. It is reported that the RT-PCR kit costs about
USD 120-130 and also requires a specialized biosafety lab
to house the PCR machine, each of which may cost USD
15,000 to USD 90,000 . Such an expensive screening
tool with delayed test results is leading to spread of the
disease, making the scenario worst. This is not an issue
for the low-income countries only but certain developed
countries are also struggling to tackle with this . The
other diagnosis methods of the COVID-19 include clinical
symptoms analysis, epidemiological history and positive
radiographic images (computed tomography (CT) /Chest
radiograph (CXR)) as well as positive pathogenic testing.
The clinical characteristics of severe COVID-19 infection is
that of bronchopneumonia causing fever, cough, dyspnea, and
respiratory failure with acute respiratory distress syndrome
(ARDS) – . Readily available radiological imaging
is an important diagnostic tool for COVID-19. The majority
of COVID-19 cases have similar features on radiographic
images including bilateral, multi-focal, ground-glass opacities with a peripheral or posterior distribution, mainly in the
lower lobes, in the early stage and pulmonary consolidation
in the late stage – . Although typical CXR images
may help early screening of suspected cases, the images of
various viral pneumonias are similar and they overlap with
other infectious and inﬂammatory lung diseases. Therefore,
it is difﬁcult for radiologists to distinguish COVID-19 from
other viral pneumonias. The symptoms of COVID-19 being
similar to that of viral pneumonia can sometimes lead to
wrong diagnosis in the current situation while hospitals are
overloaded and working round the clock. Such an incorrect
diagnosis can lead to a non-COVID viral Pneumonia being
falsely labelled as highly suspicious of having COVID-19 and
thus delaying in treatment with consequent costs, effort and
risk of exposure to positive COVID-19 patients.
Currently many biomedical health problems and complications (e.g. brain tumor detection, breast cancer detection, etc.) are using Artiﬁcial Intelligence (AI) based
solutions – . Deep learning techniques can reveal
image features, which are not apparent in the original
images. Speciﬁcally, Convolutional Neural Network (CNN)
has been proven extremely beneﬁcial in feature extraction
and learning and therefore, widely adopted by the research
community . CNN was used to enhance image quality
in low-light images from a high-speed video endoscopy 
and was also applied to identify the nature of pulmonary
nodules via CT images, the diagnosis of pediatric pneumonia
via chest X-ray images, automated labelling of polyps
during colonoscopic videos, cystoscopic image analysis
from videos – . Deep learning techniques on chest
X-Rays are getting popularity with the availability of the
deep CNNs and the promising results it has shown in
different applications. Moreover, there is an abundance
of data available for training different machine-learning
models. Transfer learning technique has signiﬁcantly eased
the process by allowing quickly retrain a very deep CNN
network with a comparatively low number of images.
Concept of transfer learning in deep learning framework
was used by Vikash et al for the detection of
pneumonia using pre-trained ImageNet models and
their ensembles. A customized VGG16 model was used
by Xianghong et al. for lung regions identiﬁcation and
different types of pneumonia classiﬁcation. Wang et al 
used a large hospital-scale dataset for classiﬁcation and
localization of common thoracic diseases and Ronneburger
et al used image augmentation on a small set of images
to train deep CNN for image segmentation problem to achieve
better performance. Rajpurkar et al reported a 121layer CNN (CheXNet) on chest X-rays to detect 14 different
pathologies, including pneumonia using an ensemble of
different networks. A pre-trained DenseNet-121 and feature
extraction techniques were used in the accurate identiﬁcation
of 14 thoracic diseases in . Sundaram et al. used
AlexNet and GoogLeNet with image augmentation to obtain
VOLUME 8, 2020
M. E. H. Chowdhury et al.: Can AI Help in Screening Viral and COVID-19 Pneumonia?
an Area Under the Curve (AUC) of 0.95 in pneumonia
detection.
Recently, several groups have reported deep machine
learning techniques using X-ray images for detecting
COVID-19 pneumonia – . However, most of these
groups used rather a small dataset containing only a few
COVID-19 samples. This makes it difﬁcult to generalize
their results reported in these articles and cannot guarantee that the reported performance will retain when these
models will be tested on a larger dataset. Ioannis et al. 
reported transfer learning approach for classifying dataset
of 1427 X-ray images containing 224 COVID-19, 700 Bacterial Pneumonia and 504 Normal X-ray images with
accuracy, sensitivity, and speciﬁcity of 96.78%, 98.66%,
and 96.46% respectively. Different pre-trained models were
compared however, the reported results were based on a small
dataset. Ashfar et al. proposed a Capsule Networks,
called COVID-CAPS rather than a conventional CNN to deal
with a smaller dataset. COVID-CAPS was reported to achieve
an accuracy of 95.7%, sensitivity of 90%, and speciﬁcity
of 95.8%. Abbas et al. have worked on a very small
database of 105 COVID-19, 80 Normal and 11 SARS X-ray
images to detect COVID-19 X-ray images using modiﬁed
pre-trained CNN model (DeTraC-Decompose, Transfer and
Compose) to project the high-dimension feature space into
a lower one. This would help to produce more homogenous
classes, lessen the memory requirements and achieved
accuracy, sensitivity and speciﬁcity of 95.12%, 97.91% and
91.87% respectively. Wang and Wong in introduced a
deep CNN, called COVID-Net for the detection of COVID-19
cases from around 14k chest X-ray images, however
the achieved accuracy was 83.5%. Ucar et al. has
ﬁne-tuned SqueezeNet pre-trained network with Bayesian
optimization to classify COVID-19 images, which showed
promising result on a small dataset. This approach should
be evaluated on a large COVID and non-COVID dataset.
Khan et al. applied transfer learning approach on
310 normal, 330 bacterial pneumonia, 327 viral pneumonia
and 284 COVID-19 pneumonia images. However, different
machine learning algorithms were not evaluated in this study
and the experimental protocol was not clear in this work.
In summary, several recent works were reported on transfer
learning approach for the detection of COVID-19 X-ray
images from a small dataset with promising results however
these needed to be veriﬁed on a large dataset. Some group
have modiﬁed or ﬁne-tuned the pre-trained networks to
achieve better performance while some groups use capsule
networks. A rigorous experiment on a large database of
COVID and non-COVID classes are very few and missing
in case of transfer learning approach. The authors in this
paper have prepared a large database of X-ray images
of 1579 normal, 1485 viral pneumonia and 423 COVID-19
positive pneumonia and made this publicly available so that
other researchers can get beneﬁt from it. Moreover, eight
different pre-trained deep learning networks were trained,
validated and tested for two different classiﬁcation schemes.
One classiﬁcation model was trained to classify COVID-19
and normal X-ray images while other was trained to classify
normal, viral pneumonia and COVID-19 pneumonia images.
Both of the experiments were evaluated with and without
image augmentation technique to study the effect of image
augmentation in this particular problem.
II. METHODOLOGY
Deep convolutional neural networks typically perform better
with a larger dataset than a smaller one. Transfer learning
can be used in the training of deep CNNs where the dataset
is not large. The concept of transfer learning uses the
trained model from large dataset such as ImageNet and
modify the Softmax and classiﬁcation layer of the pre-trained
networks. The pre-trained weights are then used for faster
training of the network for an application with comparatively
smaller dataset. This removes the requirement of having
large dataset and also reduces the long training period as is
required by the deep learning algorithm when developed from
scratch , .
Although there are a large number of COVID-19 patients
infected worldwide, the number of chest X-ray images
publicly available online are small and scattered. Therefore,
in this work, authors have reported a comparatively large
dataset of COVID-19 positive chest X-ray images while
normal and viral pneumonia images are readily available
publicly and used for this study. A Kaggle database was
created by the authors to make the database publicly available
to the researchers worldwide and the trained models were
made available so that others can get beneﬁt of this study .
A. DATABASE DESCRIPTION
In this study, posterior-to-anterior (AP)/anterior-to-posterior
(PA) image of chest X-ray was used as this view of radiography is widely used by radiologist in clinical diagnosis.
Six different sub-databases were used to create one database.
Among these databases, COVID-19 database was developed by the authors from collected and publicly available
databases, while normal and viral pneumonia databases were
created from publicly available Kaggle databases. In the
following section, authors have summarized how this dataset
is created.
COVID-19 sub-database, comprising of 423 AP/PA
images, was created from the following four major data
Interventional
Radiology (SIRM) COVID-19 DATABASE :
SIRM COVID-19 database reports 384 COVID-19
positive radiographic images (CXR and CT) with varying
resolution. Out of 384 radiographic images, 94 images are
chest X-ray images and 290 images are lung CT images.
This database is updated in a random manner and until 10th
May 2020, there were 71 conﬁrmed COVID-19 cases were
reported in this database.
• Novel Corona Virus 2019 Dataset :
VOLUME 8, 2020
M. E. H. Chowdhury et al.: Can AI Help in Screening Viral and COVID-19 Pneumonia?
Joseph Paul Cohen and Paul Morrison and Lan Dao
have created a public database in GitHub by collecting 319 radiographic images of COVID-19, Middle
East respiratory syndrome (MERS), Severe acute respiratory syndrome (SARS) and ARDS from the published
articles and online resources. In this database, they have
collected 250 COVID-19 positive chest X-ray images and
25 COVID-19 positive lung CT images with varying image
resolutions. However, in this study, authors have considered
134 COVID-19 positive chest X-ray images, which are
different from the images of the database that the authors
created from different articles.
• COVID-19 positive chest x-ray images from different
GitHub database has encouraged the authors to look into
the literature and interestingly more than 1200 articles were
 
observed that the GitHub database has not collected most
of the X-ray and CT images rather a small number of
images were in that database. Moreover, the images in SIRM
and GitHub database are in random size depending on the
X-ray machine resolution and the articles from which it was
taken. Therefore, authors have carried out a tedious task of
collecting and indexing the X-ray and CT images from all the
recently publicly available articles and online sources. These
articles and the radiographic images were then compared with
the GitHub database to avoid duplication. Authors managed
to collect 60 COVID-19 positive chest X-ray images from
43 recently published articles , which were not listed
in the GitHub database and 32 positive chest x-ray images
from Radiopaedia , which were not listed in the GitHub
• COVID-19 Chest imaging at thread reader:
A physician has shared 103 images for 50 different cases
with varying resolution from his hospital in Spain to the
Chest imaging at thread reader . Images from RSNA-
Pneumonia-Detection-Challenge database along with the
Chest X-ray Images database from Kaggle were used
to create the normal and viral pneumonia sub-databases
of 1579 and 1485 X-ray images respectively.
• RSNA-Pneumonia-Detection-Challenge
In 2018, Radiology Society of North America (RSNA)
organized an artiﬁcial intelligence (AI) challenge to detect
pneumonia from the chest X-ray images. In this database,
normal chest X-ray with no lung infection and non-COVID
pneumonia images were available .
• Chest X-Ray Images (pneumonia):
Kaggle chest X-ray database is a very popular database,
which has 5247 chest X-ray images of normal, viral and
bacterial pneumonia with resolution varying from 400p to
2000p . Out of 5247 chest X-ray images, 3906 images are
from different subjects affected by pneumonia (2561 images
for bacterial pneumonia and 1345 images for viral pneumonia) and 1341 images are from normal subjects. Chest X-ray
images for normal and viral pneumonia were used from this
FIGURE 1. Sample X-ray image from the dataset: COVID-19 X-ray image
(A), normal X-ray image (B), and viral pneumonia X-ray image (C).
database to create the new database. Figure 1 shows sample
images from the database for normal, COVID-19 pneumonia,
and viral pneumonia chest X-ray images.
B. CNN MODEL SELECTION
Eight different pre-trained CNN models were trained, validated and tested in this study. The experimental evaluation of
MobileNetv2, SqueezeNet , ResNet18 , ResNet101
and DenseNet201 were performed utilizing MATLAB 2020a
running on a computer with Intel
i7-core @3.6GHz processor and 16GB RAM, with an 8-GB NVIDIA GeForce
GTX 1080 graphics processing unit (GPU) card on 64-bit
Windows 10 operating system. On the other hand, CheXNet,
Inceptionv3 and VGG19 were implemented using PyTorch
library with Python on Intel R⃝Xeon R⃝CPU E5-2697 v4 @
2,30GHz and 64 GB RAM, with a 16 GB NVIDIA GeForce
GTX 1080 GPU. Three comparatively shallow networks
(MobileNetv2, SqueezeNet and ResNet18) and ﬁve deep
networks (Inceptionv3, ResNet101, CheXNet, VGG19 and
DenseNet201) were evaluated in this study to investigate
whether shallow or deep networks are suitable for this
application. Two different variants of ResNet were used
to compare speciﬁcally the impact of shallow and deep
networks with similar structure. Performance difference due
to initially trained on different image classes other than
X-ray images were compared with CheXNet, which is a
121-layer DenseNet variant and the only network pre-trained
on X-ray images. Several researchers showed the reliability of
using this network for COVID-19 classiﬁcation. Therefore, it
was important to investigate whether CheXNet outperforms
other deep networks or not. Eight pre-trained CNN models
were trained using stochastic Gradient Descent (SGD)
with momentum optimizer with learning rate, α = 10−3,
momentum update, β = 0.9 and mini-batch size of 16 images
with 20 Back Propagation epochs. Fivefold cross-validation
result was averaged to produce the ﬁnal receiver operating
characteristic (ROC) curve, confusion matrix, and evaluation
Two different experiments were carried out in this study:
i) Two-class image classiﬁcation using models trained
without and with images augmentation, and ii) Three-class
image classiﬁcation using models trained without and
with image augmentation. Figure 2 illustrates the overall
system diagram with the three-class image classiﬁcation
VOLUME 8, 2020
M. E. H. Chowdhury et al.: Can AI Help in Screening Viral and COVID-19 Pneumonia?
FIGURE 2. Block diagram of the overall system.
TABLE 1. Number of images per class and per fold before and after data augmentation.
C. PREPROCESSING
Chest X-ray images were only resized before applying as
input to the networks. Input requirements for different CNNs
are different. For SqueezeNet, the images were resized
to 227 × 227 pixels whereas for mobilenetv2, ResNet18,
ResNet101, VGG19 and DenseNet201, the images were
resized to 224 × 224 pixels; and for Inceptionv3 the images
were resized to 299×299 pixels. All images were normalized
according to the pre-trained model standards.
In the study1, image augmentation technique was not
applied to the training data. Since COVID-19 positive chest
X-ray images were 423, same number of X-ray images
were randomly selected from normal (out of 1579) and viral
pneumonia (out of 1485) images to match with COVID-19
images to balance the database. In study2, entire database
(i.e., 423 COVID-19, 1579 normal and 1485 viral pneumonia
images) was used. Both the experiments were evaluated using
a stratiﬁed 5-fold cross-validation (CV) scheme with a ratio
of 80% for training and 20% for the test (unseen folds) splits,
where 10% of training data is used as a validation set to avoid
overﬁtting. However, in study2, COVID-19 images are much
smaller in number than that in the other two image classes.
Moreover, overall image number in any class was not several
thousand. Therefore, Image augmentation techniques were
applied to viral pneumonia, normal and COVID-19 X-ray
images for training to create a balanced training set. However,
COVID-19 images were augmented six times while normal
and viral pneumonia images were augmented once only.
FIGURE 3. Original chest X-ray image (A), Image after rotation by
15 degree clockwise (B), Image after rotation by 15 degree counter
clockwise (C), Image after 5% horizontal translation (D), after 5% vertical
translation (E), and after 5% horizontal and vertical translation (F).
D. IMAGE AUGMENTATION
In this study, two different image augmentation techniques (rotation, and translation) were utilized to generate COVID-19 training images, as shown in Figure 3.
The rotation operation used for image augmentation was done
by rotating the images in the clockwise and counter clockwise
direction with an angle of 5, 10 and 15 degrees. Image
translation was done by translating image horizontally and
vertically by −5% to 5%. However, only image translation
was applied to the viral and normal X-ray training images.
Table 1 summarizes the number of images per class used
for training, validation, and testing at each fold. Study1 was
carried out with COVID-19 and normal images while
study2 was carried out with COVID-19, normal and viral
pneumonia images.
E. INVESTIGATION OF THE DEEP LAYER FEATURES
The deep layers features of the image were investigated by
comparing the activated areas of the convolutional layers with
VOLUME 8, 2020
M. E. H. Chowdhury et al.: Can AI Help in Screening Viral and COVID-19 Pneumonia?
FIGURE 4. Activation map for sample network models of (i) first
convolutional layer, (ii) strongest activation channel of first convolutional
layer, (iii) deep layer images set, and (iv) corresponding strongest
activation channel for the deep convolutional layer for a specific X-ray
image input.
the matching regions in the original images. The activation
map can take different range of values and was therefore
normalized between 0 and 1. The strongest activation
channels from the COVID-19, normal and viral pneumonia
X-ray images were identiﬁed and compared with the original
images. It was noticed that the strongest channel activates on
edges with positive activation on light left/dark right edges,
and negative activation on dark left/light right edges.
Convolutional neural networks learn to detect features
like color and edges in their ﬁrst convolutional layer.
In deeper convolutional layers, the network learns to detect
features that are more complicated. Later layers build
up their features by combining features of earlier layers.
Figure 4 shows the activation map in early convolutional
layers, deep convolutional layer and their corresponding
strongest activation channel for each of the models. It might
be difﬁcult to distinguish COVID-19 and viral pneumonia
from the original images as reported by different research
groups. However, the deep layer features explain better the
reason of a deep learning network’s failure or success in a
particular decision. It provides a visual explanation of the
prediction of CNN and it highlights the regions of the images
which are contributing more in classiﬁcation. This technique
will be used in the result and discussion section to illustrate
how this activation mapping is a distinguishing feature
of COVID-19 X-ray images from the other two class of
F. PERFORMANCE EVALUATION MATRIX
In order to evaluate the performance of different deep
learning algorithms for classifying the X-ray images in
case of two different classiﬁcation schemes. The trained
algorithms were validated using 5-fold cross-validation.
The performance of different networks was evaluated using
ﬁve performances metrics such as- accuracy, sensitivity or
recall, speciﬁcity, precision (PPV), and F1 score. Per-class
values were computed over the overall confusion matrix that
accumulates all test fold results of the 5-fold cross-validation.
Accuracyclass_i =
TPclass_i+TNclass_i
TPclass_i+TNclass_i+FPclass_i+FNclass_i
Precisionclass_i =
TPclass_i + FPclass_i
Sensitivityclassi =
TPclassi + FNclassi
F1_scoreclassi = 2Precisionclassi × Sensitivityclassi
Precisionclassi + Sensitivityclassi
Speciﬁcityclass_i =
TNclass_i + FPclass_i
where classi
COVID-19, and Normal for two class
problem; COVID-19, Normal and Viral Pneumonia for three
class problem.
III. RESULTS AND DISCUSSION
Two different schemes were studied in this study. Classiﬁcation of COVID-19 and Normal images using eight
different pre-trained CNN models while training was done
with and without image augmentation. COVID-19, normal
and viral pneumonia images were classiﬁed using same eight
pre-trained models and training was carried out with and
without image augmentation.
A. EXPERIMENTAL RESULTS-TWO CLASS PROBLEM
The comparative performance for different CNNs for twoclass classiﬁcation problem with and without augmentation
is shown in Table 2 and comparative AUC curves are
shown in Figure 5.It is apparent from Table 2 that all the
evaluated pre-trained models perform very well in classifying
COVID-19 and normal images in two-class problem. The
weighted average performance matrix for eight different
networks are very similar whereas small gain can be observed
when training was done using image augmentation. Among
the networks trained with 338 X-ray images for two-class
problem, ResNet18 and CheXNet are equally performing
for classifying images while CheXNet and DenseNet201 are
performing better than others in case of training with augmented images, although the difference is marginal. CheXNet
is producing the highest accuracy of 99.4% and 99.7% for
two-class classiﬁcation without and with image augmentation
respectively. Interestingly, CheXNet is performing well in
both the cases, with and without augmentation and this can
be explained from the fact that CheXNet is the only network
which is pre-trained on a large.
X-ray image database and the network supposed to
perform better for X-ray image classiﬁcation without the
requirement of training again on a larger dataset. However,
in this classiﬁcation problem as the COVID-19 images are
signiﬁcantly different from normal images all the tested
networks are performing well. This is apparent from the ROC
curves of Figure 5 as well. In both the cases (without and
with augmentation) for two-class problem, ROC curves are
showing comparable performance from all the networks.
VOLUME 8, 2020
M. E. H. Chowdhury et al.: Can AI Help in Screening Viral and COVID-19 Pneumonia?
FIGURE 5. Comparison of the ROC curve for normal, and COVID-19 Pneumonia classification using CNN based models without (A) and with
(B) image augmentation.
TABLE 2. Weighted average performance metrics for different deep learning networks for two-class classification problem with and without image
augmentation.
B. EXPERIMENTAL RESULTS-THREE CLASS PROBLEM
Table 3 summarizes the performance matrix for different
pre-trained CNN algorithms tested for the two different
classiﬁcation schemes without and with image augmentation.
It can be noticed that all the pre-trained networks (shallow
or deep) are showing very similar performance apart from
CheXNet in case of training without image augmentation.
If the pre-trained networks are trained on a small image
dataset as reported by the most of the research groups in
the literature, the performance difference is very marginal
and overall performance is reduced for three-class problem
in comparison to two-class problem. This is expected as
networks are now confused between COVID-19 and viral
pneumonia. However, CheXNet is still performing well while
trained on a small dataset as CheXNet was originally trained
one a very large X-ray image dataset. On the other hand,
while the image augmentation was applied to the training
image set, all the pre-trained networks are now performing
based on their capability to distinguish the three-class
images. Typically, the deeper the network the better is the
performance in distinguishing the image classes.
However, it is important to note that Resnet18 and
ResNet101 do not support this statement rather ResNet18
being a much shallow network than ResNet101, ResNet18 is
still outperforming ResNet101.
Interestingly, CheXNet which is a 121-layer variant of
DenseNet trained on X-ray images, is not outperforming a
deeper variant of DenseNet with 201-layers. Therefore, it can
be summarized that even though CheXNet was trained originally on X-ray images but training an even deeper network
with a larger image set can give better chance of training from
the new image sets on which the training is done, i.e., deep
network can learn better and perform better if the training
is carried out on a larger dataset. DenseNet201 outperforms
VOLUME 8, 2020
M. E. H. Chowdhury et al.: Can AI Help in Screening Viral and COVID-19 Pneumonia?
TABLE 3. Weighted average performance metrics for different deep learning networks for three-class classification problem with and without image
augmentation.
other models in three-class classiﬁcation scheme in terms of
different performance indices when the image augmentation
was employed and the performance matrix was signiﬁcantly
improved with image augmentation. It is obvious from
Figure 6 that DenseNet201with image augmentation can
signiﬁcantly increase overall network performance.
Figure 7 shows the confusion matrix for DenseNet201 for
two-class and three-class problems with image augmentation.
It is clear from Figure 7(A) that only three COVID-19 images
out of 423 images were miss-classiﬁed to normal (false
negative) and only three images out of 1579 images were
miss-classiﬁed to COVID-19 (false positive). This reﬂects
that this deep learning technique is extremely robust in
distinguishing COVID-19 images from normal X-ray images.
In the three-class problem, only one COVID-19 image
was miss-classiﬁed to normal, which is one of the three
images miss-classiﬁed by the two-class classiﬁer. Two other
COVID-19 images were miss-classiﬁed as viral pneumonia
images. None of normal images were miss-classiﬁed to
COVID-19 by the three-class classiﬁer although several
normal images were miss-classiﬁed to viral pneumonia.
COVID-19 image miss-classiﬁed to normal has bad consequences than miss-classiﬁed to other disease category (i.e.,
viral pneumonia). Similarly, normal images miss-classiﬁed
to viral pneumonia has less severe consequence than to be
miss-classiﬁed to COVID-19 pneumonia. Only four viral
pneumonia images were miss-classiﬁed to COVID-19 out
of 1485 images while 33 images miss-classiﬁed to normal.
It can be noted that network is not confusing between
COVID-19, and other two image classes rather network is
more confused between viral pneumonia and normal images.
However, the high precision and F1 score show that the
network is still performing excellent in classifying most of the
images reliably. This is very important, as the computer-aided
system (CAD) should not classify any COVID-19 patients to
normal or vice versa; however, it is important to see the reason
of the classiﬁer being failed for three COVID-19 patients’
X-ray images and miss-classiﬁed them to normal.
The difference between normal and COVID-19 X-ray
images can be observed in the deep convolutional layer of
pre-trained CNN model. It is notable from Figure 8 that the
14th layer of the DenseNet201 can detect features that can
distinguish normal, COVID-19 and Viral Pneumonia images.
This shows the reason of the success of the network in
detecting COVID-19 X-ray images and distinguishing it from
normal and viral pneumonia images, which several groups
of researchers reported earlier are not reliably possible by
plain X-ray images – . It is really difﬁcult for the
practicing radiologist to ﬁnd abnormality in the early stage of
COVID-19. However, with the help of artiﬁcial intelligence,
the X-ray images can be used to identify the deep layer
features which are not visible to the human eyes . The
deep layers enhance the distinctive features of COVID-19,
viral pneumonia and normal patients’ X-ray images, thereby
enhancing the chance of identifying the abnormality in the
lungs of the patients.
miss-classiﬁed to normal. Image 01-03 are miss-classiﬁed
by two-class classiﬁer and Image-03 is miss-classiﬁed by
three-class classiﬁer. The main reason behind the missing
of these COVID-19 images is a less opacity in the left
and right upper lobe and suprahilar on posterior-to-anterior
VOLUME 8, 2020
M. E. H. Chowdhury et al.: Can AI Help in Screening Viral and COVID-19 Pneumonia?
FIGURE 6. Comparison of the ROC curve for normal, COVID-19 and viral pneumonia classification using CNN based models without (A) and
with (B) image augmentation.
FIGURE 7. Confusion matrix for classification of (A) Normal and COVID-19, and (B) Normal, COVID-19 and viral pneumonia using DenseNet201.
FIGURE 8. Images of 23rd channel of first convolutional layer (i), 14th
convolutional layer (ii) and 29th convolutional layer images (iii) from
DenseNet201 for different subject groups: Normal, COVID-19, and viral
pneumonia. Red arrows in COVID-19 image shows the regions of light
focus edge, a distinctive feature in COVID-19 patients’ X-ray images which
are not present in viral pneumonia and normal patients.
x-ray images, which is very similar to normal X-ray images
(see Figure 8). The algorithm fails if no evident light focus
edge feature is appeared in the deep layer and this type of
FIGURE 9. Three COVID-19 X-ray images which are miss-classified to
normal images by two- and three-class classifier. Note: Image 01-03 are
miss-classified by two-class classifier and Image-03 is miss-classified by
three-class classifier.
COVID-19 cases have to be conﬁrmed by other techniques.
These three images were evaluated by three practicing
radiologists to identify what is their evaluations for these
three images. First and third images were identiﬁed as no
sign or very little sign of COVID-19 by the radiologists while
image-02 was identiﬁed as very mild stage of lung infections.
It can be summarized that the proposed technique can classify
most of the COVID-19 X-ray images very reliably.
VOLUME 8, 2020
M. E. H. Chowdhury et al.: Can AI Help in Screening Viral and COVID-19 Pneumonia?
IV. CONCLUSION
This work presents deep CNN based transfer learning
approach for automatic detection of COVID-19 pneumonia.
Eight different popular and previously reported efﬁcient CNN
based deep learning algorithms were trained, validated and
tested for classifying normal and pneumonia patients using
chest X-ray images. It was observed that DenseNet201 outperforms other different deep CNN networks while image
augmentation was used for training the CNN models.
CheXNet which is a variant of DenseNet was outperforming
other networks while image augmentation was not used.
This is obvious as the CheXNet was pre-trained on a large
X-ray database and it is showing better performance on this
study while trained on a small non-augmented image dataset.
However, a deeper version of DenseNet, when trained on a
large augmented dataset, Dense201 outperforms CheXNet.
This clearly reveals the fact that the performance reported
on smaller database in the literature should be evaluated on a
large dataset otherwise, the ﬁndings of these studies cannot be
generalized for real applications. In this work, authors have
reported the ﬁndings from a large database along with the
image augmentation to train shallow and deep networks and
it was observed that deep networks perform better than the
shallow networks particularly in classifying normal and viral
images as most of the networks can identify COVID-19 with
very high sensitivity. The classiﬁcation accuracy, precision,
sensitivity, and speciﬁcity of normal and COVID-19 images,
and normal, COVID-19 and viral pneumonia were (99.7%,
99.7%, 99.7% and 99.55%), and (97.9%, 97.95%, 97.9%,
and 98.8%) respectively. COVID-19 has already become
a threat to the world’s healthcare system and economy
and thousands of people have already died. Deaths were
initiated by respiratory failure, which leads to the failure
of other organs. Since a large number of patients attending
out-door or emergency, doctor’s time is limited and computeraided-diagnosis can save lives by early screening and propercare. Moreover, there is a large degree of variability in the
input images from the X-ray machines due to the variations of
expertise of the radiologist. Artiﬁcial intelligence exhibits an
excellent performance in classifying COVID-19 pneumonia
provided that the network is effectively trained from a large
dataset. We believe that this computer aided diagnostic tool
can signiﬁcantly improve the speed and accuracy in the
screening of COVID-19 positive cases. The method would be
highly useful in this pandemic where disease burden and need
for preventive measures are at odds with available resources.
AUTHORS CONTRIBUTION
Muhammad E. H. Chowdhury: Conceptualization, Writing -
Review & Editing, Supervision, and Project administration.
Tawsifur Rahman: Data Curation, Methodology, Software,
Validation, Formal analysis, Writing - Review & Editing.
Amith Khandakar: Data Curation, Investigation, Resources,
Writing - Original Draft, Writing - Review & Editing. Rashid
Mazhar: Writing - Original Draft, Writing - Review & Editing. Muhammad Abdul Kadir: Methodology, Visualization,
Editing. Zaid Bin Mahbub: Methodology, Visualization.
Khandakar R. Islam: Data Curation, Writing - Original Draft.
Muhammad Salman Khan: Visualization, Writing - Original
Draft. Atif Iqbal: Writing - Review & Editing, Nasser
Al-Emadi: Writing - Review & Editing, Supervision, Mamun
Bin Ibne Reaz: Writing - Review & Editing, Supervision,
Conceptualization. M. T. Islam: Writing - Review & Editing,
Supervision.
ACKNOWLEDGMENTS
This work was made possible by NPRP12S-0227-190164
from the Qatar National Research Fund, a member of Qatar
Foundation, Doha, Qatar. The statements made herein are
solely the responsibility of the authors. The publication of this
article was funded by the Qatar National Library. The authors
would like to thank Italian Society of Medical Radiology and
Interventional for sharing the X-ray images of COVID-19
patients publicly and would like to thank J. P. Cohen for
taking the initiative to gather images from articles and online
resources. Last but not the least, authors would like to
acknowledge the Chest X-Ray Images (pneumonia) database
and RSNA Pneumonia Detection Challenge in Kaggle which
helped signiﬁcantly to make this work possible. Otherwise,
normal and viral pneumonia images were not accessible to
CONFLICTS OF INTEREST
The authors declare no conﬂict of interest.