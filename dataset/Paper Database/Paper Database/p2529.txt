Acta Numerica
 
Additional services for Acta Numerica:
Email alerts: Click here
Subscriptions: Click here
Commercial reprints: Click here
Terms of use : Click here
Inverse problems: A Bayesian perspective
A. M. Stuart
Acta Numerica / Volume 19 / May 2010, pp 451 - 559
DOI: 10.1017/S0962492910000061, Published online: 10 May 2010
Link to this article: 
How to cite this article:
A. M. Stuart . Inverse problems: A Bayesian perspective. Acta Numerica, 19, pp 451-559 doi:10.1017/
S0962492910000061
Request Permissions : Click here
Downloaded from IP address: 137.205.50.42 on 11 Sep 2013
Acta Numerica , pp. 451–559
c⃝Cambridge University Press, 2010
doi:10.1017/S0962492910000061
Printed in the United Kingdom
Inverse problems: A Bayesian perspective
A. M. Stuart
Mathematics Institute,
University of Warwick,
Coventry CV4 7AL, UK
E-mail: 
The subject of inverse problems in diﬀerential equations is of enormous practical importance, and has also generated substantial mathematical and computational innovation. Typically some form of regularization is required to ameliorate ill-posed behaviour. In this article we review the Bayesian approach
to regularization, developing a function space viewpoint on the subject. This
approach allows for a full characterization of all possible solutions, and their
relative probabilities, whilst simultaneously forcing signiﬁcant modelling issues to be addressed in a clear and precise fashion. Although expensive to
implement, this approach is starting to lie within the range of the available
computational resources in many application areas.
It also allows for the
quantiﬁcation of uncertainty and risk, something which is increasingly demanded by these applications. Furthermore, the approach is conceptually
important for the understanding of simpler, computationally expedient approaches to inverse problems.
We demonstrate that, when formulated in a Bayesian fashion, a wide range
of inverse problems share a common mathematical framework, and we highlight a theory of well-posedness which stems from this. The well-posedness
theory provides the basis for a number of stability and approximation results
which we describe. We also review a range of algorithmic approaches which
are used when adopting the Bayesian approach to inverse problems. These
include MCMC methods, ﬁltering and the variational approach.
Introduction
The Bayesian framework
Common structure
Algorithms
Probability
References
A. M. Stuart
1. Introduction
A signiﬁcant challenge facing mathematical scientists is the development of
a coherent mathematical and algorithmic framework enabling researchers to
blend complex mathematical models with the (often vast) data sets which
are now routinely available in many ﬁelds of engineering, science and technology. In this article we frame a range of inverse problems, mostly arising
from the conjunction of diﬀerential equations and data, in the language of
Bayesian statistics. In so doing our aim is twofold: (i) to highlight common
mathematical structure arising from the numerous application areas where
signiﬁcant progress has been made by practitioners over the last few decades
and thereby facilitate exchange of ideas between diﬀerent application domains; (ii) to develop an abstract function space setting for the problems
in order to evaluate the eﬃciency of existing algorithms, and to develop
new algorithms. Applications are far-reaching and include ﬁelds such as the
atmospheric sciences, oceanography, hydrology, geophysics, chemistry and
biochemistry, materials science, systems biology, traﬃc ﬂow, econometrics,
image processing and signal processing.
The guiding principle underpinning the speciﬁc development of the subject of Bayesian inverse problems in this article is to avoid discretization
until the last possible moment. This principle is enormously empowering
throughout numerical analysis. For example, the ﬁrst-order wave equation
is not controllable to a given ﬁnal state in arbitrarily small time because of
ﬁnite speed of propagation. Yet every ﬁnite diﬀerence spatial discretization
of the ﬁrst-order wave equation gives rise to a linear system of ordinary
diﬀerential equations which is controllable, in any ﬁnite time, to a given
ﬁnal state; asking the controllability question before discretization is key to
understanding . As another example consider the heat equation. If this is discretized in time by the theta method (with θ ∈ and
θ = 0 being explicit Euler, θ = 1 implicit Euler), but left undiscretized in
space, the resulting algorithm on function space is only deﬁned if θ ∈[1
thus it is possible to deduce that there must be a Courant restriction if
2) before even introducing spatial
discretization. Yet another example may be found in the study of Newton
methods: conceptual application of this algorithm on function space, before
discretization, can yield considerable insight when applying it as an iterative method for boundary value problems in nonlinear diﬀerential equations
 . The list of problems where it is beneﬁcial to defer discretization to the very end of the algorithmic formulation is almost endless.
It is perhaps not surprising, therefore, that the same idea yields insight
in the solution of inverse problems and we substantiate this idea in the
Bayesian context.
Inverse problems
The article is divided into ﬁve parts. The next section, Section 2, is devoted to a description of the basic ideas of Bayesian statistics as applied to
inverse problems in the ﬁnite-dimensional setting. It also includes a pointer
to the common structure that we will highlight in the remainder of the article
when developing the Bayesian viewpoint in function space. Section 3 contains a range of inverse problems arising in diﬀerential equations, showing
how the Bayesian approach may be applied to inverse problems for functions; in particular, we discuss the problem of recovering a ﬁeld from noisy
pointwise data, recovering the diﬀusion coeﬃcient from a boundary value
problem, given noisy pointwise observations of the solution, recovering the
wave speed from noisy observations of solutions of the wave equation and
recovering the initial condition of the heat equation from noisy observation
of the solution at a positive time. We also describe a range of applications,
involving similar but more complex models, arising in weather forecasting,
oceanography, subsurface geophysics and molecular dynamics. In Section 4
we describe, and exploit, the common mathematical structure which underlies all of these Bayesian inverse problems for functions. In that section
we prove a form of well-posedness for these inverse problems, by showing
Lipschitz continuity of the posterior measure with respect to changes in
the data; we also prove an approximation theorem which exploits this wellposedness to show that approximation of the forward problem (by spectral
or ﬁnite element methods, for example) leads to similar approximation results for the posterior probability measure. Section 5 is devoted to a survey
of the existing algorithmic tools used to solve the problems highlighted in
the article. In particular, Markov chain Monte Carlo (MCMC) methods,
variational methods and ﬁltering methods are surveyed. When discussing
variational methods we show, in the setting of Section 4, that posterior
probability maximizers can be characterized through solution of an optimal
control problem, and that this optimal control problem has a minimizer
under the same conditions that lead to a well-posed Bayesian inverse problem. Section 6 contains the background probability required to read the
article; the presentation in this section is necessarily terse and the reader is
encouraged to follow up references in the bibliography for further detail.
A major theme of the article is thus to confront the inﬁnite-dimensional
nature of many inverse problems.
This is important because, whilst all
computational algorithms work on ﬁnite-dimensional approximations, these
approximations are typically in spaces of very high dimension and many
signiﬁcant challenges stem from this fact. By formulating inverse problems
in an inﬁnite-dimensional setting we build these challenges into the fabric
of the problem setting. We provide a clear concept of the ideal solution
to the inverse problem when blending a forward mathematical model with
observational data. This concept can be used to test the practical algorithms
used in applications which, in many cases, use crude approximations for
A. M. Stuart
reasons of computational eﬃciency. Furthermore, it is also possible that
the function space Bayesian setting will also lead to the development of
improved algorithms which exploit the underlying mathematical structure
common to a diverse range of applications.
In particular, the theory of
(Bayesian) well-posedness which we describe forms the cornerstone of many
perturbation theories, including ﬁnite-dimensional approximations.
Kaipio and Somersalo provide a good introduction to the Bayesian
approach to inverse problems, especially in the context of diﬀerential equations. Furthermore, Calvetti and Somersalo provide a useful introduction to the Bayesian perspective in scientiﬁc computing.
overview of the subject of inverse problems in diﬀerential equations, including a strong argument for the philosophy taken in this article, namely
to formulate and study inverse problems in function space, is the book by
Tarantola (see, especially, Chapter 5); however, the mathematics associated with this philosophical standpoint is not developed there to the
same extent that it is in this article, and the focus is primarily on Gaussian
problems. A frequentist viewpoint for inverse problems on function space is
contained in the book by Ramsay and Silverman ; however, we adopt
a diﬀerent, Bayesian, perspective here, and study more involved diﬀerential
equation models than those arising in Ramsay and Silverman . These
books indicate that the development that we undertake here is a natural
one, which builds upon the existing literature.
The subject known as data assimilation provides a number of important applications of the material presented here. Its development has been
driven, to a large extent, by practitioners working in the atmospheric and
oceanographic sciences and in the geosciences, resulting in a plethora of algorithmic approaches and a number of signiﬁcant algorithmic innovations.
A good source for an understanding of data assimilation in the context of the
atmospheric sciences, and weather prediction in particular, is the book by
Kalnay . A book motivated by applications in oceanography, which
simultaneously highlights some of the underlying function space structure of
data assimilation for linear, Gaussian problems, is that of Bennett .
The book by Evensen provides a good overview of many computational aspects of the subject, reﬂecting the author’s experience in geophysical applications and related areas. The recent special edition of Physica D
devoted to data assimilation provides a good entry point to some of the current research in this area . Another application that
ﬁts the mathematical framework developed here is molecular dynamics. The
problems of interest do not arise from Bayesian inverse problems, as such,
but rather from conditioned diﬀusion processes. However, the mathematical structure has much in common with that arising in Bayesian inverse
problems, and so we include a description of this problem area.
Inverse problems
Throughout the article we use standard notation for Banach and Hilbert
space norm and inner products, ∥· ∥, ⟨·, ·⟩, and the following notation for
the ﬁnite-dimensional Euclidean norm and inner product: |·|, ⟨·, ·⟩. We also
use the concept of weighted inner products and norms in any Hilbert space.
For any self-adjoint positive operator A, we deﬁne
⟨·, ·⟩A = ⟨A−1/2·, A−1/2·⟩,
∥· ∥A = ∥A−1/2 · ∥
in the general setting and, in ﬁnite dimensions,
| · |A = |A−1/2 · |.
For any a, b ∈H, a Hilbert space, we deﬁne the operator a⊗b by the identity
(a ⊗b)c = ⟨b, c⟩a for any c ∈H. We use ∗to denote the adjoint of a linear
operator between two Hilbert spaces. In particular, we may view a, b ∈H
as linear operators from R to H and then a ⊗b = ab∗.
In order to highlight the common structure arising in many of the problems in this book, we will endeavor to use the same notation repeatedly
in the diﬀerent contexts. A Gaussian measure will be denoted as N(m, C)
with m the mean and C the covariance operator/matrix. The mean of the
prior Gaussian measure will be m0 and its covariance matrix/operator will
be Σ0 or C0 (we will drop the subscript 0 on the prior where no confusion
arises in doing so). We will use the terminology precision operator for the
(densely deﬁned) L := C−1. For inverse problems the operator mapping the
unknown vector/ﬁeld to the observations will be denoted by G and termed
the observation operator, and the observational noise will be denoted by η.
We emphasize that in this article we will work for the most part with
Gaussian priors. In terms of the classical theory of regularization this means
that we are limiting ourselves to quadratic regularization terms, typically
a Sobolev-type Hilbert space norm. We recognize that there are many applications of importance where other regularizations are natural, especially
in image processing . A signiﬁcant challenge is to take
the material in this article and generalize it to these other settings, and
there is some recent interesting work in this direction .
There are other problem areas which lead to the need for computation of
random functions. For example, there is a large body of work concerned with
uncertainty quantiﬁcation . In this ﬁeld the input data to a diﬀerential equation is
viewed as a random variable and the interest is in computing the resulting
variability in the solution, as the input data varies. This is currently an
active area of research in the engineering community .
The work is thus primarily concerned with approximating
A. M. Stuart
measures which are the push forward, under a nonlinear map, of a Gaussian
measure; in contrast, the inverse problem setting which we study here is
concerned with the approximation of non-Gaussian measures whose Radon–
Nikodym derivative with respect to a Gaussian measure is deﬁned through
a related nonlinear map. A rigorous numerical analysis underpinning the
work of Spanos and Ghanem is an active area of research: see in
particular Schwab and Todor and Todor and Schwab , where
the problem is viewed as an example of Schwab’s more general program
of tensor product approximation for high-(inﬁnite)-dimensional problems
 . A diﬀerent area where tensor products are
used to form approximations of functions of many variables is computational
quantum mechanics and approximation of the Schr¨odinger equation ; this work may also be seen in the more general context of tensor
product approximations in linear algebra . It would
be interesting to investigate whether any of these tensor product ideas can
be transferred to the approximation of probability density functions in highdimensional spaces, as arise naturally in Bayesian inverse problems.
More generally speaking, this article is concerned with a research area
which is at the interface of applied mathematics and statistics. This is a
rich research interface, where there is currently signiﬁcant eﬀort. Examples include work in compressed sensing, which blends ideas from statistics, probability, approximation theory and harmonic analysis , and research aimed at eﬃcient sampling of
Gaussian random ﬁelds combining numerical linear algebra and statistics
 .
2. The Bayesian framework
2.1. Overview
This section introduces the Bayesian approach to inverse problems and outlines the common structure that we will develop in the remainder of the
article. In Section 2.2 we introduce ﬁnite-dimensional inverse problems and
describe the Bayesian approach to their solution, highlighting the role of
observational noise which pollutes the data in many problems of practical
interest. We show how to construct a formula for the posterior measure on
the unknown of interest, from the data and from a prior measure incorporating structural knowledge about the problem which is present prior to the
acquisition of the data. In Section 2.3 we study the eﬀect on the posterior
of small observational noise, in order to connect the Bayesian viewpoint
with the classical perspective on inverse problems. We ﬁrst study problems
where the dimensions of the data set and the unknown match; we show
that the prior measure is asymptotically irrelevant and that, in the limit
of zero noise, the posterior measure converges weakly to a Dirac measure
Inverse problems
centred on the solution of the noise-free equation. We next study the special
structure which arises when the mathematical model and observations are
described through linear operators, and when the prior and the noise are
Gaussian; this results in a Gaussian posterior measure. In this Gaussian
setting we ﬁrst study the limit of vanishing observational noise in the case
where the dimension of the data set is greater than that of the unknown,
showing that the prior is asymptotically irrelevant, and that the posterior
measure approaches a Dirac concentrated on the solution of a natural leastsquares problem. We then study the situation where the dimension of the
data set is smaller than that of the unknown. We show that, in the limit
of small observational noise, the prior remains important and we characterize this eﬀect explicitly. Section 2.4 completes the introductory material
by describing the common framework which we will illustrate and exploit
in the remainder of the article when developing the Bayesian viewpoint on
function space.
2.2. Linking the classical and Bayesian approaches
In applications it is frequently of interest to solve inverse problems: to
ﬁnd u, an input to a mathematical model, given y an observation of (some
components of, or functions of) the solution of the model.
We have an
equation of the form
to solve for u ∈X, given y ∈Y , where X, Y are Banach spaces.
will refer to G as the observation operator.1 We refer to y as data. It is
typical of inverse problems that they are ill-posed: there may be no solution,
or the solution may not be unique and may depend sensitively on y. One
approach to the problem in this situation is to replace it by the least-squares
optimization problem of ﬁnding, for the norm ∥· ∥Y on Y ,
2∥y −G(u)∥2
This problem, too, may be diﬃcult to solve as it may possess minimizing
sequences u(n) which do not converge to a limit in X, or it may possess
multiple minima and sensitive dependence on the data y. These issues can
be somewhat ameliorated by solving a regularized minimization problem
of the form, for some Banach space (E, ∥· ∥E) contained in X, and point
2∥y −G(u)∥2
1 This operator is often denoted with the letter H in the atmospheric sciences community;
because we need H for Hilbert space later on, we use the symbol G.
A. M. Stuart
However, the choice of norms ∥· ∥E, ∥· ∥Y and the point m0 are somewhat
arbitrary, without making further modelling assumptions. We will adopt
a statistical approach to the inverse problems, in which these issues can
be articulated and addressed in an explicit fashion. Roughly speaking, the
Bayesian approach will lead to the notion of ﬁnding a probability measure
µy on X, containing information about the relative probability of diﬀerent
states u, given the data y. For example, in the case where X, Y are both
ﬁnite-dimensional, the noise polluting (2.1) is additive and Gaussian, and
the prior measure is Gaussian, the posterior measure will have density πy
πy(u) ∝exp
2∥y −G(u)∥2
The properties of a measure µy with such a density πy are intimately related
to the minimization problem (2.3): the density is largest at minimizers.
But the probabilistic approach is far richer. For example, the derivation of
the probability measure µy will force us to confront various modelling and
mathematical issues which, together, will guide the choice of norms ∥· ∥E,
∥· ∥Y and the point m0. Furthermore, the probabilistic approach enables
us to answer questions such as: ‘What is the relative probability that the
unknown function u is determined by the diﬀerent local minimizers of (2.3)?’
‘How certain can we be that a prediction made by a mathematical model
will lie in certain speciﬁed regimes?’
We now outline a probabilistic framework which will include the speciﬁc
probability measure with density given by (2.4) as a special case.
framework starts from the observation that a deeper understanding of the
source of data often reveals that the observations y are subject to noise and
that a more appropriate model equation is often of the form
y = G(u) + η,
where η is a mean zero random variable, whose statistical properties we
might know, but whose actual value is unknown to us; we refer to η as
the observational noise. In this context it is natural to adopt a Bayesian
approach to the problem of determining u from y: see Section 6.6.
describe our prior beliefs about u, in terms of a probability measure µ0,
and use Bayes’ formula (see (6.24)) to calculate the posterior probability
measure µy, for u given y.
To be concrete, in the remainder of this subsection and in the next subsection we consider the case where u ∈Rn, y ∈Rq and we let π0 and πy
denote the p.d.f.s (see Section 6.1) of measures µ0 and µy. We assume that
η ∈Rq is a random variable with density ρ. Then the probability of y given
u has density
ρ(y|u) := ρ(y −G(u)).
Inverse problems
This is often referred to as the data likelihood. By Bayes’ formula (6.24) we
ρ(y −G(u))π0(u)
Rn ρ(y −G(u))π0(u) du.
πy(u) ∝ρ(y −G(u))π0(u)
with constant of proportionality depending only on y.
Abstractly (2.7)
expresses the fact that the posterior measure µy (with density πy) and
prior measure µ0 (with density π0) are related through the Radon–Nikodym
derivative (see Theorem 6.2)
(u) ∝ρ(y −G(u)).
Since ρ is a density and thus non-negative, without loss of generality we may
write the right-hand side as the exponential of the negative of a potential
Φ(u; y), to obtain
(u) ∝exp(−Φ(u; y)).
It is this form which generalizes naturally to situations where X, and possibly Y , is inﬁnite-dimensional. We show in Section 3 that many inverse
problems can be formulated in a Bayesian fashion and that the posterior
measure takes this form.
In general it is hard to obtain information from a probability measure in
high dimensions. One useful approach to extracting information is to ﬁnd
a maximum a posteriori estimator, or MAP estimator: a point u which
maximizes the posterior p.d.f. πy; such variational methods are surveyed in
Section 5.3. Another commonly used method for interrogating a probability
measure in high dimensions is sampling: generating a set of points {un}N
distributed (perhaps only approximately) according to πy(u). In this context
formula (2.7) (or (2.9) in the general setting), in which the posterior density
is known only up to a constant, is useful because MCMC methods may be
used to sample from it: MCMC methods have the advantage of sampling
from a probability measure only known up to a normalizing constant; we
outline these methods in Section 5.2. Time-dependent problems, where the
data is acquired sequentially, also provide a class of problems where useful
approximations can be developed; these ﬁltering methods are outlined in
Section 5.4.
We will often be interested in problems where prior µ0 and observational
noise η are Gaussian. If η ∼N(0, B) and µ0 = N(m0, Σ0), then we obtain
A. M. Stuart
from (2.7) the formula2
πy(u) ∝exp
In terms of measures this is the statement that
The maximum a posteriori estimator, or MAP estimator, is then
argminu∈Rn
This is a speciﬁc instance of the regularized minimization problem (2.3).
Note that in the Bayesian framework the norms ∥· ∥Y , ∥· ∥E and the point
m0 all have a clear interpretation in terms of the statistics of the observational noise and the prior measure. In contrast, these norms and point are
somewhat arbitrary in the classical approach.
In general the posterior probability measure (2.10) is not itself Gaussian.
However, if G is linear then the posterior µy is also Gaussian. Identifying the
mean and covariance (or precision) matrix can be achieved by completing
the square, as formalized in Theorem 6.20 and Lemma 6.21 (see also Examples 6.22 and 6.23). The following simple examples illustrate this. They also
show further connections between the Bayesian and classical approaches to
inverse problems, a subject we develop further in the following subsection.
Example 2.1.
Let q = 1 and G be linear so that
y = ⟨g, u⟩+ η
for some g ∈Rn. Assume further that η ∼N(0, γ2) and that we place a
prior Gaussian measure N(0, Σ0) on u. Then
πy(u) ∝exp
2γ2 |y −⟨g, u⟩|2 −1
As the exponential of a quadratic form, this is the density of a Gaussian
2 The notation for weighted norms and inner products is deﬁned at the end of Section 1.
Inverse problems
From Theorem 6.20 we ﬁnd that the posterior mean and covariance are
γ2 + ⟨g, Σ0g⟩,
Σ = Σ0 −(Σ0g)(Σ0g)∗
γ2 + ⟨g, Σ0g⟩.
If we consider the case where observational noise disappears from the system, then we ﬁnd that
γ→0 m = (Σ0g)y
γ→0 Σ = Σ0 −(Σ0g)(Σ0g)∗
Notice that Σ+g = 0 and ⟨m+, g⟩= y. This states the intuitively reasonable fact that, as the observational noise decreases, knowledge of u in the
direction of g becomes certain. In directions not aligned with g, uncertainty
remains, with magnitude determined by an interaction between properties
of the prior and of the observation operator. Thus the prior plays a central role, even as observational noise disappears, in this example where the
solution is underdetermined.
Example 2.2.
Assume that q ⩾2 and n = 1, and let G be nonlinear with
y = g(u + βu3) + η,
where g ∈Rq\{0}, β ∈R and η ∼N(0, γ2I). Assume further that we place
a Gaussian measure N(0, 1) as a prior on u. Then
πy(u) ∝exp
2γ2 |y −g(u + βu3)|2 −1
This measure is not Gaussian unless β = 0.
Consider the linear case where β = 0. The posterior measure is then
πy(u) ∝exp
2γ2 |y −gu|2 −1
By Theorem 6.20, using the identity
γ2I + gg∗−1g =
γ2 + |g|2−1g,
we deduce that the posterior mean and covariance are given by
γ2 + |g|2 ,
γ2 + |g|2 .
A. M. Stuart
In the limit where observational noise disappears, we ﬁnd that
γ→0 m = ⟨g, y⟩
(σ+)2 = lim
γ→0 σ2 = 0.
The point m+ is the least-squares solution of the overdetermined linear
equation y = gu found from the minimization problem
argminu∈R|y −gu|2.
This is a minimization problem of the form (2.2). In this case, where the
system is overdetermined, the prior plays no role in the limit of zero observational noise.
2.3. Small noise limits of the posterior measure
We have shown that the Bayesian and classical perspectives are linked
through the relationship between the posterior probability density given by
(2.10) and the MAP estimator (2.12). This directly connects minimization
of a regularized least-squares problem with the Bayesian perspective. Our
aim now is to further the link between the Bayesian and classical approaches
by considering the limit of small observational noise.
The small observational noise limit is illustrated in the two examples concluding the previous subsection. In the ﬁrst, where the underlying noise-free
problem is underdetermined, the prior provides information about the posterior mean, and uncertainty remains in the posterior, even as observational
noise disappears; furthermore, that uncertainty is related to the choice of
prior. In the second example, where the underlying noise-free problem is
overdetermined, uncertainty disappears and the posterior converges to a
Dirac measure centred on the least-squares solution of the limiting deterministic equation. The intuition obtained from these two examples, concerning the behaviour of the posterior measure in the small noise limit,
is important. The ﬁrst example suggests that in the underdetermined case
the prior measure plays a role in determining the posterior measure, even as
the observational noise disappears; in contrast, the second example suggests
that, in the overdetermined case, the prior plays no role in the small noise
limit. Many of the inverse problems for functions that we study later in this
paper are underdetermined. For these problems the prior measure plays an
important role in the solution, even when observational noise is small. A
signiﬁcant advantage of the Bayesian framework over classical approaches
is that it makes the modelling assumptions which underly the prior both
clear and explicit.
In the remainder of this subsection we demonstrate that the intuition
obtained from the two examples can be substantiated on a broad class of
ﬁnite-dimensional inverse problems.
We ﬁrst concentrate on the general
case which lies between these two examples, where q = n and, furthermore,
Inverse problems
equation (2.1) has a unique solution.
We then restrict our attention to
Gaussian problems, studying the over- and underdetermined cases in turn.
We state the results ﬁrst, and provide proofs at the end of the subsection.
The results are stated in terms of weak convergence of probability measures,
denoted by ⇒; see the end of Section 6.1 for background on this concept.
Throughout this subsection we consider the data y to be ﬁxed, and we study
the limiting behaviour of the posterior measure µy as the observational noise
tends to zero. Other limits, where y is a random variable, depending on the
observational noise, are also of interest, but we stick to the simpler setting
where y is ﬁxed, for expository purposes.
We start with the case q = n and assume that equation (2.1) has a unique
for every y ∈Rn.
Intuitively this unique solution should dominate the
Bayesian solution to the problem (which is a probability distribution on Rn,
not a single point). We show that this is indeed the case: the probability
distribution concentrates on the single point given by (2.14) as observational
noise disappears.
We assume that there is a positive constant C such that, for all y, δ ∈Rn,
|y −G(F(y) + δ)|2 ⩾C min{1, |δ|2}.
This condition implies that the derivative DG(u) is invertible at u = F(y),
so that the implicit function theorem holds; the condition also excludes the
possibility of attaining the minimum 0 of 1
2|y −G(u)|2 along a sequence
un →∞. We then have the following.
Theorem 2.3.
Assume that k = n, that G ∈C2(Rn, Rn) and that equation (2.1) has a unique solution given by (2.14), for every y ∈Rn. We place
a Gaussian prior µ0 = N(m0, Σ0) on u and assume that the observational
noise η in (2.5) is distributed as N(0, γ2I). Then the posterior measure µy,
with density given by (2.10) and B = γ2I, satisﬁes µy ⇒δF(y) as γ →0. ⋄
The preceding theorem concerns problems where the underlying equation (2.1) relating data to model is uniquely solvable. This situation rarely
arises in practice, but is of course important for building links between the
Bayesian and classical perspectives.
We now turn to problems which are either over- or underdetermined and,
for simplicity, conﬁne our attention to purely Gaussian problems. We again
work in arbitrary ﬁnite dimensions and study the small observational noise
limit and its relation to the the underlying noise-free problem (2.1). In Theorem 2.4 we show that the posterior measure converges to a Dirac measure
concentrated on minimizers of the least-squares problem (2.2). Of course,
when (2.1) is uniquely solvable this will lead to a Dirac measure as its solution, as in Theorem 2.3; but more generally there may be no solution to (2.1)
A. M. Stuart
and least-squares minimizers provide a natural generalized solution concept.
In Theorem 2.5 we study the Gaussian problem in the undetermined case,
showing that the posterior measure converges to a Gaussian measure whose
support lies on a hyperplane embedded in the space where the unknown u
lies. The structure of this Gaussian measure is determined by an interplay
between the prior, the forward model and the data. In particular, prior
information remains in the small noise limit. This illustrates the important
idea that for (frequently occurring) underdetermined problems the prior
plays a signiﬁcant role, even when noise is small, and should therefore be
treated very carefully from the perspective of mathematical modelling.
If the observational noise η is Gaussian, if the prior µ0 is Gaussian and
if G is a linear map, then the posterior measure µy is also Gaussian. This
follows immediately from the fact that the logarithm of πy given by (2.6)
is quadratic in u under these assumptions. We now study the properties of
this Gaussian posterior.
We assume that
η ∼N(0, B),
µ0 = N(m0, Σ0),
and that B and Σ0 are both invertible.
Then, since y|u ∼N(Au, B), Theorem 6.20 shows that the posterior
measure µy is Gaussian N(m, Σ) with
m = m0 + Σ0A∗(B + AΣ0A∗)−1(y −Am0),
Σ = Σ0 −Σ0A∗(B + AΣ0A∗)−1AΣ0.
In the case where k = n and A, Σ0 are invertible, we see that, as B →0,
From Lemma 6.5 we know that convergence of all characteristic functions
implies weak convergence.
Furthermore, the characteristic function of a
Gaussian is determined by the mean and covariance: see Theorem 6.4.
Hence, for a ﬁnite-dimensional family of Gaussians, convergence of the mean
and covariance to a limit implies weak convergence to the Gaussian with
that limiting mean and covariance. For this family of measures the limiting
covariance is zero and thus the B →0 limit recovers a Dirac measure on
the solution of the equation Au = y, in accordance with Theorem 2.3. It is
natural to ask what happens in the limit of vanishing noise, more generally.
The following two theorems provide an answer to this question.
Theorem 2.4.
Assume that B and Σ0 are both invertible. The posterior
mean and covariance can be rewritten as
m = (A∗B−1A + Σ−1
0 )−1(A∗B−1y + Σ−1
Σ = (A∗B−1A + Σ−1
Inverse problems
If Null(A) = {0} and B = γ2B0 then, in the limit γ2 →0, µy ⇒δm+, where
m+ is the solution of the least-squares problem
m+ = argminu∈Rn|B−1/2
(y −Au)|2.
The preceding theorem shows that, in the overdetermined case where
A∗BA is invertible, the small observational noise limit leads to a posterior which is a Dirac, centred on the solution of a least-squares problem
determined by the observation operator and the relative weights on the observational noise. Uncertainty disappears, and the prior plays no role in
this limit. Example 2.2 illustrates this situation.
We now assume that y ∈Rq and u ∈Rn with q < n, so that the problem
is underdetermined. We assume that rank(A) = q, so that we may write
A = (A0 0)Q∗
with Q ∈Rn×n an orthogonal matrix so that Q∗Q = I, A0 ∈Rq×q an
invertible matrix and 0 ∈Rq×(n−q) a zero matrix. We also let L0 = Σ−1
the precision matrix for the prior, and write
Here L11 ∈Rq×q, L12 ∈Rq×(n−q) and L22 ∈R(n−q)×(n−q); both L11 and L22
are positive deﬁnite symmetric, because Σ0 is.
If we write
Q = (Q1 Q2)
with Q1 ∈Rn×q and Q2 ∈Rn×(n−q), then Q∗
1 projects onto a q-dimensional
subspace O and Q∗
2 projects onto an (n−q)-dimensional subspace O⊥; here
O and O⊥are orthogonal.
Assume that y = Au for some u ∈Rn. This identity is at the heart of the
inverse problem in the small γ limit. If we deﬁne z ∈Rq to be the unique
solution of the system of equations A0z = y, then z = Q∗
1u. On the other
2u is not determined by the identity y = Au. Thus, intuitively we
expect to determine z without uncertainty, in the limit of small noise, but
for uncertainty to remain in other directions. With this in mind we deﬁne
w ∈Rq and w′ ∈Rn−q via the equation
and then set
22 w′ ∈Rn−q.
A. M. Stuart
Theorem 2.5.
Assume that B and Σ0 are both invertible and let B =
γ2B0. Then, in the limit γ2 →0, µy ⇒N(m+, Σ+), where
Σ+ = Q2L−1
We now interpret this theorem. Since Q∗
2Q1 = 0, the limiting measure
may be viewed as a Dirac measure, centred at z in O, and a Gaussian
measure N(z′, L−1
22 ) in O⊥. These measures are independent, so that the
theorem states that
µy ⇒δz ⊗N(z′, L−1
viewed as a measure on O ⊕O⊥. Thus, in the small observational noise
limit, we determine the solution without uncertainty in O, whilst in O⊥
uncertainty remains. Furthermore, the prior plays a role in the posterior
measure in the limit of zero observational noise; speciﬁcally it enters the
formulae for z′ and L22.
We ﬁnish this subsection by providing proofs of the preceding three results.
Proof of Theorem 2.3. Deﬁne δ := u −F(y) and let
2γ2 |y −G(F(y) + δ)|2 −1
(F(y) + δ −m0)|2.
Fix ℓ∈Rn. Then, with E denoting expectation under µy,
i⟨ℓ, F(y)⟩
i⟨ℓ, δ⟩+ f(δ)
Rn exp(f(δ)) dδ.
Thus, by Lemma 6.5, it suﬃces to prove that, as γ →0,
i⟨ℓ, δ⟩+ f(δ)
i⟨ℓ, δ⟩+ f(δ)
noting that Z = I(0). For a ∈(2/3, 1), we split I(ℓ) into I(ℓ) = I1(ℓ)+I2(ℓ)
|δ|⩽γa exp
i⟨ℓ, δ⟩+ f(δ)
|δ|>γa exp
i⟨ℓ, δ⟩+ f(δ)
Inverse problems
We consider I1(ℓ) ﬁrst so that |δ| ⩽γa. By Taylor-expanding f(δ) around
δ = 0, we obtain
2γ2 |Bδ|2 −1
F(y) + δ −m0
where B = DG(F(y)). Thus, for b = a ∧(3a −2) = 3a −2,
i⟨ℓ, δ⟩+ f(δ) = −1
2γ2 |Bδ|2 + O(γb).
I1(ℓ) = exp
|δ|⩽γa exp
2γ2 |Bδ|2 +O(γb)
It follows that
I1(ℓ) = exp
|δ|⩽γa exp
|z|⩽γa−1 exp
We now estimate I2(ℓ) and show that it is asymptotically negligible compared with I1(ℓ). Note that, by (2.15),
f(δ) ⩽−C min{1, |δ|2}
F(y) + δ −m0
⩽−C min{1, |δ|2}
1⩾|δ|>γa exp
F(y) + δ −m0
Since a < 1, it follows that I2(ℓ) is exponentially small in γ →0. As
I1(ℓ) is, to leading order, O(γn) and independent of ℓ, we deduce that
i⟨ℓ, δ⟩+ f(δ)
as γ →0, and the result follows.
A. M. Stuart
Proof of Theorem 2.4. We ﬁrst note the identity
A∗B−1(B + AΣ0A∗) = (A∗B−1A + Σ−1
which follows since Σ0 and B are both positive deﬁnite. Since A∗B−1A+Σ−1
and B + AΣ0A∗are also positive deﬁnite, we deduce that
(A∗B−1A + Σ−1
0 )−1A∗B−1 = Σ0A∗(B + AΣ0A∗)−1.
Thus the posterior mean may be written as
m = m0 + (A∗B−1A + Σ−1
0 )−1A∗B−1(y −Am0)
= (A∗B−1A + Σ−1
0 )−1(A∗B−1y + A∗B−1Am0 + Σ−1
0 m0 −A∗B−1Am0)
= (A∗B−1A + Σ−1
0 )−1(A∗B−1y + Σ−1
as required. A similar calculation establishes the desired property of the
posterior covariance.
If B = γ2B0 then we deduce that
m = (A∗B−1
0 A + γ2Σ−1
0 )−1(A∗B−1
0 y + γ2Σ−1
Σ = γ2(A∗B−1
0 A + γ2Σ−1
Since Null(A) = {0}, we deduce that there is α > 0 such that
0 Aξ⟩= |B−1/2
Aξ|2 ⩾α|ξ|2,
Thus A∗B−1
0 A is invertible and it follows that, as γ →0, the posterior mean
converges to
m+ = (A∗B−1
0 A)−1A∗B−1
and the posterior covariance converges to zero. By Lemma 6.5 we deduce
the desired weak convergence of µy to δm+. It remains to characterize m+.
Since the null space of A is empty, minimizers of
are unique and satisfy the normal equations
0 Au = A∗B−1
Hence m+ solves the desired least-squares problem and the proof is complete.
Proof of Theorem 2.5. By Lemma 6.5 we see that it suﬃces to prove that the
mean m and covariance Σ given by the formulae in Theorem 2.4 converge
to m+ and Σ+ given by (2.22). We start by studying the covariance matrix
which, by Theorem 2.4, is given by
Inverse problems
Using the deﬁnition (2.18) of A, we see that
Then, by (2.19) we have
0 A0 + L11
Applying the Schur complement formula for the inverse of a matrix as in
Lemma 6.21, we deduce that
|∆11| + |∆21|
as γ →0, and there is a constant C > 0 such that
|∆12| + |∆22| ⩽Cγ2
for all γ suﬃciently small. From this it follows that, as γ →0,
writing Q as in (2.20). We see that Σ+ = Q2L−1
2, as required.
We now return to the mean. By Theorem 2.4 this is given by the formula
A∗B−1y + Σ−1
Using the expression A = (A0 0)Q∗, we deduce that
By deﬁnition of w, w′, we deduce that
Using equation (2.23), we ﬁnd that
This completes the proof.
A. M. Stuart
2.4. Common structure
In the previous subsection we showed that, for ﬁnite-dimensional problems,
Bayes’ rule gives the relationship (2.6) between the prior and posterior
p.d.f.s π0 and πy respectively. Expressed in terms of the measures µy and
µ0 corresponding to these densities, the formula may be written as in (2.9):
Z(y) exp(−Φ(u; y)).
The normalization constant Z(y) is chosen so that µy is a probability measure:
exp(−Φ(u; y)) dµ0(u).
It is this form which generalizes readily to the setting on function space
where there are no densities πy and π0 with respect to Lebesgue measure,
but where µy has a Radon–Nikodym derivative (see Theorem 6.2) with
respect to µ0.
In Section 3 we will describe a range of inverse problems which can be
formulated in terms of ﬁnding, and characterizing the properties of, a probability measure µy on a separable Banach space (X, ∥· ∥X), speciﬁed via
its Radon–Nikodym derivative with respect to a reference measure µ0 as in
(2.24) and (2.25). In this subsection we highlight the common framework
into which many of these problems can be placed, by studying conditions
on Φ which arise naturally in a wide range of applications. This framework
will then be used to develop a general theory for inverse problems in Section 4. It is important to note that, when studying inverse problems, the
properties of Φ that we highlight in this section are typically determined by
the forward PDE problem, which maps the unknown function u to the data
y. In particular, probability theory does not play a direct role in verifying
these properties of Φ. Probability becomes relevant when choosing the prior
measure so that it charges the Banach space X, on which the desired properties of Φ hold, with full measure. We illustrate how to make such choices
of prior in Section 3.
We assume that the data y is in a separable Banach space (Y, ∥· ∥Y ).
When applying the framework outlined in this article we will always assume
that the prior measure is Gaussian: µ0 ∼N(m0, C0). The properties of
Gaussian random measures on Banach space, and Gaussian random ﬁelds
in particular, may be found in Sections 6.3, 6.4 and 6.5.
The two key
properties of the prior that we will use repeatedly are the tail properties of
the measure as encapsulated in the Fernique Theorem (Theorem 6.9), and
the ability to establish regularity properties from the covariance operator:
see Theorem 6.24 and Lemmas 6.25 and 6.27. It is therefore possible to
broaden the scope of this material to non-Gaussian priors, for any measures
Inverse problems
for which analogues of these two key properties hold. However, Gaussian
priors do form an important class of priors for a number of reasons: they are
relatively simple to deﬁne through covariance operators deﬁned as fractional
inverse powers of diﬀerential operators; they are relatively straightforward to
sample from; and the H¨older and Sobolev regularity properties of functions
drawn from the prior are easily understood.
The properties of Φ may be formalized through the following assumptions, which we verify on a case-by-case basis for many of the PDE inverse
problems encountered in Section 3.
Assumption 2.6. The function Φ: X×Y →R has the following properties.
(i) For every ε > 0 and r > 0 there is an M = M(ε, r) ∈R such that, for
all u ∈X and all y ∈Y with ∥y∥Y < r,
Φ(u; y) ⩾M −ε∥u∥2
(ii) For every r > 0 there is a K = K(r) > 0 such that, for all u ∈X and
y ∈Y with max{∥u∥X, ∥y∥Y } < r,
Φ(u; y) ⩽K.
(iii) For every r > 0 there is an L(r) > 0 such that, for all u1, u2 ∈X and
y ∈Y with max{∥u1∥X, ∥u2∥X, ∥y∥Y } < r,
|Φ(u1; y) −Φ(u2; y)| ⩽L∥u1 −u2∥X.
(iv) For every ε > 0 and r > 0 there is a C = C(ε, r) ∈R such that, for all
y1, y2 ∈Y with max{∥y1∥Y , ∥y2∥Y } < r, and for all u ∈X,
|Φ(u; y1) −Φ(u; y2)| ⩽exp
∥y1 −y2∥Y .
These assumptions are, in turn, a lower bound, an upper bound and
Lipschitz properties in u and in y. When Y is ﬁnite-dimensional and the
observational noise is N(0, Γ), then Φ has the form
Φ(u; y) = 1
It is then natural to derive the bounds and Lipschitz properties of Φ from
properties of G.
Assumption 2.7.
The function G : X →Rq satisﬁes the following.
(i) For every ε > 0 there is an M = M(ε) ∈R such that, for all u ∈X,
|G(u)|Γ ⩽exp
(ii) For every r > 0 there is a K = K(r) > 0 such that, for all u1, u2 ∈X
with max{∥u1∥X, ∥u2∥X} < r,
|G(u1) −G(u2)|Γ ⩽K∥u1 −u2∥X.
A. M. Stuart
It is straightforward to see the following.
Lemma 2.8.
Assume that G : X →Rq satisﬁes Assumption 2.7. Then
Φ : X × Rq →R given by (2.26) satisﬁes Assumption 2.6 with (Y, ∥· ∥Y ) =
(Rq, | · |Γ).
Many properties follow from these assumptions concerning the density
between the posterior and the prior. Indeed, the fact that µy is well-deﬁned
is typically established by using the continuity properties of Φ(·; y). Further
properties following from these assumptions include continuity of µy with
respect to the data y, and desirable perturbation properties of µy based
on ﬁnite-dimensional approximation of Φ or G. All these properties will be
studied in detail in Section 4. We emphasize that many variants on the
assumptions above could be used to obtain similar, but sometimes weaker,
results than those appearing in this article. For example, we work with
Lipschitz continuity of Φ in both arguments; similar results can be proved
under the weaker assumptions of continuity in both arguments. However,
since Lipschitz continuity holds for most of the applications of interest to
us, we work under these assumptions.
We re-emphasize that the properties of Φ encapsulated in Assumption 2.6
are properties of the forward PDE problem, and they do not involve inverse
problems and probability at all.
The link to Bayesian inverse problems
comes through the choice of prior measure µ0 which, as we will see in Sections 3 and 4, should be chosen so that µ0(X) = 1; this means that functions
drawn at random from the prior measure should be suﬃciently regular that
they lie in X with probability one, so that the properties of Φ from Assumptions 2.6 apply to it. In the function space setting, regularity of the
mean function, together with the spectral properties of the covariance operator, determines the regularity of random draws. In particular, the rate
of decay of the eigenvalues of the covariance operator plays a central role in
determining the regularity properties. These issues are discussed in detail
in Section 6.5. For simplicity we will work throughout with covariance operators which are deﬁned through (possibly fractional) negative powers of
the Laplacian, or operators that behave like the Laplacian in a sense made
precise below.
To make these ideas precise, consider a second-order diﬀerential operator
A on a bounded open set D ⊂Rd, with domain chosen so that A is positive
deﬁnite and invertible. Let H ⊂L2(D). For example, H may be restricted
to the subspace where
u(x) dx = 0
holds, in order to enforce positivity for an operator with Neumann or periodic boundary conditions, which would otherwise have constants in its
Inverse problems
kernel; or it may be restricted to divergence-free ﬁelds when incompressible
ﬂuid ﬂow is being modelled.
We let {(φk, λk)}k∈K denote a complete orthonormal basis for H, comprising eigenfunctions/eigenvalues of A. Then K ⊆Zd\{0}. For Laplacian-like
operators we expect that the eigenvalues will grow like |k|2 and that, in
simple geometries, the φk will be bounded in L∞and the gradient of the φk
will grow like |k| in L∞. We make these ideas precise below. For all inﬁnite
sums over K in the following we employ standard orderings.
For any u ∈H we may write
⟨u, φk⟩φk.
We may then deﬁne fractional powers of A as follows, for any α ∈R:
k⟨u, φk⟩φk.
For any s ∈R we deﬁne the separable Hilbert spaces Hs by
k|⟨u, φk⟩|2 < ∞
These spaces have norm ∥· ∥s deﬁned by
k|⟨u, φk⟩|2.
If s ⩾0 then these spaces are contained in H, but for s < 0 they are larger
than H. The following assumptions characterize a ‘Laplacian-like’ operator.
These operators will be useful to us when constructing Gaussian priors, as
they will enable us to specify regularity properties of function drawn from
the prior in a transparent fashion.
Assumption 2.9.
The operator A, densely deﬁned on a Hilbert space
H ⊂L2(D; Rn), satisﬁes the following properties.
(i) A is positive deﬁnite, self-adjoint and invertible.
(ii) The eigenfunctions/eigenvalues {φk, λk}k∈K of A, indexed by k ∈K ⊂
Zd\{0}, form an orthonormal basis for H.
(iii) There exist C± > 0 such that the eigenvalues satisfy, for all k ∈K,
(iv) There exists C > 0 such that
|k|∥Dφk∥L∞
A. M. Stuart
Note that if A is the Laplacian with Dirichlet or Neumann boundary
conditions, then the spaces Hs are contained in the usual Sobolev spaces
Hs. In the case of periodic boundary conditions they are identical to the
Sobolev spaces Hs
per. Thus the ﬁnal assumption (v) above is a generalization
of the following Sobolev Embedding Theorem for the Laplacian.
Theorem 2.10. (Sobolev Embedding Theorem)
Assume that A :=
−△is equipped with periodic, Neumann or Dirichlet boundary conditions
on the unit cube. If u ∈Hs and s > d/2, then u ∈C(D), and there is a
constant C > 0 such that ∥u∥L∞⩽C∥u∥s.
2.5. Discussion and bibliography
An introduction to the Bayesian approach to statistical problems in general is Bernardo and Smith . The approach taken to Bayesian inverse problems as outlined in Kaipio and Somersalo is to ﬁrst discretize the problem and then secondly apply the Bayesian methodology
to a ﬁnite-dimensional problem. This is a commonly adopted methodology. In that approach, the idea of trying to capture the limit of inﬁnite
resolution is addressed by use of statistical extrapolation techniques based
on modelling the error from ﬁnite-dimensional approximation . The approach that is developed in this article reverses
the order of these two steps: we ﬁrst apply the Bayesian methodology to an
inﬁnite-dimensional problem, and then discretize. There is some literature
concerning the Bayesian viewpoint for linear inverse problems on function
space, including the early study by Franklin , and the subsequent
papers by Mandelbaum , Lehtinen, Paivarinta and Somersalo 
and Fitzpatrick ; the paper by Lassas et al. contains a good literature review of this material, and further references. The papers of Lassas
et al. and Lassas and Siltanen also study Bayesian inversion
for linear inverse problems on function space; they introduce the notion of
discretization invariance and investigate the question of whether it is possible to derive regularizations of families of ﬁnite-dimensional problems, in
a fashion which ensures that meaningful limits are obtained; this idea also
appears somewhat earlier in the data assimilation literature, for a particular PDE inverse problem, in the paper of Bennett and Budgell .
In the approach taken in this article, discretization invariance is guaranteed for ﬁnite-dimensional approximations of the function space Bayesian
inverse problem. Furthermore, our approach is not limited to problems in
which a Gaussian posterior measure appears; in contrast, existing work on
discretization invariance is conﬁned to the linear, Gaussian observational
noise setting in which the posterior is Gaussian if the prior is Gaussian.
The least-squares approach to inverse problems encapsulated in (2.3) is often termed Tikhonov regularization and,
Inverse problems
more generally, the variational method in the applied literature . The book by Engl et al. discusses regularization techniques in the Hilbert space setting and the Banach space setting is
discussed in, for example, the recent papers of Kaltenbacher, Sch¨opfer and
Schuster , Neubauer and Hein . As we demonstrated,
regularization is closely related to ﬁnding the MAP estimator as deﬁned in
Kaipio and Somersalo . As such it is clear that, from the Bayesian
standpoint, regularization is intimately related to the choice of prior. Another classical regularization method for linear inverse problems is through
iterative solution ; this topic is related to the Bayesian approach to inverse problems in Calvetti and Calvetti and Somersalo
Although we concentrate in this paper on Gaussian priors, and hence
on regularization via addition of a quadratic penalization term, there is
active research in the use of diﬀerent regularizations . In particular,
the use of total variation-based regularization, and related wavelet-based
regularizations, is central in image processing . We will not address such regularizations in this article, but note
that the development of a function space Bayesian viewpoint on such problems, along the lines developed here for Gaussian priors, is an interesting
research direction .
Theorem 2.4 concerns the small noise limit for Gaussian noise. This topic
has been studied in greater detail in the papers by Engl, Hoﬁnger and Kindermann , Hoﬁnger and Pikkarainen and Neubauer and
Pikkarainen , where the convergence of the posterior distribution is
quantiﬁed by use of the Prokohorov and Ky Fan metrics. Gaussian problems
are often amenable to closed-form analysis, as illustrated in this section, and
are hence useful for illustrative purposes. Furthermore, there are many interesting applications where Gaussian structure prevails. Thus we will, on
occasion, exploit Gaussianity throughout the article, for both these reasons.
The common structure underlying a wide range of Bayesian inverse problems for functions, and which we highlight in Section 2.4, is developed in
Cotter, Dashti, Robinson and Stuart and Cotter, Dashti and
Stuart .
In the general framework established at the start of this section we have
implicitly assumed that the observation operator G(·) is known to us. In
practice it is often approximated by some computer code G(·; h) in which
h denotes a mesh parameter, or parameter controlling missing physics. In
this case (2.5) can be replaced by the equation
y = G(u; h) + ε + η,
where ε := G(u) −G(u; h). Whilst it is possible to lump ε and η together
A. M. Stuart
into one single error term, and work again with equation (2.1), this can be
misleading because the observation error η and the computational model
error ε are very diﬀerent in character. The latter is typically not mean zero,
and depends upon u; in contrast it is frequently realistic to model η as a
mean zero random variable, independent of u. Attempts to model the eﬀects
of ε and η separately may be found in a number of publications, including
Kaipio and Somersalo , Kaipio and Somersalo ,
Kaipio and Somersalo , Glimm, Hou, Lee, Sharp and Ye , Orrell, Smith, Barkmeijer and Palmer , Kennedy and O’Hagan ,
O’Sullivan and Christie, , Christie, Pickup, O’Sullivan and
Demyanov and Christie . A diﬀerent approach to dealing with
model error is to extend the variable u to include model terms which represent missing physics or lack of resolution in the model and to try to learn
about such systematic error from the data; this approach is undertaken in
Cotter, Dashti, Robinson and Stuart .
3. Examples
3.1. Overview
In this section we study a variety of inverse problems arising from boundary
value problems and initial-boundary value problems. Our goal is to enable
application of the framework for Bayesian inverse problems on function
space that is developed in Section 4, in order to justify a formula of the
form (2.24) for a posterior measure µy on a function space, and to establish
properties of the measure µy.
In order to carry this out it is desirable to establish that, for a wide range
of problems, the common structure encapsulated in Assumptions 2.6 or 2.7
may be shown to hold. These assumptions concern properties of the forward
problem underlying the inverse problem, and have no reference to the inverse problem, its Bayesian formulation or to probability. The link between
the forward problem and the Bayesian inverse problem is provided in this
section, and in the next section. In this section we show that choosing the
prior measure so that µ0(X) = 1, where X is the space in which Assumptions 2.6 or 2.7 may be shown to hold, ensures that the posterior measure
is well-deﬁned; this may often be done by use of Theorem 6.31. The larger
the space X, the fewer restrictions the condition µ0(X) = 1 places on the
choice of prior, since it is equivalent to asking that draws from µ0 are almost surely in the space X; the larger X is, the easier this is to satisfy.
The next section is concerned with ramiﬁcations of Assumptions 2.6 or 2.7
for various stability properties of the posterior measure µy with respect to
perturbations.
We will work in a Banach space setting and will always specify the prior
measure as a Gaussian.
The required background material on Gaussian
Inverse problems
measures in Banach space, and Gaussian random ﬁelds, may be found in
Section 6. We also make regular use of the key Theorem 6.31, from Section 6.6, to show that the posterior is well-deﬁned and absolutely continuous
with respect to the prior. For simplicity we work with priors whose covariance operator is a fractional negative power of an operator such as the
Laplacian. The reader should be aware that much greater generality than
this is possible and that the simple setting for choice of priors is chosen for
expository purposes. Other Gaussian priors may be chosen so long as the
constraint µ0(X) = 1 is satisﬁed.
We start in Section 3.2 by studying the inverse problems of determining
a ﬁeld from direct pointwise observations. We use this example to illustrate
our approach to identifying the Radon–Nikodym derivative between posterior and prior measures. All of the subsequent subsections in this chapter
involve Bayesian inference for random ﬁelds, but in contrast to the ﬁrst subsection they are based on indirect measurements deﬁned through solution
of a diﬀerential equation. In Section 3.3 we study the problem of ﬁnding the
diﬀusion coeﬃcient in a two-point boundary value problem, from observations of the solution. In Section 3.4 we consider the problem of determining
the wave speed for the scalar wave equation from observations of the solution. Section 3.5 concerns the problem of recovering the initial condition
for the heat equation, from observation of the entire solution at a positive
time, when polluted by an additive Gaussian random ﬁeld. We then describe several more involved examples arising in applications such as ﬂuid
mechanics, geophysics and molecular dynamics, all of which can be placed in
the common framework developed here, but for which space precludes a full
development of the details; see Sections 3.6, 3.7 and 3.8. The problems in
ﬂuid mechanics are natural extensions of the inverse problem for the initial
condition of the heat equation, and those arising in subsurface geophysics
generalize the inverse problem for the diﬀusion coeﬃcient in a two-point
boundary value problem. The problem in molecular dynamics is somewhat
diﬀerent, as it does not arise from a Bayesian inverse problem but rather
from a conditioned diﬀusion process. However, the resulting mathematical
structure shares much with the inverse problems and we include it for this
reason. References to some of the relevant literature on these applications
are given in Section 3.9.
3.2. Pointwise data for a random ﬁeld
Let D ⊂Rd be a bounded open set. Consider a ﬁeld u : D →Rn. We view
u as an element of the Hilbert space H = L2(D). Assume that we are given
noisy observations {yk}q
k=1 of a function g : Rn →Rℓof the ﬁeld at a set of
points {xk}q
yk = g(u(xk)) + ηk,
A. M. Stuart
where the {ηk}q
k=1 describe the observational noise. Concatenating data,
y = G(u) + η,
where y = (y∗
1, . . . , y∗
q)∗∈Rℓq and η = (η∗
1, . . . , η∗
q)∗∈Rℓq. The observation
operator G maps X := C(D) ⊂H into Y := Rℓq. The inverse problem is to
reconstruct the ﬁeld u from the data y.
We assume that the observational noise η is Gaussian N(0, Γ). We specify a prior measure µ0 on u which is Gaussian N(m0, C0) and determine
the posterior measure µy for u given y. Since P(dy|u) = N(G(u), Γ), informal application of Bayes’ rule leads us to expect that the Radon–Nikodym
derivative of µy with respect to µ0 is
2|y −G(u)|2
Below we deduce appropriate choices of prior measure which ensure that
this measure is well-deﬁned and does indeed determine the desired posterior
distribution for u given y.
If g : Rn →Rℓis linear, so that G(u) = Au for some linear operator
A : X →Rℓq, then the calculations in Example 6.23 show that the posterior
measure µy is also Gaussian with µy = N(m, C) where
m = m0 + C0A∗(Γ + AC0A∗)−1(y −Am0),
C = C0 −C0A∗(Γ + AC0A∗)−1AC0.
Let △denote the Laplacian on D, with domain chosen so that Assumptions 2.9(i)–(iv) hold.
Recall the (Sobolev-like) spaces Hs from (2.29).
The following theorem is proved by application of Theorem 6.31, which
the reader is encouraged to study before continuing in this section.
Theorem 3.1.
Assume that the domain of −△is chosen so that Assumptions 2.9(i)–(v) hold. Let g : Rn →Rℓbe continuous. Assume that C0 ∝
(−△)−α with α > d/2 and assume that m0 ∈Hα. Then µy(du) = P(du|y)
is absolutely continuous with respect to µ0(du) = N(m0, C0) with Radon–
Nikodym derivative given by (3.3). Furthermore, when g is linear, so that
G(u) = Au for some linear A : X →Rℓq, then the posterior is Gaussian
with mean and covariance given by (3.4).
The formulae for the mean and covariance of the Gaussian posterior measure µy = N(m, C), which arises when g is linear, follow from
Example 6.23. We now proceed to determine the posterior measure in the
non-Gaussian case. Deﬁne Lz : X →Rn to be the pointwise evaluation
operator at z ∈D. Notice that
|Lzu −Lzv| = |u(z) −v(z)| ⩽∥u −v∥L∞
Inverse problems
so that Lz : X →Rn is continuous. The function G is found by composing
the continuous function g with the operator L· at a ﬁnite set of points and
is thus itself continuous from X into Rℓq. To apply Theorem 6.31 it suﬃces
to show that µ0(X) = 1. Since Hα is the Cameron–Martin space for C0 and
since m0 ∈Hα, we deduce that µ0 = N(m0, C0) and N(0, C0) are equivalent
as measures, by Theorem 6.13. Thus µ0(X) = 1 since, by Lemma 6.25,
draws from N(0, C0) are a.s. s-H¨older for all s ∈(0, min{1, α −d/2}).
In Section 2.4 we indicated that obtaining bounds and Lipschitz properties of G or Φ, the mappings appearing in the Radon–Nikodym derivative
between µy and µ0, will be important to us below. The following lemma
studies this issue.
Lemma 3.2.
In the setting of Theorem 3.1 assume, in addition, that
g ∈C1(Rn, Rℓ) and that g is polynomially bounded. Then G satisﬁes Assumption 2.7 with X = C(D) and Y = Rℓq. Furthermore, if Dg is polynomially bounded then K(r) is polynomially bounded.
Since g is polynomially bounded and G is found by pointwise evaluation at a ﬁnite number of points, it follows that
|G(u)| ⩽p(∥u∥X)
for some polynomial p : R →R. The bound (i) of Assumption 2.7 follows.
By the mean-value theorem (Taylor theorem with remainder) we have that
|G(u) −G(v)|Γ ⩽max
su(xk) + (1 −s)v(xk)
u(xk)) −v(xk)
Thus, for all u, v satisfying max{∥u∥X, ∥v∥X} < r,
|G(u) −G(v)|Γ ⩽K(r)∥u −v∥X.
Furthermore, K may be bounded polynomially if Dg is bounded polynomially. The result follows.
3.3. Inverse problem for a diﬀusion coeﬃcient
The previous example illustrated the formulation of an inverse problem for
a function, using the Bayesian framework. However, the observations of
the function comprised direct measurements of the function at points in its
domain D. We now consider a problem where the measurements are more
indirect, and are deﬁned through the solution of a diﬀerential equation.
We consider the inverse problem of determining the diﬀusion coeﬃcient
from observations of the solution of the two-point boundary value problem
p(0) = p−,
p(1) = p+.
A. M. Stuart
We assume that p+ > p−> 0 and we make observations of {p(xk)}q
at a set of points 0 < x1 < · · · < xq < 1 subject to Gaussian measurement
error. We write the observations as
yj = p(xj) + ηj,
j = 1, . . . , q
and, for simplicity, assume that the ηk form an i.i.d. sequence with η1 ∼
N(0, γ2). Our interest is in determining the diﬀusion coeﬃcient k from y.
To ensure that k is strictly positive on , we introduce u(x) = ln(k(x))
and view u ∈L2((0, 1)) as the basic unknown function.
The forward problem (3.5) for p given u is amenable to considerable
explicit analysis, and we now use this to write down a formula for the
observation operator G and to study its properties. We ﬁrst deﬁne Jx :
L∞((0, 1)) →R by
exp(−w(z)) dz.
The solution of (3.5) may be written as
p(x) = (p+ −p−)Jx(u)
J1(u) + p−
and is monotonic increasing; furthermore, p(x) is unchanged under u(x) →
u(x) + λ for any λ ∈R. The observation operator is then given by the
p(x1), . . . , p(xq)
Lemma 3.3.
The observation operator G : C( ) →Rq is Lipschitz and
satisﬁes the bound
|G(u)| ⩽√qp+.
Indeed, G satisﬁes Assumption 2.7 with X = C( ) and K(·) exponentially bounded: there are a, b > 0 such that K(r) ⩽a exp(br).
The fact that G is deﬁned on C( ) follows from the explicit solution given in equation (3.8). The bound on G follows from the monotonicity
of the solution. For the Lipschitz property it suﬃces to consider the case
q = 1 and, without loss of generality, take x1 = 1/2. Note that then
|G(u) −G(v)|
J1(u)J1(v)
2 (u)J1(v) −J 1
2 (v)J1(u)
J1(u)J1(v)
J1(v) −J1(u)
2 (u) −J 1
⩽J1(v)−1|J1(v) −J1(u)| + J1(v)−1J 1
2 (u) −J 1
J1(v)−1 ⩽exp
Inverse problems
|Jx(u) −Jx(v)| ⩽x exp
max{∥u∥∞, ∥v∥∞}
Thus we deduce that
|G(u) −G(v)| ⩽3
2(p+ −p−) exp
∥v∥∞+ max{∥u∥∞, ∥v∥∞}
We place a Gaussian prior measure µ0 ∼N(u0, C0) on u. We say that k
is log-normal. Since changing u by an arbitrary additive constant does not
change the solution of (3.5), we cannot expect to determine any information
about the value of this constant from the data. Thus we must build our
assumptions about this constant into the prior. To do this we assume that
u integrates to zero on (0, 1) and deﬁne the prior measure µ0 on the space
u ∈L2((0, 1))
u(x) dx = 0
We deﬁne A = −d2/dx2 to be a densely deﬁned operator on H with
per((0, 1))
u(x) dx = 0
Then A is positive deﬁnite self-adjoint and, for any β > 0 and α > 1/2
(which ensures that the covariance operator is trace-class), we may deﬁne
the Gaussian measure N(m0, βA−α) on H.
y = G(u) + η,
where y = (y1, . . . , yq)∗∈Rq and η ∈Rq is distributed as N(0, γ2I). The
probability of y given u (the data likelihood) is
P (y|u) ∝exp
2γ2 |y −G(u)|2
We wish to ﬁnd µy(du) = P(du|y). Informal use of Bayes’ rule suggests that
2γ2 |y −G(u)|2
We now justify this formula.
Since G(·) is Lipschitz on X := C( ),
by Lemma 3.3, the basic idea underlying the justiﬁcation of (3.12) in the
next theorem is to choose α so that µ0(X) = 1, so that we may apply
Theorem 6.31.
Theorem 3.4.
Consider the Bayesian inverse problem for u(x) = ln(k(x))
subject to observation in the form (3.6), with p solving (3.5), and prior
measure µ0 = N(m0, C0) with m0 ∈Hα and C0 = βA−α. If β > 0 and α >
1/2 then µy(du) = P(du|y) is absolutely continuous with respect to µ0(du)
with Radon–Nikodym derivative given by (3.12), with G deﬁned in (3.9).
A. M. Stuart
We apply Theorem 6.31. The function G is continuous from X into
Rq. Hence it suﬃces to show that µ0(X) = 1. Since Hα is the Cameron–
Martin space for C0 and since m0 ∈Hα, we deduce that µ0 = N(m0, C0)
and N(0, C0) are equivalent as measures, by Theorem 6.13. Thus µ0(X) = 1
since, by Lemma 6.25, draws from N(0, C0) are a.s. s-H¨older for all s ∈
(0, min{1, α −1/2}).
3.4. Wave speed for the wave equation
Consider the equation
∂t + c(x)∂v
(x, t) ∈R × (0, ∞)
(x, t) ∈R × {0}
We assume that the wave speed c(x) is known to be a positive, one-periodic
function, and that we are interested in the inverse problem of determining
c given the observations
yj = v(1, tj) + ηj,
j = 1, . . . , q.
We assume that the observational noise {ηj}q
j=1 is mean zero Gaussian.
Since c is positive, we write c = exp(u) and view the inverse problem as
being the determination of u. We thus concatenate the data and write
y = G(u) + η,
where η ∼N(0, Γ) and G : X →Rq where X = C1(S); here S denotes the
unit circle [0, 1) with end points identiﬁed to enforce periodicity. We equip
X with the norm
∥u∥X = sup
|u(x)| + sup
Note that we may also view u as a function in Xper := C1
per(R), the space of
1-periodic C1 functions on R. Before deﬁning the inverse problem precisely,
we study the properties of the forward operator G.
Lemma 3.5.
Assume that f ∈C1(R; R) and f is polynomially bounded:
there are constants K > 0 and p ∈Z+ such that
Then G : X →Rq satisﬁes the following conditions.
• There is a constant C > 0:
1 + exp(p∥u∥X)
• For all u, w ∈X : ∥u∥X, ∥w∥X < r there exists L = L(r):
|G(u) −G(w)| ⩽L∥u −w∥∞.
Inverse problems
It suﬃces to consider the case q = 1 and take t1 = 1 for simplicity.
Let Ψ(·; t, u) : R →R denote the one-parameter group given by the solution
operator for the equation
dt = −exp(u(x)),
where we view u as an element of Xper in order to deﬁne the solution of this
equation. Then v solving (3.13) with c = exp(u) is given by the formula
v(x, t) = f
Ψ(x; t, u)
G(u) = v(1, 1) = f
Ψ(1; 1, u)
|G(u)| = |v(1, 1)| ⩽K
1 + |Ψ(1; 1, u)|p
But the solution of (3.15) subject to the condition x(0) = 1 satisﬁes
|x(1)| ⩽1 +
⩽1 + exp(∥u∥X).
Ψ(1; 1, u) ⩽1 + exp(∥u∥X),
and the ﬁrst result follows.
For the second result let x(t) = Ψ(1; t, u) and y(t) = Ψ(1; t, w) so that,
by (3.15),
x(t) = 1 −
y(t) = 1 −
Thus, using (3.17),
|x(t) −y(t)| ⩽C(∥u∥X, ∥w∥X)
|x(s) −y(s)| ds + ∥u −w∥∞
Application of the Gronwall inequality gives
|x(t) −y(t)| ⩽C(∥u∥X, ∥w∥X)∥u −w∥∞.
|Ψ(1; 1, u) −Ψ(1, 1, w)| ⩽C(∥u∥X, ∥w∥X)∥u −w∥∞.
A. M. Stuart
Hence, using (3.16), the fact that f is C1 and the bound (3.17), we deduce
|G(u) −G(w)| =
Ψ(1; 1, u)
Ψ(1; 1, w)
⩽L(r)∥u −w∥∞
⩽L(r)∥u −w∥X.
We wish to ﬁnd µy(du) = P(du|y). Informal use of Bayes’ rule gives us
2|y −G(u)|2
We now justify this formula by choice of prior and by application of Theorem 6.31.
We place a prior measure µ0 on the space X by assuming that u ∼µ0 is
Gaussian and that
u′(x) = du
dx(x) ∼N(0, βA−α),
where A = −d2/dx2 is a densely deﬁned operator on H = L2(S) with
u(x) dx = 0
If β > 0 and α > 1/2 then u′ is almost surely a continuous function, by
Lemma 6.25. Deﬁning
u(x) = u0 +
where u0 ∼N(0, σ2), determines the distribution of u completely. Furthermore, for β > 0 and α > 1/2 we have that u drawn from this measure is in
X with probability 1: µ0(X) = 1. Hence we deduce the following result.
Theorem 3.6.
Consider the Bayesian inverse problem for u(x) = ln(c(x))
subject to observation in the form (3.14), with v solving (3.13), and prior
measure µ0 as constructed immediately preceding this theorem. If β > 0
and α > 1/2 then µy(du) = P(du|y) is absolutely continuous with respect
to µ0(du), with Radon–Nikodym derivative given by (3.18).
To apply Theorem 6.31 it suﬃces to show that µ0(X) = 1, since
the function G is continuous from X into Rq. The fact that µ0(X) = 1 is
established immediately prior to this theorem.
3.5. Initial condition for the heat equation
We now study an inverse problem where the data y is a function, and
is hence inﬁnite-dimensional, in contrast to preceding examples where the
Inverse problems
data has been ﬁnite-dimensional. We assume that our observation is the
solution of the heat equation at some ﬁxed positive time T > 0, with an
added Gaussian random ﬁeld as observational noise, and that we wish to
determine the initial condition.
To be concrete we consider the heat equation on a bounded open set
D ⊂Rd, with Dirichlet boundary conditions, and written as an ODE in
Hilbert space H = L2(D):
dt + Av = 0,
Here A = −△with D(A) = H1
H2(D). We assume suﬃcient regularity conditions on D and its boundary ∂D to ensure that the operator A is
positive and self-adjoint on H, and is the generator of an analytic semigroup.
We deﬁne the (Sobolev-like) spaces Hs as in (2.29).
Assume that we observe the solution v at time T, subject to error which
has the form of a Gaussian random ﬁeld, and that we wish to recover the
initial condition u. This problem is classically ill-posed, because the heat
equation is smoothing, and inversion of this operator is not continuous on
H. Nonetheless, we will construct a well-deﬁned Bayesian inverse problem.
We place a prior measure on u, which is a Gaussian µ0 ∼N(m0, C0) with
C0 = βA−α, for some β > 0 and α > d/2; consequently u ∈H µ0-a.s. by
Lemma 6.27. Our aim is to determine conditions on α, and on m0, which
ensure that the Bayesian inverse problem is well-deﬁned. In particular, we
would like conditions under which the posterior measure is equivalent (as a
measure, see Section 6) to the prior measure.
We model the observation y as
y = e−AT u + η,
where η ∼N(0, C1) is independent of u. The observation operator G : H →
H is given by G(u) = e−AT u and, in fact, G : H →Hℓfor any ℓ> 0. If we
assume that C1 = δA−γ for some γ > d/2 and δ > 0, we then have that,
almost surely, η ∈H by Lemma 6.27.
Consider the Gaussian random variable (u, y) ∈H × H. We have
E(u, y) := (u, y) = (m0, e−AT m0).
Straightforward calculation shows that
E(u −u) ⊗(u −u) = C0,
E(u −u) ⊗(y −y) = C0 e−AT ,
E(y −y) ⊗(y −y) = e−AT C0 e−AT + C1.
By Theorem 6.20 we ﬁnd that the posterior measure µy for u given y is also
A. M. Stuart
Gaussian, with mean
m = m0 + β
δ e−AT Aγ−α
δ e−2AT Aγ−α
(y −e−AT m0)
and covariance operator
I + e−2AT C0C−1
δ e−2AT Aγ−α
We now show that the posterior (Gaussian) measure on H is indeed equivalent to the prior. We will assume α > d/2 since this ensures that samples
from the prior are continuous functions, by Lemma 6.25.
Theorem 3.7.
Consider an initial condition for the heat equation (3.19)
with prior Gaussian measure µ0 ∼N(m0, βA−α), m0 ∈Hα, β > 0 and α >
d/2. If an observation is given in the form (3.20) then the posterior measure
µy is also Gaussian, with mean and variance determined by (3.21) and
(3.23). Furthermore, µy and the prior measure µ0 are equivalent Gaussian
Let {φk, λk}k∈K, K = Zd\{0}, denote the eigenvalues of A and
deﬁne κ := β
δ supk∈K e−2λkT λγ−α
which is ﬁnite since T > 0 and A generates
an analytic semigroup. Furthermore, the operator
δ e−2AT Aγ−α
is diagonalized in the same basis as A, and is a bounded and invertible linear
operator with all eigenvalues lying in [(1 + κ)−1, 1]. Now, from (3.22), for
1 + κ⟨h, C0h⟩⩽⟨h, Ch⟩= ⟨h, C0Kh⟩⩽⟨h, C0h⟩.
Thus, by Lemma 6.15, we deduce that condition (i) of Theorem 6.13 is
satisﬁed, with E = Hα = Im(C1/2
From (3.21) we deduce that
δ e−AT Aγ−αK(y −e−AT m0).
Since A generates an analytic semigroup and since K is bounded, we deduce
that m −m0 ∈Hr for any r ∈R. Hence condition (ii) of Theorem 6.13 is
Inverse problems
satisﬁed. To check the remaining condition (iii), deﬁne
δ e−2AT Aγ−α
Aγ−αe−2AT .
The operator T is clearly Hilbert–Schmidt because its eigenvalues µk satisfy
and hence decay exponentially fast. This establishes (iii) of Theorem 6.13
and the proof is complete.
The preceding theorem uses the Gaussian structure of the posterior measure explicitly. To link the presentation to the other examples in this section,
it is natural to ask whether a similar result can be obtained less directly.
We deﬁne Φ : H × H →R by
Φ(u; y) = 1
2∥e−AT u∥2
C1 −⟨e−AT u, y⟩C1,
and use this function to derive Bayes’ formula for the measure µy(du) =
P(du|y). We will show that µy(du) is absolutely continuous with respect to
the prior µ0(du) with density
Remark 3.8.
It would be tempting to deﬁne a potential
Ψ(u; y) = 1
2∥y −G(u)∥2
2∥y −e−AT u∥2
in analogy with the examples in the two previous sections: this Ψ is a
least-squares functional measuring model/data mismatch.
However, this
quantity is almost surely inﬁnite, with respect to the random variable y,
since draws from a Gaussian measure in inﬁnite dimensions do not lie in
the corresponding Cameron–Martin space Im(C1/2
): see Lemma 6.10. This
undesirable property of Ψ stems directly from the fact that the data y is a
function rather than a ﬁnite-dimensional vector. To avoid the problem we
work with Φ(u; y) which, informally, may be viewed as being given by the
Φ(u; y) = Ψ(u; y) −1
Thus we ‘subtract oﬀ’ the inﬁnite part of Ψ. Since Bayes’ formula in the form
(3.24) only gives the density up to a y-dependent constant, we see intuitively
A. M. Stuart
why this subtraction of a term involving y is reasonable. The issues outlined
in this remark arise quite generally when the data y is inﬁnite-dimensional
and the observational noise η is Gaussian.
The form of Φ arising in this problem, and the fact that the data is inﬁnitedimensional, precludes us from using Theorem 6.31 to establish that (3.24)
is correct; however, the method of proof is very similar to that used to prove
Theorem 6.31.
Before proving that (3.24) is correct, we state and prove some properties
of the potential Φ.
Lemma 3.9.
The function Φ : H ×H →R satisﬁes Assumptions 2.6 with
X = Y = H and L(r) linearly bounded.
We may write
Φ(u; y) = 1
2 AT u, C−1/2
= δAγ we deduce that Kλ := C−1/2
e−λAT is a compact operator
on H for any λ > 0. By the Cauchy–Schwarz inequality we have, for any
Φ(u; y) ⩾−a2
By the compactness of K1/2 and by choosing a arbitrarily small, we deduce
that Assumption 2.6(i) holds. Assumption 2.6(ii) holds by a similar Cauchy–
Schwarz argument. Since Φ is quadratic in u, and using the compactness of
K1/2 and K1, we see that
|Φ(u1; y) −Φ(u2; y)| ⩽C
∥K1u1∥+ ∥K1u2∥+ ∥K1/2y∥
∥K1/2(u1 −u2)∥
∥u1∥+ ∥u2∥+ ∥y∥
4 AT (u1 −u2)∥
∥u1∥+ ∥u2∥+ ∥y∥
and similarly
|Φ(u; y1) −Φ(u; y2)| ⩽C∥u∥∥y1 −y2∥,
so that Assumptions 2.6(iii) and (iv) hold.
Theorem 3.10.
Consider the inverse problem for the initial condition u
in (3.19), subject to observation in the form (3.20) and with prior Gaussian
measure µ0 = N(m0, βA−α). If m0 ∈Hα, β > 0 and α > d/2, then the
posterior measure µy(du) = P(du|y) and the prior µ0(du) are equivalent
with Radon–Nikodym derivative given by (3.24).
Inverse problems
Recall that C1 = δA−γ and that C0 = βA−α. Deﬁne the measures
Q0(dy) = N(0, C1),
Q(dy|u) = N(e−AT u, C1),
µ0(du) = N(m0, C0),
and then deﬁne
ν0(dy, du) = Q0(dy) ⊗µ0(du),
ν(dy, du) = Q(dy|u)µ0(du).
By Theorem 6.14 we deduce that
(y|u) = exp
2∥e−AT u∥2
C1 + ⟨e−AT u, y⟩C1
The measure ν is well-deﬁned because the function Φ(·; y) : H →R is
continuous and hence µ0-measurable if µ0(H) = 1. This last fact follows
from Lemma 6.27, which shows that draws from µ0 are almost surely in H.
(y, u) = exp
2∥e−AT u∥2
C1 + ⟨e−AT u, y⟩C1
By applying Theorem 6.29, noting that under ν0 the random variables y
and u are independent with u ∼µ0, we deduce that
2∥e−AT u∥2
C1 + ⟨e−AT u, y⟩C1
with constant of proportionality independent of u.
3.6. Fluid mechanics
The preceding four subsections provide a range of examples where somewhat explicit calculations, using the solution of various forward linear PDE
problems, establish that the associated inverse problems may be placed in
the general framework that we outlined in Section 2.4 and will study further
in Section 4. However, it is by no means necessary to have explicit solutions
of the forward problem to use the framework developed in this article, and
the examples of this subsection, and the two subsections which follow it,
illustrate this.
Fluid mechanics provides an interesting range of applications where the
technology of inverse problems is relevant. We outline examples of such
problems and sketch their formulation as Bayesian inverse problems for
functions. We also show that these problems may be formulated to satisfy
Assumptions 2.7. Unlike the previous three sections, however, we do not
provide full details; we refer to other works for these, in the bibliography
subsection.
A. M. Stuart
In weather forecasting a variety of instruments are used to measure the velocity of the air in the atmosphere. Examples include weather balloons, data
from commercial and military aircraft, as well as special-purpose aircraft,
and satellites.
An important inverse problem is to determine the global
velocity ﬁeld, and possibly other ﬁelds, from the Eulerian data comprising
the various noisy measurements described above.
As a concrete, and simpliﬁed, model of this situation we consider the linearized shallow water equations on a two-dimensional torus. The equations
are a coupled pair of PDEs for the two-dimensional velocity ﬁeld v and a
scalar height ﬁeld h, with the form
∂t = Sv −∇h,
(x, t) ∈T2 × [0, ∞),
∂t = −∇· v,
(x, t) ∈T2 × [0, ∞).
The two-dimensional unit torus T2 is shorthand for the unit square with
periodic boundary conditions imposed. The skew matrix S is given by
and the term involving it arises from the Coriolis eﬀect.
The objective is to ﬁnd the initial velocity and height ﬁelds (v(0), h(0)) =
(u, p) ∈H, where
u ∈L2(T2; R3)
We assume that we are given noisy observations of the velocity ﬁeld at
positions {xj}J
j=1 and times {tk}K
k=1, all positive. Concatenating data, we
y = G(u, p) + η.
Here G maps a dense subset of H into R2JK and is the observation operator.
Because the PDE (3.27) is linear, so too is G. We assume that η ∼N(0, Γ)
is independent of u and we consider the Bayesian inverse problem of ﬁnding
the posterior measure µy(du) = P(du|y) from the prior µ0. We let A = −△
on T2 with domain
T2 u dx = 0
and deﬁne the prior through fractional powers of A.
Theorem 3.11.
Consider an initial condition for the shallow water equations (3.27) with prior Gaussian measure µ0 = N(m0, βA−α) with m0 ∈Hα,
β > 0 and α > 2. If a noisy observation is made in the form (3.28), then the
Inverse problems
posterior measure µy is also Gaussian, and is absolutely continuous with
respect to the prior measure µ0, with Radon–Nikodym derivative
(u, p) ∝exp
2|y −G(u, p)|2
where G is given by (3.28). Furthermore, the observation operator G satisﬁes
Assumptions 2.7 with X = Hs and K globally bounded, for any s > 1. ⋄
In oceanography a commonly used method of gathering data about ocean
currents, temperature, salinity and so forth is through the use of Lagrangian
instruments which are transported by the ﬂuid velocity ﬁeld and transmit
positional information using GPS. An important inverse problem is to determine the velocity ﬁeld in the ocean from the Lagrangian data comprising
the GPS information about the position of the instruments. As an idealized
model consider the incompressible Stokes (ι = 0) or Navier–Stokes (ι = 1)
equations written in the form:
∂t + ιv.∇v = ν∆v −∇p + f,
(x, t) ∈T2 × [0, ∞),
(x, t) ∈T2 × [0, ∞),
(x, t) ∈T2 × {0}.
As in the preceding example we impose periodic boundary conditions, here
on the velocity ﬁeld v and the pressure p.
We assume that f has zero
average over D, noting that this implies the same for v(x, t), provided that
u(x) = v(x, 0) has zero initial average. We deﬁne the Stokes operator A
and Leray projector P in the standard fashion, together with the Sobolev
spaces Hs = D(As/2) as in (2.29). The equations (3.30) can be written as
an ODE in the Hilbert space H:
dt + ιB(v, v) + νAu = ψ,
where ψ = Pf and B(v, v) represents the projection, under P, of the nonlinear convective term.
We assume that we are given noisy observations of Lagrangian tracers
with position z solving the integral equation
zj(t) = zj,0 +
v(zj(s), s) ds.
These equations have a unique solution if u ∈H and ψ ∈L2((0, T); H).
For simplicity assume that we observe all the tracers z at the same set of
times {tk}K
k=1, and that the initial particle tracer positions zj,0 are known
yj,k = zj(tk) + ηj,k,
j = 1, . . . , J and k = 1, . . . , K,
A. M. Stuart
where the ηj,k are zero mean Gaussian random variables. The times {tk}
are assumed to be positive. Concatenating data, we may write
y = G(u) + η,
with y = (y∗
1,1, . . . , y∗
J,K)∗and η ∼N(0, Γ) for some covariance matrix Γ
capturing the correlations present in the noise.
The function G maps a
dense subspace of H into R2JK. The objective is to ﬁnd the initial velocity
ﬁeld u, given y. We start by stating a result concerning the observation
Lemma 3.12.
Assume that ψ ∈C([0, T]; Hγ) for some γ > 0. Then G
given by (3.34) satisﬁes Assumptions 2.7 with X = Hℓfor any ℓ> 0.
These properties of the observation operator G lead to the following result.
Theorem 3.13.
Let µ0 = N(m0, βA−α) denote a prior Gaussian measure
on µ0. If m0 ∈Hα, β > 0 and α > 1 then the measure µy(du) = P(du|y) is
absolutely continuous with respect to µ0, with Radon–Nikodym derivative
2|y −G(u)|2
with G deﬁned by (3.34).
Notice that the required lower bound on the exponent α in the preceding
theorem is lower than that appearing in Theorem 3.11. This is because the
(Navier–)Stokes equation is smoothing, and hence less regularity is required
on the initial condition in order to deﬁne the observation operator G than
for the linearized shallow water equations.
3.7. Subsurface geophysics
Determining the permeability of subsurface rock is enormously important in
a range of diﬀerent applications. Among these applications are the prediction of transport of radioactive waste from underground waste repositories,
and the optimization of oil recovery from underground ﬁelds. We give an
overview of some inverse problems arising in this area. As in the previous
subsection we do not give full details, leaving these to the cited literature
in the bibliography subsection.
The permeability tensor K is a central component of Darcy’s law, which
relates the velocity ﬁeld v to the gradient of the pressure p in porous media
In general K is a tensor ﬁeld. However, the problem is often simpliﬁed by
Inverse problems
assuming that K = kI, where k is a scalar ﬁeld and I the identity tensor;
we make this simpliﬁcation.
In many subsurface ﬂow problems it is reasonable to model the velocity
ﬁeld as incompressible. Combining this constraint with Darcy’s law (3.36)
shows that the pressure p is governed by the PDE
∇· (−k∇p) = 0,
This model is a widely used simpliﬁed model in groundwater ﬂow modelling. The inverse problem is to ﬁnd the permeability k from observations
of the pressure at points in the interior of D; this information can be found
by measuring the height of the water table. For simplicity we work in two
or three dimensions d and assume that D ⊂Rd is bounded and open. As in
Section 3.3 it is physically and mathematically important that k be positive,
in order that the elliptic equation for the pressure is well-posed. Hence we
write k = exp(u) and consider the problem of determining u.
We assume that we observe
yj = p(xj) + ηj,
j = 1, . . . , J,
and note that this may be written as
y = G(u) + η
for some implicitly deﬁned function G. We assume that η ∼N(0, Γ) is
independent of u.
Before formulating the Bayesian inverse problem, we
state the following result concerning the forward problem.
Lemma 3.14.
Assume that the boundary of D, ∂D, is C1-regular and
that the boundary data h may be extended to a function h ∈W 1,2r(D)
with r > d/2. The function G satisﬁes Assumptions 2.7 with X = C(D). ⋄
We deﬁne the prior Gaussian measure through fractional powers of the
Laplacian A = −△with
∇u · n = 0,
u(x) dx = 0
Here n denotes the unit outward normal on the boundary of D.
Theorem 3.15.
Let the assumptions of Lemma 3.14 hold and let µ0 =
N(0, βA−α) denote a prior Gaussian measure on µ0. If β > 0 and α >
d −1/2, then the measure µy(du) = P(du|y) is absolutely continuous with
respect to µ0, with Radon–Nikodym derivative
2|y −G(u)|2
and G given by (3.39).
A. M. Stuart
Once the posterior measure on u is known it can be used to quantify
uncertainty in predictions made concerning the Lagrangian transport of radioactive particles under the velocity ﬁeld v given by (3.36). In particular,
the push forward of the measure µy onto v, and hence onto particle trajectories z obeying
dt = v(z),
will deﬁne a measure on the possible spread of radioactive contaminants,
enabling risk assessment to be undertaken.
The oil industry routinely confronts an inverse problem similar to but
more complex than that arising in the nuclear waste industry. Again, uncertainty quantiﬁcation is important as it enables more eﬀective decision
making concerned with the substantial investment of resources required to
extract oil from increasingly complex environments. The primary diﬀerence
between the simple model we have described for nuclear waste management
and that which we are about to describe for oil extraction arises because
the subsurface ﬂuid ﬂow for oil extraction is multiphase (gas, water, oil)
and signiﬁcant on much shorter time scales than in the nuclear waste management scenario. We study a simpliﬁed two-phase problem, for oil and
water alone. The physical model contains two unknown scalar ﬁelds, the
water saturation S (volume fraction of water in an oil–water mixture) and
pressure p, and is posed in a bounded open set D ⊂Rd. Darcy’s law now
takes the form
v = −λ(S)k∇p.
Mass conservation and transport, respectively, give the equations
−∇· (λ(S)k∇p) = h1,
(x, t) ∈D × [0, ∞),
∂t + v · ∇f(S) = η△S,
(x, t) ∈D × [0, ∞),
(x, t) ∈∂D × [0, ∞).
The ﬂux function f is known (typically the Buckley–Leverett form is used)
and the source/boundary terms h1, h2 are also both assumed known. The
scalar η is the (also assumed known) diﬀusivity of the multiphase ﬂow, typically very small. Initial conditions for S are speciﬁed on D at time t = 0.
There are additional boundary conditions on S which we now describe. We
partition ∂D = ∂Dout  ∂Din. We think of pumping water in on the boundary ∂Din, so that S = 1 there, and specify a Robin boundary condition on
∂Dout, determining the ﬂux of ﬂuid in terms of S the water saturation.
We assume that we have access to noisy measurements of the fractional
ﬂow F(t), which quantiﬁes the fraction of oil produced on a subset ∂Dmeas
Inverse problems
of the outﬂow boundary ∂Dout. This measurement is via the function
F(t) = 1 −
∂Dmeas f(S)vn dl
∂Dmeas vn dl
where vn is the component of the velocity v which is normal to the boundary and dl denotes integration along the boundary. Assume that we make
measurements of F at times {tk}K
k=1, polluted by Gaussian noise. Then the
data are as follows:
yk = F(tk) + ηk,
k = 1, . . . , K,
where the ηk are zero mean Gaussian random variables.
Concatenating
data, we may write
y = G(u) + η
where, as before, k(x) = exp(u(x)). We assume that η ∼N(0, Γ) for some
covariance matrix Γ encapsulating measurement errors. The prior µ0 is a
Gaussian measure on u, speciﬁed as in the previous section. We once again
anticipate that
2|y −G(u)|2
This is similar to the nuclear waste problem, but the observation operator
G is now more complicated. However, similar analyses of the properties of
the forward problem, and the resulting Bayesian inverse problem, can be
undertaken.
3.8. Molecular dynamics
Consider a molecule described by the positions x of N atoms moving in Rd,
with d = 1, 2 or 3. If we assume that the particles interact according to a
potential V : Rd →R and are subject to thermal activation, then, in the
over-damped limit where the inertial relaxation time is fast, we obtain the
Brownian dynamics model for the position of x:
dt = −∇V (x) +
Here W is a standard RNd-valued Brownian motion and β the inverse temperature. One of the key challenges in molecular dynamics is to understand
how molecules rearrange themselves to change from one conﬁguration to
another: in some applications this may represent a chemical reaction, and
in others a conformational change such as seen in biomolecules. When the
temperature is small (β ≫1), the solutions of (3.45) spend most of their
time near the minima of the potential V .
Transitions between diﬀerent
minima of the potential are rare events.
Simply solving the SDE starting from one of the minima will be a computationally infeasible way of
A. M. Stuart
generating sample paths which jump between minima, since the time to
make a transition is exponentially small in β. Instead we may condition
on this rare event occurring. This may be viewed as an inverse problem
to determine the control W which drives the system from one conﬁguration to another. However, we will work directly with the functions x which
result from this control, as these constitute the more physically interesting quantity. Because the Brownian motion W is a random function, this
leads naturally to the question of determining the probability measure on
functions x undergoing the desired transition between conﬁgurations. The
desired transition can be deﬁned by conditioning the dynamics given by
(3.45) to satisfy the boundary conditions
x(0) = x−,
x(T) = x+.
We view x as an element of L2((0, T); RNd) and denote the Nd-dimensional Brownian bridge measure arising from (3.45) and (3.46) in the case
V ≡0 by µ0. We also deﬁne µ to be the desired bridge diﬀusion measure
arising from the given V .
We may view both µ0 and µ as measures on
L2((0, T); RNd); the measure µ0 is Gaussian but, unless V is quadratic,
the measure µ is not. We now proceed to determine the Radon–Nikodym
derivative of µ with respect to the Gaussian bridge diﬀusion µ0.
Theorem 3.16.
Assume V ∈C2(RNd; R) and that the stochastic initial
value problem, found from (3.45) and (3.46) without the condition x(T) =
x+, has solutions which do not explode almost surely on t ∈[0, T]. Then
the measure µ deﬁned by the bridge diﬀusion problem (3.45) and (3.46) is
absolutely continuous with respect to the Brownian bridge measure µ0 found
from (3.45) and (3.46) in the case V ≡0. Furthermore, the Radon–Nikodym
derivative is given by
(x) ∝exp(−Φ(x)),
where the potential Φ is deﬁned by
G(x(t)) dt,
2∥∇V (x)∥2 −1
In addition, we ﬁnd that a large class of problems leads to the common
structure of Section 2.4. There is no explicit data y ∈Y in this problem,
but we can let y ∈Rp denote the parameters appearing in the potential V ,
and hence in G. (Note that β is not such a parameter, as it appears in G
but not in V ; more fundamentally it appears in µ0 and so is not simply a
parameter in the potential Φ). We thus write V (x; y) and G(x; y).
Inverse problems
Lemma 3.17.
Consider the function Φ deﬁned by (3.48a) and (3.48b)
with V : RNd × Rp →R. Assume that for any ε, r > 0 there exists M =
M(ε, r) ∈R such that, for all ∥y∥< r,
G(x; y) ⩾−ε2|x|2 + M;
assume also that G ∈C1(RNd × Rp, R) with derivative DyG(x; y) which is
polynomially bounded in x. Then Φ satisﬁes Assumptions 2.6 with X =
H1((0, T)).
3.9. Discussion and bibliography
We started this section by studying the problem of determining a ﬁeld from
observation. This is intimately related to the study of interpolation of data
by splines, a subject comprehensively developed and reviewed in Wahba
 . The link between spline interpolation and inverse problems using
Gaussian ﬁelds is surveyed in Gu .
The inverse problem for the diﬀusion coeﬃcient in Section 3.3 is a onedimensional analogue of the inverse problems arising in the geophysics community, which we outline in Section 3.7; these problems, which arise in the
study of groundwater ﬂow and are hence of interest to the burial of (radioactive nuclear and other) waste, are discussed in Zimmerman et al. .
A related inverse problem for the diﬀusion coeﬃcient of an elliptic PDE is
that arising in electrical impedence tomography; this widely studied inverse
problem requires recovery of the diﬀusion coeﬃcient from measurements of
the boundary ﬂux. It is of central importance in the medical sciences, and
also has a rich mathematical structure; see Borcea and Uhlmann
 for reviews.
Inverse problems for the heat equation, the subject of Section 3.5, are
widely studied. See, for example, the cited literature in Beck, Blackwell and
Clair and Engl et al. . An early formulation of this problem
in a Bayesian framework appears in Franklin .
We study applications to ﬂuid dynamics in Section 3.6: the subject known
as data assimilation.
Kalnay and Bennett survey inverse
problems in ﬂuid mechanics from the perspective of weather prediction and
oceanography respectively; see also Apte, Jones, Stuart and Voss ,
Lorenc , Ide, Kuznetsov and Jones , Kuznetsov, Ide and Jones
 , Nichols and Nodet for representative examples, some
closely related to the speciﬁc model problems that we study in this article.
Theorem 3.11, arising in our study of Eulerian observations and integration
into a wave equation model, is proved in Dashti, Pillai and Stuart .
Lemma 3.12 and Theorem 3.13, arising in the study of Lagrangian observations, are proved in Cotter et al. (Navier–Stokes case) and Cotter
et al. (Stokes case). A major question facing the research community in data assimilation for ﬂuid mechanics applications is to determine
A. M. Stuart
whether future increase in available computer resources is used to increase
resolution of the computational models, or to improve estimates of uncertainty. .) The framework developed in Section 3.6 allows for a
systematic treatment of uncertainty, as quantiﬁed by the variability in the
posterior measure; furthermore, the framework may be extended to make
inference not only about the initial condition but also about forcing to the
model, thereby enabling model error to be uncovered in a systematic fashion.
In this context we deﬁne model error to be an error term in the dynamical
model equations, as in Hagelberg, Bennett and Jones . Note, however,
that in practical data assimilation, model errors are sometimes combined
with the observation errors . Further discussion of model error
for problems arising in the atmospheric sciences may be found in the papers of Nichols and Fang et al. . In Cotter et al. we
discuss both Eulerian and Lagrangian data assimilation with and without
model error, with ﬂuid ﬂow model given by the Navier–Stokes equations
(3.30) with ι = 1.
The subject of minimal regularity required to deﬁne Lagrangian trajectories (3.32) in a Navier–Stokes velocity ﬁeld is covered in Chemin and Lerner
 and Dashti and Robinson . This theory is easily extended to
cover the case of the Stokes equations.
The systematic treatment of Lagrangian data assimilation is developed in
the sequence of papers by Ide et al. , Kuznetsov et al. , Salman,
Kuznetsov, Jones and Ide and Salman, Ide and Jones with
recent application in Vernieres, Ide and Jones . Although the subject
had been treated in an applied context, these were the ﬁrst papers to develop
a clear dynamical systems framework in which the coupled (skew-product)
dynamical system for the ﬂuid and the Lagrangian particles was introduced
as the fundamental object of study.
The papers by Pimentel, Haines and Nichols , Bell, Martin and Nichols , Huddleston, Bell, Martin and Nichols and
Martin, Bell and Nichols describe a variety of applications of ideas
from data assimilation to problems in oceanography. The paper by Wlasak,
Nichols and Roulstone discusses data assimilation in the atmospheric
sciences, using a potential vorticity formulation. In Bannister, Katz, Cullen,
Lawless and Nichols , forecast errors are studied for data assimilation
problems in ﬂuid ﬂow. The paper by Alekseev and Navon uses a
wavelet-based approach to study the inverse problem of determining inﬂow
ﬂuid properties from outﬂow measurements.
Some of the earliest work concerning the statistical formulation of inverse
problems was motivated by geophysical applications , such as those introduced in Section 3.7. The interpolation of a random ﬁeld, observed at a ﬁnite set of points, is outlined in Gu and
Inverse problems
is often referred to as ‘kriging’ .
Overviews of issues arising in oil reservoir simulation may be found in Farmer . The
mathematical statement of the oil reservoir simulation problem as outlined
here is formulated in Ma, Al-Harbi, Datta-Gupta and Efendiev and
further discussion of numerical methods is undertaken in Dostert, Efendiev,
Hou and Luo . Lemma 3.14 and Theorem 3.15, concerning the elliptic inverse problem for subsurface ﬂow, are proved in Dashti, Harris and
Stuart .
The formulation of problems from molecular dynamics in terms of probability measures on time-dependent functions has a long history. On the
mathematical side this is intimately related to the theory of rare events
 and an overview of some of the sampling techniques used for this problem may be found in Bolhuis, Chandler, Dellago
and Geissler .
The particular formulation of the problem that we
undertake here, in which the length of the transition T is speciﬁed a priori,
can be found in Dashti et al. ; see also Reznikoﬀand Vanden Eijnden
 , Hairer, Stuart, Voss and Wiberg and Hairer, Stuart and Voss
 . A generalization to second-order Newtonian dynamics models, in
place of the over-damped Brownian dynamics model (3.45) may be found
in Hairer, Stuart and Voss .
4. Common structure
4.1. Overview
It is natural to view the posterior measure µy given by (2.24) as the ideal
solution to the problem of combining a mathematical model with data y.
However, obtaining a formula such as this is only the beginning: we are
confronted with the formidable task of extracting information from this formula. At a high level this entire section is devoted to the question of the
stability of measures µy to perturbations of various kinds, under Assumptions 2.6 or 2.7. These stability results help to create ﬁrm foundations for
the algorithms designed to obtain information from the measure µy; these
algorithms are summarized in the next section.
In this section, then, we study the well-posedness of problems with respect
to parameters, or data, entering the deﬁnition of the measure: we show
Lipschitz properties of the posterior measure with respect to changes in the
We also study the related issue of approximating the measure, in
particular the approximation by measures deﬁned over a ﬁnite-dimensional
space. Section 4.2 concerns well-posedness in the setting where the data is
in the form of a function: it is inﬁnite-dimensional. In practical applications
the data will always be ﬁnite, but when the data is very dense it is a useful
abstraction to consider the data as being a function, and so this situation
is conceptually important.
However, when the data is sparse it is best
A. M. Stuart
viewed as ﬁnite, as a number of mathematical simpliﬁcations follow from
this. The well-posedness of the posterior measure in this ﬁnite data situation
is studied in Section 4.3. In Section 4.4 we study the eﬀect of approximating
the potential Φ and the eﬀect of this approximation on the measure µy given
by (2.24).
A key idea throughout this section is the use of metrics to study distances
between probability measures. This topic is discussed in Section 6.7 and,
in particular, the Hellinger metric which we use throughout this section is
introduced. The primary message concerning the Hellinger metric is this:
consider two measures which are absolutely continuous with respect to a
common Gaussian reference measure and which are distance ε apart in the
Hellinger metric. Then the expectations of polynomially bounded functions
under these two measures are also O(ε) apart. In particular, the mean and
covariance operator are O(ε) apart.
4.2. Well-posedness
The probability measure of interest is typically deﬁned through a density
with respect to a Gaussian reference measure µ0 = N(0, C) on a Hilbert
space H which, by shift of origin, we have taken to have mean zero. We
assume that, for some separable Banach space X, we have µ0(X) = 1. We
let {φk, γk}∞
k=1 denote the eigenfunctions and eigenvalues of C.
As in our previous developments, µy denotes the measure of interest,
with y denoting parameters, or data, entering its deﬁnition. As in (2.24) we
assume that
Recall that Φ(u; y) is the potential and that the normalization constant Z(y)
is chosen so that µy is a probability measure:
Both for this integral, and for others below, we observe that if µ0(X) = 1
we may write
and hence use properties of Φ(·; y) which hold on X.
In the preceding section we showed that a number of inverse problems give
rise to a probability measure µy of the form (4.1), where Φ : X × Y →R
satisﬁes Assumptions 2.6.
The data (or parameters) y is (are) assumed
to lie in a Banach space (Y, ∥· ∥Y ).
We allow for the case where Y is
inﬁnite-dimensional and the data is in the form of a function. The four
Assumptions 2.6(i)–(iv) play diﬀerent roles, indicated by the following two
Inverse problems
theorems. The third assumption is important for showing that the posterior probability measure is well-deﬁned, whilst the fourth is important for
showing continuity with respect to data. The ﬁrst and second assumptions
lead to bounds on the normalization constant Z from above and below,
respectively.
Theorem 4.1.
Let Φ satisfy Assumptions 2.6(i), (ii) and (iii) and assume
that µ0 is a Gaussian measure satisfying µ0(X) = 1. Then µy given by (4.1)
is a well-deﬁned probability measure on H.
Assumption 2.6(ii) may be used to show that Z is bounded below,
as shown in the proof of Theorem 4.2 below. Under Assumption 2.6(iii) it
follows that Φ is µ0-measurable, and hence the measure µy is well-deﬁned by
(4.1). By Assumption 2.6(i) we have that, for ∥y∥Y < r and all ε suﬃciently
X −M(ε, r)
since µ0 is a Gaussian probability measure and we may choose ε suﬃciently
small so that the Fernique Theorem (Theorem 6.9) applies. Thus the measure is normalizable and the proof is complete.
This proof directly shows that the posterior measure is a well-deﬁned
probability measure, without recourse to a conditioning argument.
conditioning argument used in Theorem 6.31 provides the additional fact
that µy(du) = P(du|y).
Now we study continuity properties of the measure µy with respect to y ∈
Y , under Assumptions 2.6(i), (ii) and (iv). This establishes the robustness
of many of the problems introduced in the preceding section to changes
Theorem 4.2.
Let Φ satisfy Assumptions 2.6(i), (ii) and (iv). Assume
also that µ0 is a Gaussian measure satisfying µ0(X) = 1 and that the
measure µy ≪µ0 with Radon–Nikodym derivative given by (4.1), for each
y ∈Y . Then µy is Lipschitz in the data y, with respect to the Hellinger
distance: if µy and µy′ are two measures corresponding to data y and y′ then
there exists C = C(r) > 0 such that, for all y, y′ with max{∥y∥Y , ∥y′∥Y } < r,
dHell(µy, µy′) ⩽C∥y −y′∥Y .
Consequently the expectation of any polynomially bounded function f :
X →E is continuous in y. In particular the mean and, in the case where
X is a Hilbert space, the covariance operator, are continuous in y.
A. M. Stuart
Throughout the proof, all integrals are over X, unless speciﬁed
otherwise. The constant C may depend on ε and r and changes from occurrence to occurrence. Let Z = Z(y) and Z′ = Z(y′) denote the normalization
constants for µy and µy′ so that
Using Assumption 2.6(ii) gives, for any r > 0,
exp(−K(r)) dµ0(u) = exp(−K(r))µ0{∥u∥X ⩽r}.
This lower bound is positive because µ0 has full measure on X and is Gaussian, so that all balls in X have positive probability. We have an analogous
lower bound for |Z′|.
Using Assumptions 2.6(i) and (iv) and using the Fernique Theorem, for µ0,
⩽C∥y −y′∥Y .
From the deﬁnition of Hellinger distance, we have
2dHell(µy, µy′)2 =
−(Z′)−1/2 exp
Z−1/2 −(Z′)−1/22
Now, again using Assumptions 2.6(i) and (iv) and the Fernique Theorem,
⩽C∥y −y′∥2
A similar use of the Fernique Theorem and Assumption 2.6(i) shows that
Inverse problems
the integral in I2 is ﬁnite. Also, using the bounds on Z, Z′ from below,
Z−1/2 −(Z′)−1/22 ⩽C
Z−3 ∨(Z′)−3
⩽C∥y −y′∥2
Combining gives the desired continuity result in the Hellinger metric.
Finally all moments of u in X are ﬁnite under µy and µy′ because the
change of measure from Gaussian µ0 involves a term which may be bounded
by use of Assumption 2.6(i).
The Fernique Theorem may then be applied. The desired result concerning the continuity of moments follows from
Lemma 6.37.
Example 4.3.
An example in which the data is a function is given in
Section 3.5, where we study the inverse problem of determining the initial
condition for the heat equation, given noisy observation of the solution at
a positive time; in Lemma 3.9 we establish that Assumptions 2.6 hold in
this case.
4.3. Well-posedness: ﬁnite data
For Bayesian inverse problems in which a ﬁnite number of observations are
made, the potential Φ has the form
Φ(u; y) = 1
2|y −G(u)|2
where y ∈Rq is the data, G : X →Rq is the observation operator and | · |Γ
is a covariance weighted norm on Rq. In this case it is natural to express
conditions on the potential Φ in terms of G. Recall that this is undertaken
in Assumptions 2.7. By Lemma 2.8 we know that Assumptions 2.7 imply
Assumptions 2.6 for Φ given by (4.3). The following corollary of Theorem 4.2
is hence automatic.
Corollary 4.4.
Assume that Φ : X × Rq →R is given by (4.3) and let G
satisfy Assumptions 2.7. Assume also that µ0 is a Gaussian measure satisfying µ0(X) = 1. Then the measure µy given by (4.1) is a well-deﬁned probability measure and is Lipschitz in the data y, with respect to the Hellinger
distance: if µy and µy′ are two measures corresponding to data y and y′,
then there is C = C(r) > 0 such that, for all y, y′ with max{|y|Γ, |y′|Γ} < r,
dHell(µy, µy′) ⩽C|y −y′|Γ.
Consequently the expectation of any polynomially bounded function f :
X →E is continuous in y. In particular the mean and, in the case where
X is a Hilbert space, the covariance operator are continuous in y.
Example 4.5.
The ﬁrst example of a problem with the structure of Assumptions 2.7 may be found in the discussion of ﬁnite-dimensional inverse
A. M. Stuart
problems in Section 2.2, and formula (2.8) in the case where ρ is a Gaussian
density; if, for example, G is diﬀerentiable and polynomially bounded, then
Assumptions 2.7 hold: see Example 2.2 for an explicit illustration. All the
examples in Section 3, with the exception of the heat equation example,
for which the data is inﬁnite, and the oil reservoir problem, for which the
appropriate analysis and choice of X has not yet been carried out, ﬁt the
framework of Corollary 4.4.
4.4. Approximation of measures in the Hellinger metric
To implement algorithms designed to sample the posterior measure µy given
by (4.1), we need to make ﬁnite-dimensional approximations. We study this
issue here. Since the dependence on y is not relevant in this section, we study
measures µ given by
where the normalization constant Z is given by
We approximate µ by approximating Φ. In particular, we deﬁne µN by
Our interest is in translating approximation results for Φ (determined by
the forward problem) into approximation results for µ (which describes the
inverse problem).
The following theorem proves such a result, bounding the Hellinger distance, and hence the total variation distance, between measures µ and µN
in terms of the error in approximating Φ.
Theorem 4.6.
Assume that the measures µ and µN are both absolutely
continuous with respect to µ0, satisfying µ0(X) = 1, with Radon–Nikodym
derivatives given by (4.4) and (4.6) and that Φ and ΦN satisfy Assumptions 2.6(i) and (ii) with constants uniform in N. Assume also that for any
ε > 0 there exists K = K(ε) > 0 such that
|Φ(u) −ΦN(u)| ⩽K exp
where ψ(N) →0 as N →∞. Then the measures µ and µN are close with
Inverse problems
respect to the Hellinger distance: there is a constant C, independent of N,
and such that
dHell(µ, µN) ⩽Cψ(N).
Consequently the expectation under µ and µN of any polynomially bounded
function f : X →E are O(ψ(N)) close. In particular, the mean and, in the
case where X is a Hilbert space, the covariance operator are O(ψ(N)) close.
Throughout the proof, all integrals are over X. The constant C
changes from occurrence to occurrence. The normalization constants Z and
ZN satisfy lower bounds which are identical to that proved for Z in the
course of establishing Theorem 4.2.
From Assumption 2.6(i) and (4.8), using the fact that µ0 is a Gaussian
probability measure so that the Fernique Theorem 6.9 applies,
From the deﬁnition of Hellinger distance, we have
2dHell(µ, µN)2 =
−(ZN)−1/2 exp
Z−1/2 −(ZN)−1/22
Now, again using Assumption 2.6(i) and equation (4.8), together with the
Fernique Theorem,
ψ(N)2 dµ0(u)
A similar use of the Fernique Theorem and Assumption 2.6(i) shows that
the integral in I2 is ﬁnite. Thus, using the bounds on Z, ZN from below,
Z−1/2 −(ZN)−1/22 ⩽C
Z−3 ∨(ZN)−3
A. M. Stuart
Combining gives the desired continuity result in the Hellinger metric.
Finally, all moments of u in X are ﬁnite under µ and µN because the
change of measure from Gaussian µ0 involves a term which may be controlled
by the Fernique Theorem. The desired results follow from Lemma 6.37.
Example 4.7.
Consider the inverse problem for the heat equation, from
Section 3.5, in the case where D = (0, 1). Approximate the Bayesian inverse
problem by use of a spectral approximation of the forward map e−AT :
H →H. Let P N denote the orthogonal projection in H onto the ﬁrst N
eigenfunctions of A. Then, for any T > 0 and r ⩾0,
∥e−AT −e−AT P N∥L(H,Hr) = O(exp(−cN2)).
From (3.25) we have the Lipschitz property that
|Φ(u) −Φ(v)| ⩽C
∥u∥+ ∥v∥+ ∥y∥
4AT (u −v)∥.
If we deﬁne ΦN(u) = Φ(P Nu), then the two preceding estimates combine
to give, for some C, c > 0 and independent of (u, y),
|Φ(u) −ΦN(u)| ⩽C
∥u∥exp(−cN2).
Thus (4.8) holds and Theorem 4.6 shows that the posterior measure is
perturbed by a quantity with order of magnitude O(exp(−cN2)) in the
Hellinger metric.
Remark 4.8.
Approximation may come from two sources: (i) from representing the target function u in a ﬁnite-dimensional basis; and (ii) from
approximating the forward model, and hence the potential Φ, by a numerical method such as a ﬁnite element or spectral method. In general these
two sources of approximation error are distinct and must be treated separately. An important issue is to balance the two sources of error to optimize
workload. In the case where u is a subset of, or the entire, initial condition
for a dynamical system and G is deﬁned through composition of some function with the solution operator, then (i) and (ii) will overlap if a spectral
approximation is employed for (ii), using the ﬁnite-dimensional basis from
(i). This is the situation in the preceding example.
For Bayesian inverse problems with ﬁnite data, the potential Φ has the
form given in (4.3), where y ∈Rq is the data, G : X →Rq is the observation operator and | · |Γ is a covariance weighted norm on Rq. If GN is an
approximation to G and we deﬁne
2|y −GN(u)|2
then we may deﬁne an approximation µN to µ as in (4.6). The following
corollary relating µ and µN is useful.
Inverse problems
Corollary 4.9.
Assume that the measures µ and µN are both absolutely
continuous with respect to µ0, with Radon–Nikodym derivatives given by
(4.4), (4.3) and (4.6), (4.10) respectively. Assume also that G is approximated by a function GN with the property that, for any ε > 0, there is
K′ = K′(ε) > 0 such that
|G(u) −GN(u)| ⩽K′ exp
where ψ(N) →0 as N →∞.
If G and GN satisfy Assumption 2.7(i)
uniformly in N, then there is a constant C, independent of N, and such that
dHell(µ, µN) ⩽Cψ(N).
Consequently the expectation under µ and µN of any polynomially bounded
function f : X →E is O(ψ(N)) close. In particular, the mean and, in the
case where X is a Hilbert space, the covariance operator are O(ψ(N)) close.
We simply show that the conditions of Theorem 4.6 hold. That
(i) and (ii) of Assumptions 2.6 hold follows as in the proof of Lemma 2.8.
Also (4.8) holds since (for some K : R+ →R+ deﬁned in the course of the
following chain of inequalities)
|Φ(u) −ΦN(u)| ⩽1
2|2y −G(u) −GN(u)|Γ|G(u) −GN(u)|Γ
|y|Γ + exp
× K′(ε) exp
⩽K(2ε) exp
as required.
A notable fact concerning Theorem 4.6 is that the rate of convergence
attained in the solution of the forward problem, encapsulated in approximation of the function Φ by ΦN, is transferred into the rate of convergence
of the related inverse problem for measure µ given by (4.4) and its approximation by µN. Key to achieving this transfer of rates of convergence
is the dependence of the constant in the forward error bound (4.8) on u.
In particular it is necessary that this constant is integrable by use of the
Fernique Theorem. In some applications it is not possible to obtain such
dependence. Then convergence results can sometimes still be obtained, but
at weaker rates. We state a theorem applicable in this situation.
Theorem 4.10.
Assume that the measures µ and µN are both absolutely
continuous with respect to µ0, satisfying µ0(X) = 1, with Radon–Nikodym
derivatives given by (4.4) and (4.6), and that Φ and ΦN satisfy Assumptions 2.6(i) and (ii) with constants uniform in N. Assume also that for any
R > 0 there is a K = K(R) > 0 such that, for all u with ∥u∥X ⩽R,
|Φ(u) −ΦN(u)| ⩽Kψ(N),
A. M. Stuart
where ψ(N) →0 as N →∞. Then the measures µ and µN are close with
respect to the Hellinger distance:
dHell(µ, µN) →0
as N →∞. Consequently the expectation of any polynomially bounded
function f : X →E under µN converges to the corresponding expectation
under µ as N →∞. In particular, the mean and, in the case where X is a
Hilbert space, the covariance operator converge.
4.5. Discussion and bibliography
The idea of placing a number of inverse problems within a common Bayesian
framework, and studying general properties in this abstract setting, is developed in Cotter et al. . That paper contains Theorems 4.1 and 4.2
under Assumptions 2.6 in the case where (i) is satisﬁed trivially because Φ
is bounded from below by a constant; note that this case occurs whenever
the data is ﬁnite-dimensional. Generalizing the theorems to allow for (i)
as stated here was undertaken in Hairer, Stuart and Voss , in the
context of signal processing for stochastic diﬀerential equations.
Theorem 4.2 is a form of well-posedness. Recall that, in the approximation of forward problems in diﬀerential equations, well-posedness and a local
approximation property form the key concepts that underpin the equivalence theorems of Dahlquist , Lax and Sanz-Serna and
Palencia . It is also natural that the wellposedness that we have exhibited for inverse problems should, when combined with forward approximation, give rise to approximation results for
the inverse problem. This is the basic idea underlying Theorem 4.6. That
result, Corollary 4.9 and Theorem 4.10 are all stated and proved in Cotter
et al. .
The underlying well-posedness of properly formulated Bayesian inverse
problems has a variety of twists and turns which we do not elaborate fully
here. The interested reader should consult Dashti et al. .
5. Algorithms
5.1. Overview
We have demonstrated that a wide range of inverse problems for functions
u given data y give rise to a posterior measure µy with the form (2.24).
This formula encapsulates neatly the ideal information that we have about
a function, formed from conjunction of model and data. Furthermore, for
many applications, the potential Φ satisﬁes Assumptions 2.6. From this we
have shown in Section 4 that the formula (2.24) indeed leads to a well-deﬁned
Inverse problems
posterior µy and that this measure enjoys nice robustness properties with
respect to changes in the data or approximation of the forward problem.
However, we have not yet addressed the issue of how to obtain information
from the formula (2.24) for the posterior measure. We devote this section
to an overview of the computational issues which arise in this context.
If the prior measure is Gaussian and the potential Φ(·; y) is quadratic,
then the posterior is also Gaussian. This situation arises, for example, in the
inverse problem for the heat equation described in Section 3.5. The measure
µy is then characterized by a function (the mean) and an operator (the
covariance) and formulae can be obtained for these quantities by completing
the square using Theorem 6.20: see the developments for the heat equation,
or Example 6.23, for an illustration of this.
However, in general there is no explicit way of characterizing the measure µy as can be done in the Gaussian case. Thus approximations and
computational tools are required to extract information from the formula
One approach to this problem is to employ sampling techniques
which (approximately) generate sample functions according to the probability distribution implied by (2.24). Among the most powerful generic
tools for sampling are the Markov chain Monte Carlo (MCMC) methods,
which we review in Section 5.2. However, whilst these methods can be very
eﬀective when tuned carefully to the particular problem at hand, they are
undeniably costly and, for many applications, impracticable at current levels of computer resources. For this reason we also devote two subsections to
variational and ﬁltering methods, which are widely used in practice because
of their computational expedience. When viewed in terms of their relation
to (2.24) these methods constitute approximations. Furthermore, these approximations are, in many cases, not well understood. In the near future
we see the main role of MCMC methods as providing controlled approximations to the true posterior measure µy, against which variational and
ﬁltering methodologies can be tested, on well-designed model problems. In
the longer term, as computational power and algorithmic innovation grows,
we also anticipate increasing use of MCMC methods in their own right to
approximate (2.24).
From a Bayesian perspective, the variational methods of Section 5.3 start
from the premise that variability in the posterior measure is small and that
most of the information resides in a single peak of the probability distribution, which can be found by optimization techniques. We view this problem
from the standpoint of optimal control, showing that a minimizer exists
whenever the common framework of Section 2.4 applies; we also review
algorithmic practice in the area. Section 5.4 describes the widely used ﬁltering methods which approximate the posterior measure arising in timedependent data assimilation problems by a sequence of probability measures
in time, updated sequentially. The importance of this class of algorithms
A. M. Stuart
stems from the fact that, in many applications, solutions are required online, with updates required as more data is acquired; thus sequential updating of the posterior measure at the current time is natural. Furthermore,
sequential updates are computationally eﬃcient as they reduce the dimensionality of the desired posterior measure, breaking a correlated measure
at a sequence of times into a sequence of conditionally independent measures at each time, provided there is an underlying Markovian structure.
We conclude, in Section 5.5, with references to the literature concerning
algorithms.
When discussing MCMC methods and variational methods, the dependence of the potential Φ appearing in (2.24) will not be relevant and we will
consider the problem for the posterior measure written in the form
with normalization constant
We refer to µ as the target distribution. For the study of both MCMC and
variational methods, we will also ﬁnd it useful to deﬁne
This is, of course, a form of regularized least-squares functional as introduced in Section 2.
5.2. Markov chain Monte Carlo
The basic idea of MCMC methods is simple: design a Markov chain with
the property that a single sequence of output from the chain {un}∞
distributed according to µ given by (5.1). This is a very broad algorithmic
prescription and allows for signiﬁcant innovation in the design of methods
tuned to the particular structure of the desired target distribution. We will
focus on a particular class of MCMC methods known as Metropolis–Hastings
(MH) methods.
The key ingredient of these methods is a probability measure on X,
parametrized by u ∈X: a Markov transition kernel q(u, dv). This kernel is
used to propose moves from the current state of the Markov chain un to a
new point distributed as q(un, ·). This proposed point is then accepted or
rejected according to a criterion which uses the target distribution µ. The
resulting Markov chain has the desired property of preserving the target
distribution. Key to the success of the method is the choice of q. We now
give details of how the method is constructed.
Inverse problems
Given q(u, ·) and the target µ we deﬁne a new measure on X×X deﬁned by
ν(du, dv) = q(u, dv)µ(du).
We deﬁne the same measure, with the roles of u and v reversed, by
ν⊤(du, dv) = q(v, du)µ(dv).
Provided that ν⊤is absolutely continuous with respect to ν, we may deﬁne
α(u, v) = min
Now deﬁne a random variable γ(u, v), independent of the probability space
underlying the transition kernel q, with the property that
with probability α(u, v),
otherwise.
We now create a random Markovian sequence {un}∞
n=0 as follows. Given
a proposal vn ∼q(un, ·), we set
un+1 = γ(un, vn)vn + (1 −γ(un, vn))un.
If we choose the randomness in the proposal vn and the binary random
variable γ(un, vn) independently of each other for each n, and independently
of their values for diﬀerent n, then this construction gives rise to a Markov
chain with the desired property.
Theorem 5.1.
Under the given assumptions, the Markov chain deﬁned
by (5.5) is invariant for µ: if u0 ∼µ then un ∼µ for all n ⩾0. Furthermore,
if the resulting Markov chain is ergodic then, for any continuous bounded
function f : X →R, any M ⩾0, and for u0 µ-a.s.,
In words, this theorem states that the empirical distribution of the Markov
chain converges weakly to that of the target measure µ. However, this nice
abstract development has not addressed the question of actually constructing an MH method. If X = Rn and the target measures have positive density
with respect to Lebesgue measure, then this is straightforward: any choice of
kernel q(u, dv) will suﬃce, provided it too has positive density with respect
to Lebesgue measure, for every u. It then follows that ν⊤≪ν. From this
wide range of admissible proposal distributions, the primary design choice is
to identify proposals which lead to low correlation in the resulting Markov
chain, as this increases eﬃciency.
A. M. Stuart
Example 5.2.
A widely used proposal kernel is simply that of a random
walk; for example, if µ0 = N(0, C) it is natural to propose
where ξ ∼N(0, C). A straightforward calculation shows that
α(u, v) = min
I(u) −I(v)
where I is given by (5.3).
Thus, if the proposed state corresponds to a
lower value of the regularized least-squares functional I, then the proposal
is automatically accepted; otherwise it will be accepted with a probability
depending on I(u) −I(v).
The parameter δ is a scalar which controls the size of the move. Large
values lead to proposals which are hence unlikely to be accepted, leading to
high correlation in the Markov chain. On the other hand small moves do
not move very far, again leading to high correlation in the Markov chain.
Identifying appropriate values of δ between these extremes is key to making
eﬀective algorithms.
More complex proposals use additional information
about DΦ in an attempt to move into regions of high probability (low Φ). ⋄
In inﬁnite dimensions things are not so straightforward: a random walk
will not typically deliver the required condition ν⊤≪ν. For example, if
µ0 = N(0, C) and X is inﬁnite-dimensional, then the proposal (5.7) will not
satisfy this constraint. However, a little thought shows that appropriate
modiﬁcations are possible.
Example 5.3.
The random walk can be modiﬁed to obtain the desired
absolute continuity of ν⊤with respect to ν. The proposal
v = (1 −2δ)1/2u +
where ξ ∼N(0, C), will satisfy the desired condition for any δ ∈R. The
acceptance probability is
α(u, v) = min
Φ(u) −Φ(v)
Thus, if the proposed state corresponds to a lower value of Φ than does the
current state, it will automatically be accepted.
The proposal in (5.8) should be viewed as an appropriate analogue of
the random walk proposal in inﬁnite-dimensional problems. Intuition as to
why this proposal works in the inﬁnite-dimensional setting can be obtained
by observing that, if u ∼N(0, C) and v is constructed using (5.8), then
v ∼N(0, C); thus the proposal preserves the underlying reference measure
(prior) µ0. In contrast, the proposal (5.7) does not: if u ∼N(0, C) then
(1 + 2δ)N(0, C).
Inverse problems
Note that the choice δ =1/2 in (5.8) yields an independence sampler where
proposals v are made from the prior measure µ0, independently of the current state of the Markov chain u. As in ﬁnite dimensions, improved proposals
can be found by including information about DΦ in the proposal.
In computational practice, of course, we always implement a sampling
method in ﬁnite dimensions. The error incurred by doing so may be quanti-
ﬁed by use of Theorem 4.6. It is natural to ask whether there is any value in
deriving MH methods on function space, especially since this appears harder
than doing so in ﬁnite dimensions. The answer, of course, is ‘yes’. Any MH
method in ﬁnite dimensions which does not correspond to a well-deﬁned
limiting MH method in the function space (inﬁnite-dimensional) limit will
degenerate as the dimension of the space increases. This eﬀect can be quantiﬁed and compared with what happens when proposals deﬁned on function
space are used. In conclusion, then, the function space viewpoint on MCMC
methods is a useful one which leads to improved algorithms, and an understanding of the shortcomings of existing algorithms.
5.3. Variational methods
Variational methods attempt to answer the following question: ‘How do we
ﬁnd the most likely function u under the posterior measure µ given by (5.1)?’
To understand this consider ﬁrst the case where X = Rn and µ0 = N(0, C) is
a Gaussian prior. Then µ has density with respect to Lebesgue measure and
the negative logarithm of this density is given by (5.3).3 Thus the Lebesgue
density of µ is maximized by minimizing I over Rn. Another way of looking
at this is as follows: if u is such a minimizer then the probability of a small
ball of radius ε and centred at u will be maximized, asymptotically as ε →0,
by choosing u = u.
If X is an inﬁnite-dimensional Hilbert space then there is no Lebesgue
measure on X, and we cannot directly maximize the density. However, we
may again consider the probability of small balls at u ∈X, of radius ε.
We may then ask how u should be chosen to maximize the probability of
the ball, asymptotically as ε →0. Again taking µ0 = N(0, C) this question
leads to the conclusion that u should be chosen as a global minimizer of I
given by (5.3) over the Cameron–Martin space E with inner product ⟨·, ·⟩C
and norm ∥· ∥C.
Recall that Φ measures model/data mismatch, in the context of applications to inverse problems. In the case where y is ﬁnite-dimensional it has the
form (4.3). It is thus natural to minimize Φ directly, as in (2.2). However,
when X is inﬁnite-dimensional, this typically leads to minimizing sequences
3 Recall that for economy of notation we drop explicit reference to the y dependence of
Φ in this subsection, as it plays no role.
A. M. Stuart
which do not converge in any reasonable topology.
The addition of the
quadratic penalization in E may be viewed as a Tikhonov regularization to
overcome this problem. Minimization of I is thus a regularized nonlinear
least-squares problem as in (2.3). Of course this optimization approach can
be written down directly, with no reference to probability. The beauty of
the Bayesian approach is that it provides a rational basis for the choice of
norms underlying the objective functional Φ, as well as the choice of norm
in the regularization term proportional to ∥u∥2
C. Furthermore, the Bayesian
viewpoint gives an interpretation of the resulting optimization problem as
a probability maximizer. And ﬁnally the framework of Section 2.4, which
leads to well-posed posterior measures, also leads directly to an existence
theory for probability maximizers. We now describe this theory.
Theorem 5.4.
Let Assumptions 2.6(i) and (iii) hold, and assume that
µ0(X) = 1. Then there exists u ∈E such that
I(u) = I := inf{I(u) : u ∈E}.
Furthermore, if {un} is a minimizing sequence satisfying I(un) →I(u), then
there is a subsequence {un′} that converges strongly to u in E.
First we show that I is weakly lower semicontinuous on E. Let
un ⇀u in E. By the compact embedding of E in X, which follows from
Theorem 6.11 since µ0(X) = 1, we deduce that un →u, strongly in X.
By the Lipschitz continuity of Φ in X (Assumption 2.6(iii)) we deduce that
Φ(un) →Φ(u). Thus Φ is weakly continuous on E. The functional J(u) :=
C is weakly lower semicontinuous on E. Hence I(u) = J(u) + Φ(u) is
weakly lower semicontinuous on E.
Now we show that I is coercive on E. Again using the fact that E is
compactly embedded in X, we deduce that there is a K > 0 such that
Hence, by Assumption 2.6(i), it follows that, for any ε > 0, there is an
M(ε) ∈R such that
C + M(ε) ⩽I(u).
By choosing ε suﬃciently small, we deduce that there is an M ∈R such
that, for all u ∈E,
C + M ⩽I(u).
This establishes coercivity.
Consider a minimizing sequence. For any δ > 0 there is an N1 = N1(δ):
M ⩽I ⩽I(un) ⩽I + δ,
Inverse problems
Using (5.9) we deduce that the sequence {un} is bounded in E and, since E is
a Hilbert space, there exists u ∈E such that (possibly along a subsequence)
un ⇀u in E. From the weak lower semicontinuity of I it follows that, for
any δ > 0,
I ⩽I(u) ⩽I + δ.
Since δ is arbitrary the ﬁrst result follows.
Now consider the subsequence un ⇀u. Then there is an N2 = N2(δ) > 0
such that, for n, ℓ⩾N2,
4∥un −uℓ∥2
2(un + uℓ)∥2
= I(un) + I(uℓ) −2I
2(un + uℓ)
−Φ(uℓ) + 2Φ
2(un + uℓ)
⩽2(I + δ) −2I −Φ(un) −Φ(uℓ) + 2Φ
2(un + uℓ)
⩽2δ −Φ(un) −Φ(uℓ) + 2Φ
2(un + uℓ)
But un, uℓand 1
2(un + uℓ) all converge strongly to u in X. Thus, by continuity of Φ, we deduce that, for all n, ℓ⩾N3(δ),
4∥un −uℓ∥2
Hence the sequence is Cauchy in E and converges strongly, and the proof
is complete.
Example 5.5.
Recall the inverse problem for the diﬀusion coeﬃcient of
the one-dimensional elliptic problem described in Section 3.3. The objective
is to ﬁnd u(x) appearing in
exp(u(x))dp
p(1) = p+,
where p+ > p−. The observations are
yk = p(xk) + ηk,
k = 1, . . . , q
written succinctly as
y = G(u) + η,
where η ∈Rq is distributed as N(0, γ2I). The function G is Lipschitz in the
space of continuous functions X = C( ) by Lemma 3.3.
A. M. Stuart
Recall that changing u by an arbitrary additive constant does not change
the solution of (3.5), and so we assume that u integrates to zero on (0, 1).
u ∈L2((0, 1))
u(x) dx = 0
We take A = −d2/dx2 with
per((0, 1))
u(x) dx = 0
Then A is positive deﬁnite self-adjoint, and we may deﬁne the prior Gaussian
measure µ0 = N(0, A−1) on H. By Lemma 6.25 we deduce that µ0(X) = 1.
The Cameron–Martin space
E = Im(A−1/2) =
per((0, 1))
u(x) dx = 0
is compactly embedded into C( ) by Theorem 2.10; this is also a consequence of the general theory of Gaussian measures since µ0(X) = 1. By the
Lipschitz continuity of G in X and Theorem 5.4, we deduce that
2γ2 |y −G(u)|2
attains its inﬁmum at u ∈E.
In summary, the function space Bayesian viewpoint on inverse problems
is instructive in developing an understanding of variational methods. In
particular it implicitly guides choice of the regularization that will lead to
a well-posed minimization problem.
5.4. Filtering
There are two key ideas underlying ﬁltering: the ﬁrst is to build up knowledge about the posterior sequentially, and hence perhaps more eﬃciently;
the second is to break up the unknown u and build up knowledge about
its constituent parts sequentially, hence reducing the computational dimension of each sampling problem. Thus the ﬁrst idea relies on decomposing
the data sequentially, whilst the second relies on decomposing the unknown
sequentially.
The ﬁrst basic idea is to build up information about µy sequentially as
the size of the data set increases. For simplicity assume that the data is
ﬁnite-dimensional and can be written as y = {yj}J
j=1. Assume also that
each data point yj is found from a mapping Gj : X →Rℓand subject to
independent Gaussian observational noises ηj ∼N(0, Γj) so that
yj = Gj(u) + ηj.
Inverse problems
Thus the data is in Rq for q = ℓJ. The posterior measure has the form
|yj −Gj(u)|2
Now let µy
i denote the posterior distribution given only the data y = {yj}i
|yj −Gj(u)|2
Furthermore, setting µy
0 = µ0, we have
2|yi+1 −Gi+1(u)|2
Compare formulae (5.11) and (5.13). When J is large, it is intuitive that
i+1 is closer to µy
i than µy = µy
J is to µ0.
This suggests that formula
(5.13) may be used as the basis for obtaining µy
i+1 from µy
i , and thereby
to approach µy = µy
J by iterating this over i. In summary, the ﬁrst key
idea enables us to build up our approximation to µy incrementally over an
ordered set of data.
The second key idea involves additional structure. Imagine that we have
yj = y(tj) for some set of times
0 ⩽t1 < t2 < · · · < tJ < ∞.
Assume furthermore that u is also time-dependent and can be decomposed
as u = {uj}J
j=1, where uj = u(tj), and that (5.10) simpliﬁes to
yj = Gj(uj) + ηj.
Then it is reasonable to seek to ﬁnd the conditional measures
νi|1:i(dui) := P(dui|{yj}i
Notice that each of these measures lives on a smaller space than does µy
and this dimension reduction is an important feature of the methodology.
Assuming that the sequence u = {uj}J
j=1 is governed by a Markovian evolution, the measure (5.15) uniquely determines the measure
νi+1|1:i(dui+1) := P(dui+1|{yj}i
Incorporating the (i + 1)st data point, we ﬁnd that
dνi+1|1:i+1
(ui+1) ∝exp
2|yi+1 −Gi+1(ui+1)|2
Thus we have a way of building the measures given by (5.15) incrementally
A. M. Stuart
Clearly, by deﬁnition, νJ|1:J(duJ) agrees with the marginal distribution of
µy(du) on the coordinate uJ = u(tJ); however, the distribution of νi|1:i(dui)
for i < J does not agree with the marginal distribution of µy(du) on coordinate ui = u(ti). Thus the algorithm is potentially very powerful at updating
the current state of the system given data up to that time; but it fails to
update previous states of the system, given data that subsequently becomes
available. We discuss the implications of this in Section 5.5.
5.5. Discussion and bibliography
We outline the methods described in this section, highlight some relevant
related literature, and discuss inter-relations between the methodologies. A
number of aspects concerning computational methods for inverse problems,
both classical and statistical, are reviewed in Vogel . An important
conceptual algorithmic distinction to make in time-dependent data assimilation problems is between forecasting methods, which are typically used
online to make predictions as data is acquired sequentially, and hindcasting methods which are used oﬄine to obtain improved understanding (this
is also called reanalysis) and, for example, may be used for the purposes
of parameter estimation to obtain improved models. MCMC methods are
natural for hindcasting and reanalysis; ﬁltering is natural in the forecasting
context. Filtering methods update the estimate of the state based only on
data from the past, whereas the full posterior measure estimates the state
at any given time based on both past and future observations; methods
based on this full posterior measure are known as smoothing methods and
include MCMC methods based on the posterior and variational methods
which maximize the posterior probability.
The development of MCMC methods was initiated with the paper by
Metropolis, Rosenbluth, Teller and Teller , in which a symmetric random walk proposal was used to determine thermodynamic properties, such
as the equation of state, from a microscopic statistical model.
 demonstrated that the idea could be generalized to quite general
families of proposals, providing the seed for the study of these methods
in the statistics community . The paper of Tierney provides the
inﬁnite-dimensional framework for MH methods that we outline here; in
particular, Theorem 5.1 follows from the work in that paper. Ergodic theorems, such as the convergence of time averages as in (5.6), can in many cases
be proved for much wider classes of functions than continuous bounded functions. The general methodology is described in Meyn and Tweedie 
and an application to MH methods is given in Roberts and Tweedie .
The degeneration of many MH methods on state spaces of ﬁnite but
growing dimension is a well-known phenomenon to many practitioners. An
analysis and quantiﬁcation of this eﬀect was ﬁrst undertaken in Roberts,
Inverse problems
Gelman and Gilks , where random walk proposals were studied for
an i.i.d. target, and subsequently in Roberts and Rosenthal ,
Beskos and Stuart and Beskos, Roberts and Stuart for other
target distributions and proposals; see Beskos and Stuart for an
The idea of using proposals designed to work in the inﬁnitedimensional context to overcome this degeneration is developed in Stuart,
Voss and Wiberg and Beskos, Roberts, Stuart and Voss in the
context of sampling conditioned diﬀusions, and is described more generally
in Beskos and Stuart , Beskos et al. , Beskos and Stuart 
and Cotter, Dashti, Robinson and Stuart .
The use of MCMC methods for sampling the posterior distribution arising in the Bayesian approach to inverse problems is highlighted in Kaipio
and Somersalo , Calvetti and Somersalo and Calvetti,
Kuceyeski and Somersalo . When sampling complex high-dimensional
posterior distributions, such as those that arise from ﬁnite-dimensional approximation of measures µy given by (2.24), can be extremely computationally challenging. It is, however, starting to become feasible; recent examples
of work in this direction include Calvetti and Somersalo , Dostert
et al. , Kaipio and Somersalo , Heino, Tunyan, Calvetti and
Somersalo and Calvetti, Hakula, Pursiainen and Somersalo .
In Cotter et al. inverse problems such as those in Section 3.6 are
studied by means of the MH technology stemming from the proposal (5.8).
Examples of application of MCMC techniques to the statistical solution of
inverse problems arising in oceanography, hydrology and geophysics may be
found in Efendiev et al. , Cui, Fox, Nicholls and O’Sullivan ,
McKeague, Nicholls, Speer and Herbei , Herbei, McKeague and Speer
 , McLaughlin and Townley , Michalak and Kitanidis 
and Mosegaard and Tarantola . The paper by Herbei and McKeague
 studies the geometric ergodicity properties of the resulting Markov
chains, employing the framework developed in Meyn and Tweedie .
The idea of using proposals more general than (5.7), and in particular proposals that use derivative information concerning Φ, is studied in Roberts
and Tweedie . A key concept here is the Langevin equation: a stochastic diﬀerential equation for which µ is an invariant measure. Discretizing this
equation, which involves the derivative of Φ, is the basis for good proposals. This is related to the fact that, for small discretization parameter, the
proposals nearly inherit this invariance under µ. Applying this idea in the
inﬁnite-dimensional context is described in Apte, Hairer, Stuart and Voss
 and Beskos and Stuart , based on the idea of Langevin equations in inﬁnite dimensions .
Characterizing the centres of small balls with maximum probability has
been an object of interest in the theory of stochastic diﬀerential equations for
A. M. Stuart
some time. See Ikeda and Watanabe and D¨urr and Bach for
the simplest setting, and Zeitouni and Dembo for a generalization to
signal processing problems. Our main Theorem 5.4 concerning the existence
of probability maximizers provides a nice link between Bayesian inverse
problems and optimal control. The key ingredients are continuity of the
forward mapping from the unknown function to the data, in the absence of
observational noise, in a space X, and choice of a prior measure which has
the properties that draws from it are almost surely in X: µ0(X) = 1; this
then guarantees that the Tikhonov regularization, which is in the Cameron–
Martin norm for the prior measure, is suﬃcient to prove existence of a
minimizer for the variational method.
The idea concluding the proof of the ﬁrst part of Theorem 5.4 is standard
in the theory of calculus of variations: see Dacarogna . The strong convergence argument generalizes an argument
from Kinderlehrer and Stampacchia . The PhD thesis
of Nodet contains a speciﬁc instance of Theorem 5.4, for a model of
Lagrangian data assimilation in oceanography, and motivated the approach
that we take here; related work is undertaken in White for Burgers’
equation. An alternative approach to the existence of minimizers is to study
the Euler–Lagrange equations. The paper of Hagelberg et al. studies existence by this approach for a minimization problem closely related
to the MAP estimator. The paper studies the equations of ﬂuid mechanics, formulated in terms vorticity–streamfunction variables. Their approach
has the disadvantage of requiring a derivative to deﬁne the Euler–Lagrange
equations, a short time interval to obtain existence of a solution, and also
requires further second-derivative information to distinguish between minimizers and saddle points. However, it does form the basis of a numerical
approach to ﬁnd the MAP estimator. For linear diﬀerential equations subject to Gaussian noise there is a beautiful explicit construction of the MAP
estimator, using the Euler–Lagrange equations, known as the representer
method. This method is described in Bennett .
Variational methods in image processing are reviewed in Scherzer et al.
 and the Bayesian approach to this ﬁeld is exempliﬁed by Calvetti
and Somersalo and, implicitly, in Ellerbroek and Vogel . Variational methods are known in the atmospheric and oceanographic literature as 4DVAR methods and, as we have shown,
they are linked to probability maximizers. In the presence of model error
the method is known as weak constraint 4DVAR . There are
also variational methods for sequential problems which update the probability maximizer at a sequence of times; this methodology is known as 3DVAR
 and is closely related to ﬁltering. Indeed, although ﬁltering and variational methods may be viewed as competing methodologies,
Inverse problems
they are, in fact, not distinct methodologies, and hybrid methods are sought
which combine the advantages of both; see Kalnay, Li, Miyoshi, Yang and
Ballabrera-Poy , for example.
Although we strongly advocate the function space viewpoint on variational methods, a great deal of work is carried out by ﬁrst discretizing the
problem and then deﬁning the variational problem. Some representative
papers which take this approach for large-scale applications arising in ﬂuid
mechanics include Bennett and Miller , Bennett and Chua , Eknes and Evensen , Chua and Bennett , Yu and O’Brien ,
Watkinson, Lawless, Nichols and Roulstone , Gratton, Lawless and
Nichols , Johnson, Hoskins, Nichols and Ballard , Lawless and
Nichols , Johnson, Hoskins and Nichols , Lawless, Gratton and
Nichols , Stanton, Lawless, Nichols and Roulstone 
and Wlasak and Nichols . The paper of Griﬃth and Nichols 
contains an overview of adjoint methods, used in the solution of data assimilation problems with model error, primarily in the context of variational
A discussion of variational methods for the Lorenz equations,
and references to the extensive literature in this area, may be found in
Evensen .
The regularized nonlinear least-squares or Tikhonov approach to inverse
problems is widely studied, including in the inﬁnite-dimensional setting of
Hilbert spaces – see the book by Engl et al. and the references
therein – and Banach spaces – see the papers by Kaltenbacher et al. ,
Neubauer and Hein and the references therein. Although we
have concentrated on Bayesian priors, and hence on regularization via addition of a quadratic penalization term, there is active research in the use
of diﬀerent regularizations . In particular, the use of total variationbased regularization, and related wavelet-based regularizations, is central in
image processing .
Solving the very high-dimensional optimization problems which arise from
discretizing the minimization problem (5.3) is extremely challenging and,
as with ﬁltering methods, ideas from model reduction are frequently used to obtain faster algorithms.
Some applications of model reduction techniques, mainly to data assimilation problems arising in ﬂuid mechanics, may be found in Lawless, Nichols,
Boess and Bunse-Gerstner , Griﬃth and Nichols ,
Akella and Navon , Fang et al. and the references
therein. Another approach to dealing with the high-dimensional problems
that arise in data assimilation is to use ideas from machine learning to try to ﬁnd good quality low-dimensional approximations to
the posterior measure; see, for example, Shen et al. , Shen, Cornford,
Archambeau and Opper , Vrettas, Cornford and Shen , Shen,
A. M. Stuart
Archambeau, Cornford and Opper , Archambeau, Opper, Shen,
Cornford and Shawe-Taylor and Archambeau, Cornford, Opper and
Shawe-Taylor .
There are some applications where the objective functional may not be
diﬀerentiable.
This can arise for two primary reasons.
Firstly the PDE
model itself may have discontinuous features arising from switches, or shocklike solutions; and secondly the method of observing the PDE may have
switches at certain threshold values of the physical parameters. In this case
it is of interest to ﬁnd computational algorithms to identify MAP estimators
which do not require derivatives of the objective functional; see Zupanski,
Navon and Zupanski .
An overview of the algorithmic aspects of particle ﬁltering, for non-
Gaussian problems, is contained in the edited volume by Doucet and Gordon
 and a more mathematical treatment of the subject may be found in
Bain and Crisan . An introduction to ﬁltering in continuous time,
and a derivation of the Kalman–Bucy ﬁlter in particular, which exploits
the Gaussian structure of linear problems with additive Gaussian noise, is
undertaken in Oksendal . It should be emphasized that these methods are all developed primarily in the context of low-dimensional problems.
In practice ﬁltering in high-dimensional systems is extremely hard. This
is because the iterative formulae (5.13) and (5.16) do not express the density of the target measure with respect to an easily understood Gaussian
measure, as happens in (2.24). To overcome this issue, particle approximations of the reference measures are used, corresponding to approximation
by Dirac masses; thus the algorithms build up sequential approximations
based on Dirac masses. In high dimensions this can be extremely computationally demanding and various forms of approximation are employed to
deal with the curse of dimensionality. See Bengtsson, Bickel and Li 
and Bickel, Li and Bengtsson for discussion of the fundamental diﬃculties arising in high-dimensional ﬁltering, and Snyder, Bengtsson, Bickel
and Anderson for a development of these ideas in the context of
applications. A review of some recent mathematical developments in the
subject of high-dimensional ﬁltering, especially in the context of the modelling or turbulent atmospheric ﬂows, may be found in Majda, Harlim and
Gershgorin . A review of ﬁltering from the perspective of geophysical
applications, may be found in Van Leeuwen .
A widely used approach is that based on the ensemble Kalman ﬁlter , which
uses an ensemble of particles to propagate the dynamics, but incorporates
data using a Gaussian approximation which is hard to justify in general; see
also Berliner and Ott et al. . Further approaches based on the
use of ensembles to approximate error covariance propagation may be found
in Chorin and Krause and Livings, Dance and Nichols . The
Inverse problems
paper of Bengtsson, Snyder and Nychka describes a generalization
of the ensemble Kalman ﬁlter, based on mixtures of Gaussians, motivated
by the high-dimensional systems arising in ﬂuid dynamics data assimilation problems. The paper of Bennett and Budgell studies the use
of ﬁltering techniques in high dimensions, motivated by oceanographic data
assimilation, and contains a study of the question of how to deﬁne families
of ﬁnite-dimensional ﬁlters which converge to a function-space-valued limit
as the ﬁnite-dimensional computation is reﬁned; it is thus related to the
concept of discretization invariance referred to in Section 2.5. However, the
methodology for proving limiting behaviour in Bennett and Budgell ,
based on Fourier analysis, is useful only for linear Gaussian problems; in
contrast, the approach developed here, namely formulation of the inverse
problem on function space, gives rise to algorithms which are robust under
discretization even in the non-Gaussian case.
In Apte et al. and Apte, Jones and Stuart , studies of
the ideal solution obtained from applying MCMC methods to the posterior
(2.24) are compared with ensemble Kalman ﬁlter methods. The context is a
Lagrangian data assimilation problem driven by a low-dimensional truncation of the linearized shallow water equations (3.27) and the results demonstrate pitfalls in the ensemble Kalman ﬁlter approach. An unambiguous
and mathematically well-deﬁned deﬁnition of the ideal solution, as given by
(2.24), plays an important role in underpinning such computational studies.
A study of particle ﬁlters for Lagrangian data assimilation is undertaken in Spiller, Budhiraja, Ide and Jones , and another application of ﬁltering to oceanographic problems can be found in Brasseur et al.
Recent contributions to the study of ﬁltering in the context of
the high-dimensional systems of interest in geophysical applications include
Bergemann and Reich , Cui et al. , Chorin and Krause ,
Chorin and Tu , Majda and Grote , Majda and Gershgorin , Majda and Harlim and Van Leeuwen .
A comparison of various ﬁltering methods, for the Kuramoto–Sivashinsky
equation, may be found in Jardak, Navon and Zupanski . In the paper of Pikkarainen , ﬁltering is studied in the case where the the state
space for the dynamical variable is inﬁnite-dimensional, and modelled by an
SPDE. An attempt is made to keep track of the error made when approximating the inﬁnite-dimensional system by a ﬁnite-dimensional one. In this
regard, a useful approximation is introduced in Huttunen and Pikkarainen
 , building on ideas in Kaipio and Somersalo . Parameter estimation in the context of ﬁltering can be problematic, and smoothing should
ideally be used when parameters are also to be estimated. However, there
is some activity to try and make parameter estimation feasible in online
scenarios; see Hurzeler and K¨unsch for a general discussion and
Vossepoel and Van Leeuwen for an application.
A. M. Stuart
We conclude this bibliography by highlighting an important question confronting many applied disciplines for which data assimilation is important.
It is typically the case that models in ﬁelds such as climate prediction,
oceanography, oil reservoir simulation and weather prediction are not fully
resolved and various subgrid-scale models are used to compensate for this
fact. This then raises the question: ‘Should future increased computer resources be invested in further model resolution, or in more detailed study of
uncertainty?’ In the language of this section a stark version of this question
is as follows: ‘Should we employ only variational methods which identify
probability maximizers, but do not quantify risk, investing future computer
power in resolving the function space limit more fully? Or should we use
MCMC methods, which quantify risk and uncertainty very precisely, but
whose implementation is very costly and will preclude further model resolution?’ This is a hard question. An excellent discussion in the context of
climate models may be found in Palmer et al. .
6. Probability
6.1. Overview
This section contains an overview of the probabilistic ideas used throughout
the article. The presentation is necessarily terse and the reader is referred
to the bibliography subsection at the end for references to material containing the complete details. Section 6.2 describes a number of basic deﬁnitions
from the theory of probability that we will use throughout the article. In
Section 6.3 we introduce Gaussian measures on Banach spaces and describe
the central ideas of the Cameron–Martin space and the Fernique Theorem.
Section 6.4 describes some explicit calculations concerning Gaussian measures on Hilbert space. In particular, we discuss the Karhunen–Lo`eve expansion and conditioned Gaussian measures. The Karhunen–Lo`eve expansion
is a basic tool for constructing random draws from a Gaussian measure
on Hilbert space, and for analysing the regularity properties of such random draws.
Conditioned measures are key to the Bayesian approach to
inverse problems and the Gaussian setting provides useful examples which
help to build intuition. In Section 6.5 we introduce random ﬁelds and, in
the Gaussian case, show how these may be viewed as Gaussian measures
on vector ﬁelds. The key idea that we use from this subsection is to relate
the properties of the covariance operator to sample function regularity. In
Section 6.6 we describe Bayesian probability and a version of Bayes’ theorem appropriate for function space. This will underpin the approach to
inverse problems that we take in this article. We conclude, in Section 6.7,
with a discussion of metrics on probability measures, and describe properties of the Hellinger metric in particular. This will enable us to measure
Inverse problems
distance between pairs of probability measures, and is a key ingredient in
the deﬁnition of well-posed posterior measures described in this article.
In this section, and indeed throughout the article, we will use the following
notational conventions. The measure µ0 will denote a prior measure, and
π0 its density with respect to Lebesgue measure when the state space is Rn.
Likewise the measure µy will denote a posterior measure, given data y, and
πy its density with respect to Lebesgue measure when the state space is
Rn; occasionally we will drop the y dependence and write µ and π. Given
a density ρ(u, y) on a pair of jointly distributed random variables, we will
write ρ(u|y) (resp. ρ(y|u)) for the density of the random variable u (resp. y),
given a single observation of y (resp. u). We also write ρ(u) for the marginal
density found by integrating out y, and similarly ρ(y) for the marginal
density found by integrating out u. We will use similar conventions for other
densities, and the densities arising from conditioning and marginalization.
6.2. Basic concepts
A measure (resp. probability) space is a triplet (Ω, F, µ), where Ωis the
sample space, F the σ-algebra of events and µ the measure (resp. probability
measure). In this article we will primarily be concerned with situations in
which Ωis a separable Banach space (X, ∥·∥X) and F is the Borel σ-algebra
B(X) generated by the open sets, in the strong topology. We are interested
in Radon measures on X which are characterized by the property
µ(A) = sup
 B ⊂A, B compact
We use E and P to denote expectation and probability, respectively, and
E(·|·) and P(·|·) for conditional expectation and probability; on occasion we
will use the notation Eµ or Pµ if we wish to indicate that the expectation (or
probability) in question is with respect to a particular measure µ. We use
∼as shorthand for is distributed as; thus x ∼µ means that x is drawn from
a probability measure µ. A real-valued measurable function on the measure
space (Ω, F, µ) is one for which the pre-image of every Borel set in R is in
F (is µ-measurable).
A function m ∈X is called the mean of µ on Banach space X if, for all
ℓ∈X∗, where X∗denotes the dual space of linear functionals on X,
ℓ(x)µ(dx).
If m = 0 the measure is called centred. In the Hilbert space setting we
have that, for x ∼µ, m = Ex. A linear operator K : X∗→X is called the
covariance operator if, for all k, ℓ∈X∗,
k(x −m)ℓ(x −m)µ(dx).
A. M. Stuart
In the Hilbert space setting where X = X∗, the covariance operator is
characterized by the identity
⟨k, Kℓ⟩= E⟨k, (x −m)⟩⟨(x −m), ℓ⟩,
for x ∼µ and for all k, ℓ∈X. Thus
K = E(x −m) ⊗(x −m).
If µ and ν are two measures on the same measure space, then µ is absolutely continuous with respect to ν if ν(A) = 0 implies µ(A) = 0. This is
sometimes written µ ≪ν. The two measures are equivalent if µ ≪ν and
ν ≪µ. If the measures are supported on disjoint sets then they are mutually
singular or singular.
A family of measures µ(n) on Banach space X is said to converge weakly
to measure µ on X if
f(x)µ(n)(dx) →
for all continuous bounded f : E →R. We write µ(n) ⇒µ.4
The characteristic function of a probability distribution µ on a separable
Banach space X is, for ℓ∈X∗,
ϕµ(ℓ) = E exp(iℓ(x)).
Theorem 6.1.
If µ and ν are two Radon measures on a separable Banach
space X and if ϕµ(ℓ) = ϕν(ℓ) for all ℓ∈X∗, then µ = ν.
The following Radon–Nikodym Theorem plays an important role in this
Theorem 6.2. (Radon–Nikodym Theorem)
Let µ and ν be two measures on the same measure space (Ω, F). If µ ≪ν and ν is σ-ﬁnite then there
exists ν-measurable function f : Ω→[0, ∞] such that, for all ν-measurable
sets A ∈F,
f(x) dν(x).
The function f is known as the Radon–Nikodym derivative of µ with
respect to ν. The derivative is written as
dν (x) = f(x).
We will sometimes simply refer to f = dµ/dν as the density of µ with
4 This should not be confused with weak convergence of functions.
Inverse problems
respect to ν. If µ is also a probability measure then
1 = µ(Ω) =
f(x) dν(x).
Thus, if ν is a probability measure, Eνf(x) = 1.
We give an example which illustrates a key idea underlying the material
we develop in this section. We work in ﬁnite dimensions but highlight what
can be transferred to probability measures on a Banach space.
Example 6.3.
For a probability measure µ on Rd which is absolutely
continuous with respect to Lebesgue measure λ, we use the shorthand p.d.f.
for the probability density function, or density, ρ deﬁned so that
for A ∈F, where F is the sigma algebra generated by the open sets in Rd.
Strictly speaking this is the p.d.f. with respect to Lebesgue measure, as we
integrate the density against Lebesgue measure to ﬁnd the probability of a
set A. Note that
dλ(x) = ρ(x).
It is also possible to ﬁnd the density of µ with respect to a Gaussian measure. To illustrate this, let µ0 = N(0, I) denote a standard unit Gaussian
in Rd. Then
µ0(dx) = (2π)−d/2 exp
Thus the density of µ with respect to µ0 is
ρg(x) = (2π)d/2 exp
We then have the identities
ρg(x)µ0(dx)
(x) = ρg(x).
It turns out that, in the inﬁnite-dimensional setting, the formulation (6.5)
generalizes much more readily than does (6.4).
This is because inﬁnitedimensional Gaussian measure is well-deﬁned, and because many measures
have a density (Radon–Nikodym derivative) with respect to an inﬁnitedimensional Gaussian measure. In contrast, inﬁnite-dimensional Lebesgue
measure does not exist.
A. M. Stuart
We conclude this subsection with two deﬁnitions of operators, both important for deﬁnitions associated with Gaussian measures on Hilbert space.
k=1 denote an orthonormal basis for a separable Hilbert space H.
A linear operator A : H →H is trace-class or nuclear if
⟨Aφk, φk⟩< ∞.
The sum is independent of the choice of basis. The operator A is Hilbert–
Schmidt if
∥Aφk∥2 < ∞.
If A is self-adjoint and we choose the {φk} to be the eigenfunctions of A,
then the sum in (6.6) is simply the sum of the eigenvalues of A. A weaker
condition is that the eigenvalues are square-summable, which is (6.7).
6.3. Gaussian measures
We will primarily employ Gaussian measures in the Hilbert space setting.
However, they can also be deﬁned on Banach spaces and, on occasion, we
will employ this level of generality. Indeed, when studying Gaussian random
ﬁelds in Section 6.5, we will show that, for a Gaussian measure µ on a Hilbert
space H, there is often a Banach space X which is continuously embedded
in H and has the property that µ(X) = 1. We would then like to deﬁne
the measure µ on the Banach space X. We thus develop Gaussian measure
theory on separable Banach spaces here.
Having deﬁned Gaussian measure, we describe its characteristic function and we state the Fernique Theorem, which exploits tail properties of
Gaussian measure.
We follow this with deﬁnition and discussion of the
Cameron–Martin space. We then describe the basic tools required to study
the absolute continuity of two Gaussian measures.
A measure µ on (X, B(X)) is Gaussian if, for any ℓ∈X∗, ℓ(x) ∼
ℓ) for some mℓ∈R, σℓ∈R. Note that σℓ= 0 is allowed, so that the
induced measure on ℓ(x) may be a Dirac mass at mℓ. Note also that it is expected that mℓ= ℓ(m), where m is the mean deﬁned above, and σ2
where K is the covariance operator. The mean m and covariance operator
K are indeed well-deﬁned by this deﬁnition of covariance operator.
Theorem 6.4.
A Gaussian measure on (X, B(X)) has a mean m and covariance operator K. Further, the characteristic function of the measure is
ϕ(ℓ) = exp
Hence, by Theorem 6.1 we see that the mean and covariance completely
Inverse problems
characterize the Gaussian measure, and so we are justiﬁed in denoting it by
N(m, K). The following lemma demonstrates an important role for characteristic functions in studying weak convergence.
Lemma 6.5.
Consider a family of probability measures µ(n).
that, for all ℓ∈X∗,
ϕµ(n)(ℓ) →exp
Then µ(n) ⇒N(m+, K+).
In the Hilbert space setting we refer to the inverse of the covariance operator C as the precision operator and denote it by L. It is natural to ask
what conditions an operator must satisfy in order to be a covariance operator. Good intuition can be obtained by thinking of the precision operator
as a (possibly) fractional diﬀerential operator of suﬃciently high order. To
pursue this issue a little further we conﬁne ourselves to the Hilbert space
setting. The following theorem provides a precise answer to the question
concerning properties of the covariance operator.
Theorem 6.6.
If N(0, C) is a Gaussian measure on a Hilbert space H,
then C is a self-adjoint, positive semi-deﬁnite trace-class operator on H.
Furthermore, for any integer p, there is a constant C = Cp ⩾0 such that,
for x ∼N(0, C),
E∥x∥2p ⩽Cp(Tr(C))p.
Conversely, if m ∈H, and C is a self-adjoint, positive semi-deﬁnite, traceclass linear operator on a Hilbert space H, then there is a Gaussian measure
µ = N(m, C) on H.
Example 6.7.
Unit Brownian bridge on J = (0, 1) may be viewed as
a Gaussian process on L2(J) with precision operator L = −d2/dx2 and
D(L) = H2(J)
0(J). Thus the eigenvalues of C are γk = (k2π2)−1 and
are summable.
If x ∼N(0, C), then E∥x∥2 = Tr(C). Combining this fact with the previous theorem we have the following generalization of the well-known property
concerning the moments of ﬁnite-dimensional Gaussian measures.
Corollary 6.8.
If N(0, C) is a Gaussian measure on a Hilbert space H
then, for any positive integer p, there exists Cp ⩾0 such that E∥x∥2p ⩽
Cp(E∥x∥2)p.
In fact, as in ﬁnite dimensions, the exponentials of certain quadratic functionals are bounded for Gaussian measures. This is the Fernique Theorem,
which we state in the Banach space context.
A. M. Stuart
Theorem 6.9. (Fernique Theorem)
If µ = N(0, K) is a Gaussian measure on Banach space X, so that µ(X) = 1, then there exists α > 0 such
µ(dx) < ∞.
We deﬁne the Cameron–Martin space E associated with a Gaussian measure µ = N(0, K) on Banach space X to be the intersection of all linear
spaces of full measure under µ.5
Lemma 6.10.
Let E be the Cameron–Martin space of Gaussian measure
µ = N(0, K) on Banach space X. In inﬁnite dimensions it is necessarily
the case that µ(E) = 0. Furthermore, E can be endowed with a Hilbert
space structure. Indeed, for Gaussian measures N(0, C) on the Hilbert space
(H, ⟨·, ·⟩), the Cameron–Martin space is the Hilbert space E := Im(C1/2)
with inner product
⟨·, ·⟩C = ⟨C−1/2·, C−1/2·⟩.
Note that the covariance operator C of a Gaussian probability measure on
a Hilbert space H is necessarily compact because C is trace-class, so that the
eigenvalues of C1/2 decay at least algebraically. Thus the Cameron–Martin
space Im(C1/2) is compactly embedded in H. In fact we have the following
more general result.
Theorem 6.11.
The Cameron–Martin space E associated with a Gaussian measure µ = N(0, K) on Banach space X is compactly embedded in
all separable Banach spaces X′ with full measure (µ(X′) = 1) under µ. ⋄
Example 6.12.
Consider a probability measure ν on R2 which is a product measure of the form δ0 ⊗N(0, 1). Introduce coordinates (x1, x2) so that
the marginal on x1 is δ0 and the marginal on x2 is N(0, 1). The intersection
of all linear spaces with full measure is the subset of R2 deﬁned by the line
E = {(x1, x2) ∈R2 : x1 = 0}.
Note, furthermore, that this subset is characterized by the property that
the measures ν(·) and ν(a + ·) are equivalent (as measures) if and only if
a ∈E. Thus, for this example, the Cameron–Martin space deﬁnes the space
of allowable shifts, under which equivalence of the measures holds.
We now generalize the last observation in the preceding example: we show
that the Cameron–Martin space characterizes precisely those shifts in the
mean of a Gaussian measure which preserve equivalence.
5 In most developments of the subject this characterization is given after a more abstract deﬁnition of the Cameron–Martin space. However, for our purposes this level of
abstraction is not needed.
Inverse problems
Theorem 6.13.
Two Gaussian measures µi = N(mi, Ci), i = 1, 2, on a
Hilbert space H are either singular or equivalent. They are equivalent if
and only if the following three conditions hold:
(i) Im(C1/2
) = Im(C1/2
(ii) m1 −m2 ∈E,
(iii) the operator T :=
∗−I is Hilbert–Schmidt
In particular, choosing C1 = C2 we see that shifts in the mean give rise to
equivalent Gaussian measures if and only if the shifts lie in the Cameron–
Martin space E. It is of interest to characterize the Radon–Nikodym derivative arising from such shifts in the mean.
Theorem 6.14.
Consider two measures µi = N(mi, C), i = 1, 2, on
Hilbert space H, where C has eigenbasis {φk, λk}∞
k=1. Denote the Cameron–
Martin space by E. If m1 −m2 ∈E, then the Radon–Nikodym derivative
is given by
⟨m1 −m2, x −m2⟩C −1
2∥m1 −m2∥2
Since m1 −m2 ∈Im(C1/2), the quadratic form ∥m1 −m2∥2
C is deﬁned; the
random variable x →⟨m1 −m2, x−m2⟩C is deﬁned via a limiting procedure
as follows. By the the Karhunen–Lo`eve expansion (6.9) below, we have the
representation of x ∼N(0, C) as
where ω = {ωk}∞
k=1 ∈Ωis an i.i.d. sequence of N(0, 1) random variables.
Then ⟨m1 −m2, x −m2⟩C is deﬁned as the L2(Ω; H) limit in n of the series
⟨m1 −m2, φk⟩ωk.
In establishing the ﬁrst of the conditions in Theorem 6.13, the following
lemma is often useful.
Lemma 6.15.
For any two positive deﬁnite, self-adjoint, bounded linear operators Ci on a Hilbert space H, i = 1, 2, the condition Im(C1/2
) holds if and only if there exists a constant K > 0 such that
⟨h, C1h⟩⩽K⟨h, C2h⟩,
Example 6.16.
Consider two Gaussian measures µi on H = L2(J), J =
(0, 1) both with precision operator L = −d2/dx2 and the domain of L being
0(J) ∩H2(J). (Informally −L is the Laplacian on J with homogeneous
A. M. Stuart
Dirichlet boundary conditions.) The mean of µ1 is a function m ∈H and
the mean of µ2 is 0. Thus µ1 ∼N(m, C) and µ2 ∼N(0, C), where C = L−1.
Here C1 = C2 = C and T = 0, so that (i) and (iii) in Theorem 6.13 are
satisﬁed with E = Im (C1/2) = H1
0(J). It follows that the measures are
equivalent if and only if m ∈E. If this condition is satisﬁed then, from
Theorem 6.14, the Radon–Nikodym derivative between the two measures is
Example 6.17.
Consider two mean zero Gaussian measures µi on H =
L2(J), J = (0, 1) with norm ∥· ∥and precision operators L1 = −d2/dx2 + I
and L2 = −d2/dx2 respectively, both with domain H1
0(J) ∩H2(J).
The operators L1, L2 share the same eigenfunctions,
2 sin(kπx),
and have eigenvalues
λk(1) = λk(2) + 1,
λk(2) = k2π2,
respectively. Thus µ1 ∼N(0, C1) and µ2 ∼N(0, C2) where, in the basis of
eigenfunctions, C1 and C2 are diagonal with eigenvalues
respectively. We have, for hk = ⟨h, φk⟩,
π2 + 1 ⩽⟨h, C1h⟩
k∈Z+(1 + k2π2)−1h2
k∈Z+(kπ)−2h2
Thus, by Lemma 6.15, Theorem 6.13(i) is satisﬁed. Part (ii) holds trivially.
Notice that
is diagonalized in the same basis as the Ci, and has eigenvalues
These are square-summable, and so part (iii) of Theorem 6.13 holds and the
two measures are absolutely continuous with respect to one another.
A Hilbert space (X, ⟨·, ·⟩X) of functions f : D ⊂Rd →R is called a
reproducing kernel Hilbert space, RKHS for short, if pointwise evaluation is
a continuous linear functional in the Hilbert space. If f(y) = ⟨f, ry⟩X, then
ry is called the representer of the RKHS.
Inverse problems
Example 6.18.
Let J = (0, 1). Note that H = L2(J; R) is not an RKHS.
Consider X = H1(J; R) equipped with the inner product
(a, b) = a(0)b(0) +
a′(x)b′(x) dx.
If ry(x) = 1 + x ∧y then f(y) = (f, ry). Notice that ry ∈X. Thus, by the
Cauchy–Schwarz inequality,
|f(y) −g(y)| ⩽|(f −g, ry)|
⩽∥f −g∥X∥ry∥X,
demonstrating that pointwise evaluation is a continuous linear functional
on X. Notice, furthermore, that the expression f(y) = (f, ry) is an explicit
statement of the Riesz Representation Theorem.
In the literature there is often an overlap of terminology surrounding the
RKHS and the Cameron–Martin space.
This is related to the fact that
the representer of an RKHS can often be viewed as the covariance function
(see Section 6.5 below) of a covariance operator associated to a Gaussian
measure on L2(D; R).
6.4. Explicit calculations with Gaussian measures
In this section we conﬁne our attention to Gaussian measures on Hilbert
space. We provide a number of explicit formulae that are helpful throughout
the article, and which also help to build intuition about measures on inﬁnitedimensional spaces.
We can construct random draws from a Gaussian measure on Hilbert
space H as follows, using the Karhunen–Lo`eve expansion.
Theorem 6.19.
Let C be a self-adjoint, positive semi-deﬁnite, nuclear
operator in a Hilbert space H and let m ∈H.
Let {φk, γk}∞
orthonormal set of eigenvectors/eigenvalues for C ordered so that
γ1 ⩾γ2 ⩾· · · .
Take {ξk}∞
k=1 to be an i.i.d. sequence with ξ1 ∼N(0, 1). Then the random
variable x ∈H given by the Karhunen–Lo`eve expansion
is distributed according to µ = N(m, C).
In applications the eigenvalues and eigenvectors of C will often be indexed
over a diﬀerent countable set, say K. In this context certain calculations are
A. M. Stuart
cleaner if we write the Karhunen–Lo`eve expansion (6.9) in the form
Here the {ξk}k∈K are an i.i.d. set of random variables all distributed as
N(0, 1). Of course, the order of summation does, in general, matter; whenever we use (6.10), however, the ordering will not be material to the outcome
and will streamline the calculations to use (6.10).
The next theorem concerns conditioning of Gaussian measures.
Theorem 6.20.
Let H = H1 ⊕H2 be a separable Hilbert space with
projectors Πi : H →Hi. Let (x1, x2) ∈H1 ⊕H2 be an H-valued Gaussian
random variable with mean m = (m1, m2) and positive deﬁnite covariance
operator C. Deﬁne
Cij = E(xi −mi) ⊗(xj −mj).
Then the conditional distribution of x1 given x2 is Gaussian with mean
m′ = m1 + C12C−1
22 (x2 −m2)
and covariance operator
C′ = C11 −C12C−1
To understand this theorem it is useful to consider the following ﬁnitedimensional result concerning block matrix inversion.
Lemma 6.21.
Consider a positive deﬁnite matrix C with the block form
Then C22 is positive deﬁnite symmetric and the Schur complement S deﬁned
by S = C11 −C12C−1
12 is positive deﬁnite symmetric. Furthermore,
−S−1C12C−1
12S−1C12C−1
Now let (x, y) be jointly Gaussian with distribution N(m, C) and m =
2)∗. Then the conditional distribution of x given y is Gaussian with
mean m′ and covariance matrix C′ given by
m′ = m1 + C12C−1
22 (y −m2),
C′ = C11 −C12C−1
Inverse problems
Example 6.22.
Consider a random variable u with Gaussian prior probability distribution N(0, 1), and hence associated p.d.f.
π0(u) ∝exp
Let y be the random variable y = u + ξ, where ξ ∼N(0, σ2) is independent
of u. Then the likelihood of y given u has p.d.f. proportional to
2σ2 |y −u|2
The joint probability of (u, y) thus has p.d.f. proportional to
2σ2 |y −u|2 −1
2σ2 |y −u|2 + 1
where cy is independent of u, we see that the u|y is a Gaussian N(m, γ2)
This technique for deriving the mean and covariance of a Gaussian measure
is often termed completing the square; it may be rigorously justiﬁed by
Theorem 6.20 as follows. First we observe that m1 = m2 = 0, that C11 =
C12 = C21 = 1 and that C22 = 1 + σ2. The formulae (6.11) and (6.12) then
give identical results to those found by completing the square.
We now study an inﬁnite-dimensional version of the previous example.
Example 6.23.
Consider a random variable u on a Hilbert space H distributed according to a measure µ0 ∼N(m0, C0). We assume that m0 ∈
). Assume that y ∈Rm is also Gaussian and is given by
y = Au + η,
where A : X →Rm is linear and continuous on a Banach space X ⊆H
with µ0(X) = 1. The adjoint of A, denoted A∗, is hence the operator from
Rm →X∗deﬁned by the identity
⟨Au, v⟩= (A∗v)(u),
which holds for all v ∈Rm, u ∈X, and where A∗v ∈X∗is a linear functional
We also assume that η ∼N(0, Γ) is independent of u and that
Γ is positive deﬁnite. Thus y|u is Gaussian with density proportional to
. We would like to characterize the Gaussian measure µy
A. M. Stuart
for u|y. Let µy = N(m, C). To calculate C and m we ﬁrst use the idea of
completing the square, simply computing formally as if the Hilbert space
for u were ﬁnite-dimensional and had a density with respect to Lebesgue
measure; we will then justify the resulting formulae after the fact by means
of Theorem 6.20. The formal Lebesgue density for u|y is proportional to
with cy independent of u, and hence completing the square gives
C−1 = A∗Γ−1A + C−1
m = C(A∗Γ−1y + C−1
We now justify this informal calculation.
The pair (u, y) is jointly Gaussian with Eu = m0 and Ey = Am0. We
deﬁne u = u −m0 and y = y −Am0. Note that y = Au + η. The pair (u, y)
has covariance operator with components
C11 = Euu∗= C0,
C22 = Eyy∗= AC0A∗+ Γ,
C21 = Eyu∗= AC0.
Thus, by Theorem 6.20, we deduce that the mean m and covariance operator
C for u conditional on y are given, respectively, by
m = m0 + C0A∗(Γ + AC0A∗)−1(y −Am0)
C = C0 −C0A∗(Γ + AC0A∗)−1AC0.
We now demonstrate that the formulae (6.14) and (6.15) agree with (6.13).
To check agreement with the formula for the inverse of C found by completing the square, we show that the product is indeed the identity. Note that
C0 −C0A∗(Γ + AC0A∗)−1AC0
I −C0A∗(Γ + AC0A∗)−1A
(I + C0A∗Γ−1A)
= I + C0A∗Γ−1A −C0A∗(Γ + AC0A∗)−1(A + AC0A∗Γ−1A)
= I + C0A∗Γ−1A −C0A∗Γ−1A
To check agreement with the two formulae for the mean, we proceed as
follows. We have
Γ−1 −(Γ + AC0A∗)−1AC0A∗Γ−1 = (Γ + AC0A∗)−1.
Inverse problems
The formula for the mean derived by completing the square gives
(C−1 −A∗Γ−1A)m0 + A∗Γ−1y
= m0 + CA∗Γ−1(y −Am0).
To get agreement with the formula (6.14) it suﬃces to show that
CA∗Γ−1 = C0A∗(Γ + AC0A∗)−1.
By (6.15) and (6.16),
CA∗Γ−1 = C0A∗Γ−1 −C0A∗(Γ + AC0A∗)−1AC0A∗Γ−1
= C0A∗(Γ + AC0A∗)−1,
and we are done.
6.5. Gaussian random ﬁelds
Our aim in this subsection is to construct, and study the properties of,
Gaussian random functions. We ﬁrst consider the basic construction of random functions, then Gaussian random functions, following this by a study
of the regularity properties of Gaussian random functions.
Let (Ω, F, P) be a probability space and D ⊆Rd an open set. A random
ﬁeld on D is a measurable mapping u : D × Ω→Rn. Thus, for any x ∈D,
u(x; ·) is an Rn-valued random variable; on the other hand, for any ω ∈Ω,
u(·; ω) : D →Rn is a vector ﬁeld. In the construction of random ﬁelds it is
commonplace to ﬁrst construct the ﬁnite-dimensional distributions. These
are found by choosing any integer q ⩾1, and any set of points {xk}q
D, and then considering the random vector (u(x1; ·)∗, . . . , u(xq; ·)∗)∗∈Rnq.
From the ﬁnite-dimensional distributions of this collection of random vectors
we would like to be able to make sense of the probability measure µ on X,
a Banach space, via the formula
µ(A) = P(u(·; ω) ∈A),
where ω is taken from a common probability space on which the random
element u ∈X is deﬁned. It is thus necessary to study the joint distribution of a set of q Rn-valued random variables, all on a common probability
space. Such Rnq-valued random variables are, of course, only deﬁned up
to a set of zero measure.
It is desirable that all such ﬁnite-dimensional
distributions are deﬁned on a common subset Ω0 ⊂Ωwith full measure,
so that u may be viewed as a function u : D × Ω0 →Rn; such a choice of
random ﬁeld is termed a modiﬁcation. In future developments, statements
about almost sure (regularity) properties of a random ﬁeld should be interpreted as statements concerning the existence of a modiﬁcation possessing
the stated almost sure regularity property. We will often simply write u(x),
suppressing the explicit dependence on the probability space.
A. M. Stuart
A Gaussian random ﬁeld is one where, for any integer q ⩾1, and any set
of points {xk}q
k=1 in D, the random vector (u(x1; ·)∗, . . . , u(xq; ·)∗)∗∈Rnq
is a Gaussian random vector. The mean function of a Gaussian random
ﬁeld is m(x) = Eu(x).
The covariance function is c(x, y) = E(u(x) −
m(x))(u(y) −m(y))∗. For Gaussian random ﬁelds this function, together
with the mean function, completely specify the joint probability distribution for (u(x1; ·)∗, . . . , u(xq)∗)∗∈Rnq. Furthermore, if we view the Gaussian
random ﬁeld as a Gaussian measure on L2(D; Rn), then the covariance operator can be constructed from the covariance function as follows. Without
loss of generality we consider the mean zero case; the more general case
follows by shift of origin. Since the ﬁeld has mean zero we have, from (6.1),
⟨h1, Ch2⟩= E⟨h1, u⟩⟨u, h2⟩
h1(x)∗(u(x)u(y)∗)h2(y) dy dx
(u(x)u(y)∗)h2(y) dy
c(x, y)h2(y) dy
and we deduce that
c(x, y)φ(y) dy.
Thus the covariance operator of a Gaussian random ﬁeld is an integral
operator with kernel given by the covariance function.
If we view the Gaussian random ﬁeld as a measure on the space X =
C(D; Rn), then the covariance operator K : X∗→X may also be written
as an integral operator as follows. For simplicity we consider the case n = 1.
We note that ℓ= ℓµ ∈X∗may be identiﬁed with a signed measure µ on D.
Then similar arguments to those used in the Hilbert space case show that
(Kℓµ)(x) =
c(x, y)µ(dy).
This may be extended to the case of random ﬁelds taking values in Rn.
A mean zero Gaussian random ﬁeld is termed stationary if c(x, y) =
s(x −y) for some matrix-valued function s, so that shifting the ﬁeld by
a ﬁxed random vector does not change the statistics. It is isotropic if, in
addition, s(x −y) = ι(|x −y|), for some matrix-valued function ι.
An important general question concerning random ﬁelds is to ﬁnd criteria
to establish their regularity, expressed in terms of the covariance function
or operator. An important tool in this context is the Kolmogorov Continuity Theorem, which follows below. This theorem expresses sample function
regularity in terms of the covariance function of the random ﬁeld. Another
Inverse problems
key tool in establishing regularity is the Karhunen–Lo`eve expansion (6.10),
which expresses a random draw from a Gaussian measure in terms of the
eigenfunctions and eigenvalues of the covariance operator and may be used
to express sample function regularity in terms of the decay of the eigenvalues
of the covariance operator. Both these approaches to sample function regularity, one working from the covariance functions, and one from eigenvalues
of the covariance operator, are useful in practice when considering Bayesian
inverse problems for functions; this is because prior Gaussian measures may
be speciﬁed via either the covariance function or the covariance operator.
Theorem 6.24. (Kolmogorov Continuity Theorem) Consider an Rnvalued random ﬁeld u on a bounded open set D ⊂Rd. Assume that there
are constants K, ε > 0 and δ ⩾1 such that
E|u(x) −u(y)|δ ⩽K|x −y|2d+ε.
Then u is almost surely H¨older-continuous on D with any exponent smaller
than min{1, ε/δ}.
In this article we mainly work with priors speciﬁed through the covariance operator on a simple geometry, as this makes the exposition more
straightforward. Speciﬁcally, we consider covariance operators constructed
as fractional powers of operators A whose leading-order behaviour is like
that of the Laplacian on a rectangle. Precisely, we will assume that Assumptions 2.9 hold.
By using the Kolmogorov Continuity Theorem we can now prove the
following.
Lemma 6.25.
Let A satisfy Assumptions 2.9(i)–(iv). Consider a Gaussian measure µ = N(0, C) with C = A−α with α > d/2. Then u ∼µ is
almost surely s-H¨older-continuous for any exponent s < min{1, α −d/2}.
The Karhunen–Lo`eve expansion (6.10) shows that
|λk|α/2 ξkφk(x).
Thus, for any ι > 0 and for C a (possibly changing) constant independent
of t, x and ξ,
E|u(x + h) −u(x)|2 ⩽C
|k|2α |φk(x + h) −φk(x)|2
|k|2α min{|k|2|h|2, 1}
|k|2α min{|k|2|h|2, 1} dk
A. M. Stuart
1⩽|k|⩽|h|−ι |k|2(1−α)|h|2 dk + C
|k|⩾|h|−ι |k|−2α dk
rd−1+2(1−α) dr + C
|h|−ι rd−1−2α dr
|h|2−ι(d+2(1−α)) + |h|−ι(d−2α)
Making the optimal choice ι = 1 gives
E|u(x + h) −u(x)|2 ⩽C|h|2α−d.
Thus, by Corollary 6.8 with H = Rn,
E|u(x) −u(y)|2p ⩽C|x −y|(2α−d)p
for any p ∈N. Choosing the exponents δ = 2p and ε = (2α −d)p −2d and
letting p →∞, we deduce from Theorem 6.24 that the function is s-H¨older
with any exponent s as speciﬁed.
Example 6.26.
Assume that a Gaussian random ﬁeld with measure µ has
the property that, for X = C(D; Rn), µ(X) = 1. Then the Cameron–Martin
space for this measure, denoted by (E, ⟨·, ·⟩E), is compactly embedded in
X, by Theorem 6.11, and hence there is a constant C > 0 such that
∥· ∥X ⩽C∥· ∥E.
Thus pointwise evaluation is a continuous linear functional on the Cameron–
Martin space so that this space may be viewed as an RKHS.
As an example consider the Gaussian measure N(0, βA−α) on H, with
A satisfying Assumptions 2.9(i)–(iv).
Then µ(X) = 1 for α > d/2 by
Lemma 6.25. The Cameron–Martin space is just Hα. This shows that the
space Hα is compactly embedded in the space of continuous functions, for
α > d/2. (Of course, a related fact follows more directly from the Sobolev
Embedding Theorem, Theorem 2.10.)
We now turn to Sobolev regularity, again using the Karhunen–Lo`eve expansion. Recall the Sobolev-like spaces (2.29) deﬁning Hs = D(As/2).
Lemma 6.27.
Consider a Gaussian measure µ = N(0, A−α), where A
satisﬁes Assumptions 2.9(i)–(iii) and α > d/2. Then u ∼µ is in Hs almost
surely for any s ∈[0, α −d/2).
The Karhunen–Lo`eve expansion (6.10) shows that
with {ξk} an i.i.d. N(0, 1)-sequence and γk = λ−α
Inverse problems
If the sum is ﬁnite then E∥u∥2
s < ∞and u ∈Hs µ-a.s. We have
Since the eigenvalues λk of A grow like |k|2, we deduce that this sum is
ﬁnite if and only if α > s + d/2, by comparison with an integral.
It is interesting that the H¨older and Sobolev exponents predicted by Lemmas 6.25 and Lemma 6.27 agree for d/2 < α < d/2+1. The proof of H¨older
regularity uses Gaussianity in a fundamental way to obtain this property.
In particular, in the proof of Lemma 6.25, we use the fact that the second
moment of Gaussians can be used to bound arbitrarily high moments. Note
that using the Sobolev Embedding Theorem, together with Lemma 6.27, to
determine H¨older properties does not, of course, give results which are as
sharp as those obtained from Lemma 6.25. For example, using Lemma 6.27
and Theorem 2.10 shows that choosing α > d ensures that u is almost surely
continuous. On the other hand Lemma 6.25 shows that choosing α = d ensures that u is almost surely H¨older-continuous with any exponent less than
d/2; in particular, u is almost surely continuous.
Example 6.28.
Consider the case d = 2, n = 1 and D = 2. Deﬁne
the Gaussian random ﬁeld through the measure µ = N(0, (−△)−α), where
△is the Laplacian with domain H1
0(D)∩H2(D). Then Assumptions 2.9 are
satisﬁed by −△. By Lemma 6.27 it follows that choosing α > 1 suﬃces to
ensure that draws from µ are almost surely in L2(D). Then, by Lemma 6.25,
it follows that, in fact, draws from µ are almost surely in C(D).
In many applications in this article we will be interested in constructing a
probability measure µ on a Hilbert space H which is absolutely continuous
with respect to a given reference Gaussian measure µ0. We can then write,
via Theorem 6.2,
The Theorem 6.14 provides an explicit example of this structure when µ
and µ0 are both Gaussian. For expression (6.20) to make sense we require
that the potential Φ : H →R is µ0-measurable. Implicit in the statement
of Theorem 6.14 is just such a measurability property of the logarithm of
the density between the two Gaussian measures. We return to the structure (6.20) again, in the case where µ is not necessarily Gaussian, in the
next subsection.
6.6. Bayesian probability
Bayesian probability forms the underpinnings of the approach to inverse
problems taken in this article. In this subsection we ﬁrst discuss the general
A. M. Stuart
concept of conditioned measures.
We then turn to Bayesian probability
in the ﬁnite-dimensional case, and ﬁnally generalize Bayes’ theorem to the
function space setting. The following theorem is of central importance.
Theorem 6.29.
Let µ, ν be probability measures on S × T, where (S, A)
and (T, B) are measurable spaces. Let (x, y), with x ∈S and y ∈T, denote
an element of S × T. Assume that µ ≪ν and that µ has Radon–Nikodym
derivative φ with respect to ν. Assume further that the conditional distribution of x|y under ν, denoted by νy(dx), exists.
Then the conditional
distribution of x|y under µ, denoted µy(dx), exists and µy ≪νy. The
Radon–Nikodym derivative is given by
c(y)φ(x, y)
if c(y) > 0, and
with c(y) =
S φ(x, y) dνy(x) for all y ∈T.
Given a probability triplet (Ω, F, P) and two sets A, B ∈F with P(A) >
0, P(B) > 0, we deﬁne the probabilities of A given B and B given A by
P(B)P(A ∩B),
P(A)P(A ∩B).
Combining gives Bayes’ formula:
P(B)P(B|A)P(A).
If (u, y) ∈Rd × Rℓis a jointly distributed pair of random variables with
Lebesgue density ρ(u, y), then the inﬁnitesimal version of the preceding
formula tells us that
ρ(u|y) ∝ρ(y|u)ρ(u),
and where the normalization constant depends only on y. Thus
ρ(y|u)ρ(u)
Rd ρ(y|u)ρ(u) du.
This gives an expression for the probability of a random variable u, given
a single observation of a random variable y, which requires knowledge of
only the prior (unconditioned) probability density ρ(u) and the conditional
probability density ρ(y|u) of y given u. Both these expressions are readily
available in many modelling scenarios, as we demonstrate in Section 3. This
observation is the starting point for the Bayesian approach to probability.
Furthermore, there is a wide range of sampling methods which are designed
Inverse problems
to sample probability measures known only up to a multiplicative constant
(see Section 5), and knowledge of the normalization constant is not required
in this context: the formula (6.23) may be used directly to implement these
algorithms. Recall that in the general Bayesian framework introduced in
Section 1 we refer to the observation y as data and to ρ(y|u) as the likelihood
of the data.
Example 6.30.
Consider Example 6.22. The random variable (u, y) is
distributed according to a measure µ0(u, y), which has density with respect
to Lebesgue measure given by
π0(u, y) =
2σ2 |y −u|2
By completing the square we showed that the posterior probability measure
for u given y is µ0(u|y) with density
This result also follows from (6.23), which shows that
Rd π(u, y) du.
Now consider a random variable (u, y) distributed according to measure
µ(u, y), which has density ρ(u, y) with respect to µ0(u, y). We assume that
ρ > 0 everywhere on Rd × Rℓ. By Theorem 6.29 the random variable found
by conditioning u from µ on y has density
Rd ρ(u, y)π0(u|y) du
with respect to π0(u|y).
The expression (6.23) may be rewritten to give an expression for the ratio
of the posterior and prior p.d.f.s:
ρ(u) ∝ρ(y|u),
with constant of proportionality which depends only on y, and not on u.
Stated in this way, the formula has a natural generalization to inﬁnite dimensions, as we now explain.
Let u be a random variable distributed according to measure µ0 on a
separable Banach space (X, ∥·∥). We assume that the data y ∈Rm is given
in terms of the observation operator G by the formula y = G(u)+η, where η ∈
Rm is independent of u and has density ρ with respect to Lebesgue measure;
A. M. Stuart
for simplicity we assume that the support of ρ is Rm. Deﬁne Φ(u; y) to be
any function which diﬀers from −log(ρ(y −G(u))) by an additive function
of y only. Hence it follows that
ρ(y −G(u))
with constant of proportionality independent of u. Use of Bayes’ rule in the
form (6.25) suggests that the probability measure for u given y, denoted
µy(du), has Radon–Nikodym derivative with respect to µ0 given by
We refer to such an argument as informal application of Bayes’ rule. We
now justify the formula rigorously.
Theorem 6.31.
Assume that G : X →Rm is continuous, that ρ has
support equal to Rm and that µ0(X) = 1. Then u|y is distributed according
to the measure µy(du), which is absolutely continuous with respect to µ0(du)
and has Radon–Nikodym derivative given by (6.26).
Throughout the proof C(y) denotes a constant depending on y, but
not on u, and possibly changing between occurrences. Let Q0(dy) = ρ(y) dy
and Q(dy|u) = ρ(y −G(u)) dy. By construction,
(y|u) = C(y) exp
with constant of proportionality independent of u. Now deﬁne
ν0(dy, du) = Q0(dy) ⊗µ0(du),
ν(dy, du) = Q(dy|u)µ0(du).
Note that ν0 is a product measure under which u and y are independent
random variables. Since G : X →Rm is continuous we deduce that Φ :
X →R is continuous and hence, since µ0(X) = 1, µ0-measurable. Thus ν
is well-deﬁned and is absolutely continuous with respect to ν0 with Radon–
Nikodym derivative
(y, u) = C(y) exp
again the constant of proportionality depends only on y. Note that
µ0(du) = C(y)
ρ(y −G(u))µ0(du) > 0
since ρ > 0 everywhere on Rm and since G : X →Rm is continuous. By
Theorem 6.29 we have the desired result, since ν0(du|y) = µ0(du).
Inverse problems
Remark 6.32.
Finally we remark that, if µy is absolutely continuous with
respect to µ0 then any property which holds almost surely under µ0 will also
hold almost surely under µy. The next example illustrates how useful this
Example 6.33.
Let µ0 denote the Gaussian random ﬁeld constructed in
Example 6.28, with α > 1 so that draws from µ0 are almost surely continuous. Now imagine that we observe y, the L2(D)-norm of u drawn from µ0,
subject to noise η:
y = ∥u∥2 + η.
We assume that η ∼N(0, γ2), independently of u. The L2(D)-norm is a
continuous function on X = C(D) and µ0(X) = 1; hence evaluation of
the L2(D)-norm is µ0-measurable, and the measure µy(du) = P(du|y) is
absolutely continuous with respect to µ0, with Radon–Nikodym derivative
y −∥u∥22
Note that the probability measure µy is not Gaussian. Nonetheless, any
function drawn from µy is almost surely in C(D).
6.7. Metrics on measures
In Section 4 it will be important to estimate the distance between two probability measures and thus we will be interested in metrics which measure
distance between probability measures.
In this section we introduce two useful metrics on measures: the total
variation distance and the Hellinger distance. We discuss the relationships
between the metrics and indicate how they may be used to estimate diﬀerences between expectations of random variables under two diﬀerent measures.
Assume that we have two probability measures µ and µ′, both absolutely
continuous with respect to the same reference measure ν. The following
deﬁnitions give two concepts of distance between µ and µ′.
Deﬁnition 6.34.
The total variation distance between µ and µ′ is
dTV(µ, µ′) = 1
In particular, if µ′ is absolutely continuous with respect to µ, then
dTV(µ, µ′) = 1
 1 −dµ′
A. M. Stuart
Deﬁnition 6.35.
The Hellinger distance between µ and µ′ is
dHell(µ, µ′) =
In particular, if µ′ is absolutely continuous with respect to µ, then
dHell(µ, µ′) =
The total variation distance as deﬁned is invariant under the choice of
ν in that it is unchanged if a diﬀerent reference measure, with respect to
which µ and µ′ are absolutely continuous, is used. Furthermore, it follows
from the deﬁnition that
0 ⩽dTV(µ, µ′) ⩽1.
The Hellinger distance is also unchanged if a diﬀerent reference measure,
with respect to which µ and µ′ are absolutely continuous, is used. Furthermore, it follows from the deﬁnition that
0 ⩽dHell(µ, µ′) ⩽1.
The Hellinger and total variation distances are related as follows:
Lemma 6.36.
Assume that two probability measures µ and µ′ are both
absolutely continuous with respect to a measure ν. Then
2dTV(µ, µ′) ⩽dHell(µ, µ′) ⩽dTV(µ, µ′)1/2.
The Hellinger distance is particularly useful for estimating the diﬀerence
between expectation values of functions of random variables under diﬀerent
measures. This idea is encapsulated in the following lemma.
Lemma 6.37.
Assume that two probability measures µ and µ′ on a Banach space (X, ∥· ∥X) are both absolutely continuous with respect to a
measure ν. Assume also that f : X →E, where (E, ∥· ∥) is a Banach space,
has second moments with respect to both µ and µ′. Then
∥Eµf −Eµ′f∥⩽2
Eµ∥f∥2 + Eµ′∥f∥21/2dHell(µ, µ′).
Furthermore, if (E, ⟨·, ·⟩, ∥· ∥) is a Hilbert space and f : X →E has fourth
moments, then
∥Eµf ⊗f −Eµ′f ⊗f∥⩽2
Eµ∥f∥4 + Eµ′∥f∥41/2dHell(µ, µ′).
Remark 6.38.
Note, in particular, that choosing X = E, and with f
chosen to be the identity mapping, we deduce that the diﬀerences in mean
and covariance operators under two measures are bounded above by the
Hellinger distance between the two measures.
Inverse problems
6.8. Discussion and bibliography
For a general classical introduction to probability theory see Breiman ,
and for a modern treatment of the subject see Grimmett and Stirzaker
 . For a concise, modern (and more advanced) treatment of the subject
see Williams .
The text by Chorin and Hald provides an
overview of tools from probability and stochastic processes aimed at applied
mathematicians.
The discussion of Gaussian measures in a Hilbert space, and proofs of
Lemma 6.15 and Theorems 6.6, 6.2, 6.13 and 6.14 may be found in Da Prato
and Zabczyk . Theorem 6.14 is also proved in Bogachev . The
lecture notes by Hairer are also a good source, and contain a proof
of Theorem 6.1 as well as the Fernique Theorem. Bogachev , Hairer
 and Lifshits all discuss Gaussian measures in the Banach space
setting. In particular, Theorem 6.4 is proved in Lifshits , and Hairer
 has a nice exposition of the Fernique Theorem.
The Karhunen–Lo`eve expansion is described in Lo`eve and a
modern treatment of Gaussian random ﬁelds is contained in Adler .
Recent work exploiting the Karhunen–Lo`eve expansion to approximate solutions of diﬀerential equations with random coeﬃcients may be found in
Schwab and Todor and Todor and Schwab .
Theorem 6.29 is proved in Dudley . For a general
discussion of Bayes’ rule in ﬁnite dimensions see, for example, Bickel and
Doksum . The approach to Bayes’ rule in inﬁnite dimensions that we
adopt in Theorem 6.31 was used to study a speciﬁc problem arising in signal
processing in Hairer et al. . The topic of metrics on probability measures, and further references to the literature, may be found in Gibbs and
Su . Note that the choice of normalization constants in the deﬁnitions
of the total variation and Hellinger metrics diﬀers in the literature.
Acknowledgements
The material in this article is developed in greater detail in the lecture
notes of Dashti et al. . These notes are freely available for download
from: The author is grateful to his co-authors Masoumeh Dashti and Natesh Pillai for their input
into this article. The author also thanks Sergios Agapiou, Andrew Duncan, Stephen Harris, Sebastian Reich and Sebastian Vollmer for numerous
comments which improved the presentation, and to Daniella Calvetti and
Erkki Somersalo for useful pointers to relevant literature. Finally, the author is grateful to have received ﬁnancial support from the Engineering and
Physical Sciences Research Council (UK), the European Research Council
and from the US Oﬃce of Naval Research during the writing of this article.
This funded research has helped shape much of the material presented.
A. M. Stuart