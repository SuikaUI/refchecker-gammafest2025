Locality statistics for anomaly detection in time
series of graphs
Heng Wang, Minh Tang, Youngser Park, and Carey E. Priebe*
Abstract—The ability to detect change-points in a dynamic
network or a time series of graphs is an increasingly important
task in many applications of the emerging discipline of graph
signal processing. This paper formulates change-point detection
as a hypothesis testing problem in terms of a generative latent
position model, focusing on the special case of the Stochastic
Block Model time series. We analyze two classes of scan statistics,
based on distinct underlying locality statistics presented in the
literature. Our main contribution is the derivation of the limiting
properties and power characteristics of the competing scan
statistics. Performance is compared theoretically, on synthetic
data, and on the Enron email corpus. We demonstrate that both
statistics are admissible in one simple setting, while one of the
statistics is inadmissible in a second setting.
Index Terms—Anomaly detection, scan statistics, time series of
I. INTRODUCTION
The change-point detection problem in a dynamic network
is becoming increasingly prevalent in many applications of
the emerging discipline of graph signal processing. Dynamic
network data are often readily observed, with vertices denoting
entities and time evolving edges signifying relationships between entities, and thus considered as a time series of graphs
which is a natural framework for investigation. An anomalous
signal is broadly interpreted as constituting a deviation from
some normal network pattern, e.g. a model-based characterization such as large scan statistics (c.f. § IV) or non-model
based notions such as a community structure change, while a
change-point is the time-window during which the anomaly
Recently, many tailor-made approaches based on different
models, aiming for change-point detection in graphs, have
been proposed in a growing literature. designs a twostage Bayesian anomaly detection method for social dynamic
graphs. Both its model and parallelization in computation are
built on the assumption that the communication between each
pair of individuals independently follows a counting process.
In , an algorithm called NetSpot is created to ﬁnd arbitrary
Heng Wang is with the Department of Applied Mathematics and
Statistics, Johns Hopkins University, Baltimore, MD 21218 USA. (email:
 )
Minh Tang is with the Department of Applied Mathematics and Statistics, Johns Hopkins University, Baltimore, MD 21218 USA. (email:
 )
Youngser Park is with the Center of Imaging Science, Johns Hopkins
University, Baltimore, MD 21218 USA. (email: )
Carey E. Priebe is with the Department of Applied Mathematics and
Statistics, Johns Hopkins University, Baltimore, MD 21218 USA. (phone:
410-516-7200; fax:410-516-7459; email: )
but evolutionary anomalies that are maintained over a spatial
or time window, i.e., the anomalous signal does not appears
and then disappears instantaneously In , the subgraph
anomaly detection problem in static graphs were analyzed
through likelihood ratio tests under a Poisson random graph
model. Finally, in , the L1 norm of the eigenvectors of the
modularity matrix were used for detection of an (anomalous)
small dense subgraph embedded inside a large, sparser graph.
In this paper, we approach the dynamic anomaly/changepoint detection problem through the use of locality-based
scan statistics. Scan statistics are commonly used in signal
processing to detect a local signal in an instantiation of some
random ﬁeld , . The idea is to scan over a small time
or spatial window of the data and calculate some locality
statistic for each window. The maximum of these locality
statistics is known as the scan statistic. Large values of the scan
statistic suggests existence of nonhomogeneity, for example,
a local region with signiﬁcantly excessive communications.
Under some homogeneity hypothesis, change-point detection
can then be reduced to statistical hypotheses testing (c.f. § III)
using scan statistics. For example, builds up a simple
testing framework with the null hypothesis being Erd¨os-R´enyi
and the alternative hypothesis being a graph containing an
unusually dense subgraph. In the static graph setting, detection
boundaries and conditions are given in such that the scan
statistics they speciﬁed for the testing is non-negligibly powerful. To capture anomalies (e.g. hacker attacks) in computer
networks, employs scan statistics through two shapes of
locality statistics: ’star’ and ’k-path’. The power properties of
’star’ as a locality measure will be further explored in § V
In this paper, we identify excessive communication activity
in a subregion of a dynamic network by employing the scan
statistics Sτ,ℓ,k(t; ·) deﬁned in § IV, with τ denoting the
number of vertex-standardization steps, ℓdenoting the number
of temporal-normalization steps and k denoting local neighborhood distance. We consider two variations of Sτ,ℓ,k(t; ·),
namely Sτ,ℓ,k(t; Ψ) and Sτ,ℓ,k(t; Φ) where Ψ and Φ are two
related but distinct locality statistics. The use of the locality
statistics Ψ and Φ is based upon earlier work of and .
In particular, Ψ is introduced in to detect the emergence
of local excessive activities in time series of Enron graphs
whereas Φ is proposed in to detect communication pattern
changes in their department email network. Using the locality
statistic Ψ, constructs fusion statistics of graphs for
anomaly detection while presents an analysis of the Enron
data set to illustrate statistical inference for attributed random
graphs. However, all these cited works are mostly empirical
 
in nature and do not provide much theoretical analysis of
these locality-based scan statistics. Under the assumption that
the time series of graphs is stationary before a change-point,
we demonstrate in this paper that for τ = 1 and ℓ= 0,
the limiting Sτ,ℓ,k(t; Ψ) and Sτ,ℓ,k(t; Φ) are the maximum of
random variables which, under proper normalizations, follow
a standard Gumbel G(0, 1) distribution in the limit. Through
these limiting properties, comparative power analysis between
Sτ,ℓ,k(t; Ψ) and Sτ,ℓ,k(t; Φ) for τ
performed We demonstrate that both Ψ and Φ are admissible
if k = 0, while Ψ is inadmissible if k = 1. We hope that
these theoretical results will help motivate subsequent work in
understanding the interplay between locality statistics, vertex
and temporal normalizations, and inference in time-series of
Our paper is structured as follows. We discuss a generative
model for time series of graphs in § II. The problem of
change-point detection is formulated in § III. The formulation
associates a change-point in the time series with changes in
the underlying generative model. We introduce in § IV two
closely related notions of locality statistic, Ψ and Φ, and
their corresponding scan statistics Sτ,ℓ,k(t; Ψ) and Sτ,ℓ,k(t; Φ).
The limiting properties and power characteristics for some
representative instances of Sτ,ℓ,k(t; ·) are given in § V and VI,
while § VII presents experimental results regarding localitybased statistics on synthetic data and the Enron email corpus.
We conclude the paper in § VIII with additional discussions
of the two locality statistics and comments about possible
applications and extensions of the framework presented herein.
A. Notation
We introduce some notation that will be used throughout
this paper. In this paper, we consider only undirected and
unweighted graphs without self-loops. Generally, a graph is
denoted by G, with vertex set V
= V (G) and edge set
E = E(G). The number of vertices of a graph is usually
denoted by n. For a graph G on n vertices, the vertex set
is usually taken to correspond to the set [n] = {1, 2, . . . , n}.
In our subsequent discussion, we might also partition V into
subsets, or blocks. If V is partitioned into B blocks of size
n1, n2, . . . , nB vertices, then, with a slight abuse of notation,
we shall denote by [ni] the vertices in block i.
Let G be a graph. For any u, v ∈V , we write u ∼v if there
exists an edge between u and v in G. We write d(u, v) for
the shortest path distance between u and v in G. For v ∈V ,
we denote by Nk[v; G] the set of vertices u at distance at
most k from v, i.e., Nk[v; G] = {u ∈V : d(u, v) ≤k}. For
V ′ ⊂V , Ω(V ′, G) is the subgraph of G induced by V ′. Thus,
Ω(Nk[v; G], G) is the subgraph of G induced by vertices at
distance at most k from v.
II. RANDOM GRAPH MODELS
In this section, we brieﬂy summarize the latent position
model of , the dot product model of and stochastic
blockmodel of and , since they are the underlying
generative model for our graph Gt at each time t.
The latent position model is motivated by the assumption
that each vertex v is associated with a K dimensional latent
random vector Xv. For any pair of vertices u and v, conditioning on the two latent positions Xu and Xv, the existence
of an edge between u and v is independently determined by
a Bernoulli trial with probability f(Xu, Xv) where f is a
symmetric link function f : RK × RK → . Namely,
∼Bernoulli(f(Xu, Xv)).
The random dot product graph model (RDPM) is a
special case of the latent position model. In the random dot
product graph model, the link function f is speciﬁed to be the
Euclidean inner product, i.e., f(Xu, Xv) = ⟨Xu, Xv⟩. Also,
for each vertex v, the latent random vector Xv takes its values
in the unit simplex S so that 0 ≤⟨Xu, Xv⟩≤1 where
S = {x ∈ K :
The stochastic block model (SBM) of and is a
random graph model in which each vertex is randomly assigned a block membership among {1, . . . , B} where B is
the number of blocks. Given block memberships, the connectivity probabilities among all vertices are characterized by a
B × B symmetric matrix P where Pj,k denotes the block
connectivity probability between blocks j and k. Namely,
∼Bernoulli(Pj,k) given u ∈[nj] and v ∈[nk].
In this paper, we shall assume that the time series of random
graphs {Gt} are generated according to a stochastic block
model where the block membership of the vertices are ﬁxed
across time while the connectivity probabilities matrix P = Pt
may varies with time (c.f. our formulation of the change-point
detection problem in § III). That is to say, at some initial
time, say t0 = 0, we randomly assign each vertex to a block
membership among {1, 2, . . . , K}. Then at each subsequent
time t ≥t0, Gt follows a SBM with a K × K probability
matrix Pt, conditioned on the initial block membership at time
t0. Under this model, the graphs are conditionally independent
over time, the conditioning being on the block membership of
the vertices. This assumption on the generative model for the
{Gt} leads to a time series of graphs where the graphs are
“weakly” dependent, i.e., they are dependent only on the block
membership of the vertices at the initial time t0. If, instead,
for each time t, we resample the vertices’ block membership
for Gt then the resulting time series of graphs is independent.
Our construction of a time series of graphs in terms of the
SBM as outlined above is a special case of the following model
constructed using the random dot product graphs1 .
1The Dirichlet distribution is a multivariate generalization of the beta
distribution and correspond to a distribution of points in the unit simplex.
The Dirichlet distribution, Dirichlet(⃗α), ⃗α = (α1, . . . , αK), αj > 0, 1 ≤
j ≤K, has density f⃗α(x1, . . . , xK) =
xj < 1, PK
j=1 xj = 1.
1) For each v ∈[n] and t ∈N,
Xv(t) ∼Dirichlet(rv⃗αv +⃗1).
2) For each t ∈N and pair of vertices (u, v),
P(u ∼v| X(t)) = ⟨Xu(t), Xv(t)⟩.
where ⃗αv ∈S is a ﬁxed location parameter for the Dirichlet
distribution and rv is the concentration parameter that will be
explained now.
It is worthwhile to note that rv = 0 for all v ∈[n] means all
vertices follow the same probabilistic behavior (uniform on the
simplex) and min rv →∞implies that Xv(t) has a point mass
distribution at ⃗αv for each vertex. In the case min rv →∞,
the random dot product model can be further reduced to the
stochastic block model (SBM) by letting vertices sharing the
same ⃗αv share the same block membership. Next, we re-denote
by ⃗αi the common Dirichlet location parameter corresponding
to block [ni] and V is partitioned into B distinct blocks
[n1], . . . , [nB] if there are B distinct ⃗αi’s in total. Accordingly,
as min ri →∞, P(u ∼v| u ∈[nj], v ∈[nk]) →⟨⃗αj, ⃗αk⟩.
We note that the above Dirichlet can be viewed as generating
a time-series of graphs where the graphs are also “weakly”
dependent, e.g., dependency between graphs at time t and t′
being on the location and concentration parameters {(αv, rv)}
for the vertices. Other generalizations of the above construction for generating time series of graphs are also possible.
See, e.g., and for examples of constructions where
the time series of graphs depends on some underlying latent
stochastic processes.
III. CHANGE-POINT DETECTION PROBLEM IN STOCHASTIC
BLOCK MODEL FORMULATION
An important inference task in time series analysis is the
problem of anomaly or change-point detection. An anomaly
is broadly interpreted to mean deviation from a “normal”
pattern and a change-point is the time-window during which
the anomalous deviation occurs. For example, in social networks, we usually represent a time-evolving collection of
emails, phone calls, web pages visits, etc. as a time series
of graphs {Gt} and we want to infer, from {Gt}, if there
exists anomalous activities, e.g., excessive phone calls among
a subgroup in the network. In the detection problem described
below in § III and its theoretical analysis presented in § V
and § VI, we shall implicitly assume, for ease of exposition,
that the {Gt} are independent. As we pointed out in our
discussion of the generative model for time-series of graphs
in § II, this independence corresponds to conditioning on
the right parameters. In the setup of our theoretical analysis
in this paper, this corresponds to conditioning on the block
membership of the vertices, which are ﬁxed in time. Related
discussions in the context of the latent process models of 
and are given in § VIII.
Statistically speaking, we want to test, for an unknown but
non-random t ∈N, the null hypothesis H0 that t is not a
change-point against the alternative hypothesis HA that t is
a change-point. There are many different ways to formulate
the notion that t is a change-point. The following formulation,
in the contex of our discussion, is reasonable and sufﬁciently
general and forms the basis of our subsequent investigation.
We say that t∗is a change-point for {Gt} if there exists distinct
choices of P0, PA independent of t such that
SBM(P0, {[ni]})
for t ≤t∗−1
SBM(PA, {[ni]})
where SBM(P, {[ni]}) denote the stochastic blockmodel with
block connectivity probabilities P and unknown, but ﬁxed
in time, block memberships {[ni]}. In contrast, the null
hypothesis, i.e. the nonexistence of change-point, is
H0 : Gt ∼SBM(P0, {[ni]}) for all t.
That is to say, under the alternative, at time t∗, a subset of the
vertices change their behavior. The vertices whose behaviour
changes correspond to the vertices with block memberships
whose corresponding rows in the connectivity matrix changes,
i.e., from P0 to PA. As permutation of the vertex block
labels does not affect our subsequent analysis, we will refer to
(t∗, {[ni]}, P0, PA) as the change parameters. As a convention, if t∗= ∞, we assume all vertices follow their original
dynamics for all t.
In the following, we discuss a speciﬁc form for P0 and
PA, illustrating, albeit in an exaggerated manner, the chatter
anomaly, i.e., a subset of vertices with altered communication
behavior in an otherwise stationary setting.
for some δ > 0, with n1, n2, . . . , nB being of size
(n1, n2, . . . , nB) = (Θ(n), O(n), . . . , O(n)).
For this form of P0 and PA, the blocks have their own
(possibly distinct) self-connectivity probabilities which are
diagonal entries of matrices. In other words, before the changepoint, each of the blocks i = 2 up to B −1 have selfconnectivity probability hi. The block i = 1 is of size
Θ(n) with self-connectivity probability p1, representing the
probabilistic behaviors of the vast majority of actors in a very
large network. The case where h2 > p1, . . . , hB−1 > p1
is of interest because we can consider each of the [ni] as
representing a “chatty” group for time t ≤t∗−1, and at t∗,
the previously non-chatty group [nB] becomes more chatty.
See Fig. 1 for a notional depiction of P0 and PA for the case
of B = 3 blocks with p1 = p3 = p1,2 = p1,3 = p2,3 = p.
The detection of this transition for the vertices in [nB] is one
of the main reasons behind the locality statistics that will be
introduced in § IV.
Notional depiction of P0 and corresponding PA. P0: all vertices
connect with probability p except that the self-connectivity probability of [n2]
is h; PA: the self-connectivity probability of [n3] transitions from p to p+δ
while [n2] retains its previous behavior.
IV. LOCALITY STATISTICS FOR CHANGE-POINT
DETECTION IN TIME SERIES OF GRAPHS
A. Two locality statistics
Suppose we are given a time series of graphs {Gt}t≥1 where
V (Gt) is independent of t, i.e., the graphs Gt are constructed
on the same vertex set V . We now deﬁne two different but
related locality statistics on {Gt}. For a given t, let Ψt;k(v)
be deﬁned for all k ≥1 and v ∈V by
Ψt;k(v) = |E(Ω(Nk(v; Gt); Gt))|.
Ψt;k(v) counts the number of edges in the subgraph of Gt
induced by Nk(v; Gt), the set of vertices u at a distance at
most k from v in Gt. In a slight abuse of notation, we let
Ψt;0(v) denote the degree of v in Gt. The statistic Ψt was ﬁrst
introduced in . investigated the use of Ψt in analyzing
the Enron data corpus.
Let t and t′ be given, with t′ ≤t. Now deﬁne Φt,t′;k(v) for
all k ≥1 and v ∈V by
Φt,t′;k(v) = |E(Ω(Nk(v; Gt); Gt′))|.
The statistic Φt,t′;k(v) counts the number of edges in the
subgraph of Gt′ induced by Nk(v; Gt).
Once again, with a slight abuse of notation, we let Φt,t′;0(v)
denote the degree of v in Gt ∩Gt′, where G ∩G′ for G and
G′ with V (G) = V (G′) denotes the graph (V (G), E(G) ∩
E(G′)). The statistic Φt,t′;k(v) is motivated by a statistic
named the permanent window metric introduced in .
The permanent window metric was meant to capture events
involving not just a single individual but the whole community.
As the community at time t is assumed to be approximated by
Nk(v; Gt), the statistic Φt,t′;k(v) uses the community structure
at time t in its computation of the locality statistic at time
t′ ≤t. Through this measure, a community structure shift
of v can be captured even when the connectivity level of v
remains unchanged across time, i.e., when the Ψt stays mostly
constant as t changes in some interval. With the purpose
of determining whether t is a change-point, two kinds of
normalizations based on past Ψ and Φ locality statistics and
their corresponding normalized scan statistics are introduced
in the next subsection.
B. Temporally-normalized statistics
Let Jt,t′;k be either the locality statistic Ψt′;k in Eq. (3) or
Φt,t′;k in Eq. (4), where for ease of exposition the index t
is a dummy index when Jt,t′;k = Ψt′;k. We now deﬁne two
normalized statistics for Jt,t′;k, a vertex-dependent normalization and a temporal normalization. These normalizations and
their use in the change-point detection problem are depicted
in Fig. 2.
t = t∗−ℓ−1
Temporal standardization: when testing for change at time t, the
recent past graphs Gt, Gt−1, . . . are used to standardize the invariants.
For a given integer τ ≥0 and v ∈V , we deﬁne the vertexdependent normalization eJt,τ;k(v) of Jt,t′;k(v) by
eJt;τ,k(v) =
Jt,t;k(v) −ˆµt;τ,k(v)
(Jt,t;k(v) −ˆµt;τ,k(v))/ˆσt;τ,k
where µt;τ,k and σt;τ,k are deﬁned as
ˆµt;τ,k(v) = 1
Jt,t−s;k(v),
ˆσt;τ,k(v) =
(Jt,t−s;k(v) −ˆµt;τ,k(v))2.
We then consider the maximum of these vertex-dependent
normalizations for all v ∈V , i.e., we deﬁne a Mτ,k(t) by
Mτ,k(t) = max
v ( eJt,τ;k(v)).
We shall refer to Mτ,0(t) as the standardized max-degree and
to Mτ,1 as the standardized scan statistics. From Eq. (5), we
see that the motivation behind vertex-dependent normalization
is to standardize the scales of the raw locality statistics
Jt,t′;k(v). Otherwise, in Eq. (8), a noiseless vertex in the past
who has dramatically increasing communications at the current
time t would be inconspicuous because there might exist a
talkative vertex who keeps an even higher but unchanged
communication level throughout time.
Finally, for a given integer l ≥0, we deﬁne the temporal
normalization of Mτ,k(t) by
Sτ,ℓ,k(t) =
Mτ,k(t) −˜µτ,ℓ,k(t)
(Mτ,k(t) −˜µτ,ℓ,k(t))/˜στ,ℓ,k(t)
where ˜µτ,ℓ,k and ˜στ,ℓ,k are deﬁned as
˜µτ,ℓ,k(t) = 1
Mτ,k(t −s),
˜στ,ℓ,k(t) =
(Mτ,k(t −s) −˜µτ,ℓ,k(t))2.
The motivation behind temporal normalization, based on recent ℓtime steps, is to perform smoothing for the statistics
Mτ,k, similar to how smoothing is performed in time series
analysis. Large values of the smoothed statistic indicates an
anomaly where there is an excessive increase in communications among a subset of vertices. We will use these Sτ,ℓ,k
as the test statistics for the change-point detection problem
described in § III.
We note that because Ψt;k(v) = Φt,t;k(v) for Mτ,k when
τ = 0, the choice of locality statistic for Jt,t′;k does not matter
when τ = 0. For convenience of notation, since Sτ,ℓ,k(t) is
essentially a function of the Jt,t′;k, we denote by Sτ,ℓ,k(t; Ψ)
and Sτ,ℓ,k(t; Φ) the Sτ,ℓ,k(t) when the underlying statistic
Jt,t′;k is Ψt′;k and Φt,t′;k, respectively.
After the above introduction of the temporally-normalized
statistics Sτ,ℓ,k(t; ·) with three parameters τ, ℓ, k , we now
present a simple toy example to illustrate a key step in the
calculation of Sτ,ℓ,k(t; ·), namely the calculation of the vertexdependent normalization eJt;τ,k(v) presented in Eq. (5). In
Fig. 3, the table calculates
eJt∗;τ,k(v), when τ
v = e, for different underlying statistics Jt,t′;k and different
values of k. More concretely, because τ = 1, eJt∗;1,k(e) =
Ψt∗;k(e) −Ψt∗−1;k(e) if the underlying statistic is Ψt;k(e)
and eJt∗;1,k(e) = Φt∗,t∗;k(e) −Φt∗,t∗−1;k(e) if the underlying
statistic is Φt,t′;k(e).
V. POWER ESTIMATES OF Sτ=1,ℓ=0,k=0(t; ·)
For algebraic simplicity, in Section V and VI, we consider a
particularly simple form of P0 and PA where
An example to differentiate the calculation of
Jt∗;τ,k(v)
underlying
statistics
distances (k
1). In the right graph Gt∗, note that
the red edges are E(Ω(Nk=0[e; Gt∗], Gt∗)); the red and blue edges
E(Ω(Nk=1[e; Gt∗], Gt∗));
E(Ω(Nk=2[e; Gt∗], Gt∗)). For instance, the magenta-marked number 3
is Ψt∗−1;0 where Ψt∗−1;0(e)
|E(Ω(N0(e; Gt∗−1); Gt∗−1))| and
E(Ω(N0(e; Gt∗−1); Gt∗−1)) = {e ∼c, e ∼f, e ∼i} in Gt∗−1.;the
orange-marked number 4 is Φt∗,t∗−1;1(e) where Φt∗,t∗−1;1(e)
|E(Ω(N1(e; Gt∗); Gt∗−1))| and E(Ω(N1(e; Gt∗); Gt∗−1)) = {h ∼
k, b ∼h, e ∼i, e ∼f} in Gt∗−1.
With above form of P0 and PA, in this section, we will derive
the limiting properties of S1,0,0(t; Ψ) and S1,0,0(t; Φ) where
S1,0,0(t; Ψ) = maxv(Ψt;0(v) −Ψt−1;0(v)) and S1,0,0(t; Φ) =
maxv(Φt,t;0(v)−Φt,t−1;0(v)). Theorem 1 below shows that in
the limit Sτ,ℓ,k(t; ·) is the maximum of random variables that
converge to the standard Gumbel distributions G(0, 1) under
proper normalizations.
Theorem 1. Let {Gt} be a time series of random graphs
according to the alternative HA detailed in § III. In particular, Gt ∼SBM(P0, {[ni]}B
i=1) for t ≤t∗−1 and
Gt ∼SBM(PA, {[ni]}B
i=1) for t ≥t∗with P0 and PA
being of the form in Eq. (12) and Eq. (13), respectively. Let
S1,0,0(t; Ψ) denote the statistic Sτ,l,k(t; Ψ) with τ = 1, l = 0,
and k = 0. Let G(α, γ) denote the Gumbel distribution with
location parameter α and scale parameter γ. For a given
n ∈N, let an and bn be given by
1 −log log n + log 4π
Then as n = P ni →∞, S1,0,0(t; Ψ) has following proper-
S1,0,0(t; Ψ) = max
1≤i≤B W0(ni; Ψ)
S1,0,0(t; Ψ) = max
1≤i≤B WA(ni; Ψ)
W0(ni; Ψ) −µ0(ni; Ψ)
WA(ni; Ψ) −µA(ni; Ψ)
and the µ0, µA, γ0, γA are given by
µ0(ni; Ψ) = ani
γ0(ni; Ψ) = bni
µA(ni; Ψ) = µ0(ni; Ψ) + 1{i=B}nBδ
γA(ni; Ψ) = γ0(ni; Ψ).
C is some explicit, computable constant. Similarly, let
S1,0,0(t; Φ) denote Sτ,l,k(t; Φ) with τ = 1, l = 0, and k = 0.
Then as n = P ni →∞,
S1,0,0(t; Φ) = max
1≤i≤B W0(ni; Φ)
S1,0,0(t; Φ) = max
1≤i≤B WA(ni; Φ)
W0(ni; Φ) −µ0(ni; Φ)
WA(ni; Φ) −µA(ni; Φ)
and the µ0, µA, κ0, κA in this case are
κ(p) = p(1 −p)(1 −p(1 −p))
ξ0(ni; Φ) = 1{i/∈{1,B}}ni(hi(1 −hi) −p(1 −p))
µ0(ni; Φ) = ani
Cnκ(p) + np(1 −p) + ξ0(ni; Φ)
γ0(ni; Φ) = bni
µA(ni; Φ) = µ0(ni; Φ) + 1{i=B}nBδ(1 −p)
γA(ni; Φ) = γ0(ni; Φ).
We note the following corollary to Theorem 1 for the case of
B = 3 blocks.
Corollary 2. Assume the setting in Theorem 1 with B = 3.
Let α > 0 be given. Let βΦ be the power of the test statistic
S1,0,0(t; Φ) when t = t∗for testing the hypothesis that t is
a change point at a signiﬁcance level of α. Similarly, let βΨ
be the power of the test statistic S1,0,0(t; Ψ) when t = t∗for
testing the same hypothesis at the same signiﬁcance level of
α. Then, as (n1, n2, n3) = (Θ(n), O(n), O(n)), βΦ, βΨ and
α have the following relationship
1) n3 = o(√n) implies βΦ = α, βΨ = α.
2) n3 = Ω(√n) implies βΨ > α.
3) n3 = Θ(√n) = Θ(n2) implies βΦ > α.
4) n3 = ω(√n) = Θ(n2) implies
n2(h(1−h)−p(1−p))
n2(h(1−h)−p(1−p))
5) n3 = Ω(√n) = ω(n2) implies βΦ > α.
6) n3 = Ω(√n) = o(n2) implies
βΦ = α if h + p < 1,
βΦ > α if h + p ≥1.
From Corollary 2, an unanswered question is whether there
exists a dominance between S1,0,0(t; Ψ) and S1,0,0(t; Φ). By
using Theorem 1, we now present an example to show that
both statistics are admissible if we restrict the test statistic
space to only two elements-S1,0,0(t; Ψ) and S1,0,0(t; Φ). That
is, neither statistic has a statistical power dominance. Our setup
is as follows. Let p = 0.43. For each pair (h, p+δ) satisfying
p < h < 1 and p < p + δ < 1, we generate a null and
alternative hypothesis pair H0 and HA according to the model
in § III with B = 3 blocks, i.e.,
with n = n1 + n2 + n3 = 1000 and n1, n2, n3 being
functions of n, h and δ (n2 = n3 = cp,h,δ
√n log n where the
constant cp,h,δ is dependent on p, h and δ). In order to compare
sensitivities of S1,0,0(t; Ψ) and S1,0,0(t; Φ) in detection, we
then calculate βΨ −βΦ by deriving the limiting property
of S1,0,0(t; Ψ) using Eqs. (14) and (15) and the limiting
property of S1,0,0(t; Φ) using Eqs. (16) and (17). The result is
illustrated in Fig. 4 where we have plotted βΨ−βΦ for different
combinations of h and q(= p + δ). Fig. 4 indicates that the
two statistics S1,0,0(·; Ψ) and S1,0,0(·; Φ) are both admissible
because S1,0,0(t; Φ) achieves a larger statistical power in the
blue-colored region but a smaller power in the red-colored
We now analyze the use of Theorem 1 as a large-sample approximation to S1,0,0(t; Φ) and S1,0,0(t; Ψ). From Fig. 4 with
p = 0.43, we choose a (h, p + δ) pair, with βΨ −βΦ > 0.05,
namely h = 0.95 and p+δ = 0.98. We then estimate the power
of βΦ and βΨ by repeated sampling of graphs from stochastic
blockmodel with parameters, (P0, n1, n2, n3) for the null distribution and (PA, n1, n2, n3) for the alternative distribution.
The result is presented in Fig. 5. We see that the largesample approximation obtained via Theorem 1 matches well
with sampling from the stochastic blockmodel (SBM). Fig. 5
also includes power estimates for the random dot product
model (RDPM) with varying concentration parameter r and
predetermined location parameters ⃗α1, ⃗α2, ⃗α3. Speciﬁcally,
⃗α1, ⃗α2, ⃗α3 are carefully chosen such that their Euclidean inner
products match corresponding block connectivity probabilities
i.e., (p, h, q) speciﬁed above. We see that, as r increases, the
power estimates for the random dot product model matches
well with those of the stochastic blockmodel and large-sample
approximation. Finally Fig. 5 also includes power estimates
A comparison, using the limiting properties of S1,0,0(t; Ψ) and
S1,0,0(t; Φ), of βΨ −βΦ for different null and alternative hypotheses pairs
as parametrized by h and q(= p + δ). The blue-colored region correspond
to values of h and q(= p + δ) for which βΨ < βΦ while the red-colored
region correspond to values of h and p + δ with βΨ > βΦ.
for the locality statistics based on Φ and Ψ for τ = 0, i.e.,
no vertex-dependent normalization and is equivalent to the
use of the max degree statistic to test H0 against HA. These
are represented as dashed and dot blue lines, corresponding
to large-sample approximation and Monte Carlo simulations,
respectively. Clearly, vertex-dependent normalization leads to
better performance for this H0 and HA pair.
VI. POWER ESTIMATES OF Sτ=1,ℓ=0,k=1(t; ·)
In this section, we provide investigations of Sτ,ℓ,k(t; Ψ) and
Sτ,ℓ,k(t; Φ) with a larger scale parameter k = 1 instead of
k = 0. We keep τ = 1 and ℓ= 0 the same as before and derive
the limiting properties of maxv(Ψt;1(v) −Ψt−1;1(v)) and
maxv(Φt,t;1(v) −Φt,t−1;1(v)). To make conclusions concise
and presentable, ﬁrstly, we delve into the limiting properties
in the model presented in § III with number of blocks B = 3.
Proposition 3. Assume the same setting in Theorem 1 with
B = 3. As (n1, n2, n3) = (Θ(n), o(n), o(n)) and n →∞,
S1,0,1(t; Ψ) has the following properties:
S1,0,1(t; Ψ) = max
S1,0,1(t; Ψ) = max
0(ni; Ψ) −µ′
0(ni; Ψ) −µ′
SBM approx theory:Ψ
SBM approx theory:Φ
SBM approx sim:Ψ
SBM approx sim:Φ
RPDM approx sim:Ψ
RPDM approx sim:Φ
Power estimates βΨ against βΦ using Monte Carlo simulation on
random graphs from the stochastic blockmodel, Monte Carlo simulation on
random graphs from the random dot product model, and large-sample approximation for the stochastic blockmodel. r is the concentration parameter. Dashed
blue line: power estimate of large-sample approximation to S0,0,0(t; Ψ); dot
blue line: power estimate of SBM Monte Carlo simulation to S0,0,0(t; Ψ).
and the µ′
A are given by
κ′(n, p, n2, h, i) = np2 + 1 + 1{i=2}n2p(h −p)
0(ni; Ψ) = µ0(ni; Ψ)κ′(n, p, n2, h, i)
0(ni; Ψ) = γ0(ni; Ψ)κ′(n, p, n2, h, i)
ζ(n3, p, δ, i) = δ
3(1{i̸=3}p2 + 1{i=3}(p + δ)2)
+n3(1{i̸=3}p(1 −p) + 1{i=3}(p + δ)(1 −p −δ))]
A(ni; Ψ) = µA(ni; Ψ)[κ′(n, p, n2, h, i) + 1{i=3}n3pδ
+ ζ(n3, p, δ, i)
A(ni; Ψ) = γA(ni; Ψ)[κ′(n, p, n2, h, i) + 1{i=3}n3pδ
S1,0,1(t; Φ) = max
0(ni; Φ) t < t∗,
S1,0,1(t; Φ) = max
A(ni; Φ) t = t∗,
0(ni; Φ) −µ′
0(ni; Φ) −µ′
and the µ′
A are given by
η(p) = p3(1 −p)
ξ0(ni; Φ) = 1{i=2}n2(h(1 −h) −p(1 −p))
0(ni; Φ) = ani
Cn2η(p) + np(1 −p) + ξ0(ni; Φ)
0(ni; Φ) = bni
ζ(n3, p, δ, i) = δ
3(1{i̸=3}p2 + 1{i=3}(p + δ)2)
+ n3(1{i̸=3}p(1 −p) + 1{i=3}(p + δ)(1 −p −δ))]
A(ni; Φ) = µ′
0(ni; Φ) + 1{i=3}n3δ(1 −p) + ζ(n3, p, δ, i)
A(ni; Φ) = γ′
Naturally,
properties
S1,0,1(t; Ψ)
S1,0,1(t; Φ) as given above offer the following power comparison result.
Proposition 4. In the model shown in Fig.1, Let α > 0 be
Φ be the power of the test statistic S1,0,1(t; Φ) when
t = t∗for testing the hypothesis that t is change point at a
signiﬁcance level of α and β′
Ψ be the power of the test statistic
S1,0,1(t; Ψ) when t = t∗for testing the same hypothesis at the
same signiﬁcance level of α. As n →∞, β′
Ψ and α have
the following relationship:
1) n3 = o(√n) implies β′
2) n3 = Ω(√n) implies β′
Consequently, Proposition 4 leads to the conclusion that the
performance of S1,0,1(t; Φ) dominates S1,0,1(t; Ψ) in the 3block model. Moreover, this superiority can be generalized
to the case with any given number of blocks B ≥3. This
is because each block [ni] with 1 < i < B in B-blocks
model follows a similar probabilistic behavior as block [n2]
in 3-blocks model while the power of hypothesis testing is
otherwise determined by the change of probabilistic behavior
of block [nB]. In the limiting condition with n →∞, both β′
Ψ in B-blocks model can be characterized as a function
of p, δ, nB only. In other words, though h2 > p, . . . , hB−1 >
p, the ”chatty” groups [n2], . . . , [nB−1] do not make any
contribution on β′
Ψ. Hence, the number of ”chatty
groups”, namely B−2, is independent of the fact of dominance
of S1,0,1(t; Φ). Due to the superiority of S1,0,1(t; Φ), only the
limiting properties of S1,0,1(t; Φ) in the general B-block model
is given below.
Theorem 5. Let {Gt} be a time series of random graphs
according to the alternative HA detailed in § III. In particular, Gt ∼SBM(P0, {[ni]B
i=1}) for t < t∗and Gt ∼
SBM(PA, {[ni]B
i=1}) for t ≥t∗with P0 and PA being of
the form in Eq. (1) and Eq. (2), respectively. Let S1,0,1(t; Φ)
denote the statistic Sτ,l,k(t; Φ) with τ = 1, l = 0, and k = 1.
Then as n = P ni →∞, S1,0,1(t; Φ) has the following
properties:
S1,0,1(t; Φ) = max
S1,0,1(t; Φ) = max
THE OPTIMAL τ AND l IN AN EXPERIMENT COMPARING THE STATISTICAL
POWER OF Sτ,ℓ,k FOR k = 0, 1 AND LOCALITY STATISTICS Φ AND Ψ. WE
VARIES τ, ℓ∈{0, 1, . . . , 10} AND COMPARE THE STATISTIC POWER FOR
EACH CHOICE OF τ AND ℓTHROUGH A MONTE-CARLO EXPERIMENT WITH
2000 REPLICATES.
max(τ,ℓ) β
Sτ,ℓ,0(t; Ψ)
Sτ,ℓ,0(t; Φ)
Sτ,ℓ,1(t; Ψ)
Sτ,ℓ,1(t; Φ)
0(ni; Φ) −µ′
A(ni; Φ) −µ′
and the µ′
A are given by
η(p) = p3(1 −p)
ξ0(ni; Φ) = 1{i/∈{1,B}}ni(hi(1 −hi) −p(1 −p))
0(ni; Φ) = ani
Cn2η(p) + np(1 −p) + ξ0(ni; Φ)
0(ni; Φ) = bni
ζ(nB, p, δ, i) = δ
B(1{i̸=B}p2 + 1{i=B}(p + δ)2)
+nB(1{i̸=B}p(1 −p) + 1{i=B}(p + δ)(1 −p −δ))]
A(ni; Φ) = µ′
0(ni; Φ) + 1{i=B}nBδ(1 −p) + ζ(nB, p, δ, i)
A(ni; Φ) = γ′
Corollary 6. Assume the setting in Theorem 5. Let β′
power of the test statistic S1,0,1(t; Φ) for t = t∗and β′
the power of the test statistic S1,0,1(t; Ψ) for t = t∗. Then,
as (n1, n2, . . . , nB) = (Θ(n), o(n), . . . , o(n)) and n →∞,
Ψ and thus S1,0,1(t; Ψ) is inadmissible.
In §V and §VI, for simplicity of analytic investigations,
we theoretically obtain power estimates of Sτ,ℓ,k(t; Ψ) and
Sτ,ℓ,k(t; Φ) under the restrictions of τ = 1 and ℓ= 0.
Besides analytic investigations, we also empirically study
power performances of Sτ,ℓ,k(t; Ψ) and Sτ,ℓ,k(t; Φ) with other
(τ, ℓ) combinations via Monte Carlo simulations. In this
experiment, we let τ range from 0 to 10 and ℓrange from
0 to 10. In each Monte Carlo replicate, a time series of
random graphs based on the SBM considered in §V, where
(n1, n2, n3) = (870, 65, 65), (p, h, q) = (0.43, 0.95, 0.98), is
sampled. Next, Sτ,ℓ,k(t∗−1; Ψ),Sτ,ℓ,k(t∗−1; Φ),Sτ,ℓ,k(t∗; Ψ)
and Sτ,ℓ,k(t∗; Φ) are calculated individually according to
speciﬁc (τ, ℓ, k). After 2000 replicates, for each test statistic,
the largest empirical power (denoted by max(τ,ℓ) β) and the
corresponding optimal choice of (τ, ℓ) (denoted by (τ ∗, ℓ∗))
is obtained and summarized in Table I.
The empirical results in Table I demonstrate the potential
value of extending the theoretical investigations in §V and §VI
to cases of τ ≥1 and ℓ≥1, though this extension appears
signiﬁcantly more challenging than the case (τ, ℓ) = (1, 0).
VII. EXPERIMENT
We use the Enron email data used in for this experiment. It
consists of time series of graphs {Gt} with |V | = 184 vertices
for each week t = 1, . . . , 189, where we draw a unweighted
edge when vertex v sends at least one email to vertex w during
a one week period.
After truncating ﬁrst 40 weeks for vertex-standardized and
temporal normalizations, Figure 6 depicts Sτ,ℓ,k(t; Ψ) (Sea-
Green) and Sτ,ℓ,k(t; Φ) (Orange) in the remaining 149 weeks
from August 1999 to June 2002. In this experiment, we choose
both τ = ℓ= 20, used in , to keep the comparisons
between the two papers meaningful. As indicated in ,
detections are deﬁned as weeks t such that Sτ,ℓ,k > 5. Hence,
from Figure 6 we have following observations and reasonings.
1) S20,20,0(t; Ψ), S20,20,0(t; Φ), S20,20,1(t; Ψ), S20,20,1(t; Φ)
and S20,20,2(t; Φ) indicate a clear anomaly at t∗= 58
in December 1999. This coincides with the happening
of Enron’s tentative sham energy deal with Merrill
Lynch to meet proﬁt expectations and boost stock price
 . The center of suspicious community-employee
v154 is identiﬁed by all ﬁve statistics.
2) S20,20,0(t; Ψ),
S20,20,0(t; Φ),
S20,20,1(t; Ψ)
S20,20,2(t; Ψ) capture an anomaly at t∗= 146 in the
mid-August 2001. This is the period that Enron CEO
Skilling made a resignation announcement when the
company was surrounded by public criticisms shown
in . The center of suspicious community-employee
v95 is identiﬁed by these four statistics.
3) S20,20,2(t; Ψ) signiﬁes an anomaly at t∗= 132 in
late April 2001 where S20,20,k(t; Φ) fails to alert for
any k ∈{0, 1, 2}. This phenomenon occurs because
S20,20,2(t; Ψ) captures the employee v90 whose secondorder neighborhood N2(v90; G132) contains 116 emails
at t∗= 132 but 0 email in his second-order neighborhoods of previous 20 weeks. That is, the timedependent second-order neighborhood N2(v90; Gt) had
no communication in the period from t = 112 to
t = 131. On the other hand, this behavior cannot be
monitored by S20,20,2(132; Φ) because the change of
communication frequency in a ﬁxed second-order neighborhood N2(v90; G132), measured by locality statistics
Φ, is not so signiﬁcant. More concretely, the number of
emails in the unchanged N2(v90; G132) has a mean of
45.5 and a standard deviation of 14.9 from t = 112 to
t = 131. In , this anomaly appears after the Enron
Quaterly Conference Call in which a Wall Street analyst
Richard Grubman questioned Skilling on the company’s
refusal of releasing balance sheet but then got insulted
by Skilling.
4) S20,20,2(t; Φ) shows a detection on v135 at t∗= 136
before June 2001 over S20,20,2(t; Ψ). This comes from
the fact that the ﬁxed second-order neighborhood of
employee v135 at t∗= 136, i.e. N2(v135; G136), has
a small standard deviation 1.08 in previous 20 weeks
while the communications in time-dependent neighborhoods {N2(v90; Gt)}135
t=116 has a large standard deviation
GGGGGGGGGGG
GGGGGGGGGG
GGGGGGGGGGGGGGGG
GGGGGGGGGGGGGGGGGGGGG
GGGGGGGGGGGGGGGG
GGGGGGGGGGGG
GGGGGGGGGGGGGGG
GGGGGGGGGGGGG
GGGGGGGGGGGG
Sτ,ℓ,k(t; Ψ)(sea green) and Sτ,ℓ,k(t; Φ)(orange), the temporallynormalized standardized scan statistics using τ = ℓ= 20, in time series of
Enron email-graphs from August 1999 to June 2002. Top: k = 0; Middle: k =
1; Bottom : k = 2. In the case k = 0, both S20,20,0(t; Ψ) and S20,20,0(t; Φ)
show detections (Sτ,ℓ,k(t; ·) > 5) at observation mark (1) and (2); in the case
k = 1, both S20,20,1(t; Ψ) and S20,20,1(t; Φ) show detections at observation
mark (1), S20,20,1(t; Ψ) also indicates an anomaly at observation mark (2);
in the case k = 2, S20,20,2(t; Ψ) detects anomalies at observation mark (2)
and (3) but S20,20,2(t; Φ) captures anomalies at observation mark (1) and
(4). Detailed analyses on each observation (1)(2)(3)(4) are provided in §VII
respectively.
10.04. Practically speaking, in this case, a dramatic
increment of email contacts in the certain community
N2(v135; G136) could be captured by S20,20,2(t; Φ) but
ignored by S20,20,2(t; Ψ) because unstable communication patterns in {N2(v90; Gt)}135
t=116 offsets the sensitivity of signal. According to , this anomaly corresponds to the formal notice of closure and termination
of Enron’s single largest foreign investment, the Dabhol
Power Company in India.
In summary, observations 1 and 2 demonstrate that in some
cases both Sτ,ℓ,k(t; Ψ) and Sτ,ℓ,k(t; Φ) are capable of capturing the same community which has a signiﬁcant increment of
connectivity. Besides, in some situations shown in observations 3 and 4, Sτ,ℓ,k(t; Ψ) and Sτ,ℓ,k(t; Φ) achieve different
detections due to its adaptability.
VIII. CONCLUSION & DISCUSSION
This paper has summarized a generative latent position model
for time series of graphs and set up the change-point detection
problem in time series of graphs in terms of stochastic
block models. Then we have proposed the way of dealing
with change-point detection through the use of scan statistics
Sτ,ℓ,k(t; Ψ) and Sτ,ℓ,k(t; Φ) constructed from two different
locality statistics Ψ and Φ respectively. We derived the limiting properties for four representative instances of localitybased scan statistics S1,0,0(t; Ψ), S1,0,0(t; Φ), S1,0,1(t; Ψ) and
S1,0,1(t; Φ). The limiting properties were then used to derive
estimates for the power of the tests.
The simulation experiments indicate that the analytic power
estimates, even when they are limited in scope, are useful
in answering some important questions about the locality
statistics. In particular, it was shown that Ψ and Φ are both admissible with respect to one another when τ = 1, ℓ= 0, k = 0.
In addition, if τ = 1, ℓ= 0, k = 1, it is worthwhile to note
that Ψ, compared with Φ, is inadmissible but computationally
inexpensive. For instance, in order to complete τ-step vertexdependent normalization calculation presented in Eq.(5), we
have to record previous τ-step graphs to calculate Jt,t′;k(v)
if the underlying locality statistic is Φ. However, if the
underlying locality statistic is Ψ, graph storage is not necessary
and recording only the previous τ-step statistics Ψt′;k(v) is
sufﬁcient. Furthermore, the power estimates are also useful
for reasoning about the behavior on more complicated models
without {Gt} independencies assumption, such as the latent
process model proposed in . builds up a latent
process model for time series of attributed graphs based on
a random dot process model. Having n vertices governed by
n individual continuous-time ﬁnite-state stochastic processes,
this model generates a time series of dependent attributed
random graphs, or equivalently, conditioning on the sample
paths of the stochastic processes, the graphs are independent.
 also provides two approximations to the exact latent
process model. The ﬁrst order approximation is the stochastic
blockmodel which gives rise to a time series of independent
random graphs with independent edges. The second order
approximation corresponds to the random dot product model
which gives rise to a time series of independent random dot
product graphs. Both of these approximations are presented in
The investigations presented in this paper do not take into
account attributes on the edges. The incorporation of edge
attributes into the current paper is, however, straightforward.
For example, handles attributes by linear fusion, and
many of the results there can be adapted to the current
paper. In particular, one can deﬁne fused locality statistics for
attributed graphs. Power estimates for these locality statistics
can be derived in a similar manner to those presented in this
paper. Other considerations, e.g., optimal fusion parameters,
can also be investigated. However, the statistics considered in
 are only temporally normalized and does not contain a
vertex dependent normalization. Thus, the derivation of their
limiting properties are much less involved. In addition, as the
experimental results in Fig 5 shown, the vertex dependent
normalization does lead to improved statistical power in many
situations of interest.
Anomaly detection in dynamic graphs has applications in diverse areas, e.g., predicting the emergence of subgroups within
an organization, monitoring disease spread in public network,
detecting modules of cancer and metastasis communities in
Protein-protein interaction (PPI) network. We envision that
these and many other applications will beneﬁt from the kind of
investigations outlined in this paper. However, much remains
to be done, both mathematically and computationally. We list
here some aspects that have not been (sufﬁciently) addressed
in the paper.
1) Besides this paper, also investigated Sτ,ℓ,k(t; Ψ)
for cases τ = 0, ℓ→∞, and k ≤1 under the
SBM setting. However, power-estimates for other more
complex locality-based scan statistics, such as Sτ,ℓ,k(t; ·)
for 1 < τ < ∞, 0 < ℓ< ∞and k ≥2, remain to be
investigated.
2) Locality statistics based on Ψ can be readily computed
in a real-time streaming data environment, in contrast to
those based on Φ. Thus, the adaption or approximation
of locality statistics based on Φ for streaming environments is of interest.
3) Power-estimates for locality statistics under the random
dot product model setting. The limiting distributions,
even for the simplest locality statistics, are currently
unavailable.
ACKNOWLEDGMENT
This work was partially supported by Johns Hopkins University Human Language Technology Center of Excellence (JHU
HLT COE), and the XDATA program of the Defense Advanced
Research Projects Agency (DARPA) administered through Air
Force Research Laboratory contract FA8750-12-2-0303.
PROOF OF SOME STATED RESULTS
In this appendix, we provide proofs of theorems, propositions
and corollaries presented in § V and VI.
Theorem 1:
Firstly, we investigate the case that the
underlying locality statistic is Ψ. We will derive the limiting
property of S1,0,0(t; Ψ) for t = t∗in some detail. The property
of S1,0,0(t; Ψ) when t < t∗can be derived in a similar manner.
As τ = 1 and ℓ= 0, for any t, we have eΨt;1,0(v) =
Ψt;0(v) −Ψt−1;0(v) from Eq. (5) and Eq. (6). Without loss
of generality, let us assume v ∈[ni] and divide Ψt;0(v) into
two parts with t = t∗and t = t∗−1:
Ψt∗;0(v) = X1 + X2
where X1 ∼Bin(n −ni, p), X2 ∼Bin(ni −1, PA
Ψt∗−1;0(v) = X3 + X4
where X3 ∼Bin(n −ni, p), X4 ∼Bin(ni −1, P0
Since Gt∗−1 and Gt∗are independent, we have
eΨt∗;1,0(v) −(ni −1)(PA
=Ψt∗;0(v) −[(n −ni)p + (ni −1)PA
−Ψt∗−1;0(v) −[(n −ni)p + (ni −1)P0
X1 −(n −ni)p
(n −ni)p(1 −p)
(n −ni)p(1 −p)
X3 −(n −ni)p
(n −ni)p(1 −p)
(n −ni)p(1 −p)
X2 −(ni −1)PA
X4 −(ni −1)P0
d−→N(0, 1) · C1 −N(0, 1) · C2 + N(0, 1) · C3 −N(0, 1) · C4
d−→N(0, C)
C1 = C2 = lim
Next, plug in PA
i,i and P0
i,i into Eq. (18), we obtain
eΨt∗;1,0(v) −1{i=B}nBδ
d−→N(0, 1), v ∈[ni]
dependency
{eΨt∗;1,0(v)}v∈V (Gt)
negligible
correlation between any two of the eΨt∗;1,0(v) goes to 0
sufﬁciently fast as n →∞. For u and v in block [ni],
corr(eΨt∗;1,0(u), eΨt∗;1,0(v)) ≤
Cnp(1 −p) = O( 1
Hence, the sample maximum of {Yv}v∈[ni] converges to the
sample maximum of ni i.i.d N(0, 1) random variables where
eΨt∗;1,0(v) −1{i=B}nBδ
( , Theorem 3.1). Also, it
is known that the sample maximum of i.i.d N(0, 1) random
variables weakly converges to the Gumbel distribution ( ,
§ 2.3). One then veriﬁes that the composition of above weak
convergences still holds (see e.g. proof of Proposition 5 in
 ) and we thus have
WA(ni; Ψ) −µA(ni; Ψ)
d→G(0, 1).
Eq.(8) and Eq. (9) then implies that
S1,0,0(t∗; Ψ) = max
eΨt∗;1,0(v) = max
1≤i≤B{WA(ni; Ψ)}.
That is, the maximum of eΨt∗;1,0(v) over all n vertices is equivalent to the maximum of WA(ni; Ψ) over all B blocks where
WA(ni; Ψ) converges to G(0, 1) under proper normalization
Similarly, the case when t < t∗can be derived through the
same approaches above. The limiting property of S1,0,0(t; Ψ)
with t < t∗then has the form in Eq. (14) with variations of
µ0(ni; Ψ) and γ0(ni; Ψ) for the normalization of W0(ni; Ψ).
We now consider the case where the underlying locality statistic being Φ. The derivation of limiting property of S1,0,0(t; Φ)
for t = t∗is given below. The derivation of the limiting
property of S1,0,0(t; Φ) for t < t∗is similar and can be
obtained with minor changes.
Let’s assume v ∈[ni], from Eq.(4) to (6),
Φt∗,t∗;0(v) = X1 + X2
where X1 ∼Bin(n −ni, p), X2 ∼Bin(ni −1, PA
Φt∗,t∗−1;0(v)|Gt∗= X3 + X4
where X3 ∼Bin(X1, p), X4 ∼Bin(X2, P0
Because eΦt∗;1,0(v) = Φt∗,t∗;0(v) −Φt∗,t∗−1;0(v), eΦt∗;1,0(v)
counts the number of edges, for vertex v, appearing in Gt∗but
disappearing in Gt∗−1. Accordingly, the edge is independently
counted with probability PA
i,i) to neighbors in [ni] and
p(1 −p) to neighbors in [n]\[ni] respectively. That is,
eΦt∗;1,0(v) = B3 + B4
where B3 ∼Bin(n−ni, p(1−p)), B4 ∼Bin(ni−1, PA
By the central limit theorem, we have
eΦt∗;1,0(v) −[(n −ni)p(1 −p) + (ni −1)PA
np(1 −p)[1 −p(1 −p)]
B3 −(n −ni)p(1 −p)
(n −ni)p(1 −p)[1 −p(1 −p)]
(n −ni)p(1 −p)[1 −p(1 −p)]
np(1 −p)[1 −p(1 −p)]
B4 −(ni −1)PA
i,i)[1 −PA
i,i)[1 −PA
np(1 −p)[1 −p(1 −p)]
d−→N(0, 1) · C1 + N(0, 1) · C2
d−→N(0, C)
i,i)[1 −PA
np(1 −p)[1 −p(1 −p)]
Similarly, after plugging P0
i,i and PA
i,i into Eq. (19), we obtain
eΦt∗;1,0(v) −np(1 −p) −ξ0(ni; Φ) −1{i=B}nBδ(1 −p)
Cnp(1 −p)[1 −p(1 −p)]
d−→N(0, 1).
dependency
{eΦt∗;1,0(v)}v∈[n] is also negligible because
corr(eΦt∗;1,0(u), eΦt∗;1,0(v))
=cov(eΦt∗;1,0(u), eΦt∗;1,0(v))
Cnp(1 −p)[1 −p(1 −p)]
Cnp(1 −p)[1 −p(1 −p)] = O( 1
Therefore by following the same procedures of reasoning the
limiting distribution of WA(ni; Ψ), we can also obtain
WA(ni; Φ) −µA(ni; Φ)
where WA(ni; Φ) = maxv∈[ni] eΦt∗;1,0(v).
Thus, S1,0,0(t∗; Φ) is the maximum of WA(ni; Φ) over B
blocks as desired.
Corollary 2: The limiting distributions of eΨt∗−1;1,0(v)
and eΨt∗;1,0(v) derived in the proof Theorem 1 provides that,
eΨt∗−1;1,0(v) −0
d−→N(0, 1), v ∈[ni]
and, under HA,
eΨt∗;1,0(v) −1{i=3}n3δ
d−→N(0, 1), v ∈[ni]
Accordingly, the ratio of the shift in the mean, from null to
alternative, over the standard deviation of eΨt;1,0(v) for each
vertex would be
. We obtain two relationships
between βΨ and α on the basis of the order of n3:
1) if n3 = o(√n), the ratio approaches to 0 and thus
implies βΨ = α.
2) if n3 = Ω(√n), then ∃k > 0 such that
k > 0 as n →∞which implies βΨ > α.
Likewise, from Theorem 1, the limiting distributions of
eΦt;1,0(v) under null and alternative respectively are
eΦt∗−1;1,0(v) −np(1 −p) −ξ0(ni; Φ)
Cnp(1 −p)[1 −p(1 −p)]
d−→N(0, 1).
eΦt∗;1,0(v) −np(1 −p) −ξ0(ni; Φ) −1{i=3}n3δ(1 −p)
Cnp(1 −p)[1 −p(1 −p)]
d−→N(0, 1).
The relationship between βΦ and α is more involved when
ξ0(n2; Φ) are included. In order to clarify the order dominance
relationship between ξ0(n2; Φ) and n3δ(1 −p), there are ﬁve
separate cases to be considered:
1) if n3 = o(√n), as n →∞, eΦt;1,0(v) share the same
mean and variance under both H0 and HA, thus βΦ = α.
2) if n3 = Θ(√n) = Θ(n2),
Cnp(1 −p)[1 −p(1 −p)]
Cnp(1 −p)[1 −p(1 −p)]
Cnp(1 −p)[1 −p(1 −p)]
= Θ(1), is not negligible
and implies βΦ > α.
Θ(n2), whether βΦ
determined by if P(argmax eΦt;1,0(v) ∈[n3]) under HA
is larger than under H0. In fact, if
n3δ(1 −p) > 1,
P(argmax eΦt;1,0(v) ∈[n2]) = 1 as n →∞under both
H0 and HA, hence βΦ = α. Otherwise, n3δ(1 −p) in
[n3] contributes to the power increment.
= Ω(√n) = ω(n2), n3δ(1 −p) dominates
ξ0(n2; Φ) in the limit thereby the location shift in block
[n3] results in P(argmax eΦt∗;1,0(v) ∈[n3]) = 1 and
thus βΦ > α.
5) if n3 = Ω(√n) = o(n2), whether n3δ(1 −p) leads to
a power increment depends on the sign of ξ0(n2; Φ).
If h + p < 1 such that ξ0(n2; Φ) being positive,
P(argmax eΦt;1,0(v) ∈[n2]) = 1 under both H0 and
HA as n →∞because n3 = o(n2). On the contrary, if
h+p ≥1, ξ0(n2; Φ) < 0 enables P(argmax eΦt;1,0(v) ∈
[n3]) to increase from H0 to HA. Thus, we have
βΦ = α if h + p < 1; βΦ > α if h + p ≥1.
Proposition 3: We present a sketch of the proof based on
arguments from for the case where the underlying locality
statistic is Ψ. The case where the underlying locality statistic
is Φ follows from the proof of Theorem 5.
Let v ∈[ni](i ∈{1, 2, 3}), locality statistics Ψt∗,t∗;1(v) and
Ψt∗,t∗−1;1(v) are respectively decomposed as follows
Ψt∗,t∗;1(v) = Xi +
Zjk, v ∈[ni]
Xi ∼Bin(ni −1, PA
Xj ∼Bin(nj, PA
Yj|Xj ∼Bin(
Zjk|Xj, Xk ∼Bin(XjXk, PA
Ψt∗,t∗−1;1(v) = X′
jk, v ∈[ni]
i ∼Bin(ni −1, P0
j ∼Bin(nj, P0
Hence, when P0 and PA are substituted, we have
eΨt∗;1,1(v) = Ψt∗,t∗;1(v) −Ψt∗,t∗−1;1(v)
j) + (Xi +
=eΨt∗;1,0(v) ·
j) + (Xi +
Thus, by using similar approaches given in the proof of lemma
3.2 and lemma 3.3 from , we obtain, as n →∞,
arg maxv∈[ni] eΨt∗;1,0(v) = arg maxv∈[ni] eΨt∗;1,1(v)
A(ni; Ψ) > µ′
= lim P(WA(ni; Ψ) > µA(ni; Ψ))
A(ni; Ψ) = maxv∈[ni] eΨt∗;1,1(v) and WA(ni; Ψ) =
maxv∈[ni] eΨt∗;1,0(v). This leads to the fact that (W ′
A(ni; Ψ))/β′
A(ni; Ψ) follows standard Gumbel distribution
G(0, 1) and S1,0,1(t∗; Φ) = max1≤i≤3 W ′
A(ni; Φ). Similar
arguments apply to S1,0,1(t∗−1; Ψ).
Before proving Theorem 5, we state and prove a technical
lemma on the correlations among the {eΦt;1,1(v)}.
Lemma 7. Let Gt−1 and Gt be two independent Erd¨os-R´enyi
graphs with connectivity probability p, i.e., Gt−1 ∼G(n, p)
DECOMPOSITION OF THE COVARIANCE TERMS IN Sτ,l,k(·, Ψ) FOR
τ = 1, l = 0, k = 1.
and Gt ∼G(n, p). For each v, eΦt;1,1(v) is deﬁned according
to Eq. (5). Then for any pair of vertices u and v, the
correlation between eΦt;1,1(u) and eΦt;1,1(v) is of order O( 1
Proof: From Eq. (5) and (6), for any pair of vertices
cov(eΦt;1,1(u), eΦt;1,1(v))
=cov(Φt,t;1(u), Φt,t;1(v)) −cov(Φt,t;1(u), Φt,t−1;1(v))−
cov(Φt,t−1;1(u), Φt,t;1(v)) + cov(Φt,t−1;1(u), Φt,t−1;1(v))
We then consider to decompose Φt,t;1(u) into two parts
representing the cardinalities of two disjoint sets of edges.
Φt,t;1(u) = Xt(u) + Yt(u)
where the intuitive interpretations behind two terms are listed
Xt(u) =|{(u, w) : (u, w) ∈E(Gt) and w ∈N1(u; Gt)\{u}}|
Yt(u) =|{(w1, w2) : (w1, w2) ∈E(Gt), w1 < w2 and
w1, w2 ∈N1(u; Gt)\{u}}|
Also, Φt,t−1;1(u) is decomposed into two terms as well.
Φt,t−1;1(u) = Xt−1(u) + Yt−1(u)
where the intuitive interpretations behind two terms are listed
Xt−1(u) =|{(u, w) : (u, w) ∈E(Gt) ∩E(Gt−1)
and w ∈N1(u; Gt)\{u}|
Yt−1(u) =|{(w1, w2) : (w1, w2) ∈E(Gt−1), w1 < w2 and
w1, w2 ∈N1(u; Gt)\{u}}|
Similarly, Φt,t;1(v) and Φt,t−1;1(v) are decomposed with the
same structure. By expanding above decompositions into Eq.
(20), we have the following table recording 16 terms and their
signs in (20).
In Table II, all terms earning the same color (blue, green
or magenta) and same positive/negative sign are symmetric.
Additionally, the terms having the same mark (†, ‡ or ⨿) are
canceled out due to the fact Yt(·)|Xt(·)
∼Yt−1(·)|Xt(·).
More concretely, for example, for four terms marked by
blue, we have cov(Xt(u), Yt(v)) = cov(Yt(u), Xt(v)) =
cov(Yt−1(u), Xt(v)) = cov(Xt(u), Yt−1(v)). The ﬁrst and
third equality are guaranteed by symmetry property. The second equality holds because Yt(u) and Yt−1(u) share the same
conditional distribution, Bin(
, p), given Xt(u). That
is, cov(Yt(u), Xt(v)|Xt(u)) = cov(Yt−1(u), Xt(v)|Xt(u))
and hence cov(Yt(u), Xt(v)) = cov(Yt−1(u), Xt(v)) with
application of law of total covariance.
We now return to Eq. (20). The above reasoning gives
cov(eΦt;1,1(u), eΦt;1,1(v))
=cov(Xt(u), Xt(v)) −cov(Xt(u), Xt−1(v))−
cov(Xt−1(u), Xt(v)) + cov(Xt−1(u), Xt−1(v))
Cauchy-Schwarz
inequality guarantees each of fours term are O(n) where
Xt(·) ∼Bin(n −1, p) and Xt−1(·) ∼Bin(n −1, p2).
In the following, to compute var(eΦt;1,1(u)), eΦt;1,1(u) is
decomposed as
eΦt;1,1(u) = Xt + Yt −Xt−1 −Yt−1
Xt ∼Bin(n −1, p),
Yt|Xt ∼Bin(
Xt−1|Xt ∼Bin(Xt, p),
Yt−1|Xt ∼Bin(
Yt|Xt ⊥Yt−1|Xt.
By applying law of total variance, we reach the following
variance order estimation
var(eΦt;1,1(u))
=Θ(var(Yt −Yt−1))
=Θ(E[var(Yt −Yt−1|Xt)] + var[E(Yt −Yt−1|Xt)])
p(1 −p)] + var )
=Θ(n2p3(1 −p))
Therefore, it follows that
corr(eΦt;1,1(u), eΦt;1,1(v)) = O( 1
as desired.
Theorem 5:
Again, to avoid redundant arguments, we
only provide derivations of limiting distribution of eΦt∗;1,1(v)
and the case t < t∗can be achieved in the same approach.
Let v ∈[ni], locality statistics Φt∗,t∗;1(v) and Φt∗,t∗−1;1(v)
are respectively decomposed as follows:
Φt∗,t∗;1(v) = Xi +
Zjk, v ∈[ni]
Xi ∼Bin(ni −1, PA
Xj ∼Bin(nj, PA
Yj|Xj ∼Bin(
Zjk|Xj, Xk ∼Bin(XjXk, PA
Φt∗,t∗−1;1(v) = X′
jk, v ∈[ni]
i|Xi ∼Bin(Xi, P0
j|Xj ∼Bin(Xj, P0
j |Xj ∼Bin(
Zjk|Xj, Xk ∼Bin(XjXk, P0
Accordingly, the mean of eΦt∗;1,1(v) is estimated as follows
E(eΦt∗;1,1(v))
=E(Φt∗,t∗;1(v) −Φt∗,t∗−1;1(v))
=E(eΦt∗;1,0(v))+
=E(eΦt∗;1,0(v)) + E(YB −Y ′
=np(1 −p) + ξ0(ni; Φ) + 1{i=B}nBδ(1 −p) + ζ(ni, p, δ, i)
Under our setting of P0 and PA, the penultimate equality
is obtained easily because Zjk and Z′
jk share the same
distribution and Yj share the same distribution with Y ′
Now let’s consider the estimation of var(eΦt∗;1,1(v)) since
the exact derivation of var(eΦt∗;1,1(v)), through the use of
law of total variance, is tedious. Due to the assumption
[n1, n2, . . . , nB] = [Θ(n), o(n), . . . , o(n)] and decompositions in Eq.(21) and Eq.(22), instead we express variance of
eΦt∗;1,1(v) as
var(eΦt∗;1,1(v))
=var(Φt∗,t∗;1(v) −Φt∗,t∗−1;1(v))
=var(Y1 −Y ′
1) + O(n2−ϵ)
=Cn2p3(1 −p) + O(n2−ϵ)
Thus, the central limit theorem leads to
eΦt∗;1,1(v) −E(eΦt∗;1,1(v))
Cn2p3(1 −p)
d−→N(0, 1)
dependencies
{eΦt∗;1,1(v)}v∈[ni] are negligible and thus
maxv∈[ni]eΦt∗;1,1(v) −µ′
A(ni; Φ) −µ′
−→G(0, 1).
Through similar arguments as in Theorem 1, we can show that
S1,0,1(t∗; Φ) = max1≤i≤B W ′
Corollary 6: This corollary is a generalization of Proposition 3 and Proposition 4. The underlying idea is as follows. In
the model presented at the beginnning of § V, the variation of
number of chatty blocks before t∗−1 makes no difference on
the sensitivity of statistics S1,0,1(t; Ψ) and S1,0,1(t; Φ) as long
as the orders of chatty blocks are o(n). Namely, in the limiting
Ψ are functions of nB and independent of
{n2, n3, . . . nB−1}. We can then extend the power comparison
conclusion from Proposition 4 for B = 3 to the general case.
The details are somewhat tedious and are omitted.