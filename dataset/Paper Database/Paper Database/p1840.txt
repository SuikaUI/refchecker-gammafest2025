FACULDADE DE ENGENHARIA DA UNIVERSIDADE DO PORTO
Detection of juxta-pleural lung nodules
in computed tomography images
M.Sc. Dissertation
Guilherme Moreira Aresta
Mestrado Integrado em Bioengenharia
Supervisor: Aurélio Campilho, Full Professor, FEUP
Co-supervisor: António Cunha, Assistant Professor, UTAD
June 23, 2016
Detection of juxta-pleural lung nodules in computed
tomography images
M.Sc. Dissertation
Guilherme Moreira Aresta
Mestrado Integrado em Bioengenharia
June 23, 2016
O cancro é uma patologia caracterizada por uma divisão anormal das células e posterior metástase
para outros tecidos. Esta doença é uma das principais causas de morte a nível mundial. Dos
diferentes tipos de cancro, o do pulmão é o mais letal. Contudo, o diagnóstico precoce aumenta a
taxa de sobrevivência dos pacientes. O diagnóstico pode ser feito através da detecção de nódulos
em imagens de tomograﬁa axial computorizada. No entanto, o cansaço, distração e limitações
do sistema visual humano reduzem o sucesso da detecção e consequentemente do diagnóstico da
patologia pelos especialistas. Por isso, o sucesso do diagnóstico pode ser melhorado através de
sistemas de detecção assistida por computador. Sabe-se que sistemas dedicados a um determinado
tipo de nódulo têm melhores resultados do que abordagens mais genéricas. Dos diferentes tipos
de nódulos, os justapleurais são aqueles com piores resultados de detecção.
Nesta dissertação propõe-se um método dedicado à deteção de nódulos justapleurais. O nosso
foco são nódulos com raio ≤5mm uma vez que estes são os mais difíceis de detectar. A abordagem proposta explora a diferença de intensidade entre os nódulos e o parênquima do pulmão,
bem como a sua estrutura naturalmente arredondada. Os potenciais candidatos são pesquisados
dentro de uma segmentação do volume do pulmão obtida através de uma técnica de crescimento
de regiões com base em intensidade. De forma a incluir os nódulos justapleurais, os contornos são
reﬁnados usando operações morfológicas e contornos activos. Os nódulos sólidos são detectados
através de uma saturação local da intensidade e da selecção de um limiar de segmetação apropriado. Os nódulos não-sólidos e sub-sólidos, por sua vez, são realçados através de uma ﬁltragem
muli-escala com Laplacianos-do-Gaussiano. Finalmente, os resultados das duas abordagens são
combinados para produzir uma lista de candidatos. Os falsos positivos mais óbvios desta lista são
eliminados através de regras ﬁxas relacionadas com o diâmetro dos candidatos. De seguida, características associadas com a intensidade, redondeza, geometria e localização dos candidatos são
usadas para treinar uma máquina de vectores de suporte e consequentemente reduzir o número de
falsos positivos. O nosso método foi desenvolvido e avaliado na "Lung Image Database Consortium image collection". Como esta base de dados não caracteriza os nódulos de acordo com a sua
posição, é também proposto um sub-conjunto apenas com nódulos justapleurais.
O sistema apresentado para detecção de nódulos justapleurais tem resultados equiparáveis ou
melhores do que os métodos do estado da arte. A sensibilidade do nosso método é de 57% com 4
falsos positivos por exame, aumentando para 62% se apenas forem considerados nódulos sólidos.
Cancer is characterized by an abnormal cell division and spread of cells to other tissues. This condition is a leading cause of death worldwide. From the different cancer types, lung cancer is the
most lethal. Survival rate is known to increase if the diagnosis is performed early, which can be
achieved by analyzing computed tomography scans. However, fatigue, distraction and limitations
of the human visual system reduce the overall detection and diagnosis success. Computer-aided
detection systems can improve nodule detection rate by providing a second opinion to the physicians. Computer-aided detection systems dedicated to speciﬁc kinds of nodules tend to outperform
general approaches. Nodules can be classiﬁed according to their location as isolated, peri-ﬁssural,
juxta-vascular and juxta-pleural. From these types of nodules, computer-aided detection systems
operate worse for juxta-pleural nodules.
A dedicated juxta-pleural lung nodule detection method is proposed. We focus on nodules
with radius ≤5mm because they are more challenging to detect. The proposed approach exploits
the intensity difference between the majority of the nodules and the parenchymal tissue, as well
as the partial roundness of these structures. Lung nodule candidates are searched inside a regiongrowing based lung volume segmentation that is reﬁned with morphological operations and active
contours to include juxta-pleural nodules. First, solid nodules are detected with a local contrast
saturation followed by the selection of an appropriate threshold over a sliding window. Sub-solid
and non-solid nodules are enhanced using multi-scale Laplacian-of-Gaussian ﬁltering. The results
from the two approaches are then combined to produce a single candidate list. The number of
false positives is reduced using ﬁxed-rules related to the radius of the candidates. Then, intensity,
blobness, geometric and location features are extracted and used to train a Support Vector Machine
classiﬁer with radial basis function to further reduce the number of false positive detections. The
method is developed and tested using the Lung Image Database Consortium image collection. This
dataset does not characterize nodules location-wise and thus a sub-dataset with the juxta-pleural
lung nodules is also proposed.
The proposed framework achieves similar or better juxta-pleural lung nodule detection performance in comparison to state-of-the-art methods. The achieved sensitivity is 57% with 4 false
positives per scan, increasing to 62% if only solid nodules are considered.
Acknowledgements
This work is ﬁnanced by the ERDF – European Regional Development Fund through the Operational Programme for Competitiveness and Internationalisation - COMPETE 2020 Programme,
and by National Funds through the FCT – Fundação para a Ciência e a Tecnologia within project
POCI-01-0145-FEDER-016673
Motivation, objectives and contributions . . . . . . . . . . . . . . . . . . . . . . . . .
M.Sc. dissertation overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Introduction
Anatomical context . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Lung cancer and computed tomography . . . . . . . . . . . . . . . . . . . . . .
Lung nodule computer-aided detection systems . . . . . . . . . . . . . . . . . .
Types of lung nodules
. . . . . . . . . . . . . . . . . . . . . . . . . . .
The LIDC/IDRI dataset . . . . . . . . . . . . . . . . . . . . . . . . . . .
Concluding remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Methods for lung nodule detection in CT images
Lung nodule detection steps
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
Candidate detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Candidate reﬁnement . . . . . . . . . . . . . . . . . . . . . . . . . . . .
False positive reduction
. . . . . . . . . . . . . . . . . . . . . . . . . .
Representative lung nodule detection algorithms . . . . . . . . . . . . . . . . . .
Juxta-pleural nodules speciﬁc approaches . . . . . . . . . . . . . . . . .
Results review . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Detection per nodule type
. . . . . . . . . . . . . . . . . . . . . . . . .
Concluding remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Juxta-pleural lung nodule detection
Method overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Lung volume segmentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Initial lung volume segmentation . . . . . . . . . . . . . . . . . . . . . .
Active contour reﬁnement . . . . . . . . . . . . . . . . . . . . . . . . .
Dataset of juxta-pleural lung nodules . . . . . . . . . . . . . . . . . . . . . . . .
Candidate detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Direct threshold . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Blob enhancement . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
False positive reduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Fixed-rules based FP reduction . . . . . . . . . . . . . . . . . . . . . . .
Supervised learning FP reduction
. . . . . . . . . . . . . . . . . . . . .
Performance evaluation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Concluding remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Results and discussion
Dataset of juxta-pleural nodules
. . . . . . . . . . . . . . . . . . . . . . . . . .
Lung volume segmentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Candidate detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
False positive reduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Fixed-rules based FP reduction . . . . . . . . . . . . . . . . . . . . . . .
Supervised learning FP reduction
. . . . . . . . . . . . . . . . . . . . .
Comparison with existing methods . . . . . . . . . . . . . . . . . . . . . . . . .
Concluding remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Conclusion and Future work
A Juxta-pleural lung nodules
References
List of Figures
Schematic representation of the anatomy of the lungs. Adapted from OpenStaxCollege-
Anatomy&Physiology . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Hounsﬁeld unit values for different types of tissue and materials commonly present
in a CT scan. −1000 corresponds to black and +1000 to white. Image from Holmes
et al. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Example of a slice from a CT scan. Relevant structures (blood vessels, bone,
ﬁssures and lung parenchyma) are depicted. CT scan image from TheCancer-
ImagingArchiveTeam.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Nodule types according to opacity. Images from TheCancerImagingArchiveTeam.
Nodule types according to relative location to lung structures. Images from TheCancerImagingArchiveTeam. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Overall structure of a lung nodule detection algorithm.
. . . . . . . . . . . . . .
Steps for juxta-pleural lung nodule detection using α-hulls. i) juxta-pleural lung
nodule; ii) pleural surface; iii) α-hull partially overlaying the pleural surface; iv)
segmented nodule, resulting from the subtraction of the α-hull to the pleural surface. 12
Steps for juxta-pleural lung nodule detection using directional-gradient concentration. i) juxta-pleural lung nodule; ii) pleural surface; iii) normals to the surface;
iv) detection of the nodule as the region with higher surface normals overlap.
Commonly used classiﬁers for false positive reduction of nodule candidates. . . .
Sensitivity (%) and respective number of false positives/scan for different methods. The minimum nodule diameter (mm), range of slice thickness (mm) and
number of scans studied are also shown. Values retrieved from: 1) Alilou et al.
 ; 2) Brown et al. ; 3) Camarlinghi et al. ; 4) Cascio et al.
 ; 5) Choi and Choi ; 6) Choi and Choi ; 7) van Ginneken et al.
 ; 8) Golosio et al. ; 9) Guo and Li ; 10) Han et al. ; 11)
Messay et al. ; 12) Opfer and Wiemker ; 13) Setio et al. ; 14)
Han et al. ; 15) Setio et al. ; 16) Tan et al. ; Setio et al. ;
17) Tan et al. ; 18) Teramoto and Fujita . . . . . . . . . . . . . . . .
Average sensitivity values of several rates of false positives/scan (2−3, 2−2, ..., 23)
for different type of nodules and algorithms. Data retrieved from van Ginneken
et al. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Schematic representation of the proposed method. . . . . . . . . . . . . . . . . .
Relevant steps of the region growing-based algorithm for lung volume segmentation. The initial segmentation (prior to reﬁnement) does not include nodules.
Nodules are included after the segmentation is reﬁned with a morphological closing. Blue scale bar corresponds to 5mm. . . . . . . . . . . . . . . . . . . . . . .
LIST OF FIGURES
Details of the correction of the lung volume segmentation via the Chan-Vese active
contour method. The inclusion of juxta-pleural nodules is improved (c and d).
Blue scale bar corresponds to 5mm.
. . . . . . . . . . . . . . . . . . . . . . . .
Examples of nodules considered as juxta-pleural. Each example is retrieved from
a scan and slice (LIDC-IDRI case#, slice#). Blue scale bar corresponds to 5mm. .
Steps for juxta-pleural nodule detection. (a)-(d): solid nodule; (f)-(i): sub-solid
nodule; (k)-(n): non-solid nodule. For the blob enhancement step, Laplacian-of-
Gaussian ﬁlters with σ = {1,1.5,2} are used. Each example is retrieved from a
scan and slice (LIDC-IDRI case#, slice#). Blue scale bar corresponds to 5mm. . .
Examples of Laplacian of Gaussian blob enhancement ﬁlters for different σ values.
Examples of nodules removed from the juxta-pleural dataset. Each example is
retrieved from a scan and slice (LIDC-IDRI case#, slice#). Blue scale bar corresponds to 5mm. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Statistics retrieved from the LIDC-IDRI, with special focus on juxta-pleural nodules. Small juxta-pleural nodules have radius ≤5mm. . . . . . . . . . . . . . . .
Examples of juxta-pleural lung nodules with radius ≤5mm (ﬁrst row) and nonnodule structures (second row). Each example is retrieved from a scan and slice
(LIDC-IDRI case#, slice#). Blue scale bar corresponds to 5mm.
. . . . . . . . .
Examples of nodules not included in the lung volume segmentation due to their
location near the limits of the lungs. Each example is retrieved from a scan and
slice (LIDC-IDRI case#, slice#). Blue scale bar corresponds to 5mm. . . . . . . .
3D reconstruction of a juxta-pleural lung nodule candidate (orange) along with the
ground-truth (yellow). The correspond initial, middle and ﬁnal slices are shown.
Each example is retrieved from a different slice (LIDC-IDRI case#, slice#). Blue
scale bar corresponds to 5mm.
. . . . . . . . . . . . . . . . . . . . . . . . . . .
Juxta-pleural lung nodules with radius ≤5mm (ﬁrst row) and respective detection
(second row). Each example is retrieved from a scan and slice (LIDC-IDRI case#,
slice#). Blue scale bar corresponds to 5mm. . . . . . . . . . . . . . . . . . . . .
Juxta-pleural lung nodule candidates marked with orange contour. The yellow
contour corresponds to the ground-truth. Each example is retrieved from a scan
and slice (LIDC-IDRI case#, slice#). Blue scale bar corresponds to 5mm.
ROC curves of the proposed classiﬁer for the detection of juxta-pleural nodules
with radius ≤5mm after the false positive reduction. The standard deviation is
shown in yellow. Specialists’ agreement level is at least 1.
. . . . . . . . . . . .
FROC curves of the proposed system for the detection of juxta-pleural nodules
with radius ≤5mm after the false positive reduction. Specialists’ agreement level
is at least 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
List of Tables
Features used for supervised learning. . . . . . . . . . . . . . . . . . . . . . . .
Number of scans and juxta-pleural nodules in the studied 729 scans from the
LIDC-IDRI dataset. Small juxta-pleural nodules are those with radius ≤5mm. . .
Inclusion of juxta-pleural nodules and juxta-pleural nodules with radius ≤5mm
by the segmented lung volume. . . . . . . . . . . . . . . . . . . . . . . . . . . .
Maximum achieved sensitivity values (%) for the proposed method, prior to the
false positive reduction step, per nodule texture and minimum agreement level
between specialists. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Maximum sensitivity values (%) for juxta-pleural nodules reported by Retico et al.
 ; De Nunzio et al. ; Han et al. . . . . . . . . . . . . . . . . .
Maximum achieved sensitivity values (%) for the proposed method, after the false
positive reduction step, per nodule texture and minimum agreement level between
specialists. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Area under the ROC curve of the classiﬁers used to reduce the number of juxtapleural nodules reported by Retico et al. ; De Nunzio et al. ; Han
et al. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Performance of the proposed juxta-pleural lung nodule detection method for different nodule textures.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Juxta-pleural lung nodule detection performance of different systems. r is the
nodule radius. A - Retico et al. , B - De Nunzio et al. , C - Han
et al. , D - Fujitalab, E - Region growing volume plateau, F - Channeler Ant
model, G - Voxel-based neural approach, H - ISI-CAD, I - Philips Lung Nodule
CAD ).
. . . . . . . . . . . . . . . . . . . . . . . .
Juxta-pleural lung nodules available in the LIDC-IDRI dataset (1 out of 6) . . . .
Juxta-pleural lung nodules available in the LIDC-IDRI dataset (2 out of 6) . . . .
Juxta-pleural lung nodules available in the LIDC-IDRI dataset (3 out of 6) . . . .
Juxta-pleural lung nodules available in the LIDC-IDRI dataset (4 out of 6) . . . .
Juxta-pleural lung nodules available in the LIDC-IDRI dataset (5 out of 6) . . . .
Juxta-pleural lung nodules available in the LIDC-IDRI dataset (6 out of 6) . . . .
LIST OF TABLES
Abbreviations and Symbols
Two-dimensional
Three-dimensional
Computer-aided detection
Computer-aided diagnosis
Computed tomography
Feed-forward neural networks
False positive
Free-response receiver operating characteristc
Hounsﬁeld unit
The Lung Image Database Consortium image collection
Laplacian-of-Gaussian
Support Vector Machine
Receiver operating characteristc
True positive
Motivation, objectives and contributions
Lung cancer is the most lethal type of cancer. CT is commonly used for detecting lung cancer. An
early detection greatly increases the survival rate of the patients. However, fatigue and distraction
errors, together with lack of experience and limitations of the visual system, cause physicians
to fail during the nodule detection process. CADe systems are thus of interest, providing to the
specialists a second opinion during their exam observation. The combination of CADe systems
dedicated to a speciﬁc type of lung nodule is known to outperform more general approaches. The
LIDC/IDRI is a lung CT public dataset used for training, testing and comparing the performance
of CADe systems. Lung nodule CADe systems are usually composed by 3 steps: initial candidate
detection, candidate reﬁnement and FP reduction. Initial candidate detection is performed by using
HU-based approaches, blob detectors or shape analysis. Candidates can be reﬁned with region
growing or active contours. The number of FPs can be reduced by using ﬁxed rules followed by a
binary classiﬁcation with a trained classiﬁer such as a SVM or a neural network.
Lung nodules can be classiﬁed according to their relative location to other lung anatomical
structures as isolated, peri-ﬁssural, juxta-vascular or juxta-pleural. Juxta-pleural nodules are lung
lesions that occur near the pleura. These nodules have similar intensity to the pleural wall and
their shape is more variable than other nodules. Considering these characteristics, the currently
used approaches for automatic lung nodule detection in CT scans do not usually perform well for
juxta-pleural nodule detection. In fact, these nodules tend to be the most difﬁcult type of nodule
to detect. Furthermore, there are few works addressing speciﬁcally the detection of juxta-pleural
nodules in CT images. The following objective for the M.Sc. dissertation is thus proposed:
• development of a dedicated method for the detection of juxta-pleural nodules in lung CT
images. The dedicated method overcomes several detection issues related to the characteristics of juxta-pleural nodules. The LIDC/IDRI dataset is used for the development of the
algorithm. The proposed solution may be used for improving the performance of a multiapproach CADe system currently in development by the C-BER group.
The LIDC/IDRI dataset does not characterize lung nodules according to their location. Consequently, to validate our method, a sub-dataset with the juxta-pleural lung nodules existent in the
LIDC/IDRI is also presented.
Several contributions to the state-of-the-art result from this research:
• creation of a juxta-pleural lung nodule sub-dataset from the LIDC/IDRI dataset; to our
knowledge this sub-dataset is the ﬁrst to consider the majority of the scans of the LIDC/IDRI
dataset and to be manually revised;
• improvement of the lung volume segmentation algorithm of the C-BER group in terms of
juxta-pleural lung nodule inclusion;
• proposal of a juxta-pleural lung nodule detection method, with focus on nodules with radius
≤5mm; the method shows up-to state-of-the-art results and unlike other works considers all
non-solid, sub-solid and solid nodules.
M.Sc. dissertation overview
The M.Sc. dissertation is organized as follows. Chapter 1 presents the anatomical context of
the problem in study, along with the fundamentals of CT imaging and lung cancer detection.
The characterization of lung nodules in terms of texture and location is also referred. Chapter 2
describes the state-of-the-art methods for the detection of lung nodules in CT scans, with focus on
approaches dedicated to juxta-pleural lung nodules. Then, the overall and location-speciﬁc lung
nodule detection performance of different systems is presented and discussed.
Chapter 3 presents our juxta-pleural lung nodule detection method. The method exploits the
intensity difference between parenchymal tissue and lung nodules as well as the roundness of these
abnormalities. Then, in Chapter 4, the performance of our system is discussed and compared to
the state-of-the-art. Chapter 5 summarizes the main conclusions of the performed research and
suggests future work to further improve the method.
Introduction
Anatomical context
The lungs (Fig. 1.1) are a set organs located within the thorax and are the most important organs
of respiration. Each lung has an apex and a base (superior and inferior portion, respectively),
three borders and two surfaces (costal and mediastinal). The right lung has 3 lobes and the left
2 lobes. The lungs are invested by a serous membrane called pleura, composed by an internal
(visceral) layer and an external (parietal) layer separated by the pleural cavity. The heart (and
other mediastinum contents) are in the central portion of the thoracic cavity and separate the two
lungs. Structures like the rib cage help to protect these organs from impacts. The intercostal
muscles participate in the breathing process. The air reaches the lungs via the trachea, which
branches into the main left and right bronchi. Each of these bronchi subdivide in progressively
smaller structures, thus allowing gas exchange with the pulmonary capillaries ).
Intercostal
Parietal pleura
Pleural cavity
Visceral pleura
Figure 1.1:
Schematic representation of the anatomy of the lungs.
Adapted from
OpenStaxCollege-Anatomy&Physiology .
Introduction
Lung cancer and computed tomography
Cancer is a group of diseases characterized by an abnormal cell division and spread of these cells
to other tissues ). According to WorldHealthOrganization , “cancer is a leading
cause of death worldwide, accounting for 8.2 million deaths in 2012”. Among all cancers, lung
cancer is the most lethal, being responsible for 1.59 million deaths, i.e, approximately 20% of
cancer related deaths. The 5-year survival rate of patients with lung cancer in developed countries
is approximately 20%. This is partially due to the late diagnosis of the pathology. When diagnosed
in early stages, the 5-year survival rate increases to over 50% ; Siegel et al.
 ). Lung cancer is usually a result of unhealthy lifestyles, which include active and passive
smoking and exposure to dangerous chemicals ).
Lung cancer screening and preliminary diagnosis is performed using non-invasive imaging
techniques, including chest X-ray, magnetic resonance and computed tomography (CT). From
these, CT is the most widely used due to the simplicity of the procedure and good imaging
results ; Bach et al. ). A CT image is produced by radiating selected portions of the body with X-photons and measuring the resulting intensity after the traverse. The attenuation value, or tissue density, of a given portion of the body is then assigned to a
voxel ). It is possible to standardize the attenuation value attributed to each
voxel by using Hounsﬁeld units (HU). HU correspond to the comparison of the attenuation value
of the tissue with the attenuation value of water. The resulting scale, centered in the HU value of
water (zero) ), is shown in Fig. 1.2.
Soft tissue
Soft tissue
+400 +1000
Figure 1.2: Hounsﬁeld unit values for different types of tissue and materials commonly present in
a CT scan. −1000 corresponds to black and +1000 to white. Image from Holmes et al. .
In a standardized CT procedure the equipments are calibrated so that the Hounsﬁeld scale
remains true. By maintaining constant the HU, it is possible to easily segment different types
of tissues. Note that HU levels may sometimes vary between equipments as result of different
radiation energies and other properties. HU are of interest for diagnosis: by selecting an adequate
range of HU values (i.e., a visualization window), the specialist can analyze different structures
and details of interest for the detection of the pathology.
1.3 Lung nodule computer-aided detection systems
Multi-slice CT is the most common type of CT imaging. The popularity results from the fact
that this technique allows, in relation to its predecessors, to scan large anatomic portions (such
as lungs) with low slice thickness. Fig. 1.3 shows an example of a CT scan, as well as relevant
anatomical structures. In these slices it is possible to distinguish blood vessels, a ﬁssure (result of
the interface between the lung nodules), the pleura and the lung parenchyma.
Blood vessel
parenchyma
Figure 1.3: Example of a slice from a CT scan. Relevant structures (blood vessels, bone, ﬁssures
and lung parenchyma) are depicted. CT scan image from TheCancerImagingArchiveTeam.
Thin slices are important because they allow high-quality 3D reconstructions and reduce the
partial-volume effect ). The partial-volume effect is the reduction of sharpness
of the image and alteration of the image intensity due to the imaging process ).
In a 3D CT image, each voxel intensity is the result of the average attenuation of the respective
portion of tissue. When slice thickness increases, the portion of tissue used for assessing the
intensity of a given voxe also increases. Due to the averaging, structures become blurred and their
overall intensity changes, which is most of the times undesirable for medical imaging analysis.
Lung nodule computer-aided detection systems
The detection of lung cancer cases in CT images is usually performed by trained physicians. In
a routine examination, the specialists visually detect the nodules. Nodules are rounded abnormal structures that may indicate primary lung cancers, metastatic diseases or non-cancerous processes ). During the procedure, the physicians annotate the nodule positioning and dimension for further follow-up. However, fatigue and distraction errors, together with
lack of experience and limitations of the visual system, reduce the detection rate and correct classiﬁcation of nodules ). As so, the development of automatic/semi-automatic
tools that aid the physicians in nodule detection and diagnosis is of interest. These tools can be
generically named as computer-aided detection (CADe) systems and computer-aided diagnosis
(CADx) systems. The former has as objective to detect information of interest to the physician
(such as the location of possible nodules in a CT scan); the latter is aimed to give a second opinion
to the specialist regarding the ﬁnal diagnosis ). This work will contribute to
the development of a CADe system for lung cancer screening in CT images. CADe systems can
be general or dedicated to a speciﬁc nodule type. The combination of dedicated CADe systems
Introduction
has shown to improve results in comparison to separated systems ; De
Nunzio et al. ). For this purpose, it is important to consider these different types of nodules.
Types of lung nodules
Lung nodules can be classiﬁed in different ways. The most obvious is perhaps the binary classi-
ﬁcation as benign or malign. This classiﬁcation is of interest for CADx systems. Nevertheless,
nodules can also be classiﬁed according to their texture and location. In CADe systems, the detection process should be adjusted according to the intrinsic characteristics of each kind of nodule.
Nodule texture
In terms of texture, nodules can be classiﬁed as solid, sub-solid and non-solid (or ground-glass
opacities) nodules. Solid nodules (Fig. 1.4a) are those that completely obscure the parenchyma.
They are relatively easy to identify, even for less experienced observers, and their margins are
usually well deﬁned. Non-solid nodules (Fig. 1.4c) are diffused abnormalities in the parenchyma.
The shape of non-solid nodules is highly irregular and difﬁcult to characterize, showing in CT
scans as cloudy areas. Sub-solid nodules (Fig. 1.4b) combine the features from solid and nonsolid nodules, only partially obscuring the lung parenchyma.
(b) Sub-solid
(c) Non-solid
Figure 1.4: Nodule types according to opacity. Images from TheCancerImagingArchiveTeam.
Nodule location
Nodules can be classiﬁed according to their location relatively to other structures in the lungs.
According to van Ginneken et al. , lung nodules can be classiﬁed as isolated, peri-ﬁssural,
juxta-vascular and juxta-pleural. Fig. 1.5 shows an example of each kind of these nodules.
Isolated nodules (Fig. 1.5a) are well-circumscribed rounded structures in the central region of
the lung parenchyma. They show no connection to blood vessels, ﬁssures or pleura. These nodules
tend to be the simplest to detect using a CADe system, as no special attention to other structures has
to be considered. Peri-ﬁssural nodules (Fig. 1.5b) are triangular or oval shapped abnormalities that
occur in the periphery of the lung ﬁssures. These nodules are usually non-malignant; nevertheless,
their follow-up is still recommended ). Juxta-vascular nodules (Fig. 1.5c) are
abnormalities that appear attached to vascular structures. In CADe systems, these nodules are
challenging to detect as their intensity is similar to the intensity of blood vessels ).
1.3 Lung nodule computer-aided detection systems
(a) Isolated
(b) Peri-ﬁssural
(c) Juxta-vascular
(d) Juxta-pleural
Figure 1.5: Nodule types according to relative location to lung structures. Images from TheCancerImagingArchiveTeam.
Juxta-pleural nodules (Fig. 1.5d) are nodules attached to the pleura, the interface membrane
between the lung parenchyma and the exterior muscular and fat tissues. Juxta-pleural nodules
show different shapes: they can be rounded structures attached by a tail to the pleura (as in
Fig. 1.5d) or they can be elongated with direct contact to the mentioned membrane. Shape variety and intensity similarity between juxta-pleural nodules and the adjacent tissues difﬁcult the
automatic detection of this kind of nodules. In fact, according to van Ginneken et al. ,
juxta-pleural nodules tend to be the more challenging type of nodule to detect.
The LIDC/IDRI dataset
CADe systems must be validated prior to their use in the clinical environment. CADe validation
should be performed considering a large range of possible scenarios, as robustness is essential.
Large and representative datasets should thus be used for testing CADe performance. Furthermore,
the usage of public datasets should be encouraged to ease the comparison between systems.
The Lung Image Database Consortium image collection ; TheCancer-
ImagingArchiveTeam) is one of the largest publicly available dataset aimed at the development of
lung nodule detection and classiﬁcation systems using CT scans. Each scan from the dataset was
evaluated by four experienced thoracic radiologists from a universe of twelve specialists. Structures of interest were divided in 3 categories: i) nodule with diameter < 3mm, ii) nodule with
diameter ≥3mm and iii) non-nodule with diameter ≥3mm. Non-nodules are lung lesions that
have no cancerous characteristics (an apical scar, for instance). CADe systems tend to detect these
lesions and so their identiﬁcation is important.
The main focus of the dataset is to promote the study of ≥3mm diameter nodules. The dataset
contains segmentations (ground-truths) of these nodules. Nodules with ≥3mm diameter also have
a subjective evaluation of several characteristics: i) subtlety (difﬁculty in detection), ii) internal
structure/composition (soft tissue, ﬂuid, fat, air), iii) calciﬁcation, iv) sphericity (overall roundness of the nodule), v) margin (how well-circumscribed is the nodule), vi) spiculation, vii) texture (solid, non-solid or sub-solid) and viii) malignancy (assuming a 60-year-old male smoker).
These characteristics are not usually of interest for CADe systems. However, they can be used
for evaluating the performance considering these subjective evaluations. For the smaller nodules
Introduction
and non-nodules only the center-of-mass is indicated. Furthermore, regardless nodule size, no
location-based classiﬁcation (isolated, peri-ﬁssural, juxta-vascular or juxta-pleural) is provided.
The ground-truth was established in two phases. In a ﬁrst phase, each of the four specialists
analyzed the scans without access to the work of the others. Segmentations were performed manually or using a semi-automatic software. In the second phase, the ground-truths were revised
based on the work of the other radiologists. The radiologists were not forced to segment structures
considered as nodules by other radiologists. Consequently, each nodule has assigned an Agreement level. If all radiologists agreed that a given abnormality was a nodule, then the Agreement
level is 4. Nodules with higher Agreement level should be easier to detect, as they tend to be more
obvious. However, several other factors, namely location, should be taken into account.
The dataset contains 1 012 scans, with a total of 7 371 nodules. From these, 2 669 nodules
have a diameter ≥3mm. Approximately 35% of these nodules have an Agreement level of 4 and
29% have an Agreement level of 1.
Concluding remarks
Lung cancer is the most lethal type of cancer. The survival rate increases to over 50% if the
diagnosis is performed early. CT scanning is used for lung nodule detection. However, fatigue,
distraction and limitations of the human visual system reduce the overall detection and diagnosis
performances. CADe systems can help to improve nodule detection rate.
The combination of dedicated CADe systems usually outperforms general approaches. For the
different nodule locations (isolated, peri-ﬁssural, juxta-vascular and juxta-pleural), CADe systems
tend to perform worse for juxta-pleural nodules. The LIDC/IDRI dataset can be used for the
development and performance evaluation of lung nodule CADe systems. Although providing
several important characteristics, no nodule location-based classiﬁcation is given.
Methods for lung nodule detection in
An automatic lung cancer diagnosis system usually comprises 3 major steps: i) candidate nodule
detection, ii) candidate analysis (segmentation and feature extraction) and iii) candidate classiﬁcation. Candidate detection consists in the determination of the 3D location of the nodules.
The main objective of the proposed work is the development of a lung nodule detection algorithm dedicated to juxta-pleural nodules. The resulting CADe system can either serve as a tool to
guide physicians in the location of this type of nodules or integrate a more complex system as the
ﬁrst step indicated above. Ideally, CADe systems should guarantee the correct localization of all
the nodules in the scan (true positives, TP) and reduce/eliminate erroneous detections (false positives, FP). A review of works regarding lung nodule detection in CT images is presented in this
chapter. Note that in our review it is assumed that the lung volume is already correctly segmented,
which may prove to be challenging ).
The analyzed works were selected by using mainly the following criteria: i) the publishing year
should be 2006 or higher (at most 10 years old); ii) validation should preferably be performed in
the LIDC/IDRI dataset, simplifying direct comparison between works and iii) the main focus of
the work should be nodule detection. The reviewed works were researched using GoogleScholar,
Scopus and ScienceDirect search engines. The keywords used for searching general lung nodule
detection approaches were lung, nodule detection, CT. For juxta-pleural nodules, the used keywords were pleural, juxtapleura, juxtapleural, juxta-pleura, juxta-pleural and nodule detection.
Lung nodule detection steps
The overall structure of a lung nodule detection algorithm is depicted in Fig. 2.1.
A lung nodule detection algorithm is usually comprised by 3 parts: i) candidate detection
(section 2.1.1), ii) candidate reﬁnement (section 2.1.2) and iii) FP reduction (section 2.1.3). An
explanation of each of these parts is given in the remaining of this section. Special attention should
Methods for lung nodule detection in CT images
Candidate detection
Shape analysis
Hounsfield unit
based threshold
Blob detector
Candidate refinement
Removal of attached
structures
Nodule region
Active contour
False positive reduction
Rule-based
(volume and diameter)
Classifier-based
(feed-foward neural
networks, support
vector machines, ...)
Figure 2.1: Overall structure of a lung nodule detection algorithm.
be given to shape analysis and active contour methods, for candidate detection and reﬁnement,
respectively, as they can be used for juxta-pleural nodule detection.
Candidate detection
The ﬁrst step is the detection of nodules candidates. This procedure should ideally guarantee a
100% sensitivity, i.e., all the existing nodules should be detected. Usually, the resulting number
of FP is very high as we are still in an initial detection stage. The initial candidate detection
can be achieved by HU intensity-based thresholding, by using blob detectors or by using region
growing of the parenchyma to detect the regions/structures of interest. The latter is of interest
for the detection of juxta-pleural nodules, because juxta-pleural nodules with solid texture cause
deformations in the limits of the lung mask.
HU intensity-based methods
The standardization of CT imaging techniques allows the fast
identiﬁcation of anatomic structures via HU intensity-based threshold (Fig. 1.2). The simplicity
and low computational costs make this method attractive for initial candidate location ; Messay et al. ; Han et al. ; Jacobs et al. ; Setio et al. ). These
methods allow to obtain both location and a rough segmentation of the candidates. HU thresholding can be performed considering one or multiple threshold levels. For instance, Setio et al.
 used an intensity threshold of −300 HU to identify solid nodules. Alilou et al. , on
the other hand, combined the result of multiple threshold levels to identify lung nodules. Note
that, by themselves, HU intensity-based threshold methods seem to not be viable for juxta-pleural
nodule location due to the intensity similarity between nodules and fat tissue ). They can, however, be of interest for preliminary detections if a proper lung segmentation is available.
Region growing of the parenchyma, based on known HU values, can also be used for the
initial detection of candidates. Seed points in the parenchyma are selected via analysis of the HU
histogram. The intensity of the neighbor pixels of the seed points is studied. If the pixels respect
a given threshold criteria, they are included in the region. The threshold is reestablished based on
the new region. The process is performed iteratively until no more pixels are added ). Once the region growing process is complete, the candidates can be obtained by
subtracting the resulting mask to a lung mask ).
Blob detectors
Blob detection-based methods are used for enhancement or detection of rounded/
spherical structures. The rounded shape of the nodules makes blob detectors a viable method for
initial candidate location. Furthermore, these methods, unlike simple thresholding, are more robust
to the presence of adjacent structures, such as vessels. A common blob detector has the following
stages: for all voxels, a 3×3 Hessian matrix is calculated by using the response of the second
order derivative of a 3D-equivalent Gaussian curve. Then, the eigenvalues |λ3| ≤|λ2| ≤|λ1| are
retrieved. The eigenvalues allow to compute blobness metrics. Retico et al. ; Guo and Li
 ; Choi and Choi used the metric described in Li et al. :
zdot(λ1,λ2,λ3) =
|λ3|2/|λ1|
if λ1 < 0, λ2 < 0, λ3 < 0
if otherwise
Murphy et al. ; Novo et al. consider the shape index (SI) and curvedness (CV):
π arctan ). Detection of juxta-pleural lung nodules can be performed by detecting concavities in the lung mask. Concavities can be found by using α-hulls ;
Ta¸scı and U˘gur ). The α-hull is a generalization of the convex-hull concept. The shape of
the α-hull depends on the parameter α: given a set of points S, “the α-hull of S is the intersection of the closed components of all the circles of radius r=1/α, such that the intersection of these
circles with S is empty” ). A low α value means higher curvature radius
of the hull; in the limit, if α=0, a convex-hull is obtained. By using different values of α and by
subtracting the resulting hulls to the initial mask, it is possible to ﬁnd the concavities. This method
also allows to obtain a segmentation of the candidate. Fig. 2.2 illustrates the discussed process.
Juxta-pleura nodules can be detected by evaluating the directional-gradient concentration, as
described in Retico et al. . The directional-gradient concentration consists in the analysis
of the number of intersections of the surfaces normals. The pleural surface can be discretized by
a ﬁnite number of triangular elements. Each of these triangles has a vector normal to its surface.
Methods for lung nodule detection in CT images
Pleural surface
segmented nodule
Figure 2.2: Steps for juxta-pleural lung nodule detection using α-hulls. i) juxta-pleural lung nodule; ii) pleural surface; iii) α-hull partially overlaying the pleural surface; iv) segmented nodule,
resulting from the subtraction of the α-hull to the pleural surface.
The voxels adjacent to the pleural surface are scored according to the number of intersections of
normal directional lines that occur in it. Regions with high concentration of intersections indicate
prominences in the pleura, which, by its turn, are indicative of the presence of lung nodules. The
detection method using the directional-gradient concentration is illustrated in Fig. 2.3.
Pleural surface
Surface normals
High concentration
Figure 2.3: Steps for juxta-pleural lung nodule detection using directional-gradient concentration.
i) juxta-pleural lung nodule; ii) pleural surface; iii) normals to the surface; iv) detection of the
nodule as the region with higher surface normals overlap.
Candidate reﬁnement
The candidate detection step usually results either in a rough segmentation or in the approximate
coordinates of the centroid of the nodule candidates. Also, the number of FP candidates is high.
Prior to reducing the number of FP, it is necessary to remove possible attached structures (such
as vessels or the pleural wall) and correct the segmentation of the nodule. The removal of connected structures is usually performed using morphological operations. Segmentation can either
be performed by intensity-based region growing or by using active contours techniques.
Removal of attached structures
Structures like vessels or the pleural wall have HU values similar to lung nodules. Lung nodules can appear near vessels and the pleural wall (juxta-vascular
and juxta-pleural nodules, respectively). As a consequence, after candidate detection, these nodules may be attached to these structures. The removal of the attached structures can be performed
using morphological operations ; Messay et al. ; Badura and Pietka
 ). A binary structuring element is shifted over the binary mask of the candidates. If the
2.1 Lung nodule detection steps
structuring element matches partially or completely the current portion of the mask, the respective
pixel of interest is changed to 1 (dilation) or 0 (erosion). Opening, which is an erosion followed
by a dilation using the same structuring element, is often used. Both 2D and 3D morphological
operations can be used. 2D operations are less computationally complex, which may prove to be
advantageous ).
Intensity-based region growing
Nodule segmentation can be performed using intensity-based
region growing. The seed points needed for region growing are obtained from the rough segmentation resulting from the initial candidate detection or by considering the candidates’ centroid. 3D
region growing is a common candidate reﬁnement technique ; Guo and Li
 ; Brown et al. ; Setio et al. ). As stated in section 2.1.1, a region growing
algorithm is an iterative process of inclusion of neighbor pixels with similar characteristics. In a
3D algorithm, the neighbors from the same slice and adjacent slices are analyzed. Region growing
algorithms are effective for the segmentation of isolated nodules. However, using region growing
in nodules near other anatomic structures may result in the inclusion of these structures in the
candidate due to the similarity in intensity.
Active contour
Active contours are a computer vision technique that allow to segment images
by delineation of the structure of interest. Due to their complexity but good results, active contours are often used for nodule classiﬁcation instead of nodule detection, as shape is an essential
characteristic to classify a nodule ). Nevertheless, active contour techniques
can also be used for candidate reﬁnement in nodule detection algorithms ).
This technique may be of interest for juxta-pleural nodule detection as it is more robust to the inclusion of adjacent structures than region growing. A standard shape is initialized in the candidate
region. Then, the position of interrelated points is iteratively updated considering two types of
energy, internal and external. The internal energy (Energyinternal) is inherent to the model itself.
It regulates how the model contracts and curves to adapt to the shape to segment. External energy, on the other hand, regards the contribution of the image to the ﬁnal shape. External energy
(Externalenergy) is a function of the gradient of the image intensity. For segmentation of lung nodules, higher gradient values and low intensity values imply lower external energy. The objective of
the process is to minimize the overall model energy, resulting from the contribution of each model
point p ; Cascio et al. ):
Energytotal = min(∑
[Energyinternal(p)+Energyexternal(p)])
False positive reduction
The initial candidate detection produces a high number of FPs. The candidate reﬁnement step
allows to improve the segmentation of the candidates. The last step is the reduction of the number
of FPs based on the characteristics of the candidates. Two procedures are used: ﬁrst, a ruled-based
Methods for lung nodule detection in CT images
analysis is performed to eliminate candidates that obviously are not nodules; then, features are
retrieved from the remaining candidates for classiﬁcation in nodule or non-nodule.
Rule-based false positive reduction
The majority of works addressing lung nodule detection
focus on nodules with diameter ranging approximately between [3 30](mm). This happens because nodules with higher radius are easy to detect and small nodules appear to not have much
importance for immediate diagnosis ; Valente et al. ). Both diameter and
volume (equivalent to a sphere of the same diameter) are commonly used for eliminating candidates that obviously are not lung nodules ; Alilou et al. ; Han et al.
 ; Setio et al. ). It is important that no TP are removed during this process. Consequently, a more relaxed criteria should be used if the candidates tend to attach to other structures.
Classiﬁer-based false positive reduction
Rule-based restrictions allow to reduce the number
of FPs. However, the number is still too high. A more reﬁned candidate selection is performed
using classiﬁers. Classiﬁcation consists in the use of a set of features to give a category to a new
observation ). Prior to the classiﬁcation, the classiﬁer must be
trained using features from known observations (such as the ground-truth). Classiﬁer training can
be supervised, if training labels (categories) are provided or unsupervised if that does not happen.
Supervised learning is usually used for FP reduction by considering the labels nodule or nonnodule. The most common features are geometrical (volume, diameter, number of voxels), shaperelated (using the Hessian matrix to assess blobness, for instance) and intensity-based ; Tan et al. ; Ta¸scı and U˘gur ). Furthermore, Choi and Choi used
the histogram of the surface normals and Setio et al. considered the location of the nodules
as a feature for classiﬁcation.
Several types of classiﬁers are used for lung nodule candidate FP reduction. Some of the most
used classiﬁers are support-vector-machines (SVM) ; Valente et al.
 ), feed-forward neural (FF) networks ; van Ginneken et al. ;
Lopez Torres et al. ) and the k-nearest neighbor algorithm (kNN) ; Valente et al. ). According to Platt , SVM is, in the linear form, a hyperplane
that separates two sets of data while maximizing the minimum distance of the two sets from that
plane (i.e., maximizing the margin). Generally, this hyperplane is the result of the mapping of the
input space to a feature space using a nonlinear map ). Fig. 2.4a depicts the
principle of the SVM.
Feed forward neural networks are a kind of artiﬁcial neural networks where information travels
in a single direction, from input to output. According to Davidian , FF networks are usually
composed by an input layer, where features are fed, hidden layers, where information is processed,
and an output layer that gives the ﬁnal classiﬁcation. Each hidden layer is composed by a certain
number of neurons placed in parallel. By its turn, each neuron weights a given combination of the
inputs of the previous layer processed by an activation function (a sigmoid function, for instance).
2.2 Representative lung nodule detection algorithms
Maximize distance
to nearest point
Input space
Feature space
(a) Support vector machines can be considered as
a hyperplane that maximizes the minimum distance
from that plane. Image adapted from Platt ;
Hearst et al. .
Input layer
Output layer
Hidden layers
(b) Standard architecture of a feed-forward neural
network. x is the input, y the output and ω is an
activation function. Image adapted from Wolfram-
Mathematica.
(c) k-nearest neighbors algorithm considering different k
values. The unknown observation (#) is labeled as G if
k = 1 and as I if k = 5. Imaged adapted from Ajanki .
Figure 2.4: Commonly used classiﬁers for false positive reduction of nodule candidates.
The training of the FF network is performed iteratively by feeding new data until the best result is
achieved. A standard architecture of a FF network is shown in Fig. 2.4b.
The kNN algorithm ) classiﬁes a new observation feature vector by evaluating
the distance of each feature to the k nearest labeled observations (neighbors). The label of the new
observation corresponds to the most common label among the neighbors. The Euclidean distance
can be used for ﬁnding the nearest neighbors. The classiﬁcation depends on the parameter k, as
represented in Fig. 2.4c.
Representative lung nodule detection algorithms
Some of the most representative works for lung nodule detection in CT images, both in terms
of performance and detection technique, are now detailed. Please refer to section 2.1 for a comprehensive description of the methods used. The performance of the methods is shown using
sensitivity per a given average number of FP/scan. The discussed works used the LIDC-IDRI
Cascio et al. used 3D mass-spring models for nodule detection. First, seed points are
selected by subtracting a region growing of the parenchyma to a mask of the lung volume. A
spherical mesh is initialized for each of the seeds. The position of each of the sphere’s vertexes
Methods for lung nodule detection in CT images
is updated in order to minimize the model’s energy (similar to an active contour model). Spline
curves are then used for reconstructing the surface of the candidate. FPs are reduced by removing
all candidates with diameter ̸∈[3 50] (mm). Geometrical and intensity distribution features are
then retrieved. FP reduction is further performed using a trained three layer feed forward neural
network. The algorithm achieved 88% sensitivity (2.5 FP/scan) and 97% (6.1 FP/scan).
Alilou et al. used a multiple threshold method to detect nodules candidates. Fixed HU
threshold levels were determined by examination of the dataset. For each threshold level, residual structures such as attached vessels are eliminated with a 2D morphological opening. Then,
blobs with diameter ̸∈[4 30] (mm) are removed. The resulting binary masks of all levels are combined using logical "OR". A greedy forward method was used for selecting 3D geometrical, 3D
intensity-based, 2D geometrical and 2D intensity-based features. A SVM classiﬁer with a radialbased-function kernel labels the candidates as "nodule" or "non-nodule". The method achieved a
80% sensitivity with 3.9 FP/scan and a maximum sensitivity of 90%.
Choi and Choi developed a detection method based on a angular histogram of surface
normals (AHSN) feature. First, candidate nodules are detected by using a multi-scale Gaussian
blob detector technique. For each scale, the threshold considers the average of the local maximum dot values (value based on the eigenvalues of the Hessian matrix). Using eigenvalues of the
Hessian matrix, the histogram of the surfaceness of the candidate is obtained. Histogram peaks
corresponding to walls are removed. This histogram is used in a trained SVM classiﬁer to reduce
the number of FPs. This method obtained a sensitivity of 97.5% with 6.76 PF/scan.
Han et al. proposed a vector quantization-based approach to detect nodules in CT
scans. The histogram of the lungs is represented by 4 Gaussian curves, which correspond to
low-frequency parenchyma, high-frequency parenchyma, blood vessels and nodule candidates.
Nodule candidates are considered to belong to the class with the highest average intensity. Vessels
and other structures are removed using morphological opening. The number of FP was reduced by
experimentally determining the volume-equivalent diameter, 3D elongation and compactness. A
SVM classiﬁer with a radial-basis-function considering intensity, geometric and Hessian features
further reduces the number of FPs. The algorithm showed a sensitivity of 82.7% (4.0 FP/scan) for
all types of nodules and 89.2% (4.14 FP/scan) for juxta-pleural nodules.
Setio et al. studied large solid nodule (> 10 mm) detection. A ﬁxed HU threshold is
used. Then, a multiple stage morphological opening removes attached structures. Nodule candidates with diameter ̸∈[8 40] (mm) are discarded. Region growing is used for segmenting the
remaining candidates. The same size threshold is re-applied. A SVM classiﬁer is used for reducing the number of FPs by considering features as intensity, geometry, blobness (Hessian-based)
and location (distance to lung structures). The method has a sensitivity of 98.3% (4.0 FP/scan).
Juxta-pleural nodules speciﬁc approaches
The detection of juxta-pleural nodules can be more challenging than other types of nodules. Juxtapleural nodules are present near the boundaries of the lung. As so, a poor lung segmentation can
eliminate these structures. Assuming that the lung segmentation is successful, other problems still
2.3 Results review
remain. Segmentation techniques, such as region-growing, are affected by the intensity of the
surrounding tissue and the presence of other structures such as bone. Portions of the pleura are
usually included during the segmentation process, affecting the performance of the system.
Most works study general approaches, attempting to detect several types of nodules using
the same approach ). To the best of our knowledge there are few works
addressing speciﬁcally juxta-pleural nodule detection. Three relevant works are described.
Retico et al. used a directional-gradient concentration analysis to determine the location
of juxta-pleural nodules. The pleural surface is retrieved from the segmentation of the lungs using
a HU-based threshold. A discrete 3D model, composed of triangular elements, is created by
using a marching cube algorithm. The authors evaluate the pleural surface normals. Regions
with high surface normals intersections, such as prominent nodules, are considered as candidates.
The candidates are detached from the pleural wall by using morphological opening. Geometrical
and textural features are used in a feed-forward neural network to reduce the number of FP. The
method showed to be susceptible to irregularities of the pleural surface, achieving a sensitivity of
72% with 6 FP/scan. The evaluation was performed in a private dataset.
De Nunzio et al. proposed an α-hull based system. The lungs were segmented using a region-growing based approach followed by a reﬁnement with morphological operations.
The α-hull is a generalization of the convex-hull method. The authors used α-hull to search for
concavities in the lung mask, which result from dense juxta-pleural nodules. The approach uses
α values equivalent to the nodule radii to detect the candidates. After, geometrical and intensitybased features are extracted. The number of FP is reduced by using a feed-forward neural network.
The maximum sensitivity was 92.3%. Ta¸scı and U˘gur proposed a similar approach. FP reduction is done using geometrical and texture features with a generalized linear regression model.
The obtained sensitivity is not stated.
Results review
A summary of the sensitivity vs FP/scan results for different nodule detection algorithms (not
exclusively dedicated to juxta-pleural) is shown in Fig. 2.5. All the analyzed methods were evaluated in the LIDC/IDRI dataset ). The number of scans used for obtaining the
results differs between authors, ranging between 58 and 888. Almost all works studied nodules
with a minimum diameter of 3mm. Slice thickness varies between 0.5 and 3mm. The average
sensitivity of the analyzed state-of-the art methods is 82% at an average FP rate of 4.1 per scan.
The evaluation of the methods’ performance should consider both sensitivity and FP/scan.
Higher sensitivity indicates an increase in the overall capacity of detecting TPs. The performance
increases with the sensitivity and decreases with the number of FP/scan. Empirically, the approaches proposed by Cascio et al. , Choi and Choi and Setio et al. show
the highest performance. However, this conclusion would only be truly valid if all the methods
were tested in the same test set with the same conditions. Slice thickness, for instance, is known
to affect the performance of algorithms due to the partial-volume effect. High thickness, or poor
Methods for lung nodule detection in CT images
False positives/scan
Sensitivity (%)
First author
Sensitivity (%)
False-positives/scan
888 125 360
0.5-2 1.25-3 0.5-3 1.25-3 <2.5
1.25-3 0.45-5 1.3-3
<2.5 0.75-3
Alilou (1)
Camarlinghi (3)
Cascio (4)
Ginneken (7)
Golosio (8)
Messay (11)
Opfer (12)
Riccardi (13)
Sahiner (14)
Setio (15)
Teramoto (18)
Figure 2.5: Sensitivity (%) and respective number of false positives/scan for different methods.
The minimum nodule diameter (mm), range of slice thickness (mm) and number of scans studied
are also shown. Values retrieved from: 1) Alilou et al. ; 2) Brown et al. ; 3) Camarlinghi et al. ; 4) Cascio et al. ; 5) Choi and Choi ; 6) Choi and Choi ; 7)
van Ginneken et al. ; 8) Golosio et al. ; 9) Guo and Li ; 10) Han et al. ;
11) Messay et al. ; 12) Opfer and Wiemker ; 13) Setio et al. ; 14) Han et al.
 ; 15) Setio et al. ; 16) Tan et al. ; Setio et al. ; 17) Tan et al. ; 18)
Teramoto and Fujita .
resolution in the direction normal to the anatomical axial plane, leads to discretization and nodule
blurring, hindering results ; Brown et al. ). The hit criterion
should also be taken into consideration, as it deﬁnes if a ﬁnal candidate should be classiﬁed as
TP or FP. A common method is to evaluate the distance between the candidate and the ground
truth. For instance, if the center of candidate lies in a sphere centered in the ground truth and with
1.5× the radius of the ground truth, then the candidate is a TP. Once hit, the respective ground
truth should be removed from the analysis list to avoid false TPs. The hit criterion is commonly
not stated by the authors, which affects the validation and evaluation of the results. Setio et al.
 have a high sensitivity value with a low FP/scan (98.4%;4 FP/scan). However, they only
studied large nodules, which are more easy to detect, segment and classify. Furthermore, they did
not consider as FP all the candidates that hit non-nodule structures. The method proposed by Choi
2.3 Results review
and Choi seems to be the one with the highest performance (95.3%;2.3 FP/scan). However,
the number of scans studied is low when compared with other works. The small number of cases
does not show if algorithm would be capable of maintaining the same performance with a second
set of images. Also, the hit criterion presented by the authors is dubious as it does not clearly state
if the ground truth of a given nodule is only considered once.
Based on the studied steps of the methods it is difﬁcult to state which combination provides
a better overall performance. Several detection methods are used but the most common tend to
be HU-based threshold and blob detectors. In terms of candidate reﬁnement, the revision of the
works indicates that active contour-based methods show a good performance, followed by region
growing. FP using rules seems to greatly enhance results and is commonly used. Both SVM and
FF networks greatly reduce the number of FP. To conclude, a high sensitivity initial candidate
detection with a low number of FP followed by a good FP reduction classiﬁer step should be the
goal of a lung nodule CADe detection system.
Detection per nodule type
Peri-fissural
Average sensivity (%)
Nodule type
Region growing volume plateau
Channeler Ant model
Voxel-based neural approach
Philips Lung Nodule CAD
Figure 2.6: Average sensitivity values of several rates of false positives/scan (2−3, 2−2, ..., 23) for
different type of nodules and algorithms. Data retrieved from van Ginneken et al. .
Fig. 2.6, based on van Ginneken et al. , shows the performance in terms of average
sensitivity of different detection algorithms for various nodule types: i) small (diameter < 5mm),
ii) large (diameter ≥5mm), iii) isolated, iv) juxta-vascular, v) juxta-pleural and vi) peri-ﬁssural.
The sensitivity was evaluated for different numbers of false positives/scan (2−3, 2−2, ..., 23) for
each of the studied algorithms. The average sensitivity (per algorithm) was used for comparison
Methods for lung nodule detection in CT images
(Fig. 2.6). The performance of the algorithms was analyzed using the dataset from the ANODE09
 challenge. This dataset contains mainly solid nodules, which are characterized per location. As the evaluation was not performed using the LIDC/IDRI dataset, direct comparison with
the lung nodule candidate detection methods revised previously does not allow to draw deﬁning
conclusions. However, the average of the results of the different methods (ηnoduletype) allows to
assess the difﬁculty in detecting each kind of nodule.
The six nodule detection algorithms are: i) Fujitalab, ii) Region growing volume plateau,
iii) Channeler Ant model, iv) Voxel-based neural approach, v) ISI-CAD and vi) Philips Lung
Nodule CAD (commercial product). Fujitalab detecs nodules using a gradient concentration ﬁlter
to enhance rounded structures followed by region growing to detect and segment candidates. FPs
are ﬁrst reduced with rules and after with a multi-regression analysis. Region growing volume
plateau uses region growing of the parenchyma to detect seed points, followed by a second region
growing for nodule segmentation. After rule-based FP reduction, a FF network is used. The
Channeler Ant model uses a dynamic region growing process (homonymous to the work) to detect
candidates. Classiﬁcation is performed using a FF network. The Voxel-based neural approach
uses blob detectors to detect nodules in the parenchyma and the directional-gradient concentration
to detect juxta-pleural nodules. Features are extracted from the surrounding region and classiﬁed
using a FF network. ISI-CAD computes the shape index and curvedness to detect candidates.
Then, two k-kNN classiﬁers are used, sequentially with different features, to reduce the number of
FPs. Please refer to van Ginneken et al. for a description of each of the methods studied.
Fig. 2.6 allows to draw several conclusions. First, isolated nodules (ηisolated = 40.2 ± 13.6)
show a tendency of higher sensitivity among all type of nodules, i.e., they appear to be the easiest
to detect. The good intensity contrast between these nodules and the parenchyma contributes to the
obtained sensitivity. Furthermore, the segmentation step is not affected by surrounding structures,
such as vessels or the pleural. In fact, nodules that are not attached to large structures, such as
isolated and peri-ﬁssural (ηperifissural = 39.9±19.6) show higher η values than the juxta-vascular
(ηjuxtavascular = 31.7±18.7) and the juxta-pleural (ηjuxtapleural = 20.5±11.8) nodules.
Juxta-pleural nodules show tendency to have the lowest average sensitivity from the analyzed
types of nodules. This is true even for the Voxel-based neural approach, which used a dedicated
approach for this type of nodule. Overall, this can be justiﬁed by the lack of contrast between
the nodule and the surrounding tissue and the existence of adjacent structures, which hinder both
initial detection and segmentation. Considering the works showed in Fig. 2.6, blob detectors seem
to outperform other methods in terms of juxta-pleural nodule detection. However, the performance
of the blob detector method for juxta-pleural nodule detection is still lower when compared to other
nodules types. Based on the discussed η values, there is need to develop algorithms specially
dedicated to the detection of juxta-pleural nodules.
2.4 Concluding remarks
Concluding remarks
Nodule detection algorithms are often composed by an initial candidate detection step, followed
by a candidate reﬁnement and reduction of FPs. Initial candidate detection can be performed
using methods based on the HU values, by analyzing shape-related characteristics or by using
blob detectors. For candidate reﬁnement, morphological operations are used for detaching nonnodule structures from the candidates. Then, region growing or active contours can be used for
obtaining a better segmentation of the candidates. The number of FPs is reduced by using ﬁxed
rules and classiﬁers. Several works focused on lung nodule detection in CT images were studied.
The detection algorithms show similarities between them, with the main differences occurring in
the method used to ﬁnd the initial candidates.
The detection of juxta-pleural nodules shows to be challenging due to their position near the
pleural wall. However, to the best of our knowledge there are few works addressing speciﬁcally
the detection of this kind of nodules. Initial candidate detection can be performed by using αshapes to detect concavities, by analyzing the directional-gradient concentration or by using blob
detectors. Direct thresholding techniques using HU values are avoidable due to the presence of the
pleural wall, except when a proper lung volume segmentation is available. Candidate reﬁnement
should be performed by methods other than region-growing, as there is risk to attach a portion
of the pleura and adjacent structures to the candidate. Morphological operations are important to
detach candidates. Finally, FP reduction should have in consideration not only intensity-related
features, but also the nodule geometry and location. SVM, FF networks and the k-NN algorithm
are often used for FP reduction.
Based on the unique characteristics of the juxta-pleural nodules and the performance of the
reviewed methods, the algorithms proposed by Retico et al. ; De Nunzio et al. ;
Cascio et al. ; Choi and Choi ; Han et al. ; Ta¸scı and U˘gur , as well as
the features proposed in Setio et al. , are of major interest to the development of a novel
CADe algorithm dedicated to the detection of juxta-pleural nodules.
Methods for lung nodule detection in CT images
Juxta-pleural lung nodule detection
Method overview
The proposed method to detect juxta-pleural nodules in CT scans is detailed in this chapter. Previous works have achieved high detection performance for nodules with radius ≥5mm, including
juxta-pleural ). Consequently, our work focuses on the detection of juxta-pleural
nodules with radius ≤5mm. Our approach can be divided in:
1. lung volume segmentation with inclusion of juxta-pleural nodules by using a region growingbased approach followed by an active contour reﬁnement. Juxta-pleural lung nodules candidates are only searched inside the segmented region. Please refer to Section 3.2;
2. detection of nodule candidates via threshold and blob enhancement techniques. Solid nodules, which have an intensity similar to non-parenchymal tissue, are segmented by selecting
an appropriate threshold. Sub-solid and non-solid nodules are ﬁrst enhanced by using multiscale Laplacian-of Gaussian-ﬁltering. Please refer to Section 3.4;
3. FP reduction via ﬁxed rules and supervised learning. First, a reduction of FPs is performed
by discarding candidates outside a given range of volume-equivalent radius. Then, a SVM
classiﬁer is trained to further reduce the number of FPs. Please refer to Section 3.5.
Our method is developed and evaluated using the LIDC-IDRI dataset, the largest publicly
available lung nodule dataset. Despite an exhaustive nodule characterization, the ground-truth
of the LIDC-IDRI does not classify lung nodules according to their location as juxta-vascular,
ﬁssural, isolated and juxta-pleural. Consequently, a method for the creation of a juxta-pleural lung
nodule dataset from the LIDC-IDRI is also proposed in Section 3.3.
A schematic representation of the steps of the proposed method is shown in Fig. 3.1. Each of
the steps will be detailed in the remaining of this chapter.
Juxta-pleural lung nodule detection
Juxta-pleural dataset
1. Lung volume
2. Morphological
3. Automatic listing
4. Manual revision
ground-truth
Candidate detection
1. Patch-wise
contrast adjustment
2. Patch-wise
1. Slice-wise blob
enhancement
2. Slice-wise
Lung volume segmentation
1. Region growing
2. Morphological
3. Active contour
False positive reduction
1. Fixed rule based
2. Supervised
ground-truth
Figure 3.1: Schematic representation of the proposed method.
Lung volume segmentation
The proposed juxta-pleural nodule detection method searches candidates only inside the segmentation of the lung volume. Consequently, it is essential that juxta-pleural nodules are included
in the lung mask. The initial lung volume segmentation is performed as proposed in Novo et al.
 . Then, a reﬁnement of the limits of the lung mask is performed using active contour.
Initial lung volume segmentation
Novo et al. proposed a region growing-based approach to segment the lung volume followed by morphological operations to include juxta-pleural lung nodules. Region growing is an
iterative process where neighbour voxels of similar intensity are included until a given stop criteria
is met. Being an intensity-based method, the contrast between the lung tissue, which is darker due
to the presence of air, and the surrounding structures (Fig. 3.2a) is essential. To improve the contrast between structures, the histogram of the CT thorax is saturated for bright values. Then, a seed
point on the fatty area is selected by ﬁnding the maximum intensity of the principal diagonal of
one of the middle slices of the scan. Starting from this seed point, all 3D neighbour voxels whose
intensity is no less than 35% of the seed intensity are included. The seed points are then updated
and the process is repeated iteratively until the segmented area remains constant. An initial lung
mask is obtained by negating the computed segmentation. Due to the nature of the algorithm,
lung volumes separated only by small structures may be merged. The segmentation is corrected
by eroding the lung mask until 2 independent volumes exist. Finally, the segmentation is reﬁned
with a region growing of the parenchyma using a more restrict growth criteria of 10% of the seed’s
intensity. Note that in some slices the lung mask may be re-merged, which is not critical.
The achieved lung mask (Fig. 3.2b and Fig. 3.2c) still does not include juxta-pleural nodules.
Nodule inclusion is performed using a morphological close operation with a circular structuring
element of radius 15mm. The closing operation allows to ﬁll the interior of the mask and include
juxta-pleural nodules without altering the overall shape of the lung mask. Fig. 3.2d shows the lung
mask after the reﬁnement, which now includes the juxta-pleural nodule.
3.2 Lung volume segmentation
(a) Lung volume slice.
(b) Initial segmentation.
(c) Initial segmentation
near nodule.
(d) Reﬁned segmentation near nodule.
Figure 3.2: Relevant steps of the region growing-based algorithm for lung volume segmentation.
The initial segmentation (prior to reﬁnement) does not include nodules. Nodules are included after
the segmentation is reﬁned with a morphological closing. Blue scale bar corresponds to 5mm.
Active contour reﬁnement
The morphological operation close preserves the overall shape of the lung volume segmentation.
However, the segmentation may not be correctly adjusted to the pleura (Fig. 3.3a). A poor lung
segmentation near the pleura affects the automatic detection of juxta-pleural nodules. For instance,
a nodule whose diameter is smaller than the distance between the segmentation and the pleura may
not be included on the mask. Consequently, the lung volume mask is corrected using a 2D Chan-
Vese active contour approach.
The Chan-Vese segmentation, ﬁrst proposed by Chan and Vese , is an iterative active
contour algorithm that does not rely on the image gradient to measure the system’s total energy.
The Chan-Vese algorithm proceeds by minimizing the segmentation function F(c1,c2,C):
F(c1,c2,C) = µ ·Length(C)+v·Area(inside(C))+
inside(C) |u0(x,y)−c1|2dxdy+λ2
outside(C) |u0(x,y)−c2|2dxdy
where C is the segmentation curve, c1 and c2 are the average inside and outside intensities,
respectively, of image u0 and µ ≥0, v ≥0, λ1 > 0, λ2 > 0 are ﬁxed parameters that affect the
evolution of the curve on each iteration. The algorithm minimizes F(c1,c2,C) having in account
the curve length, as well as the area and difference between the intensity inside and outside of the
segmentation. The parameters λ1 and λ2 are related to the uniformity of the intensity inside and
outside the curve, respectively. As suggested in Chan and Vese , for simple segmentations
these values can be unitary. The parameter µ is a critical parameter that allows to balance the
smoothness and accuracy of the contour ). A higher µ value results in smoother
contour. The parameter v directly inﬂuences the curve contraction. For the proposed application,
contour smoothing rectiﬁes some mask deformations caused by juxta-pleural nodules, increasing
the volume ratio of the nodules included in the mask as demonstrated in Fig. 3.3c and Fig. 3.3d.
Juxta-pleural lung nodule detection
(a) After the morphological closing.
(b) (a) after the Chan-
Vese active contour.
(c) After the morphological closing.
(d) (c) after the Chan-
Vese active contour.
Figure 3.3: Details of the correction of the lung volume segmentation via the Chan-Vese active
contour method. The inclusion of juxta-pleural nodules is improved (c and d). Blue scale bar
corresponds to 5mm.
Dataset of juxta-pleural lung nodules
The LIDC-IDRI dataset is the largest public dataset for the development and evaluation of CAD
lung systems. However, the lack of characterization of the ground-truth in terms of nodule position
i.e., isolated, juxta-vascular, juxta-pleural and peri-ﬁssural, hinders the detailed evaluation of these
systems. Due to the lack of position characterization, few works using the LIDC-IDRI report their
performance for juxta-pleural nodules. In fact, most works that report detection performance for
juxta-pleural nodules usually use private or small datasets where juxta-pleural nodules are identi-
ﬁed by specialists ; van Ginneken et al. ; De Nunzio et al. ). The
lack of a proper ground-truth on a large public available dataset hinders the comparison between
detection methods. The development of a dedicated juxta-pleural lung nodule detection algorithm
requires a ground-truth of juxta-pleural nodules. Consequently, a method for the creation of a
dataset with the juxta-pleural nodules available in the LIDC-IDRI is created.
The computed lung volume segmentation (see Section 3.2) is used to ﬁnd the juxta-pleural
nodules in the LIDC-IDRI dataset. First, the perimeter of the lung mask is dilated with a disk of
radius 1.5mm, corresponding to the smallest nodule in the dataset. The dilation compensates possible imperfections of the lung volume segmentation. All nodules of the ground-truth with at least
1 voxel overlapping the dilated perimeter are considered juxta-pleural nodules. Fig. 3.4 shows examples of nodules, with different radius, shapes and intensities, considered as juxta-pleural. The
resulting dataset is then manually analyzed to remove juxta-pleural nodules erroneously considered by the initial automatic selection. All nodules that do not touch the pleural wall are removed.
Finally, the remaining juxta-pleural nodules are divided in two groups, according to their
equivalent radius r, as small (r < 5mm) and large (r ≥5mm). The radius is computed as:
nvoxels ·xscale ·yscale ·zscale
where nvoxels is the number of voxels of the nodule, xscale, yscale and zscale are the dimensions,
in mm, of the voxels.
3.4 Candidate detection
(a) 0001, 91
(b) 0005, 89
(c) 0027, 113
(d) 0039, 134
(e) 0045, 63
(f) 0061, 40
(g) 0082, 174
(h) 0121, 161
(i) 0132, 28
(j) 0137, 31
(k) 0195, 87
(l) 0442, 43
(m) 0502, 53
(n) 0686, 196
(o) 0838, 175
Figure 3.4: Examples of nodules considered as juxta-pleural. Each example is retrieved from a
scan and slice (LIDC-IDRI case#, slice#). Blue scale bar corresponds to 5mm.
Candidate detection
The proposed juxta-pleural nodule detection algorithm searches for nodule candidates inside the
lung volume segmentation obtained using the method described in Section 3.2. Nodule candidates
are portions of tissue that have properties similar to lung nodules. In our system, we independently
search for two types of candidates: i) structures with an intensity similar to non-parenchymal tissue and ii) small blobs, which are rounded structures with an intensity higher than the surrounding background. These two characteristics, intensity and blobness, exploit the natural rounded
structure and the intensity similarity between the non-parenchymal tissue and the majority of the
juxta-pleura nodules. Intensity-related candidates are found by selecting an appropriate threshold
value over a given slice scan, as explained in Section 3.4.1. On the other hand, blob candidates are
enhanced prior to detection by using a blob enhancement technique, as detailed in Section 3.4.2.
Direct threshold
The majority of the juxta-pleural nodules in the LIDC-IDRI has solid texture. Solid nodules
have an intensity similar to the non-parenchymal tissue ; De Nunzio et al.
 ). Consequently, the selection of an appropriate intensity threshold allows to obtain a binary
Juxta-pleural lung nodule detection
(a) (0005,89)
(b) Saturated.
(c) b after threshold.
(d) Blob enhanced.
(e) d after threshold.
(f) (0620,91)
(g) Saturated.
(h) g after threshold.
(i) Blob enhanced.
(j) i after threshold.
(k) (0821,372)
(l) Saturated.
(m) l after threshold.
(n) Blob enhanced.
(o) n after threshold.
Figure 3.5: Steps for juxta-pleural nodule detection. (a)-(d): solid nodule; (f)-(i): sub-solid nodule;
(k)-(n): non-solid nodule. For the blob enhancement step, Laplacian-of-Gaussian ﬁlters with
σ = {1,1.5,2} are used. Each example is retrieved from a scan and slice (LIDC-IDRI case#,
slice#). Blue scale bar corresponds to 5mm.
mask of the candidate. The threshold selection is performed for each slice of the volume and
inside a sliding 30 × 30mm patch. This patch size allows to have a representative occurrence
of both parenchymal and non-parenchymal tissue, easing the threshold selection. First, contrast
is increased by saturating 1% of the intensity values at low and high intensities of the current
patch. The ﬁrst and second columns of Fig 3.5 show patches with nodules before and after the
contrast adjustment. Note that while the contrast between non-parenchymal and parenchymal
tissue is increased, sub-solid and non-solid nodules remain with little contrast. This problem will
be partially solved by the blob enhancement process (Section 3.4.2).
Finally, the patch is threshold using the value that maximizes the inter-class distance of the
intensity histogram ). The result of the threshold is combined with the lung mask
using the logical operation AND. Fig. 3.5 shows examples of this process. Note that using the
direct threshold method only the solid nodule is detected.
3.4 Candidate detection
Blob enhancement
Sub-solid and non-solid nodules have low contrast with the parenchymal tissue. As a consequence,
the contrast between these nodules and the surrounding tissue must be enhanced prior to their
detection. This process is referred as blob enhancement. In our work, a multi-scale Laplacian-of-
Gaussian (LoG) approach is used. LoG ﬁltering is a blob-enhancement technique vastly used for
the detection of rounded structures, such as the majority of the lung nodules. Also, multi-scale
approaches are advantageous over single scale because they allow to combine blob-like structures
of different radius ; El-Baz et al. ; Valente et al. ). The LoG ﬁlter
corresponds to the second derivative of the Gaussian function G(x,y,σ) and it is deﬁned as:
−∇2G(x,y,σ) = −x2 +y2 −2σ2
where σ controls the radius and amplitude of the LoG ﬁlter ).
Fig. 3.6 shows examples of LoG ﬁlters for different σ values. Note that the ﬁlter’s amplitude
is affected by a factor of σ−4.
(b) σ = 1.5
Figure 3.6: Examples of Laplacian of Gaussian blob enhancement ﬁlters for different σ values.
For each slice of the volume, I, the image is enhanced by convolving with LoG ﬁlters of
different σ values. The maximum response for each ﬁlter is then combined:
 I ∗[−∇2G(x,y,σ)]
After the enhancement using Eq. 3.4, the optimal threshold is determined inside the lung mask
by using the method proposed by Otsu . Please note that, in the proposed approach, the
different LoG ﬁlters are not normalized before the operation described in Eq. 3.4 is performed.
This means that structures with smaller diameters (approximately 5 voxels slice-wise or 7mm if
σ = 1) are heavily prioritized over to larger structures. This approach allows to enhance the most
noticeable portion of sub-solid and non-solid nodules. Although this process does not allow a
clean segmentation of the entire structure (Fig. 3.5), it was found that it signiﬁcantly reduces both
the number FP and risk of connection between structures. The connection between structures hinders the FP reduction step, greatly affecting the overall sensitivity of the system. Consequently, it
Juxta-pleural lung nodule detection
was considered more relevant to under-segment sub-solid and non-solid nodules without compromising the detection of solid nodules than the opposite.
The ﬁnal candidate mask is obtained combining the two candidate masks (direct threshold and
blob enhancement) with a logic OR operation. Each nodule candidate corresponds to a 3D connected component considering a 26 voxel neighbourhood connectivity. At this stage, a candidate
is considered a TP if at least 1 voxel overlaps the ground-truth. Otherwise it is considered a FP.
False positive reduction
The candidate detection step results on a high number of FPs. These FPs correspond mainly
to blood vessels of different calibers because of the intensity and blobness similarity with lung
nodules. A system with high number of FPs is not of practical use for physicians. Furthermore,
FP reduction should be performed in such way that the maximum number possible of TPs are
preserved. In our method, FP are reduced in two steps: ﬁrst, ﬁxed rules are applied to remove all
candidates that obviously are not nodules; then, a SVM is trained to perform a reﬁned reduction.
Fixed-rules based FP reduction
The proposed algorithm is designed to detect nodules with equivalent radius ≤5mm. Also, the
radius of the smallest segmented nodule of the LIDC-IDRI dataset is 1.5mm. Candidate radii is
computed using Eq. 3.2. Assuming a safety margin due to possible connection between different
candidates, all candidates with radius ≥6mm are removed. Juxa-pleural candidates are ﬁltered
by eliminating those that do not have at least 1 voxel at a 6mm distance from the perimeter of the
lung volume segmentation i.e., by eliminating all candidates that have no voxels on a 6mm radius
disk dilation of the lung mask perimeter. All candidates with radius < 1.5mm, corresponding to
the smallest nodule of the LIDC-IDRI, are also removed.
Supervised learning FP reduction
FPs from the candidate set are further reduced by using supervised learning. SVM with radial basis
function kernel (SVM-rbf) is used because it as shown good FP-reduction capabilities ; Valente et al. ). SVMs operate by maximizing the margin between two
classes on a given feature space, i.e by maximizing the distance on the feature plane between
a given set of observations of different classes and the decision hyperplane, while reducing the
number of misclassiﬁcations. The samples that deﬁne the margin are referred as support vectors.
A cost parameter C is introduced to enforce a soft-margin on the classiﬁer, ensuring a trade-off
between high margins and misclassiﬁcation.
3.5 False positive reduction
Table 3.1: Features used for supervised learning.
mean, standard deviation, entropy, skewness, kurtosis
Bounding box
mean, standard deviation, entropy, skewness, kurtosis
mean, standard deviation, entropy, skewness, kurtosis
mean, standard deviation, entropy, skewness, kurtosis
Bounding box
mean, standard deviation, entropy, skewness, kurtosis
mean, standard deviation, entropy, skewness, kurtosis
mean, standard deviation, entropy, skewness, kurtosis
Bounding box
mean, standard deviation, entropy, skewness, kurtosis
mean, standard deviation, entropy, skewness, kurtosis
maximum 2D axis length slice-wise (mm)
volume (mm3)
sphericity
compactness1 = volume/(bounding box volume)
compactness2 = volume/(bounding cube volume)
mean value of the lung mask distance transform
Instead of measuring this distance using a scalar product, the RBF kernel is used since it allows
for a higher degree of generalization of the hyperplane:
K(x1,x2) = e−γ·d(x1−x2)
where x1 and x2 are two observations, d is the euclidean distance between the samples and γ is
the parameter that controls the range of inﬂuence of each support vectors ;
Yu-Jen Chen et al. ).
The classiﬁer is trained with features inspired by the works of Murphy et al. ; De Nunzio
et al. ; Han et al. . The features used in our work are presented in Table 3.1.
The features referred in Table 3.1 are collected from the candidate volume, the candidate
bounding box volume and the volume 6mm outside the candidate. Namely, the volume outside the
candidate is computed by performing morphological dilation followed by the logic AND operation
with the negation of the candidate. A detailed explanation of some of the features is given next.
Hessian-based blobness features are computed according to Li et al. considering σ =
{0.5,1.5,3}. Entropy is a measure of the randomness of the volume and it is deﬁned as
entropy = −
(pi ·log2(pi))
where p is the histogram count of the bin i. Skewness and kurtosis are the third and fourth moments
and indicate how assymetric and how tayled a given distribution is, respectively. These metrics
Juxta-pleural lung nodule detection
are described as
where N is the number of voxels, xi is the intensity for voxel i and x is the mean intensity
of the candidate; n = 3 is used for skewness and n = 4 for kurtosis ).
Sphericity is the degree of overlap of the candidate with a sphere of equivalent radius using the
Dice’s coefﬁcient )
sphericity = 2(candidate∩sphere)
where N and S are the number of voxels of the candidate and sphere, respectively.
The SVM-rbf classiﬁer is retrieved from Chang and Lin . The features’ values from
all the candidates in the dataset of juxta-pleural nodules with radius ≤5mm are concatenated in
a single feature table. Each row of the table corresponds to a candidate i, whereas each column
corresponds to a given feature j. Candidates with at least 1 voxel overlapping the ground-truth are
considered as TP. During the learning process, the feature table is randomly divided in training
and test sets. This division is performed scan-wise, so that candidates from the same scan are not
in the training and test sets simultaneously. The training set is normalized by using the median
absolute deviation, due to the presence of outliers:
xijnormalized = xi j −median(Xj)
MAD = median(|Xj −median(Xj)|)
where xi j is the value of feature j for the training candidate i and Xj is a vector with all
the values of feature j considering only the training set. The median and MAD values used to
normalize the training set are then used to normalize the test set. The training and test processes
are repeated a ﬁxed number of times. The mean classiﬁer behaviour is obtained by averaging
the classiﬁer performance during the repetitions. The C and γ parameters of the classiﬁer are
determined via grid-search over the entire normalized candidate set using 5-fold cross validation.
The studied C values are {2−5 ... 215} and the γ values are {2−15 ... 23}, ).
3.6 Performance evaluation
Performance evaluation
The performance of the proposed CADe system is evaluated in terms of sensitivity and FPs produced. Sensitivity corresponds to the ratio of correct detections:
sensitivity =
where TP is the number of true positives and FN the number of false negatives (missed nodules). In CADe systems, sensitivity varies with the number of FP/scan. Free-Response receiver
operating characteristic (FROC) curve plots sensitivity as function of the number of FP/scan. Systems can be evaluated by selecting a point from the FROC curve. However, it is hard to deﬁne a
proper balance between high sensitivity and low FPs. Consequently, van Ginneken et al. 
proposed a score metric for the evaluation of CAD systems. This score averages the sensitivity for
different numbers of FPs per scan:
FROCsystem(2i)
The FROC curve can be derived from the receiver operating characteristic (ROC) curve and
plots the sensitivity as function of the number of FP. The ROC curve plots the TP rate of the system
as function of the FP ratio:
where TN is the number of true negatives.
ROC curves can be obtained by varying the decision threshold for the positive class. For
instance, ROC curves are easily computed during the classiﬁcation process by varying the decision
criteria between classes. Furthermore, the area under the ROC curve (AUC) is a good metric of
the system performance ). A higher AUC implies that the system is able to
achieve higher sensitivities without a signiﬁcant increase of the FP ratio. In this work, AUC is
used to compare the performance of the supervised FP reduction with other works.
The FROC curve of the system is computed from the ROC curve of the classiﬁer:
FROCsystem(FPscan) = sensitivityprior classi fication ·ROCclassi fier
where FPscan is the number of FPs per scan, FPscan and sensitivityprior classi fication is the average
number of FPs and is the maximum achieved sensitivity prior to classiﬁcation, respectively.
Juxta-pleural lung nodule detection
Concluding remarks
A method for the detection of small juxta-pleural lung nodules in CT scans is presented. Our
method exploits both the intensity similarity between nodules and non-parenchymal tissue and the
natural roundness of these abnormalities. The LIDC-IDRI has no ground-truth for juxta-pleural
nodules and thus a dataset with this type of nodules is created.
The candidates are searched inside a lung volume segmentation properly rectiﬁed with an
active contour-based approach to include juxta-pleural nodules. The active contour rectiﬁcation
is expected to behave better than morphological operations over the lung mask since it considers
local intensity information and contour shape instead of only shape.
Candidate detection is performed via direct threshold and blob enhancement. Direct threshold
is expected to perform a proper segmentation of solid nodules due to their high contrast with the
parenchyma. On the other hand, the identiﬁcation of sub-solid and non-solid is more challenging
due to the lack of contrast of these structures and is thus achieved through blob enhancement with
multi-scale Laplacian-of-Gaussian ﬁltering.
The number of FPs is reduced via ﬁxed-rules and supervised learning. Fixed-rules are essential
prior to the classiﬁer-based reduction because our method produces a high number of FPs. It is,
thus, a crucial step that controls the performance of the algorithm. The features and classiﬁer
selected for the supervised learning are based on state-of-the-art works and should signiﬁcantly
reduce the number of FPs produced by our system.
Results and discussion
This chapter presents and discusses the results of each of the steps explained in Chapter 3. We
discuss the results on the juxta-pleural nodule dataset, lung volume segmentation, candidate detection and FP reduction. A comparison with the state-of-the-art is also performed. We analyze
methods dedicated to the detection of juxta-pleural lung nodules, namely Retico et al. and
De Nunzio et al. . Our results are also compared with Han et al. as they state juxtapleural detection performance in the LIDC-IDRI dataset. A ﬁnal discussion including the research
of van Ginneken et al. is also performed because, even though the LIDC-IDRI dataset is
not used, it presents a proper performance assessment for juxta-pleural nodules. Please refer to
Section 2.2 and Section 2.3 for a description of their research.
Dataset of juxta-pleural nodules
A dataset with the existing juxta-pleural nodules of the LIDC-IDRI is herein presented. To the best
of our knowledge, this juxta-pleural lung nodule dataset is the ﬁrst to be collected from a large
portion of the LIDC-IDRI. We have analyzed 729 out of the 1012 available scans. The remaining
scans were not considered due to reading errors of either .dcm or .xml ﬁles. The same problems
had already been reported by Murphy et al. , although these authors managed to use 888
scans. The difference in the number of scan read might be due to the reading protocol used.
Furthermore, our dataset is manually revised to remove mislabelled nodules i.e., nodules that
were erroneously considered as juxta-pleural because they were partially contained in a lung
perimeter dilation using a disk of radius 1.5mm. Similarly, in Han et al. the authors used a
subset of the LIDC-IDRI and reported their system performance for juxta-pleural nodules. A nodule was considered juxta-pleural if at least 1 voxel was contained on a 5-layer erosion of the lung
volume segmentation. However, a manual revision was not performed and thus nodules that did
not contact with the pleura were most likely included. For instance, Table 4.1 shows the number of
scans and juxta-pleural nodules considered before and after the manual revision, thus showing the
importance of this step. The number of juxta-pleural nodules is reduced by 11% after the manual
revision. Fig. 4.1 shows examples of manually removed nodules.
Results and discussion
Table 4.1: Number of scans and juxta-pleural nodules in the studied 729 scans from the LIDC-
IDRI dataset. Small juxta-pleural nodules are those with radius ≤5mm.
No. juxta-pleural nodules
Before manual revision
After manual revision
Small juxta-pleural nodules
(a) 0042, 43
(b) 0131, 123
(c) 0171, 21
(d) 0176, 167
(e) 0300, 182
(f) 0415, 132
(g) 0655, 210
(h) 0713, 83
(i) 0858, 218
(j) 0896, 30
Figure 4.1: Examples of nodules removed from the juxta-pleural dataset. Each example is retrieved from a scan and slice (LIDC-IDRI case#, slice#). Blue scale bar corresponds to 5mm.
Despite not having position-related labels, the LIDC-IDRI characterizes nodules using different metrics. For instance, the agreement level corresponds to the number of specialists that were
in accordance if a given abnormality is, in fact, a nodule. Empirically, a lower agreement level is
indicative of a higher detection difﬁculty. Similarly, the subtlety of the nodule is a direct indicator
of how difﬁcult a nodule is to be identiﬁed by humans. Nodule texture, i.e., nodule classiﬁcation
as non-solid, sub-solid or solid, is also of interest. For instance, whereas solid nodules are highly
contrasted in relation to the parenchyma, non-solid nodules lack contrast and thus require more
effort to be detected ; Setio et al. ). Some statistics of interest of both
juxta-pleural and non-juxta-pleural nodules of the LIDC-IDRI dataset are presented in Fig. 4.2.
According to Fig. 4.2a and 4.2b, the nodule radius distribution for the all nodules of the LIDC-
IDRI dataset and the existing juxta-pleural nodules is similar. Approximately 65% of the juxtapleural nodules have a radius ≤5mm. The design of strategies for small nodules is of interest
because they occur more frequently than larger nodules. Furthermore, the agreement level for
small juxta-pleural nodules tends to reduce signiﬁcantly in comparison to the majority of the
nodules, as shown in Fig. 4.2c. The lack of agreement indicates that these abnormalities are
hard to distinguish from small blood vessels and other aberrations that occur near the pleura. This
is, in fact, corroborated by the higher percentage of small juxta-pleural nodules in the second tier
4.1 Dataset of juxta-pleural nodules
Nodule radius (mm)
Nodule ratio
(a) LIDC-IDRI nodule radius distribution.
Nodule radius (mm)
Nodule ratio
(b) Juxta-pleural radius distribution.
Number of specialists
Nodule ratio
All nodules
Juxta-pleural
Small juxta-pleural
(c) Nodule agreement level.
Nodule texture
Nodule ratio
All nodules
Juxta-pleural
Small juxta-pleural
(d) Nodule texture distribution.
Nodule subtlety
Nodule ratio
All nodules
Juxta-pleural
Small juxta-pleural
(e) Nodule subtlety distribution.
Nodule sphericity
Nodule ratio
All nodules
Juxta-pleural
Small juxta-pleural
(f) Nodule sphericity distribution.
Figure 4.2: Statistics retrieved from the LIDC-IDRI, with special focus on juxta-pleural nodules.
Small juxta-pleural nodules have radius ≤5mm.
Results and discussion
(a) 0005, 89
(b) 0034, 98
(c) 0529, 268
(d) 0854, 174
(e) 0936, 217
(f) 0005, 50
(g) 0034, 176
(h) 0529, 391
(i) 0854, 130
(j) 0936, 168
Figure 4.3: Examples of juxta-pleural lung nodules with radius ≤5mm (ﬁrst row) and non-nodule
structures (second row). Each example is retrieved from a scan and slice (LIDC-IDRI case#,
slice#). Blue scale bar corresponds to 5mm.
subtlety group in comparison to the ﬁrst tier (]4-5]). In this scale the obviousness of the nodule
increases with the subtlety value. Finally, the lower sphericity of the nodules in study indicate that
blob detectors are not as efﬁcient for the enhancement of these structures, further hindering the
detection of sub-solid and specially non-solid nodules. Fig. 4.3 shows examples of juxta-pleural
nodules and other structures that despite not being nodules have similar visual features.
Juxta-pleural nodules tend to have characteristics, namely low agreement level, difﬁcult position and high subtlety, that increase their detection difﬁculty in comparison to other nodules. With
this in consideration, it is understandable why these nodules tend to have a lower detection sensitivity. From this point forward, we consider the juxta-pleural nodule dataset as containing only
nodules with radius ≤5mm because they are the most challenging to detect. This dataset contains
approximately 68% of the considered juxta-pleural nodules (i.e., 510 out of 747 nodules).
Lung volume segmentation
A proper lung volume segmentation is essential for our juxta-pleural nodule detection method because the candidates are only searched inside the segmented region. After the initial segmentation
using region growing, our active contour model is initialized with λ1 = λ2 = µ = 1. v is set to
−0.4 to incentivize the contour to grow outwards and thus compensate the initial segmentation.
Note that there is no ground-truth available for the lung volume segmentation. Consequently,
and having in account the objective of our method, the evaluation is performed in terms of the
average volume (or portion) of juxta-pleural nodules included by the segmentation. This nodule
inclusion volume is computed by performing a logical AND operation between the lung volume
segmentation and the juxta-pleural nodule ground truth. Then, the volume ratio between this
4.2 Lung volume segmentation
Table 4.2: Inclusion of juxta-pleural nodules and juxta-pleural nodules with radius ≤5mm by the
segmented lung volume.
Novo et al. 
Proposed method
Inclusion volume (%)
Included nodules (%)
Inclusion volume (radius ≤5mm, %)
Included nodules (radius ≤5mm, %)
intersection and the ground-truth from the dataset of juxta-pleural nodules with radius ≤5mm is
computed. This inclusion volume is compared before, i.e. as proposed by Novo et al. , and
after the correction of the lung volume segmentation using the Chan-Vese active-contour.
Table 4.2 shows that the proposed lung volume segmentation correction method improves
the inclusion volume of small juxta-pleural nodules by approximately 10%. For these statistics,
nodules with less than 25% inclusion volume are not considered as included by the lung mask
because the great majority of the nodule is outside the volume segmentation. Results prove that
the active contour approach is advantageous when used to complement the morphological closing.
Note that active contours have in consideration the local intensity of the image for the adjustment
of the contour and, consequently, are able to perform shape corrections locally. On the other hand,
the used morphological operations only consider the binary mask and thus do not have enough
information to properly adjust to the lungs’ limits.
Despite increasing the inclusion volume, which eases candidate detection, there are still nodules that are not included by the lung mask (Fig. 4.4). These nodules are difﬁcult to include
because they appear near vertexes of the lungs. There, the nodules act like a barrier that both region growing and active contours fail to properly identify. In fact, all nodules that are not included
in the lung volume segmentation have solid texture. This is to be excepted because unlike subsolid and non-solid nodules, solid nodules signiﬁcantly deform the pleural region and thus affect
the lung volume segmentation. A possible solution would be to use a 3D model of an average
lung mask as the starting point for a 3D active contour-based approach. Considering Table 4.2, the
maximum sensitivity of our system for juxta-pleural nodules with radius ≤5mm is 97.8%.
(a) 0137,31
(b) 0158,54
(c) 0198,31
(d) 0634,174
Figure 4.4: Examples of nodules not included in the lung volume segmentation due to their location near the limits of the lungs. Each example is retrieved from a scan and slice (LIDC-IDRI
case#, slice#). Blue scale bar corresponds to 5mm.
Results and discussion
Table 4.3: Maximum achieved sensitivity values (%) for the proposed method, prior to the false
positive reduction step, per nodule texture and minimum agreement level between specialists.
Nodule texture
Agreement level
At least 4
At least 3
At least 2
At least 1
Number of nodules
Candidate detection
Our juxta-pleural detection method searches for candidates inside the lung volume segmentation.
Because of that, juxta-pleural nodules that are not properly included in the lung mask are not
identiﬁed by our system. As referred in Section 4.2, this situation implies a lack of inclusion of
some juxta-pleural nodules with radius ≤5mm, corresponding to an overall maximum achievable
sensitivity of 97.8%. In our method, solid nodules are detected via direct threshold after a contrast
adjustment. Sub-solid and non-solid nodules are enhanced as described in Section 3.4.2 considering σ = {1,1.5,2}. This σ range corresponds to blobs with a diameter approximately between
5 and 12 voxels, or a candidate radii range between 3.5mm and 8.5mm . Please recall that small
structures are heavily prioritized over the larger ones, which is the reason why we allow the larger
LoG radius to exceed the maximum nodule radius in the dataset. The slice-wise candidate search
and the prioritization of small structures by the LoG ﬁlters reduces the segmentation performance
of the method. For instance, due to the partial-volume effect, small solid nodules are usually only
well circumscribed and contrasted on a single slice, hindering the detection of the same candidate
on adjacent slices. Smooth boundaries between the lung and the non-parenchymal tissue further
affect the segmentation. Furthermore, the ground-truth sometimes does not start exactly attached
to the lung wall, as visible in Fig. 4.5c and Fig. 4.5d, and thus our segmentation includes volumes
outside the ground-truth. In fact, the candidate vs ground-truth Dice coefﬁcient is 0.22 ± 0.14,
including missing nodules. Fig. 4.5a shows a representaive example of a reconstructed nodule.
Changing the weights between the different LoG ﬁlters improves the segmentation results
because it allows to include more subtle and larger strucutres. However, it was found that the
connection between different structures increases, affecting the FP reduction even more than the
under-segmentation. The effects of this under-segmentation will be discussed in the next section.
Table 4.4: Maximum sensitivity values (%) for juxta-pleural nodules reported by Retico et al.
 ; De Nunzio et al. ; Han et al. 
Our method
Sensitivity
Number of nodules
4.3 Candidate detection
Ground-truth
(a) 3D reconstruction.
(b) 0520, 371
(c) 0520, 374
(d) 0520, 376
(e) 0520, 378
Figure 4.5: 3D reconstruction of a juxta-pleural lung nodule candidate (orange) along with the
ground-truth (yellow). The correspond initial, middle and ﬁnal slices are shown. Each example is
retrieved from a different slice (LIDC-IDRI case#, slice#). Blue scale bar corresponds to 5mm.
After the candidate detection step, any candidate with at least 1 voxel overlapping the groundtruth is considered a TP. Otherwise, it is considered as a FP. Nodules that correspond to more
than one candidate are only considered once. The maximum sensitivity achieved by our system
per nodule texture and agreement level among specialists is shown in Table 4.3. To achieve the
results shown in Table 4.3, 3450±2272 FPs are detected per scan. Our detection system is able to
identify the majority of the solid and sub-solid juxta-pleural nodules with radius ≤5mm. Fig. 4.6a,
Fig. 4.6b and Fig. 4.6c show examples of solid nodules, well contrasted with the non-parenchymal
tissue, being properly detected. Fig. 4.6d shows a detected sub-solid nodule. Note that only the
periphery of the nodule is not detected due to the lack of contrast.
The overall sensitivity of the proposed juxta-pleural nodule detection method is 92.1%. Considering only solid and sub-solid nodule textures, the sensitivity increases to 95.3%, which is near
the maximum sensitivity limit referred. The performance of the system further improves if an
agreement level ≥2 is considered. On the other hand, the detection sensitivity for the non-solid
nodules is poor, with only approximately half of these nodules being detected. Non-solid nodules,
especially small ones, are quite challenging to detect due to the lack of contrast. For instance, the
nodule shown in Fig. 4.6e is not detected. A different enhancement technique, such as a texturerelated approach, should be employed to detect these abnormalities.
The maximum sensitivities achieved by Retico et al. ; De Nunzio et al. ; Han
et al. are shown in Table 4.4. Retico et al. considered only small solid nodules
whereas Han et al. considered all the LIDC-IDRI radii range. De Nunzio et al. does
not state either the nodule radius or nodule texture of their dataset. However, as their method is
based on the localization of deformations caused by lung nodules, it is assumable that the searched
Results and discussion
(a) 0005, 89
(b) 0040, 44
(c) 0520, 374
(d) 0312, 118
(e) 0721, 85
(f) 0005, 50
(g) 0040, 44
(h) 0520, 374
(i) 0312, 118
(j) 0721, 85
Figure 4.6: Juxta-pleural lung nodules with radius ≤5mm (ﬁrst row) and respective detection
(second row). Each example is retrieved from a scan and slice (LIDC-IDRI case#, slice#). Blue
scale bar corresponds to 5mm.
nodules are solid. Their evaluation is not performed using the LIDC-IDRI and so the difﬁculty
of the images and number of FPs produced are not directly comparable. Retico et al. 
achieved a maximum sensitivity of 94.4% and De Nunzio et al. of 92.3%, whereas our
system achieves 95.3% for sub-solid and solid nodules. Both Retico et al. and De Nunzio
et al. search concavities in the lung volume segmentation to detect candidates. Consequently, their method fails if no deformation occurs. For instance, some juxta-pleural nodules are
connected to the pleura with a subtle peduncle (Fig. 4.3b) and thus do not cause deformations of
the lung segmentation border. In fact, De Nunzio et al. states that all the missed nodules are
connected with peduncles. Our method, on the other hand, searches candidates inside the rectiﬁed
lung volume. Consequently, the risk of failing the detection of juxta-pleural nodules that do not
cause deformations on the mask is reduced.
Han et al. achieves 100% sensitivity. This work only considers solid and sub-solid
nodules, which increases the system’s performance. Furthermore, the lower number of scans
might have allowed to avoid some of the most difﬁcult juxta-pleural nodules. Note that, similarly
to our work, the authors also perform morphological operations to rectify the lung volume and
thus their system could miss the same nodules as ours. Statistically our results are more robust
because a higher number of nodules and scans are used.
The maximum sensitivity of our candidate detection method is satisfactory when considering
the difﬁcult location of the juxta-pleural nodules. Our method studies a large number of nodules
and scans in comparison with other works. Despite the good performance, speciﬁcally for subsolid and solid nodules, a more reﬁned lung mask is needed to include the solid nodules that appear
near the terminal regions of the lungs. Also, there is need to use a to better method to enhance
sub-solid and specially non-solid nodules in order to improve our results.
4.4 False positive reduction
Table 4.5: Maximum achieved sensitivity values (%) for the proposed method, after the false
positive reduction step, per nodule texture and minimum agreement level between specialists.
Nodule texture
Agreement level
At least 4
At least 3
At least 2
At least 1
Number of nodules
False positive reduction
The proposed cadidate detection step produces an average of 3450±2272 FPs/scan. This number
of FPs is signiﬁcantly reduced by the ﬁxed-rules based reduction and the supervised FP reduction.
The performance is mostly affected by the ﬁxed-rules based reduction, as discussed in this section.
Fixed-rules based FP reduction
The most obvious non-nodule candidates are eliminated via ﬁxed-rules. First, ensuring a safety
margin due to the possibility of small attached structures, all candidates with radius ≥6mm along
with those that dist more than 6mm from the pleural wall are eliminated. After this step, the number
of FPs/scan is reduced to 352 ± 154 and our maximum sensitivity also drops to approximately
86%. The wrongly-eliminated nodules usually correspond to abnormalities that are connected to
blood vessels or noisy structures, as exempliﬁed in Fig. 4.7a. Juxta-vascular nodules also require
attention from a dedicated system and thus their detection by our system should not be prioritized.
Then, the ﬁltering using the radius ≤1.5mm criteria reduces our sensitivity to 72.5% with 95.5±
52.1 FPs/scan. The maximum sensitivity achieved after this step is shown in Table 4.5.
The removal of candidates with radius ≤1.5mm is a critical step of our system. Without this
step the high number of FPs would not allow to achieve a good classiﬁcation performance by either of the metrics referred in Section 3.6. On the other hand, our maximum sensitivity highly
penalized by this reduction. The drop in the sensitivity value results from the poor segmentation
of the nodules. Recall that average Dice coefﬁcient prior to FP reduction is just 0.22±0.14. Consequently, for the smaller nodules the segmentation is expected to be bellow the deﬁned threshold,
affecting the ﬁnal sensitivity. In fact, sub-solid and non-solid nodules are the most affected by the
ﬁxed rules-based reduction, as visible in Table 4.5 and illustrated by Fig. 4.7b and Fig. 4.7c.
The initial FP reduction step is not avoidable due to the large number of FPs that result from
small blood vessels along the lung parenchyma. Some characteristic examples of non-nodule
candidates are shown in Fig. 4.7d and Fig. 4.7e. Furthermore, although our sensitivity reduction
is much higher than Han et al. (97% with approx. 60 FPs/scan), our ﬁxed-rules are only
nodule-dependent and do not rely on prior knowledge of the candidates properties. Despite the
low overall sensitivity, our system is capable of retaining almost 80% of the solid nodules.
Results and discussion
(a) 0063, 61
(b) 0677, 374
(c) 0743, 17
(d) 0820, 215
(e) 0634, 132
Figure 4.7: Juxta-pleural lung nodule candidates marked with orange contour. The yellow contour
corresponds to the ground-truth. Each example is retrieved from a scan and slice (LIDC-IDRI
case#, slice#). Blue scale bar corresponds to 5mm.
Generically, there is the need to improve the nodule segmentation after the initial candidate
detection. Improving the segmentation will allow to retain a larger number of nodules after the
reduction with the ﬁxed rules. A possible solution is to use a 3D active contour initialized from
a sphere with the candidate’s diameter, as suggested by Cascio et al. , because it allows to
constraint the segmentation and thus avoid the risk of leaking of region-growing based methods.
Segmenting the vessel tree is also of interest, as some candidates occur in blood vessels that show
as blob structures on certain slices. Furthermore, there is also the possibility to replace the ﬁxed
rules by a ﬁrst and simpler supervised learning approach as performed by Murphy et al. .
Supervised learning FP reduction
The candidates that remain after the ﬁxed-rules based reductions are equally divided, scan-wise,
in test and training sets. The SMV-rbf classiﬁer is trained using the training set and tested in the
rest of the candidates. This process is repeated 100× and the average ROC curve (± standard
deviation) is obtained. Fig. 4.8a shows the ROC curve of our classiﬁer.
False positive ratio
Sensitivity
(a) Classiﬁer ROC curve.
False positive ratio
Sensitivity
(b) Classiﬁer ROC curve detail.
Figure 4.8: ROC curves of the proposed classiﬁer for the detection of juxta-pleural nodules with
radius ≤5mm after the false positive reduction. The standard deviation is shown in yellow. Specialists’ agreement level is at least 1.
4.5 Comparison with existing methods
Table 4.6: Area under the ROC curve of the classiﬁers used to reduce the number of juxta-pleural
nodules reported by Retico et al. ; De Nunzio et al. ; Han et al. .
Our method
For our method it is expected that the number of FPs is reduced by at least 10× in order to
achieve results comparable with the literature. Consequently, a fast evolution of the ROC curve
for the ﬁrst 0.1 FP ratio is essential. From the observation of Fig. 4.8b it is visible that reducing
the number of FPs to 1/10 our sensitivity drops approximately 10%. It is thus noticeable that the
ﬁxed-rules based reduction is the limiting performance step of our method.
The fast evolution of the curve for low false positive ratios is related to the area under the ROC
curve (AUC). Consequently, the performance of the supervised learning FP reduction step can
be evaluated in terms of AUC. Table 4.6 shows the AUC obtained for the works currently being
discussed. De Nunzio et al. used features related to intensity and geometry. Retico et al.
 also used hessian-related features. Han et al. used gradient and intensity features,
achieving the highest AUC of the reviewed works. Gradient features appear to be important to the
performance of the classiﬁcation, being used by the works with highest AUC. Han et al. 
also reported a performance drop when considering geometric features. This is most likely due to
the fact the their method already considers multiple geometry features for rule-based FP reduction.
The performance of our classiﬁer is similar to Han et al. , even though our candidate
segmentation is most likely poorer and non-solid nodules are also considered. Feature selection to
remove redundant features should further improve our results. Nevertheless, it is proven that the
limiting step in our algorithm is the ﬁxed-rules based FP reduction.
Comparison with existing methods
The overall performance of the proposed method in terms of FROC curve is shown in Fig. 4.9.
Note that our maximum sensitivity is 72.5%, namely due to the poor FP reduction resultd using ﬁxed-rules. With 4 FPs/scan our system achieves a sensitivity of 57.2 % and 63.5% with 8
FPs/scan. For solid nodules, which correspond to the majority of the studied cases, our method
achieves sensitivities of 61.8% and 68.5%, respectively. Our average score (Section 3.6) is computed by averaging the values highlighted in Fig. 4.9b. Table 4.7 shows the ﬁnal performance of
our system in terms of sensitivity and score for the different nodule textures.
Table 4.7: Performance of the proposed juxta-pleural lung nodule detection method for different
nodule textures.
Nodule texture
Sensitivity (%)
All textures
Sub-solid and solid
Results and discussion
Table 4.8: Juxta-pleural lung nodule detection performance of different systems. r is the nodule
radius. A - Retico et al. , B - De Nunzio et al. , C - Han et al. , D - Fujitalab,
E - Region growing volume plateau, F - Channeler Ant model, G - Voxel-based neural approach,
H - ISI-CAD, I - Philips Lung Nodule CAD ).
Sensitivity (%)
False positives
Sensitivity
(a) FROC curve.
False positives
Sensitivity
(b) FROC curve detail.
Figure 4.9: FROC curves of the proposed system for the detection of juxta-pleural nodules with
radius ≤5mm after the false positive reduction. Specialists’ agreement level is at least 1.
Table 4.8 shows a comparison of our results with those of Retico et al. ; De Nunzio
et al. ; Han et al. as well as the works compared in van Ginneken et al. in
terms of FPs/scan and average score. The majority of the nodules evaluated in these works has
solid texture. As a note, please consider that the comparison between works that do not use the
same set of nodules is difﬁcult due to the differences between both ground-truth and images.
Sensitivity-wise, Han et al. have the best performance, achieving 89% with 4 FPs/scan.
The used approach, vector quantization, is interesting for juxta-pleural detection as it exploits the
intensity differences between structures. However, other methods such as the Region growing
volume plateau and the Channeler Ant model also use intensity based approaches to detect their
candidates. Despite that, their performance is signiﬁcantly worse, with sensitivities bellow 50%.
The most likely reason for this is that these methods do not properly explore the boundary regions
of the lung volume as they are region-growing based. Also, their FP reduction is not as effective.
4.5 Comparison with existing methods
On the other hand, methods speciﬁcally designed to detect juxta-pleural nodules, Retico et al.
 ; De Nunzio et al. and Voxel-based neural approach do not out-perform intensitybased methods, even though they are dedicated. These approaches try to detect the deformations
caused by the nodules on the lung mask. However, this method assumes that all juxta-pleural
nodules will cause deformations, both 2D and 3D, that they are not attached by peduncles and that
the natural noise created by the shape of the lungs’ boundaries between slices is irrelevant. If these
conditions are not met the methods tend to under-perform, explaining the obtained results. Finally,
methods such as ISI-CAD search candidates by their shape characteristics. The performance of this
method is affected by juxta-pleural nodules because they are not as rounded as isolated nodules.
Despite that, both sensitivity and score are good in comparison to other methods, having achieved
an accuracy and a score of 69.5% and 0.44, respectively.
The proposed method is designed to combine intensity-based and shape-based approaches.
Consequently, the structure of our system is closer to those of Han et al. and ISI-CAD.
We avoid searching for deformations of the lungs’ limits and instead search inside a rectiﬁed
lung volume segmentation, which proved to be advantageous because we can also ﬁnd nodules
connected with peduncles, as well as sub-solid and non-solid nodules.
Our score and sensitivity are similar to the ones achieved by ISI-CAD when considering solid
nodules. When comparing to Han et al. , however, our performance is signiﬁcantly worse.
Our performance difference with these two best works can be partially explained by the differences
between the two works. Han et al. did not do a proper selection of the nodules considered
as juxta-pleural, as discussed before, which may be inadvertently improving their results. Furthermore, the evaluation of these two methods considered less scans and less nodules than ours,
and consequently our results might have been hindered by more complicated cases. Furthermore,
our method also focuses on a smaller average nodule radii, increasing the difﬁculty of the detection process ). Finally, our initial candidate reduction is worse than those of
these methods. Han et al. use an adapted set of ﬁxed-rules that signiﬁcantly reduces the
number of FPs without compromising the sensitivity. However, the rules are biased by the data in
question. The ISI-CAD method uses k-NN classiﬁcation to perform an initial candidate reduction.
This is pertinent as it is less data-dependent than the ﬁxed rules. However, using two consecutive
classiﬁers would be impracticable in our method due to the high initial number of FP. A possible solution would be to replace the ﬁxed-rules step by one that uses ﬁxed-rules to remove the
larger nodules and then a simple classiﬁer to distinguish between small nodule and non-nodule
structures. The remaining FP would then be analyzed by the proposed SVM-rbf classiﬁer.
Results and discussion
Concluding remarks
The evaluation of the proposed method to detect juxta-pleural lung nodules in CT scans is presented in this section. We discuss the improvement of the lung volume segmentation, the performance of the candidate detection as well as the FP reduction. An overall comparison with
state-of-the-art methods that refer their performance for juxta-pleural nodules is also presented.
A characterization of the juxta-pleural lung nodule dataset is performed. In comparison to the
nodules available in the LIDC-IDRI, juxta-pleural nodules present a lower agreement level among
the specialists and are more subtle. These characteristics, along with the inherent location of the
nodules, lead to an increase in the detection difﬁculty.
The proposed reﬁnement of the lung volume segmentation has proven to improve the performance of the system, both in terms of number and volume of the nodules included in the segmentation. The majority of the nodules not included corresponds to solid nodules that occur near
the upper and lower limits of the lungs. A possible solution to include these nodules is to use an
average 3D model of the lungs and perform the active contour reﬁnement 3D-wise.
Our candidate detection method shows high sensitivity values for solid and sub-solid nodules.
On the other hand, the lack of contrast of non-solid nodules hinders their detection. Furthermore,
the overall segmentation of the nodules is poor. Improvements in the segmentation could be performed by changing the weight of the different LoG ﬁlters. However, this increases the risk of
attachment between structures. The under-segmentation does not affect the detection sensitivity
but affects the reduction of FPs.
The reduction of the number of FPs is divided in two steps. In the proposed method the
step that most affects the system’s performance is the FP reduction via ﬁxed rules. Due to the
the under-segmentation, the ﬁltering of low-radii candidates signiﬁcantly reduces our sensitivity.
Consequently, a proper candidate segmentation has to be performed in order to improve the results.
Due to the risk of leakage of region-growing approaches, 3D segmentation using active contours
is most-likely a solution for this problem. The second step, which uses supervised learning, shows
a performance similar to the state-of-the-art works. Further improvement of the classiﬁer can be
performed with feature selection to remove highly correlated features.
Our system shows a performance similar or better than other state-of-the-art works. In fact, the
proposed method combines the basic idea of the two best performing algorithms, exploiting both
the difference intensity between solid nodules and parenchymal tissue and the natural roundness of
the nodules. The studied dataset can be considered of increased difﬁculty due to the small nodule
radius and thus our method presents itself as a good starting point for a high performance system
dedicated to the detection of juxta-pleural lung nodules. The implementation of the improvements
referred previously is expected to further increase the overall performance of our system.
Conclusion and Future work
Second-opinion CADe systems are useful to increase the overall cancer detection performance of
physicians. Several approaches regarding lung nodule detection in CT scans have already been
proposed and showed good detection success. However, the performance of these systems drops
for juxta-pleural nodules, which are abnormalities that occur near the pleural wall. Despite that,
there are few works addressing speciﬁcally this type of nodule.
A juxta-pleural lung nodule detection method is proposed. For that purpose, a juxta-pleural
lung nodule sub-dataset from the LIDC/IDRI dataset was created. This sub-dataset considers the
majority of the LIDC/IDRI scans and was manually revised to only include juxta-pleural nodules.
Our method exploits the intensity difference between nodules and parenchymal tissue and the
natural roundness of these structures. First, a lung volume segmentation properly rectiﬁed with
an active contour-based approach to include juxta-pleural nodules is performed. This rectiﬁcation
improves the inclusion of juxta-pleural nodules of the C-BER group lung volume segmentation
algorithm. Then, candidates are detected by selecting an appropriate threshold on a sliding window. The more subtle candidates are enhanced with Laplacian-of-Gaussian ﬁltering. Then, FPs
are reduced via ﬁxed-rules and supervised learning.
The juxta-pleural lung nodule detection method achieves high sensitivity values prior to the
FP reduction with ﬁxed-rules and supervised learning. For this ﬁrst step, missed nodules are essentially non-solid nodules, which detection is not trivial due to the lack of contrast. However,
some solid nodules near the limits of the lungs are also not detected. There is thus need to improve the initial lung volume segmentation to include these most challenging nodules. Our overall
sensitivity signiﬁcantly drops after the ﬁxed-rules based reduction. This happens essentially due
to a poor segmentation of the candidates. It is demanding that a proper FP reduction is performed.
There are numerous candidates occurring on blood vessels and other blob-like structures that must
be removed from the candidate list prior to the supervised learning FP reduction. Due to the
under-segmentation, these candidates end up having the same characteristics as the detected nodules. Consequently, their elimination also results in the elimination of TP candidates, affecting our
results. With this in mind, the following future improvements are suggested:
Conclusion and Future work
1. Lung volume segmentation: there is the need to improve the lung volume segmentation
so that solid nodules that occur near the limits of the lungs are also detected. A possible
approach is to use 3D active contour with an average 3D model of the lung mask.
2. FP reduction: a proper FP reduction is essential to obtain an algorithm with excellent performance. The proposed FP reduction schemes fails due to a poor 3D candidate segmentation
and selection of blood vessels as candidates. Consequently, it is of interest to:
• Improve the candidate 3D segmentation. Due to the position of juxta-pleural nodules,
region-growing based approaches are not recommended. A possible solution is to
use 3D active contour considering as the initilization model a sphere with the same
diameter of the candidate.
• Segment the blood vessel tree using, for instance, a region-growing based approach.
This segmentation needs to be precise so that nodules are not included.
Despite the detected problems, our dedicated CADe has a performance similar to state-of-theart works and consequently shows great potential for the detection of juxta-pleural lung nodules.
The implementation of the previously referred suggestions, and consequent performance improvement, will further increase the importance of the integration of the proposed method on a complete,
multi-dedicated CAD system.
Appendix A
Juxta-pleural lung nodules
The list of the juxta-pleural lung nodules available in the LIDC-IDRI dataset is presented in the
next pages. The number of the LIDC-IDRI case, the ﬁrst and last slice of nodule and the its radius
are shown. The information is divided in 6 different pages for convenience.
Juxta-pleural lung nodules
Table A.1: Juxta-pleural lung nodules available in the LIDC-IDRI dataset (1 out of 6)
Slice range
Radius (mm)
Slice range
Radius (mm)
Slice range
Radius (mm)
Juxta-pleural lung nodules
Table A.2: Juxta-pleural lung nodules available in the LIDC-IDRI dataset (2 out of 6)
Slice range
Radius (mm)
Slice range
Radius (mm)
Slice range
Radius (mm)
Juxta-pleural lung nodules
Table A.3: Juxta-pleural lung nodules available in the LIDC-IDRI dataset (3 out of 6)
Slice range
Radius (mm)
Slice range
Radius (mm)
Slice range
Radius (mm)
Juxta-pleural lung nodules
Table A.4: Juxta-pleural lung nodules available in the LIDC-IDRI dataset (4 out of 6)
Slice range
Radius (mm)
Slice range
Radius (mm)
Slice range
Radius (mm)
Juxta-pleural lung nodules
Table A.5: Juxta-pleural lung nodules available in the LIDC-IDRI dataset (5 out of 6)
Slice range
Radius (mm)
Slice range
Radius (mm)
Slice range
Radius (mm)
Juxta-pleural lung nodules
Table A.6: Juxta-pleural lung nodules available in the LIDC-IDRI dataset (6 out of 6)
Slice range
Radius (mm)
Juxta-pleural lung nodules
References
Ahn, M. I., Gleeson, T. G., Chan, I. H., et al. Periﬁssural Nodules Seen at CT Screening for Lung
Cancer 1. Radiology, 2010, 254(3):949–956. doi: 10.1148/radiol.09090031. URL http:
//pubs.rsna.org/doi/abs/10.1148/radiol.09090031.
Ajanki, A. 2007, kNN Classiﬁcation. URL 
e{%}3AKnnClassification.svg.
Alilou, M., Kovalev, V., Snezhko, E., et al. A comprehensive framework for automatic detection
of pulmonary nodules in lung CT images. Image Analysis & Stereology, 2014, 33(1):13. doi:
10.5566/ias.v33.p13-27. URL 
ANODE09. 2009, Automatic Nodule Detection 2009. URL 
enge.org/.
Armato, S. G., McLennan, G., Bidaut, L., et al. The Lung Image Database Consortium (LIDC) and
Image Database Resource Initiative (IDRI): A Completed Reference Database of Lung Nodules
on CT Scans. Medical Physics, 2011, 38(2):915. doi: 10.1118/1.3528204. URL 
ation.aip.org/content/aapm/journal/medphys/38/2/10.1118/1.3528204.
Armato III, S. G., McLennan, G., McNitt-Gray, M. F., et al. Lung Image Database Consortium:
Developing a Resource for the Medical Imaging Research Community1. Radiology, 2004, 232
(3):739–748. doi: 10.1148/radiol.2323032035. URL 
10.1148/radiol.2323032035.
Bach, P. B., Mirkin, J. N., Oliver, T. K., et al. Beneﬁts and Harms of CT Screening for Lung
Cancer. JAMA, 2012, 307(22):2418. doi: 10.1001/jama.2012.5521. URL 
anetwork.com/article.aspx?doi=10.1001/jama.2012.5521.
Badura, P. and Pietka, E. Soft computing approach to 3D lung nodule segmentation in CT. Computers in Biology and Medicine, 2014, 53:230–243. doi: 10.1016/j.compbiomed.2014.08.005.
URL 
Brown, M. S., Lo, P., Goldin, J. G., et al.
Toward clinically usable CAD for lung
cancer screening with computed tomography.
European Radiology, 2014, 24(11):2719–
2728. doi: 10.1007/s00330-014-3329-0. URL 
s00330-014-3329-0.
Camarlinghi, N., Gori, I., Retico, A., et al. Combination of computer-aided detection algorithms
for automatic lung nodule identiﬁcation. International Journal of Computer Assisted Radiology
and Surgery, 2012, 7(3):455–464. doi: 10.1007/s11548-011-0637-6. URL 
pringer.com/10.1007/s11548-011-0637-6.
REFERENCES
Cascio, D., Magro, R., Fauci, F., et al. Automatic detection of lung nodules in CT datasets based
on stable 3D mass–spring models. Computers in Biology and Medicine, 2012, 42(11):1098–
1109. doi: 10.1016/j.compbiomed.2012.09.002. URL 
com/retrieve/pii/S0010482512001400.
Castellino, R. A. Computer aided detection (CAD): an overview. Cancer Imaging, 2005, 5(1):17–
19. doi: 10.1102/1470-7330.2005.0018. URL 
5/1/0018/.
Chan, T. F. and Vese, L. A. Active contours without edges. IEEE Transactions on Image Processing, 2001, 10(2):266–277. doi: 10.1109/83.902291.
Chang, C.-C. and Lin, C.-J. {LIBSVM}: A library for support vector machines. ACM Transactions on Intelligent Systems and Technology, 2011, 2(3):27:1—-27:27.
Choi, W.-J. and Choi, T.-S. Automated Pulmonary Nodule Detection System in Computed Tomography Images: A Hierarchical Block Classiﬁcation Approach. Entropy, 2013, 15(2):507–523.
doi: 10.3390/e15020507. URL 
Choi, W.-J. and Choi, T.-S. Automated pulmonary nodule detection based on three-dimensional
shape-based feature descriptor. Computer Methods and Programs in Biomedicine, 2014, 113
(1):37–54. doi: 10.1016/j.cmpb.2013.08.015. URL 
m/retrieve/pii/S0169260713002940.
Davidian, D. 1995, Feed-forward neural network. URL 
/US5438646.
De Angelis, R., Sant, M., Coleman, M. P., et al. Cancer survival in Europe 1999–2007 by country
and age: results of EUROCARE-5—a population-based study. The Lancet Oncology, 2014, 15
(1):23–34. doi: 10.1016/S1470-2045(13)70546-1. URL 
com/retrieve/pii/S1470204513705461.
de Carvalho Filho, A. O., de Sampaio, W. B., Silva, A. C., et al. Automatic detection of solitary
lung nodules using quality threshold clustering, genetic algorithm and diversity index. Artiﬁcial
Intelligence in Medicine, 2014, 60(3):165–177. doi: 10.1016/j.artmed.2013.11.002. URL ht
tp://linkinghub.elsevier.com/retrieve/pii/S0933365713001541.
De Nunzio, G., Massafra, A., Cataldo, R., et al. Approaches to juxta-pleural nodule detection in
CT images within the MAGIC-5 Collaboration. Nuclear Instruments and Methods in Physics
Research Section A: Accelerators, Spectrometers, Detectors and Associated Equipment, 2011,
648:S103–S106. doi: 10.1016/j.nima.2010.12.082. URL 
r.com/retrieve/pii/S0168900210028238.
Measures of the amount of ecologic association between species. Ecology, 1945, 26:
297–302. doi: doi:10.2307/1932409.
El-Baz, A., Beache, G. M., Gimel’farb, G., et al. Computer-Aided Diagnosis Systems for Lung
Cancer: Challenges and Methodologies. International Journal of Biomedical Imaging, 2013,
2013:1–46. doi: 10.1155/2013/942353. URL 
jbi/2013/942353/.
REFERENCES
Flach, P., Hernández-Orallo, J., and Ferri, C. A coherent interpretation of auc as a measure of
aggregated classiﬁcation performance. International Conference on Machine Learning, 2011,
 :657–664. doi: 10.1145/347090.347126. URL 
papers/385{_}icmlpaper.pdf.
Getreuer, P. Chan-Vese Segmentation. Image Processing On Line, 2012, 2:214–224. doi: 10.
5201/ipol.2012.g-cv. URL 
Glass, G. V. and Hopkins, K. D. Statistical Methods in Education and Psychology. Statistical
Methods in Education and Psychology. Allyn and Bacon, 1996, 3 edition. URL 
oks.google.pt/books?id=SFmdAAAAMAAJ.
Goldman, L. W. Principles of CT: Multislice CT. Journal of Nuclear Medicine Technology, 2008,
36(2):57–68. doi: 10.2967/jnmt.107.044826. URL 
gi/doi/10.2967/jnmt.107.044826.
Golosio, B., Masala, G. L., Piccioli, A., et al. A novel multithreshold method for nodule detection
in lung CT. Medical Physics, 2009, 36(8):3607. doi: 10.1118/1.3160107. URL 
ation.aip.org/content/aapm/journal/medphys/36/8/10.1118/1.3160107.
Gray, H., Gray, H., and Lewis, W. H. Anatomy of the human body. Lea & Febiger„ Philadelphia„
1918, 20th edition. doi: 10.5962/bhl.title.20311. URL 
ary.org/bibliography/20311.
Guo, W. and Li, Q.
High performance lung nodule detection schemes in CT using local
and global information.
Medical Physics, 2012, 39(8):5157.
10.1118/1.4737109.
URL 
1118/1.4737109.
Han, H., Li, L., Han, F., et al. Fast and Adaptive Detection of Pulmonary Nodules in Thoracic
CT Images Using a Hierarchical Vector Quantization Scheme. IEEE Journal of Biomedical
and Health Informatics, 2015, 19(2):648–659. doi: 10.1109/JBHI.2014.2328870. URL http:
//ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=6825802.
Hearst, M., Dumais, S., Osman, E., et al. Support vector machines. IEEE Intelligent Systems,
1998, 13(4):18–28. doi: 10.1109/5254.708428. URL 
docs/epic03/wrapper.htm?arnumber=708428.
Holmes, E. J., Forrest-Hay, A. C., and Misra, R. R.
Interpretation of Emergency Head
Cambridge University Press, 2008, Cambridge.
doi: 10.1017/CBO9780511544804.
URL 
bridge.org/ref/id/CBO9780511544804.
Jacobs, C., van Rikxoort, E. M., Twellmann, T., et al.
Automatic detection of subsolid pulmonary nodules in thoracic computed tomography images.
Medical Image
18(2):374–384.
10.1016/j.media.2013.12.001.
 
.elsevier.com/retrieve/pii/S1361841513001722.
Kong, H., Akakin, H. C., and Sarma, S. E. A generalized laplacian of gaussian ﬁlter for blob
detection and its applications. IEEE Transactions on Cybernetics, 2013, 43(6):1719–1733. doi:
10.1109/TSMCB.2012.2228639.
REFERENCES
Li, Q., Sone, S., and Doi, K.
Selective enhancement ﬁlters for nodules, vessels, and airway
walls in two- and three-dimensional CT scans.
Medical Physics, 2003, 30(8):2040.
10.1118/1.1581411. URL 
edphys/30/8/10.1118/1.1581411.
Lopez Torres, E., Fiorina, E., Pennazio, F., et al. Large scale validation of the M5L lung CAD
on heterogeneous CT datasets.
Medical Physics, 2015, 42(4):1477–1489.
doi: 10.1118/
1.4907970. URL 
ation.aip.org/content/aapm/journal/medphys/42/4/10.1118/1.4907970.
Marr, D. and Hildreth, E. Theory of Edge Detection. Proceedings of the Royal Society of London
B: Biological Sciences, 1980, 207(1167):187–217. doi: 10.1098/rspb.1980.0020. URL http:
//rspb.royalsocietypublishing.org/content/207/1167/187.
Messay, T., Hardie, R. C., and Rogers, S. K.
A new computationally efﬁcient CAD system
for pulmonary nodule detection in CT imagery.
Medical Image Analysis, 2010, 14(3):
10.1016/j.media.2010.02.004.
URL 
j.media.2010.02.004 
1361841510000198.
Murphy, K., van Ginneken, B., Schilham, A., et al. A large-scale evaluation of automatic pulmonary nodule detection in chest CT using local image features and k-nearest-neighbour classiﬁcation.
Medical Image Analysis, 2009, 13(5):757–770.
doi: 10.1016/j.media.2009.07.
001. URL 
ghub.elsevier.com/retrieve/pii/S1361841509000516.
NIH. 2015, What is cancer? URL 
Novo, J., Rouco, J., Mendonça, A., et al. Reliable lung segmentation methodology by including
juxtapleural nodules, volume 8815 of Lecture Notes in Computer Science. Springer International Publishing, 2014, Cham. doi: 10.1007/978-3-319-11755-3. URL 
inger.com/10.1007/978-3-319-11755-3.
Novo, J., Goncalves, L., Mendonça, A. M., et al. 3D lung nodule candidate detection in multiple
scales. In 2015 14th IAPR International Conference on Machine Vision Applications (MVA),
pages 61–64. 2015, IEEE. doi: 10.1109/MVA.2015.7153133. URL 
eee.org/lpdocs/epic03/wrapper.htm?arnumber=7153133.
Okada, K., Ramesh, V., Krishnan, A., et al. Robust Pulmonary Nodule Segmentation in CT:
Improving Performance for Juxtapleural Cases. In Medical image computing and computerassisted intervention: MICCAI, International Conference on Medical Image Computing and
Computer-Assisted Intervention, volume 8, 2005. pages 781–789. doi: 10.1007/11566489_
96. URL 
ger.com/10.1007/11566489{_}96.
OpenStaxCollege-Anatomy&Physiology.
 
itis-s4-how-pleura-works.jpg.
Opfer, R. and Wiemker, R. Performance analysis for computer-aided lung nodule detection on
LIDC data. In Jiang, Y. and Sahiner, B., editors, Proceedings of SPIE, volume 6515, 2007,
REFERENCES
pages 65151C–65151C–9. doi: 10.1117/12.708210. URL 
gitallibrary.org/proceeding.aspx?articleid=1336879.
A Threshold Selection Method from Gray-Level Histograms.
IEEE Transactions on Systems, Man, and Cybernetics, 1979, 9(1):62–66.
10.1109/TSMC.1979.
4310076. URL 
number=4310076.
Pedregosa, F., Varoquaux, G., Gramfort, A., et al. Scikit-learn: Machine Learning in {P}ython.
Journal of Machine Learning Research, 2011, 12:2825–2830.
Sequential minimal optimization: A fast algorithm for training support vector machines. Advances in Kernel MethodsSupport Vector Learning, 1998, 208:1–21. doi: 10.1.1.
43.4376. URL 
1.55.560{&}rep=rep1{&}type=pdf.
Pu, J., Zheng, B., Leader, J. K., et al. An automated CT based lung nodule detection scheme
using geometric analysis of signed distance ﬁeld. Medical Physics, 2008, 35(8):3453. doi:
10.1118/1.2948349.
URL 
s1{&}Agg=doi 
/35/8/10.1118/1.2948349.
Retico, A., Delogu, P., Fantacci, M., et al. Lung nodule detection in low-dose and thin-slice
computed tomography.
Computers in Biology and Medicine, 2008, 38(4):525–534.
10.1016/j.compbiomed.2008.02.001.
URL 
ieve/pii/S0010482508000206.
Pleural nodule identiﬁcation in low-dose
and thin-slice lung computed tomography.
Computers in Biology and Medicine,
39(12):1137–1144.
10.1016/j.compbiomed.2009.10.005.
//www.ncbi.nlm.nih.gov/pubmed/19883906 
r.com/retrieve/pii/S0010482509001814.
Ridler, T. and Calvard, S. Picture Thresholding Using an Iterative Selection Method. IEEE Transactions on Systems, Man, and Cybernetics, 1978, 8(8):630–632. doi: 10.1109/TSMC.1978.
4310039. URL 
number=4310039.
Setio, A. A. A., Jacobs, C., Gelderblom, J., et al.
Automatic detection of large pulmonary
solid nodules in thoracic CT images.
Medical Physics, 2015, 42(10):5642–5653.
10.1118/1.4929562. URL 
edphys/42/10/10.1118/1.4929562.
Siegel, R. L., Miller, K. D., and Jemal, A. Cancer statistics, 2015. CA: A Cancer Journal for
Clinicians, 2015, 65(1):5–29. doi: 10.3322/caac.21254. URL 
10.3322/caac.21254.
Smola, A. and Vishwanathan, S. Introduction to machine learning. Cambridge University Press,
2014, 1107:105–128. URL 
Soret, M., Bacharach, S. L., and Buvat, I. Partial-Volume Effect in PET Tumor Imaging. Journal
of Nuclear Medicine, 2007, 48(6):932–945. doi: 10.2967/jnumed.106.035774. URL http:
//jnm.snmjournals.org/cgi/doi/10.2967/jnumed.106.035774.
REFERENCES
Sun, S., Guo, Y., Guan, Y., et al. Juxta-Vascular Nodule Segmentation Based on Flow Entropy
and Geodesic Distance. IEEE Journal of Biomedical and Health Informatics, 2014, 18(4):
1355–1362. doi: 10.1109/JBHI.2014.2303511. URL 
docs/epic03/wrapper.htm?arnumber=6728607.
Swensen, S. J., Jett, J. R., Hartman, T. E., et al.
Lung Cancer Screening with CT: Mayo
Clinic Experience1.
Radiology, 2003, 226(3):756–761.
doi: 10.1148/radiol.2263020036.
URL 
g/doi/abs/10.1148/radiol.2263020036.
Tan, M., Deklerck, R., Jansen, B., et al.
A novel computer-aided lung nodule detection system for CT images.
Medical Physics, 2011, 38(10):5630.
10.1118/1.
URL 
/38/10/10.1118/1.3633941.
Tan, M., Deklerck, R., Cornelis, J., et al.
Phased searching with NEAT in a Time-Scaled
Framework:
Experiments on a computer-aided detection system for lung nodules.
Artiﬁcial Intelligence in Medicine, 2013, 59(3):157–167.
10.1016/j.artmed.2013.07.
002. URL 
ghub.elsevier.com/retrieve/pii/S0933365713000985.
Ta¸scı, E. and U˘gur, A. Shape and Texture Based Novel Features for Automated Juxtapleural
Nodule Detection in Lung CTs. Journal of Medical Systems, 2015, 39(5):46. doi: 10.1007/
s10916-015-0231-5.
URL 
p://link.springer.com/10.1007/s10916-015-0231-5.
Teramoto, A. and Fujita, H. Fast lung nodule detection in chest CT images using cylindrical
nodule-enhancement ﬁlter. International Journal of Computer Assisted Radiology and Surgery,
2013, 8(2):193–205. doi: 10.1007/s11548-012-0767-5. URL 
m/10.1007/s11548-012-0767-5.
Terzopoulos, D. and Fleischer, K.
Deformable models.
The Visual Computer, 1988, 4(6):
306–331. doi: 10.1007/BF01908877. URL 
TheCancerImagingArchiveTeam.
Data From LIDC-IDRI. doi: 10.7937/K9/TCIA.2015.LO9Q
URL 
Valente, I. R. S., Cortez, P. C., Neto, E. C., et al. Automatic 3D pulmonary nodule detection in CT
images: A survey. Computer Methods and Programs in Biomedicine, 2016, 124:91–107. doi:
10.1016/j.cmpb.2015.10.006. URL 
ii/S0169260715300298.
van Ginneken, B., Armato, S. G., de Hoop, B., et al.
Comparing and combining algorithms for computer-aided detection of pulmonary nodules in computed tomography scans:
The ANODE09 study.
Medical Image Analysis, 2010, 14(6):707–722.
j.media.2010.05.005.
URL 
1361841510000587.
van Ginneken, B., Setio, A. A. A., Jacobs, C., et al. Off-the-shelf convolutional neural network
features for pulmonary nodule detection in computed tomography scans. In 2015 IEEE 12th