How accurately can 21 cm tomography constrain cosmology?
Yi Mao,1, ∗Max Tegmark,1, 2, † Matthew McQuinn,3 Matias Zaldarriaga,3,4 and Oliver Zahn3, 5
1Center for Theoretical Physics, Dept. of Physics,
Massachusetts Institute of Technology, Cambridge, MA 02139, USA
2MIT Kavli Institute for Astrophysics and Space Research, Cambridge, MA 02139, USA
3Harvard-Smithsonian Center for Astrophysics, 60 Garden Street, Cambridge, MA 02138, USA
4Jeﬀerson Laboratory of Physics, Harvard University, Cambridge, MA 02138, USA
5Berkeley Center for Cosmological Physics, Department of Physics, University of California,
and Lawrence Berkeley National Labs, 1 Cyclotron Road, Berkeley, CA 94720, USA
 
There is growing interest in using 3-dimensional neutral hydrogen mapping with the redshifted
21 cm line as a cosmological probe. However, its utility depends on many assumptions. To aid
experimental planning and design, we quantify how the precision with which cosmological parameters
can be measured depends on a broad range of assumptions, focusing on the 21 cm signal from 6 < z <
20. We cover assumptions related to modeling of the ionization power spectrum, to the experimental
speciﬁcations like array layout and detector noise, to uncertainties in the reionization history, and
to the level of contamination from astrophysical foregrounds. We derive simple analytic estimates
for how various assumptions aﬀect an experiment’s sensitivity, and we ﬁnd that the modeling of
reionization is the most important, followed by the array layout. We present an accurate yet robust
method for measuring cosmological parameters that exploits the fact that the ionization power
spectra are rather smooth functions that can be accurately ﬁt by 7 phenomenological parameters.
We ﬁnd that for future experiments, marginalizing over these nuisance parameters may provide
almost as tight constraints on the cosmology as if 21 cm tomography measured the matter power
spectrum directly. A future square kilometer array optimized for 21 cm tomography could improve
the sensitivity to spatial curvature and neutrino masses by up to two orders of magnitude, to
∆Ωk ≈0.0002 and ∆mν ≈0.007 eV, and give a 4σ detection of the spectral index running predicted
by the simplest inﬂation models.
PACS numbers: 98.80.Es, 98.58.Ge
INTRODUCTION
Three-dimensional mapping of our Universe using the
redshifted 21 cm hydrogen line has recently emerged as
a promising cosmological probe, with arguably greater
long-term potential than the cosmic microwave background (CMB). The information garnered about cosmological parameters grows with the volume mapped, so the
ultimate goal for the cosmology community is to map our
entire horizon volume, the region from which light has
had time to reach us during the 14 billion years since our
Big Bang. Figure 1 illustrates that whereas the CMB
mainly probes a thin shell from z ∼1000, and current
large-scale structure probes (like galaxy clustering, gravitational lensing, type Ia supernovae and the Lyman α
forest) only map small volume fractions nearby, neutral
hydrogen tomography is able to map most of our horizon
Several recent studies have forecast the precision with
which such 21 cm tomography can constrain cosmological parameters, both by mapping diﬀuse hydrogen before and during the reionization epoch and by
mapping neutral hydrogen in galactic halos after reion-
∗Electronic address: 
†Electronic address: 
21 cm tomography can potentially map most of
our observable universe (light blue/light grey), whereas the
CMB probes mainly a thin shell at z ∼103 and current largescale structure surveys (here exempliﬁed by the Sloan Digital
Sky Survey and its luminous red galaxies) map only small
volumes near the center. This paper focuses on the convenient
7 ≲z ≲9 region (dark blue/dark grey).
ization . These studies ﬁnd that constraints based on
TABLE I: Factors that aﬀect the cosmological parameter measurement accuracy.
Assumptions
Pessimistic
Optimistic
Ionization
spectrum modeling
Marginalize
Pµ0 and Pµ2
Marginalize
that parametrize Pxx(k) and
No ionization
spectrum, Pδδ(k) ∝P∆T (k).
Non-linear
scale kmax
Non-Gaussianity of
ionization signals
Doubles sample variance
Negligible
Cosmological Reionization
Gradual reionization over wide range of redshifts
Abrupt reionization at z ≲7
Redshift range
Parameter space
Vanilla model plus optional
parameters
Vanilla model parameters
Experimental Data
MWA, LOFAR, 21CMA
Intermediate case
Array conﬁguration
η = 0.8, n = 2
Giant core
Collecting area b
0.5 × design values
Design values
2 × Design values
Observation time c
1000 hours
4000 hours
16000 hours
temperature
2 × Tsys in 
Tsys given in 
0.5 × Tsys in 
Astrophysical Residual
foregrounds
scale kmin
aFor the FFTT, we consider only the case where all dipoles are in
a giant core.
bSee designed or assumed values of Ae in Table IV.
cAssumes observation of two places in the sky.
dIt is hard to predict the level of the residual foregrounds after the
removal procedure. To quantify contributions from other factors,
we take the approximation that there is no residual foregrounds at
k > kmin. Here in the table, yB is the comoving (l.o.s.) distance
width of a single z-bin.
TABLE II: The dependence of cosmological constraints on the full range of assumptions. We assume the ﬁducial values given in
Section II F, and employ the Fisher matrix formalism to forecast the 1σ accuracy of 21cm tomography measurements. Unless
otherwise noted, errors are computed by marginalizing over all other parameters in the ﬁrst ten columns (which we refer to as
the “vanilla” parameters). In “All OPT/MID/PESS”, we use the assumptions of the right, middle and left column of Table I,
respectively. We assume that the total observing time is split between two sky regions, each for an amount in Table I, using
a giant/quasi-giant/small core array conﬁguration where 100%/80%/15% of the antennae in the inner core are compactly laid
at the array center while the rest 0%/20%/85% of antennae fall oﬀin density as ρ ∼r−2 outside the compact core.
Vanilla Alone
∆¯xH(7.0) a
a¯xH(z) refers to the mean neutral fraction at redshift z.
bFFTT stands for Fast Fourier Transform Telescope, a future
square kilometer array optimized for 21 cm tomography as described in . Dipoles in FFTT are all in a giant core, and this
conﬁguration does not vary.
the cosmic microwave background measurements can be
signiﬁcantly improved. However, all of these papers make
various assumptions, and it is important to quantify to
what extent their forecasts depend on these assumptions.
This issue is timely because 21 cm experiments (like LO-
FAR , 21CMA , MWA and SKA ) are still
largely in their planning, design or construction phases.
These experiments will be described in detail in Section
II G. In order to maximize their scientiﬁc “bang for the
buck”, it is therefore important to quantify how various
design tradeoﬀs aﬀect their sensitivity to cosmological
parameters.
The reason that neutral hydrogen allows mapping in
three rather than two dimensions is that the redshift of
the 21 cm line provides the radial coordinate along the
line-of-sight (l.o.s.). This signal can be observed from the
so-called dark ages before any stars had formed,
through the epoch of reionization (EoR), and even to the
current epoch (where most of the neutral hydrogen is
conﬁned within galaxies). We focus in this study on the
21 cm signal from 6 < z < 20 – the end of the dark ages
through the EoR. This is the redshift range at which the
synchrotron foregrounds are smallest, and consequently
is the range most assessable for all planned 21 cm arrays.
There are three position-dependent quantities that imprint signatures on the 21 cm signal: the hydrogen density, the neutral fraction, and the spin temperature.
For cosmological parameter measurements, only the ﬁrst
quantity is of interest, and the last two are nuisances.
(For some astronomical questions, the situation is reversed.)
The 21 cm spin-ﬂip transition of neutral hydrogen can be observed in the form of either an absorption line or an emission line against the CMB blackbody
spectrum, depending on whether the spin temperature is
lower or higher than the CMB temperature.
During the epoch of reionization, the spin temperature
is likely coupled to the gas temperature through Lyα photons via the Wouthuysen-Field Eﬀect , and the gas
in the inter-galactic medium (IGM) has been heated by
X-ray photons to hundreds of Kelvin from the ﬁrst stars
 . If this is true, the 21cm signal will only depend on
the hydrogen density and the neutral fraction. However,
astrophysical uncertainties prevent a precise prediction
for exactly when the gas is heated to well above the CMB
temperature and is coupled to the spin temperature. In
this paper, we follow and focus entirely on the
regime when the spin temperature is much larger than
the CMB temperature , such that the observed
signal depends only on ﬂuctuations in density and/or the
neutral fraction. Speciﬁcally, we focus on the time interval from when this approximation becomes valid (around
the beginning of the reionization ) until most
hydrogen has become ionized, illustrated by the darkest
region in Figure 1. Despite this simpliﬁcation, the methods that we apply to model the ionization ﬂuctuations almost certainly can be applied to model spin temperature
ﬂuctuations with minimal additional free parameters.
In Table I, we list all the assumptions that aﬀect the
accuracy of cosmological parameter measurements, including ones about power modeling, cosmology, experimental design, and astrophysical foregrounds. For each
case, we provide three categories of assumptions: one
pessimistic (PESS), one middle-of-the-road (MID) and
one optimistic (OPT). Since we wish to span the entire
range of uncertainties, we have made both the PESS and
OPT models rather extreme. The MID model is intended
to be fairly realistic, but somewhat on the conservative
(pessimistic) side.
Before describing these assumptions in detail in the
next section, it is important to note that taken together,
they make a huge diﬀerence. Table II illustrates this by
showing the cosmological parameter constraints resulting from using all the OPT assumptions, all the MID
assumptions or all the PESS assumptions, respectively.
For example, combining CMB data from Planck and 21
cm data from FFTT, the 1σ uncertainty diﬀers by a factor of 125 for Ωk and by a factor of 61 for mν depending
on assumptions.
It is therefore important to sort out
which of the assumptions contribute the most to these
big discrepancies, and which assumptions do not matter
much. This is a key goal of our paper.
The rest of this paper is organized as follows. In Section II, we explain in detail the assumptions in the same
order as in Table I, and also present a new method for
modeling the ionization power spectra. In Section III,
we quantify how the cosmological parameter measurement accuracy depends on each assumption, and we derive simple analytic approximations of these relations. In
Section IV, we conclude with a discussion of the relative
importance of these assumptions, and implications for
experimental design.
FORECASTING METHODS &
ASSUMPTIONS
Fundamentals of 21cm cosmology
Power spectrum of 21 cm radiation
We review the basics of the 21 cm radiation temperature and power spectrum only brieﬂy here, and refer the
interested reader to for a more comprehensive discussion of the relevant physics. The diﬀerence between the
observed 21 cm brightness temperature at the redshifted
frequency ν and the CMB temperature TCMB is 
Tb(x) = 3c3hA10nH(x)[TS(x) −TCMB]
0TS(x)(1 + z)2(dv∥/dr) ,
where TS is the spin temperature, nH is the number
density of the neutral hydrogen gas, and A10 ≈2.85 ×
10−15s−1 is the spontaneous decay rate of 21cm transition. The factor dv∥/dr is the gradient of the physical velocity along the line of sight (r is the comoving distance),
which is H(z)/(1 + z) on average (i.e. for no peculiar velocity). Here H(z) is the Hubble parameter at redshift
z. The spatially averaged brightness temperature at redshift z is (in units of mK)
¯Tb ≈23.88¯xH
where ¯xH is the mean neutral fraction, and
averaged spin temperature. If TS ≫TCMB in the EoR,
the 21cm emission should therefore be observed at the
level of milli-Kelvins.
To calculate the ﬂuctuations, we rewrite Eq. (1) in
terms of δ (the hydrogen mass density ﬂuctuation), δx
(the ﬂuctuation in the ionized fraction), and the gradient of the peculiar velocity ∂vr/∂r along the line of sight,
using the fact that dv∥/dr = H(z)/(1 + z) + ∂vr/∂r:
Tb(x) = ˜Tb [1 −¯xi(1 + δx)] (1 + δ)
Here ¯xi ≡1−¯xH is the mean ionized fraction, and we have
deﬁned ˜Tb ≡¯Tb/¯xH × [ ¯
TS −TCMB)]. We write δv ≡
(Ha)−1∂vr/∂r. In Fourier space, it is straightforward to
show that, as long as δ ≪1 so that linear perturbation
theory is valid, δv(k) = −µ2δ, where µ = ˆk · ˆn is the
cosine of the angle between the Fourier vector k and the
line of sight. In this paper, we restrict our attention to
the linear regime. We will also throughout this paper
assume TS ≫TCMB during the EoR, making the last
factor in Eq. (3) unity for the reasons detailed in Section
In Fourier space, the power spectrum P∆T (k) of the
21cm ﬂuctuations is deﬁned by ⟨∆T ∗
b (k)∆Tb(k′)⟩≡
(2π)3δ3(k −k′)P∆T (k), where ∆Tb is the deviation from
the mean brightness temperature. It is straightforward
to show from Eq. (3) that, to leading order,
P∆T (k) = ˜T 2
HPδδ −2¯xHPxδ + Pxx]
HPδδ −¯xHPxδ] + µ4¯x2
Here Pxx = ¯x2
i Pδxδx and Pxδ = ¯xiPδxδ are the ionization
power spectrum and the density-ionization power spectrum respectively. For convenience, we deﬁne Pδδ(k) ≡
HPδδ(k), Pxδ(k) ≡
b ¯xHPxδ(k) and Pxx(k) ≡
b Pxx(k), so the total 21 cm power spectrum can be written as three terms with diﬀerent angular dependence:
P∆T (k) = Pµ0(k) + Pµ2(k)µ2 + Pµ4(k)µ4,
Pµ0 = Pδδ −2Pxδ + Pxx,
Pµ2 = 2(Pδδ −Pxδ),
Pµ4 = Pδδ.
Since Pµ4 involves only the matter power spectrum that
depends only on cosmology, Barkana and Loeb 
argued that in principle, one can separate cosmology
from astrophysical “contaminants” such as Pxx and Pxδ
whose physics is hitherto far from known. We will quantify the accuracy of this conservative approach (which
corresponds to our PESS scenario for ionization power
spectrum modeling below) in Section III.
From u to k
The power spectrum P∆T (k) and the comoving vector k (the Fourier dual of the comoving position vector
r) are not directly measured by 21cm experiments. An
experiment cannot directly determine which position vector r a signal is coming from, but instead which vector
Θ ≡θxˆex +θyˆey +∆fˆez it is coming from, where (θx, θy)
give the angular location on the sky plane, and ∆f is the
frequency diﬀerence from the central redshift of a z-bin.
For simplicity, we assume that the sky volume observed is
small enough that we can linearize the relation between
Θ and r. Speciﬁcally, we assume that the sky patch observed is much less than a radian across, so that we can
approximate the sky as ﬂat 1, and that separations in frequency near the mean redshift z∗are approximately proportional to separations in comoving distance. In these
approximations, if there are no peculiar velocities,
Here “⊥” denotes the vector component perpendicular
to the line of sight, i.e., in the (x, y)-plane, and dA is the
comoving angular diameter distance given by 
E(z) ≡H(z)
Ωm(1 + z)3 + Ωk(1 + z)2 + ΩΛ, (12)
is the relative cosmic expansion rate and the function
S(x) equals sin(x) if Ωk < 0, x if Ωk = 0, and sinh x if
Ωk > 0. The conversion factor between comoving distances intervals and frequency intervals is
y(z) = λ21(1 + z)2
1 The FFTT is designed for all-sky mapping (i.e. the ﬁeld of view
is of order 2π). However, since the angular scales from which we
get essentially all our cosmological information are much smaller
than a radian (with most information being on arcminute scales),
the ﬂat-sky approximation is accurate as long as the data is analyzed separately in many small patches and the constraints are
subsequently combined.
where λ21 ≈21 cm is the rest-frame wavelength of the
21 cm line.
We write the Fourier dual of Θ as u ≡uxˆex + uyˆey +
u∥ˆez (u∥has units of time). The relation between u and
k is therefore
In u-space, the power spectrum P∆T (u) of 21cm signals is
deﬁned by ⟨∆˜T ∗
b (u)∆˜Tb(u′)⟩= (2π)3δ(3)(u−u′)P∆T (u),
and is therefore related to P∆T (k) by
Ay P∆T (k) .
Note that cosmological parameters aﬀect P∆T (u) in
two ways: they both change P∆T (k) and alter the geometric projection from k-space to u-space. If dA and
y changed while P∆T (k) remained ﬁxed, the observable
power spectrum P∆T (u) would be dilated in both the
u⊥and u∥directions and rescaled in amplitude, while
retaining its shape. Since both dA and y depend on the
three parameters (Ωk, ΩΛ, h), and the Hubble parameter
is in turn given by the parameters in Table II via the
identity h =
Ωmh2/(1 −ΩΛ −Ωk), we see that these
geometric eﬀects provide information only about our parameters (Ωk, ΩΛ, Ωmh2). Baryon acoustic oscillations in
the power spectrum provide a powerful “standard ruler”,
and the equations above show that if one generalizes to
the dark energy to make ΩΛ an arbitrary function of z,
then the cosmic expansion history H(z) can be measured
separately at each redshift bin, as explored in .
21 cm tomography information on our other cosmological parameters (ns, As, Ωbh2, mν, α, etc.) thus comes
only from their direct eﬀect on P∆T (k). Also note that
(Ωk, ΩΛ) aﬀect P∆T (k) only by modulating the rate of
linear perturbation growth, so they alter only the amplitude and not the shape of P∆T (k).
If we were to use Eq. (16) to infer P∆T (k) from the
measured power spectrum P∆T (u) while assuming incorrect cosmological parameter values, then this geometric
scaling would cause the inferred P∆T (k) to be distorted
by the so-called Alcock-Paczy´nski (AP) eﬀect 
and not take the simple form of Eqns.(5)-(8). To avoid
this complication, we therefore perform our Fisher matrix
analysis directly in terms of P∆T (u), since this quantity
is directly measurable without any cosmological assumptions.
The above transformations between u-space and rspace are valid when there are no peculiar velocities. The
radial peculiar velocities vr that are present in the real
world induce the familiar redshift space distortions that
were discussed in Section II A 1, causing µ2 and µ4 power
spectrum anisotropies that were described there.
Assumptions about Pxx and Pxδ
During the EoR, ionized bubbles (HII regions) in the
IGM grow and eventually merge with one another. Consequently, Pxx(k) and Pxδ(k) contribute signiﬁcantly
to the total 21cm power spectrum.
The study of the
forms of these two ionization power spectra has made
rapid progress recently, particularly through the semianalytical calculations and radiative
transfer simulations . However, these models depend on theoretically presumed parameters whose values
cannot currently be calculated from ﬁrst principles. From
the experimental point of view, it is therefore important
to develop data analysis methods that depend only on
the most generic features of the ionization power spectra.
In this paper, we consider three methods — our
OPT, MID and PESS models — that model Pxx and
Pxδ as follows:
Pxx(k) = 0
Pxδ(k) = 0
Pxx(k) = b2
1 + αxx(k Rxx) + (k Rxx)2−γxx
Pxδ(k) = b2
−αxδ(k Rxδ) −(k Rxδ)2
Pxx(k) = arbitrary
Pxδ(k) = arbitrary
In the next three subsections, we explain these models in
It is likely that before reionization started (while ¯xH =
1 and Pxx = Pxδ = 0), hydrogen gas had already been
suﬃciently heated that TS ≫TCMB.
In this regime,
Eq. (17) holds. This OPT scenario is clearly the simplest model, since the total 21cm power spectrum is simply proportional to Pδδ: P∆T (k) = Pδδ(k)(1 + µ2)2. To
forecast the 1σ error, we use the Fisher matrix formalism
 . Repeating the derivation in , the Fisher matrix
for cosmological parameters λa (a = 1, . . . , Np) is
Z ∂ln P tot
 ∂ln P tot
where the integral is taken over the observed part of uspace, and P tot
∆T (u) denotes the combined power spectrum
from cosmological signal and all forms of noise.
VΘ = Ω× B is the volume of the Θ-space where Ωis the
solid angle within the ﬁeld of view (f.o.v.) and B is the
TABLE III: Fiducial values of ionization parameters adopted
for Figure 2. Rxx and Rxδ are in units of Mpc, while other
parameters are unitless.
frequency size of a z-bin. The Fisher matrix determines
the parameter errors as ∆λa =
For computational convenience, we subdivide u-space
into pixels so small that the power spectrum is roughly
constant in each one, obtaining
[δP∆T (u)]2
 ∂P∆T(u)
where the power spectrum measurement error in a pixel
δP∆T (u) = P tot
= P∆T (u) + PN(u⊥)
Here PN(u⊥) is the noise power spectrum and will be
discussed in detail in Section II G 3; note that it is independent of u∥and depends only on u⊥through the
baseline distribution of the antenna array.
Nc = 2πk2 sin θ∆k∆θ × Vol/(2π)3
is the number of independent cells in an annulus summing
over the azimuthal angle. We have the factor
δP∆T instead of the normal
2/Nc because we only sum
over half the sphere.
After reionization starts, both ionization power spectra
Pxx and Pxδ make signiﬁcant contribution to the total
21cm power spectrum. We explore two diﬀerent analysis
methods — our MID and PESS models — for separating
the cosmological signal from these astrophysical contaminants (i.e. Pxx and Pxδ).
Our MID model assumes that both ionization power
spectra Pxx(k) and Pxδ(k) are smooth functions of
k which can be parametrized by a small number of
nuisance parameters β1, . . . , βnion related to reionization
Combining these ionization parameters with
our cosmological ones λa into a larger parameter set pα
(α = 1, . . . , Np + nion), we can jointly constrain them by
measuring P∆T (u).
In Appendix A we will describe a χ2 goodness-of-ﬁt
test for quantifying whether this parametrization is valid.
The Fisher matrix for measuring pα is simply
[δP∆T (u)]2
This Fisher matrix Fαβ is not block diagonal, i.e., there
are correlations between the cosmological and ionization
parameters, reﬂecting the fact that both aﬀect Pxx(k)
and Pxδ(k). The inversion of the Fisher matrix therefore
leads to the degradation of the constraints of cosmological parameters. However, the total 21cm power spectrum
is usually smaller in magnitude in the MID model than in
the OPT model (see Eq. (4)), giving less sample variance.
This means that as long as noise in a 21cm experiment
dominates over sample variance, the MID model will give
weaker constraints than the OPT model, because of the
degeneracies. For future experiments with very low noise,
however, it is possible to have the opposite situation, if
the reduction in sample variance dominates over the increase in degeneracy. This does of course not mean that
the MID model is more optimistic than the OPT model,
merely that the OPT model is assuming an unrealistic
power spectrum.
Having set up the general formalism, we now propose a
parametrization speciﬁed by Eq. (18), with ﬁducial values of ionization parameters given in Table III.
parametrization was designed to match the results of
the radiative transfer simulations in Model I of , and
Figure 2 shows that the ﬁt is rather good in the range
k = 0.1 −2 Mpc−1 to which the 21cm experiments we
consider are most sensitive.
The radiative transfer simulations implemented in 
are post processed on top of a 10243 N-body simulation in
a box of size 186 Mpc. Three models for the reionization
history are considered in :
1. In Model I, all dark matter halos above mcool (corresponding to the minimum mass galaxy in which
the gas can cool by atomic transitions and form
stars, e.g. mcool ≈108 M⊙at z = 8) contribute
ionizing photons at a rate that is proportional to
their mass.
2. In Model II, the ionizing luminosity of the sources
scales as halo mass to the 5/3 power, i.e. more massive halos dominate the production of ionizing photons than in Model I.
parametrization as in Model I except for doubled
luminosity, minihalos with m > 105M⊙absorb incident ionizing photons out to their virial radius
unless they are photo-evaporated (but do not contribute ionizing photons).
It appears to be a generic feature in the simulation results that the ratios of functions at large k fall
oﬀlike a power law for Pxx(k)/Pδδ(k), and exponentially for Pxδ(k)/Pδδ(k). At small k, Pxx(k)/Pδδ(k)
can either increase or decrease approximately linearly
as k increases,
while Pxδ(k)/Pδδ(k) is asymptotically constant.
Our parametrization in Eq. (18) captures these features:
at large k, Pxx(k)/Pδδ(k) ∝
Pxδ(k)/Pδδ(k)
exp (−(k Rxδ)2);
small k, Pxx(k)/Pδδ(k) ∝(1 −(γxx αxxRxx/2) k), and
Fits to the ionization power spectra at several redshifts. Solid (blue) lines are the results of the radiative transfer
simulation in Model I of the McQuinn et al. paper . Dashed (green) lines are ﬁtting curves of our parametrization. Dotdashed (red) lines are best ﬁts using the parametrization suggested by Santos and Cooray . Top panels: Pxx/Pδδ =
HPδδ). Bottom panels: Pxδ/Pδδ = Pxδ/(¯xHPδδ). From left to right: z = 9.2, 8.0, 7.5, 7.0 (¯xi = 0.10, 0.30, 0.50, 0.70
respectively).
Pxδ(k)/Pδδ(k) ∝(1 −αxδ Rxδ k) (both αxx and αxδ
can be either positive or negative). Figure 2 also shows
that for Pxx(k) and also for Pxδ(k) at large k, our
parametrization further improves over the parametrization P(k)/Pδδ = b2e−(k R)2 suggested by Santos and
Cooray , which works well for Pxδ(k) at small k.
To be conservative, we discard cosmological information from Pxδ(k) and Pxx(k) in our Fisher matrix analysis by using the ﬁducial power spectrum Pδδ(k)(ﬁd)
rather than the actual one Pδδ(k) in Eq. (18).
means that the derivatives of Pxδ(k) and Pxx(k) with
respect to the cosmological parameters vanish in Eq. (24).
It is likely that we can do better in the future: once the
relation between the ionization power spectra and the
matter power spectrum can be reliably calculated either
analytically or numerically, the ionization power spectra
can contribute to further constraining cosmology.
In addition to the ﬁt of Model I shown in Figure 2,
we also ﬁt our model (with diﬀerent ﬁducial values from
those listed in Table III) to the simulations using Model II
and III in , and ﬁnd that the parametrization is ﬂexible enough to provide good ﬁts to all three simulations,
suggesting that the parametrization in Eq. (18) may be
generically valid and independent of models. Note, however, that at low redshifts (¯xi ≳0.7), our parametrization
of Pxδ/Pδδ does not work well at large k, in that the
simulation falls oﬀless rapidly than exponentially. This
may be because when HII regions dominate the IGM, the
ionized bubbles overlap in complicated patterns and correlate extremely non-linearly at small scales. This partial
incompatibility indicates that our parametrization (i.e.
Eq.18) is only accurate for small ¯xi, i.e. before non-linear
ionization patterns come into play.
In the remainder of this paper, we will adopt the values
in Table III as ﬁducial values of the ionization parameters.
PESS model
By parametrizing the ionization power spectra with
a small number of constants, the MID model rests on
our understanding of the physics of reionization. From
the point of view of a maximally cautious experimentalist, however, constraints on cosmological parameters
should not depend on how well one models reionization.
In this spirit, Barkana and Loeb proposed what
we adopt as our “PESS” model for separating the physics
Pδδ(k) from the “gastrophysics” Pxx(k) and Pxδ(k).
Instead of assuming a speciﬁc parametrization, the PESS
model makes no a priori assumptions about the ionization power spectra.
In each k-bin that contains more
than three pixels in u-space, one can in principle separate Pµ4(k) = Pδδ(k) from the other two moments. The
PESS model essentially only constrains cosmology from
the Pµ4 term and therefore loses all information in Pµ0
and Pµ2. We now set up the Fisher matrix formalism for
the PESS model that takes advantage of the anisotropy
in P∆T (k) arising from the velocity ﬁeld eﬀect. Numerical evaluations will be performed in Section III A.
The observable in 21cm tomography is the brightness
temperature Tb(x). In Fourier space, the covariance matrix between two pixels ki and kj is Cij = δij[P∆T (ki)+
PN(k⊥)], assuming that the measurements in two diﬀerent pixels are uncorrelated2. The total 21cm power spectrum is P∆T (k) = Pµ0(k) + Pµ2(k)µ2 + Pµ4(k)µ4. For
convenience, we use the shorthand notation PA, where
P1 ≡Pµ0, P2 ≡Pµ2 and P3 ≡Pµ4 and deﬁne the aA =
0, 2, 4 for A = 1, 2, 3, respectively. Thus the power spectrum can be rewritten as P∆T = P3
A=1 PAµaA. Treating PA(k) at each k-bin as parameters, the derivatives of
the covariance matrix are simply ∂Cij/∂PA(k) = δijµaA,
where |ki| resides in the shell of radius k with width ∆k.
Since the diﬀerent k-bins all decouple, the Fisher matrix
for measuring the moments PA(k) is simply a separate
3 × 3-matrix for each k-bin:
FAA′(k) = 1
upper half-shell
[δP∆T (k)]2 ,
where δP∆T (k)
[P∆T (k) + PN(k⊥)].
PN(k⊥) is related to PN(u⊥) by Eq. (16).
sum is over the upper half of the spherical shell k < |k| <
k+∆k. The 1σ error of P3 = Pµ4 is δP3(k) =
Once Pδδ = Pµ4 is separated from other moments, Pδδ
can be used to constrain cosmological parameters λa with
the Fisher matrix as given in Eq. (21).
We have hitherto discussed the anisotropy in P∆T (k)
that arises from the velocity ﬁeld eﬀect. However, the
AP-eﬀect may further contribute to the anisotropy in
that it creates a µ6-dependence and modiﬁes the µ4 term
The AP-eﬀect can be distinguished from the
velocity ﬁeld eﬀect since the Pµ6 term is unique to the
AP-eﬀect. Thus, one can constrain cosmological parameters from Pµ4 and Pµ6 , involving the inversion of a
4×4 matrix which loses even more information and therefore further weakens constraints. Therefore, the PESS
Fisher matrix that we have derived without taking APeﬀect into account can be viewed as an upper bound on
how well the PESS approach can do in terms of cosmological parameter constraints.
However, this maximally conservative 4 × 4 matrix approach may be inappropriately pessimistic, since the AP-induced clustering
2 We ignore here a δ-function centered at the origin since 21cm
experiments will not measure any k = 0 modes.
anisotropy is typically very small within the observationally allowed cosmological parameter range, whereas the
velocity-induced anisotropies can be of order unity.
Assumptions about Linearity
To avoid ﬁtting to modes where δk is non-linear and
physical modeling is less reliable, we impose a sharp cutoﬀat kmax and exclude all information for k > kmax.
We take kmax = 2 Mpc−1 for our MID model, and investigate the kmax-dependence of cosmological parameter
constraints in Section III B.
Assumptions about non-Gaussianity
Non-Gaussianity of ionization signals generically becomes important at high ¯xi. Using cosmic reionization
simulations with a large volume and high resolution, Lidz
et al. and Santos et al. found non-negligible (a
factor of 1.5) diﬀerences in the full power spectrum at
high ¯xi (¯xi ≳0.35)). To get a rough sense of the impact of
non-Gaussianity on cosmological parameter constraints,
we simply model it as increasing the sample variance by
a factor ξ. We thus write the total power spectrum as
δP∆T (u) = N −1/2
[ ξP∆T (u) + PN(u⊥)] ,
where ξ is the factor by which the the sample variance is
increased. The parameter ξ should take the value ξ ≈1
(Gaussian) at epochs with low ¯xi and 1 < ξ ≲2 (non-
Gaussian) at high ¯xi.
Assumptions about reionization history and
redshift range
21cm tomography can probe a wide range of redshifts,
as illustrated in Figure 1. However, one clearly cannot
simply measure a single power spectrum for the entire
volume, as the clustering evolves with cosmic time: The
matter power spectrum changes gradually due to the linear growth of perturbations . More importantly, the
ionization power spectra vary dramatically with redshift
through the epoch of reionization. We incorporate these
complications by performing our analysis separately in a
series of redshift slices, each chosen to be narrow enough
that the matter and ionization power spectra can be
approximated as constant in redshift within each slice.
This dictates that for a given assumed reionization history, thinner redshift slices must be used around redshifts
where ¯xH varies dramatically.
In this paper, we will consider two rather opposite toy
models in Section III:
• OPT: A sharp reionization that begins and ﬁnishes
at one redshift (say z ≲7).
TABLE IV: Speciﬁcations for 21cm interferometers
Experiment
baseline (m)
2 × π 2.42
397/656/1369
aWe assume that the eﬀective collecting area is proportional to
λ2 such that the sensitivity (Ae/Tsys in m2K−1) meets the design
speciﬁcation.
• MID/PESS: A gradual reionization that spans a
range of redshifts, assuming the ionization parameter values that ﬁt Model I simulation of the Mc-
Quinn et al. paper 
For the latter scenario, the ionization fraction ¯xH is not
a linear function of redshift. For example, in in the Mc-
Quinn et al. simulation, ¯xH =0.9, 0.7, 0.5 and 0.3
correspond to redshifts z = 9.2, 8.0, 7.5 and 7.0, respectively.
For our diﬀerent scenarios, we therefore adopt
the redshift ranges 6.8 < z < 10 that are divided into
four redshift slices centered at the above redshifts (OPT),
6.8 < z < 8.2 split into three bins centered at z=7.0, 7.5
and 8.0 (MID), 7.3 < z < 8.2 split into two slices centered
at z = 7.5 and 8.0.
Assumptions about cosmological parameter
Since the impact of the choice of cosmological parameter space and related degeneracies has been extensively
studied in the literature, we will perform only a basic
analysis of this here.
We work within the context of
standard inﬂationary cosmology with adiabatic perturbations, and parametrize cosmological models in terms
of 12 parameters (see, e.g. , Table 2 in for explicit
deﬁnitions) whose ﬁducial values are assumed as follows:
Ωk = 0 (spatial curvature), ΩΛ = 0.7 (dark energy density), Ωb = 0.046 (baryon density), h = 0.7 (Hubble parameter H0 ≡100h kms−1 Mpc−1), τ = 0.1 (reionization
optical depth), Ων = 0.0175 (massive neutrino density),
ns = 0.95 (scalar spectral index), As = 0.83 (scalar ﬂuctuation amplitude), r = 0 (tensor-to-scalar ratio), α = 0
(running of spectral index), nt = 0 (tensor spectral index) and w = −1 (dark energy equation of state). We will
frequently use the term “vanilla” to refer to the minimal
model space parametrized by (ΩΛ, Ωmh2, Ωbh2, ns, As, τ)
combined with ¯xH(z) and ionization parameters at all
observed z-bins, setting Ωk, Ωνh2, r, α, nt, and w ﬁxed at
their ﬁducial values.
Assumptions about Data
The MWA, LOFAR, SKA and FFTT instruments are
still in their planning/design/development stages.
this paper, we adopt the key design parameters from
 for MWA, and www.skatelescope.org for SKA,
www.lofar.org for LOFAR, and for FFTT unless explicitly stated.
Interferometers
We assume that MWA will have 500 correlated 4m×4m
antenna tiles, each with 16 dipoles. Each individual tile
will have an eﬀective collecting area of 14 m2 at z = 8 and
18 m2 at z ≳12. LOFAR will have 77 large (diameter
∼100 m ) stations, each with thousands of dipole antennae such that it has the collecting area nearly 50 times
larger than each antenna tile of MWA. Each station can
simultaneously image N regions in the sky. We set N = 2
in this paper but this number may be larger for the real
array. The design of SKA has not been ﬁnalized. We
assume the “smaller antennae” version of SKA, in which
SKA will have 7000 small antennae, much like MWA,
but each panel with much larger collecting area. FFTT
stands for Fast Fourier Transform Telescope, a future
square kilometer array optimized for 21 cm tomography
as described in . Unlike the other interferometers we
consider, which add in phase the dipoles in each panel
or station, FFTT correlates all of its dipoles, resulting
in more information. We evaluate the case where FFTT
contains a million 1m × 1m dipole antennae in a contiguous core subtending a square kilometer, providing a
ﬁeld-of-view of 2π steradians.
For all interferometers, we assume that the collecting area Ae ∝λ2, like a simple dipole, except that Ae
is saturated at z ∼12 in MWA since the wavelength
λ = 21(1 + z) cm exceeds the physical radius of an MWA
antenna panel. The summary of the detailed speciﬁcations adopted in this paper is listed in Table IV.
Conﬁguration
The planned conﬁgurations of the above-mentioned interferometers are quite varied. However, all involve some
combination of the following elements, which we will explore in our calculations:
1. A nucleus of radius R0 within which the area coverage fraction is close to 100%.
2. A core extending from radius R0 our to Rin where
there coverage density drops like some power law
3. An annulus extending from Rin to Rout where the
coverage density is low but rather uniform.
In its currently planned design, the MWA will have a
small nucleus, while the core density falls oﬀas r−2 until
a sharp cutoﬀat Rin. For LOFAR we assume 32 stations in the core, and another 32 stations in an outer
annulus out to radius Rout ∼6 km.
For SKA we assume 20% in the core, and 30% in the annulus out to
radius Rout ∼5 km. We ignore the measurements from
any dilute distribution of antenna panels outside Rout.
For LOFAR and SKA, we assume a uniform distribution of antennae in the annulus, but with an inner core
proﬁle like that of the MWA, i.e., a nucleus of radius
R0 = 285/189 m (LOFAR/SKA) and an r−2 fall-oﬀoutside this compact core. We assume an azimuthally symmetric distribution of baselines in all arrays.
For an array with Nin antennae within Rin, we can
deﬁne a quantity
where ρ0 is the area density of the nucleus. Rmax
maximal radius of the nucleus, corresponding to the case
where there it contains all the Nin antennae and there is
It is also convenient to parametrize the distribution
of these Nin antennae within Rin by two numbers: the
fraction η that are in the nucleus, and the fall-oﬀindex
n of the core. It is straightforward to show that R0 and
Rin are related to η and n by
R0 = √ηRmax
2 −n(1 −η)
if n ̸= 2.
The analytic relation for n = 2 is Rin =
R0 exp [(1 −η)/(2η)], which can be well approximated in
numerical calculation by by taking n = 2 + ǫ in Eq. (29)
with ǫ ∼10−10.
In Section III E, we will scan almost all possible design
conﬁgurations and ﬁnd the optimal one for constraining
cosmology. There are two independent ways to vary array
conﬁgurations, as illustrated by Figure 3: by varying R0
with Rin ﬁxed, and by varying Rin with R0 ﬁxed. Contributions from antennae in the annulus are negligible
compared to the core, so varying Rout is not interesting.
In other parts of Section III, we will assume the intermediate conﬁguration η = 0.8 and n = 2 (except
for FFTT which is purely in a giant core) with the
planned number of antennae in the core and annulus.
Note that this conﬁguration is optimized from the currently planned design.
FIG. 3: Examples of array conﬁguration changes. For MWA
(upper panels), antennae are uniformly distributed inside the
nucleus radius R0, and the density ρ falls oﬀlike a power
law for R0 < r < Rin where Rin is the core radius.
SKA (lower panels) and similarly for LOFAR, there is in addition a uniform yet dilute distribution of antennae in the
annulus Rin < r < Rout, where Rout is the outer annulus
When R0 is decreased (R0 = 0.7/0.5/0.3 × Rmax
with Rin = 3.0 × Rmax
ﬁxed (left panels), the density in the
core falls oﬀslower (blue/red/green curves). When Rin is decreased (Rin = 4.0/3.0/2.0 × Rmax
) with R0 = 0.5 × Rmax
ﬁxed (right panels), the density in the core also falls oﬀless
steep (dashed/solid/dotted curves).
Detector noise
21cm radio interferometers measure visibility V. The
visibility for a pair of antennae is deﬁned as 
V(ux, uy, ∆f) =
dxdy∆Tb(x, y, ∆f)e−i(uxx+uyy) ,
where (ux, uy) are the number of wavelengths between the antennae.
The hydrogen 3D map is the
Fourier transform in the frequency direction ˜I(u) ≡
R d∆fV(ux, uy, ∆f) exp (−i∆fu∥) where u = uxˆex +
uyˆey + u∥ˆez. The detector noise covariance matrix for
an interferometer is 
CN(ui, uj) =
where B is the frequency bin size, Tsys is system temperature, and tu ≈(Aet0/λ2)n(u⊥) is the observation time
for the visibility at |u⊥| = dA|k| sin θ. Here t0 is the total
observation time, and n is the number of baselines in an
observing cell.
The covariance matrix of the 21cm signal ˜I(u) is related to the power spectrum P∆T (k) by 
CSV (ui, uj) ≡⟨˜I∗(ui)˜I(uj)⟩
= P∆T (ui)λ2B
Therefore, the noise in the power spectrum is
For all interferometers, the system temperature is dominated by sky temperature Tsky ≈60(λ/1 m)2.55 K due
to synchrotron radiation in reasonably clean parts of the
sky. Following , we set Tsys = 440 K at z = 8 and
Tsys = 690 K at z = 10.
Assumptions about Residual Foregrounds
There have been a number of papers discussing foreground removal for 21 cm tomography (e.g. and references therein), and much work remains to
be done on this important subject, as the the amplitudes of residual foregrounds depend strongly depends
on cleaning techniques and assumptions, and can have
potentially dominate the cosmological signal. The work
of Wang et al. and McQuinn et al. suggested
that after ﬁtting out a low-order polynomial from the
frequency dependence in each pixel, the residual foregrounds were negligible for k > 2π/yB where yB is the
comoving width of a z-bin. To obtain a crude indication of the impact of residual foregrounds, there therefore we adopt the rough approximation that all data below some cutoﬀvalue kmin is destroyed by foregrounds
while the remainder has negligible contamination. We
choose kmin = (1/2/4) × π/yB for the OPT/MID/PESS
scenarios, and also explore wider ranges below.
RESULTS AND DISCUSSION
In this section, we numerically evaluate how the accuracy of cosmological parameter constraints depend on
the various assumptions listed above. Where possible,
we attempt to provide intuition for these dependences
with simple analytical approximations. In most cases,
we explore the dependence on one assumption at a time
by evaluating the PESS, MID and OPT scenario for this
assumption while keeping all other assumptions ﬁxed to
the baseline MID scenario.
Varying ionization power spectrum modeling
and reionization histories
Basic results
We start by testing assumptions in the ionization
power modeling of Pxx and Pxδ.
In Table V we show
the accuracy with which the 21cm power spectrum can
place constraints on the cosmological parameters from
three z-bins ranging from z = 6.8 −8.2. We ﬁx the assumptions concerning kmax, the foreground removal, and
the array layout and speciﬁcations, but vary the sophistication with which we model the ionization power.
Our results agree with those of previous studies
i.e. 21cm data alone (except for the optimized FFTT) cannot place constraints comparable with
those from Planck CMB data.
However, if 21cm
data are combined with CMB data, the parameter
degeneracies can be broken, yielding stringent constraints on Ωk, mν
For example, in the
OPT model, from LOFAR/MWA/SKA/FFTT combined
with Planck, the curvature density Ωk can be measured 5/3/15/78 times better, to a precision ∆Ωk =
0.005/0.008/0.002/0.0003, the neutrino mass mν can be
constrained 4/9/14/74 times better to accuracy ∆mν =
0.06/0.03/0.02/0.003, and running of the scalar spectral index α can be done 1/2/4/28 times better, to
∆α = 0.002/0.001/0.0006/0.0001.
The more realistic
MID model yields weaker yet still impressive constraints:
from SKA/FFTT combined with Planck, Ωk can be measured 6/109 times better, to ∆Ωk = 0.004/0.0002, mν
4/35 times better, to ∆mν = 0.06/0.007, and α 1/15
times better, to ∆α = 0.002/0.0002. The improved measurements of Ωk and α enable further precision tests
of inﬂation, since generically Ωk is predicted to vanish down to the 10−5 level, while the simplest inﬂation
models (with a single slow-rolling scalar ﬁeld) predict
α ∼(1 −ns)2 ∼10−3. For example, the inﬂaton potential V (φ) ∝φ2 predicts α ≈−0.0007, while V (φ) ∝φ4
predicts α = 0.008. In addition, 21cm data combined
with CMB data from Planck can make accurate measurements in the mean neutral fraction ¯xH(z) at separate
redshifts, outlining the full path of reionization, e.g. at
the ∆¯xH(z) ∼0.01/0.003 level from SKA/FFTT data
combined with Planck data.
OPT and MID models
For most 21cm experiments, the OPT model yields
stronger constraints than the MID model. The reason
is as follows.
By assuming Pxx = Pxδ = 0, there are
essentially no neutral fraction ﬂuctuations in the OPT
This means that this model is an ideal model
in which the 21cm power spectrum encodes cosmological
information per se, since P∆T (k) ∝Pδδ(k) at each pixel
in the Fourier space. In the more realistic MID model,
however, the nuisance ionization parameters has correla-
TABLE V: How cosmological constraints depend on the ionization power spectrum modeling and reionization history. We
assume observations of 4000 hours on two places in the sky in the range of z = 6.8 −8.2 that is divided into three z-bins
centered at z = 7.0, 7.5 and 8.0 respectively, kmax = 2Mpc−1, kmin = 2π/yB and a quasi-giant core conﬁguration (except for
FFTT that is a giant core). 1σ errors of ionization parameters in the MID model, marginalized over other vanilla parameters,
are listed separately in Table VI.
Vanilla Alone
∆ln(Ωmh2) ∆ln(Ωbh2)
∆¯xH(7.0) a ∆¯xH(7.5) ∆¯xH(8.0)
0.00036 0.0013
0.0088 0.0043
0.0088 0.0043
+LOFAR MID
0.0088 0.0043
0.0088 0.0043
0.0088 0.0043
0.0087 0.0043
0.0088 0.0043
0.0087 0.0042
0.0087 0.0043
0.0088 0.0043
0.00021 0.0087 0.0042
0.00033 0.0086 0.0042
0.0087 0.0043
a¯xH(z) denotes the mean neutral fraction at the central redshift
z. ¯xH(z)’s and As are completely degenerate from the 21cm measurement alone. For this reason, the errors shown for ln As from
21cm data alone is really not marginalized over ¯xH(z)’s.
TABLE VI: 1σ marginalized errors for the ionization parameters in the MID model.
Assumptions are made the same
as in Table V. Rxx and Rxδ are in units of Mpc and other
parameters are unitless.
0.030 0.0023 0.0021
0.0026 0.017 0.0013 0.0014 0.0030
tions with cosmological parameters. Mathematically, the
inversion of a correlated matrix multiplies each error by
a degradation factor.
An exception is the FFTT, where the situation is reversed. As mentioned in Section II B 2, the sample variance P∆T in the MID model is smaller than that in the
OPT model because of two reasons: (i) the MID model
assumes non-zero Pxx and Pxδ, and Pxδ has negative contribution to the total power spectrum (see Eqs.6 and 7);
(ii) the OPT model assumes ¯xH = 1, but ¯xH takes realistic values (less than 1) in the MID model, decreasing the
overall amplitude. In a signal-dominated experiment, reduced sample variance can be more important than the
degradation from correlations.
PESS model
Our results show that even combined with CMB data
from Planck, the 21cm data using the PESS model cannot signiﬁcantly improve constraints. There are two reasons for this failure. Firstly, the PESS model essentially
uses only Pµ4(k) to constrain cosmology, by marginalizing over Pµ0 and Pµ2. This loses a great deal of cosmological information in the contaminated Pµ0 and Pµ2, in
contrast to the situation in the OPT and MID models.
Secondly, to eﬀectively separate Pµ4(k) from other two
moments, the available Fourier pixels should span a large
range in µ. Figure 4 shows that in MWA and FFTT, the
data set is a thin cylinder instead of a sphere. The limitation in µ-range will give large degradation factors during
the inversion of Fisher matrix. (In the limit that there is
FIG. 4: Available (k⊥, k∥) pixels from MWA (upper left),
FFTT (upper right), LOFAR (lower left) and SKA (lower
right), evaluated at z = 8.
The blue/grey regions can be
measured with good signal-to-noise from the nucleus and core
of an array, while the cyan/light-grey regions are measured
only with the annulus and have so poor signal-to-noise that
they hardly contribute to cosmological parameter constraints.
only one µ for each shell, then the Fisher matrix is singular and the degradation factor is inﬁnite.) These two
factors work together with the noise level to shrink the
useful k-modes into a rather narrow range: as shown in
Figure 5, ∆Pδδ < Pδδ only for k = 0.09 −0.4 Mpc−1 in
SKA, k = 0.07 −1 Mpc−1 in FFTT and over zero modes
in LOFAR and MWA.
Varying kmax
We test how varying kmax aﬀects constraints in this
section. The cutoﬀkmax depends on the scale at which
non-linear physics, e.g. the non-linear clustering of density perturbations or the irregularities of ionized bubbles, enter the power spectrum.
It is illustrated in
the right panel of Figure 6 that generically cosmological constraints asymptotically approach a value as kmax
increases above ∼2 Mpc−1 (this typical scale can be
larger for cosmic variance limited experiments such as
FFTT). Not much cosmological information is garnered
from these high-k modes because detector noise becomes
increasingly important with k. The upshot is that the
accuracy only weakly depends on kmax.
Relative 1σ error for measuring Pδδ(k) with the
PESS model by observing a 6MHz band that is centered at
z = 8 with MWA (red/solid), LOFAR (blue/short-dashed),
SKA (green/dotted) and FFTT (cyan/long-dashed).
step size is ∆ln k ≈0.10.
Varying the non-Gaussianity parameter ξ
Table II shows the eﬀect of changing the non-
Gaussianity parameter ξ in Section II D from the ξ = 1
(Gaussian) case to ξ = 2 in the PESS scenario, along
with changing other assumptions. However, there is no
need to perform extensive numerical investigation of the
the impact of ξ, since it is readily estimated analytically. Because 1σ error ∆pi in cosmological parameters
(F −1)ii, it follows directly from Eq. 26 that ∆p does
not appreciably depend on ξ for noise dominated experiments like MWA and LOFAR, whereas ∆p ∝ξσ with
σ ≲1 for (nearly) signal dominated experiments like
SKA and FFTT. Compared with the other eﬀects that we
discuss in this section, this (no more than linear) dependence on the non-Gaussianity parameter ξ is not among
the most important factors.
Varying redshift ranges
We now test how accuracies depend on the redshift
In Table VII (OPT model) and VIII (MID
model), we consider the optimistic/middle/pessimistic
ranges, z = 6.8−10 / 6.8−8.2 / 7.3−8.2 which is divided
by nz = 4/3/2 z-bins. The results show that, from 21cm
data alone, the constraints from the extreme ranges differ signiﬁcantly (a factor of 5 for ∆Ωk). Therefore, the
TABLE VII: How cosmological constraints depend on the redshift range in OPT model. Same assumptions as in Table V but
for diﬀerent redshift ranges and assume only OPT model.
Vanilla Alone
∆ln(Ωmh2) ∆ln(Ωbh2)
∆¯xH(7.0) ∆¯xH(7.5) ∆¯xH(8.0) ∆¯xH(9.2)
0.0088 0.0043
0.0088 0.0043
+LOFAR 6.8-8.2
0.0088 0.0043
0.0088 0.0043
0.0088 0.0043
0.0088 0.0043
0.0088 0.0043
0.0087 0.0042
0.0087 0.0042
0.0087 0.0042
0.00019 0.0087 0.0042
0.00021 0.0087 0.0042
0.00023 0.0087 0.0042
TABLE VIII: How cosmological constraints depend on the redshift range in MID model. Same assumptions as in Table V but
for diﬀerent redshift ranges and assume only MID model.
Vanilla Alone
∆ln(Ωmh2) ∆ln(Ωbh2)
∆¯xH(7.0) ∆¯xH(7.5) ∆¯xH(8.0) ∆¯xH(9.2)
0.00025 0.00097
+LOFAR 6.8-8.2
sensitivity of a 21cm telescope depends strongly on the
frequency range over which it can observe the signal.
Optimal conﬁguration: varying array layout
In this section we ﬁrst investigate how array layout affects the sensitivity to cosmological parameters. Next,
we investigate the optimal array conﬁguration for ﬁxed
antennae number. Our parametrization of the array con-
ﬁguration is discussed in Section II G 2.
We map the constraint in mν on the R0–Rin plane in
Figure 7 (OPT model) and Figure 8 (MID model). R0
is the radius of the compact core, and Rin the radius
of inner core, both in the unit of Rmax
Note that if R0 = Rmax
, then Rin = Rmax
— this is the
case of a “giant core”, in which all antennae are compactly laid down with a physical covering fraction close
to unity, and is represented by the x-axis in the R0–Rin
plane (the value of R0 is meaningless if Rin = Rmax
TABLE IX: Optimal conﬁguration for various 21cm interferometer arrays. Same assumptions as in Table V but for diﬀerent
array layout. Rprop
is the previously proposed inner core radius. η is the ratio of the number of antennae in the nucleus to the
total number inside the core. n is the fall-oﬀindex by which ρ ∝r−n outside the nucleus.
Experiment
Rin (×Rmax
Almost a giant core
Close to a giant core
Almost a giant core
Almost a giant core
Both a large nucleus and a wide-spread core
Almost a giant core
aNote that in LOFAR and SKA there is an annulus with the outer
radius 6 km and 5 km respectively. So for them Rin is not the size
of total array.
FIG. 6: How cosmological constraints ∆ns depend on kmin
(left panel) and kmax (right panel) in the MID model with
the 21cm experiments MWA (red/solid), LOFAR (blue/shortdashed), SKA (green/dotted) and FFTT (cyan/long-dashed).
We plot ∆ns in this example because it has the strongest
dependence on kmin and kmax of all cosmological parameters.
The quantity 2π/yB varies in redshift, so as the horizontal
axis of the left panel, we use the overall scale κmin ≡kmin ×
(yB/2π) which is equal for all z-bins,
Table IX, we list the optimal conﬁguration that is indicated by Figure 7 and 8. The compactness of an array is
represented by Rin/Rmax
, since Rmax
is the minimum of
Rin. In comparison, R0/Rmax
does not indicate the compactness, since a slow fall-oﬀconﬁguration with a small
R0 is eﬀectively very close to a giant core. Rather, R0 is
a transition point from a ﬂat compact core to the fall-oﬀ
region. Note that we have three conﬁguration parameters R0, Rin and Rout. We ﬁnd the annulus for SKA and
LOFAR to make almost no diﬀerence to the cosmological
constraints, and therefore focus on how to optimize only
the remaining two parameters R0 and Rin.
Table IX shows that the optimal layout for OPT model
is close to a giant core, with the inner core much smaller
than the previously proposed.
For MID model, LO-
FAR and SKA still favors the quasi-giant-core layout,
but MWA favors a large core whose radius is about the
size that was previously proposed. The accuracies in mν
varies in the OPT model by a factor of 3 for LOFAR,
1.4-1.5 for MWA and SKA, and in the MID model by a
factor of 3 for LOFAR, 1.3 for MWA and 2.2 for SKA.
This means that an optimal conﬁguration can improve
the constraints by a factor up to 3 in noise dominated
experiments, and up to 2 in signal dominated experiments.
The plots have three interesting features. First, the
conﬁguration of a quasi-giant core is generically favored.
The reason for this is that the noise on the temperature in an observing cell with u⊥is inversely proportional to the square root of the number of baselines that
probe this u⊥. A compact array increases the number
of baselines that probe small u⊥, reducing the overall
noise level on these modes. Second, a couple of the upcoming 21 cm experiments favor the conﬁguration that
is close but not identical to a giant core.
The reason
for this is because arrays become sample variance limited once they have a certain number of baselines that
probe a given u⊥. A simple estimate on the signal-tonoise ratio for a compact MWA shows that on average
Pδδ/ ¯PN ≈5 at the k ∼0.1 Mpc−1 and Pδδ/ ¯PN ≈1/40
at the k ∼0.7 Mpc−1. Although moving more antennae
to the center can increase the signal-to-noise, the error
cannot be reduced as much if modes are already dominated by signal. Third, in the MID model, MWA favors
a less compact core. This fact is due to the mixing between cosmological and ionization parameters. Remember that the oﬀ-diagonal elements in the Fisher matrix
are proportional to the magnitude of ionization power
spectra — the smaller the magnitude, the smaller degradation factor and the more accurate is the cosmological
parameter measurement.
Figure 2 illustrates that the
ionization power spectrum generically falls oﬀat large k
such that a relatively large core, which is more sensitive
1σ error for mν marginalized over vanilla parameters for various conﬁguration (R0, Rin) of LOFAR(left panel),
MWA(middle panel) and SKA(right panel). We made the same assumptions here as in Table V but assume only OPT model.
FIG. 8: Same as Figure 7 but for MID model. Figures are for LOFAR(left panel), MWA(middle panel) and SKA(right panel).
to these large k, may actually improve parameter constraints. This factor appears to be important for MWA
because, as Figure 4 shows, a compactiﬁed MWA only
occupies a rather narrow band in k-space. This means
that MWA has to expand signiﬁcantly in order to use
much more large k modes.
It came to our attention that Lidz et al. performed
an analysis of the optimal conﬁguration for MWA. Lidz
et al. concludes that the optimal layout for MWA
is a giant core. This conclusion is slight diﬀerent than
ours; we ﬁnd a compact but not exactly a giant core is
optimal for MWA. The work in deﬁnes the optimal
conﬁguration to be the conﬁguration that maximizes the
total signal-to-noise, while our deﬁnition is based on parameter constraints. In addition, the conclusion in 
is based on the comparison of a giant core array conﬁguration to one without a giant core, while we investigate
a range of plausible conﬁgurations. It should be pointed
out that both approaches should be tested with detailed
simulations.
Varying collecting area
The survey volume and the noise per pixel are both
aﬀected by changing the collecting area Ae because
the solid angle a survey observes is Ω≈λ2/Ae and
e (Eq. (33)).
For noise-dominated experiments, δP∆T /P∆T ∝P N/√Nc ∝A−2
and, for signal-dominated experiments, δP∆T /P∆T ∝
1/√Nc ∝A1/2
If we parametrize the scaling of the
error on a cosmological parameter as ∆p ∝(Ae)β, we
have −1.5 < β < 0.5.
A caveat is FFTT which has
ﬁxed Ω= 2π, so δP∆T /P∆T ∝A0
e (signal dominated) or
δP∆T /P∆T ∝1/A2
e (noise dominated). Since FFTT is
nearly signal dominated, β ≲0 for FFTT.
We show how collecting area aﬀects the accuracy in Table X (OPT model) and XI (MID model). In the OPT
model, it appears that β ≈−0.4 for LOFAR, |β| ≲0.2
for MWA, |β| ≲0.3 for SKA, and β ∼−0.1 for FFTT.
In the MID model, it appears that β ∼−1.3 for LOFAR,
β ∼−0.5 for MWA, β ∼−0.6 for SKA, β ∼−0.3 for
FFTT. These exponents are compatible with the above
arguments. The upshot is that varying Ae does not sig-
TABLE X: How cosmological constraints depend on collecting
areas in the OPT model. Same assumptions as in Table V but
for diﬀerent collecting areas Ae and assume only OPT model.
The exponent β tells the rule of thumb of the Ae-dependence
of marginalized errors ∆p, assuming ∆p ∝(Ae)β.
∆ln(Ωmh2) ∆ln(Ωbh2)
refers to the ﬁducial values assumed in Table IV and are not
the same for diﬀerent arrays.
TABLE XI: How cosmological constraints depend on collecting areas in the MID model. Same assumptions as in Table
V but for diﬀerent collecting areas Ae and assume only MID
model. The exponent β tells the rule of thumb of the Aedependence of marginalized errors ∆p, assuming ∆p ∝(Ae)β.
∆ln(Ωmh2) ∆ln(Ωbh2)
0.00032 0.0012
0.00036 0.0013
0.00046 0.0016
niﬁcantly aﬀect parameter constraints.
Varying observation time and system
temperature
The detector noise is aﬀected by changing the observation time and system temperature. From Eq. (33), the
noise P N ∝T 2
sys/t0. Therefore, for noise dominated experiments, δP∆T /P∆T ∝P N/√Nc ∝T 2
sys/t0, and for
signal dominated experiments, δP∆T /P∆T ∝1/√Nc ∝
sys/t0)0. Assuming that errors in cosmological param-
TABLE XII: How cosmological constraints depend on observation time in the OPT model. Same assumptions as in Table V but for diﬀerent observation time t0 and assume only
OPT model. The exponent ǫ tells the rule of thumb of the t0dependence of marginalized errors ∆p, assuming ∆p ∝(t0)−ǫ.
t0 is in units of 4000 hours.
∆ln(Ωmh2) ∆ln(Ωbh2)
TABLE XIII: How cosmological constraints depend on observation time in the MID model. Same assumptions as in
Table V but for diﬀerent observation time t0 and assume only
MID model. The exponent ǫ tells the rule of thumb of the t0dependence of marginalized errors ∆p, assuming ∆p ∝(t0)−ǫ.
t0 is in units of 4000 hours.
∆ln(Ωmh2) ∆ln(Ωbh2)
0.00032 0.0012
0.00036 0.0013
0.00046 0.0016
eter ∆p ∝(T 2
sys/t0)ǫ, we have 0 < ǫ < 1.
sys and t−1
shares the same exponent, we evaluate the ǫ by varying only t0 in Table XII (OPT model)
and XIII (MID model). It appears that in average ǫ ∼0.5
for LOFAR, ǫ ∼0.3 for MWA, ǫ ∼0.3 for SKA, ǫ < 0.1
for FFTT in the OPT model, and ǫ ∼0.8 for LOFAR,
ǫ ∼0.5 for MWA, ǫ ∼0.4 for SKA, ǫ ≲0.1 for FFTT
in the MID model. These exponents are compatible with
the expected 0 < ǫ < 1 from the above argument. The
upshot is that the order unity changes in Tsys and t0
play a marginal role in the accuracy for future signaldominated experiments.
Varying foreground cutoﬀscale kmin
Finally, we test how accuracy is aﬀected by varying
kmin above which foregrounds can be cleaned from the
signal. One expect that the constraints tend to approach
asymptotic values at small enough kmin. However, the
most eﬀectively constrained modes are at small k (k ∼
0.1 Mpc−1) for noise dominated experiments, while the
contributions from larger k modes are more important for
cosmic variance limited experiments. This means that
kmin aﬀects the noise dominated experiments most. Left
panel of Figure 6 illustrates this by plotting cosmological
constraints as a function of the relative minimum cutoﬀ
κmin ≡kmin × y(z)B(z)/2π which is a constant scale
factor for all z-bins by deﬁnition. The slopes at κmin = 1
are rather large for MWA (varying from κmin = 0.5 to 2,
the error in ns varies from 0.032 to 0.39, about 10 times
For a signal dominated experiment like SKA,
the constraints can be oﬀby a factor of 3, or FFTT by a
factor of 1.6. This suggests that in general kmin is among
top factors to aﬀect cosmological constraints.
CONCLUSION & OUTLOOK
Which assumptions matter most?
And All PESS
(Planck+FFTT)
(Planck+SKA)
FIG. 9: Cartoon showing how cosmological parameter measurement accuracy depends on various assumptions.
cases labeled merely “PESS” or “OPT” have the PESS/OPT
ionization power spectrum modeling with MID assumptions
for everything else.
In Section III, we have quantiﬁed how cosmological
parameter measurement accuracy depends on assumptions about ionization power modeling, reionization history, redshift range, experimental speciﬁcations such as
the array conﬁguration, and astrophysical foregrounds.
We now return to the overarching question from Section I that motivated our study: among these assumptions, which make the most and least diﬀerence?
To quantify this, we consider two of the parameters
for which 21cm tomography has the most potential for
improving on Planck CMB constraints based on our estimates: Ωk and mν.
Figure 9 shows ∆Ωk based on
data from Planck plus SKA as well as ∆mν from Planck
plus FFTT. Varying the ionization power modeling from
PESS to OPT models improves the constraints on these
two parameters by a factor of 6–15.
From 21cm data
alone in the OPT model, the optimal array conﬁguration
can aﬀect accuracies up to a factor 3 (Figure 7), redshift
ranges aﬀect it by up to a factor of 5 (Table VII), and
residual foregrounds aﬀect it by up to a factor of 10 (Figure 6, left panel). In summary, the assumptions can be
crudely ordered by importance as ionization power modeling ≫foregrounds ∼redshift ranges ∼array layout
> Ae ∼Tsys ∼t0 ∼kmax ∼non-Gaussianity.
We have investigated how the measurement of cosmological parameters from 21 cm tomography depends on
various assumptions. We have found that the assumptions about how well the reionization process can be
modeled are the most important, followed by the assumptions pertaining to array layout, IGM evolution, and foreground removal.
Our results motivate further theoretical and experimental work.
On the theoretical side, it will be valuable to develop improved EoR data analysis techniques.
The OPT approach is restricted to when neutral fraction
ﬂuctuations are not important, which is not an accurate
approximation during the EOR. On the other hand, although the PESS approach is in principle insensitive to
our poor understanding of reionization by marginalizing
over it, in practice this approach destroys too large a fraction of the cosmological information to be useful. Hopefully more detailed EoR simulations will enable our MID
approach to be further improved into a phenomenological
parametrization of our ignorance that is robust enough
to be reliable, yet minimizes the loss of cosmological information. 3
On the experimental side, there are numerous complications that are beyond the scope of this paper, but that
are important enough to deserve detailed investigation in
future work. To what extent can radio-frequency interference be mitigated, and to what extent does it degrade
cosmological parameter accuracy?
This is particularly
important for instruments in densely populated parts of
the world, such as LOFAR. To what extent is the subtraction of the foreground point sources hampered by the
complicated oﬀ-center frequency scaling of the synthesized beam? To what extent does the dramatic variation
of the synchrotron brightness temperature across the sky
aﬀect our results and optimal array design? Performing
a realistic end-to-end simulation of possible experiments
(from sky signal to volts and back) should be able to
settle all of these issues.
These are diﬃcult questions, but worthwhile because
the potential for probing fundamental physics with 21
cm tomography is impressive: a future square kilometer
It is also possible to constrain cosmological parameters using
lensing of 21cm ﬂuctuations .
array optimized for 21 cm tomography could improve the
sensitivity of the Planck CMB satellite to spatial curvature and neutrino masses by up to two orders of magnitude, to ∆Ωk ≈0.0002 and ∆mν ≈0.007 eV, and detect
at 4σ the running of the spectral index predicted by the
simplest inﬂation models.
Acknowledgments
The authors wish to thank Judd Bowman, Jacqueline Hewitt and Miguel Morales for helpful discussions
and comments.
YM thanks Yi Zheng for technical
help. This work is supported by the U.S. Department of
Energy (D.O.E.) under cooperative research agreement
DE-FC02-94ER40818, NASA grants NAG5-11099 and
NNG06GC55G, NSF grants AST-0134999 and 0607597,
and from the David and Lucile Packard Foundation and
the Research Corporation.
OZ was supported by the
Berkeley Center for Cosmological Physics.
APPENDIX A: χ2 GOODNESS OF FIT IN THE
In this appendix, we elucidate some issues in separating cosmological information from astrophysics in the
MID model, and give the χ2 goodness-of-ﬁt test.
The parametrization of ionization power spectra is
based on the assumption that these power spectra are
smooth functions of k, and therefore can be parametrized
with as many parameters as necessary to ﬁt the data at
some accuracy.
However, the separation of cosmology
from astrophysics implicitly depends on another assumption that the shapes of ionization power spectra are distinguishable from that of matter power spectrum, since
one can only measure the total 21cm power spectrum.
Albeit sometimes the shape may be similar at small k
(see the plateaus in the ratios of power spectra in Figure
2), the slope and amplitude of ionization power spectrum
at the fall-oﬀregion can in principle distinguish nuisance
functions from the matter power spectrum, determine the
overall amplitude, and in return use the data at small k
to further constrain the nuisance parameters that correspond to the amplitudes.
An avalanche of data from upcoming 21cm experiments can make it possible to justify the MID model with
some parametrization of ionization power spectra. There
are standard statistical methods for testing whether the
parametrization is successful. We now give a compact
description of the χ2 goodness-of-ﬁt test, and refer interested readers to for a useful review on the statistics.
Note that we did not implement the χ2 test in this paper
since this would need observational data. The description
of χ2 test below is intended to complement the discussions of the MID model in the main part of this paper.
We want to test the hypothesis H0 that the parametrization with ﬁtting parameter values is an accurate account
of the ionization power spectra. The parameter vector to
be ﬁtted is Θ ≡(λi (i = 1, . . . , Np), βα (α = 1, . . . , nion)),
where Np and nion are the number of cosmological and
ionization parameters, respectively. The observed data
vector is y ≡(y1, . . . , yN) where yi ≡P∆T (ki) at each
pixel ki labeled by i = 1, . . . , N, where N is the total number of pixels.
Assuming the Gaussian statistic in the measurements, the corresponding vector F
for the expected value is F(ki; Θ) = (Pδδ −2Pxδ +
Pxx) + 2(Pδδ −Pxδ)µ2 + Pδδµ4, and the variance is
i ≡(δP∆T (ki))2 =
Nc [P∆T (ki) + PN(ki ⊥)]2. We can
now compute χ2:
χ2(Θ) = (y −F(Θ))T C−1(y −F(Θ)) ,
where C is the covariance matrix. If each measurement yi
is independent, then C becomes diagonal with Cii = σ2
Then Eq. (A1) is simpliﬁed to be
[yi −F(ki; Θ)]2
We can deﬁne the p-value as the probability, under the
assumption of the hypothesis H0, of obtaining data at
least as incompatible with H0 as the data actually observed. So
f(z; nd)dz ,
where f(z; nd) is the χ2 probability density function
(p.d.f.) with nd degrees of freedom nd = N −(Np +nion).
Values of the χ2 p.d.f. can be obtained from the CERN-
LIB routine PROB . To set the criterion, a ﬁt is good
if p ≥0.95, i.e. the real data ﬁt the parametrization better than the 95% conﬁdence level.
 J. D. Bowman, M. F. Morales and J. N. Hewitt, Astrophys. J. 661, 1 
 M. McQuinn,O. Zahn, M. Zaldarriaga, L. Hernquist and
S. R. Furlanetto, Astrophys. J. 653, 815 
 M. G. Santos and A. Cooray, Phys. Rev. D74,083517
 S. Wyithe, A. Loeb and P. Geil, arXiv:0709.2955 [astroph] 
 X. C. Mao and X. P. Wu, arXiv:0709.3871 [astro-ph]
 T. C. Chang, U. L. Pen, J. B. Peterson and P. McDonald,
Phys. Rev. Lett. 100, 091303 
 
 formerly known as the PaST
( 
 
 
 M. Tegmark & M. Zaldarriaga, arXiv:0805.4414 [astroph] 
 G. B. Field, Proc. IRE 46, 240 
 S. A. Wouthuysen, Astron. J., 57, 31 
 Pritchard,
Furlanetto,
Mon. Not. Roy. Astron. Soc. , 376, 1680
 P. Shapiro, K. Ahn, M. A. Alvarez, I. T. Iliev, H. Martel
and D. Ryu, Astrophys. J. 646, 681 
 A. Lewis and A. Challinor, Phys. Rev. D76, 083005
 S. R. Furlanetto, M. Zaldarriaga and L. Hernquist, Astrophys. J. 613, 1 
 M. G. Santos, A. Cooray and L. Knox, Astrophys. J. 625,
575 
 M. Zaldarriaga, S. R. Furlanetto and L. Hernquist, Astrophys. J. 608, 622 
 S. R. Furlanetto, S. P. Oh and F. Briggs, Phys. Rept.
433, 181 
 M. McQuinn, S. R. Furlanetto, L. Hernquist, O. Zahn
and M. Zaldarriaga, Astrophys. J. 630, 643 
 G. B. Field, Astrophys. J. 129, 525 
 R. Barkana and A. Loeb, Astrophys. J. 624, L65 
 R. Barkana and A. Loeb, Astrophys. J. 626, 1 
 M. Tegmark, N. A. Taylor and A. F. Heavens, Astrophys.
J. 480, 22 
 R. Barkana, Mon. Not. Roy. Astron. Soc. 372, 259 
 A. Nusser, Mon. Not. Roy. Astron. Soc. 364, 743 
Hernquist,
Zaldarriaga
 
M. McQuinn,
A.Lidz, O. Zahn, S. Dutta, L. Hernquist and M. Zaldarriaga, Mon. Not. Roy. Astron. Soc. 377, 1043 
 J. D. Bowman, M. F. Morales and J. N. Hewitt, Astrophys. J. 638, 20 
Schilizzi,
Alexander,
Kellermann,
downloadable
 specifications
10Sep07.pdf 
 M. F. Morales and J. N. Hewitt, Astrophys. J. 615, 7
 M. F. Morales, Astrophys. J. 619, 678 
 X. M. Wang, M. Tegmark, M. Santos and L. Knox, Astrophys. J. 650, 529 
Mon. Not. Roy. Astron. Soc. 355, 1053 
 S. P. Oh and K. J. Mack, Mon. Not. Roy. Astron. Soc.
346, 871 
 T. Di Matteo, R. Perna, T. Abel and M. J. Rees, Astrophys. J. 564 576, 2002
Phys. Rev. D71, 103523 
 A. Lidz, O. Zahn, M. McQuinn, M. Zaldarriaga and
L. Hernquist, arXiv:0711.4373 [astro-ph] 
 A. Lidz, O. Zahn, M. McQuinn, M. Zaldarriaga and
S. Dutta, Astrophys. J. 659, 865 
 M. G. Santos, A. Amblard, J. Pritchard, H. Trac, R. Cen
and A. Cooray, arXiv:0708.2424 [astro-ph].
 E.g. review of Statistics (Section 32) in W.-M. Yao et al. ,
J. Phys. G 33, 1 and the 2008 edition available on
the PDG WWW pages (URL: 
 Available
 
/wwwasdoc/cernlib.html
 E. W. Kolb & M. S. Turner, The Early Universe, Addison
Wesley, New York 
 M. Tegmark, Phys. Rev. Lett., 79. 3806 
 M. Tegmark et al. [SDSS Collaboration], Phys. Rev. D
74, 123507 
 O. Zahn and M. Zaldarriaga, Astrophys. J. 653, 922
 R. B. Metcalf and S. D. M. White, Mon. Not. Roy. Astron. Soc. 381, 447 
 R. B. Metcalf and S. D. M. White, arXiv:0801.2571
[astro-ph].
 P. Zhang, Z. Zheng and R. Cen, Mon. Not. Roy. Astron. Soc. 382, 1087 
 O. Zahn, M. Zaldarriaga, L. Hernquist and M. McQuinn,
Astrophys. J. 630, 657 
 O. Zahn, A. Lidz, M. McQuinn, S. Dutta, L. Hernquist,
M. Zaldarriaga and S. R. Furlanetto, Astrophys. J. 654,