Anatomically Informed Basis Functions
Stefan J. Kiebel,* Rainer Goebel,† and Karl J. Friston‡
*Department of Neurology, Friedrich-Schiller-University, 07740 Jena, Germany; †Max-Planck-Institut for Brain Research, Deutschordenstr. 46,
60528 Frankfurt/M., Germany; ‡The Wellcome Department of Cognitive Neurology, The Institute of Neurology, London, United Kingdom
Received September 16, 1999
This paper introduces the general framework, concepts, and procedures of anatomically informed basis
functions (AIBF), a new method for the analysis of
functional magnetic resonance imaging (fMRI) data.
In contradistinction to existing voxel-based univariate or multivariate methods the approach described
here can incorporate various forms of prior anatomical knowledge to specify sophisticated spatiotemporal
models for fMRI time-series. In particular, we focus on
anatomical prior knowledge, based on reconstructed
gray matter surfaces and assumptions about the location and spatial smoothness of the blood oxygenation
level dependent (BOLD) effect. After reconstruction of
the grey matter surface from an individual’s high-resolution T1-weighted MRI, we specify a set of anatomically informed basis functions, ﬁt the model parameters for a single time point, using a regularized
solution, and ﬁnally make inferences about the estimated parameters over time. Signiﬁcant effects, induced by the experimental paradigm, can then be visualized
voxel-space
reconstructed folded, inﬂated, or ﬂattened cortical
surface. As an example, we apply the approach to a
fMRI study (ﬁnger opposition task) and compare the
results to those of a voxel-based analysis as implemented in the Statistical Parametric Mapping package (SPM99). Additionally, we show, using simulated
data, that the approach offers several desirable features particularly in terms of superresolution and localization.
© 2000 Academic Press
computational
neuroanatomy;
modelling; spatiotemporal model; statistical inference.
INTRODUCTION
In functional brain imaging, the analysis of fMRI data
has become an increasingly important issue. The underlying task is to characterize the functional data observed
in space and time in terms of some interpretable and
reduced representation of the experimentally induced effects. Many methods have been proposed that can be
divided into univariate and multivariate approaches.
With a univariate approach, one typically uses prior
knowledge about experimentally evoked signals over
time to project the time-series, at any voxel position, into
a low-dimensional parameter space (typically deﬁned by
a design matrix). The remaining task is then to assess the
spatial autocorrelations and make inferences about the
observations in voxel-space. The overwhelming proportion of methods published belong to this class. In contrast, multivariate approaches can identify a few spatiotemporal components that summarize the observed data
without reference to any predictions. Though the latter
approach appears to be more comprehensive, because it
is explicitly spatiotemporal (e.g., eigenimage analysis), it
is often rather difﬁcult to interpret the spatiotemporal
components that ensue, largely because this sort of dataled characterization does not embody prior information
about interesting temporal responses. Although design
matrices can be used in multivariate analyses (e.g., canonical variates analysis), these analyses are compromised by the sample-size (number of scans) to dimensionality (number of voxels) ratio.
Mass-univariate, voxel-based approaches have an
advantage over multivariate data-led approaches,
because the temporal projection space (design matrix) is deﬁned explicitly by the researcher. Conventional analyses of this sort start by convolving the
data with a lowpass spatial ﬁlter, which (i) renders
the point spread function (PSF) approximately stationary and (ii) enhances sensitivity to underlying
(extended) physiological signal sources by virtue of
the matched ﬁlter theorem. However, the resolution
of the resulting statistical maps is compromised.
Furthermore, convolution with a lowpass ﬁlter implicitly implements a spatial model of the inherent
spatial smoothness of the BOLD effect. If one assumes that the source of underlying signal is restricted to the gray matter, it is obvious that the
spatial model implied by a spherical lowpass ﬁlter is
inappropriate: It does not incorporate knowledge
about the local anatomical distribution of potential
signal sources in the folded cortical sheet.
Anatomically informed basis functions (AIBF), presented in this work, deﬁne a new class of models, which
NeuroImage 11, 656–667 
doi:10.1006/nimg.1999.0542, available online at on
1053-8119/00 $35.00
Copyright © 2000 by Academic Press
All rights of reproduction in any form reserved.
incorporation
neuroanatomical
knowledge provided that this information can be represented as a set of basis functions. As an example, we
describe an anatomical model based on an individual’s
reconstructed cortical surface and show that spatial
resolution and sensitivity for extended cortical sources
is improved as compared to a conventional voxel-wise
analysis. We thereby implicitly introduce a general
framework for including other types of prior anatomical knowledge.
We applied the method to fMRI measurements (ﬁnger opposition task) of ﬁve subjects and to simulated
data, where the exact locations and time courses of the
underlying signals were known. We show, by comparison with a voxel-based approach (SPM99), that the
method enhances resolution and interpretability of the
resulting statistical maps.
ANATOMICALLY INFORMED BASIS FUNCTIONS
The problem addressed by anatomically informed basis
functions can be stated as follows: Given the assumptions
that (i) the BOLD effects are located somewhere on the
cortical surface and (ii) can be characterized by a spatially smooth distribution on that surface, what is the
spatial distribution of the BOLD signal, which best explains the functional observations?
If both assumptions are valid, we can describe an
anatomically informed model that enables us to characterize any measured functional data directly on the
cortical surface. As we will show later there are three
major advantages of the technique when compared to
voxel-based methods: (i) The method does not use any
additional three-dimensional spatial lowpass ﬁltering,
but operates directly on the realigned unsmoothed
data. (ii) The method provides superresolution and (iii)
by virtue of the partially distinct spatial characteristics
of underlying effects, AIBF can be used to further
differentiate among underlying signal sources.
AIBF can also be used to implement an anatomically
constrained least-squares deconvolution of the PSF for
low-resolution data to remove PSF effects. This applies
when the intrinsic PSF is large relative to voxel size.
However, we do not deal with this application in this
paper, because we restrict ourselves to fMRI analyses.
In the following, we describe the approach in three
subsections. First, we will specify the spatial model
that embodies anatomical a priori knowledge about a
functional observation. In the second subsection, the
anatomical model is ﬁtted to a series of functional
volumes observed over time, to generate a spatiotemporal parameter matrix. Finally, we deal with inference about the effects in the time domain. In this
paper, we are assuming that the spatiotemporal basis
set can be factorized into a spatial and temporal basis
set, where the latter corresponds to conventional regressors in a design matrix. This allows us to ﬁrst
estimate the spatial distribution of sources at each
time point and then estimate, and make inferences
about, their expression over time.
The Spatial Model
Surface reconstruction.
A necessary prerequisite to
the speciﬁcation of a set of surface-based basis functions is the reconstruction of cortical surfaces. These
reconstructions were obtained with the software package BrainVoyager (Version 3.5, Brain Innovations,
Rainer Goebel). For each subject, a T1-weighted anatomical image was acquired on a clinical 1.5 T Siemens
Vision unit (Siemens GmbH, Erlangen) with TR 5 15
ms, TE 5 5 ms, ﬂip angle 5 30°. Each image matrix
consisted of 256 3 256 voxels, 192 partitions, sagittal
orientation, voxel size 1 3 1 3 1 mm
The process of surface reconstruction, inﬂation, and
ﬂattening as implemented in BrainVoyager is described elsewhere . We focus here
on the properties of the various surfaces generated.
To reconstruct the individual cortical surface, we segment the cerebral white matter, the ventricles, and deep
gray matter structures like the putamen and thalamus of
both hemispheres. The segmented voxel-based partition
of each hemisphere is transformed to a vertex-based surface S0 5 (V0, F) by triangularization of the outside voxel
faces, where V0 is a NV0 3 3-matrix of vertex coordinates,
F is a NF 3 3-matrix of vertex indices, NV0 and NF are
the number of vertices and faces. Since the surface
S0, lying between white and gray matter partitions,
reﬂects the coarse voxel-based discretized approximation to the (real) underlying surface, which is
assumed to be spatially smooth (i.e., local Gaussian
curvature values are bound by some maximum
value), the coordinates described by V0 are spatially
smoothed, with respect to the local vertex neighbourhood. V0 is thus transformed to a smooth representation of the white matter surface SW 5 (VW, F).
In the next step, a surface lying within the gray
matter sheet is identiﬁed by translating the vertices
in VW using a local iterative intensity-based optimization routine. This gives a representation of the
underlying gray matter surface SG 5 (VG, F) (Fig.
1a). We then compute an inﬂated surface SI 5 (VI, F)
(Fig. 1b) of the approximation to the cortical sheet
SG. After placing several cuts on the medial side of
the hemisphere, we project the inﬂated brain surface
onto a plane and reduce distortions that arise from
the projection and intrinsic curvature of the cortical
surface. The result is a ﬂattened map (Fig. 1c) of one
cortical hemisphere SF 5 (VF, F).
Note that in all surface representations the face matrix F never changes, only the vertex coordinates matrices VW, VG, VI, and VF are modiﬁed to describe different
coordinate
ANATOMICALLY INFORMED BASIS FUNCTIONS
Cortical surface of the left hemisphere in three different representations: (a) folded, (b) inﬂated, (c) ﬂattened.
Concept of smooth overlapping spatial basis functions: The distribution on the left can be expressed as a linear combination of
the three basis functions on the right.
Different representations of a basis function. (Left) Two-dimensional Gaussian kernel with 1 mm width in x- and y-direction.
(Middle) The same basis function transformed to the original reconstructed cortical surface. (Right) A transverse slice of its representation
in voxel-space.
Results of a voxel-based analysis (SPM99) of a single subject (thumb versus middle ﬁnger tapping task). Maximum peak
displayed on a (a) coronal, (b) sagittal, and (c) transverse slice.
KIEBEL, GOEBEL, AND FRISTON
transformation between two surfaces is implemented
by an exchange of vertex coordinates matrices.
Speciﬁcation of spatial model.
We assume that the
individual gray matter surface SG 5 (VG, F) is a good
approximation to the real underlying gray matter surface in the individual’s anatomical space. Given a functional observation vector Y in voxel-space, our aim is to
estimate a smooth distribution f on the vertices VG of
the reconstructed gray matter surface that best (in
some sense) explains the observed Y, i.e.,
Y 5 g~ f ~VG!! 1 e,
where e is the residual component and g is an operator
(to be described later), which transforms intensities
deﬁned in vertex-space to the voxel-space of Y. Typically, one reconstructed hemisphere consists of roughly
130,000 vertices, whereas the number of observed gray
matter voxels in one hemisphere (e.g., 20 partitions,
128 3 128 matrices, voxel size 1.8 3 1.8 3 3 mm
much less, roughly 12,000; i.e., the problem is underdetermined. One key to solve this problem is the assumption about the smoothness of f. A smooth distribution can be modelled by less parameters Np than the
number of vertices NVG so the idea is to approximate f
by a model that is determined by a small set of parameters. We choose to model the distribution f with a
linear combination of local, smooth, and partially overlapping spatial basis functions deﬁned on VG. Figure 2
illustrates the concept behind this approach.
A necessary prerequisite for the speciﬁcation of spatial basis functions on the surface SG is the existence of
a two-dimensional coordinate system, but due to the
folded nature of the gray matter surface, there is no
simple way to deﬁne such a coordinate system. However, the cortical ﬂat map SF 5 (VF, F) is the result of
a coordinate transformation from the vertex coordinates VG to a plane; i.e., for any vertex coordinate vG
SG its associated location on SF is stored in vF
there is a two-dimensional coordinate system available on the cortical ﬂat map SF, we deﬁne the basis
functions on SF and reproject them onto the cortical
sheet SG by a coordinate exchange.
Speciﬁcation of basis functions.
There are three
conditions the basis set must conform to: (i) Each basis
function must cover a small patch of SF, (ii) the linear
combination of basis functions is able to model smooth
distributions on SF, and (iii) the approximation of f at
any vertex location is implemented as sparsely as possible. Any form of two-dimensional Gaussian, sincfunction, or similar lowpass-kernel functions fulﬁll the
ﬁrst two criteria, provided that each basis function
overlaps with its neighbors to a certain degree. The
third condition means that this overlap is not unnecessarily large.
In this work, we use circular Gaussian basis functions in a hexagonal conﬁguration such that the center
of each basis function has a ﬁxed (user-speciﬁed) distance to the center of its six neighbors. Given a twodimensional coordinate system on the cortical ﬂat map
SF, the basis function bF
j with its center at coordinates
(xj, yj) is deﬁned by
j ~x, y! 5 c1 expS
2 ~~x 2 xj! 2 1 ~y 2 yj! 2
where c1 is a constant and w is the (user-speciﬁed)
width of the Gaussian basis function in the x- and
y-directions. The hexagonal pattern of the centers of
the basis functions are deﬁned by induction; i.e., given
that (xj, yj) is the center of bF
j , then the centers of its
six-neighbor basis functions are (x 1 d/2, y 1 do),
(x 1 d, y),
(x 1 d/2, y 2 do),
(x 2 d/2, y 2 do),
(x 2 d, y), (x 2 d/2, y 1 do), where d is the ﬁxed distance between centers and do 5 sin (60°)d. The position of the ﬁrst basis function is chosen arbitrarily. A
basis function is deﬁned only if its center is enclosed
by a face of the cortical ﬂat map SF.
After speciﬁcation of the basis functions on the cortical ﬂat map bF
j , j 5 1, . . . , Np, where Np is the
number of basis functions, each bF
j is reprojected onto
the original folded surface SG by a vertex coordinate
exchange between VF and VG to give folded basis
functions bG
j . Since the bG
j are still in vertex-space,
the ﬁnal step is to embed each basis function bG
the voxel-space. To do this, we deﬁne an operator g
(Eq. (1)), which integrates over each voxel k the
surface of a given basis function bG
j multiplied by the
height of the basis function; i.e., g returns the integral of each basis function in folded vertex-space
encompassed by the voxel. This transforms the basis
functions bG
j in vertex-space to bY
j , . . . , bYNK
in voxel-space, where NK is the number of functional
voxels. This basis set is now used to model, in a
linear combination, the functional observation Y.
In Fig. 3, we show the process of transforming a basis
function from its initial representation on the cortical
ﬂat map to its intermediate state on the folded cortical
map and to its ﬁnal representation in voxel-space.
Note that one could apply an additional convolution L
to the basis functions in voxel-space bY
j , if the width of
the image PSF is larger than the voxel size. This is
not necessary for fMRI, since here we assume that L
5 I (in Toeplitz notation, where I is the identity
matrix). For example with PET (positron emission
tomography) data, one could model the positron
travel by convolution of bY
j with an isotropic lowpass
ﬁlter kernel and the effects of the measurement process itself by an additional convolution with an
anisotropic lowpass ﬁlter kernel. This particular extension will be dealt with in a separate communication.
Estimating the spatial distribution of activity for one
time point.
Let A be a NK 3 Np-matrix, where column
ANATOMICALLY INFORMED BASIS FUNCTIONS
j of A is the basis function bY
j in voxel-space. Generally, A 5 L @bY
1 | . . .| bY
Np], but for fMRI we set L 5 I
and omit L in the following equations. Then, the
model (compare to Eq. (1)) is
Y 5 Ab 1 e,
where Y is the NK-dimensional observation vector in
voxel-space, b is a Np-dimensional parameter vector
and e is a NK-dimensional residual error vector.
The unknown parameter vector b is assessed by a
least-squares estimate with zeroth-order regularization , which yields
bˆ 5 ~A T A 1 lI! 21 A TY,
where l is a regularization factor and I is the identity
matrix of dimension Np. The zeroth-order regularization tends to minimize the overall length of the vector
bˆ, which is necessary if the distance d between centers
of neighboring basis functions is large compared to
their width w, i.e., adjacent basis functions overlap
extensively and are close to collinearity.
The choice for the regularization factor l depends on
the spatial overlap and therefore their degree of nonorthogonality. A standard choice for l (Press et al.,
trace~A T A!
and yields acceptable results in our case. In the extreme that adjacent basis functions do not have any
overlap or only a small overlap, the regularization factor can be set to zero and Eq. (4) reduces to a standard
least-squares solution
bˆ 5 ~A T A! 21 A T Y.
The Temporal Domain
Given a series of functional observations Y1, . . . ,
YNY,we estimate for each Yl a parameter vector bˆ l by
Eq. (4) to assemble a (NY 3 Np) estimated parameter
BT 5 @bˆ 1| . . . |bˆ NY# 5 ~A T A 1 lI! 21 A T @Y1||YNY#,
which represents the estimate of functional observations, projected into the space of anatomically informed
basis functions. The estimated signal in voxel-space is
Equivalently, let the columns of matrix Avertex be the
folded basis functions in vertex-space bG
j , then the
estimated signal in vertex-space is given by
5 AvertexB T.
Inferences about evoked responses over time.
make inferences about evoked responses, we have to
characterize the parameter matrix B in the temporal
domain. This could be done at three levels: (i) The ﬁrst
is in the space of the basis functions (Eq. (7)). (ii) The
second is in the vertex-space (Eq. (9)), where we characterize the responses at each vertex in two dimensions
and embed the results in three-dimensional space. (iii)
Finally, we could project B back into voxel-space (Eq.
(8)) and proceed with a conventional voxel-based analysis.
Either a univariate or a multivariate technique could
be used at all three levels. In this paper, we will illustrate a multivariate approach in basis function space.
We use a combined approach of singular value decomposition (SVD), multivariate analysis of covariance
(Mancova) and canonical variates analysis (CVA) as
described in detail in and .
As with a conventional analysis in voxel-space (e.g.,
as implemented in SPM99), we use various types of
temporal basis functions or regressors: (i) condition
encoding vectors, (ii) a constant, and (iii) a vector of
global intracortical mean intensities. The condition encoding basis functions are the covariates of interest,
the remainder represent covariates of no interest. Prior
to ﬁtting the model, we applied a highpass temporal
ﬁlter with a cut-off frequency at 120 s/cycle.
Since we acquired the data using a rather long interscan time of 4 s, we assumed that the highpass ﬁlter
accounts for temporal auto-correlations, which are especially prominent at lower frequencies and .
Let the temporal basis functions be T 5 [T1|T2],
where T is a (NY 3 NT)-matrix, NT is the number of
temporal basis functions, T1 and T2 are NY 3 NT1 and
NY 3 NT2-matrices, T1 and T2 are orthogonal to each
other, and NT 5 NT1 1 NT2. T1 contains the covariates
of interest and T2 the covariates of no interest.
First we remove the effects of no interest by
BC 5 B 2 T2 ~T 2
T T2! 21 T 2
The SVD of the corrected parameter matrix BC is
where U and W are orthogonal matrices and V is a
diagonal matrix. Let BP 5 UJVJ a NY 3 NJ matrix,
where the columns of BP contain the temporal expres-
KIEBEL, GOEBEL, AND FRISTON
sion of the ﬁrst NJ spatial modes over observations. NJ
is found by thresholding the associated singular values
contained in V as described in and
UJ and VJ are the accordingly reduced versions of U
Then the temporal model is given by
BP 5 T1 g 1 eT,
where g is a NT1 3 NJ-matrix and eT (the residual
errors) a NY 3 NJ-matrix.
The least-squares estimate of g is
T T1! 21 T 1
Then the sums of squares and products due to error
RE 5 ~BP 2 T1 gˆ ! T ~BP 2 T1gˆ !.
The sum of squares and products due to the effects of
interest are
H 5 ~T1gˆ ! T ~T1gˆ !
and the sum of squares and products under the null
hypothesis (that the effects due to T1 do not exist) are
The signiﬁcance of the effects of interest can be
tested with Wilk’s Lambda
as described in .
The characterization of the signiﬁcant effects employs CVA, i.e., we ﬁnd a matrix of canonical images C
5 [c1, . . . , cJ] such that the variance ratio ~cm
TR Ecm) is maximized successively for m 5 1,. . ., J
under the condition that cov (cm, cn) 5 0 for any m, n
with 1 # m, n # J and m Þ n. As it is shown below,
the signiﬁcant canonical modes can be visualized in
the native voxel-space (functional or structural) or in
vertex-space (folded, inﬂated, and ﬂattened surfaces).
VALIDATION STUDIES
Empirical Data
Functional data and coregistration.
The functional data (EPI, gradient echo) were acquired on a clinical 1.5 T Siemens Vision unit (Siemens
GmbH, Erlangen) with TR 5 168 ms, TE 5 79 ms, ﬂip
angle 5 90°. Each image consisted of 128 3 128 voxels,
20 partitions, transverse orientation, voxel size 1.8 3
1.8 3 3 mm
3. For each of the ﬁve subjects, the position
and orientation of the slices were chosen to cover all
the brain volume superior to the corpus callosum, in
particular the primary sensorimotor hand area.
We acquired the T1-weighted structural and the EPI
data in two successive measurements, i.e., the structural and the ﬁrst scan of the functional data were
already roughly in register. Subjects were instructed to
keep still during the interval between sequences. To
correct for small movements, the ﬁrst functional scan
was manually coregistered to the corresponding structural scan. Using SPM99 the functional scans were
aligned to the ﬁrst such that all measurements were in
the same space.
Simulated Data
This section describes the simulated fMRI data used
to validate AIBF and compare it with a voxel-based
technique (i.e., SPM99).
All simulated data were generated from a single
fMRI data set consisting of 93 volumes, acquired from
one of the ﬁve subjects above using the same EPI
gradient echo sequence. The only difference was that
there was no activation condition; i.e., all scans were
acquired under a continuous rest condition. As expected, this null data set showed no signiﬁcant activations when tested with SPM99 (maximum t score 4.39,
corresponding to a P value of 0.93, corrected for multiple comparisons). In particular, there were no activations in the region of the left primary sensorimotor
The next step was the addition of some well-deﬁned
simulated activations. We used the left hemisphere of
the reconstructed cortical surface SF of subject and
condition encoding temporal basis functions of the ﬁnger-tapping study to deﬁne the activation signal. We
ﬁrst chose a subset of vertices of VF (e.g., a circle of 3
mm diameter on the surface SF) and deﬁned these as
the source of a BOLD effect. Then, we speciﬁed a (signal) time series in each vertex consisting of the condition encoding basis function. Next, we embedded the
signal into voxel-space as described above. The voxelbased signal time-series was scaled such that the mean
intensity difference between conditions was 5% of the
mean (intracortical) global signal of the null data. Finally, we added the simulated signal in voxel-space to
null data.
We generated three different sets of simulated data.
These sets differed in their spatial conﬁguration, i.e.,
in each set, a speciﬁc underlying cortical pattern of
activation was simulated:
Single source.
In this simulated data, we deﬁned a
single circular patch of 3-mm diameter on the gray
matter surface as the source of an experimentally in-
ANATOMICALLY INFORMED BASIS FUNCTIONS
AIBF results of one subject (left hemisphere) displayed on (a) the cortical ﬂat map, (b) the inﬂated cortex, and (c) the folded gray
matter surface.
AIBF results in voxel-space (left hemisphere, central sulcus at level of presumed hand representation). Maximum of ﬁrst
canonical mode displayed on (a) the surface and (b) in voxel-space. In (c), the result of a SPM99-analysis for this slice is provided.
KIEBEL, GOEBEL, AND FRISTON
duced BOLD-effect. This patch was located on the anterior bank of the central sulcus roughly at the level of
the presumed hand representation. In this analysis,
the questions were, (i) whether the location and extent
of the underlying BOLD-effect is precisely characterized by a linear combination of AIBF and, (ii) whether
Results on simulated data set “Single Source”: (a) simulated conﬁguration, (b) activation found by AIBF, (c) ﬁt in vertex-space
superimposed on transverse plane, (d) ﬁt in voxel-space, (e) SPM99-result.
Results on simulated data set “Two adjacent sources”: (a) simulated conﬁguration, (b) activation found by AIBF, (c) ﬁt in
vertex-space superimposed on transverse plane, (d) ﬁt in voxel-space, (e) SPM99-result.
ANATOMICALLY INFORMED BASIS FUNCTIONS
any activation is spuriously mapped to the posterior
bank of the sulcus.
Two adjacent sources.
In this data set, we generated two sources of signal (circular patches of 3-mm
diameter), where one patch was located on the anterior
bank of the central sulcus and the second was located
on the opposite posterior bank, such that the Euclidean
distance between the patches was minimal. The question here was whether AIBF separate the sources,
which are close in Euclidean terms, but remote in
terms of distance on the cortical surface.
Single source (extensively folded).
Here, we generated a single circular patch of 5-mm diameter around
the fundus of the central sulcus at the level of the
presumed hand representation.
Voxel-Based Analysis (SPM99)
To characterize the differences between AIBF and a
conventional voxel-based analysis, we analyzed all our
data with SPM99. To do this, we smoothed the realigned data with a three-dimensional Gaussian lowpass-ﬁlter ([4 4 6] FWHM x-, y-, and z-direction). Statistical results were assessed using the general linear
model and the theory of Gaussian random ﬁelds. All
statistical results were thresholded at a signiﬁcance
level of p , 0.05 (corrected for multiple comparisons).
Fingertapping—Voxel-Based Analysis
The results of a voxel-based analysis (SPM99) of one
subject are displayed in Fig. 4. As described in previous
studies of motor tasks , e.g., we found signiﬁcant
activation (P , 0.05 corrected) in the contralateral central sulcus (Fig. 4) and in the contralateral supplementory motor area. In two subjects, we observed signiﬁcant (P , 0.05) ipsilateral activations in premotor and
parietal areas. Due to the limited ﬁeld of view, we did
not assess effects in other locations, e.g., the cerebellum.
Fingertapping—Anatomically Informed
Basis Functions
For each subject, we applied AIBF to the left hemispheres. We used basis functions with a distance of 2
mm between their centers and a width of 1 mm, giving
between 1242 and 2044 basis functions for each subject. In all ﬁve subjects, we identiﬁed a highly signiﬁcant
hemisphere
(P , 0.001).
To visualize the ﬁrst canonical spatial mode in vertex-space, we took the linear combination of basis functions corresponding to this mode.
In Fig. 5, we display the thresholded mode of one
subject on the individual folded, inﬂated, and ﬂattened
cortical surface. The arbitrary threshold (60% of the
maximum value) was used to enable the visualization
of the highest canonical scores relative to the gyral
pattern. We found, in each subject, a region of high
canonical scores on the anterior bank of the central
sulcus on the lateral side of the characteristic inverted
Omega . In all subjects except for
one, this region also comprised the basis function with
the maximal canonical score. In all subjects, there were
also regions of high canonical scores on the posterior
bank of the central sulcus close to those on the anterior
To compare these ﬁndings to the results of a voxelbased analysis, we overlayed the two-dimensional
color-coded gray matter surface on each transverse
slice. In Fig. 6a the transverse slice containing the
maximum of the canonical mode is displayed for one
subject. Equivalently, we overlayed the thresholded
ﬁrst canonical mode deﬁned in voxel-space (Eq. (3))
onto this slice (Fig. 6b). This encodes the same information as the surface representation, but shows the
canonical mode in the space in which the regularized
least-squares-ﬁt to the functional observations was implemented. Finally, the result of the voxel-based analysis (SPM99) for this slice is shown in Fig. 6c.
Simulated Data
In all three simulated studies, we used a distance of
2 mm between centers of the basis functions and a
width of 1 mm for each basis function.
Single source.
The location of the simulated activation is shown in Fig. 7a. The result of using AIBF is
shown in Figs. 7b–7d. The original location of the simulated activation was correctly identiﬁed on the cortical surface. The SPM99 result (Fig. 7e) is slightly
blurred due to the smoothing, but the maximum peak
of the cluster still correctly identiﬁes the location.
Two adjacent sources.
The locations of the two
simulated activations is shown in Fig. 8a and the result
of using AIBF in Figs. 8b–8d. Clearly, AIBF were able
to identify and localize the two simulated activation
sites, where AIBF seems to favor the source on the
posterior bank. As shown in Fig. 8e, when employing a
voxel-based method (SPM99) for the same data, we
observe a contiguous cluster of activation, where the
maximum peak is located between the two underlying
Single source (extensively folded).
The simulated
activation was located in the fundus of the central
sulcus and is shown in Fig. 9a. This location was correctly identiﬁed by AIBF (Figs. 9b–9d). However, the
voxel-based analysis (Fig. 9e) localizes the maximum of
the activation several mm lateral to the main source of
activation. Again, this is a spurious effect due to the
smoothing used prior to voxel-based analysis.
KIEBEL, GOEBEL, AND FRISTON
DISCUSSION
In this work, we have proposed the use of anatomically informed basis functions (AIBF) for the analysis
of functional MRI data. The method utilizes a new
class of models, in which prior anatomical knowledge
can be harnessed to better qualify the analysis in a
neuroanatomical sense. We chose the reconstructed
gray matter surface and the intrinsic smoothness of
the BOLD effect over space as prior anatomical constraints in the examples presented in this paper. We
applied AIBF to fMRI measurements of a motor task
(ﬁngertapping) in ﬁve subjects and compared the results with a voxel-based analysis (SPM99). Additionally, we analyzed three sets of simulated data to characterize the salient differences between AIBF and
voxel-based techniques.
In the following, we discuss the results as assessed
by AIBF and SPM99. As an introductory remark, we
note that a formal comparison between AIBF and
SPM99 is a difﬁcult task because of the differences in
models and inference used in both methods. However,
it is not our intention to show that AIBF or SPM is
better or worse in some aspects than the other method.
Our aim is to show that AIBF is a useful tool to look at
functional data sets from a different and informed perspective.
There are three important differences between a
voxel-based analysis and the class of AIBF presented.
Three-Dimensional vs Two-Dimensional Smoothing
When using AIBF, one does not apply any spatial
lowpass ﬁlter to the data as is typical in a voxel-based
analysis. In conventional analyses, a smoothing ﬁlter
is used to enhance the sensitivity for a given signal
width. The important point is that smoothing implicitly implements a model of the underlying data,
namely one assumes that the underlying signal shape
is independent of its location. Clearly, this model is not
correct, since activations observed with fMRI usually
follow the gyral pattern of gray matter such that there
is a substantial interaction between position and the
shape of the activation. The disadvantage of using a
3D-lowpass ﬁlter model is that activation effects at a
given location are smeared into all adjacent locations,
which can lead to physiologically implausible results
(e.g., activations in white matter). For the same reason,
it is difﬁcult to differentiate between activation sites
that are close in Euclidean space, but remote from each
other on the cortical surface (e.g., opposite banks of a
sulcus). There is no doubt that one must spatially
smooth functional observations to detect signal sources
of a given width. However, the cortical sheet is highly
convoluted and a voxel-based analysis of fMRI data
based on exogenous smoothing is suboptimal in the
sense that prior knowledge about structure–function
relationships is not exploited. This renders it difﬁcult
to interpret statistical results in terms of the underlying physiology. AIBF, on the other hand, can be regarded as a spatially dependent smoothing ﬁlter,
where the kernel is an explicit function of location.
Intuitively, AIBF smoothes along the cortical surface
such that any signal on the cortical surface, that conforms to the form of the basis functions, is detected
with high sensitivity. In other words, AIBF intrinsically deﬁnes a space-varying smoothing kernel, which
introduces only as much smoothness as is necessary for
signal detection, while preserving functional topology.
Superresolution
AIBF introduces superresolution into the estimated
solution, i.e., one can characterize the functional data
on the high-resolution reconstructed surface. Since the
gray matter surface can be approximated with subvoxel accuracy, we effectively exploit high-resolution
knowledge in a low-resolution space by placing constraints on the solution. The beneﬁt is that one can
characterize the estimated solution not only in lowresolution (functional) voxel-space, but also, unambiguously, in the high-resolution vertex-space. The important point here is that the degree of superresolution
depends primarily on the characteristics of the model
speciﬁed, not on the data. Of course, in practice, the
ultimate restriction is that the basis functions speciﬁed
in vertex-space should lead to a sparse basis set in
voxel-space, i.e., the lower the functional resolution,
the less basis functions (as deﬁned in Eq. (2)) are
needed to span the measurement space in a sparse
Effective Physiological Resolution
By constraining the spatially dependent smoothing
performed by AIBF to the gray matter surface, one
implicitly
suppresses
extraparenchymal
space, e.g., from draining veins, which are located in
CSF and can be several millimeters away from the
original location of the neuronal activation. It is known
that draining veins contribute to the BOLD-effects induced experimentally , particularly when using gradient-echo sequences as we did in our study. If one is interested in
the temporal hemodynamic response of a given brain
area, then the spatial differentiation between two underlying signal sources is not overly important. However, if one is interested in a spatial high-resolution
characterization of activations, then the pattern of
draining veins may limit the effective physiological
resolution of gradient-echo fMRI.
Surface Reconstruction
The speciﬁcation of a valid anatomical model is only
possible in the context of AIBF, if (i) the reconstructed
grey matter approximates the real cortical surface and
ANATOMICALLY INFORMED BASIS FUNCTIONS
(ii) the reconstructed grey matter surface also approximates the gray matter surface as measured in the
low-resolution functional EPI-sequences. Visual inspection of the reconstructed surfaces overlayed on
each individual’s T1-weighted MRI showed that the
ﬁrst assumption was valid. The second assumption
seems to be violated in the prefrontal region, where we
observed some inconsistencies between functional and
structural scans. However, for the primary sensorimotor cortical areas, we found that the second assumption
was reasonable. A necessary prerequisite for this assumption is an accurate coregistration between the
surface and functional observations.
Distortions in Flat Maps
The geometric distortions between the folded and
ﬂattened cortical surface, due to the curvature of the
gray matter sheet, are unavoidable, especially when a
whole hemisphere is transformed. Although cuts can
diminish the ensuing distortions, they should be used
sparsely to preserve the structure–function topology.
Since our goal is to model a smooth distribution on the
(folded) cortical surface (observed in voxel-space), the
effect of geometric distortions is to render the local
smoothness of the basis functions slightly variable and
the ensuing change in ﬁt (Eq. (7)) is minimal.
Practical Issues
Some practical issues must be considered when applying the method to functional data. In the current
description, the Brainvoyager software was used to
construct the anatomically informed model. However,
the use of other surface reconstruction packages is
possible at any stage of processing. We implemented
our AIBF code in Matlab (Matlab 5.3, The Mathworks
With regard to computer resources, the number of
basis functions used to model the functional data is a
limiting factor, since the parameter estimation (Eq.
(4)) includes the matrix inversion of (A
TA 1 gI). In our
experience, the analysis of whole head volumes by
AIBF is possible at a reasonable resolution (basis functions of 2-mm width) on a conventional workstation
(256 MByte RAM, tested on a Sparc-Station and a
Linux-PC). Note that the matrix inversion (Eq. (4))
need only to be done once, after this all functional
volumes are ﬁtted using the same projection matrix.
The run-time of the whole process (generation of
model, matrix inversion and ﬁtting the data) is in the
range of 5–60 min, again largely depending on the
number of basis functions used.
Generalization
We want to identify an underlying spatiotemporal
distribution of activity on a surface, where we only
observe a low-resolution, noisy image of this distribution. Any valid prior spatial or spatiotemporal knowledge that can be used to constrain the solution will be
usefully embodied in a set of AIBF; e.g., one could try to
Results on simulated data set “Single Source (extensively folded)”: (a) simulated conﬁguration, (b) activation found by AIBF, (c)
ﬁt in vertex-space superimposed on transverse plane, (d) ﬁt in voxel-space, (e) SPM99-result.
KIEBEL, GOEBEL, AND FRISTON
model thick/thin stripes in the secondary visual area
V2 directly on the cortical sheet.
AIBF can accomodate any form of prior anatomical
knowledge given that an appropriate model can be represented as a set of basis functions. As in any inverse
problem, the ensuing solution depends on the validity of
the prior anatomical knowledge and the model speciﬁed.
The generalization of the approach presented can be described in terms of potential adaptions.
The ﬁrst obvious component is the deﬁnition of basis
functions. Our choice of Gaussian basis functions was
arbitrary. These can be replaced by any smooth, unimodal two-dimensional function, effectively implementing a lowpass ﬁlter kernel, e.g., sinc-functions.
However, the change in the resulting ﬁt is not as large
as one might expect, because the transformation from
high-resolution vertex- to low-resolution voxel-space
effectively acts as an additional lowpass ﬁlter that
renders different sets similar. A conceptually distinct
kind of basis functions is a set of spatial cosine functions of different frequencies as used in stereotactic
normalization .
In the case of other modalities like PET or SPECT
(single photon emission computed tomography), one
can model the intrinsic PSF by an additional convolution with a lowpass kernel L, which emulates the effects of underlying physical processes and its measurement. It is important to note that in this context the
solution effectively implements a deconvolution of the
original observations, since the estimated parameters
can be used to project the observations in AIBF-space
back into voxel-space without applying L.
We have used a zero-order regularization, which effectively weighs the solution in favor of small parameters. Although the regularization does not improve
the overall ﬁt, it stabilizes the ﬁts of a speciﬁc basis
function over time, since the associated parameter estimates are less susceptible to random errors of estimation. As a result, the contribution induced by the
experimental paradigm is better reﬂected in the
changes over time. Other regularization schemes can
be used, e.g., ﬁrst- or higher-order regularization as
described by Press et al. .
Finally, one could substitute the simple optimization
method used to an iteratively adaptive scheme. An interesting extension would be to iteratively change the basis
sets with respect to some goal function. Modiﬁable parameters could include the widths of basis functions in xand y-direction or positions on the cortical surface.
CONCLUSION
We have applied anatomically informed basis functions (AIBF) to a fMRI study and to simulated data.
We have shown that the method provides superresolution and higher sensitivity for signal sources
within the gray matter sheet. In this work, we have
used the location of the gray matter sheet as prior
anatomical knowledge. More generally, AIBF can be
used to incorporate any anatomical knowledge into
functional analyses to constrain the resulting solution.
ACKNOWLEDGMENT
K.J.F. was supported by the Wellcome Trust.