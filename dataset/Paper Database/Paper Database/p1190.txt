Improved detection of Parkinsonian resting tremor with feature
engineering and Kalman ﬁltering
Lin Yao a,⇑, Peter Brown b,c, Mahsa Shoaran a
a ECE Department, Cornell University, Ithaca, NY, USA
b Medical Research Council Brain Network Dynamics Unit, University of Oxford, Oxford, UK
c Nufﬁeld Department of Clinical Neurosciences, John Radcliffe Hospital, University of Oxford, Oxford, UK
See Editorial, pages 241–242
a r t i c l e
Article history:
Accepted 10 September 2019
Available online 5 November 2019
Parkinson’s disease (PD)
Kalman ﬁltering
Machine learning (ML)
Local ﬁeld potential (LFP)
Tremor detection
Adaptive deep-brain stimulation
h i g h l i g h t s
 Multiple features of local ﬁeld potentials in subthalamic nucleus were investigated to detect resting
tremor in Parkinson’s disease.
 The use of relevant features, machine learning, and Kalman ﬁlter improves the tremor detection
performance.
 The Kalman ﬁlter in feature space signiﬁcantly improves the speciﬁcity of detection by 17%.
a b s t r a c t
Objective: Accurate and reliable detection of tremor onset in Parkinson’s disease (PD) is critical to the
success of adaptive deep brain stimulation (aDBS) therapy. Here, we investigated the potential use of feature engineering and machine learning methods for more accurate detection of rest tremor in PD.
Methods: We analyzed the local ﬁeld potential (LFP) recordings from the subthalamic nucleus region in
12 patients with PD (16 recordings). To explore the optimal biomarkers and the best performing classi-
ﬁer, the performance of state-of-the-art machine learning (ML) algorithms and various features of the
subthalamic LFPs were compared. We further used a Kalman ﬁltering technique in feature domain to
reduce the false positive rate.
Results: The Hjorth complexity showed a higher correlation with tremor, compared to other features in
our study. In addition, by optimal selection of a maximum of ﬁve features with a sequential feature selection method and using the gradient boosted decision trees as the classiﬁer, the system could achieve an
average F1 score of up to 88.7% and a detection lead of 0.52 s. The use of Kalman ﬁltering in feature space
signiﬁcantly improved the speciﬁcity by 17.0% (p = 0.002), thereby potentially reducing the unnecessary
power dissipation of the conventional DBS system.
Conclusion: The use of relevant features combined with Kalman ﬁltering and machine learning improves
the accuracy of tremor detection during rest.
Signiﬁcance: The proposed method offers a potential solution for efﬁcient on-demand stimulation for PD
 2019 International Federation of Clinical Neurophysiology. Published by Elsevier B.V. This is an open
access article under the CC BY-NC-ND license ( 
1. Introduction
Deep brain stimulation (DBS) is a widely utilized treatment
option to reduce the motor symptoms of advanced PD such as resting tremor, akinesia, and rigidity. Conventional DBS delivers constant and high-frequency (~130 Hz) stimulation pulses which
may cause side effects such as psychiatric symptoms and speech
 
1388-2457/ 2019 International Federation of Clinical Neurophysiology. Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license ( 
⇑Corresponding author at: Electrical and Computer Engineering Department,
Cornell University, 411 Phillips Hall, Ithaca, 14850 NY, USA. Tel.: +1 607 379 2097.
E-mail address: (L. Yao).
Clinical Neurophysiology 131 274–284
Contents lists available at ScienceDirect
Clinical Neurophysiology
journal homepage: www.elsevier.com/locate/clinph
impairment . Moreover,
open-loop charge delivery increases the power consumption of
the DBS system, potentially requiring a surgical battery replacement every three to ﬁve years. To address these challenges, the
so-called adaptive DBS (aDBS) approach offers a promising alternative, by replacing conventional stimulation with a closed-loop and
adaptive one . In this approach, the neuromodulation is
dynamically controlled by motor symptoms such as tremor or
bradykinesia, either in a continuous way , or with
an on-off strategy . By
providing feedback from relevant biomarkers, such as the beta
band power of LFPs in the subthalamic nucleus (STN) , adaptive DBS can titrate stimulation, hence reducing the
total stimulation delivered, improving both the efﬁcacy of treatment and side effects, and increasing the battery life. Proof-ofconcept studies of adaptive DBS in humans have
reported promising advantages over conventional DBS, including a
27% improvement of the Uniﬁed PD Rating Scale (UPDRS), 56%
stimulation
dissipation,
improved speech intelligibility .
The adaptive DBS method tested used feedback based on the beta
amplitude of LFPs recorded by the stimulation electrodes.
In order to characterize motor symptoms in PD, biomarkers in
the LFP of STN and GPi have been studied . For instance, neuronal oscillations within the
motor network and over the tremor frequency range (~3–7 Hz)
have been shown to correlate with resting tremor, measured as
cortico-muscular
 . The beta band (13–30 Hz) power in
the cortex and STN has been shown to reduce during PD rest tremor , while the cortical
phase-amplitude
oscillations (50–200 Hz) decreases during rest tremor . The ratio of high-frequency oscillations (HFOs)
between the slow band (200–300 Hz) and the fast band (300–
400 Hz) has also been shown to increase during rest tremor
 . Moreover, the low gamma (33–55 Hz)
power in the STN LFP is increased during rest tremor in Parkinson
patients . While such features can potentially be used for real-time detection of resting tremor, the majority of current adaptive DBS
experiments have been overly
simplistic and based on a single feature such as beta band power,
with a simple thresholding mechanism to control DBS. However,
the exclusive usage of beta-band power in the STN may not be
optimal for tremor detection in PD, given that it is not correlated
with tremor . Therefore, other relevant
biomarkers of pathological neural activity and powerful classiﬁcation algorithms need to be investigated to more accurately characterize and predict the tremor state .
Toimproverestingtremor detectionfromthe LFP,a multi-feature
classiﬁcation approach based on features of the LFP such as variance,
zero crossing rate, autocorrelation, band powers, and wavelet transform has been used to identify tremor related characteristics in PD
patients , and shows that LFPs from STN or
GPi provide sufﬁcient information for rest tremor detection. In
another study, using beta, gamma, and tremor band powers, the
ratio of slow and fast high frequency oscillations (HFOs), and a Hidden Markov Model (HMM), the Parkinsonian rest tremor was also
accurately detected from STN LFPs . Both
frequency and time domain features such as multiple band powers
and the Hjorth parameters from subthalamic LFPs, combined with
a logistic regression classiﬁer have also been used to detect Parkinsonian rest tremor . However, despite promising
results, the latency of tremor detection was not reported in these
studies, and is an important parameter for implementation of
closed-loop DBS where stimulation should best anticipate symptomatic disturbance. Furthermore, it is still unclear whether the
use of more domain-speciﬁc features and advanced machine learning techniques could further improve the tremor detection accuracy.
In various other neurological applications such as seizure detection
for medication-resistant epilepsy and movement intention decoding in brain-machine interface systems
 , the use of machine learning and domainspeciﬁc features has made a signiﬁcant impact by achieving remarkable accuracies. Particularly, gradient boosting-based algorithms
such as XGBoost have been very successful in
classifying time-series neurophysiological data with limited training sets and have been included in our analysis. Such decision treebased classiﬁers have been recently integrated on microchips with
ultra-low power consumption and small area utilization and could potentially be used for hardware implementation of aDBS. Moreover, the evaluation of tremor detection algorithms in a greater number of patients with different tremor
characteristics is another crucial step for the reliability assessment
of aDBS and its translation to a clinical setting.
In this work, we study the predictive accuracy of various
biomarkers in the LFP recorded in the region of STN, such as band
power in relevant frequency bands, beta-HFO phase-amplitude
coupling (PAC) , the Hjorth parameters that
have been primarily used for EEG characterization ,
and wavelet entropy . We evaluate these neurophysiological biomarkers for quantifying Parkinsonian rest tremor
in a group of 12 PD patients with different tremor intensities, and
employ advanced ML models to detect rest tremor periods. Moreover, to further enhance the tremor detection performance, a Kalman ﬁltering approach in the feature domain is explored .
2. Materials and methods
The overview of our proposed framework for tremor detection
is depicted in Fig. 1. The goal is to accurately detect the occurrence
of resting tremor by directly measuring the neural activity in STN.
Fig. 1. Overview of the proposed framework for tremor detection. The output of
machine learning-based classiﬁer can be used to activate DBS in an envisioned
closed-loop system.
L. Yao et al. / Clinical Neurophysiology 131 274–284
We opted to detect tremor from the LFP rather than from peripheral inertial signals as then stimulation could potentially anticipate
the physical symptom. In addition, wireless communication
between peripheral sensors and an internalized system introduces
potential vulnerability to hacking, and additional energy demands.
We used a supervised learning approach to classify the continuous
LFP signal, while simultaneous measurements from an accelerometer sensor were used to label the data, as ‘ground truth’. The neurophysiological biomarkers were extracted from multi-channel LFP
signals and a Kalman ﬁlter was used to process the extracted features. We subsequently trained different classiﬁers on a labeled
feature set and evaluated the trained models on the test set to
detect the tremor and non-tremor states.
2.1. Patients and surgical procedure
We studied 12 PD patients recruited from the University of
Oxford. All subjects gave informed consent to participate, and the
local research ethics committee approved the study. Patients were
aged between 46 and 73 years old (mean 62 years old, 10 males),
and had a disease duration ranging from 4 to 17 years (mean
10 years). Bilateral DBS electrodes were implanted into the STN,
preceding the therapeutic stimulation for advanced idiopathic PD
with motor ﬂuctuations or dyskinesias. All the studied patients
also had resting tremor. Detailed techniques for targeting and
implanting electrodes in the STN have been previously reported
 . Microelectrode recording was not performed during surgery. The model 3389 quadripolar macroelectrode with four platinum-iridium cylindrical contacts was used
(Medtronic Neurologic Division, Minneapolis, USA). The contacts
of this electrode range from 0 to 3, with contact 0 indicating the
most caudal contact. Electrodes were localized intra-operatively
through the effect of direct stimulation, and immediately postoperation by stereotactic imaging. Nevertheless, considering that
not all contacts lie in the STN per se, we termed the area sampled
by the electrode contact as the STN region (STNr). The extension
cables for DBS electrodes were externalized through the scalp,
enabling recordings prior to connection to a subcutaneous pacemaker, which was implanted in a second operation a week later.
A TMSi porti (TMS international, Netherlands) and associated
acquisition software were used to record monopolar LFPs at a sampling rate of 2048 Hz. These were then common average referenced and bandpass ﬁltered between (0.5–500 Hz). Bipolar LFPs
were extracted ofﬂine, by subtracting the monopolar signals measured by neighboring contacts on each electrode . We included three bipolar channels in our analysis (0–1,
1–2, 2–3). In a separate study, we included the bipolar channels
between 0–2 and 1–3 contacts, which is a preferred strategy to
reject the stimulation artifact on the middle electrode during adaptive DBS . We also compared the performance of our classiﬁer using a bipolar versus
monopolar electrode contact conﬁguration.
Overall, the dataset included 16 LFP recordings (7 from right
side), as patients with bilateral tremor were recorded from both
hemispheres. The LFPs were recorded from the STNr with both medication withdrawn overnight and DBS off, while the acceleration of
the contralateral limb was simultaneously recorded. Patients were
at rest throughout the recordings. The LFP recordings varied from
1.5 to 10 (mean 6.2) minutes in duration among patients. Tremor
prevalence ranged from 41 to 97 (mean 73) % of time.
2.2. Data annotation
In order to label the data, the tremor frequency f T of the
accelerometer recording was calculated as the frequency associated with the highest amplitude (over 1–10 Hz). Then, a Butterworth
second-order
(f T  1; f T þ 1 Hz) was used to ﬁlter the acceleration signal from
the limb, and a Hilbert transform was subsequently applied to
extract the envelope, as shown in Fig. 2. We then identiﬁed the
resting non-tremor period as baseline, through visual inspection.
For instance, the interval between the two vertical lines in Fig. 2
(a) is considered as non-tremor. The mean value + ﬁve times the
standard deviation of baseline was empirically set as threshold,
and the envelope was labeled as tremor if its amplitude surpassed
the threshold level. While this method was effective in most
patients, in some cases (i.e., 5 recordings) we had to slightly adjust
the threshold to avoid the unnecessary annotation of very small
and short-duration motions as tremor, and avoid rapid label
switching within longer tremor episodes .
2.3. Feature extraction
In order to compute the LFP biomarkers of tremor, we used a 1second window with half overlapping to continuously segment the
LFP recordings. Fifteen features were extracted from the three
45dimensional feature vector. In addition to beta power, which is
the most commonly used feature in aDBS studies, we explored
other potentially relevant biomarkers based on prior research on
Parkinson’s disease and other neurological diseases, with the goal
of improving tremor detection performance. The selected feature
set included band power in several frequency bands, phaseamplitude coupling, and time-domain features such as the Hjorth
parameters, as outlined below.
2.3.1. Low and high HFO power
The presence of HFO in STN (~300 Hz) was reported in patients
with PD under dopaminergic treatment . It has
been further shown that the lower frequency HFO power (200–
300 Hz) decreases after levodopa intake, while the higher frequency HFO power (300–400 Hz) increases . Furthermore, the ratio between the low and high HFO powers is shown to be a marker of Parkinsonian resting tremor. This
 .
2.3.2. Phase-amplitude coupling (PAC)
The coupling between the beta-band phase and HFO (150–
400 Hz) amplitude in STN LFPs has been shown to have a positive
correlation with severity of motor impairment, while it decreases
after the intake of dopaminergic medication .
2.3.3. Tremor power and maximum peak power
An increased cortico-muscular coherence during tremor has
been observed within (3–7 Hz) frequency range in the motor network . In our study, we extracted both
the total power and the maximum peak power in (3–7 Hz) to index
the tremor state.
2.3.4. Hjorth parameters
The Hjorth parameters of a signal describe its statistical characteristics in the time domain and are commonly used in EEG studies
 . These parameters include the activity, mobility, and
complexity. While the Hjorth activity indicates the signal variance,
mobility is a measure of the average frequency. Furthermore, the
variations in frequency within a given time period are presented
by the Hjorth complexity.
L. Yao et al. / Clinical Neurophysiology 131 274–284
2.3.5. Gamma power
Multi-site LFP recordings from STN have shown an increased
low gamma oscillation (31–45 Hz) during strong tremor periods
 , suggesting that low gamma might be a
pertinent feature for tremor detection. We further included the
gamma power in a higher frequency band (60–90 Hz) previously
reported in STN LFPs , and the high
gamma (100–200 Hz) power that has been reported in macaque
local ﬁeld potentials .
2.3.6. Wavelet entropy
The wavelet entropy can be used to analyze the transient features of a non-stationary signal, while estimating the degree of
order or disorder of the signal . It has been a useful tool to analyze EEG signals, and given the difference of power
spectrum within tremor and non-tremor states, we hypothesized
that the associated wavelet entropy might be a useful feature for
tremor detection.
2.3.7. Low and high beta power
The beta (13–30 Hz) power measured in the cortex and STN is
reduced during resting tremor . Furthermore, the low beta (13–20 Hz) power signiﬁcantly decreases in the on-state following the administration of
apomorphine and levodopa . We included both
low and high beta features in our study.
2.4. Correlation analysis
We used a biserial correlation coefﬁcient to
quantify the correlation of each feature with the labeled tremor.
This coefﬁcient measures the ratio between the absolute difference
of the group means (tremor and non-tremor) and the pooled standard deviation of the two classes. The maximum correlation coef-
ﬁcient of the three bipolar channels was used to represent the
correlation of each feature with tremor.
2.5. Kalman ﬁltering
The Kalman ﬁlter has been extensively used to track the state of
a system based on the model of its dynamics and noisy measurements over time. This approach minimizes the variance of the estimation error, thus effectively reducing the undesired ﬂuctuations
of the measured data .
In tremor detection for PD, the noisy ﬂuctuations of the measured
Neurophysiological biomarkers for resting tremor detection.
Description
1. Low Beta
Spectral power in (13–20 Hz) 
Spectral power in (31–45 Hz) 
Spectral power in (60–90 Hz) 
Spectral power in (100–200 Hz) 
6. Low HFO
Spectral power in (200–300 Hz) 
7. High HFO
Spectral power in (300–400 Hz) 
8. HFO Ratio
Power ratio of HFO in (200–300 Hz) and (300–400 Hz)
 
Phase-amplitude coupling between the phase of beta (13–
30 Hz) and the amplitude of HFO (150–400 Hz) 
10. Tremor
Spectral power in (3–7 Hz)
The peak power in (3–7 Hz)
12. Wavelet
Wavelet entropy 
13. Hjo Act
Hjorth activity 
14. Hjo Mob
Hjorth mobility 
15. Hjo Com
Hjorth complexity 
Fig. 2. (a) Tremor labeling based on acceleration signal, (b) the corresponding LFP. The red curve shows the envelope of the ﬁltered acceleration around the tremor frequency,
while the two vertical lines deﬁne the non-tremor period as baseline for threshold setting. The horizontal black line represents the threshold to separate the tremor and nontremor periods; (c) Time-frequency decomposition of the acceleration signal, (d) and corresponding LFP (the y-axis is displayed in log scale). The color bars on the right
indicate the log of the absolute power.
L. Yao et al. / Clinical Neurophysiology 131 274–284
local ﬁeld potentials and the associated features may degrade the
tremor detection performance. As illustrated in Fig. 3, we applied
a Kalman ﬁlter of second-order to reduce the noise in feature time
series and obtain a smoothed feature following Kalman ﬁlter. We
expected that this approach would lower the rate of false positive
detections and improve the overall decoding performance. A brief
summary of the ﬁltering process is provided
Assuming that
represents the state vector vk, where _dk
denotes the derivative of dk, the feature vector f k is described by
the following state-space model:
  vk þ uk
where Tp shows the time interval of the prediction and wk represents the process disturbance, assumed to be a white noise of zero
mean and covariance of:
The Kalman ﬁlter is applied to the model in (1) to recursively
provide an estimate bdk of dk. Next, the obtained smoothed variable
bdk is utilized in place of f k as input to our machine learning model.
The standard deviations rw of wk and ru of uk are the required
parameters for Kalman ﬁltering, while the Kalman gain depends
on r ¼ rw=ru, which is set to 5  105 in this design .
2.6. Classiﬁcation and performance assessment
In order to detect the tremor episodes from extracted features,
we evaluated the performance of different machine learning models and performed a hyperparameter tuning of classiﬁers in a
patient-speciﬁc manner to determine the optimal settings. These
models include the commonly used classiﬁcation algorithms such
as logistic regression (LR), support vector machines based on linear
or RBF kernels (SVM-L, SVM-R), linear discriminant analysis (LDA),
multilayer perceptron (MLP), K-nearest neighbors (KNN), and more
recent models such as extreme gradient-boosted trees (XGB) and
random forest (RF). The decision tree ensembles and random forest) have been among
the winning classiﬁers in ML challenges in recent years, performing
remarkably well on small training datasets . We further examined the performance of ML
algorithms that do not rely on handcrafted features or domain
knowledge, such as convolutional neural network (CNN) . We used a compact CNN previously employed for
EEG classiﬁcation . The CNN model was
implemented using the AlexNet architecture of TensorFlow, with
three convolutional layers, three average pooling layers, and a softmax output layer. During model training, a 32-samples input batch
was fed to the CNN in each iteration and the weights were updated
by backpropagation. Multiple iterations were conducted until a
stable cross-validation score was obtained.
Here, all the features described in Table 1 were used for classi-
ﬁcation. We used a block-wise approach to partition the LFP
recordings into training and test sets and to minimize the risk of
data leakage. Each recording was ﬁrst divided into twenty blocks
of equal size. A ﬁve-fold cross-validation (CV) was subsequently
applied, i.e., in each round, 80% of the LFP blocks were used to train
the model and the rest to validate the performance. The results of
ﬁve rounds were then averaged to assess the overall predictive
performance. Given the unbalanced distribution of tremor/nontremor episodes in our dataset, we measured the performance of
classiﬁers by F1 score, sensitivity, and speciﬁcity, rather than accuracy. The F1 score is deﬁned as 2  SensitivityPrecision
SensitivityþPrecision, indicating the
harmonic mean of the sensitivity and precision. It ranges from 0
to 1 with higher values representing better performance (precision
is the fraction of true positive detections to the total positive detections returned by the classiﬁer).
2.7. Feature importance
Following model selection, we evaluated the predictive performance of features for the top performing classiﬁer (XGB, as later
shown in Section 3.2) to assess the relative feature importance
and potentially reduce the feature computation overhead. Here, a
sequential feature selection (SFS) method was utilized . The algorithm ﬁrst evaluates all
single-feature subsets to ﬁnd the most predictive biomarker. In
each subsequent iteration, the performance of the previous subset
combined with a new element from the remaining feature set is
investigated to ﬁnd the next ‘‘best feature”, using F1 score measured by 5-fold CV . The algorithm continues to
successively add new features and update the subset until all features are analyzed.
2.8. Detection latency
In addition to detection rate, the timing of stimulation in adaptive DBS is also critical for modulation to be effective, and to be used
as a reliable alternative for conventional DBS. In this work, the
latency in tremor detection is measured with reference to the
labeled tremor onset, showing how early ahead (or late) a detection
is raised by the model. To measure the latency of classiﬁers, we
deﬁne tr as the onset of tremor based on the labeled acceleration
with the following conditions: (1) the state changes from nontremor to tremor at tr; (2) the next consecutive state starting at
tr þ w=2 is also labeled as tremor, where w represents the window
size and w=2is the overlap. Similarly, we deﬁne tp as the predicted
onset of tremor based on the output of classiﬁer, with the following
two criteria: (1) the predicted state changes from non-tremor to tremor at tp; (2) the subsequent state starting at tp þ w=2 is predicted
as tremor. Then, the latency is calculated by tp  tr based on the
nearest prediction within a range of 4 s around tr, as shown in Fig. 4.
In the current dataset, some patients exhibit continuous
tremor-like activity, lacking a clear transition from the non-
Fig. 3. Kalman ﬁltering in feature space. The blue curve represents the original
feature (low HFO power), while the red curve shows the corresponding feature
following Kalman ﬁltering.
L. Yao et al. / Clinical Neurophysiology 131 274–284
tremor to tremor state. For latency analysis, we chose those
patients who had at least one clear tremor onset (tr) and one correctly detected tremor onset (tpÞ as described above. With this condition, 7 patients (9 recordings) were included in our latency
analysis. The average detection latency of individual patients is
used to quantify the overall latency.
2.9. Statistical analysis
We used a one-way repeated measures ANOVA to compare the
correlation coefﬁcient among biomarkers (15 levels corresponding
to the features in Table. 1), to compare the F1 score for different
channel conﬁgurations (3 levels: monopolar, bipolar between adjacent channels , and bipolar ), and to compare the F1 score for different window sizes and overlapping (6
levels: 2 s without overlap, 2 s with half overlap, 1 s without overlap, 1 s with half overlap, 0.5 s without overlap, and 0.5 s with half
overlap). In addition, a two-way ANOVA with repeated measures
was applied to study the impact of Kalman ﬁltering (2 levels: with
and without Kalman ﬁlter) and classiﬁers (8 levels: LDA, LR, KNN,
SVM-L, SVM-R, MLP, RF, and XGB) on the classiﬁcation performance. We used the IBM SPSS Statistics Version 22 for the statistical analyses presented here. Mauchly’s test for sphericity was
performed for repeated measures and in cases where the sphericity
assumption was violated, the results were Greenhouse-Geisser
corrected. Multiple comparisons with Bonferroni correction were
used for post-hoc comparison when the main effect was signiﬁcant
(p < 0.05).
3. Results
3.1. STNr LFP biomarkers for quantifying resting tremor
Fig. 5 depicts the correlation coefﬁcient of each feature with tremor. The one-way ANOVA with repeated measures showed a signiﬁcant
difference
electrophysiological
biomarkers
(Greenhouse-Geisser
(5.0,75.0) = 6.4,
p < 0.0001), and the Hjorth complexity exhibited a higher correlation with tremor compared to other features. No signiﬁcant difference was observed between low beta vs. high beta (p = 0.72),
neither between low and high HFO (p = 0.84), in our dataset.
3.2. Kalman ﬁltering to enhance the speciﬁcity
Fig. 6 compares the classiﬁcation performance of different ML
models using the feature set in Table 1, and the effect of Kalman
ﬁltering. For F1 score, a two-way repeated measures ANOVA
(1,15) = 4.19,
p = 0.058) and a signiﬁcant effect of classiﬁers (Greenhouse-
Geisser corrected F (1.3,18.8) = 5.37, p = 0.026) with no interaction.
For the sensitivity measure, the classiﬁers showed a signiﬁcant
main effect (Greenhouse-Geisser corrected F (1.4,20.4) = 5.02,
p = 0.027), while all classiﬁers except KNN showed comparable
performance. For the speciﬁcity measure, the two-way repeated
measures ANOVA showed a signiﬁcant main effect of Kalman ﬁlter
(F (1,15) = 14.62, p = 0.002) and of ML models (Greenhouse-Geisser
corrected F (2.7,40.8) = 3.83, p = 0.019) with no interaction. Moreover, the Kalman ﬁltering resulted in a 17.0% higher speciﬁcity
compared to the cases without Kalman ﬁltering. The XGB classiﬁer
obtained the highest F1 score (84.0% ± 10.8%) and sensitivity
(89.2% ± 12.0%),
speciﬁcity
(59.6% ± 23.1%) on this dataset. The tremor detection performance
for each recording based on the XGB model is shown in Table 2.
The CNN classiﬁer obtained an F1 score of 77.1% ± 18.3%, sensitivity
of 81.7% ± 20.1%, and speciﬁcity of 37.8% ± 30.1%. Fig. 7 depicts the
performance of CNN while increasing the number of training
epochs to the network. On average, the performance reached its
maximum value after 10 training epochs.
Using Kalman ﬁlter and XGB, the simulated classiﬁcation results
for three representative LFP recordings are illustrated in Fig. 8,
showing a reasonable detection of tremor state. Speciﬁcally, for
patients with prolonged episodes of weak or strong tremor
(Fig. 8(a)), the proposed method can reliably detect the presence
of tremor in the majority of cases. Our approach was also effective
on recordings with a single prolonged tremor (Fig. 8(b)) while raising a number of false positives for small motions during the non-
Fig. 4. Latency calculation in an example patient. The time difference between the
onset of classiﬁer output (tp) and the onset of labeled tremor (tr) is deﬁned as
detection latency.
Fig. 5. Correlation coefﬁcients of features with tremor. For each feature, the
channel with the maximum correlation coefﬁcient has been used. The error bars
indicate the standard error.
Fig. 6. Performance of different classiﬁers in tremor detection, with and without
Kalman ﬁltering. The performance is measured by F1 score, sensitivity, and
speciﬁcity. The error bar indicates the standard error.
L. Yao et al. / Clinical Neurophysiology 131 274–284
tremor state. Finally, for recordings with a high tremor prevalence
(Fig. 8(c)), the algorithm could reliably detect the tremor episode.
3.3. Other design parameters
In addition to the type of classiﬁer and features, the other
parameters that may affect the classiﬁcation performance include
the window size, sampling rate, and channel conﬁguration, which
are discussed in the following. We further investigated the optimal
number of features that led to the highest classiﬁcation performance. For the following analysis, we use XGB combined with Kalman ﬁlter, as it showed a superior performance in tremor
detection.
3.3.1. Window size and overlapping
The classiﬁcation performance and latency for different window
lengths and overlaps are depicted in Fig. 9(a)-(d). Here, we
observed a nearly similar performance in terms of F1 score
(Greenhouse-Geisser corrected F (2.7,39.7) = 0.43, p = 0.71). As
expected, shorter windows and the use of overlapping improved
the detection latency. Overall, the 1-second window with half
overlapping achieved a reasonable trade-off between detection
performance and latency.
3.3.2. Bipolar and monopolar channel conﬁgurations
The performance and detection latency for the monopolar and
two bipolar conﬁgurations using a 1-second window and half
overlapping are shown in Fig. 9(e). The one-way ANOVA with
repeated measures showed no signiﬁcant difference in terms of
(Greenhouse-Geisser
(1.5,22.3) = 1.74,
p = 0.20) among the three conﬁgurations. Moreover, by only using
the 0–2 or 1–3 bipolar channel for classiﬁcation, no signiﬁcant
deterioration in performance was observed. The monopolar conﬁguration led to a lower detection latency, but it was not signiﬁcant.
Tremor detection performance for each recording using the XGB classiﬁer. Here, K and N denote the performance with and without Kalman ﬁltering.
Recording index
F1 Score (%)
Sensitivity (%)
Speciﬁcity (%)
77.1 ± 18.3
84.0 ± 10.8
83.9 ± 20.8
89.2 ± 12.0
32.7 ± 29.8
50.4 ± 31.4
Fig. 7. Performance of compact CNN on the training and validation sets across
consecutive training epochs. The gray area indicates the standard error across
Fig. 8. Examples of tremor detection on three sample LFP recordings. The bipolar
LFP, measured acceleration, labeled tremor, and classiﬁer output are shown. The
binary output of XGB classiﬁer that is built upon LFP features successfully tracks the
episodes of tremor.
L. Yao et al. / Clinical Neurophysiology 131 274–284
Considering that in practice, a bipolar conﬁguration would limit
the impact of stimulation artifact by canceling it as a commonmode input, we opted to use the bipolar method in this work.
3.3.3. Sampling rate
Although we used a high sampling rate to capture the
high-frequency content in LFPs, this may increase the hardware
complexity and power dissipation of the processing circuitry. To
study the effect of sampling rate, we reduced the date rate to
512 Hz and excluded the HFO-based features (low HFO, high
HFO, HFO ratio, PAC) from our analysis. We observed that the performance slightly degraded at lower sampling rates (F1 score of
84.0% ± 11.2%,
sensitivity of
88.6% ± 13.3%,
speciﬁcity
49.5% ± 35.0%).
3.3.4. Optimal number of biomarkers
In order to reduce the feature count and assess the importance
of different biomarkers in the overall classiﬁcation performance,
the number of input features to the XGB model was successively
increased based on the SFS method, as depicted in Fig. 10. We
observed that performance can be further improved by optimally
selecting as low as only ﬁve features or less, from each patient.
For equal number of features, the F1 score with Kalman ﬁltering
was generally higher than the case without Kalman ﬁlter. This ﬁgure shows that the average F1 score for the XGB model can reach
88.7% ± 8.5%, which is 8.3% higher compared to using all 45
features. The detection latency for this optimal setting was
0.52 ± 1.14 s (i.e., detection lead of 0.52 ± 1.14 s). The most discriminative features using the SFS method and XGB classiﬁer are
outlined in Table 3 for each LFP recording. The stopping criterion
The top performing features with XGB model.
Most discriminative features
High Gamma, Low Beta, Hjo Com
High Beta, Gamma, Hjo Act, Low Beta
High Gamma
Tremor Power, High Beta, HFO Ratio, Max Power, Wavelet
Hjo Com, HFO Ratio, High HFO
HFO Ratio, Wavelet Ent, Low Gamma, Hjo Com, High HFO
Gamma, High HFO, HFO Ratio
High Gamma, HFO Ratio, Hjo Com
High HFO, PAC, Low HFO, Tremor Power
High Gamma, Gamma
Gamma, Low Beta, High HFO
Hjo = Hjorth, Act = Activity, Mob = Mobility, Com = Complexity.
Fig. 9. Performance for different window sizes and overlaps; (a) F1 score, (b) sensitivity, (c) speciﬁcity, and (d) latency; (e) Performance for monopolar and bipolar
conﬁgurations with a 1-s window and half overlap, and the boxplot of the corresponding latency on the right axis.
Fig. 10. The grand-averaged classiﬁcation performance with respect to number of
features using the sequential feature selection method. The arrow shows the setting
that leads to the highest performance on average, using the same XGB model for all
patients. The gray area indicates the standard error across patients.
Fig. 11. Distribution of the number of times a feature is selected across patients. A
subject-speciﬁc number of features is used for each patient (min 1, max 5). Features
selected from more than one channel in a patient are counted as one.
L. Yao et al. / Clinical Neurophysiology 131 274–284
is when adding a new feature improves the F1 score by less than
1%, with a maximum of 5 features selected in each case. With this
process, the distribution of selected features for the patients in our
dataset is shown in Fig. 11, in which the high beta, low HFO, high
HFO, and Hjorth parameters are among the most commonly
selected features. While the correlation analysis did not show
any signiﬁcant difference between the low and high beta features,
the latter is more frequently selected as an important feature for
tremor detection in this study.
4. Discussion
In this work, we systematically analyzed the neurophysiological
biomarkers in the STNr LFP in a machine learning framework, with
the goal of accurately detecting resting tremor in PD. To the best of
our knowledge, this is the ﬁrst use of Kalman ﬁltering as a post feature processing approach to enhance tremor detection performance.
signiﬁcant
speciﬁcity for all the studied classiﬁers. The enhancement of speci-
ﬁcity is critical to limit the number of false positive detections and
thereby to minimize DBS power consumption and side effects.
4.1. The choice of feedback signal
To detect the onset of tremor from local ﬁeld potentials, we
need to properly identify and label tremor episodes for model
training. Here, we placed a peripheral accelerometer sensor on
patients’ hands to measure their tremor intensity. Then, we
adopted a thresholding method to separate the tremor and nontremor periods, similar to the methods used elsewhere . As an
alternative feedback signal, the tremor severity measured by
peripheral sensors or surface EMG could be used to control DBS.
For example, the peripheral measurements of the tremulous limb
have been utilized to guide the stimulation and suppress tremor
 . However, this
approach may impose an additional requirement on patient compliance , as well as
security concerns for wireless telemetry between the implant
and the wearable sensor. To implement adaptive DBS, the combination of informative biomarkers based on neuronal activity ) may be preferred as they directly reﬂect brain activities that may underlie
symptoms . For example,
the cortical narrow gamma (60–90 Hz) oscillations pertaining to
dyskinesia have been used to control DBS ,
while reducing energy consumption by 38% to 45% and maintaining therapeutic efﬁcacy. Ideally, a combination of both depth and
cortical biomarkers may provide a more precise and/or reliable
approach for the closed-loop control of DBS and enable the targeting of multiple PD symptoms . For instance,
cortical biomarkers could be used in place of the low-amplitude
STN HFOs that are difﬁcult to detect in the presence of stimulation
artifact , while these sensitive STN biomarkers could accurately detect the onset of tremor (as shown in this
work) and activate DBS in the ﬁrst place. The advantage of our proposed framework is that a handful of most relevant biomarkers can
be selected in a patient-speciﬁc manner and combined with powerful classiﬁcation algorithms, without the need to prioritize and
threshold a single depth or cortical biomarker that could, in turn,
sacriﬁce the efﬁcacy or energy efﬁciency of the adaptive DBS.
In addition to detection performance, the physical and practical
constraints of the system should be carefully considered when
choosing the feedback signal for aDBS, such as the need for additional implants, any required changes in the surgical procedure,
and patient comfort and compliance . Our current study is based on LFPs in STNr, with the advantage that no
additional implant is needed and no change in the standard surgical
biomarkers
extracted from the LFP may allow for the better personalization
and adaptability of therapy to account for inter-subject variability.
4.2. Features, classiﬁers, and Kalman ﬁlter
Multiple LFP biomarkers and a feedforward neural network
were previously used for resting tremor detection , achieving a classiﬁcation accuracy of over 86% in 4
out of 8 patients. However, due to the unbalanced duration of
tremor/non-tremor episodes in most patients, the classiﬁcation
accuracy may not be appropriate for quantifying the performance.
In the current study, we further demonstrated the possibility of
successful tremor detection on 12 patients with diverse tremor
characteristics and durations, using relevant biomarkers in the
STNr LFP, state-of-the-art ML models, and Kalman ﬁltering. If we
instead apply a median threshold to beta power only, similar to
most prior studies, the F1 score, sensitivity and speciﬁcity dropped
to 49.6% ± 9.9%, 44.7% ± 9.0% and 47.3% ± 24.04%, respectively.
Moreover, using the HMM model on
our feature set, we obtained an F1 score of 56.3% ± 15.5%, sensitivity of 48.2% ± 16.4% and speciﬁcity of 55.5% ± 23.6%, while Kalman
ﬁlter is not effective in this case. The CNN model with embedded
feature learning led to an F1 score of 77.1% ± 18.3%, sensitivity of
81.7% ± 20.1%, and speciﬁcity of 37.8% ± 30.1%. Therefore, our
feature-engineered approach showed a superior performance in
the current dataset. In general, while deep learning models obtain
an outstanding performance on large and unstructured datasets
such as provided by imaging, they may not be optimal for problems with limited training data .
In this work, we used the Hjorth parameters for tremor analysis
in PD . Interestingly, the Hjorth complexity, which
is a measure of the change in frequency, showed a higher correlation with tremor compared to other features. The underlying neurophysiological mechanism that contributes to the correlation of
Hjorth complexity with tremor may be worth further study. The
use of Kalman ﬁlter in feature space was motivated by prior studies
on epileptic seizure detection and emotion
classiﬁcation from EEG . In this work, the Kalman ﬁlter improved the tremor detection performance of different
classiﬁers, by reducing the noisy ﬂuctuations of the features. Due to
the inherent noise in the neural system and the corresponding LFP
recordings, a second-order Kalman ﬁlter provided a suitable way to
model this noisy activity, thereby successfully tracking the tremor
state. The Kalman ﬁlter offers the potential beneﬁt of enhancing
the detection speciﬁcity without degrading the sensitivity of the
classiﬁer, thus improving the energy efﬁciency in aDBS. Furthermore, we tested the potential use of Kalman ﬁlter after classiﬁcation, which proved to be less effective compared to ﬁltering in
feature space for tremor detection.
The classiﬁcation results in Fig. 8 show that our algorithm performs well on typical patients that have sustained tremor periods.
For patients with shorter tremor episodes, our algorithm raises a
number of false positives. In this work, we used Kalman ﬁltering
to lower the number of false positives and achieved 17% improvement in speciﬁcity on average. The other potential approach to
limit the false positive rate is to increase the number of successive
detections required to deﬁne tremor, e.g., by deﬁning tremor onset
after three positive detections. Although we have largely improved
speciﬁcity by the use of Kalman ﬁltering, this is still a remaining
challenge for adaptive DBS and needs to be addressed in future
L. Yao et al. / Clinical Neurophysiology 131 274–284
4.3. Channel conﬁguration
Considering that in a closed-loop approach, the DBS electrodes
would be used for both sensing the neural activity and stimulation,
this would unavoidably cause a strong stimulation artifact at the
recording site. The bipolar conﬁguration provides a way to reduce
this effect, by partially canceling the common-mode artifact component. In this work, we compared the classiﬁcation performance
of monopolar and two bipolar conﬁgurations, and no signiﬁcant
difference was found in the absence of stimulation. Our analysis
showed that a single bipolar combination (0–2 or 1–3) leads to a
comparable performance, which could further reduce hardware
complexity. To minimize the potential impact of stimulation artifact on the classiﬁer performance, we also tested our algorithm
by excluding the high-gamma feature (100–200 Hz), and the
results showed no signiﬁcant decline in performance. More
advanced circuit techniques will be explored to suppress the artifact both at the input of ampliﬁers and digitally in the back-end,
in order to enable a robust implementation of adaptive DBS in
4.4. Limitations and future work
In the current approach for labeling the data, we visually identiﬁed a low-activity time period as baseline. Then, a threshold was
empirically set by calculating the average and standard deviation
for the baseline. However, we had to slightly adjust the threshold
in some patients to avoid the abrupt transitions in labels due to
noise or artifact in the acceleration signal. Alternatively, the
accelerometer could be combined with other methods such as
video recording and EMG sensing in order to more reliably deﬁne
and label the tremor episodes for model training.
It has been previously shown that amplitude-responsive aDBS
decreases the total energy delivered to the tissue by ~130 mW per
side, while the energy dissipated by a single-channel power
classiﬁer is of the order of 10 mW . Through
system-on-chip integration in modern CMOS technologies, power
dissipation in the range of sub-microwatt per channel has recently
been reported for epileptic seizure detection ,
and a very low energy of 41.2nJ/class for computing 12 features
with an XGB classiﬁer . Moreover, while a
high voltage compliance is required for stimulation, recording
can be reliably done at a lower supply voltage. Considering that
sensing, feature computation, and classiﬁcation could be performed with low energy, aDBS could potentially save total battery
usage, in addition to the saving in energy delivered to the tissue
through stimulation (and thereby the reduction in side-effects).
The actual computational overhead and energy consumption for
the proposed algorithm needs to be investigated and compared
with the potential saving in stimulation energy. An optimal sampling rate that enables a good trade-off between detection accuracy and energy should be further explored. Moreover, the
performance in this study was evaluated ofﬂine, while an online
evaluation of the proposed approach should be performed to further validate its efﬁcacy in real-time and during closed-loop operation. The effect of stimulation artifact on the tremor detection
circuitry should be studied in order to efﬁciently integrate this
method into the DBS system.
Efﬁcient integration of multiple biomarkers and advanced control algorithms could potentially improve the therapeutic efﬁcacy
of aDBS . Although
aDBS has mostly been realized using external devices this is not
exclusively the case. Medtronic’s implantable research system,
the Activa PC + S, has been used for neural recording and stimulation in essential tremor and PD, and for acute trials of aDBS in
Parkinson’s . The investigational Summit RC
+ S (Medtronic) embeds basic spectral analysis algorithms and an
LDA classiﬁer. The design of a low-power and miniaturized ASIC
integration
extraction,
advanced classiﬁcation, and stimulation could enable high quality,
low-noise recording and more effective intervention, and remains
a future goal. Also, while the use of multiple biomarkers may
account for inter-subject variability, more research is required to
translate this approach into an effective personalized therapy.
Here, as a proof-of-concept, we demonstrated our approach in
the form of a binary classiﬁer that could activate an on-demand
stimulator. However, it is also possible to use this framework in
a truly adaptive manner, by predicting the tremor strength using
a regressor or a multi-class machine learning method to adaptively
control the stimulation amplitude. Finally, we limited our analyses
to Parkinsonian rest tremor, and the confounding effects, if any, of
voluntary movement remain to be investigated, as does the detection of Parkinsonian action or postural tremor.
5. Conclusion
In this work, we evaluated a number of neurophysiological
biomarkers in the LFP signal from the STNr, and various classiﬁcation algorithms to detect resting tremor episodes in Parkinson’s
disease. By combining a powerful machine learning model with
relevant patient-speciﬁc features in the LFP, and using Kalman ﬁltering, we achieved an average F1 score of 88.7% and detection lead
of 0.52 s. This work demonstrates the potential use of a more accurate ML-based approach for resting tremor detection and adaptive
DBS control in Parkinson’s disease.
Acknowledgement
We thank Bingzhao Zhu at Cornell University for his contribution
to feature importance analysis and valuable comments.
Declaration of Competing Interest