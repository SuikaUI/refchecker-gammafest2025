STATISTICS IN MEDICINE
Statist. Med. 2009; 28:1108–1130
Published online 30 January 2009 in Wiley InterScience
(www.interscience.wiley.com) DOI: 10.1002/sim.3533
Mediation analysis with principal stratiﬁcation
Robert Gallop1,∗,†, Dylan S. Small2, Julia Y. Lin3, Michael R. Elliott4, Marshall Joffe5
and Thomas R. Ten Have5
1Department of Mathematics, Applied Statistics Program, West Chester University, 323B Anderson Hall,
West Chester, PA 19383, U.S.A.
2Wharton School of Business, University of Pennsylvania, PA, U.S.A.
3Center for Multicultural Mental Health Research, Cambridge Health Alliance, CA, U.S.A.
4Department of Biostatistics, University of Michigan, MI, U.S.A.
5School of Medicine, Department of Biostatistics and Epidemiology, University of Pennsylvania, PA, U.S.A.
In assessing the mechanism of treatment efﬁcacy in randomized clinical trials, investigators often perform
mediation analyses by analyzing if the signiﬁcant intent-to-treat treatment effect on outcome occurs
through or around a third intermediate or mediating variable: indirect and direct effects, respectively.
Standard mediation analyses assume sequential ignorability, i.e. conditional on covariates the intermediate
or mediating factor is randomly assigned, as is the treatment in a randomized clinical trial. This research
focuses on the application of the principal stratiﬁcation (PS) approach for estimating the direct effect
of a randomized treatment but without the standard sequential ignorability assumption. This approach is
used to estimate the direct effect of treatment as a difference between expectations of potential outcomes
within latent subgroups of participants for whom the intermediate variable behavior would be constant,
regardless of the randomized treatment assignment. Using a Bayesian estimation procedure, we also
assess the sensitivity of results based on the PS approach to heterogeneity of the variances among these
principal strata. We assess this approach with simulations and apply it to two psychiatric examples.
Both examples and the simulations indicated robustness of our ﬁndings to the homogeneous variance
assumption. However, simulations showed that the magnitude of treatment effects derived under the PS
approach were sensitive to model mis-speciﬁcation. Copyright q
2009 John Wiley & Sons, Ltd.
KEY WORDS:
principal stratiﬁcation; mediating variables; direct effects; principal strata probabilities;
heterogeneous variances
∗Correspondence to: Robert Gallop, Department of Mathematics, Applied Statistics Program, West Chester University,
323B Anderson Hall, West Chester, PA 19383, U.S.A.
†E-mail: 
Contract/grant sponsor: National Institute of Mental Health (NIMH); contract/grant number: R01MH-078016
Received 25 January 2008
Copyright q
2009 John Wiley & Sons, Ltd.
Accepted 11 December 2008
MEDIATION ANALYSIS WITH PRINCIPAL STRATIFICATION
1. INTRODUCTION
We present a principal stratiﬁcation (PS) model approach for investigating whether a randomized baseline intervention effect on a continuous outcome occurs around a post-randomization
binary intermediate factor (direct effect) in the context of randomized behavioral health trials.
Estimating such an effect is the part of a mediation analysis of whether the effect of treatment is
through or around the intermediate factor (e.g. ).
An assumption that is commonly made for standard mediation analysis methods (e.g. ) is
the untestable, no unmeasured confounding assumption for the intermediate factor, illustrated in
Figure 1. Therefore, it is assumed that there is no extraneous variable that inﬂuences both the
mediator and the outcome. If such variables were present, then an assessment of direct effect of
treatment would require some adjustment due to the inﬂuence of the confounding variable.
This assumption is equivalent to randomization of the baseline intervention and of subsequent
intermediate variables (i.e. a strong form of ‘sequential ignorability’; e.g. ). Because intermediate
factors are typically not randomized, we use the PS approach as one way of relaxing the sequential
ignorability assumption by imposing model constraints.
The PS model stratiﬁes the population into latent classes or principal strata based on the
potential values of the mediator variable under the randomized treatment assignment. Because
these principal strata are based on potential outcomes for the mediator under different randomized
treatment conditions for each individual, treatment effects on outcome within each principal strata
can be interpreted causally . In noncompliance to treatment assignment settings, PS models
have been used to estimate the effects of the randomized treatment assignment on outcome (i.e.
intent-to-treat (ITT) effects) within separate principal strata based on potential compliance behavior
under each randomization assignment (e.g. ).
In the context of mediation, Rubin and Mealli and Rubin noted that direct effects
corresponded to the ITT effects on outcome in those principal strata for which the potential
mediator level is constant when the treatment is varied. We will assess such a model with examples
applied to the example data sets and with simulations. In addition, we will consider this model
with heterogeneous variances to assess the robustness of the PS mediation approach to the constant
variance assumption made previously (e.g. ).
Confounder
Randomized
Assignment
Direct Effect
Figure 1. Mediation process.
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
R. GALLOP ET AL.
Other causal approaches have been proposed to estimating direct effects without the sequential
ignorability assumption. Ten Have et al. proposed a rank preserving model with weighted
G-estimation to investigate direct effects for the complete sample in contrast to within speciﬁc
principal strata under consideration in this paper. Dunn and Bentall proposed an analogous
instrumental variable approach to estimating direct effects. We apply the PS approach to the
data sets analyzed in Ten Have et al. , and make some comparisons with the results from the
rank-preserving model.
We consider two examples for which we want to investigate the direct effect of treatment. The
ﬁrst sample, a suicide therapy study, reported in Brown et al. consists of 101 adults who
attempted suicide. These patients were evaluated within 48 h of the suicide attempt as well as at
the conclusion of 6 months of treatment. Patients were randomized to cognitive behavioral therapy
(CBT) or usual care (TAU). In addition to receiving the counseling services available through
the treatment regimen, some patients sought additional therapy outside the study. The primary
outcome of interest was the depression as measured by the Beck depression index (BDI) at the end
of the 6 months of treatment . We investigate whether or not outside non-study therapy may
be mediating the signiﬁcant ITT effect of the CBT on 6 months depression. The second sample, a
suicide prevention study, reported in Bruce et al. consists of 297 patients who were randomized
to family practices either consisting of depression specialist (DS) versus those family practices that
do not. In addition to receiving the services provided in their family practice, some patients took
medication for their depression. The primary outcome of interest for this sample is their depression
as measured by the Hamilton depression scale (HRSD) at 4 months post-randomization .
In this example, it is of interest to investigate whether or not receiving additional medication may
be mediating the signiﬁcant intent-to-treatment effect of the randomized DS in the primary care
The remainder of the paper is organized as follows. In Section 2, we present the PS model
with particular focus on estimating direct effects within certain principal strata and also the
accommodation of heterogeneous variances and inclusion of covariates. In Section 3, we consider a
simulation to assess the validity and robustness of our estimation strategy. In Section 4, we discuss
the estimation of PS model-based direct effects in certain principal strata for the two example data
sets with a comparison to a standard regression approach to estimating direct effects for the whole
sample, assuming sequential ignorability (e.g. ). We also assess sensitivity of the PS approach
to homogeneous variance assumptions. In Section 5, we provide some concluding remarks.
2. PS MODEL
In this section, the PS model estimates direct effects as ITT effects conditional on the principal
strata. The model is presented ﬁrst in terms of the potential outcomes approach . Estimation
is achieved in a subsequent section by translating to an equivalent model for the observed outcomes
conditional on principal strata.
2.1. Notation
Notation for the observed and potential outcome below suppresses the patient index i for simplicity.
The observed variables include the mediator variable, D, the randomized treatment assignment
variable, R, and a vector of observed baseline covariates X. The mediator, D, is deﬁned as taking
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
MEDIATION ANALYSIS WITH PRINCIPAL STRATIFICATION
the mediator (D =1) or not (D =0). The treatment assignment, R, is deﬁned as treatment (R =1)
or control (R =0).
For causal interpretations of the ITT effects within each principal strata, we deﬁne potential
variables corresponding to the observed variables, D and Y, the outcome variable, under each
randomization assignment. The notation Dr corresponds to the mediator value when R =r. With
binary r, there are two separate potential mediator variables: D0 and D1. D1 is the mediator
variable that would be observed if a subject were randomized to the treatment, and D0 is the
mediator variable if the same participant were randomized to the control group. Similarly, we
deﬁne the potential outcome Yr as the outcome that would be observed if a given patient were
randomized to level r. There are two separate potential outcome variables: Y0 and Y1. Y1 is the
outcome variable that would be observed if a subject were randomized to the treatment, and Y0 is
the outcome variable if the same participant were randomized to the control group. With these two
potential outcome variables, we can deﬁne the causal contrasts for the direct effect of the baseline
intervention within certain principal strata.
2.2. Principal strata
Under the PS approach applied to the mediation context, we focus on the ITT effects in two
of the four principal strata formed by the potential behavior of a binary mediator with a binary
randomized treatment assignment. For the ﬁrst principal stratum, compliant mediators, all subjects
in this principal stratum exhibit the positive mediator behavior when assigned to treatment but do
not exhibit the positive mediator behavior when assigned to the control group (D1 =1 and D0 =0).
The second principal stratum, always mediators, consists of subjects who regardless of treatment
assignment always exhibit the positive mediator behavior (D1 =1 and D0 =1). The third principal
stratum, never mediators, consists of subjects who regardless of treatment assignment never exhibit
the positive mediator behavior (D1 =0 and D0 =0). The fourth stratum, deﬁant mediators, is the
converse of the compliant mediating stratum; therefore, it consists of subjects who when assigned
to treatment do not exhibit positive mediator behavior, but when assigned to the control do exhibit
positive mediator behavior (D1 =0 and D0 =1).
For the PS model, no randomization assumptions for the mediator are required, since the potential
mediator behavior under each treatment assignment regardless of actual treatment assignment identiﬁes the principal stratum under certain model assumptions and covariate relationships (e.g. ).
Mediation analyses are then based on the ITT analysis within the never and always mediator strata.
Because the potential mediator level is constant within each of these principal strata, the separate
ITT effect of treatment within each of these strata is a direct effect.
2.3. PS model
Inference on the direct effect of the intervention holding the mediator constant is based on the ITT
effects of treatment within the always and never mediator strata. These ITT effects are deﬁned in
the following models for the outcome stratifying on the principal strata, as illustrated in Figure 2.
Figure 2 shows that for the always and never mediator strata, the pathway between treatment and
outcome does not include the mediator, because the potential level of the mediator is held constant
in these two strata. Given the principal strata are deﬁned on the basis of potential mediator behavior
under each randomization assignment, the ITT effects within these principal strata are causal in
that they are protected against unmeasured confounding of the mediator-outcome relationship.
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
R. GALLOP ET AL.
Figure 2. Mediation process with the four latent classes of the principal stratiﬁcation model.
A separate model is speciﬁed for each pair of potential outcomes Y for each principal strata,
where r takes on the values 1 for treatment and 0 for the non-treatment. Per strata, we have:
Yr =ITTtr +bT
The subscript t takes on the values 1, 2, 3, and 4 corresponding to the compliant mediating, always
mediating, never mediating, and deﬁant mediating principal strata, respectively. As addressed by
others (e.g. ), we note that the correlation between t0 and t1 is not identiﬁable from the data
under the proposed model and assumptions.
As an extension, we consider modeling separate variances within each principal strata. Therefore,
under this heterogeneity extension, we have:
tr ∼N(0,2
for t ∈{1,2,3,4}
The ITT effect for the tth principal stratum for subjects with covariates X then is
ITTt = E[Y1|X,C =t]−E[Y0|X,C =t]
where X is a vector of baseline covariates and C =t corresponds to the tth principal stratum.
The standard ITT effect for the population equals the weighted sum of the stratum-speciﬁc ITT
effects across all four strata with weights corresponding to probabilities of membership in each
principal stratum, t =Pr(C =t|X), where X are the baseline covariates, such that 4
t=1 t =1.
For notational simplicity, we will suppress the dependence of ITTt|X and t|X on X hereafter. We
model the t’s as functions of the baseline covariates with the following multinominal model:
t = P(C =t|X=x)=
t=1 exp =
t=1 exp(t)
Therefore, we have:
E[Y1−Y0|X=x,C =t]t
The direct effect of treatment corresponds to weighted sum of the ITT effect across the always
and never mediating strata and is computed as follows:
t=2 E[Y1−Y0|X=x,C =t]t
2.4. Assumptions
To be able to estimate the above parameters under the speciﬁed model, a number of assumptions are
needed: (1) the stable unit treatment value assumption (SUTVA); (2) randomization of treatment;
and (3) baseline covariate-randomization no-interaction assumptions.
The SUTVA assumption consists of two parts . First, there is a single value for each of
the potential random outcome variables Yr for a given patient regardless of the randomization
assignment of any other patient. Notationally, this assumption implies Yr is deﬁned with scalar
indices for a given patient, rather than vector indices representing baseline intervention levels for
all subjects. Second, there is a single value for each potential outcome random variable Yr for a
given patient regardless of the method of administration of the randomized baseline intervention,
such that for a given patient with observed level r for R
Y =rYr +(1−r)Y1−r
The randomization assumption implies that the treatment assignment and the potential outcome
variable at baseline are independent. That is, the treatment assignment is balanced with respect
to all observed and unobserved baseline confounders. A weaker form of this assumption requires
that the potential outcomes be independent of randomization given observed baseline covariates.
In this mediation model, we relax the exclusion restriction and monotonicity assumptions sometimes made under the PS Model (e.g. ). The exclusion restriction states that the ITT effect is
zero for different combination of always mediating and never mediating strata. Hence, no effect of
treatment when mediating behavior is constant. Without the exclusion restriction, we can estimate
direct effects as ITT effects in the never and always mediating strata. Monotonicity rules out the
existence of the deﬁant mediating stratum. Departures from monotonicity depend on whether there
is deﬁant behavior in the sample. In our mediation context, there are deﬁer individuals, who when
assigned to the control group would always not exhibit the positive mediator behavior, but when
assigned to treatment would always exhibit the positive mediator behavior. For example, in the
suicide therapy sample of 101 suicide patients, deﬁers would be people when assigned to TAU, the
control treatment would always seek outside therapy, and when assigned to the CBT group would
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
R. GALLOP ET AL.
always not seek outside therapy. These people would be observed as deﬁant mediators. This could
be evident for patients in TAU, who have been involved in previous treatments, quite similar to
the current TAU, and feel they are not getting substantially better and seek outside therapy to aid
their recovery, whereas for patients in CBT, the treatment may be entirely new where they feel the
treatment is appropriately delivered.
Relaxing this monotonicity assumption increases the dependence of our modeling approach
on the model assumptions and covariate-mediation behavior relationships (e.g. ). One model
assumption to which the PS approach may be sensitive is the constant variance assumption,
which we assess with the heterogeneous variance model. In addition, the PS approach depends
on relationships involving baseline covariates. Speciﬁcally, it assumes no interaction between the
baseline covariates, X, and the treatment assignment, R, within each principal stratum. Finally,
identiﬁability of the ITT effects within the principal strata is aided with covariates, X, which
predict and distinguish among these principal strata (e.g. ).
2.5. Estimation
Conditional on principal stratum under the above assumptions, the potential outcome models in
(1) are equivalent to the following model for the observed outcome Y:
Y|C =t, R =r,x∼N(ITTtr +cTx,2
We set ITTtr +cT
t X=tr, and deﬁne bt =[t0 t1 T], therefore, we have Y|C =t, R =r,x∼
t ). We let r and p represent the vector of principal stratum-speciﬁc variances and the
principal strata probabilities. We let b represent the matrix where the tth row corresponds to the bt
for the tth principal stratum. The ﬁrst two columns correspond to the intercept under the control
and treatment, respectively. Hence, the difference of these two columns corresponds to ITTt, the
ITT effect. The remaining columns correspond to the regression coefﬁcients for the covariates
within each principal strata identiﬁed by the corresponding row.
Estimation for the PS model is based on a mixture of distributions across principal strata. For
subjects assigned to R =0 with mediator D =0, then
f (Y|D =0, R =0,p,b,r)=
which is a mixture across compliers and never mediators. The symbol
is a normal probability
distribution function. For subjects assigned to R =1 with mediator D =1, then
f (Y|D =1, R =1,p,b,r)=
which is a mixture across compliers and always mediators. For subjects assigned to R =0 with
mediator D =1, then
f (Y|D =1, R =0,p,b,r)=
which is a mixture across always mediators and deﬁers. For subjects assigned to R =1 with
mediator D =0, then
f (Y|D =0, R =1,p,b,r)=
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
MEDIATION ANALYSIS WITH PRINCIPAL STRATIFICATION
which is a mixture across never mediators and deﬁers. Then the posterior distribution is as
f (b,r|R, D,Y,X) ∝p(b,r,p)×
i:zi=0,di=0
i:zi=1,di=1
i:zi=0,di=1
i:zi=1,di=0
is a normal distribution parameterized by the speciﬁc conditional mean tz and variance 2
We will employ Bayesian techniques with relatively ﬂat prior distributions to estimate the
effects of interest. Markov chain Monte Carlo (MCMC) techniques are used to implement these
Bayesian mixture estimation (e.g. ). In the case where no covariates are used in modeling
the principal strata probabilities, as illustrated in equation (5), we use a Gibbs sampler to
construct the Markov chain. The ﬁrst 100 draws are considered as burn-in. Convergence will be
assessed using the Gelman–Rubin method . In the case where covariates are used in modeling
the principal strata probabilities, as illustrated in equation (4), we use the Metropolis–Hastings
algorithm to construct the Markov chains.
Under the PS model, we specify relatively ﬂat normal and inverse gamma prior distributions
for the mean and variance parameters that govern the potential outcomes and principal strata
probabilities. First, we assume bt
∼N(ˆb,R), 2
t ∼inverse-gamma(0.01,0.01). The vector b is the
estimate from the linear regression of Y on R and X, and R=nV where V is the variance–
covariance matrix of b. The data-based priors for ITTt follow similar strategies by Ten Have et al.
 and Hirano et al. . Different prior distributions were speciﬁed for the logistic models for
the principal strata depending on whether covariates were used to help predict the principal strata
membership. With covariates, we again speciﬁed a relatively ﬂat multivariate normal distribution
under different prior variances speciﬁed for the intercept and each covariate in the prediction of
principal strata membership as illustrated in equation (4). The different prior variances for the
coefﬁcients in equation (4) account for the different scaling for the corresponding covariate .
In the absence of covariates predicting the principal strata, the relatively ﬂat Dirichlet prior is used.
The distributions from which parameters are drawn at each iteration of MCMC are illustrated in
the Appendix.
2.6. Software for estimating the PS model
As discussed by Bellamy et al. , a SAS macro for the PS approach is available at
 ACADEMICS/SCH CAS.MAT/rgallop/ within Causal SAS macros zip
ﬁle with documentation in the README.TXT text ﬁle. This software has been used in the
published analyses in Ten Have et al. , Bellamy et al. , and Lynch et al. .
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
R. GALLOP ET AL.
3. SIMULATIONS
To assess the accuracy and robustness of our estimation procedures, we present four sets of
simulations under the PS model. All simulated data sets were based on the data from the sample
of 101 adults who attempted suicide and were randomized to CBT or TAU. The ﬁrst two sets
of simulations were based on the parameter estimates from ﬁtting the PS model with a separate
variance for the deﬁant mediating principal stratum (heterogeneous variance by deﬁer model),
where the ﬁrst and second sets corresponded to the original sample size of 101 and then a doubling
of the sampling size to 202, respectively. The third and fourth sets of simulations were based on
the same analysis model but which was mis-speciﬁed for the true model for which a separate
variance was speciﬁed for the always mediating principal stratum instead of the deﬁant mediating
class (heterogeneous variance by always mediator model). The sample sizes of the third and fourth
sets paralleled the sample sizes of the ﬁrst and second set. The true simulation models for all of
these simulations were based on the following speciﬁcations from the analysis of the actual data:
• Principal strata probabilities of 0.024 for compliant mediators, 0.129 for always mediators,
0.752 for never mediators, and 0.095 for deﬁant mediators.
• Bernoulli treatment assignment randomly generated with the probability of a CBT versus
TAU designation of 0.50.
• Baseline depression randomly generated as a univariate normal variable with mean of 31.9
and standard deviation of 13.8.
• Endpoint depression generated as a univariate normal variable with mean dependent on
treatment assignment, principal stratum, and a baseline covariate with
and a pooled standard deviation of 12.0 for the compliant, always, and never mediating strata
and a standard deviation of 0.8 for the deﬁant mediating stratum (rows for  correspond to
each principal strata ordered in accordance to equation (1). The ﬁrst two columns correspond
to the intercept under control and treatment, respectively. The third column corresponds to
the baseline covariates regression coefﬁcient within each stratum, respectively).
For the third and fourth simulations based on the mis-speciﬁed model, we used the same above
speciﬁcations, except we speciﬁed a standard deviation structure that was different for the true and
ﬁtted models. The true model assumed a standard deviation of 12.0 for the compliant mediating,
never mediating, and deﬁant mediating strata and a standard deviation of 0.8 for the always
mediating stratum.
With the above speciﬁcations, simulated depression outcomes, baseline depression status, and
treatment and principal strata assignments were generated. For each of 500 generated data sets, we
ﬁtted the model with 10 000 MCMC chains after 100 burn-in iterations. We ﬁtted both the heterogeneous variance by deﬁers and homogeneous variance PS models. Simulations are summarized
in Table I. The summary measures for the direct effect parameter are presented separately for the
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
MEDIATION ANALYSIS WITH PRINCIPAL STRATIFICATION
Table I. Performance of simulated models for CBT treatment for suicide.
Simulated based on heterogeneity for deﬁers compared to other 3 groups
True value
(per cent)
(per cent)
Direct effect
Heterogeneous by
deﬁers model
Homogeneous
Direct effect within always mediators
Heterogeneous by
deﬁers model
Homogeneous
Direct effect within never mediators
Heterogeneous by
deﬁers model
Homogeneous
Mis-speciﬁed model—simulation based on heterogeneity for always mediators compared with other 3 groups
True value
(per cent)
(per cent)
Direct effect
Heterogeneous by
deﬁers model
Homogeneous
Direct effect within always mediators
Heterogeneous by
deﬁers model
Homogeneous
Direct effect within never mediators
Heterogeneous by
deﬁers model
Homogeneous
Note: Per row top number corresponds to results for N =101 and bottom corresponds to results for N =202.
never and always mediating classes as well as for a weighted average of these two classes:
• the coverage of nominal 95 per cent conﬁdence interval, which is the percentage of iterations for which the corresponding nominal 95 per cent conﬁdence interval includes the true
parameter;
• the average bias, which is the difference between average estimate of the effect with the true
value, −5.70 for the direct effect, −10.05 for the always mediator ITT effect, and −4.96 for
the never mediator ITT effect;
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
R. GALLOP ET AL.
• the percent bias, which is the magnitude of the difference between the true parameter value
and average estimate divided by the true value, then multiplied by 100 per cent; and
• the mean-squared error (MSE) for average estimate.
Table I displays results for the four simulations, where the upper portion corresponds to the
correctly speciﬁed analysis model and the lower portion corresponds to the mis-speciﬁed analysis
model. For each of the upper and lower portions, the ﬁrst row corresponds to the results for
simulations based on a sample size of 101, and the second row corresponds to the results based
on a sample size of 202.
The correctly speciﬁed heterogeneous variance by deﬁers model does produce stable estimates
of the direct effects in the always and never taker strata, with coverage in line with the nominal
95 per cent level. For the never mediating stratum, coverage is 95.0 and 95.3 per cent for the
simulations based on sample sizes of 101 and 202, respectively. Similarly, for the always mediating
stratum, coverage is 97.6 and 97.9 per cent. We also see the stable estimates for the overall direct
effect, the weighted average of these two strata, which has coverage of 96.2 and 95.3 per cent for
the simulations based on sample sizes of 101 and 202, respectively.
Comparison of the heterogeneous variance by deﬁers model with the homogeneous variance
model indicates a better ﬁt for the heterogeneous variance model as illustrated by less bias in the
corresponding effects, although coverage is quite comparable between the two models. For the
never mediating stratum based on the 101 simulation sample size, percent bias diminished from
32.5 to 15.8 per cent, whereas for the always mediator class, percent bias decreased from 50.1 to
18.7 per cent. For the overall direct effect, percent bias decreased from 10.4 to 6.6 per cent. A
similar pattern holds true for simulations based on sample size of 202.
To determine the robustness of inference with respect to mis-speciﬁcation of the heterogeneous
variance analysis model, we ﬁtted the homogeneous variance and heterogeneous variance by deﬁers
models to data generated from a heterogeneous variance model with a different variance speciﬁed
for the always mediating class rather than the deﬁant mediator stratum. The results revealed an
increase in bias for the effects estimated under the heterogeneous variance analysis model. An
increase in bias is also seen for the effects estimated under the homogeneous variance model with
the exception of the ITT effect in the never mediating stratum. Within this class, we do see an
increase in the MSE for the mis-speciﬁed heterogeneous variance by deﬁers model compared with
the correctly speciﬁed heterogeneous variance by deﬁers model. Coverage was worse for both
the homogeneous and heterogeneous variance by deﬁers models when the true model assumed a
different variance for the always mediators. In particular, for the always mediating stratum based
on the original overall sample size of 101, we see coverage was reduced by more than 50 per cent
for the heterogeneous variance by always mediator model and by 20 per cent for the homogeneous
variance model. There was less of reduction in the coverage for the never mediating class, for which
the class probabilities were signiﬁcantly larger than the probabilities for the always mediators.
This result suggests that the negative impact of model mis-speciﬁcation may be most signiﬁcant
for strata with such small membership probabilities.
4. APPLICATIONS
We illustrate the mediation process on the two examples discussed earlier. We present PS modelbased estimates of the direct effects in the always and never mediator principal strata for the two
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
MEDIATION ANALYSIS WITH PRINCIPAL STRATIFICATION
example data sets with a comparison to a standard regression approach to estimating direct effects
for the whole sample under the assumption of sequential ignorability. These direct effect estimates
are compared in the context of the overall ITT estimate for the whole sample using standard
regression with the outcome variable as the dependent variable and randomized indicator variable
as the primary covariate, while adjusting for the baseline outcome. We also assess the sensitivity
of the PS approach to the homogeneous variance assumption.
4.1. Cognitive therapy treatment for suicide attempters
A goal of CBT is for patients to have a better understanding of their depression and mechanisms
of an onset of a depression episode and also develop cognitive strategies for dealing with these
mechanisms rather than reliance on other types of strategies such as psychotherapy. Hence, CBT
patients should be less likely to seek external therapy dealing with psychology of the underlying
problems rather than cognitive issues. Accordingly, the CBT effect compared with TAU effect is
working through less reliance on outside therapy such as psychotherapy.
To assess the direct effect of CBT apart from reducing reliance on external therapy, we proceed
with the methods discussed in Section 2. Baseline BDI was adjusted for as a covariate in all
models. Using the notation described in the previous section, we have the following:
• R =1 for CBT and R =0 for TAU.
• D =1 for those who receive outside therapy, D =0 for those who do not receive outside
• Y is the BDI score at 6 months.
• X, the vector of baseline covariates, consists of the baseline BDI score.
The Bayesian estimation process was implemented based on ﬂat prior distributions described
in Table II. Baseline covariates were adjusted for in the outcome models, but not the prediction
model for the principal strata. The data analysis results were very similar between adjusting and
not adjusting for covariates in the principal strata model. With no adjustment for covariates in the
model for the principal strata in equation (5), the homogeneous and heterogeneous variance PS
models were estimated with MCMC as implemented through a Gibbs sampler. For each model,
the ﬁrst 100 draws were considered as burn-in. We used 45 000 iterations with convergence shown
with the Gelman–Rubin statistic. Posterior distributions were generated for all effects. Posterior
conﬁdence intervals for each ITT effect within principal stratum were generated. Direct effects for
treatment within the never and always mediator principal strata were derived based on the posterior
distributions for the effects in equation (3). Under both the heterogeneous and homogeneous
variance PS models, we estimated the pooled direct effect of treatment across the always and never
mediator strata based on equation (7).
Table II. Prior distribution assumptions for CBT treatment for suicide.
Parameters
Prior distribution
N(b,) with =n Var(b)
2 under homogeneity of variance
Inverse-gamma with parameters 0.01 and 0.01
2t under heterogeneity variance for all t
Each are inverse-gamma with parameters 0.01
(t =1,2,3, or 4)
Dirichlet with parameters 1, 1, 1, 1
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
R. GALLOP ET AL.
Table III. Estimates of intervention effect for CBT compared with TAU. Standard errors and nominal
95 per cent conﬁdence intervals are in parentheses.
Overall ITT effect
−6.35 (2.53)
(−11.37,−1.33)
Standard direct effect for overall sample
−6.86 (2.60)
(−12.01,−1.70)
Homogeneous variance PS
Heterogeneous variance by
deﬁers PS model
Always mediators (12.9 per cent)
−8.29 (17.68)
−10.05 (7.63)
(−43.43, 28.30)
(−24.92, 5.07)
Never mediators (75.2 per cent)
−7.06 (4.47)
−4.96 (2.80)
(−15.36, 1.93)
(−10.43, 0.58)
Pooled direct effect of intervention
−7.11 (4.28)
−5.70 (2.65)
(−15.16, 1.49)
(−10.92,−0.49)
Note: Principal strata probability per class under heterogeneous variance PS model are included in parentheses
in the effect column.
For the heterogeneous variance model, where variances varied across principal strata, we found
that for all principal strata except the deﬁer–mediator principal stratum, small sample sizes of 10
or less occurred occasionally across the Gibbs sampling iterations, given the probabilities for these
principal strata were consistently low. Consequently, we considered a heterogeneous variance by
deﬁers model, under which the variance for the deﬁant mediating stratum differed from the variance
for the other three principal strata, while the other three principal strata have one common variance.
The choice of the deﬁant mediating stratum is also based on our relaxation of the monotonicity
assumption. While our samples do exhibit deﬁant mediating behavior, clinically, it would seem
these people are somewhat different compared with those who are compliant mediating, never
mediating, or always mediating. We assess this assumption by comparing the corresponding results
to those under the PS with homogeneous variances and under the standard regression approach
of Baron and Kenny , which estimates direct effects for the whole sample. The results are
illustrated in Table III.
Table III shows that the standard regression direct effect for the overall sample is nearly comparable to the ITT treatment effect with 95 per cent conﬁdence intervals of (−12.01,−1.70) and
(−11.37,−1.73), respectively. Hence, it appears that under the standard approach, most of the
ITT effect of the CBT intervention is not through the mediator, outside therapy.
Under the homogeneous variance PS model, we see that the direct effect estimates in both the
always and never mediating principal strata, and consequently the pooled direct effect estimate,
exceed the overall ITT effect. The wide conﬁdence intervals for the PS stratum-speciﬁc direct
effects notwithstanding, the ITT effects in the non-informative principal strata (complier and deﬁer
mediators) are smaller than the never and always mediator direct effects. However, the PS-based
wide conﬁdence intervals for the always and never mediating classes overlap with the standard
ITT and direct effect estimates, as does the pooled PS conﬁdence interval. The pooled PS ITT
conﬁdence interval is narrower as one would expect with a larger sample size, but still does not
quite show statistical signiﬁcant, as the nominal 95 per cent conﬁdence interval is (−13.96,0.01).
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
MEDIATION ANALYSIS WITH PRINCIPAL STRATIFICATION
Figure 3. Plots of the prior (smooth line) and posterior (histogram) distribution of the ITT estimates for
each principal strata for the homogeneous variance model. Note: plots from left to right and top to bottom
are: compliant mediating, always mediating, never mediating, and deﬁant mediating.
In contrast to the large pooled direct effect estimate under the homogeneous variance model, the
heterogeneous variance by deﬁer PS model yielded a reduced pooled direct effect estimate relative
to the overall ITT estimate and the standard direct effect for the whole sample. The heterogeneous
variance PS direct effect estimate was −5.70, 20 per cent less than the homogeneous variance
direct effect estimate of −7.11. However, the 95 per cent conﬁdence interval of (−10.92,−0.49)
for the heterogeneous variance pooled direct effect was narrower and therefore signiﬁcant relative
to the marginally non-signiﬁcant analogous homogeneous variance interval of (−13.96,0.01). In
addition, the pooled direct effect estimate under the homogeneous variance model was more than
15 per cent less than the overall ITT estimate and the standard regression direct effect estimate. The
smaller heterogeneous variance PS direct effect estimate was due to a smaller direct effect estimate
in the heavily weighted never mediator stratum under this PS model than under the homogenous
variance model. The relatively small pooled direct effect estimate (−5.70) under the heterogeneous
variance model is still larger than in magnitude than the rank preserving model-based estimate
(−3.93) for the whole sample reported by Ten Have et al. . This difference may be due to the
potential heterogeneity of direct effects in the sample as represented by the differences between
always and never mediators addressed next.
Compared with the corresponding estimates under the homogeneous variance model, the heterogeneous variance PS model exhibited more heterogeneity between the always and never mediator
strata-speciﬁc direct effect estimates in Table III, although the conﬁdence intervals still overlap
because of their wide widths. The conﬁdence intervals notwithstanding, the stark difference between
the ITT effect estimates in the always and never mediator strata suggests the possibility of a CBT
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
R. GALLOP ET AL.
Figure 4. Plots of the prior (smooth line) and posterior (histogram) distribution of the ITT estimates for
each principal strata for the heterogeneous variance model. Note: plots from left to right and top to bottom
are: compliant mediating, always mediating, never mediating, and deﬁant mediating.
intervention-outside therapy interaction. That is, the CBT intervention may be more effective in
the always mediating group than in the never mediating group. We expect CBT patients to be
less likely to seek additional therapy due to CBT focusing on an individual’s understanding of
the mechanism and coping strategies for a depression onset. However, for those who are very
committed to seeking outside therapy (always mediating group), you would expect them to be
more receptive to any type of therapy and therefore CBT should be more effective in this more
committed group. For the group that would never seek outside therapy, you would expect them to
also be less receptive to CBT, and therefore CBT should less effective in this group.
Given the difference in direct effect estimates between the heterogeneous and homogeneous
variance PS models, the ﬁt of the models has been compared as follows. To assess convergence
of the MCMC chains under the homogeneous and heterogeneous variance models, we employed
the Gelman–Rubin Statistic. For the homogenous model, the GR statistic ranged from 1.00003 to
1.0024 for various sets of starting values of the chain. Similarly, for the heterogeneous variance
model, the GR statistic ranged from 1.00048 to 1.0165.
Figures 3 and 4 present plots of the prior and posterior distribution of ITTt for each principal
stratum. According to criteria formulated by Garret and Zeger for latent class models such
as the PS model, the substantial discrepancies between posterior and prior distributions for the
principal strata indicate that the data contributed information to identiﬁcation of the ITT estimates
for the speciﬁc principal strata. Figure 3 plots the distributions for the homogeneous model and
Figure 4 plots the distribution for the heterogeneous variance model.
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
MEDIATION ANALYSIS WITH PRINCIPAL STRATIFICATION
As seen in Figure 3 for both the compliant and always mediating strata, the posterior is close to
the prior distribution, suggesting that the data did not provide much information for identifying the
ITT effect in these principal strata. However, for the never and deﬁant mediating strata, there is a
sufﬁcient separation between the prior and posterior distribution, suggesting that the data provided
information for identifying the ITT effect in these two strata. In Figure 4, for the compliant
mediators, the posterior is close to the prior distribution, suggesting that the data did not provide
much information for identifying the ITT effect in that group. In contrast, for the always, never, and
deﬁant mediating strata, there is sufﬁcient separation between the prior and posterior distribution,
suggesting that the data provided information for identifying the ITT effect in these three stratum.
These results may suggest that the heterogeneous variance model identiﬁes the data better than
the homogeneous variance model.
4.2. Collaborative care suicide prevention study
In the Bruce et al. study, the practices with a DS may be more likely to recognize an onset of a
depression episode, resulting in immediate prescription of medication compared with the practices
without a DS. This could lead to better depression status for patients randomized to practices with
a DS compared with patients randomized to practices without a DS. However, the presence of a
DS in practice may have a direct effect on reducing depression symptoms even for patients who
would always take medication regardless of the presence of a DS (always medicators) or never
take medication (never medicators). This direct effect would occur if the presence of the DS in a
practice were to increase the overall efforts by practice providers and staff in treating depression
using other strategies in addition to medication.
To assess the direct effect of the DS apart from increasing medication use, we proceed with
the methods discussed in Section 2. Because the within-practice design effect is so small for the
outcome, we ignored the clustering due to primary practice as was done in previous publications of
the study results . Using the notation described in the previous section we have the following:
• R =1 for patients randomized to a practice with a DS and R =0 for patients randomized to
a practice without a DS.
• D =1 for those who took medication, D =0 for those who did not take medication.
• Y is the HRSD score at 4 months.
• X, the vector of baseline covariates, consists of the baseline HRSD score, and baseline suicide
The standard ITT analysis for the whole sample of the outcome HRSD at 4 months while
controlling for baseline HRSD and baseline suicide ideation is signiﬁcant. To assess whether
this signiﬁcant ITT effect due to the presence of the DS in the primary care practice occurred
around the mediator, whether patients were taking medication, we compare the standard direct
effect estimate for the overall sample under the standard regression approach of Baron and Kenny
 with various PS model-based estimates for always and never mediators with and without
homogeneous variance assumptions. Unlike the previous example, the sample size of this example
is sufﬁcient to estimate a separate variance for each principal stratum (heterogeneous variance
model), thus no pooling variance across select principal strata is necessary.
The Bayesian estimation process for the PS models was implemented based on ﬂat prior distributions as described in Table IV, using the Metropolis–Hastings algorithm to adjust for covariates
under the principal strata multinomial model in equation (4). The ﬁrst 100 draws were considered
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
R. GALLOP ET AL.
Table IV. Prior distribution assumptions for depression specialist practice study.
Parameters
Prior distribution
N(b,) with =n Var(b)
2 under homogeneity of variance
Inverse-gamma with parameters 0.01 and 0.01
2t under heterogeneity variance for all t
Each are inverse-gamma with parameters 0.01
(t =1,2,3, or 4)
N(0,diag(1,2.25,0.04))
Table V. Estimates of intervention effect for practices with depression specialist
compared with those without depression specialist. Standard errors and nominal
95 per cent conﬁdence intervals are in parentheses.
Overall ITT effect
−3.12 (0.82)
(−4.72,−1.51)
Standard direct effect for overall sample
−2.67 (0.89)
(−4.41,−0.93)
Homogeneous variance PS
Heterogeneous variance PS
Always mediators (34.4 per cent)
−2.83 (2.57)
−2.88 (2.63)
(−7.51, 3.10)
(−7.95, 2.34)
Never mediators (3.9 per cent)
−9.17 (9.41)
−8.52 (4.63)
(−25.04, 13.73)
(−10.01, 4.89)
Pooled direct effect of intervention
−3.83 (2.65)
−3.38 (2.46)
(−8.27, 2.15)
(−8.16, 1.46)
Note: Principal strata probability for each strata under heterogeneous variance PS model are included in
parentheses in the effect column.
as burn-in. Again, we used 49 000 iterations with convergence shown with the Gelman–Rubin
statistic. Posterior distributions intervals were generated for all effects. Posterior means and conﬁdence intervals for each ITT effect within each principal stratum were generated. The pooled
direct effect for treatment across never and always mediators was derived based on the posterior
distributions for the pooled effect in equation (7). The results for the overall ITT effect, the standard
regression overall direct effect, and stratum-speciﬁc and pooled estimates under both PS models
are illustrated in Table V.
The estimated direct effects of the DS intervention under the different modeling approaches
differ more in terms of inference than in terms of magnitude. While the standard regression direct
effect estimate is approximately 15 per cent less than the overall ITT effect estimate, suggesting
some mediation, the direct effect estimate is still signiﬁcant. In contrast, the pooled direct effect
estimates for the always and never mediator strata under both the homogeneous and heterogeneous
variance PS models are larger than the overall ITT effect estimate, although their conﬁdence
intervals surround zero. The larger PS direct effect estimates are inﬂated because of the very large
direct effect estimates in the never mediator (never medicated) stratum under both variance PS
models. With such a small percentage (3.9 per cent per Table V) of the sample potentially belonging
to the never medicated group, one may want to base inference on the always medicated stratum
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
MEDIATION ANALYSIS WITH PRINCIPAL STRATIFICATION
Figure 5. Plots of the prior (smooth line) and posterior (histogram) distribution of the ITT estimates for
each principal strata for the homogeneous variance model. Note: plots from left to right and top to bottom
are: compliant mediating, always mediating, never mediating, and deﬁant mediating.
under either of the variance PS models. With non-signiﬁcant conﬁdence intervals, the direct effect
estimates under the two models range between −2.83 and −2.88, about 10 per cent less than the
overall ITT estimate of −3.12. The non-signiﬁcant conﬁdence intervals notwithstanding, the direct
effect estimates in the always medicated group are in some agreement with the standard regression
direct effect estimate, all being 10–15 per cent less than the overall ITT estimate. This consistency
between PS and standard direct effect estimates corresponds to a similar pattern observed for the
rank preserving (−2.58) and standard direct effect (−2.67) estimates in Ten Have et al. .
Keeping in mind the wide conﬁdence intervals, the stark difference between the ITT effect
estimates in the always and never mediator strata under both PS models suggests the possibility of
a DS intervention–medication interaction. That is, the DS intervention may be more effective in the
never medication group than in the always medication group. However, under the heterogeneous
and homogeneous variances, the 95 per cent conﬁdence intervals of the contrast in the DS effect
between the always and never mediation groups contain 0: (−16.83,23.49) and (−8.95,12.96)
for the homogeneous and heterogeneous variance models, respectively. Hence, there is not enough
evidence to show an intervention–mediator interaction.
We again used the Gelman–Rubin method to assess the convergence of the MCMC chains.
For the homogenous model, the GR statistic ranged from 1.0011 to 1.0048 for various sets of
starting values. Similarly, for the heterogeneous variance model, the GR statistic ranged from
1.0005 to 1.0021.
Figures 5 and 6 offer plots of the prior and posterior distributions of ITTt for each principal
stratum. Figure 5 plots the distributions for the homogeneous model and Figure 6 plots the
distribution for the heterogeneous variance model.
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
R. GALLOP ET AL.
Figure 6. Plots of the prior (smooth line) and posterior (histogram) distribution of the ITT estimates for
each principal strata for the heterogeneous variance model. Note: plots from left to right and top to bottom
are: compliant mediating, always mediating, never mediating, and deﬁant mediating.
Both Figures 5 and 6 indicate that there is sufﬁcient separation in each of the four principal
strata between the prior and posterior distributions. Hence, there is an evidence to suggest that
both the homogeneous and heterogeneous variance models appear to identify the data well.
5. DISCUSSION
In addressing the direct effect of treatment in the context of mediation, the presented examples
and simulation results illustrate that care must be taken in interpreting standard direct effect
estimates under the sequential ignorability assumption and complementing these estimates with
causal estimates of direct effects that relax such an assumption. In this paper, we compared such
causal estimates under the PS approach with the standard regression direct effect estimates in a
simple context with a single continuous outcome and binary intervention and mediator. In one
example, there was agreement, and in the other there was greater disagreement between the standard
and causal approaches. Moreover, we assessed the sensitivity of the PS approach to departures
from the homogeneous variance assumption. In the example with agreement between the PS and
standard approaches, the PS method appeared to not be sensitive to the variance assumption. In
contrast, in the example with a smaller sample, there was disagreement between the homogeneous
and heterogeneous variance PS model results.
With the PS model as with all causal approaches, there are limitations, which may have led to
differences between the results of the PS and standard regression direct effect approaches. One
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
MEDIATION ANALYSIS WITH PRINCIPAL STRATIFICATION
standard assumption is a common variance in the potential outcome error distribution across principal strata. In this investigation, we relaxed this assumption allowing heterogeneity in the variance
of the error distribution across principal strata. Our simulations showed somewhat increased bias
and poorer coverage under mis-speciﬁcation of the principal stratum-speciﬁc variance structure.
From a modeling perspective, investigators may want to explore the relaxation of the homogeneity
of variance assumption during their implementation. Comparison with the stability of the effects
as well as assessment of rate of convergence and model identiﬁability under homogeneity and
heterogeneity will help the investigator assess the need for modeling heterogeneity.
In addition, the PS approach is dependent on the validity of unveriﬁable assumptions. SUTVA,
may not hold when interventions require each clinician/therapist treating multiple patients as in
both studies; therefore, the interchangeability of subjects may be somewhat questionable. The
randomization assumption may also be somewhat implausible in the Collaborative Care Study, for
which primary care practices were randomized. An imbalance for an observed baseline variable,
suicide ideation, occurred and was adjusted for. Given that the randomization units were the 20
primary care practices in the study, such an imbalance is not unlikely. Nonetheless, this was the
only one of many baseline covariates that exhibited signiﬁcant differences between the randomized
groups. Hence, there is equivocal evidence of potential unmeasured confounding.
The additional assumption of no interactions involving the randomized intervention and mediator
with baseline covariates conditional on the principal stratum is crucial for identifying parameters
under the PS approach. In the suicide cognitive therapy study, the cognitive therapist may have
provided more intensive therapy for patients with more suicide ideation or depression at baseline,
which would have resulted in an R∗X interaction. Nonetheless, the investigators believed that the
cognitive therapy approach is standardized enough that such an interaction was not very likely.
Similarly, baseline depression and suicide ideation may have impacted the way an external therapist
provided the mediator, non-study therapy. However, this interaction may also be unlikely given
that non-study therapists mostly saw patients after the study started and may not be aware of the
patients’ baseline values. In the Collaborative Care Study, R∗X and D∗X interactions may have
more likely existed given that the DS intervention was less scripted than the CBT intervention
in the other study and the mediator, medication adherence, is a patient factor and thus possibly
sensitive to baseline depression and ideation.
A beneﬁt of the PS model is that it does not require the assumption of no structural interaction
between the treatment assignment and the mediator. Comparing the direct effects between the
always and never mediating principal strata, the two strata for which the potential mediation level
is constant, we can assess a component of the treatment assignment by mediator interaction. A
substantial difference in the direct effect between these two strata would suggest such an interaction.
This paper focuses on direct effects on a follow-up continuous outcome at a single follow-up
visit. The PS approach has been extended to longitudinal data in the context of treatment noncompliance in randomized trials (e.g. ). Using such longitudinal extensions in the mediation
context is an area of future research. In addition, the PS approach has been extended to binary
outcomes in the non-compliance context (e.g. ). Similar extensions to binary outcomes in the
mediation context are needed.
While the limitations of the PS approach have been addressed above, this approach offers
a viable technique for assessing mediation when the mediator is not randomized, i.e. lack of
sequential ignorability. The PS approach can provide evidence for mediation but only for the
always- and never-mediator classes. With the caveat of potentially low power, no direct effect
in the always- and never-mediator classes is indicated when the conﬁdence intervals for the ITT
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
R. GALLOP ET AL.
effects in these classes include zero but are narrow enough for precise inference. Assuming that
one can manipulate the mediator such that subjects in the always-mediator group can be made
to exhibit never-mediator behavior and vice-versa for subjects in the never-mediator group, the
absence of a direct effect in these classes implies that the resulting ITT effects within these classes
are totally mediated by the mediator. Also, all mediation approaches pertaining to all types of
subjects make the assumption of a mediator that can be manipulated . MacKinnon et al. 
describe causal inferences as new approaches for mediation. In fact, they highlight the PS approach
of Frangakis et al. as a promising method, as do Lynch et al. . Finally, the PS approach
has an additional advantage over more traditional approaches beyond the beneﬁt of protection
against unmeasured confounding. The PS approach accommodates mediators that are not under
the control of the investigator or clinician. In our example, the traditional approach assumes that
the clinician has control over whether the patients seek outside therapy.
APPENDIX A: MCMC DRAWS
We draw Ci from a multinomial distribution where the probability for each class t is
P(Ci =t|Ri =r, Di =d,Yi,b,r2)=
(yi|tr,2
(yi|tr,2t )+t∗
(yi|t∗r,2
where t∗corresponds to the other principal stratum for the pair Ri =r, Di =d.
The distributions from which the other parameters drawn at each iteration are as follows:
(b|X,Y,r2) ∼MVN(ˆb, ˆR)
b = (XTX)−1Y
R = 2(XTX)−1
(r2|X,Y,b) ∼Inv−
df=0.01+ N, 0.012+v
v = (Y−Xb)T(Y−Xb)
(pt|X,Y,l,r2) ∼Dirichlet(nt +1)
where N is the sample size and I is the indicator function that equals 1 when the equation within
the parentheses is true and 0 otherwise, the matrix X includes baseline covariates augmented with
indicators for control and treatment assignment, and Y is the vector of outcomes.
ACKNOWLEDGEMENTS
The preparation of this manuscript was funded in part by R01MH-078016. M. R. Elliott’s effort was
funded in part by NIMH grant R01MH-078016.
Copyright q
2009 John Wiley & Sons, Ltd.
Statist. Med. 2009; 28:1108–1130
DOI: 10.1002/sim
MEDIATION ANALYSIS WITH PRINCIPAL STRATIFICATION