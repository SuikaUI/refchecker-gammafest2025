Nonlinear Event-Related Responses in fMRI
Karl J. Friston, Oliver Josephs, Geraint Rees, Robert Turner
This paper presents an approach to characterizing evoked
hemodynamic responses in fMRl based on nonlinear system
identification, in particular the use of Volterra series. The
approach employed enables one to estimate Volterra kernels
that describe the relationship between stimulus presentation
and the hemodynamic responses that ensue. Volterra series
are essentially high-order extensions of linear convolution or
“smoothing.” These kernels, therefore, represent a nonlinear
characterization of the hemodynamic response function that
can model the responses to stimuli in different contexts (in
this work, different rates of word presentation) and interac-
tions among stimuli. The nonlinear components of the re-
sponses were shown to be statistically significant, and the
kernel estimates were validated using an independent event-
related fMRl experiment. One important manifestation of
these nonlinear effects is a modulation of stimulus-specific
responses by preceding stimuli that are proximate in time.
This means that responses at high-stimulus presentation
rates saturate and, in some instances, show an inverted U
behavior. This behavior appears to be specific to BOLD ef-
fects (as distinct from evoked changes in cerebral blood flow)
and may represent a hemodynamic “refractoriness.” The aim
of this paper is to describe the theory and techniques upon
which these conclusions were based and to discuss the im-
plications for experimental design and analysis.
Key words: nonlinear system identification; functional neuro-
imaging; fMRI; hemodynamic response function; Volterra se-
INTRODUCTION
This paper is about evoked hemodynamic responses in
functional magnetic resonance imaging (fMRI) and how
the measured blood oxygen level dependent (BOLD) ef-
fects can be related to underlying neuronal activity. In
particular we investigate the nonlinear nature of this
response, the significance of the nonlinear components,
and how they affect the design and interpretation of fMRI
experiments.
In Friston et al. (I), we presented a model of observed
hemodynamic responses, in fMRI time series, that obtain
when the underlying neuronal activity (inferred on the
basis of changing task conditions) is convolved or
smoothed with a hemodynamic response function. This
model was subsequently elaborated in the context of the
general linear model (2-4). The general linear model is
variously employed in linear system identification, from
MRM 3941-52 
From the Wellcome Department of Cognitive Neurology, Institute of Neu-
rology, Queen Square, London, United Kingdom.
Address correspondence to: Karl J. Friston, The Wellcome Department of
Cognitive Neurology, Institute of Neurology, Queen Square, London, UK
WCl N 3BG.
Received January 21, 1997; revised June 17, 1997; accepted June 77,
This work was supported by the Wellcome Trust.
Copyright 0 1998 by Williams & Wilkins
All rights of reproduction in any form reserved.
0740-31 94/98 $3.00
a signal-processing perspective, or multiple linear regres-
sion or AnCova in statistics. These approaches to mod-
eling and characterizing fMRI time series are predicated
on the assumption that the relationship between evoked
neuronal activity and the ensuing hemodynamic re-
sponse can be approximated by a linear convolution
using a fixed and time-invariant hemodynamic response
function (1, 5). This assumption has been evaluated by
comparing estimates of the hemodynamic response func-
tion using different stimuli (6) and linear system identi-
fication. In this paper, we present a nonlinear character-
ization of the hemodynamic response function using
nonlinear system identification and explicitly assess
both the significance and behavior of the nonlinear com-
ponents (where they exist).
We have employed a parametric experimental design
using evoked responses to words presented aurally at
varying frequencies. This variation allowed us to exam-
ine the “stability” of the hemodynamic response to single
words and the interactions among stimuli when pre-
sented close together. These interactions represent non-
linear effects that we were able to estimate and make
statistical inferences about. The importance of this work
relates to understanding the nonlinear relationship be-
tween evoked responses and sensory or behavioral pa-
rameters (such as presentation rate) and the implied con-
straints imposed upon experimental design and analysis.
For example, we were able to resolve the apparent dis-
crepancy between linear increases in blood flow in re-
sponse to increasing word presentation rates (7) and the
nonlinear dependency of the BOLD signal (8). From a
data analysis perspective, the framework described in
this paper can be seen as a generalization of linear ap-
proaches that characterize hemodynamic responses,
evoked by single events, in terms of basis functions of
peri-stimulus time (9).
This paper is divided into three sections. The first
section describes the theoretical background to analyzing
nonlinear or dynamic systems using Volterra series as a
general model relating changes in neuronal activity (or
stimuli) to hemodynamic responses. By using a second-
order expansion, we were able to reformulate the prob-
lem in terms of the general linear model and therein
provide for both parameter estimation and statistical in-
ference about the effects observed. The second section
uses the results of the first section to analyze two fMRI
experiments, comprising two single-subject aural-stimu-
lation paradigms. In the first, epoch-related experiment
blocks, or epochs, of words were presented at different
rates. On the basis of this experiment, we were able to
estimate a high-order or nonlinear hemodynamic re-
sponse function and use it to predict the response that
would have been evoked by a single word. In the second,
event-related experiment, words were presented in iso-
lation. This allowed us to validate the estimated re-
sponses to single words from the first study in terms of
Friston et al.
empirically determined event-related responses from the
second. The third section uses the nonlinear model of
evoked responses of the previous sections to look in
detail at the nonlinear interactions. By performing “vir-
tual” experiments on the model, we show that these
interactions can be thought of in terms of a hemodynamic
“refractoriness” in which a prior stimulus modulates the
response to a subsequent stimulus, if it occurs within a
second or so. This modulation represents an interaction,
over time, between the responses to successive stimuli
and results in reduced responsiveness at high-stimulus
frequencies.
THEORETICAL BACKGROUND
Nonlinear System Identification
Neuronal and neurophysiological dynamics are inher-
ently nonlinear and lend themselves to modeling by non-
linear dynamic systems. However, due to the complexity
of biological systems, it is difficult to find analytic equa-
tions that describe them adequately [although see
Vazquez and No11 (10) for a compelling example]. An
alternative is to take a very general model and obtain the
specific parameters that enable the model to describe the
system in question (11). A common example of this func-
tional approach to system identification is the use of
Volterra series. The Volterra series is an extension of the
Taylor series representation to cover dynamic systems
and has the general form
+ . . . and soon
fit) is the output, in this case the hemodynamic response
or fh4RI signal, and u(t) the input, in this case neuronal
activity as indexed by the stimulus rate employed in our
experiments. hl’(T1,. . . . 7,) is the nth order Volterra ker-
nel. It can be shown that these series can represent any
analytic time-invariant system (1 1). The Volterra series
has been described as a “power series with memory” [see
Chapters 2 and 3 of Bendat (12) for a fuller discussion].
The problem of characterizing the relationship between
the stimulus function or neuronal activity u(t) and the
hemodynamic response fit) reduces to estimating the
kernel coefficients h”. For long time series, with rela-
tively noiseless data, a number of approaches could be
tried. Wray and Green (11) describe a technique using
time-delay neuronal networks. In our experience, the
nature of fMRI data does not permit t.he use of such
techniques, so we have adopted a standard least squares
approach. This has the advantage of providing for statis-
tical inference using the general linear model (see be-
low). To do this, one must first linearize the problem.
Consider the second-order approximation to the above
expansion with finite “memory” T:
h2(T1,T2)’ U ( t - T1) * U ( t - 7 2 ) * dTldT2
Note that the integrals start at zero. This reflects the fact
that our system is “causal” in the sense that neuronal
changes precede hemodynamic responses. In this formu-
lation, the first-order coefficients hl(t) correspond to the
[linear] hemodynamic response function as described in
Friston et al. (1). The new terms depend on the second-
order coefficients h2 and are the primary focus of this
The second step in making the estimates of ho, hl, and
h2 more tractable, for noisy data like fMRI, is to expand
the kernels in terms of a small number P of temporal
basis functions
This allows us to estimate the
coefficients of this expansion using standard least
squares: 97).
Now define a new set of response variables x,(t) that
represent the original time series u(t) convolved with the
ith basis function
b i ( ~ , )
Substituting this expression into Eq. [I] and including an
explicit error term e(t) gives
This is simply a general linear model with response
variable fit), the observed time series, and explanatory
variables 1, xj(t), and xi(t).xj(t) at the [discrete] times at
which they are observed. These explanatory variables
(convolved time series of neuronal activity or stimulus
presentation rate) constitute the columns of the design
Nonlinear Even t-Rela ted Responses
matrix. The unknown parameters are 8, g', and 8 from
which the kernel coefficients ho, hl, and h2 are derived,
using Eq. . Having reformulated the problem in this
way, we can now use standard analysis procedures de-
veloped for serially correlated fMRI time series that em-
ploy the general linear model (2, 4). These procedures
provide parameter estimates (i.e., estimates of the basis
function coefficients and, implicitly, the kernels them-
selves) and statistical parametric maps (SPMs) testing the
significance of a hemodynamic response at each and
every voxel. In this paper, we will use SPMs of the F
statistic (SPM{FJ) that test the joint contribution of effects
considered of interest (the remaining effects, or columns
of the design matrix, are called confounds). Below we
will present SPM{FJs testing for the significance of the
first- and second-order coefficients hl and h2 and
SPM{F]s that test for the nonlinear effects h2 alone by
treating the first-order effects hl as confounds. These
analyses involve using design matrices with and without
the effects of interest and assessing the reduction in error
with the F statistic.
In this work, we used only three basis functions, i.e.,
P = 3 (Fig. 1). These were gamma density functions
peaking during the early, intermediate, and late compo-
nents of the anticipated hemodynamic response. The
choice of these functions was motivated by prior knowl-
edge about the form of the [linear] hernodynamic re-
sponse function. This form is usually well approximated
by a linear combination of two or more gamma density
functions. A special case of this is the Poisson form
adopted in Friston et al. (1) that corresponds to a single
gamma density with equal mean and variance. Clearly
the choice of basis functions is dictated by the nature of
the data and the amount of temporal detail that one
wants to model. In some instances (e.g., multislice acqui-
sition), there are differences in the times that one voxel
time series is acquired in relation to another. To accom-
modate these slight shifts in time, we often supplement
the basis functions with their temporal derivatives (Fig.
1). The role of these derivatives can be seen intuitively by
basis functions
time (seconds)
FIG. 1. Basis functions b,(t) (solid lines) and their derivatives (bro-
ken lines) used in the expansion of the Volterra kernels h'(7,) and
h2(7,, 7.J. These are gamma density functions with mean and
variance 2' (i = 2, 3, and 4). These gamma density functions can
be thought of as a set of time-scaled Poisson functions because
their mean and variance are equal.
noting that adding (or subtracting) the temporal deriva-
tive shifts the basis function backwards (or forwards) in
time. In this paper, derivatives were only used in the
analysis of the event-related study where temporal ef-
fects were more acute.
THE fMRl EXPERIMENTS
Experimental Design and Data Acquisition
In this section, we apply the theory presented above to
fMRI time series obtained from a single normal male
subject during passive listening to words presented alone
or continuously at different rates. The data were acquired
at 2 Tesla using a Magnetom VISION (Siemens, Erlangen)
whole body MRI system, equipped with a head volume
coil. Contiguous multislice T,*-weighted fMRI images
were obtained with a gradient echo-planar sequence us-
ing an axial slice orientation (TE = 40 ms, TR = 1.7 s,
64 X 64 X 16 voxels [19.2 X 19.2 X 4.8 cm]). After
discarding initial scans (to allow for magnetic saturation
effects), each time series comprised 1200 (first study) and
1000 (second study) volume images with 3-mm isotropic
voxels. In the first, epoch- or rate-related experiment, the
subject listened to monosyllabic or bisyllabic concrete
nouns (i.e., dog, radio, mountain, gate) presented at five
different rates (10, 15, 30, 60, and 90 worddmin) for
epochs of 34 s (20 scans), intercalated with periods of
rest. The five presentation rates were successively re-
peated according to a Latin Square design. In the second,
event-related study, the subject listened to (nonrepeat-
ing) nouns presented once every 34 s.
Data Preprocessing
The data were analyzed with SPM96 (Wellcome Depart-
Neurology,
 
ucl.ac.uk/spm). The time series were realigned, corrected
for movement-related effects, and spatially normalized
into the standard space of Talairach and Tournoux (13)
using the subject's coregistered structural Tl scan (14,
15). The data were spatially smoothed with a 5-mm iso-
tropic Gaussian kernel and temporally smoothed with a
,8 -s Gaussian kernel. Because we also smoothed the de-
sign matrix, the temporal smoothing does not affect the
kernel or response function estimates (2).
Epoch-Related Responses
The data were analyzed using a design matrix that in-
cluded the explanatory variables (convolved time series)
in Eq. . The basis functions employed in this analysis
were a series of gamma density functions as shown in
Fig. 1 (solid lines). The stimulus function u(t), the sup-
posed neuronal activity, was simply the word presenta-
tion rate at which the scan was acquired. We also used
more comprehensive forms for u(t) that involved model-
ing each word individually, but the results were very
similar to the simpler snalysis presented here. The re-
sulting SPM(FJ, reflecting the significance of an evoked
response (or more formally, testing the null hypothesis
that all h1 and h2 were jointly zero), is shown in Fig. 2
Friston et al.
Design Matrix
SPM{F} - Rate experiment
SPM{F} - Event-related
Design Matrix
along with the design matrix
used. The left-hand side of the
upper design matrix com-
prises the explanatory variable
xi(t) and xi(t).xi(t). The remain-
ing columns contain the con-
stant (used to estimate go) and
other effects designated as
confounds (low-frequency ar-
tifacts, global effects, and so
on). This SPM(F} has been
thresholded [F = 32, P < 0.001
corrected for multiple compar-
isons (IS)] and shows wide-
spread responses in bilateral
temporal regions with the
most significant effects evi-
dent in the periauditory re-
The estimated kernels ho,
h’, and h2 for a voxel in the
left superior temporal gyrus
(-56, -28,12 mm) are shown in
Fig. 3. As might be expected,
the first-order kernel resem-
bles the hemodynamic re-
sponse functions identified
using linear analyses such as
least squares deconvolution
[e.g., Fig. 6 in Ref. (l)]
regression [ e.g., Fig. 5 in Boyn-
ton et al. (6)]. Of note is the
protracted undershoot that
lasts for about 16 s. The sec-
ond-order kernel is shown be-
low and is remarkable for the
pronounced negativity on the
lower left, flanked by smaller
positive lobes. This negativity
suggests that if neuronal activ-
ity has been high in the past
few seconds, then the hemo-
dynamic response will be sup-
FIG. 2. Top left: SPM{F} testing for the significance of the first- and second-order kernel coeffi-
cients (b’ and b2) in the first (rate) experiment. This is a maximum intensity projection of a statistical
process of the F ratio, following a multiple regression analysis at each voxel. The format is standard
and provides three orthogonal projections in the standard space conforming to that described in
Talairach and Tournoux (13). The grey scale is arbitrary, and the SPM{F) has been thresholded at
32 (f < 0.001 corrected). Top right: The design matrix used in the analysis. The design matrix
comprises the explanatory variables in the general linear model. It has one row for each of the 1200
scans and one column for each explanatory variable or effect modeled. The left-hand columns
contain the explanatory variables of interest x,(t) and x,(t).x,(t), where x,(t) is word presentation rate
u(t) convolved with the basis functions b,(t) in Fig. 1. The remaining columns contain covariates or
effects of no interest designated as confounds. These include (left to right) a constant term (b’),
periodic (discrete cosine set) functions of time, to remove low-frequency artifacts and drifts, global
or whole brain activity G(t), and interactions between global effects and those of interest G(t).x,(t)
and G(t).x,(t).x,(t). The latter confounds remove effects that have no regional specificity. Lower left:
SPM{F) as above but for the second event-related experiment. This SPM{F} has been thresholded
at F = 16 (f < 0.001 corrected). Note the similarity between the two SPM{F}s, despite the fact that
they derive from different experimental designs and completely independent data. Lower right: The
design matrix employed. The effects of interest are the first-order terms x,(t) derived by convolving
u(t) with all six functions in Fig. 1. u(t) was in this instance one when a single word was presented
and zero elsewhere. The confounds are as described above.
pressed. The positive lobes
suggest that this suppression
is ameliorated if the underly-
ing neuronal activity is sus-
tained, i.e., is high in the re-
cent (4 s) and more distant
past (8 s). There are two fur-
ther important points to note.
First, the second-order kernel
is symmetrical. This will al-
ways be the case because the
contribution of u(t - T l ) . u ( f - T ~ )
to the response is exactly the
same as u(t - T ~ ) . u ( ~
- T ~ ) . The
second unpredicted and more
intriguing observation is that
the second-order kernel is very
similar to the “product” of the
first-order kernel times itself
Nonlinear Event-Related Responses
0th order kernel (hO) = 146
1st order kernel {hi}
time (seconds}
FIG. 3. The Volterra kernels ho, h’, and h2 based on parameter
estimates from a voxel in the left superior temporal gyrus at -56,
-28, 12 mm. These kernels can be thought of as a characterization
of the second-order hemodynamic response function. The first-
order kernel (upper panel) represents the (first-order) component
usually presented in linear analyses. The second-order kernel
(lower panel) is presented in image format. The color scale is
arbitrary; white is positive and black is negative. The insert on the
right represents [-h1(T,).h1(T2)],
the second-order kernel that would
be predicted by a simple model that involved convolution with h1
and then some nonlinear scalar function.
(insert in Fig. 3). In other words, h2(~l,~2)
is roughly
proportional to hl(i-J.hl(~J. We return to the implica-
tions of this in a subsequent section.
The basic form of the second-order kernel estimates
was very similar for all the voxels in the periauditory
region. The nature of these nonlinear effects will be dem-
onstrated more intuitively in the final section of this
paper. Using these kernel estimates, we can estimate
responses to any temporal pattern of words presented by
using Eq. [I] and any suitable function u(t). In the first
instance, we present the estimated responses to the stim-
uli actually used: The predicted and observed responses
for the first 17 min of the time series are shown in Fig. 4
(upper panel). Predicted responses to 34-s epochs at two
presentation rates (30 and 60 words/min) and the ad-
justed responses observed are shown in the lower panel
of Fig. 4 (adjusted data is simply the original data after
the confounding effects have been removed). The agree-
ment is evident.
Event-Related Responses
By specifying a stimulus function u(t) that models the
occurrence of a single word, we can use Eq. [I] and the
kernel estimates in Fig. 3 to simulate the hemodynamic
response of this brain region to single word. This simu-
lated event-related response is shown in Fig. 5 (upper
panel). One observes a peak at about 4 s followed by a
protracted undershoot lasting for about 16 s. This re-
sponse is “simulated” using a model whose parameters
were determined without ever presenting single words in
isolation (i.e,, the Volterra series model based on the rate
experiment). A validation of the model can be effected in
terms of the empirically determined event-related re-
sponse to actual single words using the second experi-
The same analysis described above was applied to the
event-related, single word experiment. In this instance,
by virtue of the fact that the words were presented very
sparsely, there is no opportunity for the responses to
fitted and observed response
time (seconds)
responses at 30 and 60 wpm
time (seconds)
FIG. 4. Top panel: Fitted or predicted (broken line) and observed
(solid line) responses at the same voxel as in Fig. 3, over the first
1024 s. The observed responses here are adjusted such that those
effects that can be modeled by the confounds have been re-
moved. Lower panel: Predicted and observed responses for ep-
ochs of 30 (light grey) and 60 (dark grey) wordshin (wpm) super-
imposed upon each other.
Friston et al.
simulated response to a single stimulus
time (seconds)
empirical response
time (seconds)
FIG. 5. Top panel: Hemodynamic response to a single word (bar
at 0 s) modeled using the Volterra kernel estimates of Fig. 3. Lower
panel: The empirical event-related response in the same region
based on the second experiment. The solid line is the fitted re-
sponse using the first-order kernel estimates and the dots repre-
sent the adjusted responses.
successive words to interact, and therefore a first-order
model is sufficient to describe the response. In this case
u(t) was effectively a series of delta functions modeling
the occurrence of each word. The basis functions were
the gamma functions used above (solid lines in Fig. 1)
and their derivatives (dotted lines in Fig. 1). The result-
ing SPMIF}, testing for the significance of event-related
responses to single words, is shown in the lower half of
Fig. 2. This should be compared to the equivalent SPM{F}
from the rate experiment (upper half). The similarity
between these two SPM{F)s is remarkable given that they
were obtained using completely different data and exper-
imental designs (epoch- or rate-related and event-relat-
ed). The fitted response, based on the estimate of hl, from
the same region as above, is shown in Fig. 5 (lower panel)
with the adjusted data. The striking similarity between
the empirically observed event-related response and that
predicted on the basis of the Volterra kernels ho, hl, and
hZ obtaining from the rate experiment (upper panel) can
be considered a validation of the estimation procedure
and the underlying model. Interestingly the empirical
response includes a slight initial “dip.” We will return to
this below.
NONLINEAR ASPECTS OF EVOKED RESPONSES
Are They Significant?
To assess the significance of the nonlinear response com-
ponents (due to hZ), over and above the first-order com-
ponents, we repeated the analysis of the rate experiment,
treating the first-order effects (i.e., the contributions de-
termined by h’) as confounds. The resulting SPM(F} is
shown in Fig. 6 and implicates both periauditory regions
and the left posterior superior temporal region (Wer-
nicke’s area), suggesting that nonlinear effects are not
only prevalent but very significant (P < 0.001 corrected)
in this experimental design.
The Form of the Kernel Estimates and Implications for
the “Structure” of Nonlinear Effects
As noted above and brought to our attention by one of our
reviewers, the elements of the second-order kernel are
roughly proportional to the product of the corresponding
elements of the first-order kernel, i.e., ~ ‘ ( T ~ , T ~ )
h1(7Jh1(7J. This can be seen by comparing the estimate
of hZ with the insert corresponding to - h ’ ( ~ ~ ) . h ’ ( ~ ~ )
Fig. 3. There are subtle differences in that the off-diago-
nal positive lobes in h2 peak around a s, whereas they
peak at 16 s in the insert (at these times the values of hZ
are slightly negative). However, the overall form is very
similar and this suggests a simple form for the underlying
nonlinear model of evoked responses:
where f(.) is a nonlinear scalar function. Expansion off(.)
in a McLaurin series gives
Eq. demonstrates the formal similarity with Eq. [I]
where ~ ’ ( T , , T , ) has been replaced by h ’ ( ~ ~ ) . h ~ ( ~ ~ ) .
simpler model is equivalent to convolving the stimulus
function with a first-order kernel (i.e., a linear “latent”
hemodynamic response function) and then taking some
nonlinear (e.g. , second-order polynomial) function of the
result. The distinction between the general form implied
by the Volterra series and this simpler form is depicted in
Fig. 7. It is pleasing to note that this simple form was
adopted by Vazquez and No11 (10) in their nonlinear
characterization of evoked visual responses. These au-
thors assumed a Gaussian form for the kernel, but still
Nonlinear Event-Related Responses
SPM{F} - Nonlinear effects
Design Matrix
FIG. 6. Left: SPM{F} testing for the significance of the second-order kernel coefficients (h2). In this
instance, the explanatory variables pertaining to the first-order kernel have been moved over to the
confound partition of the design matrix (shown on the right). The SPM{F} has been thresholded at
F = 16 (P < 0.001 corrected). Note that this SPM{F} has been thresholded at half the value
employed for the equivalent SPM{F} testing for the first- and second-order effects in Fig. 2. This
is because the values in this SPM{F) were generally smaller, although still extremely significant.
our results speak to the appropriateness of the general
form for their model.
From the perspective of the current analysis, the pa-
rameter estimates suggest a specific form for the nonlin-
ear relationship between input and measured output in
fMRI, despite the fact that no constraints (other than the
basis functions) were placed on the model. These sorts of
insights may help to identify the biophysical level at
which nonlinearities are expressed in fMRI. For example,
if the nonlinear effects manifest after a temporal convo-
lution of neuronal activity to give a hemodynamic re-
sponse, then it may be that the measured fMRI signal is
simply a saturating (nonlinear) function of hemodynamic
changes. We return to this in the discussion. Simple
nonlinear forms are also important from the point of view
of system identification using optimization techniques,
because there are fewer parameters to estimate (and their
relationship to the system in question is often more ap-
parent). However, it should be noted that the simplifica-
tion implicit in Eq. does not help in the context of
framework adopted here. This is because to make Eq. 
linear in the parameters, one comes back to Eq. .
Interactions Between Stimuli
In this section, we examine how the nonlinear effects
identified in the previous sections come to shape the
responses to different stimuli. We have chosen to do this
in terms of the effect that a preceding stimulus has on the
response to a current stimulus. This captures the essence
of nonlinear responses, in the sense that interesting non-
linearities (above and beyond a simple nonlinear map-
ping from neuronal input to hemodynamic response)
involve interactions over time.
The kernel estimates of the
previous section can be used
to specify a model that should
reproduce the hemodynamic
response to any arbitrary stim-
ulus. This means that we can
look in detail at responses to
different sequences of events
that would otherwise require a
whole series of experiments.
Of course, these simulated re-
sponses are only predictions
and suggest some interesting
experiments for empirical ver-
ification. Here, however, we
use these predictions to con-
vey, in a heuristic way, the im-
plications of the second-order
Consider the response to a
pair of stimuli, separated by a
second, in relation to the re-
sponses to each presented in
isolation. Figure 8 shows these
responses to the stimuli (up-
per panel: together-solid line,
and separately-broken lines).
To assess the impact of the
first stimulus on the response to the second, we can
subtract the response to the first stimulus from the re-
sponse to both. This gives the response to the second
stimulus in the context of the first (solid line in the lower
panel of Fig. 8). It can be seen that this response is
attenuated markedly, with an augmented undershoot, in
relation to the response obtained when the stimulus is
presented in isolation (broken line). In short, the re-
sponse to a stimulus is compromised or modulated by
preceding stimuli to give a nonlinear “refractoriness”
that depends on the interstimulus interval or rate. This
effect is only one aspect of the nonlinear interactions
embodied in the characterization, but it is an important
one. The consequence of this effect is to progressively
moderate the response to each word with increasing rates
of presentation. Figure 9 (upper panel) shows the re-
sponses, to epochs of words presented at different rates,
predicted by the model. The responses here are simply
the integral under the evoked response curve during
word presentation. The empirical response (dots) are in-
cluded for comparison. As expected [and consistent with
the results of Binder et al. (8)], the response function
deviates from a linear relationship at higher event fre-
quencies. It is interesting that for the voxel we have been
using, the nonlinear model predicts that the integrated
response would fall off at very high rates or frequencies.
This is not an artifact. In some brain regions, this effect
was observed empirically. The lower panel depicts the
modeled and empirical integrated responses for a voxel
more anteriorly in the superior temporal gyrus that
shows an inverted U dependency on presentation rate,
peaking at l/s. The neurophysiological mechanisms that
may contribute to this effect are discussed below.
Friston et al.
time-delayed input
u(t - T) i
Model implied by
Volterra series
linear combination
. . . . . . .
I u ( t : T )
Simple model
FIG. 7. Schematic depicting the difference between the finite-mem-
ory power series implied by the Volterra series model and the simpler
model suggested by the parameter estimates. u(t) represents the
input (in this case the stimulus function) and f(u,,uz,. . . . u,) some
nonlinear function with n arguments. y(f) is the output (in this instance
the hemodynamic response).
Variation in Responses Over the Brain
So far we have focussed on evoked responses at one point
in the brain. In general, the kernel estimates for other
brain regions were very similar in form. To characterize
the variability in responses over different regions, we
simulated the response to a single word at all voxels
surviving an uncorrected F value corresponding to P =
lop8 and then performed a principal component analysis
of the resulting responses. The eigenvalue spectrum (Fig.
10, upper panel) suggested that there were three main
response forms or components that could largely account
for the variation in responses. These first three principal
components are shown in the lower panel. The first
corresponds to the canonical hemodynamic response
with a very quick onset and early peak at 3 s. The second
can be interpreted in terms of a late response, peaking at
about 8 s. Interestingly, the second component shows a
pronounced early “dip” and is almost exactly the same as
the responses shown in Le and Hu (17). This early signal
decrease has been attributed to increased oxygen extrac-
tion (18) before compensatory increases in blood flow
become established (19). The third component is a late
component that covers most of the “undershoot.” The
similarity between these principal components and the
basis functions employed in the model is expected given
that (i) the form of the response is constrained by the
basis functions, and (ii) the basis functions were chosen
to “cover” likely variations in the response profile. To
indicate the spatial organization of the response varia-
tion, Fig. 11 presents the positive and negative first prin-
cipal components scores as maximum intensity projec-
tions. As might be expected, the high positive scores are
most evident in the auditory and periauditory regions
(upper panel). The negative scores are most pronounced
in posterior temporal, parietal, and extrastriate regions
(lower panel). Negative expression of the first principal
component corresponds to an evoked deQcfivQtion or
reduction in signal. This is a real phenomenon and can
be demonstrated as such by looking at the event-related
responses in the posterior superior temporal region using
independent data from the second study. Figure 12
shows the form of this response that can be characterized
as a deactivation, peaking at about 5 s followed by a more
protracted positive rebound. This unusual biphasic re-
sponse is not an artifact of global or whole brain normal-
ization (because we removed global confounds using
multiple linear regression as opposed to scaling the data)
and speaks to the ability of fMRI to detect decreases in
BOLD signal that endure far longer than the early tran-
sients mentioned above.
DISCUSSION
We have presented a nonlinear approach to characteriz-
ing evoked hemodynamic responses in fMRI that is based
response to a pair of stimuli
time [seconds)
effect of a prior stimulus
time (seconds)
FIG. 8. Top panel: The simulated responses to a pair of words
(bars) (1 s apart) presented together (solid line) and in isolation
(broken line) based on the second-order hemodynamic response
function in Fig. 3. Lower panel: The response to the second word
when preceded by the first (broken line), obtained by subtracting
the response to the first word from the response to both, and
when presented alone (broken). The difference reflects the impact
of the first word on the response to the second.
Nonlinear Event-Related Responses
nonlinear resDonses (-56,-28.121
event frequency [Hz)
nonlinear responses {-68,-16,O)
event frequency (Hz)
FIG. 9. Integrated (over the period of word presentation) re-
sponses during epochs of words, lasting for 34 s, presented at
increasing frequencies. The line represents the simulated re-
sponses using the second-order hemodynamic response function
in Fig. 3, and the dots correspond to the observed responses at
the voxel in question. Lower panel: The same analysis but for a
voxel more anterior in the superior temporal gyrus (-68, -16, 0
mm). Note the nonlinear and inverted U relationship between
integrated response and word presentation frequency.
on nonlinear system identification, in particular the use
of Volterra series. By reformulating the model, we were
able to estimate the kernel coefficients that mediate be-
tween underlying neuronal activity and the observed
hemodynamic response and make statistical inferences
about their significance. These kernel coefficients can be
thought of as high-order or nonlinear extensions of linear
convolution or “smoothing” functions and, therefore, rep-
resent a nonlinear characterization of the hemodynamic
response function. We have shown that the same nonlinear
response function can model the responses to stimuli in
different contexts (in this work, different rates of presenta-
tion) and that the nonlinear component is not only very
significant but also is quantitatively important. Its effect can
be thought of in terms of interactions between successive
stimuli, such that the responses to an extant stimulus are
modulated by the preceding stimulus. This means that re-
sponses at very high frequencies saturate and in some brain
areas start to decline again. A number of techniques and
observations have been presented in this paper, and we will
now review and extend some of the more important issues.
Nonlinear Modeling versus Linear Modeling
What Are the Implications of this Work for
Experimental Design and Analysis?
The first thing to note is that there is a fundamental
distinction between positing the same nonlinear hemo-
dynamic response function that can account for varying
responses to stimuli presented at different rates, and a
series of rate-dependent, linear hemodynamic response
functions. To make this distinction clear, consider the
analysis presented in Fig. 13. In this analysis, we have
discarded the second-order terms from the design matrix
and have treated each presentation rate as a different
stimulus type. This simply involves separating the first-
order terms into a set of columns for each rate (Fig. 12,
upper right). This represents an alternative, multiple lin-
ear regression approach to the data and yields parameter
estimates (up to first-order kernel coefficients ho and h*)
for each rate. The resulting event-related responses
(shown in the lower panel of Fig. 13) are rate-specific
and, as one might expect, show that responses to single
words are progressively attenuated when these words are
presented at high frequencies. The set of first-order he-
modynamic response functions (Fig. 13) and the single
eigenvalue spectrum
eigenvalue
first 3 principal components
time [seconds)
FIG. 10. Principal component analysis of simulated responses to
single words in different brain regions. Top panel: Normalized
eigenvalue spectrum showing only three principal components
have eigenvalues greater than unity. Lower panel: The first three
principal components (solid line-first, broken line-second, and
dotted line-third) reflecting the underlying forms of estimated he-
modynamic responses to single words.
positive expression of 1 st PC
negative expression of 1 st PC
FIG. 11. Spatial distribution of component scores from Fig. 10.
Top panel: Maximum intensity projection of the positive compo-
nent scores showing that bitemporal, periauditory regions express
the first principal component to a substantial degree. Lower panel:
As above but for the negative scores associated with the first
principal component of the response.
second-order hemodynamic response function (Fig. 3)
are both trying to model the same thing, and yet they do
so in a very distinct way. The first distinction is concep-
tual; in the nonlinear analysis, we are explaining the
Friston et al.
responses in terms of the same response function that
accommodates interactions between stimuli. In the linear
analysis we relegate these interactions to formal differ-
ences among the rate-specific response functions (and
would normally try to characterize these differences post
hoc). There is another more subtle difference between the
two analyses: In the linear analysis, we have discounted
second-order effects in the hope that a suitably shaped
first-order response function can model all the nonlin-
earities inherent in the real response. While this is justi-
fiable for epochs of a fixed rate and length, it may not be
for epochs that endure over different periods of time.
This is because interactions over time (e.g., hemody-
namic adaptation and refractoriness) may be significant,
even for a fixed stimulus frequency. Only the nonlinear
analysis would model these effects appropriately. Note
that for a fixed form of event, or epoch, the second-order
terms [e.g., xi(t).xj(t)]
can be emulated, exactly, by (more
complicated) first-order terms. In other words, with no
parametric variation in the form of the underlying neu-
ronal activity evoked, a first-order model is sufficient.
This is the rationale behind dropping the second-order
terms in the event-related study and in the linear analysis
depicted in Fig. 13.
Which Then is the Most Appropriate Anaiysis to Use?
This question is only posed in parametric experimental
designs (20) when some experimental parameter is var-
ied (for example, rate of stimulus presentation, response
rate, duration of task, etc.). The alternatives are then to
model a nonlinear response in terms of a parametrically
varying input u(t) or to treat each level of the parameter
manipulated as a separate condition (cf. the linear anal-
ysis above). In some circumstances, only the nonlinear
option may be viable, for example, if the parameter is
. . . . . .
FIG. 12. Event-related deactivation: The empirical event-related
response based on the zeroth and first-order kernel estimates
(solid line) for a voxel in the right superior temporal region at -42,
-50, 18 mm. The dots correspond to adjusted data.
Nonlinear Event-Related Responses
SPM{F) - linear analysis
rate-specific 1 st order effects
rate-specific (1 st order) responses
time {seconds}
FIG. 13. A linear analysis of the rate experiment. Top left: SPM{F} testing for the significance of the
first-order coefficients hi estimated separately (but simultaneously) for each presentation rate. This
SPM{F} has been thresholded at F = 16 (f < 0.001, corrected). The similarity with the equivalent
SPM{F)s in Fig. 2 is evident. Top right: Explanatory variables corresponding to xi(t) arranged to
model each presentation rate independently (i.e., the design matrix partition of interest). The first
five sets of columns represent the five presentation rates and the final two correspond to (short and
long) periods of rest. Lower panel: Simulated hemodynamic responses to single words (bar) using
the kernel estimates from the above design matrix, for the same voxel as in Fig. 3. These
response-function estimates are rate-specific and show an attenuated response to single words
when they are presented in the context of a high-frequency word stream. The numbers on the
response functions denote the presentation rate in wordslmin.
is possible to implement the
nonlinear analysis above with
existing tools (e.g., SPM96),
the construction of the design
matrices is complicated, and a
simple linear analysis may be
quite sufficient for most pur-
In terms of experimental de-
sign, the nonlinear effects
above mean that it is possible
to drive the brain “too hard”
with very high stimulus pre-
sentation rates. The analyses
of the present study suggest
that the optimum presentation
rate, for words, is about 11s.
The SPM{F}
One aspect of the techniques
presented in this paper is the
use of the SPM(FJ to make in-
ferences about the significance
of the response, in terms of the
response kernel coefficients.
This is an instance of the use-
fulness of the SPM(F1 [see
Buechel et al. (21) for another
example] and has been facili-
tated by recent advances in
Gaussian field theory that al-
low one to make corrections
for multiple dependent com-
parisons in F fields (16). The
importance of the SPM(F), as
opposed to SPM(t) or t maps
(and related statistical pro-
cesses), is that it reflects the
significance of a whole set of
parameter estimates, in this in-
stance the collection of kernel
coefficients that describe the
hemodynamic response (h’,
h’, and h’). We envisage that
the SPM(F) will find an in-
creasing role in fMRI, where
the emphasis will shift from
making statistical inferences
about particular simple effects
to quantifying their more com-
plicated nature and form in
terms of the parameter esti-
mates. As the models of hemo-
dynamic responses become
more sophisticated, the number
of parameter estimates involved
changing continuously and does not conform to a series
of discrete levels. In general, however, the results that
obtain from the two approaches would be similar, and
the question reduces to one of implementational expedi-
ency and simplicity in describing the results. Although it
will increase, and some device will be required to make an
inference about these parameters en masse. The SPM(F] is
one such device. It should be noted that the distribution of
the F statistics based on temporally correlated fMRI data
only approximate a true F distribution. Their use should
Friston et al.