NBER WORKING PAPER SERIES
STRUCTURAL EQUATIONS, TREATMENT EFFECTS
AND ECONOMETRIC POLICY EVALUATION
James J. Heckman
Edward Vytlacil
Working Paper 11259
 
NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
March 2005
This paper was presented by Heckman as the Fisher-Schultz Lecture at the Eighth World Meetings of the
Econometric Society, Seattle, Washington, August 13, 2000. This paper was also presented at the seminar
on Applied Price Theory at the Graduate School of Business, University of Chicago in October 2000, at a
seminar at Upsalla University, December 2000, at Harvard University, April 2001, and at the Montreal
Econometrics Seminar, September 2003. We thank Jaap Abbring, Richard Blundell and two anonymous
referees for helpful comments on the first round reports. We benefited from the close reading of Ricardo
Avelino, Jean-Marc Robin, Sergio Urzua, and Weerachart Kilenthong on the second draft. We have benefited
from a close reading by Jora Stixrud and Sergio Urzua on the third draft. We have also benefited from
comments by an anonymous referee on the second draft of this paper. Sergio Urzua provided valuable
research assistance in programming the simulations reported in this paper and was assisted by Hanna Lee.
Urzua made valuable contributions to our understanding of the random coefficient case and cases with
negative weights and made numerous valuable comments on this draft, as did Weerachart Kilenthong. See
our companion paper where these topics are developed further. This
research was supported by NSF 97-09-873, NSF-00-99195, NSF SES-0241858, and NIH R01 HD043411,
and the American Bar Foundation. The views expressed herein are those of the author(s) and do not
necessarily reflect the views of the National Bureau of Economic Research.
©2005 by James J. Heckman and Edward Vytlacil. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice, is
given to the source.
Structural Equations, Treatment Effects and Econometric Policy Evaluation
James J. Heckman and Edward Vytlacil
NBER Working Paper No. 11259
March 2005
JEL No. C1
This paper uses the marginal treatment effect (MTE) to unify the nonparametric literature on
treatment effects with the econometric literature on structural estimation using a nonparametric
analog of a policy invariant parameter; to generate a variety of treatment effects from a common
semiparametric functional form; to organize the literature on alternative estimators; and to explore
what policy questions commonly used estimators in the treatment effect literature answer. A
fundamental asymmetry intrinsic to the method of instrumental variables is noted. Recent advances
in IV estimation allow for heterogeneity in responses but not in choices, and the method breaks down
when both choice and response equations are heterogeneous in a general way.
James J. Heckman
Department of Economics
The University of Chicago
1126 E. 59th Street
Chicago, IL 60637
 
Edward Vytlacil
Stanford University
 
Evaluating the impacts of public policies, forecasting their eﬀects in new environments, and predicting
the eﬀects of policies never tried are three central tasks of economics. The structural approach and the
treatment eﬀect approach are two competing paradigms of policy evaluation.
The structural approach emphasizes clearly articulated economic models that can be used to accomplish all three tasks under the exogeneity and parameter policy invariance assumptions presented in that
literature. Economic theory is used to guide the construction of models and to suggest included and excluded variables. The functional form and exogeneity
assumptions invoked in this literature are sometimes controversial 
and the sources of identiﬁcation of parameters of these models are often not clearly articulated.
The treatment eﬀect literature as currently developed focuses on the ﬁrst task—evaluating the impact
of a policy in place—in the special case where there is a “treatment group” and a “comparison group,”
i.e. a group of nonparticipants. In the language of that literature, “internal validity” is the primary goal
and issues of forecasting out of sample or of evaluating new policies receive little attention.1
of its more limited goals, fewer explicit functional form and exogeneity assumptions are invoked. The
literature on treatment eﬀects has given rise to a new language of economic policy analysis where the link
to economic theory is often obscure and the economic policy questions being addressed are not always
clearly stated. Diﬀerent instruments answer diﬀerent economic questions that typically are not clearly
stated. Relationships among the policy parameters implicitly deﬁned by alternative choices of instruments
are not articulated.
This paper unites the two approaches to policy evaluation using the Marginal Treatment Eﬀect (MTE)
under the assumption that analysts have access to treatment and comparison groups. The MTE is the
mean response of persons to treatment at a margin that is precisely deﬁned in this paper. It is a willingness
to pay measure when outcomes are values under alternative treatment regimes.
Under the conditions speciﬁed in this paper, the MTE can be used to construct and compare alternative conventional treatment eﬀects, a new class of policy relevant treatment eﬀects and the probability
limits produced from instrumental variable estimators and matching estimators. Using the MTE, this
paper unites the selection (control function) approach, deﬁned in a nonparametric setting, with the recent
1Internal validity means that a treatment parameter deﬁned in a speciﬁed environment is free of selection bias. It is
deﬁned more precisely below.
literature on instrumental variables.
A major focus in the recent microeconomic policy evaluation literature, and a major theme of this
paper, is on constructing and estimating models with heterogeneity in responses to treatment among
otherwise observationally identical people. This literature emphasizes that responses to treatment vary
among observationally identical people, and crucially, that agents select (or are selected) into treatment
at least in part based on their own idiosyncratic response to it. This emphasis is in marked contrast
to the emphasis in the conventional representative-agent macro time series literature that ignores such
heterogeneity despite ample microeconometric evidence on it.2
Entire classes of econometric evaluation estimators can be organized by whether or not they allow for
the possibility of selection based on unobserved components of heterogeneous responses to treatment. In
the presence of such heterogeneity, a variety of diﬀerent mean treatment eﬀects can be deﬁned for diﬀerent
instruments and conditioning sets. In the absence of such heterogeneity, these diﬀerent treatment eﬀects
collapse to the same parameter.3
The dependence of estimated treatment parameters on instruments is an important and not widely
understood feature of models with heterogeneous responses on which people act.4 Instrument-dependent
parameters arise in this class of models, something excluded by assumption in conventional structural
econometric models that emphasize the estimation of invariant parameters. Two economists analyzing the
same data set but using diﬀerent valid instruments will estimate diﬀerent parameters that have diﬀerent
economic interpretations. Even more remarkably, two economists using the same instrument but with different notions about what variables belong in choice equations will interpret the output of an instrumental
variable analysis diﬀerently. Intuitions about “identifying strategies” acquired from analyzing conventional
models where responses to treatment do not vary among persons are not valid in the more general setting
analyzed in this paper. The choice of an instrument deﬁnes the treatment parameter being estimated.
The relevant question regarding the choice of instrumental variables in the general class of models studied in this paper is “What parameter is being identiﬁed by the instrument?” rather than the traditional
question of “What is the eﬃcient combination of instruments for a ﬁxed parameter?”—the question that
2Heckman summarizes the evidence on heterogeneity in responses to treatment on which agents select into treatment.
3See Heckman ; Heckman and Robb ; Heckman and Vytlacil .
4This dependence was ﬁrst noted by Heckman and Robb . See also Angrist, Graddy, and Imbens .
has traditionally occupied the attention of econometricians who study instrumental variables. Even in the
presence of least squares bias, and even assuming large samples, IV based on classical assumptions may
be more biased for a given policy parameter than OLS. The cure may be worse than the disease.
We extend the method of instrumental variables to estimate economically interpretable parameters
in models with heterogeneous treatment outcomes. We note a fundamental asymmetry intrinsic to the
method of instrumental variables. Treatment outcomes can be heterogeneous in a general way that we
make precise in this paper. Choice equations cannot be heterogeneous in the same general way. When
choices and treatment outcomes are analyzed symmetrically, the method of instrumental variables and
our extension of it breaks down, and more explicit structural approaches are necessary to solve policy
evaluation problems.
The plan of this paper is as follows. Section 1 presents a prototypical microeconometric structural
model as a benchmark to deﬁne and motivate the various treatment parameters used in the literature and
to compare and contrast structural estimation approaches with those used in the literature on treatment
eﬀects. We then deﬁne our general model and assumptions in Section 2. Our model extends the treatment
eﬀect literature by introducing choice theory into it and by using a weaker set of assumptions than those
used in the structural literature to deﬁne and identify the marginal treatment eﬀect (MTE). This section
shows how the MTE can be used to generate and unify the various treatment parameters advocated in
the recent literature and provides an economic foundation for the treatment eﬀect literature. We derive a
set of testable restrictions implied by our model, and we apply the general analysis to the special case of
a parametric Generalized Roy Model.
The conventional treatment parameters do not, in general, answer questions of economic or policy
interest. Section 3 shows how to use the MTE to deﬁne policy relevant parameters that answer well posed
economic questions. Evaluation of diﬀerent policies requires diﬀerent weights for the MTE. The MTE
plays the role of a policy invariant structural parameter in conventional econometrics for a class of policy
interventions deﬁned in this paper.5
Section 4 organizes entire classes of econometric estimators on the basis of what they assume about
the role of unobservables in the MTE function, conditional on X. Our analysis shows that traditional
instrumental variables procedures require that the marginal treatment eﬀect is the same for all persons
5Hendry discusses the role of policy invariant parameters in macro-forecasting and policy evaluation.
of given X characteristics. When the marginal treatment eﬀect varies over individuals with the same
X, we show how the instrumental variables estimand (the probability limit of the instrumental variables
estimator) can be written as a weighted average of MTE, where our general expressions nest previous
results in the literature as special cases. The interpretation of the IV estimand depends not only on
the choice of instrument used but also on what other variables are included in the choice model even if
they are not used as instruments. We show that it is not always possible to pick an instrument that
answers a particular policy problem of interest, and we show that not all instruments answer well deﬁned
policy questions. We present necessary and suﬃcient conditions to construct an instrument to produce
a particular policy counterfactual, and show how to construct the instrument when the conditions are
satisﬁed. We develop necessary and suﬃcient conditions for a particular instrument to answer some well
deﬁned policy question, and show how to construct the policy counterfactual when the conditions are
satisﬁed. We focus on instrumental variables in this paper but also consider matching and ordinary least
squares as special cases of our general model for IV.
Section 5 returns to the policy evaluation problem. The treatment eﬀect literature can be used to answer
certain narrowly focused questions under weaker assumptions than are required to recover conventional
structural parameters that answer a broad range of questions. When we attempt to address the broader
set of questions entertained in the structural econometrics literature, additional conditions are required to
extrapolate existing policies to new environments and to provide accurate forecasts of new policies never
previously experienced.
The weaker identifying assumptions invoked in the treatment eﬀect literature
are possible because of the narrower set of questions addressed by that literature. In the language of the
treatment eﬀect literature, internal validity (absence of selection bias) does not imply external validity (the
ability to generalize). When the same policy forecasting questions addressed by the structural literature are
asked of the treatment eﬀect literature, the assumption sets used in the two literatures look very similar,
especially for nonparametric versions of structural models. External validity requires stronger conditions.
Section 6 discusses the fundamental role played by the assumed absence of general forms of heterogeneity
in choice equations invoked in the recent literature under the rubric of “monotonicity” assumptions. When
both choices and treatment outcomes are modelled symmetrically, the method of instrumental variables
breaks down, and a diﬀerent approach to policy analysis is required. Section 7 concludes.
A Latent Variable Framework
The treatment eﬀect literature investigates a class of policies that have partial participation at a point in
time so there is a “treatment” group and a “comparison” group. It is not helpful in evaluating policies
that have universal participation. In contrast, the structural econometrics literature can evaluate policies
with universal participation by using functional form and support conditions to substitute for lack of a
comparison group . Throughout this paper we follow the conventional
practice in the literature and ignore general equilibrium eﬀects.6
In order to link our discussion to the literature on structural econometrics, it is fruitful to compare how
the two diﬀerent approaches analyze a Generalized Roy Model for two potential outcomes (Y0, Y1). This
model is widely used in applied econometrics .
Write potential outcomes (Y0, Y1) for conditioning variables X as
Y0 = µ0(X) + U0
Y1 = µ1(X) + U1,
where Y1 is the outcome if treated and Y0 is the outcome if not treated.7
In a model of educational
attainment, Y1 is the present value of college earnings and Y0 is the present value of earnings in the
benchmark no-treatment state (e.g. high school). Let D = 1 denote receipt of treatment so that Y1 is
observed, while D = 0 denotes that treatment was not received so that Y0 is observed. In the educational
attainment example, D = 1 if the individual selects into college, D = 0 otherwise. The observed outcome
Y is given by
Y = DY1 + (1 −D)Y0.
C = µC (Z) + UC
6See, however, the studies by Heckman, Lochner, and Taber , who demonstrate the empirical importance of investigating general equilibrium eﬀects in the context of evaluating the returns to schooling.
7Throughout this paper, we denote random variables/random vectors by capital letters and potential realizations by the
corresponding lower case letter. For example, X denotes the random vector, and x denotes a potential realization of the
random vector X.
denote the cost of receiving treatment. Net utility is D∗= Y1 −Y0 −C and the agent selects into treatment
if the net utility from doing so is positive, D = 1[D∗≥0].
The original Roy Model is a special case of this framework when there are zero costs of treatment,
µC (Z) = 0 and UC = 0. The generalized Roy model allows for costs of treatment, both driven by observable
determinants of the cost of treatment, Z, and unobservable determinants of the cost of treatment, UC. For
example, in the educational attainment example, tuition and family income operate through direct costs
µC (Z) to determine college attendance, while UC might include disutility from studying. The model can
be generalized to incorporate uncertainty about the beneﬁts and costs of treatment and to allow for more
general decision rules. Let I denote the information set available to the agent at the time when the agent
is deciding whether to select into treatment. If, for example, the agent selects into treatment when the
expected beneﬁt exceeds the expected cost, then the index is D∗= E(Y1 −Y0 −C | I). The decision to
participate is based on I and D = 1[D∗≥0] where D∗is a random variable measurable with respect to
Conventional approaches used in the structural econometrics literature assume that (X, Z) ⊥⊥(U0, U1, UC),
where “⊥⊥” denotes independence. In addition, they adopt parametric assumptions about the distributions
of the error terms and functional forms of the estimating equations, and identify the full model that can
then be used to construct a variety of policy counterfactuals. The most commonly used speciﬁcation of
this model writes µ0 (X) = Xβ0, µ1 (X) = Xβ1, µC (Z) = ZβC and assumes (U0, U1, UC) ∼N (0, Σ). This
is the normal selection model .
The parametric normal framework can be used to answer all three policy evaluation questions. First,
it can be used to evaluate existing policies by asking how policy-induced changes in X or Z aﬀect (Y, D).
Second, it can be used to extrapolate old policies to new environments by computing outcomes for the
values of X, Z that characterize the new environment. Linearity and distributional assumptions make
extrapolation straightforward. Third, this framework can be used to evaluate new policies if they can be
expressed as some known functions of (X, Z). For example, consider the eﬀect of charging tuition in an
environment where tuition has never before been charged. If tuition can be put on the same footing as
(made comparable with) another measure of cost that is measured and varies, or with returns that can be
8See Cunha, Heckman, and Navarro for a version of this model.
measured and vary, then we can use the estimated response to the variation in observed costs or returns
to estimate the response to the new tuition policy.9
This paper relaxes the functional form and distributional assumptions used in the structural literature
and still identiﬁes an economically interpretable model that can be used for policy analysis.
semiparametric approaches relax both distributional and functional form assumptions of selection models,
but typically assume exogeneity of X and do not estimate treatment eﬀects except
through limit arguments .10 The treatment eﬀect literature
seeks to bypass the ad hoc assumptions used in the structural literature and estimate treatment eﬀects
under weaker conditions. The goal of this literature is to examine the eﬀects of policies in place (i.e. to
produce internally valid estimators) rather than to forecast new policies or old policies on new populations.
Treatment Eﬀects
We now present the model of treatment eﬀects developed in Heckman and Vytlacil and Heckman,
Urzua, and Vytlacil , which relaxes most of the controversial assumptions discussed in Section 1. It
is a nonparametric selection model with testable restrictions that can be used to unify the treatment eﬀect
literature, identify diﬀerent treatment eﬀects, link the literature on treatment eﬀects to the literature in
structural econometrics and interpret the implicit economic assumptions underlying instrumental variables
and matching methods. We follow Heckman and Vytlacil and Heckman, Urzua, and Vytlacil 
in considering binary treatments. Heckman and Vytlacil and Heckman, Urzua, and Vytlacil 
extend this analysis to the case of a discrete, multi-valued treatment, for both ordered and unordered
models, while Florens, Heckman, Meghir, and Vytlacil develop a related model with a continuum
of treatments.
We use the general framework of Section 1, equations (1a)–(1d), and deﬁne Y as the measured outcome
9For example, in a present value income maximizing model of schooling, costs and returns are on the same footing so
knowledge of how schooling responds to returns is enough to determine how schooling responds to costs. See Section 5.1.
10A large part of the literature is concerned with estimation of slope coeﬃcients and not the
counterfactuals needed for policy analysis. Heckman develops the more demanding conditions required to identify
policy counterfactuals.
variable. We do not impose any assumption on the support of the distribution of Y . We use the more
general nonlinear and nonseparable outcome model
µ0(X, U0).
Examples include conventional latent variable models: Yi = 1 if Y ∗
i = µi(X)+Ui ≥0 and Yi = 0 otherwise;
i = 0, 1. Notice that in the general case, µi(X, Ui)−E(Yi | X) ̸= Ui, i = 0, 1, so even if the µi are structural,
the E(Yi | X) are not.11
The individual treatment eﬀect associated with moving an otherwise identical person from “0” to “1”
is Y1 −Y0 = ∆and is deﬁned as the eﬀect on Y of a ceteris paribus move from “0” to “1”.
ceteris paribus eﬀects are called “causal eﬀects.” To link this framework to the literature on structural
econometrics, we characterize the decision rule for program participation by an index model:
D∗= µD(Z) −UD ;
otherwise,
where (Z, X) is observed and (U1, U0, UD) is unobserved. The random variable UD may be a function
of (U0, U1). For example, in the Roy Model UD = U1 −U0, and in the Generalized Roy Model UD =
U1−U0−UC. Without loss of generality, Z includes all of the elements of X. However, our analysis requires
that Z contain at least one element not in X. The following assumptions are weaker than those used in
the conventional literature on structural econometrics or the recent literature on semiparametric selection
models and at the same time can be used to both deﬁne and identify diﬀerent treatment parameters.12
The assumptions are:
(A-1) µD(Z) is a nondegenerate random variable conditional on X;
(A-2) The random vectors (U1, UD) and (U0, UD) are independent of Z conditional on X;
(A-3) The distribution of UD is absolutely continuous with respect to Lebesgue measure;
11See Heckman and Vytlacil for alternative deﬁnitions of structure.
12As noted in Section 2, and Heckman and Vytlacil , a much weaker set of conditions is required to deﬁne the
parameters than is required to identify them. As noted in Section 5, stronger conditions are required for policy forecasting.
(A-4) The values of E|Y1| and E|Y0| are ﬁnite; and
(A-5) 1 > Pr(D = 1 | X) > 0.
Assumptions (A-1) and (A-2) are “instrumental variable” assumptions that there is at least one variable that determines participation in the program that is not in X and that is independent of potential
outcomes (Y0, Y1) given X. These are the assumptions used in the natural and social experiment literatures where randomization or pseudorandomization generates instruments. (A-2) also assumes that UD is
independent of Z given X and is used below to generate counterfactuals. Assumption (A-3) is a technical
assumption made primarily for expositional convenience. Assumption (A-4) guarantees that the conventional treatment parameters are well deﬁned. Assumption (A-5) is the assumption in the population of
both a treatment and a control group for each X. Observe that there are no exogeneity requirements for
X. This is in contrast with the assumptions commonly made in the conventional structural literature and
the semiparametric selection literature . A counterfactual “no feedback” condition
facilitates interpretability so that conditioning on X does not mask the eﬀects of D. Letting Xd denote a
value of X if D is set to d, a suﬃcient condition that rules out feedback from D to X is:
(A-6) X1 = X0 almost everywhere.
Condition (A-6) is not strictly required to formulate an evaluation model, but it enables an analyst who
conditions on X to capture the “total” or “full eﬀect” of D on Y . This assumption
imposes the requirement that X is an external variable determined outside the model and is not aﬀected
by counterfactual manipulations of D. However, the assumption allows for X to be freely correlated with
U1, U0 and UD so it can be endogenous in this sense. In this paper, we examine treatment eﬀects conditional
on X, and we maintain assumption (A-6) in this paper.
Deﬁne P(Z) as the probability of receiving treatment given Z: P(Z) ≡Pr(D = 1 | Z) = FUD|X(µD(Z)),
where FUD|X(·) denotes the distribution of UD conditional on X.13 We often denote P(Z) by P, suppressing
the Z argument. As a normalization, we impose UD ∼Unif and µD(Z) = P(Z). This normalization
is innocuous given our assumptions, because if the latent variable generating choices is D∗= ν(Z) −V,
13Throughout this paper, we will refer to the cumulative distribution function of a random vector A by FA(·) and to
the cumulative distribution function of a random vector A conditional on random vector B by FA|B(·). We will write the
cumulative distribution function of A conditional on B = b by FA|B(· | b).
where V is a general continuous random variable, we can apply a probability transform to reparameterize
the model so that µD(Z) = FV |X(ν(Z)) and UD = FV |X(V ).14
Vytlacil establishes that assumptions (A-1)–(A-5) for selection model (2a), (2b) and (3) are
equivalent to the assumptions used to generate the LATE model of Imbens and Angrist . Thus the
nonparametric selection model for treatment eﬀects developed in this paper is equivalent to an inﬂuential
instrumental variable model for treatment eﬀects. Our latent variable model satisﬁes their assumptions
and their assumptions generate our latent variable model. Our latent variable model is a version of the
standard sample selection bias model.
Our model and assumptions (A-1)–(A-5) impose two testable restrictions on the distribution of (Y, D,
Z, X). First it imposes an index suﬃciency restriction: for any measurable set A and for j = 0, 1,
Pr(Yj ∈A | X, Z, D = j) = Pr(Yj ∈A | X, P(Z), D = j).
This restriction has empirical content when Z contains two or more variables not in X. Second, the
model also imposes a testable monotonicity restriction in P = p for E(Y D | X = x, P = p) and
E(Y (1 −D) | X = x, P = p) which we develop in Appendix A.
Even though the model of treatment eﬀects developed in this paper is not the most general possible
model, it has testable implications and hence empirical content. It unites various literatures and produces
a nonparametric version of the widely used selection model, and links the treatment literature to economic
choice theory.
Deﬁnitions of Treatment Eﬀects
The diﬃculty of observing the same individual in both treated and untreated states leads to the use
of various population level treatment eﬀects widely used in the biostatistics literature and applied in
economics.15
The most commonly invoked treatment eﬀect is the Average Treatment Eﬀect (ATE):
14This representation is valid whether or not (A-2) is true. However, (A-2) imposes restrictions on counterfactual choices.
For example, if a change in government policy changes the distribution of Z by an external manipulation, under (A-2) the
model can be used to generate the choice probability from P (z) evaluated at the new arguments i.e., the model is invariant
with respect to the distribution Z.
15Heckman, LaLonde, and Smith discussed panel data cases where it is possible to observe both Y0 and Y1 for the
same person.
∆ATE(x) ≡E(∆| X = x) where ∆= Y1 −Y0.
This is the eﬀect of assigning treatment randomly
to everyone of type X assuming full compliance, and ignoring general equilibrium eﬀects.
The average impact of treatment on persons who actually take the treatment is Treatment on the Treated
(TT): ∆TT(x) ≡E(∆| X = x, D = 1).
This parameter can also be deﬁned conditional on P(Z):
∆TT(x, p) ≡E(∆| X = x, P(Z) = p, D = 1).16
The mean eﬀect of treatment on those for whom X = x and UD = uD, the Marginal Treatment Eﬀect
(MTE), plays a fundamental role in our analysis:
∆MTE(x, uD) ≡E(∆| X = x, UD = uD).
The MTE is the expected eﬀect of treatment conditional on observed characteristics X and conditional on
UD, the unobservables from the ﬁrst stage decision rule. For uD evaluation points close to zero, ∆MTE(x, uD)
is the expected eﬀect of treatment on individuals with the value of unobservables that make them most
likely to participate in treatment and who would participate even if the mean scale utility µD (Z) were
small. If UD is large, µD (Z) would have to be large to induce people to participate.
One can also interpret E(∆| X = x, UD = uD) as the mean gain in terms of Y1 −Y0 for persons with
observed characteristics X who would be indiﬀerent between treatment or not if they were exogenously
assigned a value of Z, say z, such that µD(z) = ud. When Y1 and Y0 are value outcomes, MTE is a mean
willingness to pay measure. MTE is a choice-theoretic building block that unites the treatment eﬀect,
selection and matching literatures.
A third interpretation is that MTE conditions on X and the residual deﬁned by subtracting the
expectation of D∗from D∗: ˜UD = D∗−E (D∗| Z, X) . These three interpretations are equivalent under
separability in D∗, i.e., when (3) characterizes the choice equation, but lead to three diﬀerent deﬁnitions of
MTE when a more general nonseparable model is developed. This point is developed further in Section 6.
The LATE parameter of Imbens and Angrist is a version of MTE. Deﬁne Dz as a counterfactual
choice variable, with Dz = 1 if D would have been chosen if Z had been set to z, and Dz = 0 otherwise.
Let Z(x) denote the support of the distribution of Z conditional on X = x. For any (z, z′) ∈Z(x) × Z(x)
such that P(z) > P(z′), LATE is E(∆| X = x, Dz = 1, Dz′ = 0) = E(Y1 −Y0 | X = x, Dz = 1, Dz′ = 0),
16These two deﬁnitions of treatment on the treated are related by integrating out the conditioning p variable: ∆TT(x) =
0 ∆TT(x, p)dFP (Z)|X,D(p|x, 1) where FP (Z)|X,D(·|x, 1) is the distribution of P(Z) given X = x and D = 1.
the mean gain to persons who would be induced to switch from D = 0 to D = 1 if Z were manipulated
externally from z′ to z. From the latent index model, it follows that LATE can be written as
E(Y1 −Y0 | X = x, Dz = 1, Dz′ = 0) = E(Y1 −Y0 | X = x, u′
D ≤UD < uD) = ∆LATE(x, uD, u′
for uD = Pr(Dz = 1) = P(z), u′
D = Pr(Dz′ = 1) = P(z′), where assumption (A-2) implies that Pr(Dz =
1) = Pr(D = 1 | Z = z) and Pr(Dz′ = 1) = Pr(D = 1 | Z = z′). Imbens and Angrist deﬁne the
LATE parameter as the probability limit of an estimator. Their analysis conﬂates issues of deﬁnition
of parameters with issues of identiﬁcation.
Our representation of LATE allows us to separate these
two conceptually distinct matters and to deﬁne the LATE parameter more generally. One can imagine
evaluating the right hand side of this equation at any uD, u′
D points in the unit interval and not only at
points in the support of the distribution of the propensity score P (Z) conditional on X = x where it is
identiﬁed. From assumptions (A-2), (A-3), and (A-4), ∆LATE(x, uD, u′
D) is continuous in uD and u′
D↑uD∆LATE(x, uD, u′
D) = ∆MTE(x, uD).17
Heckman and Vytlacil use assumptions (A-1)–(A-5) and the latent index structure to develop
the relationship between MTE and the various treatment eﬀect parameters shown in the ﬁrst three lines
of Table IA. For example, in that table ∆TT (x) is a weighted average of ∆MTE:
∆MTE (x, uD) hTT (x, uD) duD,
hTT (x, uD) =
1 −FP|X (uD | x)
 1 −FP|X (t | x)
SP|X (uD | x)
E (P (Z) | X = x),
and SP|X(uD | x) is Pr(P (Z) > uD | X = x) and hTT (x, uD) is a weighted distribution . The parameter ∆TT (x) oversamples ∆MTE (x, uD) for those individuals with low
values of uD that make them more likely to participate in the program being evaluated. Treatment on the
untreated (TUT) is deﬁned symmetrically with TT and oversamples those least likely to participate. The
17This follows from Lebesgue’s theorem for the derivative of an integral and holds almost everywhere with respect to
Lebesgue measure. The ideas of the marginal treatment eﬀect and the limit form of LATE were ﬁrst introduced in the
context of a parametric normal Generalized Roy model by Bj¨orklund and Moﬃtt , and were analyzed more generally
in Heckman . Angrist, Graddy, and Imbens also deﬁne and develop a limit form of LATE.
various weights are displayed in Table IB. The other weights, treatment eﬀects and estimands shown in
this table are discussed later. A central theme of this paper is that under our assumptions all estimators
and estimands can be written as weighted averages of MTE.
Observe that if E(∆| X = x, UD = uD) = E(∆| X = x), so ∆is mean independent of UD given
X = x, then ∆MTE = ∆ATE = ∆TT = ∆LATE. Therefore in cases where there is no heterogeneity in terms
of unobservables in MTE (∆constant conditional on X = x) or agents do not act on it so that UD drops
out of the conditioning set, marginal treatment eﬀects are average treatment eﬀects, so that all of the
evaluation parameters are the same. Otherwise, they are diﬀerent. Only in the case where the marginal
treatment eﬀect is the average treatment eﬀect will the “eﬀect” of treatment be uniquely deﬁned.
Figure 1A plots weights for a parametric normal Generalized Roy Model generated from the parameters
shown at the base of Figure 1B. We discuss the contents of Figure 1B in section 4. A high uD is associated
with higher cost, relative to return, and less likelihood of choosing D = 1. The decline of MTE in terms
of higher values of uD means that people with higher uD have lower gross returns. TT overweights low
values of uD (i.e., it oversamples UD that make it likely to have D = 1). ATE samples UD uniformly.
Treatment on the Untreated (E(Y1 −Y0 | X = x, D = 0)) or TUT, oversamples the values of UD unlikely
to have D = 1.
Table II shows the treatment parameters produced from the diﬀerent weighting schemes. Given the
decline of the MTE in uD, it is not surprising that TT > ATE > TUT. The diﬀerence between TT and
ATE is a sorting gain: E(Y1 −Y0 | X, D = 1) −E(Y1 −Y0 | X), the average gain experienced by people
who sort into treatment compared to what the average person would experience. Purposive selection on
the basis of gains should lead to positive sorting gains of the sort found in the table. We return to this
table to discuss the other numbers in it.
Heckman presents evidence on the nonconstancy of the MTE drawn from a variety of studies
of schooling, job training, migration and unionism. With the exception of studies of unionism, a common
ﬁnding in the empirical literature is the nonconstancy of MTE given X.18 The evidence from the literature
suggests that diﬀerent treatment parameters measure diﬀerent eﬀects, and persons participate in programs
based on heterogeneity in responses to the program being studied. The phenomenon of nonconstancy of
the MTE that we analyze in this paper is of substantial empirical interest.
18However, most of the empirical evidence is based on parametric models.
The additively separable latent index model for D (equation 3) and assumptions (A-1)–(A-5) are far
stronger than what is required to deﬁne the parameters in terms of the MTE. The representations of
treatment eﬀects deﬁned in Table IA remain valid even if Z is not independent of UD, if there are no
variables in Z that are not also contained in X, or if a more general nonseparable choice model generates
D (so D∗= µD (Z, UD)). No instrument is needed to deﬁne the parameters. These issues are discussed
further in Section 6.
Assumptions (A-1)–(A-5) will be used to interpret what instrumental variables estimate, and to relate
instrumental variables to the policy relevant treatment eﬀects. They are suﬃcient to identify ∆MTE(x, uD)
at any uD evaluation point that is a limit point of the support of the distribution of P(Z) conditional on
X = x.19 As developed in Section 6, without these assumptions and representations (in particular equation
(3)) for the choice equations, the IV method and our extension of it does not identify any economically
interpretable parameters.
The literature on structural econometrics is clear about the basic parameters of interest although it is
not always clear about the exact combinations of parameters needed to answer speciﬁc policy problems.20
The literature on treatment eﬀects oﬀers a variety of evaluation parameters. Missing from that literature
is an algorithm for deﬁning treatment eﬀects that answer precisely formulated policy questions. The MTE
provides a framework for developing such an algorithm which we now develop.
Policy Relevant Treatment Parameters
The conventional treatment parameters do not always answer economically interesting questions. Their
link to cost beneﬁt analysis and interpretable economic frameworks is often obscure.21 Each answers a
diﬀerent question. Ignoring general equilibrium eﬀects, ∆TT is one ingredient for determining whether or
not a given program should be shut down or retained. It is informative on the question of whether the
19For example, if we additionally impose that the distribution of P(Z) conditional on X has a density with respect to
Lebesgue measure, then (A-1)–(A-5) enable us to identify ∆MTE(x, uD) at all (x, uD) evaluation points in the support of the
distribution of (X, P(Z)).
20In a fundamental paper, Marschak shows how diﬀerent combinations of structural parameters are required to
forecast the impacts of diﬀerent policies.
It is possible to answer many policy questions without identifying any of the
structural parameters individually. The treatment eﬀect literature partially embodies this vision, but typically does not
deﬁne the economic question being answered, in contrast to Marschak’s approach. See Heckman and Heckman and
Vytlacil .
21Heckman and Vytlacil develop the relationship between these parameters and the requirements of cost beneﬁt
persons participating in a program beneﬁt from it in gross terms.22 The parameter ∆MTE estimates the
gross gain from a marginal expansion of a program. Many investigators estimate a treatment eﬀect and
hope that it answers an interesting question. A more promising approach to deﬁning parameters is to
postulate a policy question or decision problem of interest and to derive the treatment parameter that
answers it. Taking this approach does not in general produce the conventional treatment parameters or
the estimands produced from instrumental variables.
We consider a class of policies that aﬀect P, the probability of participation in a program, but do not
aﬀect ∆MTE. The policies analyzed in the treatment eﬀect literature that change the Z not in X are more
restrictive than the general policies that shift X and Z analyzed in the structural literature. An example
from the schooling literature would be policies that change tuition or distance to school but do not directly
aﬀect the gross returns to schooling. Since we ignore general equilibrium eﬀects in this paper, the eﬀects
on (Y0, Y1) from changes in the overall level of education are assumed to be negligible.
Let a and a′ denote two potential policies and let Da and Da′ denote the choices that would be made
under policies a and a′. Let the corresponding decision rules be Da = 1[Pa(Za) ≥UD], Da′ = 1[Pa′(Za′) ≥
UD], where Pa(Za) = Pr(Da = 1 | Za) and Pa′(Za′) = Pr(Da′ = 1 | Za′). To simplify the exposition,
we will suppress the arguments of these functions and write Pa and Pa′ for Pa(Za) and Pa′(Za′). Deﬁne
(Y0,a, Y1,a, UD,a) as (Y0, Y1, UD) under policy a, and deﬁne (Y0,a′, Y1,a′, UD,a′) correspondingly under policy
We assume that Za and Za′ are independent respectively of (Y0,a, Y1,a, UD,a) and (Y0,a′, Y1,a′, UD,a′)
conditional on Xa and Xa′. Let Ya = DaY1,a + (1 −Da)Y0,a and Ya′ = Da′Y1,a′ + (1 −Da′)Y0,a′, denote the
outcomes that would be observed under policies a and a′, respectively.
We deﬁne ∆MTE as policy invariant if
Policy Invariance E(Y1,a | UD,a = u, Xa = x) and E(Y0,a | UD,a = u, Xa = x) are invariant to the choice
of policy a.
Policy invariance can be justiﬁed by the strong assumption that the policy change does not change the
counterfactual outcomes, covariates, or unobservables, i.e., (Y0,a, Y1,a, Xa, UD,a) = (Y0,a′, Y1,a′, Xa′, UD,a′).
However, ∆MTE is policy invariant if this assumption is relaxed to the weaker assumption that the policy
change does not aﬀect the distribution of these variables conditional on X:
22It is necessary to account for costs to conduct a proper cost beneﬁt analysis. See the discussion in Heckman and Vytlacil
 for nonparametric cost-beneﬁt analysis.
(A-7) The distribution of (Y0,a, Y1,a, UD,a) conditional on Xa = x is the same as the distribution of
(Y0,a′, Y1,a′, UD,a′) conditional on Xa′ = x.
We assume (A-7) holds and discuss invariance further in Appendix B.
For the widely used Benthamite social welfare criterion V (Y ) , comparing policies using mean outcomes,
and considering the eﬀect for individuals with a given level of X = x, we obtain the policy relevant
treatment eﬀect, PRTE, denoted ∆PRTE(x):
E(V (Ya) | X = x) −E (V (Ya′) | X = x) =
(x, uD){FPa′|X(uD | x) −FPa|X(uD | x)} duD,
where FPa|X(· | x) and FPa′|X(· | x) are the distributions of Pa and Pa′ conditional on X = x, respectively,
deﬁned for the diﬀerent policy regimes and ∆MTE
= E(V (Y1,a) −V (Y0,a) | UD,a = u, Xa = x).23,24
The weights are derived in Appendix B under the assumption that the policy does not change the joint
distribution of outcomes. To simplify the notation, throughout the rest of this paper, we assume that
V (Y ) = Y. Modiﬁcations of our analysis for the more general case are straightforward.
Deﬁne ∆¯P (x) = E(Pa | X = x) −E(Pa′ | X = x), the change in the proportion of people induced
into the program due to the intervention. Assuming ∆¯P (x) is positive, we may deﬁne per person affected weights as hPRTE (x, uD) =
FPa′ |X(uD|x)−FPa|X(uD|x)
. These are the weights displayed in Table IB.
As demonstrated in the next section, in general, conventional IV weights ∆MTE
diﬀerently than either
the conventional treatment parameters (∆ATE or ∆TT) or the policy relevant parameters, and so does not
recover these parameters.
Instead of hoping that conventional treatment parameters or favorite estimators answer interesting
economic questions, one approach developed in this paper is to estimate ∆MTE
and weight it by the
appropriate weight determined by how the policy changes the distribution of P to construct ∆PRTE. An
alternative approach produces a policy weighted instrument to identify ∆PRTE by standard instrumental
23We could deﬁne policy invariance for ∆MTE in terms of expectations of V (Y1,a) and V (Y0,a).
24If we assume that the marginal distribution of Xa and Xa′ are the same as the marginal distribution of a benchmark X,
the weights can be integrated against the distribution of X to obtain the total eﬀect of the policy in the population:
E(V (Ya)) −E (V (Ya′)) = EX{E(V (Ya) | X) −E (V (Ya′) |X)}
(x, uD){FPa′|X(uD | x) −FPa|X(uD | x)} duD
variables.
We develop both approaches in the next section.
Before doing so, we ﬁrst consider what
conventional IV estimates and conditions for identifying ∆MTE. We also consider matching methods and
Instrumental Variables, Local Instrumental Variables, OLS
and Matching
In this section, we use ∆MTE to organize the literature on econometric evaluation estimators. We assume
(A-7) but for simplicity suppress the “a” and “a′” subscripts. We focus primarily on instrumental variable
estimators but also brieﬂy consider the method of matching. We present the method of local instrumental
variables.
Well established intuitions about instrumental variable identiﬁcation strategies break down
when ∆MTE is nonconstant in uD given X. Two sets of instrumental variable conditions are presented in
the current literature for this more general case: those associated with conventional instrumental variable
assumptions which are implied by the assumption of “no selection on heterogenous gains” and those
which permit selection on heterogeneous gains. Neither set implies the other, nor does either identify the
policy relevant treatment eﬀect in the general case. Each set of conditions identiﬁes diﬀerent treatment
parameters.
In place of standard instrumental variables methods, we advocate a new approach to estimating policy
impacts by estimating ∆MTE using local instrumental variables (LIV ) to identify all of the treatment
parameters from a generator ∆MTE. ∆MTE can be weighted in diﬀerent ways to answer diﬀerent policy
questions. For certain classes of policy interventions discussed in Section 5, ∆MTE possesses an invariance
property analogous to the invariant parameters of traditional structural econometrics.
We also consider whether it is possible to construct an instrument such that instrumental variables
directly estimate ∆PRTE. We establish necessary and suﬃcient conditions for the existence of such an
instrument. We also address the inverse question of whether instrumental variable estimators always answer
well-posed policy questions. In general, they do not. We present necessary and suﬃcient conditions for
a particular instrument to answer some policy counterfactual and characterize what question is answered
when an answer exists.
Conventional Instrumental Variables
In the general case with ∆MTE(x, uD) nonconstant in uD, linear IV does not estimate any of the treatment
eﬀects previously deﬁned. Let J(Z) denote an instrument written as a function of Z. We sometimes
denote J(Z) by J, leaving implicit that J is a function of Z. The standard conditions J(Z) ̸⊥⊥(U1, U0) and
Cov (J(Z), D) ̸= 0 do not, by themselves, imply that instrumental variables using J(Z) as the instrument
will identify conventional or policy-relevant treatment eﬀects. We must supplement the standard conditions
to identify interpretable parameters. To link our analysis to conventional analyses of IV, we invoke familiarlooking representations of additive separability of outcomes in terms of (U1, U0) so Y1 = µ1(X) + U1 and
Y0 = µ0(X) + U0, but this is not strictly required. All derivations and results in this section hold without
any additive separability assumption if µ1(x) and µ0(x) are replaced by E(Y1 | X = x) and E(Y0 | X = x),
respectively, and U1 and U0 are replaced by Y1 −E(Y1 | X) and Y0 −E(Y0 | X), respectively.
Two distinct sets of instrumental variable conditions in the literature are those due to Heckman and
Robb and Heckman , and those due to Imbens and Angrist . In the case where
∆MTE is nonconstant in uD, linear IV estimates diﬀerent parameters depending on which assumptions are
maintained. To establish this point, it is useful to brieﬂy review the IV method in the case of a common
treatment eﬀect deﬁned conditional on X, where Y1 −Y0 = ∆, with ∆a deterministic function of X, and
where additive separability in outcomes is assumed, as in conventional models. Using (1a) and (1b) with
U1 = U0 = U, and assuming E(U|X) = 0, we may write Y = µ0(X) + D∆+ U where ∆= µ1(X) −µ0(X).
By the law of iterated expectations, E(U | X) = 0 and Z ⊥⊥U | X imply E(UJ(Z) | X) = 0. The
standard instrumental variables intuition is that when E(UJ | X) = 0 and Cov (J, D | X) ̸= 0, linear IV
identiﬁes ∆:
(IV ) Cov (J, Y |X)
Cov (J, D|X) = Cov (J, D∆|X)
Cov (J, D|X) = ∆Cov (J, D|X)
Cov (J, D|X) = ∆= µ1(X) −µ0(X)
where the second equality follows from the assumption that ∆is a deterministic function of X. This
intuition breaks down in the heterogeneous response case where the outcomes are generated by diﬀerent
unobservables (U0 ̸= U1) so Y = µ0(X)+D∆+U0, where ∆= µ1(X)−µ0(X)+U1 −U0. This is a variable
response model.
There are two important cases of the variable response model. The ﬁrst case arises when responses are
heterogeneous, but conditional on X: people do not base their participation on these responses. In this
case, the following condition holds:
(C-1) D ⊥⊥∆| X =⇒E(∆| X, UD) = E(∆| X), ∆MTE(x, uD) is constant in uD and ∆MTE = ∆ATE =
∆TT = ∆LATE.
The second case arises when the following condition holds:
(C-2) D ̸⊥⊥∆|X and E(∆| X, UD) ̸= E(∆| X).
In this case ∆MTE is nonconstant and the treatment parameters diﬀer among each other.
Application of the standard IV equation to the general variable coeﬃcient model produces the ﬁrst
equality in IV above. Now, however, ∆is not a deterministic function of X and thus we cannot simply take
∆outside of the covariance term as in the third term of (IV ). Plugging in ∆= µ1(X) −µ0(X) + U1 −U0,
Cov (J, D∆|X)
Cov (J, D|X) = µ1(X) −µ0(X) + Cov (J, D(U1 −U0)|X)
Cov (J, D|X)
Our independence assumptions imply that J is independent of U1 −U0 conditional on X, but do not imply
that J is uncorrelated with D(U1−U0) conditional on X. Thus, in general, the covariance in the numerator
of the second term is not zero. Knowledge of (X, Z, D) and (X, Z, (U0, U1)) dependencies is not enough to
determine the covariance in the second term. We need to know joint (X, Z, D, U0, U1) dependencies.
A suﬃcient condition for producing (C-1) is the strong information condition that decisions to participate in the program are not made on the basis of U1 −U0 :
(I-1) Pr(D = 1 | Z, X, U1 −U0) = Pr(D = 1 | Z, X).
Given our assumption that (U1 −U0) is independent of Z given X, one can use Bayes’ Theorem to show
that (I-1) implies the weaker mean independence condition:
(I-2) E(U1 −U0 | Z, X, D = 1) = E(U1 −U0 | X, D = 1)
which is generically necessary and suﬃcient for linear IV to identify ∆TT and ∆ATE.
Case (C-2) is inconsistent with (I-2). IV estimates ∆LATE under the conditions of Imbens and Angrist
 . ∆LATE, selection models, and LIV, introduced below, analyze the more general case covered by
(C-2). Diﬀerent assumptions deﬁne diﬀerent parameters. In addition, as we establish in Section 4.3, even
under the same assumptions, diﬀerent instruments deﬁne diﬀerent parameters and traditional intuitions
about instrumental variables break down.
Estimating the MTE Using Local Instrumental Variables
Heckman and Vytlacil resolve this confusion using the Local Instrumental Variable (LIV )
estimator to recover ∆MTE pointwise. Conditional on X = x, LIV is the derivative of the conditional
expectation of Y with respect to P(Z) = p :
∆LIV(x, p) ≡∂E(Y | X = x, P(Z) = p)
E(Y1 −Y0|X, P(Z)) exists (almost everywhere) by assumption (A-4), and E(Y |X, P(Z)) can be recovered
over the support of (X, P(Z)). Assumptions (A-2), (A-3) and (A-4) jointly allow one to use Lebesgue’s
theorem for the derivative of an integral to show that E(Y1 −Y0 | X = x, P(Z) = p) is diﬀerentiable in
p. Thus we can recover
∂pE(Y | X = x, P(Z) = p) for almost all p that are limit points of the support
of distribution of P(Z) conditional on X = x.25 Under our assumptions, LIV identiﬁes MTE for all limit
points in the support of the distribution of P(Z) conditional on X. This expression does not require
additive separability of µ1(X, U1) or µ0(X, U0).26
Under standard regularity conditions, a variety of nonparametric methods can be used to estimate
the derivative of E(Y | X, P(Z)) and thus to estimate ∆MTE. With ∆MTE in hand, if the support of the
distribution of P(Z) conditional on X is the full unit interval, one can generate all the treatment parameters
deﬁned in Section 2 as well as the policy relevant treatment parameter presented in Section 3 as weighted
versions of ∆MTE. When the support of the distribution of P(Z) conditional on X is not full, it is still
possible to identify some parameters. For example, Heckman and Vytlacil show that to identify
ATE under our assumptions, it is necessary and suﬃcient that the support of the distribution of P(Z)
25For example, if the distribution of P(Z) conditional on X has a density with respect to Lebesgue measure, then all
points in the support of the distribution of P(Z) conditional on X are limit points of that support and we can identify
∆LIV(x, p) = ∂E(Y | X = x, P(Z) = p)
for p (almost everywhere).
26Note, however, it does require our model and assumptions, including the assumption of additive separability between UD
and Z in the latent index for selection into treatment. See the discussion in Section 6.
conditional on X includes 0 and 1. Thus, identiﬁcation of ATE does not require that the distribution
of P(Z) conditional on X be the full unit interval or that the distribution of P(Z) conditional on X
contain any limit points. Sharp bounds on the treatment parameters can be constructed under the same
assumptions imposed in this paper without imposing full support conditions. The resulting bounds are
simple and easy to apply compared with those presented in the previous literature.27
To establish the relationship between LIV and ordinary IV based on P(Z) and to motivate how LIV
identiﬁes ∆MTE, notice that from the deﬁnition of Y that the conditional expectation of Y given P(Z) is
E(Y | P(Z) = p) = E(Y0 | P(Z) = p) + E(∆| P(Z) = p, D = 1)p,
where we keep the conditioning on X implicit. Our model and conditional independence assumption (A-2)
E(Y | P(Z) = p) = E(Y0) + E(∆| p ≥UD)p.
Applying the IV or Wald estimator for two diﬀerent values of P(Z), p and p′, for p ̸= p′, we obtain:
E(Y | P(Z) = p)-E(Y | P(Z) = p′)
= ∆ATE + E(U1-U0 | p ≥UD)p-E(U1-U0 | p′ ≥UD)p′
where the expression is obtained under the assumption of additive separability in the outcomes so (1a)
and (1b) apply. Note that exactly the same equation holds without additive separability if one replaces U1
and U0 with Y1 −E(Y1|X) and Y0 −E(Y0|X).
When U1 ≡U0 or (U1 −U0) ⊥⊥UD, (case (C-1)), IV based on P(Z) estimates ∆ATE because the second
term on the right hand side of the expression (8) vanishes. Otherwise, IV estimates a diﬃcult-to-interpret
combination of MTE parameters which we analyze further below.
Another representation of E(Y | P(Z) = p) that reveals the index structure under additive separability
more explicitly writes (keeping the conditioning on X implicit) that
E(Y |P(Z) = p) = E (Y0) + ∆ATEp +
E(U1 −U0|UD = uD)duD.
27For example, see Heckman and Vytlacil for a comparison of sharp bounds under the nonparametric selection
model with the Manski sharp bounds under a weaker mean independence condition. Heckman and Vytlacil 
survey and synthesize this literature and Heckman and Vytlacil develop the bounds.
We can diﬀerentiate with respect to p and use LIV to identify ∆MTE:
∂E(Y | P(Z) = p)
= ∆ATE + E(U1 −U0|UD = p) = ∆MTE(p).
Notice that IV estimates ∆ATE when E (Y | P(Z) = p) is a linear function of p. Thus a test of the
linearity of E(Y | P(Z) = p) in p is a test of the validity of linear IV for ∆ATE, i.e., it is a test of
whether or not the data are consistent with a correlated random coeﬃcient model. The nonlinearity of
E(Y | P(Z) = p) in p provides a way to distinguish whether Case (C-1) or Case (C-2) describes the
data. It is also a test of whether or not agents can at least partially anticipate future unobserved (by the
econometrician) gains (the Y1 −Y0 given X) at the time they make their participation decisions. This
analysis generalizes to the nonseparable outcomes case. We use separability in outcomes only to simplify
the exposition and link to more traditional models. In particular, exactly the same expression holds with
exactly the same derivation for the nonseparable case if we replace U1 and U0 with Y1 −E(Y1|X) and
Y0 −E(Y0|X), respectively.28
Figure 2A plots two cases of E (Y | P(Z) = p) based on the Generalized Roy Model used to generate
the example in Figure 1A and 1B. When ∆MTE does not depend on uD the expectation is a straight
line. Figure 2B plots the derivatives of the two curves in Figure 2A. When ∆MTE depends on uD, people
sort into the program being studied positively on the basis of gains from the program, and one gets the
curved line depicted in Figure 2A. The levels and derivatives of E(Y | P(Z) = p) and standard errors can
be estimated using a variety of semiparametric methods. The derivative estimator of ∆MTE is the local
instrumental variable (LIV ) estimator of Heckman and Vytlacil . Thus it is possible to test
condition (C-1) using simple econometric methods. In the case without regressors, X, the null hypothesis
is the parametric null of linearity.29
28Making the conditioning on X explicit, we obtain that E(Y | X = x, P(Z) = p) = E(Y0 | X = x) + ∆ATE(x)p +
E(U1 −U0|X = x, Ud = uD)duD, with derivative with respect to p given by ∆MTE(x, p).
29Thus, one can apply any one of the large number of available tests for a parametric null versus a nonparametric alternative
 . With regressors, the null is nonparametric leaving E(Y | X = x, P(Z) = p)
unspeciﬁed except for restrictions on the partial derivatives with respect to p. In this case, the formal test is a test of a
nonparametric null versus a nonparametric alternative, and a formal test of the null hypothesis can be implemented using
the methodology of Chen and Fan .
What Does Linear IV Estimate?
It is instructive to consider what linear IV estimates when ∆MTE is nonconstant, and conditions (A-1)–
(A-5) hold. We consider the general nonseparable case. We consider instrumental variables conditional on
X = x using a general function of Z as an instrument, and then specialize our result using P(Z) as the
instrument. Let J(Z) be any function of Z such that Cov (J(Z), D | X = x) ̸= 0. Deﬁne
βIV (x; J) ≡[Cov (J (Z) , Y | X = x)] / [Cov (J (Z) , D | X = x)] .
Appendix B derives an expression for the numerator of this expression, using (1c) and (A-2) and letting
˜J(Z) ≡J(Z) −E(J(Z) | X)
Cov (J (Z) , Y | X) =
∆MTE(X, uD)E( ˜J(Z) | X, P(Z) ≥uD) Pr(P(Z) ≥uD | X)duD.
The denominator follows by a similar argument. By iterated expectations Cov (J(Z), D | X) = Cov (J(Z), P(Z) | X
βIV (x; J) =
∆MTE(x, uD)hIV (uD | x; J) duD,
hIV (uD | x; J) = E( ˜J(Z) | X = x, P(Z) ≥uD) Pr(P(Z) ≥uD | X = x)
Cov (J (Z) , P (Z) | X = x)
assuming the standard rank condition Cov (J (Z) , P (Z) | X = x) ̸= 0. The weights integrate to unity,
hIV (uD | x; J) duD = 1,
and can be constructed from the data on X, P(Z), J(Z) and D. Assumptions about the properties of the
weights are testable.30
We ﬁrst discuss additional properties of the weights for the special case where J(Z) = P(Z) (the
propensity score is the instrument), and then analyze the properties of the weights for a general instrument
30Expressions for IV and OLS as weighted averages of marginal response functions, and the properties and construction
of the weights, were ﬁrst derived by Yitzhaki in 1989 in a paper that was eventually published in 1996 .
He does not use the MTE, however.
J(Z). From equation (11),
hIV (uD|x; P(Z)) = [E(P(Z) | X = x, P(Z) ≥uD) −E(P(Z) | X = x)] Pr(P(Z) ≥uD | X = x)
V ar (P (Z) | X = x)
Figure 1B plots the IV weight for J (Z) = P(Z) and the MTE for our Generalized Roy model example
(see also Table 1B). Let pMin
denote the minimum and maximum points in the support of the
distribution of P(Z) conditional on X = x. The weights on MTE corresponding to the use of P(Z) as
the instrument are nonnegative for all evaluation points, are strictly positive for uD ∈(pMin
zero for uD < pMin
and for uD > pMax
Our expression for the weights does not impose any support conditions on the distribution of P(Z)
conditional on X, and thus does not require either that P(Z) be continuous or discrete. To demonstrate
this, consider two extreme special cases: (i) when P(Z) is a continuous random variable, and (ii) when
P(Z) is a discrete random variable.
First consider the case where the distribution of P(Z) conditional on X has a density with respect
to Lebesgue measure with nonnegative density on the interval (pMin
). In this case, ∆LIV(x, uD) is
well deﬁned for all uD ∈(pMin
) such that hIV(uD | x; P(Z)) > 0. Using the fact that ∆LIV(x, uD) =
∆MTE(x, uD) at evaluation points where LIV is well deﬁned, we can rewrite the expression for the IV
estimator as
βIV (x; P(Z)) =
∆LIV(x, uD)hIV(uD | x; P(Z))duD.32
Next consider the case where the distribution of P(Z) conditional on X has density with respect to
counting measure. For simplicity, assume that the support of the distribution of P(Z) conditional on X
31For uD evaluation points between pMin
, uD ∈(pMin
), we have that
E (P (Z) | P (Z) ≥uD, X = x) > E (P (Z) | X = x) and Pr(P(Z) ≥uD | X = x) > 0,
so that hIV (uD | x; P(Z)) > 0 for any uD ∈(pMin
). For uD < pMin
E (P (Z) | P (Z) ≥uD, X = x) = E (P (Z) | X = x) .
For any uD > pMax
, Pr(P(Z) ≥uD | X = x) = 0. Thus, hIV (uD | x; P(Z)) = 0 for any uD < pMin
and for any uD > pMax
hIV (uD|x; P(Z)) is strictly positive for uD ∈(pMin
), and is zero for all uD < pMin
and all uD > pMax
the weights are nonzero at the endpoints depends on the distribution of P (Z). However, since the weights are deﬁned for
integration with respect to Lebesgue measure, the value taken by the weights at pMin
does not aﬀect the value of
the integral.
32Angrist, Graddy, and Imbens develop a special case of this expression for a scalar instrument.
contains a ﬁnite number of values, {p1, ..., pK} with p1 < p2 < · · · < pK. Then E(P(Z) | X = x, P(Z) ≥
uD) is constant in uD for uD within any (pj, pj+1) interval, and Pr(P(Z) ≥uD) is constant in uD for uD
within any (pj, pj+1) interval, and thus hIV(uD | x; P(Z)) is constant in uD over any (pj, pj+1) interval. Let
qj denote the value taken by hIV(uD | x; P(Z)) for uD ∈(pj, pj + 1). Then, letting ˜qj = qj (pj+1 −pj)
βIV(x; P(Z))
E(∆|X = x, UD = uD)hIV(uD | x; P(Z))duD
E(∆|X = x, UD = uD)qjduD
qj(pj+1 −pj)
E(∆|X = x, UD = uD)
(pj+1 −pj)duD
∆LATE(x, pj, pj+1)˜qj.33
The properties of the weights for general J(Z) depend critically on the relationship between J(Z) and
P(Z). Deﬁning T(p | x; J) = E(J | P(Z) = p, X = x) −E(J|X = x),
hIV(uD | x; J) =
uDT(t | x; J)dFP|X(t|x)
Cov (J, P | X = x)
From this expression, we learn that the IV estimator with J(Z) as an instrument satisﬁes the following
properties:
(i) Two instruments J and J∗weight MTE equally at all uD evaluation points if and only if E(J|X =
x, P(Z) = p) −E(J|X = x) = E(J∗|X = x, P(Z) = p) −E(J∗|X = x) for all p in the support of the
distribution of P(Z) conditional on X = x.
(ii) The support of hIV(uD | x; J) is contained in (pMin
). Therefore hIV (t | x; J) = 0 for t < pMin
and for t > pMax
. Using any instrument other than P(Z) leads to nonzero weights only on a subset
), and using the propensity score as an instrument leads to nonnegative weights on a
larger range of evaluation points than using any other instrument.
(iii) hIV(uD | x; J) is nonnegative for all uD if E(J | X = x, P(Z) ≥p) is weakly monotonic in p. Using J
33In this special case, our analysis is a latent variable version of the formula in Imbens and Angrist .
as an instrument yields nonnegative weights on ∆MTE if E(J | X = x, P(Z) ≥p) is weakly monotonic
in p. This condition is satisﬁed when J(Z) = P(Z). More generally, if J is a monotonic function
of P(Z), then using J as the instrument will lead to nonnegative weights on ∆MTE. There is no
guarantee that the weights for a general J (Z) will be nonnegative for all uD, although the weights
integrate to unity and thus must be positive over some range of evaluation points. We produce
examples below where the instrument leads to negative weights for some evaluation points.
The propensity score plays a central role in determining the properties of the weights. The IV weighting
formula critically depends on T(p | x; J) and hence on the relationship between the instrument J(Z) and
the propensity score. For example, whether two instruments provide the same weights on MTE depends
on their relationship with P(Z) (item (i) above), the possible support of the IV weights depends on the
support of P(Z) (item (ii)) and whether an instrument will provide positive weights on MTE depends on
the instrument’s relationship with P(Z) (item (iii)).
The interpretation placed on the IV estimand depends on the speciﬁcation of P(Z) even if only Z1 (e.g.
a coordinate of Z) is used as the instrument. This drives home the point about the diﬀerence between IV
in the traditional model and IV in the more general model with heterogeneous responses analyzed in this
paper. In the traditional model, the choice of any valid instrument and the speciﬁcation of instruments
in P(Z) not used to construct a particular IV estimator does not aﬀect the IV estimand. In the more
general model analyzed in this paper, these choices matter. Two economists, using the same J(Z) = Z1,
will obtain the same IV point estimate, but the interpretation placed on that estimate will depend on the
speciﬁcation of the Z in P(Z) even if P(Z) is not used as an instrument. The weights can be positive for
one instrument and negative for another.
Table II gives the IV estimand for the Generalized Roy Model used to generate Figures 1A and 1B
using P (Z) as the instrument. The model generating D = 1 [β′Z > V ] is given at the base of Figure 1B
(Z is a scalar, β is 1, V is normal, UD = Φ
). We compare the IV estimand with the policy relevant
treatment eﬀect for a policy deﬁned at the base of Table II. If Z > 0, persons get a bonus Zt. Their
decision rule for Z > 0 is D = 1 [Z(1 + t) > V ]. People are not forced into participation in the program.
Given the assumed distribution of Z, and the other parameters of the model, we obtain hPRTE(uD) as
plotted in Figures 3A-3C (the scales diﬀer across the graphs). We use the per capita PRTE and consider
three instruments. Table III presents estimands for three instruments in the Generalized Roy models for
three environments.
The ﬁrst instrument we consider is P(Z), which ignores the policy (t) eﬀect on choices. It is estimated
on a sample with no policy in place. Its weight is plotted in Figure 3A which also displays the OLS weight
(discussed later). The IV weights for P(Z) and the weights for ∆PRTE diﬀer. This is as it should be
because ∆PRTE is making a comparison across regimes but IV in this case is making a comparison within
a no policy regime. Given the shape of ∆MTE(uD), it is not surprising that the estimand for IV based on
P(Z) is so much above the ∆PRTE which weights a lower-valued segment of ∆MTE(uD) more heavily.
The second instrument we consider exploits the variation induced by the policy in place and ﬁts it
on samples where the policy is in place. On intuitive grounds, this instrument might be thought to work
well for identifying the PRTE, but in fact it does not. The instrument is ˜P(Z, t) = P(Z(1 + t1 [Z > 0]))
which jumps in value when Z > 0. This is the choice probability in the regime with the policy in place.
Figure 3B plots the weight for this IV along with the weight for P(Z) as an IV (repeated from 3A). While
this weight looks a bit more like the weight for ∆PRTE, it is clearly diﬀerent.
Figure 3C plots the weight for an ideal instrument for PRTE: a randomization of eligibility. This
compares the outcomes in a population with the policy in place with outcomes where it is not. We use an
instrument B such that
if a person is eligible to participate in the program
otherwise.
Persons for whom B = 1, make their participation choices under the policy with a jump in Z, t1(Z > 0)
in their choice sets. If B = 0, persons are embargoed from the policy and there is no bonus. This is a
prepolicy regime. We assume Pr[B = 1 | Y0, Y1, V, Z] = Pr[B = 1] = 0.5 so all persons are equally likely to
receive or not receive eligibility for the bonus and assignment does not depend on model unobservables in
the outcome equation. The Wald estimator in this case is
E(Y | B = 1) −E(Y | B = 0)
Pr(D = 1 | B = 1) −Pr(D = 1 | B = 0).
The IV weight for this estimator is a special case of equation (11):
hIV (uD | B) =
B −E(B) | ˆP(Z) ≥uD
where ˆP(Z) = P (Z (1 + t1[Z > 0]))B P(Z)(1−B). Here, the IV is eligibility for a policy and IV is equivalent to a social experiment that identiﬁes the mean gain per participant who switches to participation in
the program. It is to be expected that this IV weight and hPRTE are identical.
Monotonicity
Monotonicity property (iii) is strong. For a general J(Z), there is no guarantee that it will be satisﬁed even
if J(Z) is independent of (Y0, Y1) given X and if J(Z) is correlated with D given X = x so that standard
IV conditions are satisﬁed. Thus if Z is a K-dimensional vector and J(Z) = Z1, even if conditional on
Z2 = z2, . . . , ZK = zK, P(Z) is monotonic in Z1, there is no guarantee that Z1 used as an instrument for
D has positive weights on the MTE.
If we redeﬁne IV for Z1 to be conditional on Z2 = z2, . . . , ZK = zK, the weights are positive. Conditioning on instruments not used to form the primary covariance relationship is a new concept that does
not appear in the conventional IV literature. In conventional cases governed by condition (C-1), any valid
instrument identiﬁes the same parameter. In the general case analyzed in this paper, diﬀerent choices of
instruments and the conditioning sets of other Z variables deﬁne diﬀerent parameters.
Figure 4 demonstrates the possibility of negative weights for the model given at its base. In this ﬁgure,
we use V rather than normalized FV (V ) = UD in order to use familiar normal algebra. This simulation is
generated from a classical normal error term selection model with nonnormal instruments. The instruments
are generated as mixtures of normals from two underlying populations. One can think of this example as a
two-component ecological model with diﬀerent J(Z), P(Z) covariance relationships in the two components.
An alternative way of saying the same thing is that there are diﬀerent (J(Z), β′Z) covariance relationships
in the two subpopulations generating D = 1(β′Z > V ). In the ﬁrst component, the covariance between
J(Z) and β′Z is .98. In the second, the covariance varies as shown in Table IV where the IV is Z1 but
the choice probability depends on Z1 and Z2 (µD(Z) = β′Z). Ceteris paribus, increasing Z1 increases the
probability that D = 1. Symmetrically, increasing Z2 holding Z1 constant also increases this probability.
Yet, since Z1 and Z2 covary, varying Z1 implicitly varies Z2, which may oﬀset the ceteris paribus eﬀect
of Z1 and produce nonmonotonicity and negative weights. In this example there are diﬀerent covariance
relationships in diﬀerent normal subcomponents of the data. As Z1 increases, P(Z) increases for some
people and decreases for other people, leading to two-way ﬂows into and out of treatment for diﬀerent
people. IV estimates the eﬀect of Z1 on outcomes not controlling for the other elements of Z. For the
conﬁguration of parameters shown there (and for numerous other conﬁgurations), the IV weight is negative
over a substantial range of values.
The negativity of the weights over certain regions exhibited in Figure 4 makes clear that Z1 (and more
generally J(Z)) fails the monotonicity condition (iii) and does not estimate a gross treatment eﬀect. Some
agents withdraw from participation in the program when Z1 is raised (not holding constant Z2) while
others enter, even though ceteris paribus a higher Z1 raises participation (D). Thus the widely held view
that IV estimates some treatment eﬀect of a change in D induced by a change in Z1, is in general false.
It estimates a net eﬀect and not a treatment eﬀect, because monotonicity may be violated. Heckman,
Urzua, and Vytlacil present stark examples where MTE is negative, the weights are negative and
instrumental variable estimates of treatment eﬀects are positive. Table IV shows how the IV estimand
changes with the weights even though the treatment parameters are the same in all three examples.
Monotonicity condition (iii) is testable. Whether condition (iii) corresponds to positive weights on
MTE depends on whether all of our assumptions hold, particularly (A-2) and representation (3). If the
weights are negative, the change in J(Z) induces two way ﬂows into and out of treatment. Since it is
possible to estimate the joint density of (J(Z), P(Z)) given X nonparametrically, under our assumptions
it is possible to test for the positivity of the weights which under our assumptions is also a test for
monotonicity condition (iii).
However (A-2) itself is not testable. Monotonicity condition (iii) is distinct
from the condition termed “monotonicity” by Imbens and Angrist . We discuss their condition in
Section 6.
Policy Relevant Instrumental Variables
We have just analyzed what IV estimates in terms of weighting MTE. Instead of picking an instrument
and hoping that it estimates something interesting, it is more natural to deﬁne an economically interesting
parameter and see if instrumental variables identify it. Suppose that there is a parameter deﬁned as a
weighted average of ∆MTE conditional on X = x. Can we construct a function of Z to use as an ordinary
instrument so that the resulting estimand corresponds to the desired weighted average of ∆MTE? This
question is especially interesting if the estimand is a policy counterfactual. We also consider whether there
is any policy counterfactual estimated by a given instrument. We initially consider the case where P(Z)
is a continuous random variable. We return at the end of this section to consider the case where the
distribution of P(Z) is discrete.
Suppose that we seek to recover a parameter deﬁned by
∆MTE(x, u)w(u|x)du by the method of linear
instrumental variables. We know from equation (12) the form of the weights corresponding to the IV
estimator for any particular instrument J(Z). We seek an instrument J(Z) that has associated weights
on MTE given by equation (12) that are the same as those on the desired parameter
uDT(t | x; J)dFP|X(t|x)
Cov (J, P | X = x)
= hIV (uD | x, J) .
Assuming that FP|X has a density with respect to Lebesgue measure, the second term in this expression
is diﬀerentiable in u (almost everywhere). Assuming that w(uD|x) is also diﬀerentiable at all points of
evaluation, it follows that w′(uD|x) = −
T(uD|x;J)fP |X(uD|x)
Cov (J,P|X=x)
. The following proposition provides conditions
under which an instrument exists with the desired properties.
Proposition 1. Under the following conditions
(i) FP|X(·) has a density with respect to Lebesgue measure;
(ii) w(·|x) satisﬁes the following properties: w(uD|x) diﬀerentiable in uD for all uD ∈ ,
0 w(uD|x)duD =
1, and w(1|x) = w(0|x) = 0;
(iii) fP|X(t|x) = 0 implies w′(t|x) = 0;
there exists an instrument Jx(Z) such that Cov (Jx, D | X = x) ̸= 0 and w(uD|x) = hIV (uD | x, Jx). An
instrument that satisﬁes these conditions is 34
w′(P(Z)|x)
fP |X(P(Z)|x)
if fP|X(P(Z)|x) > 0
if fP|X(P(Z)|x) = 0.35
Under (i), conditions (ii) and (iii) are necessary and suﬃcient for the existence of such an instrument.
Proof. See Appendix C.
Condition (i) is a regularity condition requiring that P(Z) be a continuous random variable.
examine the case where P(Z) is discrete at the end of this section.
Condition (ii) requires that the
desired weights on MTE be proper weights in the sense of integrating up to one, and also that the weights
satisfy the regularity conditions that the weights are diﬀerentiable and that the weights are zero when
evaluated at the uD values of zero and one. The ﬁrst and third of these conditions mimic the properties of
any IV weights, and the second condition mimics the property of any IV weights when the instrument is
continuous. Condition (iii) is a strong, but natural, condition. It requires that the support of the propensity
score includes the support of w′(·|x). Thus, the density of the propensity score has to be positive at any
evaluation point where w′(· | x) is nonzero. This condition will always be satisﬁed if fP|X(t|x) > 0 for all
t ∈ . Given (i), if (ii) or (iii) fails, then no instrument exists that provides the desired weights. If the
desired weights do not integrate to one or are not diﬀerentiable, then as long as P(Z) is continuous (has
a distribution that is absolutely continuous with respect to Lebesgue measure), there will not exist any
instrument that provides the desired weights. If the weights are nonconstant over an interval outside of
the support of the propensity score, then no such instrument can be constructed that would provide the
desired weights.
One implication of Proposition 1 is that if P(Z) is continuous, when the MTE depends on uD in a
nontrivial way there does not exist any instrument that provides the weights corresponding to ATE or TT.
To see this, recall that the weights for ATE and TT do not satisfy w(1 | x) = w(0 | x) = 0, so that the
34When such an instrument exists, it will not be unique, since the IV estimand will be invariant to rescaling or location
shifts for the instrument.
35Note that fP |X(P(Z)|x) > 0 with probability 1 so that Jx(Z) = w′(P(Z)|x)/fP |X(P(Z)|x) with probability 1.
weights for ATE and TT do not satisfy condition (ii) of the proposition. Thus, under assumptions (A-1)-
(A-5) and under the additional assumptions of the proposition, no instrument exists giving the weights for
ATE or TT if P(Z) is a continuous random variable. This statement leaves open the question of whether
instruments will exist that answer policy counterfactuals. We now specialize the previous proposition for
the special case of policy weights, using the notation for policy counterfactuals from Section 3.
Proposition 2. Assume
(i) FP|X(·), FPa′|X(·) and FPa|X(·) have densities with respect to Lebesgue measure where P is the initial
(benchmark) probability and Pa′ and Pa are the probabilities associated with two policies (possibly)
distinct from the benchmark policy.
(ii) E(Pa|X = x) ̸= E(Pa′|X = x);
(iii) for any t, fP|X(t|x) = 0 implies fPa|X(t|x) −fPa′|X(t|x) = 0.
Deﬁne Jx to be a policy relevant instrument if it satisﬁes Cov (Jx, D | X = x) ̸= 0 and
hIV (uD | x, Jx) =
uDT(t | x; Jx)dFP|X(t|x)
Cov (Jx, P | X = x)
FPa′|X(t | x) −FPa|X(t | x)
E(Pa′ | X = x) −E(Pa | X = x).
Given condition (i) and (ii), condition (iii) is necessary and suﬃcient for the existence of such an instrument. If the instrument exists, it can be constructed as: 36
fPa′ |X(P(Z)|x)−fPa|X(P(Z)|x)
fP |X(P(Z)|x)
if fP|X(P(Z)|x) > 0
if fP|X(P(Z)|x) = 0.37
Proof. Follows by verifying the conditions of Proposition 1. See Appendix C.
Condition (i) requires that the propensity score be a continuous random variable in a benchmark
regime and under both alternative regimes. Condition (ii) requires that a fraction of individuals selecting
into treatment under regime a is diﬀerent than the fraction under regime a′. Condition (iii) imposes the
36If such a Jx(Z) exists, then any linear function of Jx(Z) will also produce the desired set of weights.
37Note that fP |X(P(Z)|x) > 0 with probability 1 so that Jx(Z) =
(fPa′ |X(P (Z)|x)−fPa|X(P (Z)|x))
fP |X(P (Z)|x)
with probability 1.
requirement that the densities of the propensity score in the two regimes only diﬀer at evaluation points
in the support of the benchmark propensity score. If (iii) fails, then no policy relevant instrument can be
constructed.
An immediate corollary of the proposition is that IV using the propensity score as the instrument
recovers the policy relevant parameter if
P(Z) = α(X) + β(X)
fPa′|X(P(Z)) −fPa|X (P(Z))
fP|X(P(Z))
where α(X) = E(P(Z)|X) and β(X) = −V ar (P(Z) | X), i.e. only if the propensity score is linear in
{fPa′|X(P(Z)) −fPa|X(P(Z))}/fP|X(P(Z)).
A related question asks whether, given an instrument, there exists a policy counterfactual such that
the given instrument is the policy relevant instrument for that counterfactual. We investigate this question
for policy counterfactuals starting from a benchmark distribution of P(Z) (the benchmark policy is a so
Pa(Za) = P(Z)) to some new policy characterized by Pa′(Za′). We ﬁrst answer the question for the special
case where the propensity score is the instrument. Solving for fPa′|X(P(Z)) in (13), the propensity score
will be the policy relevant instrument for a policy characterized by
fPa′|X(uD) = fP|X(uD)
1 −uD −E(P(Z)|X)
V ar (P(Z) | X)
If fPa′|X given by equation (14) is a proper density, then instrumental variables using the propensity score
directly estimates the eﬀect of a policy intervention that changes the density of the propensity score from
fP|X to fPa′|X where fPa′|X is given by equation (14). To be a proper density, fPa′|X must integrate to one
and be nonnegative for all evaluation points. fPa′|X(·) integrates to one.38 fPa′|X(·) will be nonnegative and
thus a proper density if and only if uD −E(P(Z)|X) ≤V ar (P(Z)) for all uD such that fP|X(uD) > 0. If
we let pMax
denote the maximum of the support of P(Z) conditional on X, we can rewrite this condition
−E(P(Z)|X = x) ≤V ar (P(Z) | X = x). Nothing guarantees that this condition holds so one
cannot guarantee that an instrument produces any policy counterfactual. Not all instruments answer well
posed policy questions.
1 −uD−E(P (Z)|X)
V ar (P (Z)|X)
duD = 1 since
uDfP |X(uD)duD = E(P(Z)|X)
We next consider the question of whether a general instrument is the policy relevant instrument for
some policy. Following the same series of steps used to establish (14), if the instrument J(Z) answers a
corresponding policy question, then the policy imposes the restriction that
fPa′|X(uD) = fP|X(uD)
1 −E(J(Z)|X, P(Z) = uD) −E(J(Z)|X)
Cov (J, P(Z) | X)
The implied fPa′(·) integrates to one. It is nonnegative for all evaluation points if and only if
E(J(Z)|X, P(Z) = uD) −E(J(Z)|X)
Cov (J, P(Z) | X)
for all uD such that fP|X(uD) > 0.
If this condition fails, the instrument is not the policy relevant
instrument for any policy. Nothing in the structure of the problem imposes this requirement.
The preceding analysis conditions on X. Suppose that we wish to recover unconditional parameters,
e.g., those deﬁned by
∆MTE(x, u)w(u|x)du
dFX(x). If the conditions of Proposition 1 hold for X = x
(almost everywhere), then one solution would be to construct Jx(Z) for each x, estimate the parameter
conditional on X for each x, and then average over x values. However, from the construction of Jx(Z), one
can use instrumental variables unconditional on X with the constructed J(Z) as the instrument to obtain
the desired parameter in one step.
Proposition 3. Assume that the conditions of Proposition 1 hold for almost all X. Construct
w′(P(Z)|X)
fP |X(P(Z))
if fP|X(P(Z)) > 0
if fP|X(P(Z)) = 0.39
Cov (J(Z), Y )
Cov (J(Z), D) =
∆MTE(x, uD)w(uD | x)du
Proof. See Appendix C.
Thus far we have considered the case where P(Z) is a continuous random variable.
Is it possible to
construct an instrument that produces the desired weights if P(Z) is discrete? The following proposition
39Note that fP |X(P(Z)|X) > 0 with probability 1 so that J(Z) = w′(P(Z)|X)/fP |X(P(Z)|X) with probability 1.
shows that instrumental variables estimators are only able to produce a very narrow range of weights if
P(Z) is discrete. In particular, they only produce weights given by step functions with the jumps in the
weight function occurring only at the support points of P(Z).
Proposition 4. Under the following conditions
(i) The support of the distribution of P(Z) conditional on X is a ﬁnite set, {p1, ..., pK} with p1 < p2 <
. . . < pK and with Pr[P(Z) = pj | X = x] > 0 for each j = 1, ..., K;
(ii) w(·|x) satisﬁes the following properties:
0 w(uD|x)du = 1, and w(uD|x) = 0 for uD ≤p1 and for
(iii) w(uD|x) is constant in u over the interval (pj, pj+1] for j = 1, ..., K;
there exists an instrument Jx(Z) such that Cov (Jx, D | X = x) ̸= 0 and
uDT(t | x; Jx)dFP|X(t|x)
Cov (Jx, P | X = x)
An instrument that satisﬁes these conditions is
Pr[P(Z) = pj | X = x](wj −wj+1)1[P(Z) = pj],
where wj denotes the (constant) value of w(uD|x) over the interval (pj−1, pj] for j = 2, ..., K −1, and where
w1 = wK+1 = 0.40Given condition (i), conditions (ii) and (iii) are necessary and suﬃcient for the existence
of such an instrument.
Proof. See Appendix C.
Thus, if P(Z) is a discrete random variable, only a very limited set of possible weights on P(Z) can be
captured through proper choice of the instrument so the class of policies that can be generated by IV is
very limited. We next use our framework to analyze the OLS estimator and the assumptions about ∆MTE
imposed in one widely used version of the method of matching.
40When such an instrument exists, it will not be unique, since the IV estimand will be invariant to rescaling or location
shifts for the instrument.
OLS Weights and Matching
The OLS estimator can also be represented as a weighted average of ∆MTE.
The weight is given in
Table IB where U1 and U0 are deﬁned as deviations from conditional expectations, U1 = Y1 −E(Y1 | X),
U0 = Y0 −E(Y0 | X). Unlike the weights for ∆TT and ∆ATE, these weights do not necessarily integrate
to one and they are not necessarily nonnegative. The OLS weights for the Generalized Roy Model are
plotted in Figure 1B. The negative component of the OLS weight leads to a smaller OLS treatment
estimate compared to the other treatment eﬀects in Table II.
Table II shows the estimated OLS treatment eﬀect for the Generalized Roy example. For a binary
regressor D, OLS conditional on X identiﬁes
E(Y1 | X, D = 1) −E(Y0 | X, D = 0)
E(Y1 −Y0 | X, D = 1) + {E(Y0 | X, D = 1) −E(Y0 | X, D = 0)},
where the term in braces is the “selection bias” term—the diﬀerence in pretreatment outcomes between
treated and untreated individuals. It is also the bias for ∆TT. The large negative selection bias in this
example is consistent with comparative advantage as emphasized by Roy . People who are good in
sector 1 (i.e. treatment) may be very poor in Sector 0 (no treatment). The diﬀerences among the policy
relevant treatment eﬀects, the conventional treatment eﬀects and the OLS estimand are illustrated in Figure 3A and Tables II and III. As is evident from Table II, it is not at all clear that the instrumental variable
estimator, with instruments that satisfy classical properties, performs better than OLS in identifying the
policy relevant treatment eﬀect.
If there is no selection conditional on covariates, UD ⊥⊥(Y1, Y0) | X, then E(U1 | X, UD) = E(U1 |
X) = 0 and E(U0 | X, UD) = E(U0 | X) = 0 so that the OLS weights are unity and OLS identiﬁes
ATE. OLS is a form of matching. Furthermore, UD ⊥⊥(Y1, Y0) | X implies that ∆MTE(x, uD) does not
vary with uD, i.e., ∆MTE(X, uD) = ∆MTE(X, u′
D) for uD, u′
D (almost everywhere) so all treatment eﬀects
are the same. Observe that given the assumed conditional independence in terms of X, we can identify
ATE and TT without requiring a Z satisfying (A-2). If there is such a Z, the conditional independence
condition implies under (A-1)–(A-5) that E(Y | X, P(Z) = p) is linear in p. This conditional independence
assumption is invoked in the method of matching and has come into wide spread use. The method is based
upon the assumption that there is no purposeful selection into the program based on unmeasured (by the
econometrician) components of gain41.
One can weaken the assumption that UD ⊥⊥(Y1, Y0) | X to the condition that Y1 and Y0 are mean
independent of D conditional on X.42 However, D will be mean independent of Y1, Y0 conditional on X
without UD being independent of Y1, Y0 conditional on X only if fortuitous balancing occurs with regions
of positive Y1, Y0 dependence on UD and regions of negative Y1, Y0 dependence on UD just exactly oﬀsetting
each other. Such balancing is ruled out in the Roy model and in the Generalized Roy Model.43,44 We next
apply our framework to analyze policy forecasting problems.
Out of Sample Policy Forecasting, Forecasting the Eﬀects of
New Policies and Structural Models Based on the MTE
Section 3 introduced the concept of the Policy Relevant Treatment Eﬀect and invokes a policy invariance
assumption. In this section, we present conditions for constructing PRTE for new environments and for
new programs using historical data.
Using the terminology of Campbell and Stanley , estimating the impact of a program in place
in a particular environment is the problem of “internal validity.” Extrapolating internally valid estimates
to new environments, “external validity,” or forecasting the eﬀects of new policies, are also important
problems which we now address.
Let a ∈A denote a policy characterized by random vector Za. Let e ∈E denote an environment
41See Heckman and Navarro and Heckman and Vytlacil for a more extensive discussion of matching estimators.
42See Heckman, Ichimura, Smith, and Todd and Heckman, Ichimura, and Todd . If the goal of the analysis
is to estimate ∆TT, one can get by with the weaker assumption that only Y0 is mean independent of D conditional on X
since E (Y1 | D = 1, X = x) is identiﬁed from observational data so there can be selection arising from dependence between
43In particular, assume Yj = µj(X)+Uj for j = 0, 1, assume D = 1[Y1−Y0 ≥C(Z)+UC], and let UD = UC−(U1−U0). Then
if UC ⊥⊥(U1 −U0), and UC has a log concave density, then E(Y1 −Y0|X, UD = uD) is decreasing in uD, ∆TT(x) > ∆ATE(x),
and the matching conditions do not hold. If UC ⊥⊥(U1 −U0) but UC does not have a log concave density, then it is still
the case that (U1 −U0, UD) is negative quadrant dependent. One can show that (U1 −U0, UD) being negative quadrant
dependent implies that ∆TT(x) > ∆ATE(x), and thus again that the matching conditions cannot hold.
See Heckman and
Vytlacil for further discussion.
44It is sometimes said that the matching assumptions are “for free” because one can always
replace unobserved F(Y1 | X = x, D = 0) with F(Y1 | X = x, D = 1) and unobserved F(Y0 | X = x, D = 1) with
F(Y0 | X = x, D = 0). This ignores the counterfactual states generated under the matching assumptions that (C-1) is true
in the population. The assumed absence of selection is not a “for free” assumption, and produces fundamentally diﬀerent
counterfactual states for the same model under matching and selection assumptions.
characterized by random vector Xe. A history, H, is a collection of policy-environment (a, e) pairs that
have been experienced and documented. We assume that the environment is autonomous so the choice of
a does not aﬀect Xe. Letting Xe,a denote the value of Xe under policy a, autonomy requires that
(A-8) Xe,a = Xe
(autonomy).
Autonomy is a more general notion than the concept introduced in (A-6). They are the same when the
policy is a treatment. General equilibrium feedback eﬀects can cause a failure of autonomy. In this section
we will assume autonomy, in accordance with the partial equilibrium tradition in the treatment eﬀect
literature.45
Evaluating a particular policy a′ in environment e′ is straightforward if (a′, e′) ∈H. One simply looks at
the associated outcomes and treatment eﬀects formed in that policy environment and applies the methods
previously discussed to obtain internally valid estimates. The challenge comes in forecasting the impacts
of policies (a′) in environments (e′) for (a′, e′) not in H.
We show how ∆MTE plays the role of a policy-invariant functional that aids in creating counterfactual
states never previously experienced. We focus on the problem of constructing the policy relevant treatment
eﬀect ∆PRTE but our discussion applies more generally to the other treatment parameters.
Given the assumptions invoked in Section 3, ∆MTE can be used to evaluate a whole menu of policies
characterized by diﬀerent conditional distributions of Pa′. In addition, given our assumptions, we can focus
on how policy a′, which is characterized by Za′, produces the distribution FPa′|X which weights an invariant
∆MTE without having to conduct a new investigation of (Y, X, Z) relationships for each proposed policy.46
Constructing Weights for New Policies in a Common Environment
The problem of constructing ∆PRTE for policy a′ (compared to ¯a) in environment e when (a′, e) /∈H entails
constructing E (V (Ya′)). We maintain the assumption that the baseline policy is observed, so (¯a, e) ∈H.
We assume (A-1)–(A-5), (A-7) and (A-8) and use (3) to characterize choices. The policy does not change
the distribution of (Y0, Y1, UD) conditional on X. Under these conditions, equation (6) is a valid expression
45However, see Heckman, Lochner, and Taber for an example of a nonautonomous treatment model.
46Ichimura and Taber present a discussion of local policy analysis in a more general framework without the MTE
structure, using a framework developed by Hurwicz .
for PRTE and constructing PRTE only requires identiﬁcation of ∆MTE and constructing FPa′|Xe from the
policy histories He, deﬁned as the elements of H for a particular environment e, He = {a : (a, e) ∈H}.
Associated with the policy histories a ∈He is a collection of policy variables {Za : a ∈He}. Suppose
that a new policy a′ can be written as Za′ = Ta′,j(Zj) for some j ∈He where Ta′,j is a known deterministic
transformation and Za′ has the same list of variables as Zj. Examples of policies that can be characterized
in this way are tax and subsidy policies on wages, prices and incomes that aﬀect unit costs (wages or
prices) and transfers. Tuition might be shifted upward for everyone by the same amount, or tuition might
be shifted according to a nonlinear function of current tuition, parents’ income, and other observable
characteristics in Zj.
Constructing FPa′|Xe from data in the policy history entails two distinct steps. From the deﬁnitions,
Pr(Pa′ ≤t | Xe) = Pr(Za′ : Pr(Da′ = 1 | Za′, Xe) ≤t | Xe). If (i) we know the distribution of Za′, and
(ii) we know the function Pr(Da′ = 1 | Za′ = z, Xe = x) over the appropriate support, we can then recover
the distribution of Pa′ conditional on Xe. Given that Za′ = Ta′,j(Zj) for a known function Ta′,j(·), step
(i) is straightforward since we recover the distribution of Za′ from the distribution of Zj by using the fact
that Pr(Za′ ≤t | Xe) = Pr(Zj : Ta′,j(Zj) ≤t | Xe). Alternatively, part of the speciﬁcation of the policy
a′ might be the distribution Pr(Za′ ≤t | Xe). We now turn to the second step, recovering the function
Pr(Da′ = 1 | Za′ = z, Xe = x) over the appropriate support.
If Za′ and Zj contain the same elements though possibly with diﬀerent distributions, then a natural
approach to forecasting the new policy is to postulate that
Pr(Dj = 1 | Zj = z, Xe)
Pr(Da′ = 1 | Za′ = z, Xe) = Pa′(z),
i.e. that over a common support for Zj and Za′ the known conditional probability function and the desired
conditional probability function agree. Condition (15) will hold, for example, if Dj = 1[µD(Zj) −UD ≥0],
Da′ = 1[µD(Za′) −UD ≥0], Zj ⊥⊥UD | Xe, and Za′ ⊥⊥UD | Xe. Even if condition (15) is satisﬁed on a
common support, the support of Zj and Za′ may not be the same. If the support of the distribution of
Za′ is not contained in the support of the distribution of Zj, then some form of extrapolation is needed.
Alternatively, if we strengthen our assumptions so that (15) holds for all j ∈He, we can identify Pa′(z) for
all z in S
j∈He Supp (Zj). However, there is no guarantee that the support of the distribution of Za′ will be
contained in S
j∈He Supp (Zj), in which case some form of extrapolation is needed.
If extrapolation is required, then one approach is to assume a parametric functional form for Pj(·).
Given a parametric functional form, one can use the joint distribution of (Dj, Zj) to identify the unknown
parameters of Pj(·) and then extrapolate the parametric functional form to evaluate Pj(·) for all evaluation
points in the support of Za′. Alternatively, if there is overlap between the support of Za′ and Zj,47 so there
is some overlap in the historical and policy a′ supports of Z, we may use nonparametric methods presented
in Matzkin with functional restrictions (e.g. homogeneity) to construct the desired probabilities on
new supports or to bound them. Under the appropriate conditions, we may use analytic continuation to
extend Pr(Dj = 1|Zj = z, Xe = x) to a new support for each Xe = x .
The approach just presented is based on the assumption stated in equation (15). That assumption is
quite natural when Za′ and Zj both contain the same elements, say they both contain tuition and parent’s
income. However, in some cases Za′ might contain additional elements not contained in Zj. As an example,
Za′ might include new user fees while Zj consists of taxes and subsidies but does not include user fees. In
this case, the assumption stated in equation (15) is not expected to hold and is not even well deﬁned if Za′
and Zj contain a diﬀerent number of elements.
A more basic approach analyzes a class of policies that operate on constraints, prices and endowments
arrayed in vector C. Given the preferences and technology of the agent, a given C = c, however arrived at,
generates the same choices for the agent. Thus a wage tax oﬀset by a wage subsidy of the same amount
produces a wage that has the same eﬀect on choices as a no-policy wage. Policy j aﬀects C (e.g. it
aﬀects prices paid, endowments and constraints). Deﬁne a map Φj : Zj −→Cj which maps a policy j,
described by Zj, into its consequences (Cj) for the baseline, ﬁxed-dimensional vector C. A new policy a′,
characterized by Za′, produces Ca′ that is possibly diﬀerent from Cj for all previous policies j ∈He.
47If we strengthen condition (15) to hold for all j ∈He, then the condition becomes that Supp (Za′) ∩S
j∈He Supp (Zj) is
not empty.
To construct the random variable Pa′ = Pr (Da′ = 1 | Za′, Xe), we postulate that
 Dj = 1 | Zj ∈Φ−1
j (c), Xe = x
Pr (Dj = 1 | Cj = c, Xe = x)
Pr (Da′ = 1 | Ca′ = c, Xe = x)
 Da′ = 1 | Za′ ∈Φ−1
a′ (c), Xe = x
j (c) = {z : Φj(z) = c} and Φ−1
a′ (c) = {z : Φa′(z) = c}. Given these assumptions, our ability to
recover Pr (Da′ = 1 | Za′ = z, Xe = x) for all (z, x) in the support of (Za′, Xe) depends on what Φj functions
have been historically observed and how rich the histories of Cj, j ∈He are. For each za′ evaluation point
in the support of the distribution of Za′, there is a corresponding c = Φa′(za′) evaluation point in the
support of the distribution of Cj = Φj(Zj). If, in the policy histories, there is at least one j ∈He such
that Φj(zj) = c for a zj with (zj, x) in the support of the distribution of (Zj, Xe) then we can construct the
probability of the new policy from data in the policy histories. The methods used to extrapolate Pa′(·) over
new regions, discussed previously, apply here. If the distribution of Ca′ (or Φa′ and the distribution of Za′)
is known as part of the speciﬁcation of the proposed policy, the distribution of FPa′|Xe can be constructed
using the constructed Pa′. Alternatively, if we can relate Ca′ to Cj by Ca′ = Ψa′,j(Cj) for a known function
Ψa′,j or if we can relate Za′ to Zj by Za′ = Ta′,j(Zj) for a known function Ta′,j, and the distributions of Cj
and/or Zj are known for some j ∈He, we can apply the method previously discussed to derive FPa′|Xe and
hence the policy weights for the new policy.
This approach assumes that a new policy acts on components of C like a policy in He, so it is possible
to forecast the eﬀect of a policy with nominally new aspects. The essential idea is to recast the new
aspects of policy in terms of old aspects previously measured. Thus in a model of schooling, let D =
1 [Y1 −Y0 −B ≥0] where Y1 −Y0 is the discounted gain in earnings from going to school and B is the
tuition cost. Here the eﬀect of cost is just the negative of the eﬀect of return. Historically, we might only
observe variation in Y1 −Y0 (say tuition has never previously been charged). But B is on the same footing
(has the same eﬀect on choice, except for sign) as Y1 −Y0. This identiﬁed historical variation in Y1 −Y0
can be used to nonparametrically forecast the eﬀect of introducing B, provided that the support of Pa′
is in the historical support generated by the policy histories in He. Otherwise, some functional structure
(parametric or semi-parametric) must be imposed to solve the support problem for Pa′.
As another example, following Marschak , consider the introduction of wage taxes in a world
where there has never before been a tax. Let Zj be the wage without taxes. We seek to forecast a post-tax
net wage Za′ = (1 −τ) Zj + b where τ is the tax rate and b is a constant shifter. Thus Za′ is a known
linear transformation of policy Zj. We can construct Za′ from Zj. We can forecast under (A-2) using
Pr (Dj = 1 | Zj = z) = Pr (Da′ = 1 | Za′ = z). This assumes that the response to after tax wages is the
same as the response to wages at the after tax level. The issue is whether Pa′|Xe lies in the historical
support, or whether extrapolation is needed. Nonlinear versions of this example can be constructed.
As a ﬁnal example, environmental economists use variation in one component of cost (e.g. travel cost)
to estimate the eﬀect of a new cost (e.g. a park registration fee). See Smith and Banzhaf . Relating
the costs and characteristics of new policies to the costs and characteristics of old policies is a standard,
but sometimes controversial, method for forecasting the eﬀects of new policies.
In the context of our model, extrapolation and forecasting are conﬁned to constructing Pa′ and its
distribution. If policy a′, characterized by vector Za′, consists of new components that cannot be related
to Zj, j ∈He, or a base set of characteristics whose variation can be identiﬁed, the problem is intractable.
Then Pa′ and its distribution cannot be formed using econometric methods applied to historical data.
When it can be applied, our approach allows us to simplify the policy forecasting problem and concentrate our attention on forecasting choice probabilities and their distribution in solving the policy forecasting
problem. We can use choice theory and choice data to construct these objects to forecast the impacts of
new policies, by relating new policies to previously experienced policies.
Forecasting the Eﬀects of Policies in New Environments
When the eﬀects of policy a are forecast for a new environment e′ from baseline environment e, and
Xe ̸= Xe′, in general both ∆MTE (x, uD) and FPa|Xe will change. In general, neither object is environment
invariant.48
The new Xe′ may have a diﬀerent support than Xe or any other environment in H.
addition, the new (Xe′, UD) stochastic relationship may be diﬀerent from the historical (Xe, UD) stochastic
relationship. Constructing FPa|Xe′ from FPa|Xe and FZa|Xe′ from FZa|Xe can be done using (i) functional
form (including semiparametric functional restrictions) or (ii) analytic continuation methods. Notice that
the maps Ta,j and Φa may depend on Xe and so the induced changes in these transformations must also
48We suppress the dependence of UD on a for notational convenience.
be modelled. There is a parallel discussion for ∆MTE (x, uD). The stochastic dependence between Xe′ and
(U1, U0, UD) may be diﬀerent from the stochastic dependence between Xe and (U1, U0, UD). We suppress
the dependence of U0 and U1 on e and a only for convenience of exposition and make it explicit in the next
paragraph.
Forecasting new stochastic relationships between Xe′ and (U1, U0, UD) is a diﬃcult task. It can be
avoided if we invoke the traditional exogeneity assumptions of classical econometrics:
(A-9) (U1,e,a, U0,e,a, UD,e,a) ⊥⊥(Xe, Za)
Under (A-9), we only encounter the support problems for both ∆MTE and the distribution of Pr (Da = 1 | Za, Xe)
in constructing policy counterfactuals.
Conditions (A-7), (A-8) and (A-9) are unnecessary if the only goal of the analysis is to establish internal
validity, the standard objective of the treatment eﬀect literature. Autonomy and exogeneity conditions
become important issues if we seek external validity. An important lesson from this analysis is that as we
try to make the treatment eﬀect literature do the tasks of structural econometrics (i.e. make out of sample
forecasts), the assumptions invoked in the two literatures come together.
A Comparison of Three Approaches
Table V compares the strengths and limitations of the three approaches to policy evaluation that we have
discussed: the structural approach, the conventional treatment eﬀect approach, and the recently developed
approach to treatment eﬀects based on the MTE function developed in this paper.
The approach based on the MTE function and the structural approach share interpretability of parameters. Like the structural approach, it addresses a range of policy evaluation questions. The MTE
parameter is less comparable and less easily extrapolated across environments than are structural parameters, unless nonparametric versions of invariance and exogeneity assumptions are made. However, ∆MTE is
comparable across populations with diﬀerent distributions of P (conditional on Xe) and results from one
population can be applied to another population under the conditions presented in this section. Analysts
can use ∆MTE to forecast a variety of policies. This invariance property is shared with conventional structural parameters. Our framework solves the problem of external validity which is ignored in the standard
treatment eﬀect approach. The price of these advantages of the structural approach is the greater range of
econometric problems that must be solved. They are avoided in the conventional treatment approach at
the cost of producing parameters that cannot be linked to well-posed economic models and hence do not
provide building blocks for an empirically motivated general equilibrium analysis or for investigation of the
impacts of new public policies. ∆MTE estimates the preferences of the agents being studied and provides
a basis for integration with well posed economic models. If the goal of a study is to examine one policy
in place (the problem of internal validity), the stronger assumptions invoked in this section of the paper,
and in structural econometrics, are unnecessary. Even if this is the only goal of the analysis, however, our
approach allows the analyst to generate all treatment eﬀects and IV estimands from a common parameter
and provides a basis for uniﬁcation of the treatment eﬀect literature.
Monotonicity, Uniformity, Nonseparability, Independence and
Policy Invariance: The Limits of Instrumental Variables
The analysis of this paper and the entire recent literature on instrumental variables estimators for models
with heterogeneous responses (i.e., models with outcomes of the form (2a) and (2b)) relies critically on
the assumption that the treatment choice equation has a representation in the additively separable form
(3). From Vytlacil , we know that, under our assumptions. this assumption is equivalent to the
assumption of monotonicity as deﬁned by Imbens and Angrist . Using the notation of Section 2,
Imbens and Angrist deﬁne monotonicity as the following condition: if the Z are changed for everyone from
Z = z to Z = z′, Dz ≥Dz′ or Dz ≤Dz′ for all UD conditional on X. A better name for this condition
would be “uniformity” since it describes a condition across people rather than the shape of a function for
a particular person.
This uniformity condition imparts an asymmetry to the entire instrumental variable enterprise. Responses are permitted to be heterogeneous in a general way, but choices of treatment are not. In this
section, we relax the assumption of additive separability in (3). We establish that in the absence of additive separability or uniformity, the entire instrumental variable identiﬁcation strategy in this paper and the
entire recent literature collapses. Parameters can be deﬁned as weighted averages of an MTE but MTE
and the derived parameters cannot be identiﬁed using any instrumental variable strategy.
One natural benchmark nonseparable model is a random coeﬃcient model of choice D = 1 [Zβ ≥0]
where β is a random coeﬃcient vector and β ⊥⊥(Z, U0, U1) . If β is a random coeﬃcient with a nondegenerate distribution and with components that take both positive and negative values, uniformity is clearly
violated. However, it can be violated even when all components of β are of the same sign if Z is a vector.
To consider a more general case, relax the assumption of equation (3) to consider a more general case
D∗= µD (Z, UD) ,
where µD (Z, UD) is not necessarily additively separable in Z and UD, and UD is not necessarily a scalar.49
In the random coeﬃcient example, UD = β.
D = 1 [D∗≥0] .
We maintain assumptions (A-1)–(A-5) and (A-8).
In special cases, (17a) can be expressed in an additively separable form. For example if D∗is weakly
separable in Z and UD, D∗= µD (θ (Z) , UD) for any UD where θ (Z) is a scalar function, µD is increasing
in θ (Z), and UD is a scalar, then we can write (17b) in the same form as (3):
where ˜U = µ−1
D (0; UD) and ˜U ⊥⊥Z | X, and the inverse function is expressed with respect to the ﬁrst
argument. Vytlacil shows that any model that does not satisfy uniformity (or “monotonicity”) will
not have a representation in this form.50
In the additively separable case, the MTE (4) has three equivalent interpretations.
(i) UD is the
only unobservable in the ﬁrst stage decision rule, and MTE is the average eﬀect of treatment given the
unobserved characteristics in the decision rule (UD = uD) . (ii) A person with UD = uD would be indiﬀerent
49The additively separable latent index model is more general than it may at ﬁrst appear. It is shown in Vytlacil 
that a wide class of threshold crossing models without the additive structure on the latent index will have a representation
with the additively separable structure on the latent index.
50In the random coeﬃcient case where Z = (1, Z1) where Z1 is a scalar, and β = (β0, β1) if β1 > 0 for all realizations, we
can write the choice rule in the form of (3): Z1β1 > −β0 ⇒Z > −β0
β1 and UD = −β0
β1 . This trick does not work in the general
between treatment or not if P (Z) = uD, where P(Z) is a mean scale utility function. Thus, the MTE is
the average eﬀect of treatment given that the individual would be indiﬀerent between treatment or not
if P (Z) = uD. (iii) One can also view the additively separable form (3) as intrinsic in the way we are
deﬁning the parameter and interpret the MTE (4) as an average eﬀect conditional on the additive error
term from the ﬁrst stage choice model. Under all interpretations of the MTE and under the assumptions
used in the preceding sections of this paper, MTE can be identiﬁed by LIV ; the MTE does not depend
on Z and hence it is policy invariant and the MTE integrates up to generate all treatment eﬀects, policy
eﬀects and all IV estimands.
The three deﬁnitions are not the same in the general nonseparable case (17a). Heckman and Vytlacil
 extend MTE in the nonseparable case using interpretation (i). MTE deﬁned this way is policy
invariant to changes in Z . They show that LIV is a weighted average of the MTE with possibly negative
weights and does not identify MTE. If uniformity does not hold, the deﬁnition of MTE allows one to
integrate MTE to obtain all of the treatment eﬀects, but the instrumental variables estimator breaks
Alternatively, one could deﬁne MTE based on (ii):
(x, z) = E (Y1 −Y0 | X = x, UD ∈{uD : µD(z, uD) = 0}) .
This is the average treatment eﬀect for individuals who would be indiﬀerent between treatment or not at a
given value of z. Heckman and Vytlacil show that in the nonseparable case LIV does not identify
this MTE and that MTE does not change when the distribution of Z changes, provided the support of
MTE does not change.51 In general, this deﬁnition of MTE does not allow one to integrate up MTE to
obtain the treatment parameters.
A third possibility is to force the index rule into an additive form by taking µ∗
D (Z) = E (µD (Z, UD) | Z),
deﬁning U ∗
D = µD (Z, U) −E (µD (Z, U) | Z) and deﬁne MTE as E (Y1 −Y0 | X = x, U ∗
D). Note that
D is not independent of Z, is not policy invariant and is not structural. LIV does not estimate MTE.
With this deﬁnition of the MTE it is not possible, in general, to integrate up MTE to obtain the various
treatment eﬀects.
51If the support of Z changes, then the MTE must be extended to a new support.
For any version of the nonseparable model, except those that can be transformed to separability,
index suﬃciency fails. To see this most directly, assume that µD (Z, UD) is absolutely continuous with
respect to Lebesgue measure. Deﬁne Ω(z) = {uD : µD (z, uD) ≥0}. In the additively separable case,
P (z) ≡Pr (D = 1 | Z = z) = Pr (uD ∈Ω(z)) , P (z) = P (z′) ⇔Ω(z) = Ω(z′) . This produces index
suﬃciency. In the more general case of (17a) it is possible to have (z, z′) such that P (z) = P (z′) and
Ω(z) ̸= Ω(z′) so index suﬃciency does not hold.
Implications of Nonseparability
In this section, we develop generalization (i), leaving development of the other interpretations for another
occasion. We focus on PRTE. The analysis of the other treatment parameters follows by parallel arguments.
For any uD in the support of the distribution of UD, deﬁne ΩuD = {z : µD(z, uD) ≥0}. For example,
in the random coeﬃcient case, with UD ≡β and D = 1[Zβ ≥0], we have Ωb = {z : zb ≥0}, where b is a
realization of β. Deﬁne 1A(t) to be the indicator function for the event t ∈A. Then, Appendix B shows
E(Ya) −E(Ya′)
E [E(Ya|X) −E(Ya′ | X)]
E(∆| X = x, UD = uD)
Pr[Za ∈ΩuD | X = x]
−Pr[Za′ ∈ΩuD | X = x]
dFUD|X(uD|x)
Thus, without additive separability, we can still derive an expression for PRTE and by similar reasoning
the other treatment parameters.
However, to evaluate the expression requires knowledge of MTE, of
Pr[Za ∈ΩuD | X = x] and Pr[Za′ ∈ΩuD | X = x] for every (uD, x) in the support of the distribution
of (UD, X), and of the distribution of UD. In general, if no structure is placed on the µD function, one
can normalize UD to be unit uniform (or a vector of unit uniform random variables) so that FUD|X will
be known. However, in this case the ΩuD = {z : µD(z, uD) ≥0} sets will not in general be identiﬁed. If
structure is placed on the µD function, one might be able to identify the ΩuD = {z : µD(z, uD) ≥0} sets
but then one needs to identify the distribution of UD conditional on X. If structure is placed on µD, one
cannot in general normalize the distribution of UD to be unit uniform without undoing the structure being
imposed on µD.
In particular, consider the random coeﬃcient model D = 1[Zβ ≥0] where UD = β is a random vector,
so that Ωβ = {z : zβ ≥0}. In this case, if all of the other assumptions hold, including Z ⊥⊥β | X, and
the policy change does not aﬀect (Y1, Y0, X, β), the PRTE is given by
E(Ya) −E(Ya′)
E [E(Ya|X) −E(Ya′ | X)]
E(∆| X = x, β = b)
Pr [Za ∈Ωb | X = x]
−Pr [Za′ ∈Ωb | X = x]
dFβ|X (b | x)
Because structure has been placed on the µD(Z, β) function, the sets Ωβ are known. However, evaluating
the function requires knowledge of the distribution of β which will not in general be identiﬁed without
further assumptions.52 Normalizing the distribution of β to be a vector of unit uniform random variables
produces the distribution of β but eliminates the assumed linear index structure on µD and results in Ωβ
sets that are not identiﬁed.
Even if the weights are identiﬁed, Heckman and Vytlacil show that it is not possible to use LIV
to identify MTE without additive separability between Z and UD in the selection rule index. Appendix D
develops this point for the random coeﬃcient model. Thus, without additive separability in the latent index
for the selection rule, we can still create an expression for PRTE (and the other treatment parameters)
but both the weights and the MTE function are no longer identiﬁed using instrumental variables.
One superﬁcially plausible way to avoid these problems would be to deﬁne ˜µD(Z) = E(µD(Z, UD) | Z)
and ˜UD = µD(Z, UD) −E(µD(Z, UD) | Z), producing the model D = 1[˜µD(Z) −˜UD ≥0]. We keep
the conditioning on X implicit. One could redeﬁne MTE using ˜UD and proceed as if the true model
possessed additive separability between observables and unobservables in the latent index. This is the
method pursued in approach (iii).
For two reasons, this approach does not solve the problem of providing an adequate generalization
of MTE. First, with this deﬁnition, ˜UD is a function of (Z, UD), and a policy that changes Z will then
also change ˜UD. Thus, policy invariance of the MTE no longer holds. Second, this approach generates
a ˜UD that is no longer statistically independent of Z so that assumption (A-2) no longer holds when ˜UD
is substituted for UD even when (A-2) is true for UD. Lack of independence between observables and
52See, e.g. Ichimura and Thompson for conditions for identifying the distribution of β in a random coeﬃcient
discrete choice model when Z ⊥⊥β.
unobservables in the latent index both invalidates our expression for PRTE (and the expressions for the
other treatment eﬀects) and causes LIV to no longer identify MTE.
The nonseparable model can also restrict the support of P (Z) . For example, consider a standard normal
random coeﬃcient model with a scalar regressor (Z = (1, Z1)) . Assume β0 ∼N (0, σ2
and β0 ⊥⊥β1. Then
P (z1) = Φ
where in this usage Φ is the standard cumulative normal distribution. If the support of z1 is ℜ1, then in
the standard additive model σ2
1 = 0 and P (z1) has support . When σ2
1 > 0, the support is strictly
within the unit interval.53 In the special case when σ2
0 = 0, the support is one point
We cannot, in general, identify ATE, TT or any treatment eﬀect requiring the endpoints 0 or 1.
Thus the more general case model of nonuniformity presented in this section does not satisfy the index
suﬃciency property, and the support of the treatment eﬀects and estimators is, in general, less than full.
The random coeﬃcient model for choice may explain the empirical support problems for P(Z) found in
Heckman, Ichimura, Smith, and Todd .
Implications of Dependence
We next consider relaxing the independence assumption (A-2) to allow Z ⊥⧸⊥UD | X while maintaining
the assumption that Z ⊥⊥(Y1, Y0) | (X, UD) . We maintain the other assumptions, including additive
separability between Z and UD in the latent index for the selection rule (equation (3)) and the assumption
that the policy changes Z but does not change (UD, Y0, Y1, X). Thus we assume that the policy change
does not change the MTE function (policy invariance). Given these assumptions, we derive in Appendix B
the following expression for PRTE in the nonindependent case:
E (Ya) −E (Ya′) = E [E (Ya | X) −E (Ya′ | X)]
E(∆| X = x, UD = uD)
Pr[µD(Za′) < uD | X = x, UD = uD]
−Pr[µD(Za) < uD | X = x, UD = uD]
dFUD|X(uD | x)
53The interval is
Although we can derive an expression for PRTE without requiring independence between Z and UD, to
evaluate this expression requires knowledge of MTE and of Pr[µD(Za′) < uD | X = x, UD = uD] and of
Pr[µD(Za) < uD | X = x, UD = uD]) for every (x, uD) in the support of the distribution of (X, UD). This
requirement is stronger than in the case of independence since the weights no longer depend only on the
distribution of Pa(Za) and Pa′(Za′) conditional on X. To evaluate these weights requires knowledge of the
function µD and of the joint distribution of (UD, Za) and (UD, Za′) conditional on X, and these will in
general not be identiﬁed without further assumptions.
Even if the weights are identiﬁed. Heckman and Vytlacil show that it is not possible to use LIV
to identify MTE without independence between Z and UD conditional on X. Thus, without conditional
independence between Z and UD in the latent index for the decision rule, we can still create an expression
for PRTE but both the weights and the MTE function are no longer identiﬁed without invoking further
assumptions.
One superﬁcially appealing way to avoid these problems is to deﬁne ˜UD = FUD|X,Z(UD) and ˜µD(Z) =
FUD|X,Z(µD(Z)), so D = 1[µD(Z) −UD ≥0] = 1[˜µD(Z) −˜UD ≥0] with ˜UD ∼Unif conditional on X
and Z and so ˜UD is independent of X and Z. It might seem that the previous analysis would carry over.
However, by deﬁning ˜UD = FUD|X,Z(UD), we have deﬁned ˜UD in a way that depends functionally on Z and
X, and hence we violate invariance of the MTE with respect to the shifts in the distribution of Z given X.
Do We Need Uniformity?
The monotonicity or uniformity condition and the additional condition of positive weights for MTE are
both required to obtain gross treatment eﬀects using IV. If these conditions are violated, changes in Z
induce two way ﬂows with some people changing into treatment and others leaving it. Thus IV does not
identify the “gross eﬀect” of treatment. Recall from our discussion in Section 4.3 that even if we have
monotonicity or uniformity as deﬁned in this section (a necessary and suﬃcient condition for the existence
of representation (4)), the discussion in Section 4.3 reveals that in a model with multiple instruments we
may still obtain negative IV weights unless we condition on the other instruments.
Monotonicity and independence are invoked when the treatment (indicated by D) is the policy being
evaluated. But treatments are only a subset of all possible policies of interest and if the goal is to evaluate
the eﬀects of a policy on aggregate outcomes, as in ∆PRTE, the monotonicity requirement may not be
needed. In that case, one is interested in the net impact of the policy and not the impact of treatment
operating through a particular mechanism or treatment. The policy of interest may entail two-way ﬂows.
Consider the case where D indicates schooling, which is the treatment. Deﬁne D = 1 if the person
goes to college and D = 0 otherwise. Suppose that the policy being studied is the introduction of a
physical education (PE) requirement in colleges along with mandatory augmented athletics facilities. The
policy has no eﬀect on (Y1, Y0) (e.g. potential earnings) but it aﬀects the choice of college, so it is a
valid Z. Some people hate PE while others love it and are attracted by colleges with good gyms, so
monotonicity (uniformity) is violated. If Za = z is the policy with PE and Za′ = z′ is the policy without
PE, E(Y |Za = z)−E(Y |Za′ = z′) is a perfectly valid policy parameter—the eﬀect of the policy on aggregate
outcomes—even if uniformity is violated and ∆MTE is not policy invariant. One only needs uniformity,
policy invariance and the other assumptions only when the policy is a treatment.
The Limits of Instrumental Variable Estimators
The treatment eﬀect literature focuses on a class of policies that move treatment choices in the same
direction for everyone. General instruments do not have universally positive weights on ∆MTE. They are
not guaranteed to shift everyone in the same direction. They do not necessarily estimate gross treatment
eﬀects. However, the eﬀect of treatment is not always the parameter of policy interest. Thus, in the
example just presented, schooling is the vehicle through which policy operates. One might be interested
in the eﬀect of schooling (the treatment eﬀect) or the eﬀect of the policy. These are separate issues unless
the policy is the treatment.
Generalizing the MTE to the case of a nonseparable choice equation that violates the monotonicity
condition, we can deﬁne but cannot identify the policy parameters of interest. If we make the model
symmetrically heterogeneous in outcome and choice equations, the method of instrumental variables and
our extensions of it break down in terms of estimating economically interpretable parameters. This case is
beyond the outer limits of an entire literature, although it captures intuitively plausible phenomena. More
general structural methods are required.54
54The framework of Carneiro, Hansen, and Heckman can be generalized to allow for random coeﬃcients models
in choice equations, and lack of policy invariance in the sense of (A-7). However, a fully semiparametric analysis does not
Summary and Proposed Extensions
This paper develops an approach to policy evaluation based on the marginal treatment eﬀect (∆MTE),
which provides a choice-theoretic foundation for organizing the treatment eﬀect literature.
All of the
conventional treatment eﬀect parameters can be expressed as diﬀerent weighted averages of ∆MTE. These
conventional treatment eﬀect parameters do not, in general, answer economically interesting questions.
We deﬁne the policy relevant treatment eﬀect as the solution to a Benthamite policy criterion for policies
operating on decisions to participate, but not on potential outcomes. The policy relevant treatment eﬀect
can be represented as a weighted average of ∆MTE where the weights diﬀer in general from the weights used
to generate conventional treatment eﬀects. Thus the conventional treatment eﬀects are not guaranteed to
answer policy relevant questions.
Instrumental variable estimators and OLS estimators converge to expressions that can be represented
as weighted averages of ∆MTE parameters, with the weights in general diﬀerent from those used to deﬁne
the various treatment eﬀects and the weights not necessarily positive so they do not identify a gross
treatment eﬀect. We show how to check whether the weights are positive. Conventional IV and matching
assumptions impose a strong condition on the ∆MTE—that selection into programs is not made in terms
of any unobservable gain from program participation.
We present methods for estimating ∆MTE based on local instrumental variables and we develop a new
instrumental variable for recovering policy relevant treatment eﬀects using standard instrumental variable
methods. We present conditions for using IV to estimate well-posed policy questions. We show that
IV need not generate any interesting policy counterfactual, and that there are policy counterfactuals for
which no IV can be generated. In a model of heterogeneous responses, there is no natural superiority of
conventional IV over OLS in estimating policy relevant parameters. We develop the conditions required
to forecast the eﬀects of old policies on new environments and the eﬀects of new policies. These issues
are typically ignored in the treatment eﬀect literature but are central to the structural policy evaluation
literature.
The model presented in this paper and the models presented in the recent literature on instrumental
variables in heterogeneous response models are fundamentally asymmetric. Responses to treatment are
appear to be possible. This generalization is under preparation for publication.
allowed to be heterogeneous in a general way, but choices of treatment are not.
When we develop a
symmetrically heterogeneous model, the method of instrumental variables breaks down entirely, and a
diﬀerent approach to econometric policy analysis is required.
Department of Economics, University of Chicago, 1126 E. 59th Street, Chicago, IL, 60637, U.S.A.
 ,
Dept. of Economics, Stanford University, 579 Serra Mall, Palo Alto, CA, 94305, U.S.A.
 
Appendices
Testable Monotonicity in P Restriction
Theorem 1. Assume Y0, Y1, and D are determined by equations 2a, 2b and 3 respectively. Assume conditions (A-1) through (A-5) hold.
(i) Let g0, g1 be any real valued functions such that g0(Y0, X), g1(Y1, X) ≥0 with probability 1. Then
E((1 −D)g0(Y, X) | X, P(Z) = p) is weakly decreasing in p and E(Dg1(Y, X) | X, P(Z) = p) is
weakly increasing in p.
(ii) Let g0, g1 be any real valued functions such that g0(Y0, X), g1(Y1, X) > 0 with probability 1. Then
E((1 −D)g0(Y, X) | X, P(Z) = p) is strictly decreasing in p and E(Dg1(Y, X) | X, P(Z) = p) is
strictly increasing in p.
Proof. Consider assertion (i). Consider E(Dg1(Y, X)|X = x, P(Z) = p) for some x. Let p1, p0 denote any
two points in the support of the distribution of P(Z) conditional on X = x such that p1 > p0. Then
E (Dg1(Y, X)|X = x, P(Z) = p1) −E (Dg1(Y, X)|X = x, P(Z) = p0)
E(1[UD ≤P(Z)]g1(Y1, X)|X = x, P(Z) = p1) −E(1[UD ≤P(Z)]g1(Y1, X)|X = x, P(Z) = p0)
E(1[UD ≤p1]g1(Y1, X)|X = x) −E(1[UD ≤p0]g1(Y1, X)|X = x)
E({1[UD ≤p0] + 1[p0 < UD ≤p1]}g1(Y1, X)|X = x) −E(1[UD ≤p0]g1(Y1, X)|X = x)
E(1[p0 < UD ≤p1]g1(Y1, X)|X = x)
where the ﬁrst equality follows from the deﬁnition of D and uses the fact that Dg1(Y, X) = Dg1(Y1, X); the
second equality uses independence condition (A-2); the third equality uses the fact that p0 < p1 and thus
that 1[UD ≤p1] = 1[UD ≤p0]+1[p0 < UD ≤p1]; the fourth equality follows from linearity of expectations;
the ﬁnal inequality follows from g1(Y1, X) ≥0 with probability 1. The proof that E((1 −D)g0(Y, X) |
X, P(Z) = p) is decreasing in p follows from a similar argument. Assertion (ii) follows from a trivial
modiﬁcation of the last line of the above proof.
Consider the following examples of g0 and g1:
(i) If Y1, Y0 are known to be nonnegative (for example, Y1, Y0 are indicator variables, or Y1, Y0 are wages),
then we may choose gj(Y, X) = Y . In this example, Theorem 1 implies that E((1−D)Y | X, P(Z) =
p) is weakly decreasing in p and E(DY | X, P(Z) = p) is weakly increasing in p. More generally,
if Y1, Y0 are known to be bounded from below by a function of X so that Y1 ≥l1(X), Y0 ≥l0(X)
with probability 1, then we may choose gj(Y, X) = Y −lj(X) so that Theorem 1 implies that
E((1 −D)(Y −l0(X)) | X, P(Z) = p) is weakly decreasing in p and E(D(Y −l1(X)) | X, P(Z) = p)
is weakly increasing in p.
(ii) Without any assumptions on the support of the distribution of Y1, Y0, let t denote a real number and
take gj(Y, X) = 1[Y ≤t] for j = 0, 1. Then Theorem 1 implies that Pr(D = 0, Y ≤t | X, P(Z) = p)
is weakly decreasing in p and Pr(D = 1, Y ≤t | X, P(Z) = p) is weakly increasing in p. More
generally, let A denote any measurable subset of the real line, and take gj(Y, X) = 1[Y ∈A] for
j = 0, 1. Then the conclusion of the proposition can be rewritten as Pr(D = 0, Y ∈A | X, P(Z) = p)
is weakly decreasing in p and Pr(D = 1, Y ∈A | X, P(Z) = p) is weakly increasing in p.
For any choice of g0, g1, the restriction of Theorem 1 leads to the prediction that regression functions
E((1 −D)g0(Y, X) | X, P(Z) = p) and E(Dg1(Y, X) | X, P(Z) = p) satisfy the monotonicity conditions.
This is an example of a nonparametric null with shape restrictions versus a nonparametric alternative. A
formal test of the null hypothesis can be implemented using the methodology of Ghosal, Sen, and van der
Vaart .
The restrictions of Theorem 1 nest the Imbens-Rubin restrictions on IV as a special case. They
assume a binary Z, and obtain the density of Y1 and Y0 from the observed data and derive the testable
restriction that these densities be nonnegative.55 Our analysis is more general.56
Derivation of PRTE and IV Weights
Proof. (Equation (6)) To simplify the notation, assume that V (Y ) = Y . Modiﬁcations required for the
more general case are obvious. Deﬁne 1A(t) to be the indicator function for the event t ∈A. Then
E (Ya | X)
E(Ya|X, Pa(Za) = p) dFPa|X(p)
[1[0,p](uD)E(Y1,a | X, UD = uD) + 1(p,1](uD)E(Y0,a | X, UD = uD) du
[1[uD,1](p)E(Y1,a | X, UD = uD) + 1(0,uD](p)E(Y0,a | X, UD = uD) dFPa|X(p)
(1 −FPa|X(uD))E(Y1,a | X, UD = uD) + FPa|X(uD)E(Y0,a | X, UD = uD)
55See also Heckman, Smith, and Taber for a closely related test.
56For ease of exposition, suppress conditioning on X. Take the case where Z = 0, 1, and P(1) > P(0). Consider the Y1
outcome; the analysis for Y0 is completely symmetric. For binary Z with P(1) > P(0), our restriction can be rewritten
as E(Dg1(Y )|Z = 1) ≥E(Dg1(Y )|Z = 0). Take g1(Y ) = 1[Y ∈A] for any pre-speciﬁed set A, for example, the intervals
examined in the histogram analyzed in the Imbens-Rubin paper. In this special case, our monotonicity restriction is that
Pr(D = 1, Y ∈A|Z = 1) −Pr(D = 0, Y ∈A|Z = 0) > 0, and the restriction is the same as the Imbens and Rubin restriction
of a nonnegative density. Our analysis replaces their densities with the probability that Y lies in any given set. Thus, their
restriction is a very special case of the general monotonicity restriction developed in this paper.
This derivation involves changing the order of integration. Note that from (A-4),
E|1[0,p](uD)E(Y1,a | X, UD = uD) + 1(p,1](uD)E(Y0,a | X, UD = uD)| ≤E(|Y1| + |Y0|) < ∞,
so the change in the order of integration is valid by Fubini’s theorem. Comparing policy a to policy a′,
E (Ya | X) −E (Ya′ | X) =
E(∆| X, UD = uD)(FPa′|X(uD) −FPa|X(uD)) duD,
which gives the required weights. (Recall ∆= Y1 −Y0 and from (A-7) we can drop the a, a′ subscripts on
outcomes and errors.)
Relaxing (A-7): Implications of Noninvariance for PRTE.
Suppose that all of the assumptions invoked up to Section 3 are satisﬁed, including additive separability
in the latent index choice equation (3) (equivalently, the monotonicity or uniformity condition). Impose
the normalization that the distribution of UD is unit uniform. Suppose however, contrary to (A-7), that
the distribution of (Y1, Y0, UD, X) is diﬀerent under the two regimes a and a′. Thus, let (Y1,a, Y0,a, UD,a, Xa)
and (Y1,a′, Y0,a′, UD,a′, Xa′) denote the random vectors under regimes a and a′, respectively. Following the
same analysis as used to derive equation (6), the PRTE conditional on X is given by
E(Ya | Xa = x) −E (Ya′|Xa′ = x)
E(Y1,a −Y0,a | Xa = x, UD,a′ = u)
FPa′|Xa′(u | x) −FPa|Xa(u | x)
[E(Y0,a | Xa = x, UD,a = u) −E(Y0,a′ | Xa′ = x, UD,a′ = u)] du
(1 −FPa′|X(u | x))
 E(Y1,a −Y0,a | Xa = x, UD,a = u) −E(Y1,a′ −Y0,a′ | Xa′, UD,a′ = u)
Thus, when the policy aﬀects the distribution of (Y1, Y0, UD, X), the PRTE is given by the sum of three
terms: (I) the value of PRTE if the policy did not aﬀect (Y1, Y0, X, UD); (II) the weighted eﬀect of the
policy change on E(Y0 | X, UD); and (III) the weighted eﬀect of the policy change on MTE. Evaluating
the PRTE requires knowledge of the MTE function in both regimes, knowledge of E(Y0 | X = x, UD = u)
in both regimes, as well as knowledge of the distribution of P(Z) in both regimes. Note, however, that
if we assume that the distribution of (Y1,a, Y0,a, UD,a) conditional on Xa = x equals the distribution of
(Y1,a′, Y0,a′, UD,a′) conditional on Xa′ = x, then E(Y1,a | UD,a = u, Xa = x) = E(Y1,a′ | UD,a′ = u, Xa′ = x),
E(Y0,a | UD,a = u, Xa = x) = E(Y0,a′ | UD,a′ = u, Xa′ = x), and thus that terms (II) and (III) are zero and
the expression for PRTE simpliﬁes to the expression of equation (6).
Proof. (Equation (10))
Cov (Jx (Z) , Y | X)
E ([Jx (Z) −E (J (Z) | X)] Y | X)
E ((J (Z) −E (J (Z) | X)) (Y0 + D (Y1 −Y0)) | X)
E ((J (Z) −E (J (Z) | X)) D (Y1 −Y0) | X)
˜J(Z) 1[UD ≤P(Z)] (Y1 −Y0)
˜J(Z) 1[UD ≤P(Z)] E (Y1 −Y0 | X, Z, UD)
˜J(Z) 1[UD ≤P(Z)] E (Y1 −Y0 | X, UD)
˜J(Z) 1[UD ≤P(Z)]
E (Y1 −Y0 | X, UD)
E( ˜J(Z) | X, P(Z) ≥uD) Pr(P(Z) ≥uD)E (Y1 −Y0 | X, UD = uD)
∆MTE(X, uD)E( ˜J(Z) | X, P(Z) ≥uD) Pr(P(Z) ≥uD)duD
The third equality follows from (3); the fourth equality follows from the law of iterated expectations
with the inside expectation conditional on (X, Z, UD); the ﬁfth equality follows from assumption (A-2);
the sixth equality follows from the law of iterated expectations with the inside expectation conditional
on (X = x, UD); the seventh equality follows from Fubini’s Theorem and the normalization that UD is
distributed unit uniform conditional on X; and the ﬁnal equality follows from plugging in the deﬁnition
of ∆MTE. Yitzhaki was the ﬁrst to develop the interpretation of IV as a weighted average
although he did not develop the MTE.
Proof. (Equation (18)) E (Ya | X)
E(Ya|X, UD = uD, Za = z) dFUD,Za|X(uD, z)
1ΩuD(z)E(Y1|X, UD = uD, Za = z) + 1ΩcuD(z)E(Y0|X, UD = uD, Za = z)
dFUD,Za|X(uD, z)
1ΩuD(z)E(Y1|X, UD = uD) + 1ΩcuD(z)E(Y0|X, UD = uD)
dFUD,Za|X(uD, z)
1ΩuD(z)E(Y1|X, UD = uD) + 1ΩcuD(z)E(Y0|X, UD = uD)
dFUD|X(uD)
[Pr[Za ∈ΩuD | X]E(Y1|X, UD = uD) + (1 −Pr[Za ∈ΩuD | X])E(Y0|X, UD = uD)] dFUD|X(uD)
uD denotes the complement of ΩuD and where the ﬁrst equality follows from the law of iterated
expectations; the second equality follows by plugging in our threshold crossing model for D; the third
equality follows from independence Z ⊥⊥(Y1, Y0, UD) | X; the fourth and ﬁfth equalities follow by an
application of Fubini’s Theorem and a rearrangement of terms. Fubini’s Theorem may be applied by
assumption (A-4). Thus comparing policy a to policy a′, we obtain (18).
E(Ya | X) −E(Ya′ | X) =
E(∆| X, UD = uD)(Pr[Za ∈ΩuD | X] −Pr[Za′ ∈ΩuD | X]) dFUD|X(uD).
Proof. (Equation (19))
E (Ya | X)
E(Ya|X, UD = uD, Za = z) dFUD,Za|X(uD, z)
1[0,µD(z)](uD)E(Y1 | X, Z = z, UD = uD)
+1(µD(z),1](uD)E(Y0 | X, Z = z, UD = uD)
dFUD,Za|X(uD, z)
1[0,µD(z)](uD)E(Y1 | X, UD = uD)
+1(µD(z),1](uD)E(Y0 | X, UD = uD)
dFUD,Za|X(uD, z)
1[0,µD(z)](uD)E(Y1 | X, UD = uD)
+1(µD(z),1](uD)E(Y0 | X, UD = uD)
dFZa|UD(z | uD)
dFUD|X(uD)
(1 −Pr[µD(Za) < uD | UD = uD]) E (Y1 | X, UD = uD)
+ Pr [µD(Za) < uD | UD = uD] E (Y0 | X, UD = uD)
dFUD|X(uD)
where the ﬁrst equality follows from the law of iterated expectations; the second equality follows by plugging
in our model for D; the third equality follows from independence Z ⊥⊥(Y1, Y0) | X, UD; the fourth equality
follows by an application of Fubini’s Theorem; and the ﬁnal equality follows immediately. Thus comparing
policy a to policy a′, we obtain (19) in the text.
Proofs of Propositions
Proof of Proposition 1
We ﬁrst show that, given (i), conditions (ii) and (iii) are suﬃcient for the instrument Jx(Z) deﬁned the
proposition to have the desired properties. As a preliminary step, note that
E(Jx|X = x) =
1[fP|X(p|x) > 0]w′(p|x)dp =
w′(p|x)dp = 0,
where the ﬁrst equality comes from plugging in the proposed Jx and using condition (i); the second
equality follows from condition (iii); and the ﬁnal equality follows from condition (ii). We now check that
the proposed Jx is correlated with D under conditions (i) to (iii).
Cov(Jx(Z), D | X = x) = Cov(Jx(Z), P(Z) | X = x) =
1[fP|X(p|x) > 0]w′(p|x)pdp =
w′(p|x)pdp = −1,
where the ﬁrst equality follows from the law of iterated expectations; the second equality comes from
plugging in the proposed Jx and using E(Jx|X = x) = 0; the third equality uses condition (iii) and the
ﬁnal equality follows from integration by parts using condition (ii). We now check that the proposed
instrument Jx implies the desired weights on ∆MTE. With the proposed Jx, for u such that fP|X(u|x) > 0,
−T(u | x; Jx)fP|X(u|x)
Cov (Jx, P | X = x) = w′(u|x),
where the equality comes from plugging in the proposed Jx and using E(Jx|X = x) = 0 and Cov (Jx, P |
X = x) = −1. Thus, for u such that fP|X(u|x) > 0, we have that −T(u | x; Jx)fP|X(u|x)/Cov (Jx, P |
X = x) = w′(u|x) as desired. For u such that fP|X(u|x) = 0, condition (iii) implies that w′(u|x) = 0, and
thus trivially −T(u | x; Jx)fP|X(u|x)/Cov (Jx, P | X = x) = w′(u|x) for u such that fP|X(u|x) = 0.
We now show that, given condition (i), conditions (ii) and (iii) are necessary. First, consider condition
(ii). We have previously established that the weights corresponding to any instrument must integrate
to one, and that the weights corresponding to any instrument must satisfy w(0 | x) = 0. One can also
directly verify that w(1 | x) = 0 unless the conditional distribution of P(Z) has a mass point at 1. The
conditional distribution of P(Z) does not have a mass point at 1 by condition (i). Using condition (i),
one can apply Lebesgue’s theorem for the derivative of an integral to show that the weights corresponding
to any instrument will be diﬀerentiable.
Thus, given condition (i), the weights corresponding to any
instrument will satisfy condition (ii), and thus condition (ii) is a necessary condition for there to exist
an instrument that corresponds to the desired weights. Now assume conditions (i) and (ii), and consider
condition (iii). Suppose that (iii) does not hold, so that there exists a set of t values such that fP|X(t|x) = 0
but w′(t|x) > 0. Then, for such values of t,
−T(t | x; Jx)fP|X(t|x)
Cov (Jx, P | X = x) = 0
for any potential instrument Jx while w′(t|x) > 0, and thus trivially there cannot exist an instrument Jx
−T(t | x; Jx)fP|X(t|x)
Cov (Jx, P | X = x) = w′(t|x)
for all t. Thus, given condition (i), conditions (ii) and (iii) are necessary for the existence of an instrument
with the desired properties.
Proof of Proposition 2
FPa′|X(· | x) −FPa|X(· | x)
E(Pa | X = x) −E(Pa′ | X = x).
We now show that conditions (i) and (ii) of Proposition 2 imply conditions (i) and (ii) of Proposition 1
when w(·|x) is deﬁned in this manner. Note that condition (i) of Proposition 2 immediately implies that
condition (i) of Proposition 1 holds. Condition (i) of Proposition 2 implies that w(·|x) is diﬀerentiable for
all evaluation points with
fPa′|X(· | x) −fPa|X(· | x)
E(Pa | X = x) −E(Pa′ | X = x).
Since FPa|X(·) and FPa′|X(·) are distribution functions, one can directly verify that
0 w(u|x)du = 1. Since
the propensity score is always bounded by 0 and 1, using condition (i), FPa|X(1 | x) = FPa′|X(1 | x) = 1
and FPa|X(0 | x) = FPa′|X(0 | x) = 0 and thus w(1|x) = w(0|x) = 0. Deﬁning w(·|x) in this manner, we
have that conditions (i) and (ii) of Proposition 2 imply conditions (i) and (ii) of Proposition 1. Given
fPa′|X(· | x) −fPa|X(· | x)
E(Pa | X = x) −E(Pa′ | X = x),
we have that condition (iii) of Proposition 2 is equivalent to condition (iii) of Proposition 1 for this choice
of w(·|x). The result now follows directly from Proposition 1.
Proof of Proposition 3
Assume that the conditions of Proposition 1 hold almost everywhere with respect to X. From the proof
of Proposition 1, under the stated conditions, E(J(Z) | X) = 0, Cov (J(Z), D | X) = −1, and
Cov (J(Z), Y | X)
Cov (J(Z), D | X) =
∆MTE(X, u)w(u|X)du.
It follows that Cov (J(Z), D | X) = Cov (J(Z), D | X) = −1, that Cov (J(Z), Y ) = E(J(Z)Y ) =
E(J(Z)Y | X)
, and thus that
Cov (J(Z), Y )
Cov (J(Z), D)
−E(J(Z)Y | X)
Cov (J(Z), Y | X)
Cov (J(Z), D | X)
∆MTE(x, u)w(u|x)du
Proof of Proposition 4
We ﬁrst show that, given condition (i), conditions (ii) and (iii) are suﬃcient for the instrument
Jx(Z) deﬁned by the proposition to have the desired properties.
For notational convenience, deﬁne
πl = Pr[P(Z) = pl], for l = 1, ..., K. As a preliminary step, note that with this deﬁnition of Jx(Z),
E(Jx|X = x) =
[wl −wl+1]πl =
[wl −wl+1] = w1 −wK+1 = 0
where we use the fact that w1 = wK+1 = 0. We now check that the proposed Jx is correlated with D under
conditions (i) to (iii).
Cov(Jx(Z), D | X = x)
Cov(Jx(Z), P(Z) | X = x)
[wl −wl+1]plπl =
[pl −pl−1]wl
w(t | x)dt =
w(t | x)dt = 1,
where the ﬁrst equality follows from the law of iterated expectations; the second equality comes from
E(Jx|X = x) = 0 and plugging in the proposed Jx(Z); the third equality rearranges terms in the sum
using w1 = wK+1 = 0; the fourth equality uses condition (iii) and the deﬁnition of wl; the ﬁfth equality
uses linearity of integration; and the ﬁnal equality uses condition (ii). We now check that the proposed
instrument Jx implies the desired weights on ∆MTE. Using Cov(Jx(Z), D | X = x) = 1 and that E(Jx(Z) |
X = x) = 0, the IV weights corresponding to the proposed Jx(Z) as given by hIV(u) = E(Jx (Z) 1[P(Z) ≥
u]). We immediately have hIV(u) = w(u | x) = 0 for u ∈(pK, 1] and for u ∈[0, p1]. For u ∈(pj−1, pj],
j = 2, ..., K, we have
E(Jx (Z) 1[P(Z) ≥u]) =
[wl −wl+1]1[pl ≥u]πl =
[wl −wl+1] = wj −wK+1 = wj = w(u | x)
where the ﬁrst equality comes from plugging in the proposed Jx(Z); the second equality follows from
u ∈(pj−1, pj]; the third equality follows by rearranging terms; the fourth equality follows from wK+1 = 0;
and the ﬁnal equality follows by the deﬁnition of wj and the fact that u ∈(pj−1, pj].
We now show that, given condition (i), conditions (ii) and (iii) are necessary. First, consider condition
(ii). One can verify that the weights corresponding to any instrument must integrate to one. One can
also verify that the weights corresponding to any instrument must satisfy w(u | x) = 0 for u ≤pMin
and for u > pMax
, where pMin
are the minimum and maximum values in the support of the
conditional distribution of P(Z). Given condition (i), one can immediately verify that the IV weights for
any instrument must satisfy condition (iii). Thus, given condition (i), the weights corresponding to any
instrument will satisfy conditions (ii) and (iii), and thus, given condition (i), conditions (ii) and (iii) are
necessary conditions for there to exist an instrument that corresponds to the desired weights.
Local Instrumental Variables for the Random Coeﬃcient
Consider the model:
D = 1[Zβ ≥0],
where β is a random variable. For ease of exposition, we leave implicit the conditioning on X covariates.
Assume that (Y0, Y1, β) ⊥⊥Z. Assume that β has a density that is absolutely continuous with respect to
Lebesgue measure on ℜK. We have
E(Y | Z = z) = E(DY1 | Z = z) + E((1 −D)Y0 | Z = z).
To simplify the exposition, ﬁrst consider the ﬁrst term, E(DY1 | Z = z). Using the model, the independence
assumption, and the law of iterated expectations, we have
E(DY | Z = z)
1[zβ ≥0]Y1
1[zβ ≥0]E(Y1 | β)
z[K]β[K] ≥−z[−K]β[−K]
where the ﬁnal outer expectation is over β. Consider taking the derivative with respect to the Kth element
of Z assumed to be continuous. Let Z[K] denote the Kth element of Z and Z[−K] denote all other elements
of Z, and write Z = (Z[−K], Z[K]). Likewise, partition z, β, and b as z = (z[−K], z[K]), β = (β[−K], β[K]),
and b = (b[−K], b[K]), where z is a realization of Z and b is a realization of β. For simplicity, suppose that
the Kth element of z is positive, z[K] > 0. We obtain
E(DY | Z = z)
z[K]β[K] ≥−z[−K]β[−K]
β[K] ≥−z[−K]β[−K]
where the inside expectation is over β[K] conditional on β[−K], i.e., is over the Kth element of β conditional
on all other components of β. Thus,
∂z[K]E(DY | Z = z) =
E(Y1 | β = M(b[−K])) ˜w(b[−K])db[−K],
M(b[−K]) = ((b[−K])′, −z[−K]b[−K]
)′ and ˜w(b[−K]) = z[−K]b[−K]
f(b[−K], −z[−K]b[−K]
with f(·) the density of β (with respect to Lebesgue measure), and where for notational simplicity we
suppress the dependence of the function M(·) and the weights ˜w(·) on the z evaluation point. In this
expression, we are averaging over E(Y1 | β = b), but only over b evaluation points such that zb = 0. In
particular, the expression average over the K −1 space of b[−K], while for each potential realization of b[−K]
it is ﬁlling in the value of b[K] such that z[K]b[K] = −z[−K]b[−K] so that z[K]b[K]+z[−K]b[−K] = 0. Note that the
weights ˜w(b−K]) will be zero for any b[−K] such that f(b[−K], −z[−K]b[−K]
) = 0, i.e., the weights will be zero for
any b[−K] such that there does not exist b[K] in the conditional support of β[K] with z[K]b[K] = −z[−K]b[−K].
Following the same logic for E((1 −D)Y0 | Z = z) we obtain
∂z[K]E((1 −D)Y | Z = z) = −
E(Y0 | β = M(b[−K])) ˜w(b[−K])db[−K]
and likewise have
∂z[K] Pr(D = 1 | Z = z) =
˜w(b[−K])db[−K]
∂z[K]E(Y | Z = z)
∂z[K] Pr (D = 1 | Z = z) =
E(Y1 −Y0 | β = M(b[−K]))w(b[−K])db[−K],
w(b[−K]) = ˜w(b[−K])/
˜w(b[−K])db[−K].
Now consider the question of whether this expression will include both positive and negative weights.
Recall that ˜w(b[−K]) = z[−K]b[−K]
(z[K])2 f(b[−K], −z[−K]b[−K]
˜w(b[−K]) ≥0
if z[−K]b[−K] > 0,
˜w(b[−K]) ≤0
if z[−K]b[−K] < 0,
and will be nonzero if z[−K]b[−K] ̸= 0 and there exists b[K] in the conditional support of β[K] with z[K]b[K] =
z[−K]b[−K], i.e., with zb = 0. We thus have that there will be both positive and negative weights on the
MTE if there exists values of b in the support of β with both z[−K]b[−K] > 0 and zb = 0, and there exists
other values of b in the support of β with z[−K]b[−K] < 0 and zb = 0.