Multirate Digital Filters, Filter Banks,
Polyphase Networks, and Applications:
A Tutorial
Multirate digital filters and filter banks find application in com-
munications, speech processing, image compression, antenna sys-
tems, analog voice privacy systems, and in the digital audio indus-
try. During the last several years there has been substantial progress
in multirate system research. This includes design of decimation
and interpolation filters, analysis/synthesis filter banks (also called
quadrature mirror filters, or QMFJ, and the development of new
sampling theorems. First, the basic concepts and building blocks
in multirate digital signal processing (DSPJ, including the digital
polyphase representation, are reviewed. Next, recent progress as
reported by several authors in this area is discussed. Several appli-
cations are described, including the following: subband coding of
waveforms, voice privacy systems, integral and fractional sampling
rate conversion (such as in digital audio), digital crossover net-
works, and multirate coding of narrow-band filter coefficients. The
M-band QMF bank is discussed in considerable detail, including
an analysis of various errors and imperfections. Recent techniques
for perfect signal reconstruction in such systems are reviewed. The
connection between QMF banks and other related topics, such as
block digital filtering and periodically time-varying systems, based
on a pseudo-circulant matrix framework, is covered. Unconven-
tional applications of the polyphase concept are discussed.
I. INTRODUCTION
In recent years there has been tremendous progress in
the multirate processing of digital signals. Unlike the sin-
gle-rate system, the sample spacing in a multirate system
can vary from point to point [I], . This often results in more
efficient processing of signals because the sampling rates
at various internal points can be kept as small as possible.
Unfortunately, thisalso results in the introduction of a new
type of error, i.e., aliasing, which should somehow be can-
celed eventually.
The basic building blocks in a multirate digital signal pro-
cessing (DSP) system are decimators and interpolators. In
1981, an excellent tutorial article on decimation and inter-
polation appeared in . Subsequent to this a text on the
subject of multirate systems has also been published by the
same authors . Since then, a number of new develop-
ments have taken place in the area, particularly in multirate
Manuscript received October12,1988; revised Junel3,1989.This
work was supported in part by the National Science Foundation
under grants DCI 8552579 and MIP 8604456.
The author is with the Department of Electrical Engineering, Cal-
ifornia Institute of Technology, Pasadena, CA 91125, USA.
I E E E Log Number 8933329.
digital filter bankdesigns.Ashort summaryof someofthese
developments was reported recently by this author at an
IEEE international conference . The purpose of this article
is to provide a self-contained and more complete exposure
to many recent contributions on multirate systems, includ-
ing filter bank design.
As mentioned in , multirate systems find application
in communications, speech processing, spectrum analysis
 , radar systems, and antenna systems. In this tutorial, two
sections are devoted to a review of applications. In Section
111, we point out applications in digital audio systems, in
subband coding techniques (used in speech and image
compression), and in analog voice privacy systems (for stan-
dard telephone communications). In Section V-E, appli-
cations of special transfer functions (such as complemen-
tary functions) in digital audio is reviewed. In Section IX,
several unconventional applications of multirate systems
and polyphase theory are indicated. These include a) deri-
vation of new sampling theorems for efficient compression
of signals, b) derivation of new techniques for efficient cod-
ing of impulse response sequences of narrow band filters,
c) design of FIR filters with adjustable multilevel responses,
and d) adaptive filtering in subbands.
A. Paper Outline
In section II, basic tools, such as decimators, interpola-
tors, decimation and interpolation filters, and digital filter
banks, are reviewed, along with the interconnection prop-
erties of the building blocks. In section I l l , some applica-
tions of multirate DSP are indicated, in digital audio sys-
tems, in subband coding, and in voice privacy systems.
Section IV reviews the digital polyphase decomposition due
to Bellanger, along with applications such as the uniform
DFT filter bank. The concept of multilevel polyphase
decomposition is also introduced here as a tool for efficient
implementation of fractional decimation filters. Several
special types of filter banks, such as Nyquist filters, power-
complementary systems and Euclidean filter-banks, are
studied in section V. In section VI, the two-band QMF bank
is studied in sufficient detail along with procedures for
eliminating aliasing in such systems. Procedures for elim-
ination of amplitude and/or phase distortion are discussed.
00189219/90/0100-0056$01.00 0
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
Perfect-reconstruction two-channel QMF banks are intro-
duced by blending the polyphase concept with the classical
network-theoretic concept of losslessness.
The relation between M-band QMF banks and two other
related topics (block filtering and periodically time-varying
systems) is reviewed in section VII, based on an algebraic
structure called the pseudo-circulant matrix. In section VIII,
M-band QMF banks are discussed in greater detail, and
techniques for elimination of aliasing, amplitude, and phase
distortions are reviewed. Section IX discusses unconven-
tional applications, and Section X discusses some exten-
sions of multirate ideas to cases of multidimensional sig-
nals. The paper concludes with a discussion of open
problems in multirate DSP.
B. Notations and Terminology
and w are used as frequency variables for
continuous-time and discrete-time cases, respectively. In
the discrete-time case the term normalized frequency i s
used to denote f = d2s. The frequency response of a trans-
fer function H(z) is expressed as H(e'") = IH(e/")l e /$("), where
IH(e/")l i s the magnitude response and +(U) the phase
response. The quantity ~ ( w ) = -d+(w)/dw is the group delay
of H(z). If (H(e/")l is constant for all a, H(z) is all-pass. If +(a)
has the form ko - klo, then H(z) is said to have linear phase
and the group delay is a constant k,; physically, if the input
to such a filter H(z) has energy only in the passband of H(z),
then the output is a delayed version of the input, by kl sam-
ples. Unless mentioned otherwise, a low-pass filter has real
coefficients, so that IH(e/")l is symmetric and +(U) is anti-
symmetric with respect t o o = 0. Usually (H(e/")( is plotted
for 0 I f 5 0.5 (i.e., for 0 5 w 5 s). If up and us denote the
passband and stopband edges of a low-pass filter, the quan-
tity wc = (ap + wJ2 is said to be the cutoff frequency.
Bold-faced quantities denote matrices and vectors, as in
A, H(z) etc. The symbol / k denotes the k X k identity matrix
(with subscript often omitted). The quantitiesAr,At and A*
denote, respectively, the transpose, transpose conjugate,
and conjugate of A. For functions H(z), the notation H,(z)
denotes conjugation of the coefficients without conjugat-
ing z. For example if H(z) = a + bz-', then HJz) = a* +
b*z-l. Thus, H*(z) = H,(z*). The notation fi(z) stands for
H;(z-'). In other words, conjugate the coefficients, take
transpose (if matrix), and replace z with z-'. When z = e/"
(i.e., on the unit circle), we have A(z) = Ht(z). Linear time-
invariant systems [7l are abbreviated as LTI and linear
periodically time-varying systems as LPW. A p x r matrix
A is said to be unitary (orthogonal if it is real) if AtA = c/~,
c # 0. Note that A is not restricted to be square. For exam-
ple, [::$)]
is unitary for any real 0. The symbol WM stands
The subscript M is usually deleted because its
value is often clear from the context. This quantity appears
in the definition of the discrete Fourier transform (DFT) [I,
[81. Thus an M-point sequence [xo, xl, . . , xM-,l has the
M-point DFT sequence
The variables
0 5 k I M - 1.
The inverse DFT (IDFT) is given by
The most crucial property of W that finds repeated use in
multirate DSP is the following:
otherwise.
k = integer multiple of M
For any pair of integers k, n, we have W K = W", if and only
if k - n is an integer multiple of M. In particular, therefore,
W k # W"for0 5 k < n I M - 1.
State Space Descriptions: Consider a discrete time trans-
fer matrix H(z) with input vector u(n) and output vector y(n).
Suppose we have implemented this transfer matrix using
a structure, and let N denote the number of delay elements
used. Label the outputs of the delay elements as the state
variables xk(n), 0 I
k 5 N - 1, and define the state vector
x(n) = [x,(n) xl(n) . xN-,(n)lr. With u(n) and y(n) denoting
the input and output (vector) sequences to the structure,
one can always find equations of the form 
x(n + 1) = Ax(n) + Bu(n),
y(n) = Cx(n) + Dub),
to describe the structure. This is called the state-space
description of the structure. The matrix A, called the state
transition matrix, has size N x NI where N is the number
of delays in the structure. The transfer function H(z) of the
structure is given by H(z) = D + C(z/ - A)-'B. The smallest
number of delay elements (i.e., z-l elements) required to
implement H(z) is called the McMillan degree (or simply,
the degree) of H(z). If the number of delays N in the struc-
ture is equal to the degree, then the structure is said to be
a minimal realization of H(z). This is equivalent to saying
that A is as small as possible.
A summary of acronyms and common notations used in
this paper is found in the Nomenclature, which follows sec-
BASIC BUILDING BLOCKS AND TOOLS
In this section we introduce the basic multirate building
blocks, along with their frequency-domain characteriza-
tions, and interconnection behaviors.
A. Decimators and Interpolators
decimator is characterized by the input-output relation
Fig. 1 shows block diagrams of these building blocks. The
ydn) = x(Mn)
Fig. 1. Building blocks. (a) M-fold decimator. (b) L-fold
interpolator.
which says that the output at time n is equal to the input
at time Mn. As a consequence, only the input samples with
sample numbers equal to a multiple of M are retained. This
sampling-rate reduction by a factor of M is demonstrated
in Fig. 2 for the case of M = 2. The L-fold interpolator is char-
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
Fig. 2. Demonstration of decimation for M = 2.
acterized by the input-output relation
That is, the output yI(n) is obtained by inserting L - 1 zero-
valued samples between adjacent samples of x(n), as dem-
onstrated in Fig. 3for L = 2. The decimator and interpolator
Sincedecimation corresponds tocompression in the time
domain, one might expect a stretching effect in the fre-
quencydomain. To be more precise, theztransform of y,(n)
is given by
which means MY,(e/")
X(e/'"-2"k"M
). The term with
k = 0 is indeed the M-fold stretched version of X(e/"). The
M - 1 terms with k > 0 are uniformly shifted versions of
this stretched version. These M terms together make up a
function with period 27r in w, which is the basic property
of the Fourier transform of any sequence . Fig. 4(c) dem-
onstrates this effect for M = 2. The terms with k > 0 are
called the aliasing terms. As long as x(n) is bandlimited to
IwI < d M , there is no overlap of these terms with the k =
The fundamental difference between aliasing and imag-
ing is important to notice. Aliasing can cause loss of infor-
mation because of the possible overlap of the shifted ver-
sionsof the stretched version of X(e1"). Imaging, on the other
hand, does not lead to any loss of information (which iscon-
sistent with the fact that no time-domain samples are lost).
B. Interconnections
Fig. 5 shows acascade connection which is often encoun-
tered in filter-bank systems. The signal v(n) here is equal to
Fig. 3. Demonstration of interpolation for L = 2.
are linear systems even though they are time-varying , [SI,
The z transform of the interpolator output yl(n) i s given
Y/(Z) = X(ZL).
This means YI(e/") = X(eluL) i.e., YI(e/") is an L-fold com-
pressed version of X(e"?, as demonstrated in Fig. 4(b). The
appearance of multiple copies of the basic spectrum in Fig.
Fig. 5. Effect of decimation followed by interpolation.
x(n) whenever n is a multiple of M, and zero otherwise. The
transform-domain relation is
4 is called the imaging effect and the extra copies are the
V(Z) = - c X(zWk)
images created by the interpolator.
Fig. 4. Transform-domain effects of decimation and inter-
polation. (a) The z transform. (b) L-fold compressed version.
(c) Demonstration of effect when M = 2.
which means that MV(e1") is a sum of X(e/") with the M -
1 uniformly shifted versions X(el(w-2"k'M'
1. From the figure
we see that x(n) can be recovered from v(n) by eliminating
the images by filtering, provided none of the images has an
overlap with X(e?
If such an overlap occurs, it implies
aliasing and x(n) cannot be recovered. Notice that in order
for x(n) to be recoverable it is not necessary for X(e/") to be
restricted to IwI < dM. It is sufficient for the total band-
widthofX(e1")to belessthan2dM.Thusageneral bandpass
signal with energy in the region a 5 w 5 a + 2a/M can be
decimated by M without creating overlap of the alias com-
ponents, and the decimated signal in general is a full-band
A different type of cascade is shown in Fig. 6(a). We shall
have occasion to use this in section IV-B, which concen-
trates on multilevel-polyphase decompositions. It should
becautionedthatthetwo building blocks in Fig.6(a)are not,
in general, interchangeable, i.e., the systems in Fig. 6(a) and
6(b) are not equivalent. For example, with M = L, the system
of Fig. 6(a) is an identity system, whereas the system of Fig.
6(b) causes a loss of M - 1 out of M samples. It can be shown
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
x(n)*yt(n)
Fig. 6. Two ways to cascade decimator and interpolator.
These are equivalent if and only if M and L are relatively
prime. (a) Example of identity system. (b) Example of loss of
M - 1 out of M samples.
(Appendix A) that the systems of Fig. 6(a) and 6(b) are iden-
tical if and only if L and M are relatively prime.
Decimation Filters and Interpolation Filters: In most
applications a decimator is preceded by a bandlimiting fil-
ter H(z) whose purpose is to avoid aliasing. For example, a
low-pass filter with stopband edge U, = TIM can serve as
such a filter. The cascade shown in Fig. 7(a) is commonly
called a decimation filter. An interpolation filter, on the
other hand, is a device which follows an interpolator (Fig.
7(b)), the purpose being to eliminate the images. The low-
pass filter of Fig. 7(c) again serves as an example (with L =
The decimation filter
- -+ilH(eJw;
The interpOlatiOn filter
Fig. 7. (a) Decimation filter. (b) Interpolation filter. (c) Low-
pass filter.
Fractional Sampling Rate Alterations: Fig. 8(a) shows a
scheme for reducing the sampling rate by a nonintegral
(rational) number MIL. Fractional reduction of sampling rate
often results in data compression without loss of infor-
mation. As an example, if X(eJw)
is as in Fig. 8(b), then a frac-
tional reduction by 312 is possible. This can be accom-
Fig. 8. Decimation by rational fraction of MIL. (a) General
structure. (b) Exampleof bandlimited signal. (c) Effect of frac-
tional decimation of this signal ( L = 2, M = 3).
plished by setting M = 3, L = 2 in Fig. 8(a). The filter H(z)
is then taken to be low pass, with passband edge at *I3 and
stopband edge at 2 ~ 1 3 .
Notice that in this application, the
transition bandwidth of H(z) need not be unduly narrow.
The various signals in Fig. 8(a) have transforms as in Fig. 8(c),
so that Y(e/") is a fractionally stretched version of X(e'").
Two Noble Identities: In Fig. 9(a) we have a decimator fol-
lowed by a transfer function G(z). It can be proved, based
Fig. 9. Noble identities for multirate systems. (a) Decimator
followed by transfer function G(z). (b) Equivalent cascade.
(c) Example of transfer function preceding. (d) Equivalent
on (3b), that this cascade is equivalent to the one in Fig. 9(b)
provided G(z) is a rational transfer function (i.e., a ratio of
polynomials in z-'). In a similar manner, the two cascades
in Figs. 9(c) and 9(d) are equivalent (provided G(z) is rational),
as can be proved from (3a). These identities are very val-
uable in practically all applications for efficient implemen-
tation of filters and filter banks. We shall call these the
"noble identities."
C. Analysis and Synthesis Banks
These are the two basic types of filter banks. An analysis
bank is a set of analysis filters Hk(Z) which splits a signal into
M subband signals xk(n) as shown in Fig. 10(a). What we do
Fig. 10. Analysis and synthesis filter banks. (a) Analysis
bank. (b) Synthesis bank. (c) Typical response of uniform
DFT filter bank; here M = 4.
with the subband signals depends on the application, aswe
shall see in sections Ill, VI, and IX. Next, a synthesis bank
(Fig. 10(b)) consists of M synthesis filters Fk(Z), which com-
bine M signals yk(n) (possibly from an analysis bank) into
a reconstructed signal i(n). There are several types of filter
banks, i.e., the complementary type, the Nyquist type, etc.,
to be described in Section V along with applications.
Uniform DFT Filter Banks: An analysis bank with M filters
(M > 1) is said to be a uniform DFTfilter bank if all the filters
are derived from H&) according to Hk(z) = H,(zWk), 0 5
k 5 M - 1. Here H&) is called the prototype filter. Note
VAI DYANATHAN: MULTI RATE DIGITAL FILTERS
that Hk(e/") = Ho(el(w-2*k'M)
), which means that the fre-
quency responses of HJz) are uniformly shifted versions
of Ho(elw). Fig. I O W shows a typical set of responses, where
Ho(z) is taken to be low pass. More details can be found in
section IV-C and in and [Ill.
SOME APPLICATIONS
OF MULTIRATE
We shall now review a number of important applications
of multirate filters and filter banks, with pointers to the lit-
erature for details, examples, and demonstrations. In sec-
tion IX, several unconventional applications are also out-
Applications in the design of transmultiplexers (which
are devices for conversion between frequency division
multiplexing (FDM) and time-division multiplexing (TDM))
are not discussed here in detail, primarily because of the
excellent treatment already available in . Also see [I41
for the correspondence between transmultiplexers and
analysiskynthesis filter banks. The input to a TDM-to-FDM
converter is a signal y(n), which is the time-multiplexed ver-
sion of M signals y&), 0 5 k 5 M - 1. Given y(n), the com-
ponents yk(n) can easily be separated out by use of a com-
mutator switch , . TheseM signals are then modulated
using distinct carrier frequencies. The carrier frequencies
uk, 0 5 k 5 M - 1 are chosen so that there is sufficient spec-
tral gap between the messages. A sum of these M signals
(which is the FDM signal) i s then transmitted through the
channel. The total channel bandwidth is therefore required
to exceed the sum of signal bandwidths because of the safe-
guard gap between adjacent spectra. The gap enables one
to obtain perfect recovery of the multiplexed signals yk(n)
at a future point.
A novel approach to transmultiplexing was suggested in
 and cited in , based on synthesis and analysis filter
banks. This approach permits overlap between the spectra
of successive messages in the frequency domain. The total
required channel bandwidth is therefore less than that in
conventional FDM channels. Conditions are derived under
which cross-talk can be avoided and the set of M original
signals can still be recovered from this version. Details can
be found in reference cited in .
A. Digital Audio Systems
In the digital audio industry, it is a common requirement
to change the sampling rates of band-limited sequences.
This arises for example when an analog music waveform
x,(t) is to be digitized. Assuming that the significant infor-
mation is in the band 0 5 lQ(I27r 5 22 kHz , a minimum
sampling rate of 44 kHz is suggested (Fig. Il(a)). It is, how-
ever, necessary to perform analog filtering before sampling
to eliminate aliasing of out-of-band noise. Now the require-
ments on the analog filter /-/@)
(Fig. Il(b)) are strigent: it
should have a fairly flat passband (so that XJjQ) is not dis-
torted) and a narrow transition band (so that only a small
amount of unwanted energy is let in). Optimal filters for this
purpose (such as elliptic filters , which are optimal in the
minimax sense) have a very nonlinear phase response [16,
page82laround the bandedge (i.e., around 22 kHz). In high-
quality music this i s considered to be objectionable . A
common strategy to solve this problem is to oversample
x,(t) by a factor of two (and often four). The filter H,(jQ) now
has a much wider transition band, as in Fig. Il(c), so that
over-sampling
sampling rate
linear-phase
FIR filter
Fig. 11. (a) Spectrumofx,(t). (b)Antialiasingfilter response
for sampling at 44 kHz. (c) Antialiasing filter response for
sampling at 88 kHz. (d) Improved scheme for A/D stage of
digital audio system.
the phase-response nonlinearity i s acceptably low. A simple
analogBessel filter (which has linear phase in the passband
 ) can be used in practice. The sequencex,(n) so generated
is then lowpass filtered (Fig. Il(d)) by a digital filter H(z) and
then decimated by the same factor of two to obtain the final
digital signal x(n). The crucial point is that since H(z) is dig-
ital, it can be designed to have linear phase [71, [161, [171,
while at the same time providing the desired degree of
sharpness.
A similar problem arises after the DIA conversion stage,
where the digital music signal y(n) should be converted to
an analog signal by lowpass filtering. To eliminate the
images of Y(e'") in the region outside 22 kHz, a sharp cutoff
(hence nonlinear phase) analog low-pass filter is required.
This problem is avoided by using an interpolation filter, as
in Fig. 7(b),which increasesthesampling ratedigitally.After
this, DIA conversion is performed followed by analog fil-
tering. The interpolation filter H(z) is once again a linear-
phase FIR low-pass filter and introduces no phase distor-
The obvious price paid in these systems is the increased
internal rate of computation. However, by using the poly-
phase framework (section IV) the efficiency of these mul-
tirate systems can be dramatically improved.
In digital audio, it is relativelyeconomic (compared to the
analog case) to produce high-quality copies of material from
one medium to another . Perhaps to discourage such
practice, the sampling rates used for various mediaareoften
made different from each other. It is therefore necessary
in studios to design efficient nonintegral sampling rate con-
verters (such as the one in Fig. 8(a)). See section IV-B for
further detai Is. Further applications of mu Iti rate fi Iter banks
in digital audio can be found in section V-E.
B. Subband Coding of Speech and Image Signals
In practice, one often encounters signals with energy
dominantly concentrated in a particular region of fre-
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
quency. An extreme example was shown in Fig. 8(b), where
all the energy is in 0 5 10)
< 2d3. In this case it is possible
to compress the signal simply by decimating it by a factor
of 3/2 (using Fig. 8(a)) or less.
It is more common, however, to encounter signals that
are not bandlimited but still have dominant frequency
bands. An example is shown in Fig. 12(a). The information
Fig. 12. Splitting a signal into subband signals x,(n) and
x, (n). (a) Caseof dominant frequency bands. (b) Splitting the
signal by using an analysis bank with M = 2 (Fig. 10(a)). (c)
Encoding the subband signal.
in IO( > 912 is not small enough to be discarded. And we
cannot decimatexb) without causing aliasing either. It does
seem unfortunate that a small (but not negligible) fraction
of energy in the high-frequency region should prevent us
from obtaining any kind of signal compression at all.
Butthere isawayto get around this difficulty: wecan split
the signal into two frequency bands by using an analysis
bank (Fig. 10(a) with M = 2), with responses as in Fig. 12(b).
The subband signal x,(n) has less energy than xo(n), and so
can be encoded with fewer bits than xo(n). As an example,
let x(n) be a 10-kHz signal (10000 samples/s) normally
requiring 8 bits per sample so that the data rate is 80 kbits/
s. Let us assume that the subband signals x,(n) and x,(n) can
be represented with 8 bits and 4 bits per sample, respec-
tively. Because these signals are also decimated by two, the
data rate now works out to be 40 + 20 = 60 kbitsls, which
is a compression by 413. This is the basic principle of sub-
band coding: split the signal into two or more subbands,
decimate each su bband signal, and allocate bits for samples
in each subband depending on the energy content. This
strategy i s clearly a generalization of the simple decimation
process (which works only for strictly bandlimited signals).
In speech coding practice, further use of the perceptive
properties in each subband is exploited before quantiza-
tion - .
The reconstruction of the full band signal is done using
the interpolators and synthesis bank filters as in Fig. 13. The
Fig. 13. Analysis/synthesis system for subband coding.
(Also called two-band QMF bank; see text.)
interpolators restore the original sampling rate, and the fil-
ters Fk(z) eliminate the images. Further generalizations fol-
low immediately: the signal can be split into M subbands
with each subband signal decimated by M and indepen-
dently quantized.
Pioneering work on the application of this technique in
speech coding has been done by Crochiere , [I91 and
by Galand and Estaban . The coding in each subband is
typically more sophisticated than just quantization. For
example, techniques such as adaptive pulse code modu-
lation (APCM) and adaptive delta pulse code modulation
(ADPCM) are commonly used . The specific properties
of speech signals and their relation to human perception
are carefully exploited in the coding process; the appro-
priate number of subbands and thecoding accuracy in each
subband are judged based on the articulation index. See
 - for complete examples of speech coding, using this
idea. The quality of subband coders is usually judged by
what is called the mean opinion score (MOS). This score is
obtained by performing listening tests with the help of a
widevarietyof unbiased listeners, and asking them to assign
a score for the quality of the reproduced signal ?(n) (in com-
parison to x(n)). The maximum score is normalized to 5 by
convention. Subband-coded speech with an average bit rate
of 16 kbits/s can typically achieve a MOS of 3.1, whereas at
32 kbits/s a score of 4.3 has been achieved in the past [20,
chapter 111.
In video signal processing, subband coding has been
applied for image compression, and success has been
reported by several authors - . The results in , in
particular, use vector quantization in each subband to
obtain acoded imagewith only0.48 bits per pixel. (Theorig-
inal uncoded picture being an 8 bits per pixel image.)
Several commentsare now in order: first, in order for sub-
band coding to work, it is necessary to have some a priori
knowledge abouttheenergydistribution ofX(e1"). In speech
and image processing, for example, such knowledge is usu-
ally available because of the long history of experience with
the coding of such signals. Second, the bandsplitting and
decimation operation inevitably results in aliasing because
the filters Hk(z) are not ideal. The filters Fk(z) should be cho-
sen carefully in such away that aliasing is actually canceled
(see section VI, where we include a detailed review of all
the distortions which arise in the analysislsynthesis sys-
C. Analog Voice Privacy Systems
These systems are intended to communicate speech
over standard analogtelephone links,whileat thesametime
ensuring voice privacy. The main idea is to split a signal x(n)
into M subband signals xk(n) and then divide each subband
signal into segments in the time domain. These segments
of subband signals are then permuted and recombined into
a single encrypted signal y(n), which can then be trans-
mitted (after DIA conversion). For example, if there are five
subbands and twenty-five time segments in each subband,
then there are 125! possible permutations, and unless an
eavesdropper has the key for decryption, he will be unable
to perform a pleasant job of eavesdropping. The aims of the
designer of such a privacy system are: the encrypted mes-
sage should be unintelligible, decryption without a key
should be very difficult, and the decrypted signal should
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
be of good quality retaining naturalness and voice char-
acteristics. These features have indeed been achieved by
Cox et al. .
At the receiver end, y(n) is again split into subbands, and
the time-segments of the subbands unshuffled to get xk(n),
which can then be interpolated and recombined through
the synthesis filters.
Iv. THE POLYPHASE DECOMPOSITION
4ND ITS APPLICATIONS
The polyphase decomposition, which originated from the
work by Bellanger et a/. [Ill, is very fundamental to many
applications in multirate DSP. These include efficient real-
time implementation of decimation and interpolation fil-
ters, fractional sampling-rate changing devices, uniform
DFT filter banks, and perfect-reconstruction analysiskyn-
thesis systems. More recently, the polyphase idea has been
applied for the derivation of new sampling theorems ,
and for recovering bandlimited signalsfrom non-uniformly
sampled versions. In this section the basic concept is intro-
duced and some of the aforementioned applications are
elaborated. Section IX deals with the remaining applica-
tions. To avoid repetitions, results presented in , are
reviewed only briefly here.
A. The Polyphase Decomposition
senting a digital filter. We can rewrite H(z) in the form
Let H(z) = E:=-,
h(n)z-" be a transfer function repre-
H(z) = [. . . + h(-4)z4 + h(-2)1 + h(0)
+ z-'[ - * * + h(-3)z4 + h(-l)z2
+ h(2)zT2 + h ( 4 ) ~ - ~
+ h(1) + h(3)z-Z + . . .].
If we use the abbreviations
Eo(z) = c h(2n)z-",
h(2n + l)z-"
we can re-express (5) in the form
H(z) = Eo(z2) + z-'E1(z2).
Basically, we have merely grouped the impulse-response
coefficients h(n) into even numbered samples eo(n) = h(2n)
and odd-numbered samples e,(n) = h(2n + 1). Denoting the
z-transforms of eo(n) and el(n) by Eo(z) and E,(z), respectively,
we obtain the relation (7). This representation will be called
the two-component polyphase decomposition of H(z). The
quantities Eo(z) and E,(z) are called the polyphase compo-
nents of H(z). As an example, let H(z) = 1 + 2z-' + 5z-' +
Then H(z) = 1 + 5z-' + z-'[2 + 4z-*], so that Eo(z) =
1 + 5z-' and E,(z) = 2 + 4z-l.
Note that the representation of (7) holds whether H(z) is
FIR or IIR. For example, let
By using the identity 1 - x = (1 - x')/(l + x), we can rewrite
so that Eo(z) = 1/(1 - a'z-') and El(z) = a41 - a'z-').
In an exactly analogous manner, it is possible to repre-
sent H(z) in the M-component polyphase form
H(z) = c z-kEk(zM).
Once again Ek(z) are called polyphase components and the
coefficients ek(n) and
In other words, the impulse response sequence {h(n)} has
now been grouped into M subsequences ek(n).The kth sub-
sequence ek(n) is mererly the M-fold decimated version of
h(n + k). Note that for a given H(z), the quantity Ek(z)
depends on M. For example Eo(z) in (7) is totally different
from that in (IO). A second subscript (such as Ek,M(~)),
would make this distinction clear, is avoided in this paper
in the interest of simplicity. In most applications M is fixed,
and there is no room for confusion.
An important property of the representation (IO) is given
by the following relation:
are given by
ek(n) = h(nM + k), 0 I
k 5 M - 1.
M - I c H(ZWk) = ME,(zM)
which follows from the property (IC) of the quantity W. The
z transform Eo(z) of eo(n) is thus seen to be equal to
H ( z " ~ W ~ ) I M ,
and since eo(n) i s nothing but the M-fold deci-
mated version of h(n), this gives a proof of the formula (3b)!
Before getting into applications, we shall mention a sec-
ond type of polyphase decomposition which is notationally
more convenient in some situations. This is given by
H(z) = c z - ( ~ - ' - ~ ) R
It i s evident that RJz) is related to Ek(z) by Rk(z) = EM-' -&),
which is just a renumbering of the components. The rep-
resentations (IO) and (13) will be, respectively, called Type
1 and Type 2 polyphase decompositions. Correspondingly,
Ek(z) and Rk(z), 0 5 k 5 M - 1 are called Type 1 and Type
2 polyphase components. It is important to notice that the
polyphase decomposition can be applied for any sequence
x(n) and is not restricted to impulse response coefficients.
B. Application in Sampling-Rate Alteration
In Section Il-B we mentioned three standard kinds of
sampling-rate alterations, namely decimation, interpola-
tion, and fractional decimation. Each of these involves adig-
ita1 filter H(z), which unfortunatelyoperates at apointwhere
the sampling rate is highest (see Figs. 7(a), 7(b) and 8(a)).
These filtering operations can be made more efficient as
described next.
Decimation Filters: Consider again the decimation filter
of Fig. 7(a) with M = 2. Supposewe implement H(z) (assumed
FlRof 1engthN)directlyasin Fig.14.Thesystem hastocom-
puteonlytheeven numbered output samples y(2n). Foreach
computed sample we require N multiplications and N - 1
additions.Assumethatx(n) isarriving in real-timeatthe rate
Fig. 14. Direct implementation of FIR decimation filter.
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
of one sample per unit time. The scheme of Fig. 14 would
then require that the N multiplications and N - 1 additions
be performed in one unit of time (because, as the next input
sample arrives, the internal delay elementsz-' are updated
to the new set of values). So, whenever y(2n) is being com-
puted, the system is working at the rate of N MPU and N
- 1 APU.' And at odd intervals, the system is sitting idle
(because y(2n + 1) need not be computed). This is clearly
an inefficient use of computing resources.
On the other hand, if we implement the system in poly-
phase form, we can redraw Fig. 7(a) as in Fig. 15(a). Next,
Fig. 15. Polyphase implementation of decimation filter. (a)
Redrawing based on Fig. 7(a). (b) Redrawing by use of first
noble identity (Fig. 9).
with the helpof the first noble identity(Fig.9)wecan redraw
Fig. 15(a) as in Fig. 15(b). Now the building blocks €&z) and
E,(z) are receiving the samples at half the rate (i.e., one sam-
ple in two units of time). We therefore need to perform only
NI2 MPUsand (N - 1)/2APUson theaverage.Thepolyphase
representation is thus a neat tool which enables us to rear-
range the computations of the filtering operation, so as to
minimize the computational load per unit time. Looking at
it in another way, each multiplier in Fig. 14 is required to
complete its operation in one unit of time, whereas in Fig.
I5(b), two units of time are available for the same job.
For general M, the decimation filter can be implemented
using the M-component decomposition of (IO). The com-
putational saving is M-fold.
lnterpolation Filters: Recall the interpolation filter of Fig.
7(b).AssumefirstthatH(z) isdirectlyimplemented as in Fig.
14. The input x,(n) to the filter has all the odd numbered
samples equal to zero. As a result, only about 50 percent
of the multipliers in Fig. 14 have nonzero inputs. As such,
the implementation does not exploit this fact to minimize
the required computation per unittime. For example, when
n is even, h(0) has to work at two times the input rate
(because its input will change after this duration), while at
the same time h(1) is resting. Once again a polyphase
approach will give a more efficient design. For this we use
(13) with M = 2, and invoke the second noble identity (Fig.
9) to obtain the implementation of Fig. 16. Here each mul-
Fig. 16. Polyphase implementation of interpolation filter.
tiplier in each building block is constantly occupied, and
gets two units of time to finish its job.
Commutator Models: A very convenient way to represent
the polyphase decomposition is offered bythe commutator
'The abbreviations MPU and APU represent multiplications per
unit time and additions per unit time, respectively, where a unit
of time is the separation between the samples of the input signal
switch model. The basic principles of this are discussed
clearly in and . The applications of the commutator
model in multirate analysislsynthesis systems is also indi-
cated in . It can be verified that the Type-I polyphase
decomposition can be represented using the counterclock-
wise commutator model and theType-2 polyphase using
theclockwise model. In this paperweshall not makeexplicit
reference to this type of a model, and to minimize dupli-
cation of the results described in and , we refrain from
further elaboration.
Fractional Decimators: Consider Fig. 8(a), which is a
scheme to obtain a sampling rate reduction by the factor
MIL. If we implement H(z) directly, as in Fig. 14, then it is
inefficient due to two reasons: first the input to H(z) con-
tains L - 1 zero-valued samples out of every L samples so
that only one out of L multipliers is working at a time. Sec-
ond, only one out of M computed samples in xdn) is going
to be used. These two factors are related to the fact that the
computations in Fig. 8(a) are done at the point where the
sampling rate is the highest possible.
To obtain a more efficient implementation, we begin by
considering the M = 3, L = 2 example again. By using the
Type-I polyphase representation and rearranging as we did
in Fig. 15, we obtain the implementation of Fig. 17(a). On
Fig. 17. Two ways to improve the efficiency of fractional-
decimation filter. (a) Using Type-I decomposition, based on
Fig. 15. (b) Using Type-2 decomposition, based on Fig. 16.
the other hand, if we use the Type-2 decomposition and
rearrange as in Fig. 16, we get Fig. 17(b). Clearly Fig. 17(a)
and Fig. 17(b) are more efficient than Fig. 8(a), by factors of
M and L, respectively. Can we do better than these? Notice
that Fig. 17(a) exploits the presence of the decimator
whereas Fig. 17(b) exploits the presence of the interpolator.
Is it possible to exploit both?
Theanswer, indeed, is in the affirmative. Such an efficient
scheme is obtained in [3, page 3111 by the use of filter struc-
tures with time-varying coefficients. The derivation in is
based on time-domain reasonings.
We shall now describe an implementation with the high-
est possible efficiency, based on z-domain reasonings 
using the polyphase decomposition. First notice that we are
stuck in Fig. 17 mainly because we cannot move the inter-
polator any more to the right (and decimator any more to
the left). This is because the noble identities simply cannot
be applied anymore! However, here is the nice trick which
comes to our rescue: we can write z-' = z - 3 3 so that Fig.
17(b) can be redrawn as in Fig. 18(a). With the help of the
noble identities, this becomes Fig. 18(b). Next we can inter-
change the decimator with the interpolator (which is valid
because 2 and 3 are relatively prime; see section 11-B) to
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
Fig. 18. Successive redrawings of fractional decimation cir-
cuit, to maximize corn utational efficiency. (a) First redraw-
identities. (c)Third redrawing, interchanging decimator with
interpolator. (d) Fourth redrawing, using Type-I polyphase
decomposition (equation (14)).
ing, when z-’ = Z - ~ Z t: . (b) Second redrawing, using noble
obtain Fig. 18(c). Finally, we can perform aType-I polyphase
decomposition of the polyphasecomponents Ro(z) and R,(z)
as follows:
R,(z) = R,(23)
+ z-1R,,(z3) + Z-2R,(Z3),
R&) = R&?)
+ z - * R , , ( ~ )
so that Fig. 18(c)can be redrawn as in Fig. 18(d). In summary,
Fig. 18(d) is equivalent to Fig. Wa)! If H(z) = Er::
then we still have only N multipliers in Fig. 18(d). However,
each multiplier operates at the lowest possible rate, which
is one-third of the input rate. This trick works for arbitrary
M, L as long as they are relatively prime, because in that
case, two things are true: a) there exist integers no and n,
satisfying -noL + n, M = 1 (Euclid’s theorem, ) so that
wecan replace each 2-l with ~ ‘ ‘ ~ ~ z - ” ’ ~ ,
and b) thedecimator
and interpolator can be interchanged.
C. Application in Filter-Bank Implementations
Consider an analysis filter bank with two filters (i.e., M
= 2 in Fig. IO(a)) and let the filters be related as H,(z) = Ho( -2)
(i.e., a uniform DFT bank with M = 2). If we express Ho(z)
as in (71, then we have H,(z) = E O ( l ) - ~-’€~(2),
so that we
can implement the system as in Fig. 19. If the implemen-
tation of Ho(z) requires N,
multiplications and N, additions,
then the pair [H&z), H,(z)], implemented as in the preced-
ing, requires only N,
multiplications and N, + 1 additions.
We therefore obtain two filters at nearly the cost of one.
Fig. 19. Implementing pair [H,,(z), Ho(-z)].
More generally, consider the uniform DFT filter bank
described in setion 11-Cwith Hk(Z) = Ho(zWk).
Expressing the
prototype H&) as in (IO) we see that
Hk(Z) = c w - k n Z - n E n ( p )
which follows because WM = 1. Notice the similarity of the
summation (15) to the IDFT relation in (Ib). This enables us
to draw the complete analysis bank as in Fig. 20. The total
X ( ” ) Z ? J L [
Fig. 20. Implementing uniform DFT bank using polyphase
decomposition.
computational complexity of this structure, proposed by
Bellanger et al., is equal to that of the prototype plus the
cost of the IDFT operation. For large M, a standard FFT can
be used to minimize the cost of the IDFT. For special values
of M, such as M = 2,4, etc., the IDFT operation is entirely
multiplierless. In any case, it is clear that the structure of
Fig. 20 is much more efficient than a direct implementation
of M filters, because we obtain M filters at the cost of one
filter (plus the IDFToverhead). In fact, in most applications,
the outputs xk(n) of the filters Hk(Z) are decimated by M. By
using the appropriate noble identity we can move these
decimators to the left as shown in Fig. 21. We now see that,
Fig. 21. Redrawing Fig. 20 when xk(n) must be decimated.
apart from the IDFT overhead, the number of MPUs and
APUs of the entire system of M filters with decimation is
1IMth that ofasinglefilterHo(z)without decimation! Inother
words, the complexity tends to decrease as M increases.
This dramatic result is aconsequence of the polyphase rep-
resentation, combined with decimation. The uniform DFT
analysis bank is therefore an efficient tool for spectrum
analysis, and has actually been used in commercial spec-
trum analyzers. See, for example, the recent Tektronix
product described in .
There are, however, some applications for which the uni-
form DFTfilter bank is not necessarily the most well suited.
As we shall see in section VIII, the uniform DFT filter bank
is not the most suitable choice in maximally decimated QMF
bank applications. This is because perfect cancelation of
aliasing with such systems typically requires synthesis fil-
ters of very high order. Moreover, perfect-reconstruction
M-band QMF banks seldom have analysis filters satisfying
the uniform shift property Hk(Z) = /-/0(zWk).
SPECIAL TYPES
OF DIGITAL FILTERS AND FILTER BANKS
A number of multirate applications benefit from the use
of special types of systems such as half-band filters, Mth
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
band filters, and power-complementary filter-banks. We
shall now review these systems and indicate some appli-
A. Half-band Filters, Mth Band Filters, and Nyquist Filters
In most applications, these are linear-phase FIR filters.
The impulse response h(n) is assumed to be Hermitian-sym-
metric with respect ton = 0 (i.e., H(z) = E,"=
- K h(n)z-" with
h(n) = h*(-n)), so that these are, in fact, zero-phase filters.
A half-band filter , [16, page 1401 by definition, is a zero-
phase filter whose impulse response satisfies
where c is usually taken to be 0.5. In other words, the even-
numbered samples of h(n), except h(O), are equal to zero.
If the transfer function H(z) is written in the form of (7),
see immediately that the polyphase component fo(z) is a
constant, i.e., fo(z) = c. Thus
H(z) = c + z-'€,(2)
from which we obtain
H(z) + H(-z) = 2c.
Notice that with z = e'", H(-z) = H(e""-")), which, for real-
coefficient filters, reduces to H(el(*-"'). Thus, for a real-coef-
ficient zero-phase FIR filter satisfying (16), we have
assuming c is normalized to 0.5. This shows that
H(el'"/2-e)) and H(e/'"/2+e))
add up to unity for all 8. In other
words, we have a symmetry with respect to the half-band
frequency d2, justifying the name "half-band filters." Fig.
22 demonstrates the effect of this symmetry for a low-pass
/+(e'") + H(e""-")) = I
Fig. 22. Response of FIR half-band filter.
filter: the peak errors 61 and 6, are equal and the band edges
wp and os are equally distant from 62. These filters are, in
particular, suitable as low-pass filters with cutoff wc at d 2 .
The importance of half-band filters can be more thoroughly
appreciated in section VI-B (see also and [16, page 1431).
Special tricks for the design of half-band filters can be found
in [16, page 1411 and in [361.
With H(z) = E,"=
- K h(n)z-", it is clear that we can assume
K to be odd (otherwise h(K) = h(-K) = 0, in view of (16),
anyway). If we now define a causal version of H(z) to be H&z)
= z - ~ H ( z ) ,
then the relation (18)translates tothewell-known
relation [IO]
HJZ) - H,(-z) = z - ~ .
An Mth band filter is a logical extension of a half-band
filter. We shall define it as a zero-phase FIR filter with
impulse response satisfying
The constant c is usually taken to be 1/M. The property of
(20) i s also called the Nyquist property, for historical rea:
sons . Representing H(z) in the polyphase form of (IO),
it is clear that the component Eo(z) i s equal to the constant
c. In other words, we can write H(z) as
H(z) = c + z-'€,(zM) + Z-2f2(ZM)
Naturally we expect such a filter to satisfy a logical exten-
sion of the property in (18). For this, consider the relation
in (12), which holds for any H(z)-. With fo(z) equal to the con-
stant c, the summation on the LHS of (12) reduces to a con-
stant, i.e.,
C H ( Z W ~ )
for all z.
Notethat anyoneof(20), (21),and (22) implies theothertwo.
Clearly (18) is a special case of (22), with M = 2. The sig-
nificance of (22) is that the M uniformly shifted frequency
responses H(el('-2*k'M)) add up to a contant for all w, if H(z)
is an Mth band filter).
Standard techniques for the design of FIR Mth band fil-
ters can be found in . In most applications (such as in
interpolation filter design and multilevel filter design (sec-
tion IX-D)), the Mth band filter is required to be a linear-
phase low-pass filter with cutoff TIM. The simplest design
procedure that guarantees the Mth band property is the
well-known windowing technique , , in which the
coefficients of h(n) are obtained as
sin ( d M )
where w(n) is a finite-duration sequence called the window
function. If w(n) is taken as the Kaiser window, then any
desired stopband attenuation and transition bandwidth for
H(z) can be obtained by choice of the window length and
a window parameter called 0 [16, page 681. The advantage
of the window method is that the condition (20) is auto-
matically satisfied, because [sin (7rnlM)Il~n
is zero when-
ever n is a nonzero multiple of M.
It is well known that window methods do not result in
filters that are optimal in anyway. An alternative procedure
to design Mth band filters that are optimal in the least-
squares sense is provided by the eigenfilter approach, the
details of which can be found in [38, section VI. Finally,
design procedures which seek to obtain approximately
equiripple (i.e., optimal in the minimax sense) FIR Mth band
filters can be found in 1351.
For the case of arbitrary-phase FIR and IIR filters, one can
still define the Mth band property by requiring that one out
of the M polyphase components €k(z) be constant. IIR Mth
band filters of this type can be found in .
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
B. Complementary Transfer Functions
A set of transfer functions [Ho(z), Hl(z),
* . , HM-,(z)] is
said to be strictly complementary (SC) if they add up to a
delay, i.e.,
M - 1 c Hk(Z) = CZ-"',
An example of this is the set H~(z) = H(zWk), 0 5 k 5 M -
1, where H(z) i s an Mth band filter (see (22)). If we split a
signal x(n) into M subband signals using such a set of filters
(Fig. 10(a)), then the subband signals can simply be added
to get back the original signal with no distortion except for
A set of M transfer functions is said to be power-com-
plementary (PC) if
C IHk(e/u)(2 = c
for all z,
where c # 0 is constant. This property is equivalent to
k = O /ik(Z)Hk(Z)
= cfor all z, by analytic continuation. Such
a property is useful in analysis/synthesis systems (i.e., in
systems where Fig. 10(b) is cascaded to Fig. 10(a)). If the syn-
thesis filters are chosen as Fk(z) = A!&), then we have a(n)
= cx(n), which implies perfect recovery of x(n). In practice,
the noncausality of fijk(Z) is avoided by insertion of a delay
Z-"'SO that a(n) = cx(n - no).
A set of transfer functions is said to be all-pass comple-
mentary (AC) if
Hk(z) = A(z)
where A(z) is all-pass. If such a set is used in Fig. 10(a), and
if the subband signals xk(n) are recombined by adding, the
result i ( n ) satisfies Iz(z)l = JX(e/")l, so that there is no ampli-
tude distortion in the reconstructed signal.
A set of transfer functions is said to be doubly comple-
mentary (DC) if it is AC and PC. There are several appli-
cations of this (including digital audio; see the following).
A pair of FIR transfer functions [Ho(z), H,(z)] is said to be
Euclidean complementary (EC) if the polynomials Ho(z) and
H,(z) are relatively prime (i.e., do not share acommon factor
of the form (1 - 0rz-l) with 0 < la1 < 00. It is well known
(Euclid's theorem [33, page 1751) that if H,(z) and Hl(z) are
relatively prime, then there exist polynomials Fo(z) and Fl(z)
H&Z)FO(Z) + Hl(z)Fl(z) = C,
This means that we can combine the outputs of Ho(z) and
H,(z) to reproduce x(n) with no delay, even when the filters
H,(z), Hl(z), F,(z), Fl(z) are causal FIR! Here is a simple exam-
ple which helps explain this surprising result: let H,(z) =
1 + z - l and H,(z) = 1 - z-'.
Then the choice F,(z) = Fl(z)
= 0.5 results in i ( n ) = x(n). Given the relatively prime pair
[Ho(z), H,(z)], there exists a unique pair [fo(z), Fl(z)] (up to a
scale factor) of lowest degree which can be solved using
Euclid's algorithm.
More generally, a set of M FIR transfer functions [Ho(z),
Hl(z), . . * , k/M-l(Z)] is said to be EC if there is no factor (1
- az-l) with 0 < ICY < 00 common to all of these. Under
this condition, there exists a set of M FIR filters [Fo(z), Fl(z),
. . , FM-~(Z)] such that E;=-/ Hk(Z)Fk(Z) = I. In particular,
if all Hk(z) are causal, then so are all Fk(z).
A warning is appropriate in this context. Suppose the rel-
atively prime polynomials Ho(z) and Hl(z) are causal low-pass
and high-pass filters with JH,(eJ")J, JHl(eJ")J 5 1. Then the
unique lowest degree pair [Fo(z), F,(z)] turns out to be high-
pass and low-pass, respectively (try it!). So with Fo(z), Fl(z)
normalized so that IFo(e/")(, (Fl(el")l 5 1, the constant c in
(26) can be very small. This means that quantization errors
in the design and implementation of the filters can dom-
inate c, rendering this scheme impractical.
C. Relation Between Mth Band Filters a n d Power-
Complementary Filters
Consider a transfer function H(z) represented in the
M-component polyphase form (IO). Define the new transfer
function G(z) = fi(z)H(z). Then the set [Eo(z), E1(z), . * - ,
EM-&)] is power complementary if and only if G(z) is an Mth
band filter. A proof of this can be found in Appendix B.
D. Design of Special Transfer Functions
Since the design procedures are well documented in the
literature, we shall be content with mentioning afew point-
ers here. The design of linear-phase FIR half-band filters is
discussed in and [16, page 1401. The design of FIR linear-
phase Mth band and Nyquist filters is described in , ,
and . As mentioned in section V-A, the simplest approach
for this is based on the window method.
Givenan FIRfilterH,(z)with IHo(el")I I
1,itiseasytofind
an FIR filter Hl(z) such that [H,(z), H,(z)] i s PC. For this, note
that PC property is equivalent to
(/-/,(e/")(* = I - (Ho(e/")('.
In other words, Hl(z) is a spectral factor of the quantity I
- IHo(e/")I2. The coefficients of such a spectral factor can
be computed as follows: compute the zeros of the poly-
nomial 1 - fio(z)Ho(z) (which is equal to fil(z)Hl(z)), and
denotetheseaszl,z,, . . . ,z,,,whereKistheorderofH,(z).
These zeros occur in reciprocal conjugate pairs, i.e., if a is
a zero then so is l/a*. Construct H,(z) by arbitrarily picking
one out of every such pair (this arbitrariness implies that
the spectral factor need not be unique). Since all the zeros
of H,(z) are determined in this way, Hl(z) is determined up
to a scale factor. Methods for computing H,(z) without
explicitly finding the zeros of 1 - fio(z)Ho(z) are described
in and . The method in works even if there are
zeros on the unit circle, whereas the method reported in
 works only if there are no unit-circle zeros.
Finally, IIR filters with doubly complementary properties
are elaborated in and . Some more elaboration on
aspecial classof IlRtransferfunctionswith thedoublecom-
plementary property can also be found in section VI-A of
this paper.
E. Applications of Special Transfer Functions
From the preceding discussions it is clear that Mth band
filters and complementary filters have applications in the
exact reconstruction of a signal x(n) after it has been split
into M subbands (provided the subband signals are not
decimated; decimation would cause aliasing error, which
is a major issue discussed in section VI). A second appli-
cation of Mth band filters is that they are ideally suited as
interpolation filters. Recall that the input to the interpo-
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
lation filter in Fig. 7(b) has M - 1 zeros between adjacent
nonzero samples (with L = M) and that the purpose of H(z)
is to fill these zero-valued samples with a weighted average
of nonzero samples. Clearly, it is desirable to communicate
the original nonzero samples of x,(n) without change. This
i s accomplished [37l if the impulse response h(n) satisfies
Complementary Filters in Digital Audio: The loudspeaker
system in most audioequipment typically hasdifferent sub-
speakers for different frequency ranges; e.g., the tweeter
(high frequency) and woofer (low frequency). In a digital
audio system it is desirable to split the signal y(n) (before
D/A conversion) into the low-pass signal yo(n) and high-pass
signal yl(n) using an analysis bank [Ho(z), H,(z)]. The analysis
bank is more commonly called a "crossover network" in
the audio industry. (See [U] and for analog-filter exam-
ples of this type.) These subband signals can then be D/A
converted and fed into the speakers. Assuming that the
loudspeaker introduces negligible distortion (which, in
general, is not true), the human ear eventually perceives an
analog version of yob) + yl(n). In the transform domain, this
is [Ho(z) + H,(z)] Y(z). To avoid any distortion in the recon-
struction, it is desirable to design H,(z) and H,(z) to be a
strictly complementary pair. This requires the use of linear-
phase FIR half-band filters, which are more expensive than
IIR filters. With IIR filters it is possible to force the all-pass
complementarity. This means that [Ho(z) + H,(z)] Y(z) rep-
resents Y(z) faithfully except for phase distortion. If nec-
essary, phase distortion can be equalized using an all-pass
filter (section VI-A).
It is very desirable to design Ho(z) and H,(z) to be good
low-pass and high-pass filters so that the speakers are not
damaged by out-of-band energy. Notice, however, that if
Ho(z) is a good low-pass filter and if [Ho(z), Hl(z)] is AC, this
does not mean H,(z) isagood high-passfilter.This is because
the responses Ho(el") and /-/,(el") are, in general, complex.
For example, it is possible at some frequencyto have Ho(el")
= e/*/3 and H,(e/") =
so that the sum is 2 cos (d3) =
1, consistent with the all-pass requirement of H,(z) + H,(z).
For this reason a dou bly complementary pair [Ho(z),
is most suitable: the PC property ensures that Hl(z) is agood
high-pass filter (if Ho(z) is low-pass) and the AC property
eliminates amplitude distortion. Such IIR filters can be
implemented much moreefficientlythan FIRfilters, as elab-
orated in , , and in section VI-A. For systems with
several subband speakers, an M-band AC filter bankcan be
used; see for the design of such filters.
More applications of special transfer functions are scat-
tered throughout this paper in various forms.
VI. THE TWO-CHANNEL
Consider the filter bank system of Fig. 13, which is a max-
imally decimated analysiskynthesis system (or a QMF bank)
 , - . The applications of this system were outlined
in greater detail in section Ill. The QMF bank is an LTV sys-
tem (because of decimators and interpolators). In this sec-
tion we shall study the aliasing and imaging effects created
by the decimators and interpolators, emphasizing the M =
2 case. The filters Ho(z) and H,(z) are low-pass and high-pass,
respectively (Fig. 12(b)). The overlapping responses of Fig.
12(b) ensures that no portion of X(e9 is severely attenuated.
However, this overlap also means that the filters do not
bandlimit the subband signals xo(n) and x,(n) to a sufficient
extent, which results in aliasing when xo(n) and x,(n) are
decimated. We should choose the synthesis filters Fo(z) and
Fl(z) to cancel this aliasing, as is explained next.
A. Analysis and Elimination of Errors in the QMF Bank
Since aliasing is permitted, none of the complementary
filters described in section V can be used for perfect recon-
struction without canceling this aliasing.
Consider a typical input x(n) with X(ejw) as in Fig. 23(a).The
signal xo(n) has transform as in Fig. 23(b). From (3b) we
deduce that Vo(e/") = [Xo(e/"'2) + Xo(-e/"'2)1/2, which
describes the aliasing effect in the top channel. From (3a)
we see that Yo(e/") = Vo(e*/"), which describes the imaging
effect. In a similar way, we can trace through the bottom
channel in Fig. 13. The transforms of the various signals in
Fig. 13 are therefore as shown in Fig. 23.
Our aim is to combine the signals yo(n) and yl(n) with the
help of the filters Fo(z) and F,(z) such that aliasing i s can-
celed. The shaded areas in Figs. 23(d) and (g) represent the
two alias components. It is evident that the filters Fo(z) and
Fl(z) should be low-pass and high-pass, respectively, so that
the major part of the aliasing is removed. After this, the only
alias components of considerable significance are around
w = 7d2 and w = 3~12, as shown in Figs. 23(h) and 23(i). These
nonzero components remain because the analysis filters
overlap around d 2 . (Fig. 12(b)). Our aim is to cancel these
two nonzero components.
By using (3a) and (3b) we see that the general relation
between R(z) and X(z) is given by
The term containing X(-z), which is the alias component,
vanishes if we choose
F&z) = H,(-z),
Fi(z) = -H&-z).
With aliasing canceled in this manner we have
R(z) = T(Z)X(Z).
The LTV system of Fig. 13 thus becomes an LTI system with
transfer function
which represents the distortion caused by the QMF bank.
We shall call T(z) the overall transfer function (or the dis-
tortion transfer function).
In general, because of T(z), i(n) suffers from amplitude
distortion (if IT(ej")l is not constant for all w) and from phase
distortion (if T(z) does not have linear phase). To eliminate
amplitude distortion it is necessary to force T(z) to be all-
pass, whereas to eliminate phase distortion, we have to
force T(z) to be FIR with linear phase. Both of these dis-
tortions are eliminated if T(z) is a pure delay, i.e.,
T(z) = Cz-"O
or, equivalently,
i(n) = cx(n - no).
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
Alias-term
a t Output
Alias-term
a t Output
Fig. 23. Illustration of various Fourier transforms in two-channel QMF bank. Here hor-
izontal axis represents W. (a) Typical input. (b) Transform. (c) Aliasing effect. (d) Imaging
effect. (e) Using xl. (9 Using vl. (g) Using yl. (h) Alias-term at output of F,,(z). (i) Alias-term
at output of Fl(z).
Summarizing, the reconstructed signal R(n) in Fig. 13 suf-
fers from three distortions: aliasing distortion (ALD), ampli-
tudedistortion (AMD), and phasedistortion (PHD). In addi-
tion, we have the nonlinear coding error created by the
encoding (or quantization) of the decimated signals. Since
coding error cannot be eliminated, we shall not discuss it
further. On the other hand, we shall see that the first three
errors can be completely eliminated at finite cost by careful
choice of the filters Hk(z) and Fk(z). Such systems which are
alias-free and satisfy (31) are called perfect-reconstruction
(PR) systems.
Elimination of Phase Distortion: For any pair of analysis
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
filters, the choice of (28) of the synthesis filters eliminates
ALD. We then have
T(z) = 1 [H,(z)H,(-z)
- H1(z)Ho(-z)l.
It is easy to force T(z) to be an FIR linear-phase filter simply
by forcing Ho(z) and Hl(z) to be linear-phase FIR.
In the earliest known QMF banks , , the analysis
filters were related to each other as follows:
HJz) = Ho(-z)
F&Z) = H&Z), F,(z) = - H ~ ( z ) = - H ~ ( - z ) .
The choice of (34) ensures that H,(z) i s a high-pass filter if
H&z) is low pass. The choice of (35) i s equivalent to that of
(28) under the condition of (34), thus eliminating aliasing.
We then have
T(z) = [ H ~ ( z ) - H;(-z)] = ~ Z - ' € ~ ( Z ~ ) € , ( Z ~ ) (36)
which automatically has linear phase as long as Ho(z) is cho-
sen to have linear phase (the RHS of (36) is obtained bywrit-
ing H,(z) as in (7)). With ALD and PHD eliminated in this way,
we still are left with AMD. To demonstrate this, Fig. 24(a)
shows three linear-phase designs of Ho(z). The correspond-
ing plots of JT(el")( are shown in Fig. 24(b), demonstrating
the existence of AMD (because the plot is not constant for
all w. If there i s too much overlap between the filters Ho(z)
and Hl(z) (curve I), then there i s peaking in IT(el")I, around
w = d2. Iftheoverlapistoosmall(curve2),then IT(e'")I dips
around d 2 . An optimal overlap based on trial-and-error
results in curve 3, which appears to be fairly good (though
not very exciting).
From(36)weseethatthesystem isPRifandonlyif fo(z)E,(z)
i s a pure delay. Since Ho(z) is restricted to be FIR, this is pos-
sible if and only if Eo(z) and E,(z) are delays, which means
Ho(z) must have the form
Summarizing, a two-channel FIR QMF bank with filters
restricted as in (34) can have PR property if and only if H,(z)
is a trivial transfer function of the form (37).
In practice, frequency responses are required to be more
Ho(z) = CoZ-Z"o + C1Z-(2nl+l).
N O R M A L I Z E D F R E Q U E N C Y
N O R H A L I Z E O F R E Q U E N C Y
Fig. 24. Three design examples for FIR QMF bank, demonstrating amplitude distortion.
(a) Response of analysis filters H,,(z). (b) Corresponding amplitude distortions.
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
sophisticated than (37). So, under theconstraint of (34), per-
fect reconstruction is not possible. After eliminating ALD
and PHD, it is, however, possible to minimize AMD sys-
tematically. To be more specific, one optimizes the coef-
ficients of Ho(z) such that the function 1 T(ej")) is made as flat
as possible, while at the same time minimizing the stop-
band energyof Ho(z).Thusan objective function oftheform
can be minimized by optimizing the coefficients of H,(z).
The second integral in (38) goes only up to u12 because
IT(ej'")l has period u rather than 2u (see (36)). The coefficient
a is used to control the tradeoff between the stopband
energy of H,(z) and the flatness of (T(ej")(. Such optimi-
zation has been done by Johnston , and by Jain and Cro-
chiere . Several tables of optimal filter coefficients can
be found in [41 and .
An efficient implementation of the preceding two-chan-
ne1 QMF bank can beobtained using the polyphasedecom-
position. In view of (34), the analysis bank can be drawn as
in Fig. 19. The decimators which follow this can be moved
to the left of E o ( l ) and E1(2), so that the entire analysis bank
requires only about NI2 MPUs and NI2 APUs. And in view
of the relation of (351, the synthesis bank can be imple-
mented with equal efficiency. Fig. 25 shows the complete
Synhsir bank
Fig. 25. Completetwo-band QMF bankwith H,(z) = Ho(-z),
Fo(z) = H&), F,(z) = -H,(z).
implementation using the polyphase framework. Notice
that the complete system in Fig. 25 requires a total of only
about N MPUs and N APUs, where N is the length of the
low-pass filter Ho(z).
Recall that in the preceding method H,(z) is required to
have linear phase if T(z) must have linear phase. A caution
about thechoiceof N is necessary here: N should bechosen
to be even. An odd value of N results in T(ej"), which is nec-
essarilyzero at w = k u12. For proof, see , or [50, page
7. A different proof is obtained by looking at the RHS of
(36): if N is odd, then Eo(z) and El(z) are linear-phase filters,
and one of these necessarily has odd order, resulting in a
zero at w = u [16, page 731. This translates into a zero of (36)
at w = ku12.
Elimination ofAmplitude Distortion: The choice of filters
as in (34) and (35), with H,(z) chosen as linear-phase FIR,
eliminated ALD and PHD completely, and AMD was then
minimized by optimization. A complementary approach
would be to choose the filters to eliminate ALD and AMD
completely, and minimize PHD. This can indeed be accom-
plished as follows. Again choose the filters as in (34) and (35)
so that (28) is satisfied, resulting in ALD elimination. Now
we have T(z) as in (361, which we wish to force to be all-pass.
From the RHS of (36) we see that this can be done by con-
straining the polyphase components E,(z) and El(z) to be IIR
all-pass! This is precisely equivalent to constraining the
analysis filter Ho(z) to be of the form
where Ao(z) and Al(z) are all-pass filters of the form
A,(z) = ao(z2),
Al(z) = z-'a1(2).
The relevant question now is this: is it possible to obtain
good low-pass filters under the constraint that the transfer
function be of the form of (39a)? The answer, fortunately,
To understand this, recall that the frequency response of
the all-pass functions can be expressed as A,(ej")
and Al(ejw) = ej+l(") so that (39a) takes the form
If the all-pass functions are designed such that the phase
responses +,(U) and +l(o) are aligned in the passband and
in the stopband, IHo(e'")l automatically comes
out to be a good low-pass response! In fact, it can be shown
 that digital Butterworth, Chebyshev, and Elliptic filters
are special cases of the form (39a).
The further constraint (39b) on the all-pass filters is nec-
essary to ensure that Ao(z)12 and A1(z)/2 are the components
Eo@) and z-'€~@), so that (36) will work out to be all-pass,
thus eliminating AMD. We then have T(z) = z-'aO(2)a,(1)/
2. The phase distortion created by the nonlinear phase of
T(eI") can be reduced by all-pass equalization.
Design Procedure: Perhaps the simplest procedure to
design filters of this form involves the recognition , 
that digital elliptic filters (which are optimal in the minimax
sense) automatically have the form of (39a). If the order of
H,(z) is odd, the coefficients of A,(z) and A,(z) are real ,
and we shall assume it is so here. The only remaining step
is to ensure that Ao(z) and Al(z) have the forms ao(z2) and
z -'al(z2), respectively. Now with H,(z) = [ao(z2) + z -'a,(z2)Y
2 and Hl(z) = Ho(-z), we can verify by direct substitution
that 1 Ho(e'"))2 + I Hl(e'w)12 = 1, i.e.,
In other words, 1 Ho(e/W)12
has a symmetry, with respect to
u12, analogous to Fig. 22.
The procedure would then be to design an odd-order
elliptic filter Ho(z) (of specified attenuation and transition
width) with passband ripple 61 and stopband ripple 62 such
that the aforementioned symmetry holds (i.e., 1 - (1 - 264'
= 6;). With all the filter specifications now available, a stan-
dard digital elliptic filter design procedure (such as the one
in [9, pp. 125-1271 followed by bilinear transformation) can
be used to design H,(z).
The filter so designed is guaranteed to have the following
because of the half-band symmetry, which guarantees that
the poles of H,(z) are confined to the imaginary axis of the
z plane (see [43, Appendix] for formal proof). This ensures
that d(z) has the form
(1 + dkz-l)
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
0 < dl < d2 < *
The filters ao(z) and al(z) are now identified as
wp = 0 . 3 8 ~ .
The elliptic low-pass design, based on , then
results in Ho(z) = [ao(z2) + ~-~a,(z*)]12,
0.211056 + z-’
1 + 0.211056z-“
0.685604 + z - ’
= 1 + 0.685604~-”
Fig. 26(a) shows the magnitude response of Ho(z). The group
delay of the QMF bank (i.e., the group delay T ( W ) of T(z) =
z-’ao(z2) al(z2)) is shown in Fig. 26(b). This exhibits a peak
around s12 as expected. The group delay distortion (which
is thedifference between the largestand thesmallest values
of T(w)) i s approximately equal to 14 samples.
A ninth-order all-pass equalizer of the form
with equalizer
Once the polyphase components Eo(z) = ao(z)/2 and El(z) =
a1(z)/2 are so determined, we can implement the complete
QMF bank as in Fig. 25. The phase distortion of the QMF
bank (caused by the nonlinearity of phase d(w) of T(z) =
z-’ao(z2) al(z2)/2), can be seen by plotting the group delay
T(W) = -d+(w)/dw. The nonlinearity of I$(o)
corresponds to
a nonflat nature of ~(0).
This is particularly severe near the
band edge (i.e., around w = d2), and particularly so for fil-
ters with sharp transition bands and/or large attenuations.
Design Example: Assume that Ho(z) is required to have a
stopband attenuation of 40 dB and stopband edge wS =
0.62~. Because of the half-band symmetry, this implies a
peak passband ripple ti1 = 0.25 x
and passband edge
is used to compensate for the group delay distortion of
ao(z)al(z). This means that the reconstructed signal 2(n) must
be passed through €(z*) to get the equalized output. Fig.
26(b)also shows thegroupdelayofthecompleteQMF bank
with theequalizer. This group delay isfairlyflat and exhibits
N O R N R L I Z E O F R E O U E N C V
N O R N A L I Z E D F R E O U E N C V
Fig. 26. Design example for IIR all-pass-based QMF bank. (a) Magnitude response of H,(z).
(b) Group delay of complete QMF bank with and without equalizer.
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
a distortion of only about 2.5 samples. Note that the overall
group delay of the equalized QMF bank is approximately
equal to 23 samples. The coefficients 0, Rk, and
obtained by minimizing an objective function of the form
Jo* [71(u) + 7 2 ( 0 ) - d2 du
where 71(0) is the group delay of ao(z) al(z) and Tz(1.0) is the
group delay of E(z). The quantity c of this is an unknown
constant, and is among the parameters being optimized.
The equalizer parameters found in this matter turned out
R1 = 0.673364,
R2 = 0.660524,
R(3) = 0.662805,
R(4) = 0.666467,
el = 0.7791~,
e2 = 0.1896r,
e3 = 0.3808~,
= 0.5759~,
and /3 = 0.659.
There exist a number of digital filter structures for imple-
menting all-pass filters , I531 which have the following
property: the transfer function remains (stable and) all-pass,
despite quantization of the multipliers. In other words, the
transfer function is structurallyall-pass (i.e., all-pass despite
multiplier values). This is very desirable: if we implement
the QMF bank as in Fig. 25, with the functions Eo(z) and El(z)
constrained to be structurally all-pass, then ALD and AMD
are eliminated regardless of quantization of the structure
coefficients.
See the end of section VI for a discussion of implemen-
tation complexity and for a comparison with other types of
two-channel QMF banks of comparable performance.
B. Two-channel Perfect Reconstruction QMF Banks
Next, how can we eliminate all three distortions, viz., ALD,
AMD, and PHD simultaneously? Such elimination would of
course imply (31), i.e., perfect reconstruction. We can cre-
ate a very simple example of a PR system by choosing the
filters as follows:
F&z) = z-',
F1(z) = 1.
This system is shown in Fig. 27(a). By employing (27) we can
verify that (29) i s satisfied with T(z) = z -' so that i(n) = x(n
- 1). This can also be seen from Fig. 27(a) by noting that the
analysis bank merely partitions the input samples into even-
and odd-numbered subsets. The synthesis bank combines
these subsets and puts the samples back in their original
places (except for a delay z-').
Even though the filters (41) have trivial frequency
responses,this example provestheexistenceof FIR PRQMF
banks. Weshall make useof Fig. 27(a) toconstruct nontrivial
FIR PR QMF examples, where the filters Ho(z) and Hl(z) have
good attenuation. We shall seek the help of the polyphase
decomposition to make the connection between Fig. 27(a)
and more nontrivial systems.
Polyphase Decomposition of the QMF Bank: We have
already seen that a two-channel QMF bank can be drawn
as in Fig. 25 when the filters are related by (34) and (35). We
also saw that if the filters are so related, then perfect recon-
struction is not possible unless the frequency response of
Fig. 27. Pertaining to design of perfect-reconstruction sys-
tems. (a) Simple perfect-reconstruction system. (b) Redraw-
ing two-band QMF bank. (c) Here P(z) = R(z)E(z).
Ho(z) is as in (37). Let us, therefore, not assume at the begin-
ning any relationship between filters.
Suppose each of the analysis filters i s written in the form
of (7), i.e., H&) = Eko(z2) + z-'Ekl(z2), k = 0,l. Similarly let
each synthesis filter be written in the form (13), i.e., Fk(z) =
z-'Rok(z2) + Rlk(z2). We can collect these equations neatly
in matrix-form as follows:
With this, we can redraw Fig. 13 in the form of Fig. 27(b),
where F(z) = [E'[),], 0 I
k, n, 5 M - 1, and R(z) = [REA], 0 I
k, n, s M - 1. Now we can employ the noble identities (Fig.
9) to move the decimator and interpolator, resulting in Fig.
27(c), where f(z) = R(z) €(z).
It is now clear that if the filters Hk(z) and Fk(z) are such
R(z) = €-'(z)
then the system of Fig. 27(c) reduces to that of Fig. 27(a),
which is a PR system! It is in fact shown in that a nec-
essary and sufficient condition for the PR property is that
f(z) should have one of the following forms:
Returning now to the earlier example, where the filters
were related as in (34) and (35), we have
where Eo(z) and El(z) are polyphase components of Ho(z).
We then have
R(z) €(z) = 2E,(z) E&)/.
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
As explained earlier, it is not possible to obtain a PR system
based on this, because Ho(z) would then become con-
strained as in (37).
To obtain an FIR PR system with good filters Ho(z) and
H,(z),we havetogive up theconstraint (34). Smith and Barn-
well have shown how this can be done, based on spec-
tral factorization of half-band filters. We shall review this
same approach from a different viewpoint which enables
us to extend the perfect reconstruction property for arbi-
trary M and, in addition, gives efficient polyphase lattice
structures for robust implementation. Consider the task of
satisfying the general condition (45) for perfect reconstruc-
tion.Thus let us forcethe productP(z)to be dz-K/by requir-
ing R(z) = d ~ - ~ E - ' ( z ) .
This means that R(z) and hence Fk(z)
are, in general, IIR filters. The synthesis filters will be stable
provided the determinant of €(z) is a minimum phase poly-
To obtain a PR system with only FIR filters, we must work
harder. The strategy woud be to constrain det f(z) to be a
delay. A subclass of FIR matrices for which the determinant
is a delay is the family of lossless matrices , . To design
FIR PR QMF banks systematically, we now turn attention to
this family. It should be remembered, however, that loss-
lessness of f(z) is not a necessary condition for perfect
reconstruction [301, [311, [551.
C. Lossless Systems2
Historically, lossless systems are well known in classical
electrical network theory - . An electrical network
composed of lossless elements (such as inductors and
capacitors but no resistors) is said to be lossless.The imped-
ance matrix Z(s) of a multiterminal lossless electrical net-
work satisfies Re [Z(jt?)] = 0. The scattering matrix of a mul-
titerminal network is defined as T(s) = [Z(s) - I][Z(s) + I]-'.
For a lossless network, the property of Z(jt?) translates into
the unitariness of T(jt?). An excellent (and perhaps the only
one of its kind) reference on lossless systems is the text by
Belevitch .
Interestingly enough, the concepts of losslessness and
passivity have played a crucial role in single-rate digital sig-
nal processing (primarily in robust digital filter design) ,
 , - . The importance of lossless systems in mul-
tirate digital filter banks has been exploited in . Our pre-
sentation in this tutorial is based on , , and - ,
which deal with discrete-time lossless systems directly in
the z domain, for application in QMF bank design. -
Discrete-Time Lossless Systems: A p X r transfer matrix
H(z) describes an r-input p-output system with input vector
u(n) and output vector y(n). Thez-transforms of u(n) and y(n)
are related as Y(z) = H(z) U(z). The energy of the sequences
are defined as E, = E;=
ut(n) u(n) and ,Ey = Er=
y(n), respectively. The system H(z) is said to be lossless if
the relation E,,
= cE, holds for every possible input
sequence, where c > 0 is a constant independent of u(n).
If we take c = 1, then the output of the lossless system has
the same energy as the input, justifying the name.
More formally, a transfer matrix H(z) is said to be lossless
if it i s stable (i.e., all entries have poles inside the unit circle
and satisfies
fi(z) ~ ( z )
for all z,
*At this point, the reader may find it beneficial to review the
Nomenclature section, found at the end of the paper.
for some c # 0. The property of (48) implies that H(z) is uni-
tary on the unit circle (see section I), i.e., Ht(e'") H(e"? =
c l for all W.
A constant unitary matrix is a trivial example of a lossless
system. A scalar stable all-pass function H(z), which by def-
inition satisfies 1 H(e'")l = constant, is another example. AS
a third example, if Hk(z), 0 5 k 5 M - 1 is a power com-
plementary set, then the M x 1 vector [Ho(z) Hl(z)
is a lossless system. A lossless example with p =
r is offered by the 2 x 2 orthogonal matrix [A-;].
= r, an FIR lossless systems H(z) satisfies the property det
H(z) = ~ ! z - ~ ,
where d is a constant and K is an integer ,
 . Moreover, the inverse is given by H-'(z) = fi(z)/c, as
seen from (48). In other words, the inverse is not only guar-
anteed to exist, but also can be found from H(z) simply by
writing down fi(z). For example, let
We can verify that this is lossless (because (48) is satisfied
with c = 4). The inverse is given by
H(z) = [: :
1:: ; 1:: 1.
D. Use of Lossless Systems in QMF Design
to be FIR and lossless. We can now choose R(z) as
Returning now to the QMF bank, suppose we restrict f(z)
R(z) = z-Ki(z) = cz-Kf-'(z)
so that perfect reconstruction is guaranteed. The delayz-K
ensures causalityof the synthesis bank. For example, if €(z)
is as in (49), then R(z) should be
[ -1 + z - l
-1 + z - '
With €(z) as in (49) and R(z) as in (52), we have
Ho(z) = 1 + z-' + z - 2 - z-3,
H1(z) = 1 + z-1 - 2 - 2 + 2 - 3
F&z) = [-I + z - ~
+ z - ~ ] ,
Thus the simple choice of filters, as in (53) and (54), results
in an FIR PR QMF bank.
The product of paraunitary systems is paraunitary. There-
fore the product of lossless systems is lossless, so that we
can generate more complicated examples of arbitrary
degree just by multiplyingtogether simpleexamplesof €(z).
However, to obtain a systematic procedure for the design
of QMF banks based on lossless polyphase matrix €(z), we
have to find a technique for characterizing the entire family
of 2 x 2 FIR lossless systems. By performing a systematic
gradient search within this family, it is then possible to
optimize the filter responses Ho(z) and H,(z) so that they
have good stopband attenuations. In preparation for this
we shall now summarize a number of important results per-
taining to the QMF bank based on lossless f(~).
See for
most proofs.
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
Summarizing, an FIR PR QMF bank with €(z) chosen to
be lossless has the following properties: a) [H,(z), H,(z)] is
a power complementary pair; b) Hl(z) is related to Ho(z) by
(56), i.e., by (57); and c) the synthesis filters are given by (58),
i.e., by (59). Conversely, it turns out that if an FIR QMF
bank satisfies these three properties, it is a perfect recon-
st ruction system.
It can finally be shown that if H,(z) is any FIR transfer func-
tion such that its polyphase components foo(z) and E,,(z)
power-complementary (or, equivalently, if /4,(z) H,(z) is a
zero-phase half-band filter; see section V-C), then the fol-
lowing things are true: a) the matrix E(z) defined as (55) is
lossless; b) if Hl(z), F,(z), and Fl(z) are chosen as in (56) and
(58), we have a FIR PR QMF system.
The Design Procedure: In the aforementioned FIR PR
QMF system, once we know H,(z), the remaining transfer
functions Hl(z), F,(z), and Fl(z) are completely determined.
We are now left with one final question: how to design the
coefficients h,(n) of H,(z)? We shall restrict the design to the
case of real h,(n). It i s shown in that every 2 x 2 real-
coefficient FIR lossless system €(z) can be expressed in the
€(z) = dR,A(z) RK-~A(z) . . R,A(z)R~
The four entries of a 2 x 2 FIR lossless system are
related to each other because of the constraint €(z)
€(z) = cl. It can be shown that the most general 2 x
2 causal FIR lossless system has the form
where cy is a constant with (a(
= 1, K 2 0 is an integer
large enough to make the entries causal, and {Eoo(z),
forms a power complementary pair. In what
follows we assume a = 1, as this does not reduce the
freedom for filter design.
As a consequence of this, if we use €(z) to construct
analysis filters as in (42), then Hl(z) i s related to H,(z)
Here 2K + 1 is the order N - 1 of Ho(z) (so that Hl(z)
in (56) is causal). With this, the coefficients of H,(z) are
h,(n) = (-l)"h,*(N - 1 - n).
With the matrix R(z) chosen as z-~€(z) the synthesis
filters determined by (43) are given as
Clearly this choice also implies I Fo(el")l = I H,(e/")I
and I F,(el")( = I H,(e'")l.
With €(z) constrained to be lossless, the pair [H,(z),
H,(z)] i s power complementary, and so is the pair [F,(z),
The quantityk,(z)H,(z)
is azero-phase half-band filter
(section V-A).
where R, are 2 x 2 real orthogonal matrices of the form
A(z) is a diagonal matrix of the form
and d is a real scalar constant of no serious consequence.
Here K is the degree of €(z). Note that the building blocks
(61) and (62) in the product (60) are themselves lossless. With
F(z) used as the polyphase matrix for the analysis filters and
with the synthesis-bank polyphase matrix chosen as (51),
any real-coefficient FIR PR QMF bank with lossless €(z) can
be drawn as in Fig. 28. This is called the lattice structure,
Analysis bank implementation
Synthesis bank implementation
Fig. 28. Lattice structure implementation of two-channel
real-coefficient FIR perfect reconstruction QMF bank with
lossless E(z).
because of the criss-cross nature of the building blocks. The
parameters CY, can be optimized on a computer to ensure
that the stopband energy of H,(z) is minimized; the pass-
band of H,(z) comes out to be automatically good because
of the half-band property of /4,(z) H,(z).
Several design
examples can be found in , along with tables of optimal
filter coefficients with filters designed in this maqner. The
use of filters related by (56) and (58) (with H(z) 2 Ho(z) H,(z)
constrained to be a half-band filter) in the design of perfect
reconstruction QMF banks was first recognized in and
 . The first approach to design such filters was based on
the design of the half-band filter H(z) followed by spectral
factorization. Such factorization is often numerically inac-
curate because H(z) has large attenuation and typically has
several zeros on the unit circle. An inaccurate spectral fac-
tor results in a QMF bank with imperfect reconstruction
property. Later on the lattice structure of Fig. 28 was intro-
duced so that a direct optimization of H,(z) could be done
with no need for factorization; the lattice guarantees per-
fect reconstruction despite coefficient quantization.
A noteworthy feature of the lattice is that regardless of
the values of a, and d, the following properties hold: a)
fio(z) H,(z) is a zero-phase half-band filter; b) H,(z) is related
to Ho(z) by (56); c) [H,(z), H,(z)] is power complementary; and
d) i ( n ) = cx(n - 2K - I), so that perfect reconstruction i s
guaranteed regardless of quantization of the coefficients
Linear-Phase FIR Perfect Reconstruction QMF Banks: In
some perfect reconstruction sytems, it is desirable to have
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
analysis and synthesis filters having linear phase. At first
this might appear to be a redundant requirement because,
the complete analysislsynthesis system has the PR property
anyway (which means that any phase distortion caused by
analysis filters is somehow compensated for by the syn-
thesis filters). However, in practice, the term "PR system"
implies that only the linear errors (ALD, AMD, and PHD) are
eliminated but not the nonlinear coding error (which results
from the coding of the subband signals after decimation).
For low bit-rate coding, the coding errors are typically cor-
related to the signals, and the alias cancellation is not per-
fect in the presence of such errors. Experience has indi-
cated (particularly in image-processing applications) that
the reconstruction error caused by this coding error is less
harmful if the analysis filters used in the QMF bank have
linear phase.
The perfect reconstruction system described in the pre-
ceding is such that the analysis filters Hk(z) do not have lin-
ear phase. This is because a linear-phase power comple-
mentary pair [Ho(z), H,(z)] necessarily has trivial forms (such
as (37)). If we give up the power complementary require-
ment of the analysis filters, we can obtain perfect recon-
struction FIR QMF banks with linear-phase analysis filters
(and synthesis filters of same lengths). Two such families
are reported in [67l, where the losslessness of €(z) (and
hence the power-complementarity of the analysis filters) is
given up forthis purpose.TheresuItinganalysis-bankstruc-
ture is somewhat similar to Fig. 28. The main difference is
that the minus sign in front of olk in each building block is
absent for 0 5 n 5 K - 1 (so that R, is not orthogonal any
more). The last section RK is, however, exactly as in Fig. 28,
with olK = 1. Further detailed derivations, design examples,
and the exact details about the corresponding synthesis
bank can be found in [67l.
E. Computational Complexity and Price Paid for Perfect
Reconstruction
So far in this paper we have seen three methods for the
design of two-channel QMF banks. In one method, the rela-
tions (34) and (35) are satisfied, and H,(z) is a linear-phase
FIRfi1ter;ALD and PHD arecompletely eliminated; and AMD
is minimized using Johnston's procedure , [a].
In another
method, relations (34) and (35) are still satisfied, but H,(z)
is an IIR filter of the form (39a), whereA,(z) and A&) are all-
pass filters of the form (39b); ALD and AMD are completely
eliminated; and PHD reduced by all-pass equalization.
We then described a method where the analysis and syn-
thesis filters are FIR, satisfying a different relation (viz., (56)
and (58)), and are such that fi,(z) H,(z) has half-band prop-
erty. In this method, ALD, AMD, and PHD are completely
eliminated, but the analysis filters do not have linear phase.
Finally, we mentioned a method which gives rise to FIR per-
fect reconstruction systems in which the analysisfilters have
linear phase(whi1eat the sametimeofferingarbitrarilygood
attenuation characteristics).
Several features of the preceding four methods are sum-
marized in Table 1, where a number is assigned to each
method for identification purposes. Notice in particular the
MPU count (derived in the following) for the entire QMF
bank,which isequal tothelengthofthefiIterH,(z)for meth-
ods 1 and 2, and half this length for method 3. The group
delay of the complete QMF system is also tabulated, and
is equal to the order of Ho(z) for the first three methods.
Table 1 Comparison of Four Types of Two-Channel QMF Banks.
(Smith-Barnwell ,
VaidyanathanlHoang
(VaidyanathadNguyen )
(Johnston's Table)
Perfect-Reconstruction
Perfect-Reconstruction
Relation between
H,(z) = Ho(-z)
H,(z) = -z-Lfi,(-z)
not explicit; implicitly
same as method 1
F ~ ( z ) = HoM,
Fo(z) = z-'fio(z),
det E(z) = delay, and
F ~ ( z ) = - H ~ ( - z )
F,(z) = z-'fi,(z)
R(z) = cz-*E-'(z)
L = order of Ho(z)
Phase response of
Other crucial features
f i o ( z ) ~ o ( z )
is a (zero-
phase FIR) half-band
Distortions in QMF
ALD canceled
ALD canceled
AMD minimized
AMD eliminated
PHD eliminated
PHD eliminated
ALD canceled
AMD eliminated
PHD eliminated
nonlinear since H o ( z )
2H0(z) = ao(zZ)
+ Z - ~ ~ , ( Z ~ ) ,
a,(z) IIR allpass
ALD canceled
AMD eliminated
PHD equalized
N, = order of H,(z)
Notation for filter
N, = length of
N, = length of Ho(z)
N3 = length of Ho(z)
length or order as
N, - 1 + equalizer
analysis/synthesis
overhead (all-pass
polyphase)
Number of MPU to
N, (direct-form,
Nz (lattice, polyphase)
implement entire
polyphase)
(lattice, polyphase)
Group delay of entire
analysis/synthesis
complicated
Note: ALD = aliasing distortion; A M D = amplitude distortion; PHD = phase distortion.
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
Counting the Number of MPU: For Method 1 the MPU
count is obvious from earlier discussions. For Method 2,
note that the lattice structure of Fig. 28 enables us to obtain
a polyphase implementation requiring half as many MPUs
as a direct-form implementation of the analysis bank. This
is because each section of the form (61) requires two mul-
tipliers, which operate at half the input rate (because the
decimators can be moved all the way to the left in Fig. 28),
and the number of such sections in the analysis bank is
equal to Nl2, where N is the length of Ho(z). Consequently,
the entire analysis/synthesis system requires only N MPUs.
A direct-form implementation would have required 2N
MPU, and the modified direct form would require 1.5N
MPUs. Next, for Method 3 the same lattice structure can be
used with the modification mentioned in section VI-D. Since
this modification callsfor deletion of the minus sign in front
of ak in Fig. 28, each latticesection requires only one (rather
than two) multiplier 1691, so the MPU count is reduced by
a factor of two. For method 4, the MPU count i s obtained
from the fact that any all-pass function of order L can be
implemented with only L multipliers .
To obtain a more complete feeling for the relative trade-
offs and complexities of the various methods, we compare
them based on design examples of identical specifications
(as far as practicable). Table 2 compares the three FIR QMF
banks. In each method,Ho(z) is required to havea stopband
attenuation A, = 38 dB, and stopband edge w, = 0.586~.
Only method 1 has amplitude distortion, and this is pro-
portional to the second integral in (38) (see for quan-
titative definition). Assume that this distortion i s required
to be 0.025 dB or less. With these requirements, methods
1 and 2 require approximately the same filter length, and
hence the same MPU count. On the other hand, method
3 (where the analysis filters have linear phaseandthe QMF
bank has perfect reconstruction) requires a higher length
of 62. However, because of the existence of a neat lattice
representation for method 3, the number of MPUs required
for the entire QMF bank is nearly same as for methods 1
If this is so, what is the price paid for perfect reconstruc-
tion? Compared to method 1, method 2 has nonlinear-anal-
ysis filters, which can be considered the price paid. How-
ever, this is overcome in method 3. The only price paid in
method 3 is that the overall group delay of the QMF system
is two times longer. Assuming an input sampling rate of 8
kHz for x(n) in Fig. 13, this group delay is approximately 4
ms for methods 1 and 2, and 8 ms for method 3. Even 8 ms
is unlikely to be objectionable in most speech communi-
cation systems.
Next, Table 3 shows a comparison of the FIR perfect
reconstruction system (method 2) with the IIR QMF bank
Table 3 Comparison of Methods 2 and 4, When Both are
Required to have A, = 40 dB, and us = 0.62 ?r
Reconstruction
(IIR System with
FIR System)
Nonzero PHD)
Filter length or order
as appropriate
Number of MPU for
entire analysis/
synthesis system
Group delay
distortion
Other distortions
N, = filter length
for H,(z) = 22
N, = order of
11, with an allpass
equalizer E(z) of
2.5 samples with
allpass equalizer
E(z) of order 9
(method 4) with Ho(z) constrained to have A, = 40 dB and
W, = 0 . 6 2 ~
in both cases. With a ninth-order all-pass equal-
izer, the group delay distortion of method 4 is about 2.5
samples and the MPU count i s only half as much as the FIR
perfect reconstruction system. Note, however, that for sys-
tems with sharper Ho(z), the equalizer tends to have dis-
proportionately higher order, so that the IIR system might
end up having a higher MPU count!
VII. UNIFICATION
OF ALIAS-FREE
QMF BANKS, BLOCK
DIGITAL FILTERS AND LPTV SYSTEMS
There are three topics in digital signal processing, devel-
oped quite independently of each other, that are closely
related by a common mathematical structure . These
topics are alias-free QMF banks, block digital filtering, and
Table 2 Comparison of Design Examples for Three FIR Two-Channel QMF Banks. In
All Three Methods, H,(z) has A, = 38 dB and w, = 0.586 IT
(Johnston’s Tables)
(Vaidyanathan-Hoang)
(Nguyen-Vaidyanathan)
i.e., Imperfect Reconstruction Le., Perfect-Reconstruction i.e., Perfect-Reconstruction
with Linear Phase
with Nonlinear Phase
with Linear Phase
Analysis and Synthesis Filters
Analysis and Synthesis
Analysis and Synthesis
Required filter-length N, = 32 for AMD error E, =
Group delay of entire
analysis/synthesis
Number of MPU for
entire analysis/
synthesis system
Price paid by the
AMD not equal to zero
H,(z) and H,(z) do not
have linear phase
Group delay is longer
method in relation
to remaining two
Note: AMD = amplitude distortion
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
linear periodically time-varying (LPTV) systems. In the fol-
lowing parts of this section we shall review this relation.
A. Alias-Free QMF Banks
Fig. 29(a) shows the M band generalization of the QMF
bank. It is said to be a maximally decimated structure
because the decimation ratio M is equal to the number of
bands.Todistinguish this from tree structures(section VIII),
the scheme of Fig. 29(a) is called a parallel structure. Once
Fig. 29. (a) M-band maximally decimated parallel QMF
bank. (b) Redrawing of Fig. 29(a) in terms of polyphase com-
ponent matrices.
again, this is an LTV system because of the decimators and
interpolators. The correct name for the system of Fig. 29(a)
would be "M-band maximally decimated analysis/synthesis
system." It is, however, loosely called the "QMF" bank in
analogywith the two-channel system of Fig. 13. For the two-
channel case, the response 1 H,(e/'")\ is usually an image of
1 H,(e/")( with respect to the quadrature frequency 7d2, jus-
tifying the name "quadrature mirror filter." For the M-band
case, the name QMF is technically illogical, but has been
used for simplicity by several authors.
If therewere nodecimators and interpolators in Fig. 29(a),
it would have been very easy to obtain perfect reconstruc-
tion by using any one of the special techniques of section
V. In the presence of the decimators and interpolators, we
must be morecarefu1,duetoaliasingeffects. Employing(3a)
and (3b), we arrive at the following relation, which reflects
the aliasing caused by the decimators and the imaging
caused by the interpolators:
. M - I M - 1
M k = O n=O
f ( z ) = -
F ~ ( z ) Hk(zWn) X(zW").
This shows that there are M - 1 alias components X(zW"),
n > 0 in the reconstructed signal, besides the original X(z).
If thesecomponents are eliminated by proper choiceof Fk(z)
and Hk(z), the QMF bank becomes an LTI system with trans-
fer function T(z) = f(z)/X(z) = E;=-:
Fk(z) Hk(z)/M. Further-
more, if T(z) is all-pass, AMD is eliminated, whereas if T(z)
i s linear-phase FIR, PHD is eliminated.
The condition for alias-cancellation can be written in
matrix form , , as
The M X M matrix H(z) in (64) is called the alias-component
matrix. If it can be inverted, it i s indeed possible to find the
synthesis filters Fk(z), 0 5 k 5 M - 1 to cancel aliasing com-
pletely. The difficultywith this approach is that even if Hk(z)
are FIR, the inverse of H(z) could be IIR, so that Fk(z) are, in
general, neither FIR nor stable. If we multiply all Fk(z) bythe
LCM of the denominators of Fk(z), 0 5 k 5 M - 1 to get a
new set of synthesis filters, aliasing continues to be absent
(as seen from (64)), but T(z) changes. In any case, the result-
ing set of synthesis filters can have very high orders. For
these reasons, inversion of H(z) is usually not used as a pro-
cedure for the design of alias-free QMF banks.
If we approach this problem in terms of the polyphase
matrices €(z) and R(z) as in section VI-B, we have much bet-
ter luck. In fact, a convenient procedure for design of
M-band FIR perfect-reconstruction QMF banks based on
lossless €(z) has been developed , , , and will be
summarized in Section VIII.
Suppose we express Hk(z) and Fk(z) in terms of Type 1 and
Type 2 polyphase components, respectively:
Hk(Z) = c z -nEkn(ZM),
Defining the M x M matrices €(z) = [Ekn(z)] and R(z) =
we can then redraw the QMF bank as in Fig. 29(b).
By using the noble identities of Fig. 9, we can move the deci-
mators and interpolators to finally obtain Fig. 30, where&)
Fig. 30. Equivalent structure of Fig. 29.
= R(z) €(z). In conclusion, every M-band maximally deci-
mated QMF bank can be redrawn as in Fig. 30. The prop-
erties of the QMF bank, such as aliasing, and other dis-
tortions depend completely on the behavior of P(z). We now
askourfirst question in thissection(anddiscusstheanswer
in Section VIII-D).
Question 1: What is a set of necessary and sufficient con-
ditions in terms of P(z) so that aliasing is completely can-
B. Block Digital Filters
Consider a single-input single-output (or "scalar") LTI
system with transfer function S(z) (Fig. 31(a)). From the input
sequence x(n) let us create a vector sequence x(n) as fol-
x(n) = [xM-,(n) xM-*(n) . . . x0(n)lT
Ho(ZWM-l) H,(z
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
(a) Scalar transfer function S(z). (b) Its blocked ver-
sion with block length M.
where xdn) = x(nM + k), 0 I
k s M - 1. Then x(n) is called
the blocked version of the scalar signal x(n). Similarly, the
blocked version y(n) of y(n) is
y(n) = [yM-l(n)
yM-2(n) . . * yo(n)lT
where yk(n) = y(nM + k), 0 I
M - 1. The integer M is
called the block length. It can be shown [731- that the
two vector-sequences y(n) and x(n) are related by a transfer
matrix, i.e.,
V(z) = f(z) X(z).
The M x M matrix p(z) is called the blocked version of S(z).
Implementing the filterS(z1 by direct implementation of P(z)
is called block digital filtering. Theadvantageof such imple-
mentation i s that we increase the available parallelism by
a factor of M. Block filtering therefore offers higher imple-
mentation speed due to increased parallelism.
Wecan seethat the blocking operation (68) i s veryclosely
related to polyphase decomposition. Indeed, the compo-
nents of (66) are merely M-fold decimated versions of x(n
+ k), 0 5 k 5 M - 1. It can be seen that the implementation
of S(z) using the blocking approach can be given a flow-
graph representation as in Fig. 31(b). The close relation
between the blocking scheme and QMF banks can be seen
from this representation. Here is the second question we
raise in this section (we shall discuss the answer in the fol-
lowing text).
Question 2: Suppose we are given an arbitrary M x M
transfer matrix f(z). What is a set of necessary and sufficient
conditions on p(z) such that it is the blocked version of some
scalar filter S(z)!
C. Linear Periodically Time-Varying (1 PTV) Systems
Consider a linear system whose coefficients vary period-
ically with time, with period M. For 0 I
M - 1, letAk(z)
represent the transfer function of the system if its coeffi-
cients were frozen to be their values at time -k. For each
k, let us represent Ak(Z) in terms of its M polyphase com-
ponents: Ak(z) = C!:Jz-"Gk,(zM).
Defining G(z) = [Gkn(Z)],
we can represent the LPTV system as in Fig. 32(a). By defin-
ing the components
we can redraw Fig. 32(a) as in Fig. 32(b). The relation of (69)
between the'kth rows of P(z) and G(z) is quite interesting:
thus, with M = 3, we see that f(z) i s given by
Fig. 32. Representation of arbitrary linear periodically time
varying system using polyphase framework. (a) The LPTV
system. (b) Redrawing based on components defined in
equation (69).
P(z) = z-lclz(z)
z -1G2,(Z) z -lG*2(Z) G20(z)
In other words, the kth row of P(z) is a k-times circularly
shifted version of the kth row of G(z) with a delay 2-l
attached to the elements that spill over. Here is the third
question we raise.
Question 3: Let Fig. 32(b) represent an arbitrary LPTV sys-
tem. What is a set of necessary and sufficient conditions on
p(z) so that the system is actually time-invariant?
D. Pseudo-circulant Matrices
Thethreequestions raised in the preceding havethesame
answer! The answer is that, f(z) should have an algebraic
form called the pseudo-circulant form. Thus, if (and only
if)P(z) is pseudo-circulant,thefollowing aretrue: a)theQMF
bank is alias-free; b) f(z) is the blocked version of a scalar
filter; and c) the LPTV system of Fig. 32(b) represents an LTI
system. This result is proved in . In this section we shall
merely state the meaning of "pseudo-circulant." Taking M
= 3, for convenience, a 3 x 3 pseudo-circulant has the form
Po(z) :El.
Thus P(z) is a circulant matrix with the exception that
theentries below the main diagonal are multiplied with z -'.
Pseudo-circulants have also been observed explicitly or
implicitly in the context of block processing by other
authors , - .
Assuming that f(z) is pseudo-circulant, what is the scalar
filter S(z) of which f(z) is the blocked version? The answer
P, (z) z - PJZ)
z-kPk(ZM).
In other words, the 0th row of f(z) contains the type-1 poly-
phase components of s ( ~ ) .
Next, given a QMF bank with
pseudo-circulant f(z) (so that aliasing is canceled), the dis-
tortion function T(z) of (64) is given by
T(z) = ~ - ( ~ - l )
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
It can also be shown that P(z) is lossless if and only if S(z)
is stable all-pass. Thus an alias-free QMF bank is free from
AMD if and only if the pseudo-circulant is lossless, and the
blocked version of a scalar filter is lossless if and only if the
scalar filter is stable all-pass!
VIII. M-BAND PERFECT
RECONSTRUCTION SYSTEMS
Perfect reconstruction in M-band FIR QMF banks has
been shown to be possible in the past , , . We shall
now summarize some techniques for this.
Consider the M-band QMF bank of Fig. 29(a) again. As
seen in Section VILA, there are M - 1 alias components in
k(n), and these components are removed if and only if (64)
holds. If perfect reconstruction is also desired, we have to
force T(z) to be a delay. It remains to solve for the synthesis
filters Fk(z) in (64). Once again we wish to avoid inversion
of the alias-component matrix. So we lean on the polyphase
representation of Fig. 29(b), which is completely equivalent
to Fig. 29(a).
As we did in section VI-B, we can choose R(z) = E-’(z) to
obtain perfect reconstruction. To avoid inversion of F(z), we
wish to force it to be lossless so that €(z) = cF-’(z). This
means that the choice of R(z), as in (51), will ensure the PR
property. Assuming that H ~ ( z )
(and hence €(z)) are FIR, this
also ensures that R(z), and hence Fk(z) are FIR. Moreover,
this choice of R(z) i s equivalent to choosing the synthesis
filter coefficients as 
fk(n) = &;(no - 1 - n),
0 5 k 5 M - 1
where no is the length of the longest analysis filter, and a
i s a nonzero constant which can be scaled to be unity.
It remains to show how E(z) can be forced to be lossless.
In the M = 2 case, we had the factorization result (60) for
lossless matrices. Similar factorization theorems have also
been developed - for the M x M case. A structure
has been developed in for real coefficient FIR lossless
transfer matrices based on a state-space approach. The
structure is such that every M x M real coefficient FIR loss-
less system can be realized using this structure. Conversely,
regardless of the values of the parameters in the structure
(which are angles of rotation), the transfer matrix remains
(FIR and) lossless. The development in is based on the
discrete-time lossless bounded real lemma which
relates the losslessness of €(z) to the state-space descrip-
tion (see end of section I for state-space notations). Accord-
ing to , a stable transfer matrix€(z) is lossless if and only
if there exists a structure (with minimum number of delays)
such that the system matrix
is unitary. Acomplete parameterization of all lossless matri-
ces of a given degree can therefore be obtained merely by
parameterizing all unitary matrices of a given size. The
development in makes further use of the fact that F(z)
is FIR, so that A has all eigenvalues equal to zero. Because
of the unitariness of the R matrix, the structures in are
also said to be ”orthogonal filter structures.”
The only disadvantage of the structure in is that the
parameters in the structure are sines and cosines of angles.
If we wish to optimize the analysis filter responses by opti-
mizing these angles, then the procedure involves several
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
computations of sines and cosines per iteration, which
results in a very slow optimization procedure.
It is possible to obtain a more convenient characteriza-
tion of FIR lossless matrices that is free from cosines and
sines. The following result is proved in and and
works for the real as well as complex coefficient case.
Theorem. An M x M causal FIR transfer matrix F(z) of
degree K is lossless if and only if it can be expressed in the
where Vn(z) are M x M matrices of the form
E(z) = vK(z) vK-I(z) ‘ ’ ’ vl(z)/fO
VJZ) = [I - v, v:, + z - lv, v:]
in which v, are M x 1 column vectors of unit norm, and Ho
is an M x M constant unitary matrix.
The term ”degree” in the preceding statement indicates
the smallest number of scalar delays (i.e., z-’ elements)
required to implement the system. It can be shown , 
that the form (76) for V,(z) with unit-norm v, automatically
guarantees that Vn(z) is (causal, FIR, and) lossless of degree
one. If we write down the state-space representation of the
system implemented as in (75), the system matrix R turns
out to be unitary . In other words, the structure for €(z)
obtained in this way is an “orthogonal” structure in the
same sense as those in are. This property is important
because it implies certain useful properties for finite word-
length implementations, such as automatic Oe2 scaling of
internal nodes, and reduced round-off noise .
It is important to note that for the case of real coefficient
FIR lossless matrices, the unit-norm vectors v, in (76) and
the unitary matrix Ho in (75) are real.
It is possible to optimize the unit-norm vectors v, in (76)
and the unitary matrix Ho in (75) such that the sum of stop-
band energies of the analysis filters Hk(z) is minimized.This
issue is handled in much greater detail in . In fact, it is
possible to completely avoid rotation angles in the expres-
sion (75) (and this helps to speed up the optimization of the
analysis filter responses) because the unitary matrix Ho can
also be expressed as a product of M - 1 matrices of the form
[I - 2w, w;]
(where w, are unit-norm column vectors), fol-
lowed by a diagonal unitary matrix. The factor [I -.
2w, 4 1 , which is a unitary matrix, is thewell-known House-
holder form.
The degree-one lossless building blocks described by(76)
can be implemented with 2M multipliers and one scalar
delay (see Fig. 33). For the real coefficient case, Ho can be
Fig. 33. Implementation of degree-one M x M FIR lossless
building block using 2M multipliers and one scalar delay.
implemented using (r)
planar rotation angles (see and
 ), each of which is equivalent to four real multiplica-
tions. The matrix H, then requires 4 (r)
multiplications so
that the total number of real multipliers in a real-coefficient
FlRanalysis bankwith losslessF(z),as in(75), isequal to2MK
+ 2M(M - 1).
Robustness of Perfect Reconstruction Under Coefficient
Quantization: Recall that as long as the polyphase matrix
of theanalysis bank has the form (75),wherevnareunit-norm
vectors and Ho is unitary, the filter bank of Fig. 29(a) has per-
fect reconstruction provided the synthesis filters are cho-
sen as in (74). The unit-norm requirement of y,, and uni-
tariness of Ho are essential to ensure losslessness of €(z) (and
hence perfect reconstruction). Now suppose that we
actually implement the analysis and synthesis banks in
polyphase form (Fig. 29(b)) with R(z) related to €(z) as in (51)
(i.e., fk(n) related to hk(n) as in (74)). In particular, assume
that E(z) is implemented as in (75), with building blocks as
in Fig. 33. In practice we have to quantize the components
of v,, appearing in the building block.The norm of thequan-
tized v,, is not unity any more. If we do not exercise addi-
tional care, perfect reconstruction property will be lost
because of this. However, here is a simple trick which over-
comes this problem: instead of using the building blocks
(76) use the denormalized building blocks
U,,(z) = [u:u,/ - u,u: + z-'u,u:]
where U, is the quantized version of the unit-norm vector
v,,. The modified building blocks are lossless, i.e., U&) U,,(z)
= a,,/for some scalar a,, > 0. Next, in practice, the elements
of the unitary matrix Ho in (75) should also be quantized.
Recall that H,, can be expressed as a product of the matrices
[I - 2w,, w:] (and a diagonal matrix). If we replace each of
these with [u:u,,/ - 2u,u:],
whereu, is a quantized version
of w,,, then the resulting product is still unitary (but denor-
malized). The overall result of these replacements is that,
€(z) is replaced with c€(z), where c is some positive scalar.
The losslessness property of the polyphase matrix is there-
fore preserved under quantization, and so is the perfect
reconstruction property of the filter bank!
Other Quantization Effects: In general, quantization of
the filter coefficients in the analysis bank results in deg-
radation of the analysis filter responses. Because of the loss-
less property of Rz), it is, however, possible to reduce the
passband sensitivity of the responses 1 Hk(e'")l with respect
to coefficient quantization (as discussed in , , and
 ). It should, however, be noted that in subband coding
applications, passband sensitivity of the analysis filters is
not very crucial. It is more important to have good rejection
of adjacent-band signals (i.e., good stopband attenuations)
so that the subband features can be exploited during the
coding process. Simulation results in show that the
stopband sensitivity of the analysis filters with respect to
thecoefficientsofthe lossless matrix&) areacceptablylow
in practice. It is also desirable to have perfect reconstruc-
tion in spite of coefficient quantization, which in turn can
be accomplished as described in the preceding.
Roundoff Noise and Coding Noise: The FIR perfect
reconstruction system implemented in terms of the lossless
matrices€(z) and R(z) is also subject to roundoff noise errors,
due to internal signal quantization. This has been analyzed
in for the two-channel case. Because of the lossless
nature of the building blocks, the noise gain from the loca-
tion of the noise source to the location of f(n) does not
exceed unity. The output noise variance is therefore well
under control. See for more quantitative details. A sec-
ond (and major) source of error arises from the fact that the
subband signals (outputs of the analysis filters Hk(Z)) are
coded prior to transmission. The analysis of this noise is
rendered difficult because the coding noise sources from
adjacent channels are not necessarily uncorrelated and,
moreover, each noise source can be colored.
IIR QMF Banks with Lossless E(z): If we replace each delay
element z-' in (75) with a degree-one all-pass function
(ai + z-')/(I + a,,z-') (where la,,[ c 1 for stability), then
€(z) becomes an IIR lossless system. Moreover, every
degree4 M x M IIR lossless system can be realized in this
manner . In the FIR case with lossless E(z), we had to
choose R(z), as in (51), to obtain perfect reconstruction. In
the IIRcasethiscannot bedone becauseE(z)will have poles
outside the unit circle. To overcome this problem we pro-
ceed as follows: we write €(z) = P(z)/d(z), where d(z) is the
least common multiple of the denominators of the entries
of €(z), and f(z) is the matrix of correspondingly adjusted
numerator polynomials. We then choose R(z) = ~ - ~ R z ) / d ( z )
so that R(z) (and hence the synthesis filters) are guaranteed
to be stable. With this choice we have R(z) €(z) = ~ - ~ [ d ( z ) /
d(z)]/, so that the distortion T(z) in (29) is all-pass. Sum-
marizing, there is no amplitude distortion, only phase dis-
tortion. A second method based on the determinant of €(z)
i s indicated in page 491 of . These ideas work for arbi-
FIR Design Examples: We shall now present design exam-
ples of FIR perfect reconstruction systems. For a three-
channel system, Fig. 34(a) shows an example of the
responses I Hk(e/")I of the three analysis filters. These were
lengfhs-56,53.56.
lengths-44 each.
NORMALIZED FREQUENCY *
Fig. 34. Examples of magnitude responses in dB for anal-
ysis filters of various FIR perfect reconstruction systems. (a)
Three-band analysis bank. (b) Five-band analysis bank. (c)
Three-band linear-phase analysis bank.
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
designed by constraining €(z) to be lossless as just
described, and optimizing the parameters of v, and H,. The
optimization was carried out using appropriate software in
 . Initialization of theoptimization wasdoneasdescribed
in . To obtain perfect reconstruction, the FIR synthesis
filters were obtained as in (74) with no = 56. As a second
example, Fig. 34(b) shows the responses of the analysis fil-
ters Ho(z), l+,(~), and H2(z) for the M = 5 case.The remaining
two filters are given by H&z) = H1(-z) and H4(z) = Ho(-z),
and are therefore not shown (this relation is not necessary
for perfect reconstruction, nor is it automatic; see ). The
FIR matrix F(z) was again constrained to be lossless. Once
again, if synthesis filters are chosen according to (74) with
no = 44, we have perfect reconstruction, because of the
losslessness of F(z) which was forced during the design of
Hk(z)’s.The table of filter coefficients for these two exam-
ples can be found in and , respectively. Finally, Fig.
34(c) shows the analysis filter responses for a three-channel
QMF bank, where the analysis filters have linear phase; the
matrix F(z) is not lossless here, but still has a determinant
equal toadelay.Thetableof filter coefficientsforthis exam-
ple can be found in [87l.
Methods Based on Tree-Structures: When M is a power
of two, we can obtain the QMF bank by repeated use of the
two-channel QMF bank. See for details. If the two-chan-
ne1 building block is designed to have the PR property, then
so does the M channel tree-structured design. Since the
design of the filters Ho(z) and Hl(z) is easier than a direct
M-band design, tree structures are often considered attrac-
tive. However, for agiven M, tree structures are not optimal
in terms of filter lengths and result in greater group delay
of the overall QMF system, compared to nontree designs.
Such group delays are of concern in long-distance com-
munication links, where echos are possible.
Methods Based on Approximations: Some authors have
developed methods for designing the filters Hk(z) such that
the three distortions (ALD, AMD, and PHD) are approxi-
mately eliminated. Notable among these are and .
These are based on the design of an appropriate optimized
prototype filter, from which the other filters can be derived
using a modified form of cosine modulation. The approx-
imate designs are sometimes less expensive to implement
than the perfect ones.
Price Paid for Perfect Reconstruction: It is sometimes
assumed that one must pay a high price in terms of design
complexity, to achieve perfect reconstruction in FIR QMF
banks. This, however, is not true. The PR property often
admits the representation of the analysis bank in terms of
lattice structures, which are surprisingly efficient. If a PR
system is implemented in lattice form, it is often not more
expensive than an approximate design with comparable
attenuations for the analysis filters. See section VI-E and
Tablesl-3of this paper;also seePO, pp. 701-703lforfurther
quantitative remarks.
As a further demonstration of this claim, consider the FIR
perfect reconstruction example in Fig. 34(c). The analysis
filters here have linear phase. A design example is pre-
sented in [87l for the M = 3 case, where the filters Ho(z),
Hl(z), and H2(z) have lengths 56,53, and 56, respectively. The
entire analysis bank of three filters, if implemented using
the lattice structure in [87, requires a total of only 8 MPUs
and 11 APUs!
Let us now count the total number of multiplications in
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
the M band FlRanalysis bankwith lossless polyphase matrix
F(z) implemented as in (75). Assuming thecoefficients of the
filters to be real (so that v, and Ho are real), we have a total
of 2MK + 2M(M - 1) multipliers for the analysis bank. With
F(z) as in (751, the analysis filters have maximum length N
= KM + M, so that the number of multipliers becomes 2(N
- 1) + 2(M -
Recognizing that these multiplications can
be performed at the lower rate (by moving the decimators
to the left of F(z) in Fig. 29(b)), the number of MPUs for the
analysis bank is equal to 2(N - 1)lM + 2(M - 1)21M = 2(N
- 1)lM + 2M. In comparison, consider the uniform DFT
analysis bank of Fig. 21, which we found to be very efficient
in section IV. Assuming that the analysis filters have length
N each, the total number of multiplications is equal to N
plus the cost of IDFT. The number of MPUs is equal to
N/M plus the DFT cost, which depends on M. For N >> M
we see that the perfect reconstruction FIR system with loss-
less&) implementedas in (75)isonlyabouttwotimes more
expensive than the uniform DFT filter bank with same filter
orders! In fact, if we impose certain symmetry conditions
among the analysis filters Hk(z) in the perfect reconstruc-
tion system (as elaborated in [go]), then the number of MPUs
for the perfect reconstruction system is reduced by a factor
of two, so that it becomes equal to that of the uniform DFT
polyphase analysis bank. Summarizing, the computational
complexity of the FIR perfect-reconstruction analysis bank
based on lossless polyphase matrices can be made com-
parable to that of the uniform DFT polyphase analysis bank
for same N, whenever N >> M.
Unsuitability of the Uniform DFT QMF Bank for Perfect
Alias Cancellation: The uniform DFT FIR analysis bank
shown in Fig.21 iscomputationallyveryefficient,and iswell
suited for spectrum analysis. However, it is usually not well
suited for QMF bank applications requiring perfect recon-
struction (hence perfect alias cancellation in particular). This
can be seen by referring to , which derives the necessary
and sufficientconditionsontheFlRsynthesisfiltersforalias
cancellation in this case. It turns out that the synthesis fil-
ters typically have much higher orders than the analysis fil-
ters, resulting in a much more expensive synthesis bank.
In contrast to this, the perfect reconstruction FIRQMF bank
based on general lossless FIR €(z) (rather than on uniform
DFT analysis bank) is such that each synthesis filter has the
same length as the corresponding analysis filter (see (74)).
The overall cost of the complete analysislsynthesis system
is therefore lower.
Alias-component matrix, polyphase component matrix,
and interrelations: It can be shown that the M x M
matrix in (64) is lossless if and only if the polyphase com-
ponent matrix F(z) is lossless. So by forcing €(z) to be loss-
less, we make the inversion of (64) simple; in fact, closed-
form expressions for fk(n) as in (74) are obtained.
For any M-band maximally decimated FIRQMF bank, con-
sider the following three properties: a) losslessness of €(z);
b) the relation (74); and c) perfect reconstruction property
(32). It can be shown that any two of these imply the
third. For example, if a QMF bank satisfies (74) and has per-
fect reconstruction property, then &)
must be lossless.
Similarly, if F(z) is lossless, then we have perfect recon-
struction if and only if (74) holds. Note, however, that nei-
ther losslessness of E(z) nor the relation (74) are, by them-
selves, necessary or sufficient conditions for perfect
reconstruction.
Notice that in Fig. 29(b) if €(z) is replaced with the M x
M DFT matrix, it is equivalent to performing an orthogonal
(rather unitary) transformation on blocks of the input. A
more general type of orthogonal transformation called the
“lapped orthogonal transformation” (LOT) has recently
been used in image processing applications . Interest-
ingly enough, the LOT has been developed quite indepen-
dently (see and references therein) but turns out to be
an analysis bank with lossless €(z) of low degree. See ,
where the authors have established the link between LOT
and paraunitariness; also see .
IX. UNCONVENTIONAL
APPLICATIONS
In this section we outline some unconventional appli-
cations of multirate filter banks in signal processing. These
include new sampling theorems, new techniques for effi-
cient quantization of filter coefficients, and adaptive fil-
tering in subbands.
A. New Sampling Theorems Based on the QMF Principle
and Polyphase Decompositions
The sampling theorem for continuous-time signals has
been well known for several decades , . The earliest
known version says that if a continuous-time signal x,(t) is
bandlimited to -u < Q < u, it can be reconstructed from
equallyspaced samplesx(n) = x,(nT) provided thesampling
frequency 2dTexceeeds the so-called Nyquist rate 8 20.
Under this condition, the transform X(e1”) is a periodic rep-
etition of X,(jQ) properly scaled, as shown in Fig. 35. Quan-
lowpass filler lor
recovering x&
from samples,
Fig. 35. Transform of x,(t) and transform of sampled ver-
sion x,(nT). (a) Signal recovery. (b) Low-pass filtering.
titatively,
The signal x,(t) can be recovered from the samples x(n)
merely by low-pass filtering the impulse train Er=
6(t - nT), which results in elimination of the unwanted cop-
ies of the basic spectrum X,(jQ) in Fig. 35(b). Notice that the
low-pass filter required is an ideal filter which is IIR, non-
causal, and unstable 17, 181.
Several generalizations of this theorem are known .
Perhaps the earliest one, called the derivative sampling
theorem, says that if x,(t) and dx,(t)/dt are available (for
example, the position and velocity of an aircraft), then uni-
formly spaced samples of these two waveforms, taken at
half the Nyquist rate, are sufficient to retain all the infor-
mation. In other words, the signal x,(t) can be recovered
from these samples. Once again, the use of ideal filters is
required in the recovery pr0cess.A natural extension of this
theorem i s that if x,(t) and the first M - 1 derivatives are
available (such as the position, velocity, acceleration, jerk,
etc. of an aircraft), then each of these can be uniformly sam-
pled at the rate 8 / M without losing information. No simple
closed-form expressions are available, however, for the
reconstruction of x,(t) from these generalized samples.
The second family of generalizations is the class of non-
uniform sampling theorems . The basic idea is that the
samples of x,(t) can be spaced in an entirely nonuniform
manner (Fig. 36) provided the sampling rate averaged over
Fig. 36. Demonstration of nonuniform sampling.
a sufficiently long period exceeds 8. More precise state-
ment of this result can be found in and references
therein.This result is called the nonuniform sampling theo-
rem, and less formally, the ”folk theorem.”The knowledge
of this result seems to date back to the days of Cauchy
(1841!). An extreme case of the folk theorem is the assertion
that a bandlimited signal is completely determined every-
where if all its past samples, taken at twice the Nyquist rate,
are available! The reconstruction of x,(t) from the nonun-
iformly spaced samples is, in general, very involved ,
However, if we take a second look at these sampling theo-
rems from a discrete-time viewpoint, the insight obtainable
i s rewarding. For example, let x(n) be a bandlimited
sequence, i.e., a sequence whose transform X(e1“) vanishes
for w, 5 IwI 5 K, with wC < K. An example with wC = 2d3
was seen in Fig. 8(b). It i s clear that we can construct a new
sequence y(n) with a lower rate, without losing information.
Fig. 8(a) shows how to do this in terms of the fractional deci-
mator circuit (L = 2, M = 3). We know that if H(z) is ideal
low-pass with cutoff 2d3, Y(e’“) is a stretched version of
X(e/”) by the factor 3/2.
This, however, is not theonlywayto reduce thesampling
rate. A simpler way to compress x(n) in Fig. 8(b) would be
to divide the time index into segments of length three and
retain two out of three samples in each segment. This is
equivalent to nonuniform sampling of a hypothetical
underlying continuous-time signal. From this nonuni-
formly decimated version y(n), is it possible to recoverx(n)?
The answer is yes, as we would expect because of our
knowledge about the “folk theorems.”
The main point we wish to make is that this problem
can be stated in the form of a QMF bank design problem.
With such a restatement, the algorithm for reconstruction
ofx(n)fromy(n) is seen to beasimplesynthesis-bankdesign
problem, which actually can be carried out in practice with
FIR filters. To demonstrate these ideas, consider the exam-
ple of Fig. 8(b) again. We wish a data rate reduction of 312.
Thiswill beaccomplished by retainingtwoout of everycon-
secutive segment of three samples. Fig. 37 shows a way to
mechanize this subsampling based on multirate building
blocks.The samples retained in the process are those num-
bered . . . -4, -3, -1,O,
2,3,5,6,8,9,
. . . Consider now
the M-channel maximally decimated QMF bank of Fig. 29(a)
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
Fig. 37. Mechanization of nonuniform subsampling pro-
with M = 3, and let the analysis filters be Ho(z) = 1, H,(z) =
z-l, and H2(z) = 0. The analysis bank then resembles Fig.
37. Question: how do we design the synthesis filters Fo(z)
and Fl(r) such that f(n) is equal to x(n)? This problem can
be formally solved using the matrix description of section
VII-A.The resultsderived in showthat the required syn-
thesis filters are
Fo(z) = z-'[1 - c + S G H ( Z ) ] C,(Z),
F,(z) = [I - c - sG,(z)]
where GL(z) is an ideal low-pass filter with cutoff U, =
2 d 3 and CH(z) is an ideal Hilbert transformer , [Iq, i.e.,
GH(ej") = jsgn[o]. The claim is that the choice (77) results
in i ( n ) = x(n - 1). In practice, the ideal responses can be
approximated with linear-phase FIR filters with any desired
accuracy. See for design examples of this type. Exten-
sion of these results for the multidimensional case can be
found in [loll.
A more complete analysis of this type of reconstruction
filter banks has been done in [IOI]. For the case of general
L and M, the ideal solution for the reconstruction filters
turns out to be such that each filter fk(z) is a multilevel filter.
(Multilevel filtersaredescribed in section IX-Dof this paper.)
This means that the response fk(el") is a piecewise constant
with M (possibly complex) levels in the region 0 5 (J < 2a.
It turns out that all the M filters F&)
can in practice be
implemented by implementing a single Mth band low-pass
filter in polyphase form, and obtaining fixed linear com-
binations of the outputs of the polyphase components.
Consequently, the price paid for the set of reconstruction
filters is equal to the price of a single Mth band low-pass
filter plusthecost of implementingaconstant M x L matrix.
Details can be found in [loll.
The advantage of these compression techniques based
on nonuniform subsampling is that the compression is
computationally very simple. The only price paid i s for the
implementation of filters Fk(z) at the reconstruction stage.
These techniques are attractive when a transmitter has low
computational capability, while the receiver (e.g., a ground
station) has more resources for signal retrieval.
The second type of sampling theorem for sequences is
somewhat similar to the derivative sampling theorems. Let
x(n) be some sequence, not necessarily bandlimited, which
we wish to transmit (or just store). Let us define the first
difference as x,(n) = x(n) - x(n - 1). Suppose, instead of
transmitting x(n) we transmit twofold decimated versions
of x(n) and xl(n). (We will soon talk about advantages of
doing this). From the received signals is it possible to get
back x(n) for all n? The answer is yes, as the reader might
have guessed. In fact, more i s true. If we are given x(n), and
the first M - 1 differences xk(n), 1 s k 5 M - 1, we can
transmit the M-fold decimated versions of these M
sequences, and eventually reconstruct x(n) at the receiver.
Moreover, such reconstruction can be done perfectly with
FIR filters. These filters, in addition, are multiplierless!
VAIDYANATHAN: MULl IRAlt DIGITAL FILTERS
This result can be derived by recognizing that the prob-
lem can be posed as a filter bank design problem (Fig. 29(a)),
where the analysis filters are Hk(z) = (1 - z - ' ) ~ ,
which cor-
responds to the difference operators. The task is to design
the synthesis filters Fk(z), 0 s k I
M 5 1 such that f(n) =
x(n - no). Even though the solution for Fk(z) is not obvious
by looking at Fig. 29(a), it becomes quite tractable once we
redraw the structure as in Fig. 29(b). The polyphase matrix
f(z) in this case turns out to be a constant lower triangular
matrix which is its own inverse [30, Lemma 3.11. With R(z)
chosen as €-'(z) for perfect reconstruction, we then have
R(z) = f(z), and the synthesis filters given by (65) are evi-
dently FIR. As an example, consider the M = 3 case, so that
Using (65), the synthesis filters turn out to be
F~(z) = 1.
For sequences of certain types, difference sampling theo-
rems offer an advantage. Consider, for example, a signal
x(n), each of whose samples is a 16-bit number. Clearly it
cannot be bandlimited (because it is quantized). But the
first difference x,(n) can be quite small (see Fig. 38 for dem-
Fig. 38. Binary register patterns for hypothetical sequence
and its first difference.
onstration), and so representable by, e.g., 8 bitdsample. If
we transmit decimated versions of x(n) and x,(n) with 16 and
8 bits per sample, then the average data rate is now 1 2 bits
per sample, which is an improvement.
B. Efficient Quantization of Filter-Coefficients Using the
Generalired Polyphase (GPP) Decomposition
In section Ill-B we saw that the subband coding tech-
niquecan be used for efficient representation of a sequence
whose spectral energy is very low in some frequency regions
compared to others. Can we apply the same trick for effi-
cient representation of thecoefficients h(n)of adigital filter?
In other words, does it make sense to do subband coding
of impulse responses? After all, the frequency response
H(eIW) in most applications does have very low energy in
some frequency bands. The anticipated advantage would
be that the average number of bits per sample of h(n) could
possibly be reduced, resulting in a more efficient imple-
mentation of H(z).
The main flaw in this kind of reasoning is that subband
coding of a sequence requires a filter-bank system. If the
price paid for the filter bank outweighs the advantage
gained from efficient representation of h(n), we are losers
in the game! As a result, the idea works only if the filter bank
turns out to be a simple low-cost device. Based on intuitive
reasonings we shall now derive an appropriate low-cost
"QMF bank" that can be used for such applications.
To fix ideas, let H(z) be a narrow-band low-pass deci-
mation filter. It is well known , [ I 7 then that the adjacent
samples of the impulse response h(n) are highly correlated,
i.e., h(n) - h(n - 1) is typically very small compared to the
average [h(n) + h(n - 1)]/2. Our aim i s to exploit this. Let
us represent H(z) in terms of its type-I polyphase form (7).
After moving the decimators (assumed to be two fold for
simplic'ity) using the appropriate noble identity, the struc-
ture is as in Fig. 15(b). Suppose now that we insert a matrix
rand its inverse in Fig. 15(b), to obtain Fig. 39(a). Evidently,
this does not affect x(n) at all! As an example let T = [A -;I,
so that T-' = There. Noting that
[E,(z) E,MI
r = [E,(z) E,(z) - E,(Z)I
we can redraw Fig. 39(a) as in Fig. 39(b). The coefficients of
Eo(z) - El(z) are composed of the first difference of h(n),
which are expected to be very small.
Fig. 39. New type of polyphase decomposition for filter-
coding applications. (a) implementation based on insertion
of matrix Tand its inverse in Fig. I5(b). (b) Redrawing using
equations (80) and (81).
Comparing the two equivalent structures (Fig. 15(b) ver-
sus Fig. 39(b))forthedecimationfilter,weseethat both have
the advantage offered by the polyphase representation,
namely computation at the lower rate. The additional
advantage offered by Fig. 39(b) is that the lower branch con-
tains Eo(z) - El(z) (rather than E,(z)), which can be repre-
sented with much fewer bits than E0(z).
Now we come to generalizations. Suppose we represent
H(z) in the M-component type-I polyphase form (IO). We
can now insert an M x M nonsingular matrix T and its
inverse as in Fig. 40(a). This gives us the new representation
of Fig. 40(b), where
[cO(z) Gl(z) ' . GM-l(Z)I = [E&)
El(z) ' ' ' EM-l(z)I T
Fig. 40. Generalized polyphase (GPP) decomposition. (a)
Implementation using an M x M nonsingular matrix Tand
its inverse. (b) Redrawing using equations (82) and (83).
For example let M = 3 and let
r = o -I -2 .
Note again that T - l = There. We can then simplify Fig. 40
to Fig. 41. In this example the difference E0(z) - E&)
Fig. 41. Generalized polyphase implementation of deci-
mation filter with M = 3.
has coefficients requiring fewer bits than Eo(z). The same is
true with the second difference Eo(z) - 2E1(z) + E2(z), and
These specific examples are such that the columns of T
correspond to the coefficients of the difference operators
(1 - z - l ) k . This is the reason for the appearance of the dif-
ferences Eo(z) - E&),
Eo(z) - 2E1(z) + E2(z), etc. in Fig. 41.
In general, if the M x M matrix T has columns chosen as
in the preceding, we have T-' = T (the proof follows by
using Lemma 3.1 in ).
There are M branches in Fig. 40. In general, for narrow-
band H(z) with Tchosen as in the preceding, the branches
have decreasing importance as k grows. Thus the coeffi-
cients of Gk(z) can be quantized to fewer and fewer bits as
k grows. Note that if we altogether discard every branch
with k > 0, we obtain the recently reported IFlR scheme
[I021 for efficient design of narrowband filters (elaborated
below). The choice of T with columns equal to the coeffi-
cients of (1 - z - ' ) ~
is not necessarily the optimal choice
from the viewpoint of obtaining the most efficient imple-
mentation of H(z), and i s used here only as a demonstration.
Further study is required to determine the optimal choice
of T for any given H(z). In any case, the representation of
Fig. 40(b) can be expressed as
H(z) = c U,(Z) Gk(ZM)
which we shall call thegeneralized polyphase (GPP) decom-
position. With U&) = z - k we obtain the type-I polyphase
representation (IO), and CJz) automatically becomes Ek(z).
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
C. The Interpolated FIR (/FIR) Approach
In recent years, a number of techniques have been pro-
posed by several authors for efficient implementation of
narrowband digital FIR filters , . The IFlR approach
i s a simple and elegant technique for such a purpose, intro-
duced by Neuvo etal. in . Consider the design of a nar-
rowband linear-phase FIR low-pass filter with desired
response as in Fig. 42(a). The transition bandwidth (U, - up)
Fig. 42. Illustrating IFlR approach for narrow-band FIR
design. (a) Low-pass filter with desired response. (b)Twofold
stretched response. (c) Replacing each delay with two delays.
(d) Removing unwanted passband by use of low-pass filter
is also narrow so that the required order is very high [Iq.
As an example, let the passband ripple 61 and stopband rip-
ple ti2 be equal. Let the stopband attenuation A, (defined
as -20 logl06,) be equal to 40 dB, with up = 0 . 1 6 ~ and W ,
= 0.24~. An equiripple design H(z) then requires an order
of 52 (see [16, page 801). Instead of designing the filter to
meet the response of Fig. 42(a) directly, suppose we design
a linear-phase FIR filter G(z) to meet the twofold stretched
response in Fig. 42(b). Now the transition band is two times
wider (but the peak ripples in the passband and stopband
are unaltered), so that the required order is 26. If we now
replace each delay in the implementation of G(z) with two
delays, the response is as in Fig. 42(c). In other words, we
have the desired passband and an unwanted passband. The
unwanted passband can be removed by a low-pass filter I(z)
with response as in Fig. 42(d). Notice that the transition band
of I(z) is verywide so that I(z) is of very low order. The overall
transfer function is now H,(z) = G(z2)I(z) and can be used
in place of the direct design H(z).
This indirect design approach is called the lFlR (inter-
polated FIR) approach for reasons described in . The
filter G(z) is called the model filter, and I(z) the “interpo-
lator’’ (because I(z) interpolates the impulse response of
G(z2) ). The order of the IFlR design G(z2)/(z)
is clearly
higher than the direct design H(z) (due to the extra order
contributed by /(z)). However, the computational com-
plexity is lower. Taking the impulse response symmetry into
account, the directly designed filter H(z) for the preceding
specifications requires 27 multipliers. The filter G(z) (and
hence G(z2)) requiresonly 14 multipliers. So the IFlRdesign
requires about half as many multipliers (because I(z) can be
made practically multiplierless; see , ). If we now
assume that H(z) is a factor-of-two decimation filter, then
a direct design of H(z) would require 27/2 = 14 MPUs (after
usingthe polyphasetrickof Fig. 15),whereasthe IFlRdesign
would requireaboutl4I2 = 7MPUsplusthesmalloverhead
of implementing /(z). More generally, assume the low-pass
specification of Fig. 42(a) to be such that us << TIM, so that
its output can be decimated by M without causing aliasing.
Let K be the order of a direct design H(z). The specification
can now be stretched M-fold for designing the model filter
G(z), so that the order of G(z) in the IFlR design is KIM. The
IFlR design is therefore H,(z) = G(zM)I(z), where I(z) now
eliminates M - 1 unwanted passbands in G(zM). Assuming
again that the overhead cost of I(z) is small, we see that the
MPU count is approximately as follows: K MPUs for H(z)
without decimation; KIM MPUs for H(z) followed by deci-
mation; and only KIM’ MPUs for H,(z) followed by deci-
mation (see Fig. 43). In practice, all these numbers can be
divided by two because of linear-phase symmetry.
Fig. 43. Implementation of decimation filter using lFlR
Combining these discussions with those in section IX-B,
it is clear that, structurally, the IFlR scheme can also be
obtained by using the GPP approach (simply retain the top
branch in Fig.40(b)sothatthesystem isequivalenttoadeci-
mation filter Go(zM)U0(z)).
The reader is encouraged to see
[4, Ch. 5]for multistagedecimation filter design techniques,
which are related to the preceding idea, and which are per-
haps the earliest reported techniques for efficient narrow-
band filter design.
D. FIR Filters with Adjustable Multilevel Response, and
Tunable FIR Filters
In section V we discussed zero-phase FIR Mth band fil-
ters, and mentioned a few applications. In this section we
shall discuss one more application. This is in the design of
multilevel digital filters. Such a filter has several passbands
with each passband response typically at a different level
&, as shown in Fig. 44. In practice it is also desirable to adjust
the levels & independently by tuning a single parameter
for each band, without having to redesign the entire filter.
In short, we are looking for a “programmable” feature in
the filter implementation.
All of this can be easily accomplished based on the poly-
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
phase components of a standard low-pass zero-phase Mth
band "prototype" filter H ( z ) with frequency response as in
Fig. 45(a). Consider the new transfer function
G(z) = c PfJ-RzWk)
which is a weighted sum of the responses in Fig. 45(b). In
the regions where the responses of H(zWk) do not overlap,
Fig. 45. Pertaining to multilevel filter design based on Mth
band (or Nyquist) filters. (a) Prototype filter H(z). (b)
Responses. (c) Example of real positive monotone.
the levels are determined entirely by the &, assuming that
the stopband response of H(z) is small enough to be
neglected. In the regions of overlap in Fig. 45(b), the
response is more complicated. Consider, for example, the
region around w = TIM. We can assume that only H(z) and
H(zW) are significant here. From (22) (with c = 1 IM), we see
H(zWk) = 1 for all z so that we have
H(z) + H(zW) = 1,
for w around s/M.
Now consider G(z) around U = TIM. We have, assuming
thatthepkare much largerthan the stopband rippleof H(z),
G(e"? = PoH(z) + PIH(zW) = Po[H(z) + H(zW)]
+ (01 - Po)H(zW)
which simplifies, in view of (87), to
G(e9 = PO + (P1 - Po)H(zW).
The main pointwewish to make is that G(e/") in (89) is mono-
tone in thetransition region. In otherwords, itchangesfrom
Po to P1 without any "bumps" (Fig. 45(c)), because H(zW) is
a real positive monotone function in the region of overlap.
Summarizing, G(e'") is a filter with multiple pass bands,
with Pk denoting the kth passband level and, moreover, the
transition between passbands is monotone. This conclu-
sion is a consequence of the Mth band property of H(z). By
combiningtheexpression (86)with (21),wecan simplifyG(z)
C(z) = bTW+e(z)
where P = [POP1 .
Z-(M-l)E M - l (zM)IT, and W is the usual M x M DFT matrix.
This gives a polyphase implementation of the multiband
e(z) = [1/M z-'El(zM)
Fig. 46. Polyphase implementation of adjustable
level filter. Here& represents "response level" in kth
filter G(z), whose passband levels Pk are adjustable merely
by tuning the multipliers Pk. See Fig. 46.
Design Example: Fig. 47(a) shows the frequency response
of a fifth-band (M = 5) prototype filter H(z) with length N
= 59, designed using the Kaiser window approach (Section
V-A). Note that the responses in this figure are plotted for
0 s w 5 2s. The stopband attenuation of H(z) is about 75
dB. Fig. 47(b) shows two examples of multilevel responses.
The levels used are (0.4, 1.0, 0.7, 0.1, 0.9) and (1.0, 0.5, 0.0,
0.7, 0.7), respectively. In the latter example, two adjacent
levels are permitted to be equal (=0.7), and the transition
band between them cannot be seen.This is because, H(zW3)
and H(zW4) add up to aconstant very nicely in the transition
band, due to the fifth-band property. This feature can be
used to obtain multilevel filters with unequal bandwidths,
simply by choosing M to be sufficiently larger than the num-
ber of levels and appropriately combining adjacent bands.
Adjustable Cutoff FIR Filters: A second outcome of this
idea is the generation of low-pass filters (and bandpass if
desired), of adjustable cutoff. For example, if we choose Po
= P1 = fiM-l = 1 and the remaining 0's to be zero, then C(z)
is a real-coefficient FIR low-pass filter with cutoff 3sIM. In
this way, the cutoff frequency can be "tuned" in discrete
jumps. By increasing M, the discrete nature of the tuning
can be made sufficiently close to "continuous tuning" in
E. Adaptive Filtering in Subbands
Adaptive filters and their applications in signal process-
ing such as equalization, echo cancellation, etc. are well
known - . An important issue in the implemen-
tation of adaptive filters is the rate at which the filter coef-
ficients converge to a solution. This rate in turn depends
on the statistical properties of the input signal. To make
discussions easy, let the signal be wide sense stationarywith
power spectrum S(W). Let sM and s, represent the maximum
and minimum values of S(W) and let r = sM/s,. Clearly 1 5
W. As a rule of thumb, we can say that the convergence
is slow for large r .
The use of band-splitting in adaptive filters was sug-
gested first in . It should be noted that frequency-
domain adaptation algorithms [IO7 are special cases of this
idea. The idea of decimating in each subband before adap-
tation i s treated in . If the bandsplitting filterswere ideal
bandpass filters, then the ratio r for each subband will be
smaller than that for the original signal. This leads to faster
convergence in each subband. It should be remembered,
however, that in practice the filters H&) are not ideal and
there is aliasing in each subband due to decimation. The
effect of this on the ratio r in each subband requires further
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
N O R W A L I Z E O F R E O U E N C Y
N O R W A L I Z E D f R E Q U E N C Y
Fig. 47. Design example for adjustable multilevel FIR filters. (a) Response of prototype
fifth band filter of length 59. (b) Two examples of multilevel design, obtained using poly-
phase network of Fig. 46.
X. MULTIRATE
PROCESSING
OF MULTIDIMENSIONAL
form Vn, where Vis a fixed nonsingular matrix of real num-
Multidimensional signals [I091 arefunctionsof more than
one variable. These are denoted by notations such as x(n,,
, nM) and abbreviated as x(n). (We also abbreviate
two-dimensional as “2D” and multidimensional as “MD.”)
It is necessary to manipulate and process such signals in
applications such as video, and in radar and sonar signal
processing. In this section we shall be content with point-
ing out the existing literature on multirate multidimen-
sional signal processing.
The concept of sampling a two- (or higher) dimensional
signal proves to be more trickythan in the one-dimensional
case. This is because the sampling geometry can be rect-
angular or nonrectangular. One of the earliest references
bers and n is a vector of integers. The matrix V is said to
generate the lattice. A discrete-parameter M D signal x(n)
can be obtained from a continuous-parameter M D signal
x,(f) by defining x(n) = x,(Vn). In other words, x,(f) has been
sampled at the locations of the lattice generated by V. For
this reason, Vis called the sampling matrix. The number of
samples per unit area which results from this sampling is
equal to the reciprocal of the determinant of V. Notice that
a diagonal V corresponds to rectangular sampling.
The reciprocal lattice is a lattice generated by the matrix
V-‘and plays a key role in sampling theory. Basically, if
X,(Q) and X(o) are the multidimensional Fourier transforms
of x,(f) and x(n), respectively, then they are related by
on the generalized sampling of multidimensional signals
X(W) = - c Xa[V-T(o - 27rk)l
i s the work by Petersen and Middleton [IIO], where the
number theoretic concepts of lattices and reciprocal lat-
tices were used to describe the sampling and aliasing pro-
cesses. A lattice is basically a collection of vectors of the
where L is equal to the determinant of V. This summation
extends over all integer vectors k. If a bandlimited M D sig-
VAIDYANATHAN: MULTIRATE DIGITAL FILTERS
nal has to be sampled without causing aliasing, we can do
this by appropriate choice of Vso as to ensure that no two
terms in the preceding summation overlap for any W .
Digital processing of sampled multidimensional signals
is discussed in - . An excellent overview on the
sampling of multidimensional signals, including a review
of lattices, can be found in .
The minimum sampling density required to avoid alias-
ingdependson the shapeof the basic reciprocal latticecell.
By careful choiceof V,wecan minimize thisdensity. In par-
ticular, notice that a diagonal V(i.e., rectangular sampling)
does not necessarily lead to minimum density. This, in fact,
is the motivation for the introduction of generalized non-
rectangular sampling. For example, if X,(Q) is restricted to
a circular region of support, then a particular choice of V,
known as the “hexagonal sampling matrix,” is known to
result in smaller sampling density .
The generalized multidimensional decimator takes an
input signal x(n) and produces the output y(n) = x(Dn),
where D is a M x M nonsingular matrix of integers. Several
standard multirate topics, such as the design of decimation
and interpolation filters, design of filter-banks, and mul-
tistage decimator design techniques, have been recently
extended to the MD case by several authors. For the case
of separable systems, an interesting scheme to obtain per-
fect reconstruction with IIR filters (based on all-pass build-
ing blocks as in section VI) is reported in . Reference
[I161 extends the perfect reconstruction results of to the
2D rectangular decimation case. References (1171 and [I181
deal with some of these extensions for the case of gener-
alized (nonrectangular) decimators and interpolators.
Extension of the concept of polyphase representation to the
(nonrectangular) MD case can be obtained by using the
ideas of “cosets of lattices” . In fact, it is shown in [I181
that the perfect reconstruction techniques for maximally
decimated analysislsynthesis systems reported in can
begeneralized totheMDcasesimply by making useof such
a generalized multidimensional polyphase decomposition.
XI. OPEN PROBLEMS
AND CONCLUDING
Even though the multirate filter bank area has reached
a certain level of maturity, there do remain certain open
questions and research problems of considerable interest.
First, consider the FIR two-channel perfect reconstruc-
tion system based on the Smith Barnwell approach. As we
saw in section VI-B, the design issue is to find a spectral
factor Ho(z) of a zero-phase FIR half-band filter. Once Ho(z)
is found, the remaining filters are completely known
(through the relations (56) and (58)). There are two ways to
design Ho(z). The first is to find a zero-phase half-band filter
H(z) of appropriate specifications and then find a spectral
factor of H(z) by a zero-finding approach or by cepstral
methods . The second procedure is to use the fact that
the lattice of Fig. 28 automatically gives rise to H,(z) and
H,(z) with appropriate properties as elaborated in section
VI-C. The difficulty with the first approach i s that if A, is the
desired stopband attenuation of Hfl(z), then H(z) has to have
an attenuation of 2A,dB. For large A,, it is therefore difficult
(and numerically inaccurate) to do the factorization. The
second approach overcomes this problem because no
spectral factorization is involved. However, it has the dis-
advantage of requiring long computer time for optimiza-
tion of the lattice coefficients (and for this reason, a number
of tables of filter-coefficients are published in so that
the designer does not have to do the optimization), even
though perfect reconstruction is structurally guaranteed.
The problem of efficient design of Ho(z) (so that it takesonly
about as much time as a standard single-rate equiripple
design [I191 of comparable order) is still open. Stated in a
completely different way (section VI-C), we wish to design
a good low-pass filter Ho(z) such that its two polyphase com-
ponents are power complementary. What is the most effi-
cient way to do this?
The second problem has to do with the all-pass breakup
described in section VI-A. The conditions under which an
IIR filter Ho(z) can be expressed as a sum of two all-pass
functions is well known , ; and digital Butterworth,
Chebyshev, and Elliptic filters happen to satisfy this con-
dition. Such transfer functions are useful in the design of
two-channel QMF banks. For the M-band case, it would be
necessary to express a transfer function as sum of Mall-pass
functions (this also enables us to obtain a uniform DFT
bank). Even though such designs have appeared in the lit-
erature , the problem of finding a set of necessary and
sufficient conditions on H&z) (analogous to [42, page 35311,
that will permit such all-pass decomposition is open.
In section VI1 we saw that the pseudo-circulant property
of P(z) is necessary and sufficient for alias-cancellation in
QMF banks. Diagonal matrices of the form P,(z)/are clearly
special cases of pseudo-circulants. However, all examples
of alias-free QMF banks reported in the literature have P(z)
= Po(z)/ (or minor permutations of it), which i s not a nec-
essary condition. If we relax this condition, does it result
in more efficient designs? Assuming that this is so, what is
a systematic procedure to arrive at such designs? These are
unresolved questions.
In section VI we saw that in order to design FIR perfect
reconstruction QMF banks, it is really only necessary to
force the determinant of €(z) to be a delay. This was done
byforcing€(z) to be lossless, primarily because losslessness
is easier to force structurally, giving rise to useful design
techniques (and, moreover, the synthesis filters are thereby
guaranteed to have the same length as analysis filters, as
seen from (74)). If we give up the lossless condition and keep
€(z) as general as possible (subject of course to the deter-
minant condition), then we can get more general (perhaps
more efficient) designs. In the two-channel case, for exam-
ple, in order to get FIR perfect reconstruction QMF banks
with good analysis filters which are at the same time linear-
phase, it is necessary to give up losslessness .
An obvious way to force the determinant of €(z) to be a
delay is to express €(z) as
€(z) = RKAK(z)RK-~AK-~(z)
. . R,Al(z)Ro
where R, are M x M constant nonsingular matrices and
A,(z) are M x M diagonal matrices with delay elements on
the diagonals. Note that (60)-(62) represent a special case
of this with M = 2. Now the preceding product form does
not cover every possible M x M €(z) whose determinant is
a delay. Here is the open problem: find a structure (or a
mathematical expression) such that it represents every pos-
sible €(z) of agiven degreewith determinant equal to a delay,
and which does not represent any €(z) whose determinant
is not a delay. If such a structure can be found, its param-
eters can then be optimized on a computer to obtain good
PROCEEDINGS OF THE IEEE, VOL. 78, NO. 1, JANUARY 1990
analysis filters as done in section VIII. Even though this
problem has not been formulated or solved to this degree
of generality, special cases of this can be found in and
[87l (to obtain linear-phase FIR PR QMF banks) and in 
(for obtaining special nonconstant passband magnitude
responses for analysis filters in FIR PR QMF banks). One
approach towards a generalized solution is the following
observation: an M x M polynomial matrix E(z) in the vari-
able z-l has determinant equal to a delay if and only if it
can be expressed in the form
F(z) = U(z)A(z)V(z)
where A(z) is a diagonal matrix of delays (with nondecreas-
ing powers as we go down the diagonal) and U(z) and V(z)
are polynomial matrices in z-l with determinants equal to
nonzero constants (in other words, U(z) and V(z) are "uni-
modular" matrices )). This observation follows from
the Smith-McMillan form of decomposition for polynomial
matrices [120, Ch. 61, [121, Ch. 61. The preceding problem
then reducesessentiallytooneof characterizing causal uni-
modular matrices: one seeks to develop a structure whose
multiplier parameters span all unimodular matrices; and
converselyevery transfer matrix generated by the structure
is required to be causal and unimodular. Certain general
factorization theorems such as those in [I221 may give a
starting point for this problem.
Fig. 48 helps to visualize the FIR perfect reconstruction
family. The largest set in this Venn diagram is the set of all
ALL FIR E (1)
Fig. 48. Venn diagram, summarizing families of FIR QMF
banks for perfect reconstruction.
FIR analysis banks. We then have the subset for which the
determinant of E(z) is a minimum-phase polynomial so that
a stable synthesis bank (not necessarily FIR) for perfect
reconstruction exists. The next subset is such that det E(z)
is actually a delay so that an FIR synthesis bank for perfect
reconstruction exists. The synthesis filters can, however, be
longer than the analysis filters. The fourth subset is such
that F(z) can be expressed as in (91) (which obviously guar-
antees that the determinant is a delay). The synthesis filters
for perfect reconstruction, in principle, can again be longer
than the analysis filters. The last and the smallest subset is
such that E(z) is lossless. In this case the synthesis filters
have the same length as the analysis filters, and moreover
are given by the closed form formula (74). The advantage
of subset #5 is that it gives rise to lattice structures, which
in turn lead to simple design procedures for the analysis
filters, ensuring that the filter-responses are nicely
bounded. Thedisadvantage is that, in thetwo-channel case,
losslessness is not compatible with the linear-phase
requirement of analysis filters (unless they are trivial, as in
(37)). In 1671, losslessness has been relaxed to obtain linear-
phase two-channel QMF banks with perfect reconstruc-
tion. There are two cases considered at length in [67. These
belong to subsets #4 and #3, respectively.
Another open area in multirate DSP is the design of QMF
banks with nonuniform decimation ratio. This means that
the decimators in Fig. 29(a) are not all equal to M but depend
on the subband. For example, let nk represent the deci-
mation ratio for the kth subband with 0 I
k 5 M - 1 (the
passband widths of the filters are, of course, accordingly
adjusted to be nonuniform). These integers should clearly
satisfy Clink = 1, to preserve the average number of sam-
ples per unittime. Examplesof such systems have beengen-
erated inthe past bycombiningsmallerQMF bankmodules
in some way (such as in a tree structure ). Some of the
unresolved issues in the more general case are how to
obtain alias cancellation (and, for the more ambitious
designer, perfect reconstruction) with FIR filters. What are
the necessary and sufficient conditions for these, and how
can these be forced structurally? Does losslessness still have
a role? Some progress in this direction has been reported
Finally, there has been some progress in the design of
two-dimensional filter banks, as mentioned in section X.
However, systematic procedures for obtaining completely
general lattice structures for lossless polyphase matrices
are yet to be developed, due to lack of neat factorization
theorems in the general case. Factorization theorems for
restricted special cases can be found in . Finally, the 2D
versions of practically all the I D open problems are open
NOMENCLATURE
All-pass complementary.
Analog to digital.
Adaptive delta pulse code modulation.
Aliasing distortion.
Amplitude distortion.
Adaptive pulse code modulation.
Additions per unit time.
Digital to analog.
Doubly complementary.
Discrete Fourier transform.
Digital signal processing.
Euclidean complementary.
Frequency division multiplexing.
Finite-length impulse response.
Generalized polyphase.
Inverse discrete Fourier transform.
Interpolated finite-duration impulse response.
Infinite-duration impulse response.
Lossless bounded real.
Lapped orthogonal transform.
Linear periodically time-varying.
Linear time-invariant.
Linear ti me-varyi ng.
Multidimensional.
Mean opinion score.
Mu I ti pl icat ions per u n i t-ti me.
Power complementary.
Phase distortion.
Perfect reconstruction.
Quadrature mirror filter.
Time-domain multiplexing.
Two-dimensional.
VAIDYANATHAN: MULTIRATE DIGITAL FlLTERS
Analysis filters.
Synthesis filters.
Type-I polyphase component matrix for anal-
ysis bank.
Type-2 polyphase component matrix for syn-
thesis bank.
Equals R(z)E(z).
Overall transfer function (or distortion func-
Number of channels in analysiskynthesis fil-
Equals e-’2n’M; subscript M often omitted.
Frequency variable (radls) for continuous-time
Frequency variable (rad) for discrete-time sig-
tion) of alias-free QMF bank.
Normalized frequency.
CONDITION FOR EQUIVALENCE OF FIGS. 6(a) AND 6(b)
By applying the relations (3a), (3b) to Figs. 6(a) and 6(b) we
Y1(Z) = kso
X(zLlMWkL)
Y2(z) = - c X(zL/MWk).
The summations (A.l) and (A.2) are identical except for the
powers of W appearing in each. The right sides of (A.l) and
(A.2) are identical if and only if the collection of M numbers
k 5 M - 1 is equal to the collection Wk, 0 5 k
We know that there are precisely M possible values for
W” when n runs through the set 0 I n I M - 1. Since W k
# W” for 0 5 k < n I
M - 1, all the M distinct values of
the powers of Ware present in the set Wk, 0 I
1. The expression (A.1) is therefore identical to (A.2) if and
only if WkL # WnL for any k, n such that 0 I
- 1 (i.e., if and only if (k - n)L # pM for an integer p). This
in turn is true if and only if M and L are relatively prime (Le.,
do not share a common factor greater than unity).
APPENDIX B
RELATION BETWEEN
Mth BAND FILTERS AND POWER-
COMPLEMENTARY
Let H(z) be any transfer function expressed in Type-I
polyphase form (IO). Define
H(ZW-“) = c Z-kWknEk(ZM)
for0 5 n 5 M - 1, where W = e-i2T/M.
This set of M transfer
functions can be represented in vector form as
where W is the M x M DFT matrix [A, . Since W is unitary,
it is (trivially) paraunitary(sectionV1-C). If the set[E,(z), El (z),
. . . , EM-,(z)] is power complementary (i.e., if the column
vector [E~(Z),
E,(z), . , E M - l ( Z ) ] ’ i s paraunitary), then the
M X 1 matrix on the LHS of (A.4) is paraunitary (because it
is a product of paraunitary matrices). This, in turn, means
that the set Hk(z),
k I M - 1 is power complementary.
In other words, if we define G(z) g f i ( z ) H ( z ) , then G(z) sat-
isfies Cy=-; G ( z W - ~ )
= constant, so that it is an Mth band
Conversely, assuming that C(z) is an Mth band filter, we
can prove that the set of polyphase components [Eo(z),
. . . , &-l(.z)] is power complementary simply by inverting
the two M x M matrices in (A.4) and carrying out a similar
argument as in the preceding.
ACKNOWLEDGMENT
I would like to thank Dr. R. E. Crochiere of the AT&T Bell
Labs for his encouragement in the preparation of this arti-
cle. It is a privilege to acknowledge the useful discussions
I have had with Dr. M. Bellanger of TRT, France, Prof. M.
Vetterli of Columbia University, Profs. Smith and Barnwell
of Georgia Institute of Technology, and Prof. T. Ramstad of
the Norwegian InstituteofTechnology.Also, theinput from
reviewers resulted in useful improvements of this paper.
Finally, the valuable “multirate interaction” I have had with
my graduate students during the last few years is gratefully
acknowledged. In particular, Zinnur Doganata’s interac-
tions on lossless systems, Vincent Liu’s interactions on
nonuniform sampling and on 2D systems, and Truong
Nguyen’s interactions on symmetric and linear-phase QMF
banks have been particularly beneficial.