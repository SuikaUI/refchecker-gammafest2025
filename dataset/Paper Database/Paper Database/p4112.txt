"Trace Inference,
Curvature Consistency,
Curve Detection
Pierre Parent
B. Sc. Economiques. (Université de Montréal). 1975
Department of Electrical Engineering-
McGiII University
A thesis submitted to the Faculty of Graduate Studies and Research
in partial fulfillment of the requirements for the degree of
Master of Engineering
~eptember 1986
@ Pierre Parent
Permission has been granted
to the National
Libr~ry of .
Canada to microfilm this
thesis and to lend or sell
copïes of the film.
The author (copyright owner)
r e s e r v e d
pul:)lication rights,
n~ither the
extensive extracts from it
may be printed 'Or oth~i:wise
reproduced
~ithout ~his/her
wri tten permission.
L'autorisation a été accordée
la Bibliothèque nationale
microfilmer
cet te thèse et ,de prêter ~ ou
de vendre des exemplaires du
L'auteur (titulaire du droit
d' auteur) ,se
autres droits, de publication;
e x t r a.i 't s
de\: e Il e - c i
au-trement reproduits sans" son
autorisation écrite.
0-3l5~8171-X
Thls thesis describes a n.ovel approach to curve infer~nce in digital images bâsed
on curvature information . It divides the inference procedure into two stages: a trace
inference stage. and a curve synthesis stage. Only the trace inference stage is addressed
in this thesis. the curve synth~sis stage being the second part of a two-part research
effort. It is shown that recovery of the tra~e of a curve requires that the tangent and
curvature information be recovered at the same time. These make it possible to specify
powerful constraints between estimated ta'ngcmts to a curve (in terms of a neighbourhood
reJationship called co-circularity), and between curvature estimates (in terms of a curyature
consistency relatipn). Because -ail curve information is quantized. special care must be
taken to obtain accurate estimates of trace- ~oints. tangents and curvatures. This issue
is addressed by the introduction of a smootnness constraint and a maximum curvature
constraint. The procedure is applied to two types of images: (i) artificial images designed
to evaluat,e curvature sensitivity and noise sensitivity. and (i;) natural images.
Cette thèse décrit une nouvelle approche basée sur la courbure au problème de
l'inférence de courbes dans les images digitales. 0 Elle ~cinde la procédure d'inférence en
dewc étapes: une étape d'inférence de trace, et une étape de synthèse de courbe. Seule
J'étape de J'inférence de trace sera traitée dans cette thèse, l'étape de synthèse de courbe
étant la seconde partie d'un travail de recherche en deux volets. Il est démontré que la
récupération de la trace d'une courbe exige que la tangentnt la courbure soient récupérées
en même temps. Ces informations permettent de spécifier des contraintes puissantes entre
les tangentes estimées à une courbe (en termes d'une relation de voisinage appelée cocircularité). et entre les courbures estimées .(en termes d'une relation de cohérence de
courbure). Puisque toutes les informations sur les courbes sont discrètes, J'estimation
'précise des points d~ la trate, des tangentes et des courbures doit se faire soigneusement.
Ce ptoblème est résol,u par l'introduction d'une contrainte de diff~rentiabilité continue et
d'une ~ontrainte de courbure maximale. La procédure es,t appliquée à d~ux typestdïmages
digitales: (i) des images ~rtificielles conçues pour évaluer la sensib~lfté à la courburè et au
bruit. et (H) des it:nages naturelles .
t :(/fk ..... '5 '"", - ----
Acknowledgem'nts
My sincerest love and gratitude go to Dina El Masri. my life companion. who
has shared\ in the many sacrifices netessary to the accompl,ishment of this resear~h. who
has provided' me with ampl~al support and encouragement during times of difficulty
and depression. and who.-js now eager. deservedly 50. to share in the profits brought upon
by the Masters' degree. High also in my esteem~ ~re those who helped put sorne shape to
illY i~~s during many stimu/ating discussions: Kamal Gupta. Peter Sander. Norah link.
Frank Ferrie. Yvan Leclerc. and Benjie Kimia (in order of office assignment). Some of the
typesetting of this thesis (the references and the bibliography) wou/d not have,been so easy
were it not for Wade Hong. whom 1 also thank for his presence.during some lunch outings.
which made the meal5 tax-/ess. if not price/ess. Many special thanks go to Michael "der
Mouse" Parker. CVaRL's very own wizard. whose computer /iteracy will a/ways amaze me.
who seemed to always have the answer to my problem. 'and to whom 1 still owe a dinner
at L~ Petité Halle (one of these days .. Mike!).
Serious work is not possible without a decent amount of Rand R. Thus. "aCknowledgements wou/d be incomplete without mentioning those who made student life ail
the more enjoyable. mainly through sports and games: Paul Freedman. Pierre Sicard. /sken der Paylan. Abdol-Rezit Mansouri. and Faycal Kahloun: or through pleasant afternoon
breaks: Maria Mastromonaco. who liked to (are quattro chiacchiere. and Mindle Levitt.
whose persistence ili\.learning TeX 1 admire.
1 sincerely thank my advisor. Steve Zucker. who. it goes without saying. was
so indispensable to the completion of this work. In particular. he managed to drill sO,me
.rigour into my scientific writing style: and ~ am grateful for this.
And finally. thank God. ifs done!
- 1 _l',G,-, l
Table of Contents'
Table of èontents
Abstract 7' •..•..•••••••••••.•••
~ \1: ....... , . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. ii
~és~mé ....................... . ~~.Jo ••••••••• ,.... • • • • • • • • • • • • • • • • • • • • • • • • •• iii
Acknowledgements .............. : ................ : ............... ,...... 1..'1 _
Table of Contents ' ................ 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . v
Ist 0 rlgures ..... : . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. VIII
lritroduction ......................... ~ .............. : ... "
Chapter 2 ,Background and motivation ................ : . . . . . . . . . . .. 4
The discrete trace of a curve. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. 4
2.2 Smoothness assumptions p~rmit trace inference ... ~ .................. .-.
2.3 Overview of differential geometry ............... '.' .. " ........... : . . . . . 7
Derivatives through curvature consistency ............... ; .- .......... "
2.5 Tangent and curvatUte fields .... .-. .................. : . . . . .. . . . . . . .. 10
2.6 Discrete representation of trace. tangent, and ~urvature .. . . . . . . . . . . . . .. 11
2:7 ' Curve inference"'3s a two-stage procedure ..•................ ". . . . . . . .. 12
Trace inference and-orientation selection. . . ..... . . . ... 14
The two steps of Stage 1 ............................ : ............ } 15
3.1.1. Step 1: Initial tangen.t estimates .................•.. : ...... :.. 16
3.1.2 Stèp 2: Interpreting the initial tangent estimates ......... '. . . . . . .. 17
Orientation, curvature, sm~othness, and position
const:raints ................. -. . . . . . . . . . . . . . . . . . . . . . . . . . . .. 18
4.1 ·Co-cirèularity ................ : ..•... t'. • • • • • • • • • • • • • • • • • • • • • • • • • • •
• 'Table of Contents ' •
4~1.1 Definition
Co-circularity in the discrete ca~ ..........
~ .................. .
Maximutt:' curvature constraint. ...................... '.' .. '" .-.. .
Co-circularity support ............................................. .
4.3 . Curvature cwses .................... , ............ , ............. .
4.4 'Consistency of curvatures ........................................ .
Smoothness constraint .....................................•......
Lateral maxima ....................................... ~ ......... .
Techniques for extracting lateral maxima ................... , .. ..
Inferring tangent fields by maximizing support ....... .
Overview of relaxation labelling .................................... .
The relaxation graph ............................................ .
E:omplete relaxation model ......... , .............. : ................. .
Normalization details ......•....... !....!-•••••• : •• .' •••••••••••••••••••
Extent of neighbourhoo~ support : ..... , .................. i •••
5.4.2 Intra-pixel lengt.h correction .... .' ....... ' ........... , ......... .
Normalization of the support function ......................... .
xperlments ........................................... .
Artificial images ................................................ .
6.~.1 Sensitivity to curvature ... , ................... .-....... .-...... '
6.1.2 Sensitivit1 to noise .............. : ................. ' ........ .
Neighbourhood size a'nd smo~thness .. ' ... ,.1 • •••••••• : ••••••••••
6.2 Natural images .•..... -................. -....... ~ .... ",: ............ .
Satellite image: fogging roads in forest .. : . : ...... ,.', .~. , , ..... ~ ..
6.2.2 Angiogram ........ f ••••••• tI •• ........... ,. ••••••• , •••••••••••••
'Table of Contents
6.2.3 Fingerprint ............................. : . . . . . . . . . . . . . . . . .. 48
Chapter 7 Summary and Conclusions .... : ........... ; .......... "
Bibliography
Appendix A
....................................................... 52
Radial Projection~-4n Efficient Update R",le for
Relaxation Labelling ... ' ................................. ' .. 55
A.t Notation ............................................ ".. . . . . . . . . .. 55
A.2 Consistent labe/lings ............................................. 55
A.3 Radial ~~ctjon update ru le ............. .' ...........
~. . . . . . . . . . . . .. 57
A.3.r-'Avoiding projecti~n outside labelling spaèe ..... . . . . . . . . . . . . . . .. 58
A.3.2 Convergence properties and preservation of order
information . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. 59
A.3.3 Comparison with, previous rules ............ : . . . . . . . • . . . . . . . . .. 60
A.3.4 Summary of. radial projection method ... : ... ' . .' ................ , 61
A.4, Conclusion .............. : ......•............... ~· ... :............ 62
!";-;.;:.p --:
List of Figures
List of Figures
2.1 . Various curves and corresponding discreté traces (shaded areas). (a)
'distinct,planar curves may.sharè a common discrete trace. (b) 'a
small orientation change is. undiscernible. (c) a corner and a bend of
high curvature have identica~ traces. (d) two orientation changes in
clos~ proximity and a smooth beAd--have s:mi;àf discrete traces ............
Three curves fitted to a given discrète trace:ll( a) positional constraint
only. one fit among a large family of curves with a broad spectrum of
behaviour: (b) po~n' and orientation constraint: the family of
curves is more constrained: (c) positioh. orrentation and curvature
constraints combined with a smoothness criterion. the family of
solutions is reduced to a single cur •. Observe that the curve in (c)
satisfies the orientation (tangent) constraint and that both curves (c)
'and (b) satisfy th~ position al constraint (a). But ·the curve in (a)
does not satisfy the tangent (b) or curvature (c) constfaints ..............
(a) Tangent T is the limit of segment PA as A approaches P along
C. (b) The curvature x: of C at P is,the limit of the ratio a/IABI as
A and B appr9ach P independenily along C .. (c) The~osculating
drcle 0 at P is the limit of the drcle that/Passes ~hrough A. P ~nd
B as A and B approach P independently along C. The osculating
drcle in (c) is a substantially better local approximation than the
tangent in (a) ................. ~ ...................................
The initial convolutions are performed with this "Iine det~cto'" ,
operator. which is ~ diffêrencè of three GauS\ians in the x direction:
multiplied by a single Gaussian in the y diret:tion ...... :. . . . . . . . . . .. . ..
ln (a). unit tangents A and B are both tangent to the sa me circle.
therefore A. is co-circular to.B (denoted A x B). This condji;~n is
seometric-al!y' eqiJiv~lent to that depicted in (b). where ct = -p. .........
~,,t~._', '
List of Figures
Two unit tangents À a.nd >'" with respective orientations 0>.., 8>.,
whose positio~~ are ;es~ricted to the~ drcle of radius 1/2 centered at
the pixel positions (Xt'Y1)' (xJ,Yj): the lin~ with oritntation 8tJ .
joining the centers of the pixels: the Ij'ne with orientation Ot joining
the tangents. . ........ ~ ................. ,' ... ' ...................... "
The interval for -the orientation 8t of the lin joining two curve
tangents located in drdes of radius 1/2 cent red at (XilYt) and
(X"YJ) is (Dij a,D~J + a). where DiJ is the
r~~-ntation of the line
Joining the centers of·the drcles. and a depen s on the distance D
separating them. The sine of a is 1/2 divided y the distance from 0
to (x" yd. which is Df2. hence a = arcsin(l/ ). ..................... 21
The interior angle function r(,(3,"Y) is the interi r angle between a
pair of lines with orientations f3 and '1: The si n of this function is
determined by the direction in ~ruch the first Ir e must rotate in
order to close the interior angle. .................................... 22
CQ-circul,arity coefficient Cii(..\'..\') as a function of orientation 0),1 of
neighbC!uring tangent. The length of the interval (Om1n,6max) is
E+2a.(see Condition 4.5) ............... : .......................... 23, _.-
4.6' A diamèter 15 neighbourhood (a)G partitioned into 7 curvature classes _
for the vertical orientation (b) -11)). (a) bears some resemblance to
'the consistency operators for curve enhancement developed in
[Hedlund. Granlund and Knutsson. 1982)" ...•.... . . . . . . . . . . . . . . . . . . .. 25
ln (a). 'A ~ B and A' and B are tange~t to th~ same curve. In (b)
however. the spatial configuration of A and B is the sa me as in (a).
b,,~ they are tangent to distinct çurvés. ,~ ............. : . . . . . . . . . . . . . .. 26
ln (a). A x B but 'the ëstimated' curvature at B is inconsistent with
the interpretation of a CUf've through A and B. In (b) h'Owever.
mutual support is possible because the curvatures are consistent. ........ 27
List df Figures
An equi-Iength neighbourhood for the vertical orientat~m with 7
curvature classes. Ali arcs of circle vertically tangent ta' the center of
the neighbourHood have the same length. Pm\n (= l/ICma:r) is the
minimum radius of curvature. which limits the extent of ,the
neighbourhood according ta the maximum curvature constraint. . . . . . . . . .. 3S
Trace inference process on concentric circles after 2 iterations. The
resulting tangent field (short segments) and curvature field (arrows
painting to ~er of curvature) are superimposed on the image (filled
pixels). The. assigned tangent and curvature fields are perfect
everywhere except at a few locations were quan'tization affects the
local structure of the curve more severely. These errors would
disappear u~ing a larger neighbourhood size. . ... : . . . . . . . . . . . . . . . . . . . .. 40
6.~ Trace inference on an image consisting of a single curve. using two
neighbourhood sizes. and with the addition of various amoûnts of
noise. to obtain S / N ratios of 00. 1.8. 0.9 on this page and ratios
0.6 and 0.45 on the following page. After tw~rations. only those
tangents with certainties ab ove 0~5 are displayed. The smaller
neighbourhood size results in fairly stable inference dôwn to
S / N = 0.9 .. " while the larger neighbourhood size remâins quite stable
for S / N d~WObo 0.45. where,..t~urve is nearly i!JlPerceptible at
close range. . . . . . . . . . . . . . . . . . . . .. . ......... ':: • , . . . . . . . . . . . . . . . . .. 42
6.2 (continued)
Noise sensitivity exper; ent for S / N =' 0.6 and
• _ ........ '-'! '.......- , .... t ••• tt •• .......•.................. , .... ,43
Li~t of Figures
A comparison of different methods for detecting curves: (a)
intensities thresholded to include most of the curve points. resulting
in ma'ny non-curve points being selected: (b) thresholded lateral
maxima. eq\Jivalent to the oth iteration of t~trace inference process;
again. only a low threshold allows ail curve-~ints to be selected. at ,
the cost of including sorne non-curve points; (c) previous Parent and
Zucker method. based on compaflson of expected versus observed
operator responses; this method 15 not ~urvature-based. and .depends
only on the immediate 3 by 3 neighbourhood for support. hence the
noise sensitivity; (d) trace inference process. same as pr~viôus Figure
for neighbourhood size 25 and .S / N = 0.45. It clearly iIIustrates the
advantage of using curvature information. ............................ 44
Effect of varying neighbourhood size on the smoothness of the
inferred trace of a curve. The image is a single curve. essentially
straight but with a gaussian-like bump., Three neighbourhood sizes
are used. going from the smallest in (a} to the largest in (c). In (a).
the diamete~ of the neighbourhood is 15. and the bump is weil
represented in the resul~. its curvature being within the maximum
curvature constraint. In (b). the diameter is 25. and already the bump
is smoother than in (a). Fina,lIy. in (c). where the diameter of the
neighbourhood is 45. the curvature field inferred is straight
everywhere. and there is only a slight lateral displacement of the
trace where the bump is ................................ " .......... ,4ô
(a) a satellite image of a forest with logging roads. and (h) the.result
of 2 iterations of the trace inference process. using a neighbourhood
size of 25. a step size of 1.0. and displayed at a confidence threshord
,.. of 0.6. The curvature vectors ar omitted for the sake of clarity .......... "
List of Figures
6.6 (a) an angiogram. qr radiograph of blood vessels in the brain. and (b)
the resu~fter 2 i~erations of the trace inference process. using a
neighbourhood size of 15. a step size of 1.0. and displayed at a
confidence threshold of 0.5. . . . . . . . . . . . . . . . . . . . . . . .. ............... 48
6.7 (a) the image of a'fingerprint. and (b)'-rhe result after 2 iterations of
the-trace inference process. using a neighbourhood .:;ize of 11., a step
size of 1.0. and displayed' at a confidence threshold -* only O.~. due
to the extremely low contrast of the original image. . . . .. . ..... '_',
For the case of anode with two labels: an updated labelling
assignment is obtained by scaling ~ + ~ to satisfy the constraint
Pt ·1 = 1. .. ..................... . .......................... ,
When the yector sum P~ + ~ lies outside the positive quadrant. the
vector gk is first projected onto the boundary of the positive
quadrant (S;k). Thus. pf + S;k is guaranteed to lie in the positive
quadrànt. S!k is obtained from sic by subtracting its most negative
component from ail its components ........ : ... ' .............. ~ . . . . .. 59
If the constraint Il Pi Il = 1 is substituted for the ,usual la~elling
cànstraint. the Hummel an~ Zucker framework converges to the
. same labelling as with the radial ,projection rule. assuming that ail
components of ~ are nàh-negative. . . . . . . . . . . . . .
~ . . . . . . . . . . . . . , . . . . 61
Introduction
Curves arise from the projection of various .kinds of structure in the visu al world.
such as occluding contours of objects. curvature extrema in s~rfaces. and discontinuities
in surface coverings and lighting. But curves are not directly observable in images: rather.
curves are abstract entities (mappings) and images consist only of intensities. Ali that is
observable in images is.information about the trace of curves. or information about the set
of image locations through which the (projected) curve passes. The curve must then be
inferred from this. inform~tiôn. In this thesis we formulate such an inference process in
terms of traces. tangents. and curvatures. and develop c~nsistency relationsf1ips "6etween
The formation of images of curves is a forward problem. and is well-posed. The
inverse problem-the inference of curves from images-is not. how~ver. since information
is lost during the imaging process. Additional constrai~ts must be founèl. and we seek
them through an analysis of the discrete nature of the problem~. We show. in -particular.
how discretized versions of standard notions from differential geometry lead naturally to
smoothness constr~ints. and how quantization leads to minimization as a method for using
these constraints.
Our approach differs from others in two fundamental ways. first. the standard
approach to inferring curves assumes that the trace points are known. In spline inter- .
polation. for example •. a collection of points is given. and polynomial values are sought
Introduction
between them [Pavlidls. 1982]. In our formulation. however. the tractt-points must also be~ determined. If images were purely bmary. with dark points correspondirig to ,trace points.
and with adjacent traëe points on the curve adjacent in the image. then trace mference
would be straightforward! But images contain structure other than the ra.w traces. so
that a preliminary problem-the inference (or sep~ration) -"t'the trace from other 'n:!!Ke
structure-must be solved as weil. We therefore separate the curve inference .process into
two distinct stages. the first in which local information (such as the trace) is determined.
and the second in which the global curve is inferred.
Other attempts at curve inference lumped the problem of inferring the trace of
the curve together with the problem of inferrin~ the.curv,e. However. this mixes local and
global information together. and makes it difficult to take advantage of interactions between
them. Martellï' . Energy considerations then lead to elegant minimizations
of second-order functional~. However. it is not at ail clear that such physicaf assumptions
should motivate the trace inference process. We begin with standard notions in differentiaf
geometry. and discretize them onto quantized grids. This feads to an anaJagous formulation. but suggests that we include one more derivative than is normally assumed. Rat.her
than minirnizing a functional through curvature . we (impficitly) obtain
" a functional through curvature variation. This additional derivative appears necessary for
focalizing discontinuiiies. The minimization is accomplished usfng standard relaxation labelling techniques. and this formulation substantially ~utperforms earlier. more' heuristic
attempts .
This thesis is the first part of a two-part research effort. In this thesis we
develop the inferenc~ of th~ (discrete) trace. tangent. and curvatu"rè fields. Given 'these
fields. tn the second part of the effort [Kimja and Zucker. in preparation] it is shown hovi
to find integral curves through them. i.e .. how to actually infer the global curves and their
discontinuities. We begin.ln this thesis. by motivating the constraints. and end with several .
real examples that iIIustrate the robustness of the approach.
Backgroimd and motivation
Two different kinds of information are lost during the curve imaging process: (1)
information about the third diménsion. through projection: and (2) 'detatls about small-scale '
variations. becau~e of sampling. The latte~-quimtization noise-introduces significant
uncertainty in position al information and réduces the image to a finite set. Consideration
of the details of the q'uantization. and how they affect the discr'etization of concepts -From
difTetentia' 'geometry. forms the backbone of our approach.
The discrete trace of a curve
The, entir~ effect of the imaging process can be f9rmalized as foflows. Let the
curve B bé a map~ing y: 1 _'E3. fr9m an ini~rv~11 on the real Jine'to Euclidian 3-space.
is a continuous function of t. a parameter running along the cur~e. YI, Y2'and 113 are the
Euclidian coordinates of the trace of B. that is. the ,mage of the mapping. Through a
projection operator n. B ·maps to a turve C in the plane
~here the curve C is a rriapping x : 1 -+ E2. with
2.1 The discrete trace of.a curve
Figure 2.1 Various curve~ and corresponding discrete trace~ (shaded areas). • (a)
distinct planar curves may share a common discrete trace. (b) a small orientation
change is undiscernible. (c) a corner and a bend of high curvature have identical
trace~. (d). two orientation changes in clo~e proximity and a smooth bend have
similar discrete traces.
b~ing a cont;n~ous function of the ,parameter t. Finall~.1 a sampling operatoi E-takes the
~race of,C. which is t~e set {(Xl(t),X~(t)) 1 tEl}. into a disçrete trace on a squa're
sampling lattiée with integer coordinates
trace C--tT.
T is a distrete trace.othat is a set, of points with integer coordinates. The sàmpling fùnction
is given by
Observe that t is a Jn~ny-to-one mapping. which maps ail the' point~ of the curve inside
a unit square of the sampling grid to the center point of the square." Therefore. both the
projection operatQr n and the sampling operator I: are non-invertibl,e. Many distinct space
curves-in fact an infinity of them. and some non-curves too-c~n giv~ rise to identical
projectionS: likewise. distinct plan,:,r projections ma1 have indistinguishablè discrete traces.
~s depicted in figure 2.1.
Smoothn,ess a~sumptlons permit trace inference
Smoothness assumptions ,permit trace inference
While the for.ward proble"ms of. obtaining a planar projection C from a space
cune B .. and obtaining a discrete tracè T from the pl,anar projection ~re weU-posed. neither
'of the corresponding inverse problems are. Additional constraints' ~ne requirèd to limit
t'le'. family of solutions. In 'the case of the inverse projection problem. constraints about
physical object~ may com,e into play [Barrow and Tenenbau~ 1981. Witkin 1981). while
only general-purpose co~straints. or. constraints that must hold over large classes of images.
·are available t~ invert the sampling process. From this point on. we shall ~onsider only
the projected curve C.' Sinc~ small-scale details are primarily what is lost by sampling ..
it is natural to impose a certain order of smoothness on the projected curve (except atd~scàntinuitie~) giving ,rise to a given discrete. trace. an~othing more.
The trace inference 'problem is further exacerbated by the fact that. In general.
. the trace 'of a curve is not directly observable in the image in\which it is encoded. The trace
itse/flmust be inferred From the image intensities. We contend that the trace 'nference prob-
, lem is closely Iinked to the sampling inversion problem. since the smoothness assumptions
-about thè planar curve mqst influence the trace inference process. Thus it will be shown
thàt it is not sufficient to infer only the trace of a curve. but th~t tangent and curvature
fields must be inferred as weil. Again. we formulate these disdretely. The tangent and
curvature fields embody the smoothness assumptions. and act as further constraints on
the inverse sampling ptoblem .. Thus. the tangent and curvatur,e esti~aies ~ovi~e a local
':moder of the curve in a neighbourhood around the putative trace point.
TQ iHustrate the different orders of constraint. Figure' 2.2 depicts a discreiè
trace to which continuous curves have been fitted .. Given points in the discrete trace (a).
a discrete orientation constraint (through the discret~ .tangent ~eld) is added in (b). and
then the combined orientation a-nd curvature constraints, (through the discrete tangent an~
curvature fields) are i~ (c); Observe that the curves in (c) and (11) satisfy the positional'
constraint in (a): that is. they ail pass through t~e indicated positions. Similarly. the
2 3 Overview of dif!erentlal geometry
. " Figure 2,2
Three curves fitted to' a given discrete trace: (a) positional constraint
only. one fit among.a large family of curverwith a broad spectrum of behaviour:
(b) position and orientation ·constraint. "the family of curves is more constrained:
(c) positioll. orientation and curvature constraints combined with a smoothness
crlterion.' the family of solutions is reduced to a single turve
Observe that. the
curve, in (c) satisfies the orientation (tangent) tOJlstraint and that both curves (c)
and (b) satisfy the positional constraint (a), But the c:urve in (a) does not satisfy
the tangent (b) or curvature (c) tonstraints
curves in (b) and (c) satisfy ·the tangent constraint ln (b)~ but not (a)., Finally.,only
c~rve (c) satisfies a curv~ture constraint (depicted as, short ~rcs of osculating cirdes ;n
(<:)). and 'it is also the smQo,thest curve satisfying these combined 'constraints., Thus.
a,~d~ional (smoothnes5) c?nstraint5 J;mit the space of possible curves: what ;5 r:equired
for oU,r problem is to provide sufficient constraÎnts, so t~at there is a unique'lcurve which
5atisfies them. The problem 15 then well-posed. We now start to' concentrate on the
trace inference problem. and, begin our search for constraints with a review of differential
geo';'etry: Morè global smoothness const,~ints limiting the full space' of 'possible curves \,
will. of ~urse. infl\;l~ce the analysis. These will al50 be discussed in appropriate places. '
Overview of differential geometry
, Jt;5 useJul to review a few elementary notJ~ns 'of differential"geometry [do.
Carmo. 1976] to establish the context in which the smoothness constraints will be for-
mulated. The reviéw will ,be centered on curves in the plélne. although géneralization's to
higher.· dimensional curves IXÏst .
Overyiew of differe~tial geometry
Let 1 be an interval in one-dirytensional Euclidian space E~. A curve C is defined '
as a c~ntinuous mappj~g x : 1 -+ E2 from the interval to the plane. where
where tEl i.s a parameter running along the curve. and Zt. X2 a're continuous functions of
t. TheJ~.urve is said to have order of continuity k. denoted Ck• if ail derivatives up to ahd
încluding the kth derivative of xl and x2 are continuous. Ta'king the first derivative with
respec,t to .ve~YWhere along C. we obtain the' tangen~s
X/(t) = (xHt),x~(t)),'
; where the vectors X/(t) have bases. at (Xl(t),X2(t)). Their magnitudes can be int~rpreted
as the velocity of a particle following the curve. A curve may be reparameterized ln terms of -
its arc lengt~ s. equ;valent tQ a particle traveling at constant' unit velo~ity along thé curve.
ln this case:--the tangent vectors are unit)ength vectors.
where oS = I(t} is a reparameterization of th,e curve. and /lx'll == 1.
The interesting aspect of th~ tangent' is its o~ie~tation. Jhe geom~tric Jnter-
pretation of the tangent to a cur've is depicted il1 ,Figure 2.3 (a). Letting P bé a point on
a curve. and .('i a neighbouring point. the tangent T at.,E is the limit of the line AP as A
approaches P along the curve. The tangent yields the ~rientation of "a curve at a point.
Taking the sec{)n~ derivative with respect to oS everywh~re along ,C, we obt~in
. x"($) = (X1(8)'~X~(S));
where thè vector x"(s) is normal to the'vector xl(s) .. an~ the, ~agnitud~ of x"(s) is cailed
thê curvature of C. Curvature is' a measure'of the ra~e of change of orientation p~er ùn;t ~rc
length. The geometric interprétation for thé curvature is, dépicteCl in ,Figure 2.3 (b).
P be a p~ on a c~rve. T th~,.tangent at tha~' po;~t. a~d A-a neighbouring p~;n~ on, the' ,
Derivative~, through curvatu!e consistency
Figure 2.3 (a) Tangent T is the limit of segment'PA as A a'pproaches P along C,
(b) The curvatùre K. 'Of C at Pis the limit of the ratio ojjABI ifS A and B approach
P independently along C. (c) The osculating drdé 0 at Pis tfle Umit of·the drcle
tha~ passés throu'gh A. P and B.,as A and B approach P i{ldependently along C
The osculatlng drcle in (c) is a substantially better local approxjmation than the
tangent in (a),
curve. Let 0: denote the angle between the Une AP and T. The'curvature It at P is the
lim;t. of the ratio a(IABI as A approaches P along the curve. Related to this interpretation
. of curvatur!! is the o$culating drcle. Re(erring to Figurè 2.3 (cJ, let A, P and B be three
.neighbouring.points on a curve: and let 0 be a drcle through th~se poi,nts. As A and B
independently approach P aldog the curve. 'the drcle 0 converges towards a IÎmit. whose
rad,iys .is precîsely t.he inverse of the eurvature It at P .
2.4 . Derivàtives throùgh curvature consistency
Alth0':Jgh third and higher order derivatives can be. defined for curves. practicaJ
considerations dictate that the process must stop somewhere. Our position is that the
t;ace. t~nge),{ and curvature fie!ds provide the JocaJ basis for inferring glob~1 curves. an~ "
~re neces'sary, for placing dis,cont,inuities. corn~s, or breakpoints. Qualitatively for' people.,
Înteresting events along curves c-onsist only of abrupt changes of orientation and curvature.
1.local .:naxima of curvatùre. a~d inflection points (i.e. zero crdssings of curvature) [Attneave.
1959:... HofTman and Richards. 1986: Koend~rink and van D~orn. 1982: Fischler. 1983).
These are the places that a, huma" o~server ;s most likely to choose to segment fong
curves into shorter ones..' Higher arder dis,continuities s~cb ,as discont",uities' in curvature
variation do Mt seem to matter. Between the ~elected corner points. curves simply appellr '
to be smooth.
Tangent and curvalure fleld$
Alth6ugh this argument for limiting the number of derivatives considered 15
informai and based on human perception. any machine vision system will have to coniront (
~his ISSlre as weil. While any namber of derivatives can be d~fined. only a finite (and .. in
' . ) fact. small) number oLthem can actually be computed. Evolution. presumably. has settled
upon an optimal number.
ln terms of ditTerential geometry. then. the visual system would appear to perceive curves as being piecewise-Coo. w~th' segmentation occuring .at discontinuities in the
flrst and second derivatives of the curves. Iri the sequel. we shall show that curvature
co'nsistençy-a ~ece~ry ~ela~ionship between discrete estimates of curvature alo~g a
smooth ~urve--amounts to a bound on the third derivative. i.e. on the curvature variation. Higher aider discontinuities ar~ smoothed over and ignored.
, There is a numerical reason for limiting the an~lysis to curvature variation ,as
weil. Quantization can be modeled as the addition of. "noise" 
of an arc-Iéngth parameter '8. However ~e
this is primarily the abject we, are after: and
not given.. it is necessary to forn:tulate sorne of our alg~rithms extrinsically in tetms of the
Euclidian spacé in which the curves are embedded. Consider a retinotopic restriction of
th~ ,ptâne E2 to finlte .extent D ,~ E2. We shall be in'terested in 2 vector fields on D.
one which is a mappi~g that associates a' tangent vectoi ~/(8) ta each point in D. and the
2.6 Discrete representation of trace. l.~ent. ~nd curvature
other which associates a curvature x" (8). We refer to these fields as tangent and curvatur~
fields. respectively. The fields form the basis of our representation fo~urves. Thus. those
points in the trace of a curve will have unit tan~ents with associated curvatures mapped.
to .ttIem. ~hile othe!s will have nul! tangents and curvatures.
Discretè representation of trace, tangent, an~ curvature
Sinc~ our problem begins in the discrete domain. we choose a representation
for curves based on their traces. with associated tangent fields and curvature fields. These
latter fields are represented discretely as weil. to reflect the fact that cürve inference consists
of a two-stage proces~. In this first step. the goal is to estimate the trace. tangent. and
curvature fjelds finely enough so that discontinuities can be placed. but ..coarsely enough
50, that overwhelmingly restrictive assumptions are not made. The compromise solution.
then. is with discrete tangent and curvature fields. which serve as inequality bounds on
which ·the next. global stage can be based.
The di,scre~e trace of ~ cur~e consists of a set of points in the discrete plane.
,The discrete 'tangent field is fQrmed by. finding. for e~ch point of the discrete trace. the
quantized orientation of the curve as it runs through that point. It thus consists of. a set of
u'nit tangents to curves. characterized by their position and orientation. Hence. assuming
m discrete orientat'ons. and letting 'h. denote the discrete orientation of the tangent at a
partic.ular position. À = 1, ... ,m." the actual orientation 0* lies in the interval
< (J*, < 0). + ~.
The 'di$cret~ cùrvature field is similarly formed by associating to each unit tangent the
quant;zed curvature at thai point.
It ,is desirable to have 'a uniform '. representation for ail points in the discrete
pl~ne. capable. among other things. of distinguishing between trace points and non-trace
point~. If. for, example. the orientation of a curve is allowed to have one of 8 values. i.e.
(urve mference as 1 two-stage procedure
the orientation is quantized to multiples of f = 71' /8. each point of the discrete plane cou Id
be associated with a vector of 8 elements. each one a predicate true or false according
to whether or not a curve passes through that point wi~h approximately that (quantiled)
orientation. Alter,nately. the true or false p~dicates CQuid be replaced py real numbers in
the interval . where the extrem.es assert presence or absence of a curve with absolute
certainty. white intermediate values represent'Iess certain assertions. Thus. for curve points.
lhere is at least one element of the certainty vector with a value near 1. while for non-curve
points. ail elements are near O. Sorne points may have more than one near-1 value. e.g.
curve crossings. and orientation discontinUlties. The folJowing notation is used fo. the
certainty of tangent >. at position (Xl' Yl):
Pl (>.~ for i = 1, ... , n
). ~ 1, ... --;m.
assuming an Image wlth ~ pixels and m discrete orientations of tangents at each pixel.
With each orientation vector element Pl ().) is associated a single discrete measure of curvature. K,().}. It becomes part of the discrete curvatur~ field when the corresponding tangent is part of the discrete tangent field.
2.7 -Curve inference as a two-stage procedure
Sufficient background material has now been developed to specify the two stages
involved in inferring a curve.
Trace Infer,ence and Orientation Selectiol}
Taking an image as input. infer the discrete trace. tangen~. and curvature fields
subject to quantization and maximal curvature constraints.
Stage 2: Curve Synthesis
Taking the discreté tràce. tangent. and curvature fields as input. focate discontinui.ties and find integral ë~rves running through them. su~t to discontinuity
and smootbness coq:;traints.
..........,
... ... ""' ..... ~t
2 7 Curve inferenc.e as a two-stage procedure
Stage 2. curve s~nthesis. will be treated in subsequent work [Kimla and Zucker.
in preparation], We now concentrate on Stage 1.
Trace inference and orientation selection
The goal of the first stage of our curve inference proceS5 ;5 the recovery of
local information. Clearly this must include the recovery of trace points. If the curve
were known. then .trac~ points could be separated from other image structure simply b~
calculating them. But the curve is not known. so we are iorced to estimate the structure
of the curve in the neighborhood of each putative trace point. As we shall show. coarse
estimates of the tangent and curvatures provide sufficent l~al information 'about the curve.
These estimates provide a partial local modef for the curve sufFiciènt to gather' evidence
about individual trace points from their neighbours.
Two terms used abovè--Iocal and coarse-warrant further expansion. because
they are rela~ed in a fu~damental ~ay. Observe that. when searching for a book in th~
library. one first searches through broad categories before finely scanning the exact titles.
Analogously. curve recovery is facilitated by first obtaining a rough-or coarse-estimate of
its structure to guide subsequent analyses. Thé need for a local analysis follows for simila ...
reasons . .,.si!1ce few (if any) assumptions can be made a priori about the global str\,Jcture of
the curve. • Moreover. given the presence of noise from both sensors and quantization. such
a coarse. local analysis becomes necessary: imagine trying to exactly estima~e the tangent
~f a contour from an- image to thr~e decimal places without strict a priori assI;Jmptions.
such as the straightness of the' sides' of a bloC~Binford. 1981].\. Seeking,higher-order
. approximations suffers the same problems as weil.
Similar arguments tould be made in detail .about the tan,gents and curvatur~.
The two.steps of Stage' 1
If the curve were known. then these could be computed exactly. But since it is not. the~,
they must be estimated as weil. There is s~methjng of a hierarchy of information here.
with the (estimated) tangents supplying constraints on the positions of nearby (estimated)
trace points. with the (estimated) curvatures supplying constraints on the (estimated) tangents and their (estimated) locations: and. finally. with curvature consistency relationships
supplying constraints on (estimated) curvatures. We now develop these constraints in detail. based on quantizations of the differentiel geometry already described. In the end we
will have obtained an inference procedure for estimating (quantized) trace. tangent. and
curvature fields such that a particular funct/onal with terrJ:1S through curvature variation is
minimized.
The two steps of Stage 1
The Stage 1 inference procedure consists of two distinct steps. a measurement
" step and an interpretation step. The functional minimization and tangent field inference
are accomplished in the" second 'step.
Step 1: Measurement
Cew'0lution of linear operators against the image to obtain initial tangent certainty ëstimates at each position and for each (quantized) orientation.
__ ~-_ Step -2: Interpretation
S,election of a subset of the taflgents signaled in Step 1 according to the func- '
tional minimization procedure to ~è defined.
Classically, of course. the linear operators amount to "Ii ne detectors" : _
where Band C are thè normalized weights of the seè'ond and third .Gaussians.
, The c1assical rationate for. choosirig such opera tors is cleaq they are template
representations of short.' straight line segments. ' The Gaussian kernels "have the attractive
'~property'thàt they s~ooth o~er intensity 'variations alol'lg the tangent direction. but sharpen
. th~m in the orthogo~al direction [Zucke~ and Hummel. 1986]. Suçh opera tors resemble the
receptive fields of so-called simple-cells in primate visual cortex [Hubei and Wiesel. 1977).
\ a'nd hence" are al50 attractive from a biological point of view.
& _.~--~----------------
The two st~ps of ~ta,ge 1
3.1.2 Step 2: Interpreting the initial/tangent estimates
Classical treatments of cur~e detection also involve two steps. the tirst of which
is very similar to the onejust despibed. But the second-step-interprétation ofthe'operator
convolutions-ls usually much simpler than the scheme that 'we shall be' describing. Since:
the operator templates match high-contrast straight lines so weil. it is often assum~d that
,si~ply seJecting the' str~ng~st convolutions 15 suffj'ceni f~r obtaining a loc~I'representation
of the co.~tour (what we are calling a tangent field). B,ut this ;s not the ca'se fot any pattern '
other than widely spaced. straight lines. Curvature. corners. and nearby c~nto~rs ail affect
the convolutions. and ail are sufficent to invaJidate the -maximum convolution selection
strategy IZucker. 1982: 1985]. A richer model for curves is clearly n'eeded .• '
From the ditTerenttal geometry reviewed in Chapter 2. it is dear that our model
must at least include curvature. Recall that. in the neighborhood of each point. the osculat-
ing circle is a substantially better' approximation to the curve than the tangent (Fig. 2.3).
We shall la~eT argue t,hat'curvature is also a high-enough-approximatioh to separate closely
~paced curves. 50 that incorrect convolutions that cover distinct curves can be properly
interpreted. Therefore we shall foc us on curvature. and sha/J begin to derive an estimation
p~ocedure base~ on (a quantized version of) Jt. Our goal. briefly stated. is to minimize t~e
curvature variàtion at each point by maximizing circu{arity.
: Orientation, curvature',
smoothness, and position constraints
ln .this chapter. we shall tirst establish the neighbourhood circul~rjty measùre
in terms of a pairwise relation .b~tween (estimated) tangent elel1'lents. called co-circularity.
which determines an orientation constraint. Introducing the maximum curvature constraint
that arises from grid quantization is then straightforward. Secondly. it will be shoWfl
"that ~he orientation constniint is not sufficient and that interaction between neighbours
should be mediated' by ~ curvature consistency constrai,nt.· This constraint can be applied
provided local,estimates of curtature ilre available. It will be shown that these estim~tes
can be obtained by partitioning neighbourhoods into regions ca lied curvat,ure classes. 'and
that ~angent estima~es can be o.btained by propagating support through' these regions.
Çons'istency of curvature is achievec;f by comparison of the CUrvature classes. ThÎrdly. the
. ,smoothness constraint is examined in relation to the maximum curvature constraint·and
the neighbourhood size.
Fi,nallY. a lenl of constraÎnt is requir.ed to achieve the high locali~ation accuraçy
w~ich ;5 characteristic of curvilinear patterns in im~ges. This p,ositional constraint is a
, form of lateral maximul)'l selection whereby a pixel-wide region is determined to be part of
the curve: It is 'required because support for tangent elements may occur over a relatively
wide area near curves. whereas -the di$crete' trace of a' curve is ~omposed only of the set of
pixels' through whicfl the curve actually passes. This level of constraint thus imprC?ves the
accuracy of t~e trace inference. procedure.
Co-circularity
The standard approach to estimating curvature is to fit a polynomial to a collection of points. and then to d'ifTerentiate the polynomiaÎ twice [Pavlidis. 1982]. This.
however'. amplifies noise. and hençe is unusa~le il1 our quantized context. We sha" present
a d.ifferent scheme. in which the information contai n,éd in tangent estimates provides the
, basis for curvature estima tes through ~he co-circularity relationship.
Definitio'n
The ~elation of co-circularity applies to distinct tangents to a drcle (see Figure
4.1(a)): A property of this spatial configuration is that the tangents fprm angles of equaJ
magnitudë. but of opposite sign: with the line joining the points o~ange~cy (see Figure
4.1 (b)). Thus. a~straction can be made of tHe drcle. and the 'symmetty of the configuration
can be retained ~s .the characteristic of co-circularity. Note that when the radius of tbe
cjrcle hecomes infinite. we obtain a special case of co-cir'cularity: co-linearity. Co-circularity'
is therefore a function of both the' orientations and the positions ?f the tahgen.ts .
. Definition. " Two unit tangents À and À' are co-circular, denoted
ifT there exists a c;;icÎe ic; which they are both tahglnt. '.
Co-circul~r;ty is a kinçJ of symmetry re'àtion betYt'eer;l tangeAts. and bears sQme
relatio~sHip to the way' in which '[Brady and Asa~a. 19841 define a local symmetry. But our
'di$cretization and us~ of the notion differs substant~ally fro~ theirs:
. 4.1.2 'Co-circularity in ,the di.crete case
When ,position a'nd orientat~on are qu~ntized. tangent pairs are seldqm exactly
co-éitc~lar. The' slriall perturbations introd,uced 'by quantizatio~'·must:so,mehow. be taken
C~·eircUlarity
Figure 4.1
I~ (a). unit tangents A and B are bot~ tangent to the samt:' circle.
t~erefore A i's co-circular to B (denoted A x Bl This condition is geometriçally
~uival~nt to t;hat depic~ed in'(b). where Q = -8.
Fig~ré 4.2 Jw~ unit ta~gents ~ and ).1 with respective orjentati~ns 6 À' (J).' whose
, positions aré restricted to the circte of radius 1/2 centered at the pixel positions
'(z,. Yi)' (x), y]). the ~ine-with orientation fi,; joining the centers of the pixels; the,
IIne with orientation 6t joining ~he tangents.
into acçount. T 0 do this. 'we b~gin by allowing the p~sition of the tangen'ts ta be anywhere
.wi~hin the ~itéf~ of\r~Qius 1/2' pixel center~d at the pixel. Lik~wise. we le~ the;r orièntatjon
vary within·a nèighbourhood of size f. for c)rientation~ quantized ta multi~les of f. The
tang~nt .pair is thus co-circular. if the~ exists -at least on~ a~~jgnment.o~ th~ position and
orientation variables for which ce-circ arlty as defined above is Uue.
Let (Xi, Yi) and (x" Yi) be the coordinates of nodes i and j.' and let (x, y) be
,an'erbitrary point with,in the drcle ai radius 1/2 centered at (Xi:, Ys}. and ('r, y') a point in
a c'ircuiar neigh~ourhood 'of (x" 1Ii): let À and À' be unit t~j,gents at these locations and
IJ). and IJ).,I be their r~pectiv~ orientations: let (J be àn orienfâtion, in an f-neighbou'rhood
of (J).. and (JI an orientation in an E~neighbourho~d of IJ)./ (see Fïgur~' 4.2). The'orientation
of the Une joïning the centers of the pixels is give_n by
Bi; = arctan(Ayj Ax)
where Ax = Xi ~ Zi and A, -'Yi - Yi-
. '(4.1) ,
Co·tircularity
Figu~e '.4.3
'The interval for the grientation' 8t of the line jointng two u~it tangents
~ and )'/Iocat,ed in circ/es-of radius 1/2 cèn,tered at (zid1i) and'(~jlYj) is (8 .. j ":
Q,Oij+Q), whefF Bij is th,e orienta~ion of the line joining the centers of the"cirçles.
and â depe,nds orr the dislance di] separàting them. The sine of Q ;s 1/2 dlvided
by the distance from 0 to (z,'YÛi wlfi~h,.is dij/2. hence Q = atcsin(1/dtJ).
We wish to ,determ;ne the minimum and maximum values 'that may be taken
by Btl the orientation of the line joining the tang'enfs as (x; y) and (,cl, y') are allowed to
vary within their ~ircu~~r neighbourhoods. As il)' Figure 4.3. th~ e~trema coincide with thè '
two intersecting tangents comman to the circular neighbourhoods, ln the case of: drdes
of e~ual radii, it can be shown that the angle between the,comman tangent and the line .
jointng their cen,ters is given by'
Q = arcsin(ljd,j)
Let' the function r (P, "y) dèsignatè the interlor angle b~tween a pair of lines with •
ori~l'Jtations ,s,·and 'Y. as in Figure 4,4. let the sign .of t~is fun~tion be the same~ a~ the
é djrection in which the first line must rot~te in ~der to close the interiQr angle and coin~ide
,: with the second. that is. po~itive for. counterclockwise and negative for clQckwise rotations:
The formai aefinition of this function. assuming that ~ S {3 < 'Tr and 0 :5 'Y < 'Tr. is. th~
if h .... ftl ~ ,;::
ifl<'Y-~~1lï
jf -'Tr ,< ."1 - {3 < -J. '
Turning back to Figure 4.2 ind recalling the geometrical definition of co-circu- -
, larity. we .find that the tangents at-Czi,Yi) and (xj,lIj)"âre co-circular if the interior angle
Figure 4-.4
The inte~i<?r angle functiofl r(.8,"'I) is the interio~ angle between a pair
of lines with orientations /3 and "'r The sigl1 oJ this Junction is -determined by the
, direction- in which ~he first li ne must rotate in order to close the interior angle,
bétwee,n the first tangent ,and the,line.jOining the tange~ts"is the,same as·that betwe~n the
latter Irne and the second tangent. Formally'.
. for s0":1e (Jt E ,(O,,) - ex, (Jij+ a). (J ,E (8).. --2-, q>: +. 7)' (JI ~
((J,\I -,., (J)..I + 2 j. This condition
tS clearly equivalent to
').x).' iff.lr((J,x,(JI·.1)-r(9(1,6J..,)I<E,+,2a.
-Condition (4,~) Îsa discrete co-tirèularity. con,dition: it is either trùe or false.
A continuous version of this -Condition can be imp'ler:nented by measuring the closeness
ta c~cjrcularjty. and we refer to' t'hjs m~a~ù;e ,as Cl- c~circularity coéfficient. Depart",re
from ~xact co-circul~rity oçèurs by rotatio~ ~f. one', of .the tan,ents. ~hich suggests t~at a
funcfi~n of the difference in orientation bet~ee~'a tangent and' the èo-circuJar tangent in the
.. sa me position èould be used as a n1easure, Qf co-circularity. \ The Co-cifcularity coeffiéient
. . . . . .
t,hen consists of a real number between 0 and 1. where 0' means not co-cîrcular. 1 means
co-circular. and values clo~e to 1 are interpreted as nèarly'c9-circular. .
Generally. the'cOéfficient is.1 for a certain range Qf orient~tÎons of tangents·at
the-neighbo'uring node. because of buift-in qùantization noise tolerance in" (4.5).-Denote
' - this range by [(J~'h (Jmaz) • . We le~ the magnitude of the.coefficient fatl C?ff monotonically
outside this rahg~ (~ee Figure 4.5).
4.1 Co-,circularity
Figure _4.5 Co-circularity coefficient cti(.\' -,\'l as a fun,tion of orientation fi).1 ,of
nelgtibouring tangent, The length of the interval f6mm,Oma:] is 'E + 2a (see
Conditton 4.5).
rh us the co-circufarity coeffjcie~ts ct.j(À, À'{are given by
(À ~') _ {l,
if 1 r(8).,8,,) r(~-;;-U,\,)I < E+ 2a:
max(l - '118).1 - Oml ,Cmm), otherwise.
where. 8~ is ~he extreme of t~e range -(8~tn, Orna:] cJos~st to 0,\/. and" js)he absolute
, value of the ~Iop,e of the drop-off region: assuming a linear decrease ..
Because of the grid and tangent quantization. it is necessary to consider tan-
-, gentt distributed in a neighbourhood around each image point. If only the 3 by 3 îmmediate
neighbours wére <:ônsider~d. then-the angular quimtization of 0" would be much to~ severe.
The co-circul~rity" coe~cient so defined can be me~sured for ail neighbouring tangents in
~. ~eighb~urhood of ~ given size. and the set of ,th~se measures fo;ms t~e neighbour:hood
support set.
Maximum ,curvature constraint
.In order t6 introduce the maximùm curvatûre constraint (recaU Fig. 2.1(c)). a
measure of the radius of curvature implied by a pair of tangents is required", Létting Pii(À)
denote the implied radius! )Ve use
, Pi; P') = 2 sin 1 ;i:.\"8.; Il
as its measure. The maximu,m curv.ature co'nstraint implies th~t
4.2 Co-circularlty support
Figure 4-.6(a) shows the set of neighbours co-circûlàr to a tangent with a vertical orientation
for a neighbourhood diameter of 15 with the maximum curvature constraint applied.
Co-circula rit y SUppofl--
We are now in a position to estim~te how weil 'a particular (estimated) tangent
is supported by other (estimated) tangents in its neighbourhood, Recall that the first
measurement st~ge consisted in convolutions against "Iine detectors" (Seçtion 3.1). Lettin~
8 À denote the orientation of the operator at node i with coordinates (Xi, Yt). for ). ==
1, ... ,m. the normalized convolutions {Pt (>.), i = 1, ... ; n, >. =' 1, ... ,ni}, 0 ~ ,Pt (..\) ~ 1.
provide an initial estimate of the confid~nce in ta~gent >. at node (. Note. for a long
straight line of orientation 8).* passing th~ough i. that Pt{>'*) will be maxima1 at that
posÎtion. and that pd..\) will drop off from Pi(>'*) according to the orientation tuning curve
for the operator.
,But wh en the ,curve -does not consist of lon~ straight lines. Pt P) can Jollow
a . more complex distribution at eacn node i. Therefore. the circularity measure must be
evaluated over a local neighbourhood around i and must dépend on the entire distribution of
possible tangents at each point. We take a linear weighted sum to indicate the co-circularity.
supp.ort for a unit tangent >. at po~ition i:
,sd..\) = L L 't.1{>.,>")P1{>")
i=l, ).'=1
where r iJ (>', ..\') = Ci] (..\;"\'). the co-circularity coefficient. Clearly those tangents Iyi"g
along a curve should have maximal support.
More re"lain5 to be (fone beforf:! this i5
guaranteed. however. because /ine~r averaging schemes 5uch as this have the potential to
smooth across different but ne3(by (within the given neighbourhood) cdrves.
4.3 'Curvature classes
Consider a smalt neighbourhood of an image containing many curves. Within
this neighbourhood. many tangent pairs are' mutually co-circular. with _ sorne co-circular
4.3 Curvature classes
,,\ \ l , ,.. J'
........... \ 14 , l''''
--, \, ,,. .... -
''''--\1;'''-''''
""' .... - .... '1\---... '
:::~~~:~~~: 1
........ " \\\.
\ " .... -
Figure 4.6 A diameter '15 neighbourhood (a). partitioned into 7 curvature classes
for the vertical orientation (b) - (h). (a) bears some resemblance to the consistency
opera tors for curve enhancement developed În IHedlund. Granlund and Knutsson.
pai~s belonging in fact _to distin.ct curves. More specifically. given three tangents A. Band
C in such a neighbourhood and given that A ::=::: B and A ~ C. it does not follow necessarily
that B xe." ln partic~lar. the interpr~tation of A remains ambiguous when B f:. C: does
Aoelong tp the curve going through A and B. -or to the Q.ne through A and C? Oné way to
decide the situation is to partttion the neighbollrhood support set about A into sufficiently
narrow curvature classes Kk(A). le = 1, ... , K as in Figure 4.~(b)-(h).
Eaçh curvature dass consists of ail the osculating cirdes whose, radius is between the limits for that cJass or. equivalently. whose curvature is within certain limits.
~ Thus.,'if A ::=:: B. A x C. and B. C belong to the same cu.rvature class Kk{A} with respect
to A. it may be concluded that B x' C.
, T~o benefits acgue from the use of paf1:itioning.
O imposes n-wise
consistency .of tangents within curvature'classes at a low cast in complexity. The tange,!!
supp~~_func~ion can be modified to take advantage of'the partition. by measuring support
il1aependently by curvature class. and by selècting the highest as the final tangent support.
4 4 Consistency of curvltures
Figure 4.7 ln (a). A x Band . ....NInd B are tangent to the same curve. In lb)
however. the spatial configuration of A and B 15 the same as ln (a). but they are
tangent to distinct curves.
The suppor:t of tangent .\ at node z· is thus given by
8,(.\)= ~ax L 2:T~,(.\,'\')P1(.\')'
k-l,K 1=1 ~/=1
where the 'Coefficient r~i~' ,\') is the product of the co-circuJarity coefficient c'] P, '\') and
a partitioning function
Kk.(.\ .\') = {l, if P~un < Pl](.\) ~ P~a%:
otherwise:
for given. curvature cJas's limits P~m and P~a%'
The second benefit is that a discrete e~
ft,('\) is obtained by
correspondenC( w,ith the curvature c1as~ tha~âximizes the support function. With this
estimate. it is be ,possible to introduce a further constraint on the selection of neighbouring
tangents for local.' su~port. This constraint is examined in the next Section.
Fi~st note .
however. that these discrete curvature estimates have been obtained without the numerical
problems inherent in stanlard. spline-fltting t~chniques.
4 .. 4 ConsistenC!of curvatures
One kind of ambiguity persists even after partitioning into cunrciture classes.
C0t:lside~ ~or example Figures 4.7(a) and (b).,
ln Figure 4.7(a). tangents A and B are co-circular and they are ta.,ent 10
the same curve. In Figure 4.7(b) however. tangents A and B accur in the sa,,(e spatial
4.4 Consistency of curvatures
Figure 4.8
In'(a). A ::::: B but the estimated ,curvature at B 15 inconsistent with
the interpretation of a curve through A and B ln (b) however. mutuaLsupport is
possible because the curvatllres are consist<lnt
configuration as in (a). yet they are tangent to distinct curves. Should the tangents A and
B mutuaiiY support each other in (b)? If not. how can configurations (a) and (b) be told
The solution to this problem requires companson of local curvature class estimates. The orientation of a tangent and the local curvature class estimate together
.si!termine a region about the position of the tangent where a curve is most lil<ely to exist.
ln Figure 4.8. B ;::::: A. therefore B belongs to at 16ast one of the curvature cla$ses of
A. But in Figure 4.8(a),_ the local curvatu~e c1ass e~timate at B does not include A as a
member. The curvatures are s~id to be inconsÎstent ~nd' tbis 'Condition precludes 'mutual
support of A and B. Figure 4.8(b) depicts a situation' where curvatures are consistent ~ith
th~ interpretatio~ that a curve passe~ through A and B. Note that in this case we h~'ye
both A E Kk(B) and B ~. Kk,(A) for some k and k~ (not nec~ssarily eqù~,).
Letting" Ci~~' (À, À') denote the predicate variable for c~rvature consistency. i.e.
, "' . {l, if cur1atyre class k of >. at {is consistent
ctlc (À, À') =
, with e~timated curvature ,class Jç' of À' at j:
0, otherwlse:.
we obtain a new coefficiènt
which is a function of.·curvature as weil as orientation and position.
Smoothness constraint
4.5 Smoothness constraint
50 far. it has been assumed that the, tangent and curvature fields_ embodied
the smoothness constraint without explicitating its actual mechamsm. In this Section. the
smoothness constraint will be dlscussed in relation to the circularity measure. whîch is a
function of the maximum curvature constraint and the neighbourhood size.
The smoothness constraint takes on two distinct but ,related forms. First and'
foremost. it is mediated through the maximum curvature constraint. whose role is to filter
out quantization noise ictroduced by discretization of the image. The upper bound on
maximum curvature is dictated directly by the resolution.of the discrete image. As depicted
in Figure 2.1 (c). very high curvature is indistinguishable from a çorner. so the limit is at
the point where the maximum curvature leads to· a trace different from a corresponding
corner. Experiments with the trace inference procedure suggest that the minimum radius
of curvature should be in the range of 2.5 to 3.0 pixels.
The second form of smoothness constraint depends on the size of the neighbour-
-hood used to collect support for unit tangents along a Curvè. It is implicitly assumed that /
,the osculating circle is a good approximation of the neighbourQ,ood. that is. the curvature
variation is small within a given neighb,ourhood size. Thus. the greater the neighbourhood
is. the I~ss sensitive the circularity measure' ~iJJ be to small details in the eurve., and the
smoother the inferred tracé will be. For example. a regular polygon would be perceived as a
circl~ using a sufficiently large neighbourhood. Chapter 6 describes an experiment showing
the effect of varying neighbourhood size on inferred trace and tangent and curvature fields .
,Neighbourhood size and max.imum curvature are not totally independent. In'-'
general. the minimum radius of curvature scales with neighbourhood size. just as the
radius of. curvature limits of the curvature class~s (assuming a fixed number of curvature
classes). As wil~ be seen in the next chaptér. the extent of the neighbourhood is d~fined in
such a way that ail circles tangent to thé center of the neighbourhood have equal arc length
within the neighbourhood. This .is _one solution to avoiding, the proble,!, of preferenc-: for
Lateral màxima
certain curvature classes over others. Thus. the minimum radius of curvature must scale
with neighbourhood size. Another approach to the curvature preference proble~ would be
to adjust the co-circularity coefficients to offset the eff!!Cts of variable intra-ne;ghbourhood
arc lengths. Then. a la~ge neighbourhood size could be chosen while maintaihing a low
minimum radius of curvature. perhaps at the cost of increasing the number of curvature
classes to cover the extended range more effectively. This solution was not developed due
to the high complexity cost of increa"iing the number of curvature classes.
Lateral maxima
ln this Se~tion. we address t~e problem of inferring the trate of a curve from the
certainties associated with the tangent~during our procedure. The objective is to extra ct a
pixel-wide region about a curve. The method is based on comparisons between certainties.
in a 5mall neighbourhood. with selectio~of the tangents with hrghest certainty. i.e. the
lateral maxima.,
Tèchniques for extracting lateral maxima
'the rationale for lateral maximum selection is the observation that the support function exhibits a th~Jracter;stic maximum at the precise location of a curve. The
magnitude of the sup~ort function decreases gradually on either side of this location.
lateral maximum selection is, in principle. -a simple t~hniqùe .. but its impiement~tion on à discrete grid requires care!ul consideration. The most obvious problem
. is that. on an orthogonal grid. only tangents with orientation parallel to a grid axis have
-Iateral neighbours with which to compare. For other ori~ntations, ,interpolated v~lues for
lateral neighbours must be used. rather than the neighbour dosest to the ideaÎ position. A
straightforward linear interpolation based on a plane fitted to the three nearest neighbours
is quite sutficiènt. A tangent À at (x, y) is, therefore a lateral maximum if its certainty
is ma'\.imal among ail tangents in the 3' by 3 neighbourhood in position~orientatjon space.
4.6 Lateral maxima
Letting mi(À) denote the predicate variable for a later~1 maximum for <?rlent-ation ,\ at node-i. we have
,{ 1, iff Pt{À) ?>~Pl(~'). T/À' E {>. -1.~,>. f 1}. ~nd, ~
Pt(À) > pr(A'). "if À' -:: .{~ -
~. À. ~ + 1}. and'
'pt(A) > Pt{À'). '<lÀ' E {À -l,A + i}:
0', , otherwise:
where pLJA')f'arid Pr{-*') denote the certainties of the left and right. or interpolated left and
right tertainties for tangent A'.
As an alternative ta i,nterpolated certàinties. one côuld also perform a strid
comparison against a set of neighbouring certainties determined by the orientation of the
certai~ty under test. Comparison sets can be defined in such CI way that thb selection
process is stable. More formally.
iff Ptf~) > p]p.'). 'VA' E {À -l:;À,À + 1}. 'Vj E Nf:
otherwise:
where the neighbour set ~f is .a predefined set·depending o~ the local esti";'ated orientation
A ~nd estim,ted curvatur~ k.
The lateral maximum'.property of neighbouriry~ tangents can bë used as an ad-
ditionat constrain~ in the support fùnet.on. Sinee only those tangents in the neighbourhood
that are laierai maxima are compatible with a curve' interpretation (observe, that the ini-
tial convolutions drop off with tateral displacef11ent from the curve). }he support functiqn
, should be-corres~ondingly restricted. Thùs. we' obtain a new expression for the support of
a tange.ot:
Si(À) = ~ax L L T~k' p, A') p} P/) mj(À').
k-l,K ;=1..\'=1
The net effect. of this constraint is toJurther narrow the region' near eurvés where tangents
receive high support.
, . Chapter 5'
Inferring tangént' fields by maximizing support
Since the expression (4.16) for the support 'of a tangent should be maximized
at each 'position, a natural,choice for a global functional is the avetage local support
A (p) = L 8, (.\) p, ( ;\)
Qualitatively. the Pi (.\) indicate whieh tangents and positions are cho~en, and ~he &, (.~)
!ndicate how mutually consistent they are, through the quafltized geometrical constructs
just developed. That is. the si (l) codes the local model for the curvè in. the neighbourhood
of tangent ..\ àt node i. In particurâr. as the position al quantization âi -t.O. orientation
quantiza-tion 1:1~ -
O. and the c~rvature classes' approach the actual curvature, s,(l)---t- 1
fo,. ~II tangents along the. (smooth) curve, and Si(À) '--t- ,0 e1sewhere.
Relaxation labeliing is a procedure for maximizing eXpressions such .as (5.l).
[Hummel and Zucker, f983}. and in the followipg Sèction, we review the relaxation labelling
procedure and tailor it to this application.
Ove~view of relaxation 'Iabelling'
Relaxation labelling is an iterative prÔ'cedure applied over a network of nodes.
Associated witb each n'ode is a set of labels. a~d associated with each laber is a measure
~ of confidenc~. or certalnty. Let'there,be n nodes and. for the sake of simplicity,-a uniq.ue
'Ia~.t e~h nO.de,' Further. let PiCA) den~te the confide,nce ,of label ~ at node'
5 2 The relaxation graph "
1. The values of the Pl (À) are restrict~d to-the intervaIIO.I}. and are' s,ubject to t~~ added'
constraint that at each node i,
LP,(À)=l fori=l, ... ,n.
ln vect9r notation. this constraint can be written as Pl ·1 = 1. wheré 1 is the m-dim,ensional
vector 'o{ l' s (1, 1, ... , 1) . The degree of compatibil~ty bet~een a label and its neighbour- ,
hood can be measured hy what f5' known as t~e lab'el!s support. which' is a function' of
~ther laber certainties in the nerghbourhood and their cqmpatibility (pair-wise) with the
label being supported. The constraints between l;lbels 'are represented by a 'matrix of cb~patibiJities. riflA, IV). which serve to embody the p,oblem-dep~ndent knowledge. In this
notation. r'l (À, A') denotes the compatibil~ty between laber A' associated Y'ith n'ode j ?nd
'Iabel À associated with node i. We use the following expression fo/ ~h'e suppo
8 2 (>..) of
label>" at node i:
St(>"}. = L L r2i(>'" >..')p) (>../)
. )=1 A/=l
Relaxation labelling is ,the process of achieving consisteQ,cy. Hummel and Zucker'
[Hummel and Zucker'. 1983] defined ~!l~sistency in variational terms; they 'also, proved
, that. for symmetric compatibility coefficients. consiste!lt, states qf the relaxation, network'~
m~ximjzed functionals of 'the form A(p) in (5.1). S'uch 'maxi~a a~e' achieved iteratively:
beginning ~!th an il)Jtiallabelling {p?(~).}. th~ iteràtion
·pf+l(>..) = f(pf{>..): 8:(À)}
continues untiJ convergence. ' Hummel ~nd Zucker iHu~~el and iùcker. ,1983) d~v«dop a
gene,~1 ~cheme~for t~e 'iteration (5.4) utili~ing the 'Mohammed projection operC!tor.· Ho~~ver. t'he efficien~y of titis schem~ can 'be improved
~ubs~antially Jor this,application: see and Appendix A.'
5.2, The ~elaxation graph,
Th~ original appr,bàch to representing
1 i~ a relaxation 'graph use~ m: orientation; of taÎtgents to a' curve at eaèh, nodè. plus
5,2. rhe relaxation gra'ph
the no-line label. with certainties. 'sùbject to condition
L pd.\) == 1,
for i = 1, ... ,!l. c
Ac;cording to this èonventÎon.' a labelling is consistent 'and certain only if at most one
9rientation Îs chose" by t~e relaxation p,rocess. However. cürve ,intersections and corners
require that multiple orientations be chosen at c~rtain nodes.
Our 'solution is to have not one ,but many superimposed relaxation graphs. one
for 'each label>' = 1,. ~ J', m. We shall refer to t,his collection as a relaxation hyper-gra'ph.
Each node of graph >. requires ~ labels: >. and no-Iine, Interactions are permitted betwéen
the graphs through the compatibility coeffidents.
Note that the certainty vector àt each no de of each 'graph consists 'of two
co'mponents 'with unit sumo Clearly. not~irig is gained'tby representing both components
of the ~ vector explièitly. one of the cOh1ponents being sim ply the complement of 'the other.
Similar savings can' be achieved in th'e compatibililY matrix by eliminating the no-line label.
completely.
. é:o~sider ~thë Co~,tri~tltion of node 'j to the support of the t~~ lab.e~ (0 and 1 i
a~ nodef >~tting ~ti = ~,j(~, ~). ~10'-==',;;1(~' 0) .. et~ .• and p~' " ' Pj(1). ~e o~tajn, from
'si(1) :: ,r10(1 - p,) f tl1PJ
8i(Or= roo(l'- p.,') +r~lPj' \
Assuming that roo =. rU' rOI = ~10 = -ru. the above are reduced 'to
- where both expreslÏons are void of terms related to label O. Hence. for this special case.
, (,and mahY similar ones wh~e- ail compatibility coefficients are functions' of a single one).
5.3" Complete relaxatiQn model
it Îs' possible to reduce thè complexity of the relaxation graph and the compatibility matri'X,
,The assumptions about the compatibility coefficiÈmts a~e not unreasonable when label 0
,is interpreted as no-Iine. This result s~ows tha~ if certain labels 'are feft out and only
the co~patibility coèijkients between the remaining labels ar~ -specified. the sys~em Îs
equivalent to another one wh'ere ail .the' labels and compatibility coefficients are specified.
Thus. truncation of the graph and compatibility matrix doe; nof violate r~laxation labelling
theory. The result is extensible to systems of more than two labels',
Complete relaxatio," modeÎ
, To su.mmarize. a sketch of the .complete relaxation model as it wiJI be used in
the trace in~erence process is as follows:
• . Hyper~graph:
m graphs of n nodes. o~e for each orientation, The labels represent
ta'~gents with or~tions quantized to multiples o{ ~ = ~, The
~"no.line·· label is not explicitly I.rep're~ented. , The 'm labels at node i
ha,ve indepenqent certai~ties Pi (,\) (E' [0, 1). ,
Support fundiôn~, the sup'port Si (,\) of label À' at no'de i is' a normalized funetion of the
sum of the products .of neighbouring label certainties hy appropiiately
chosen compatibility coefficients. ,as in Eq. (4\16).
Update formula:
each pd.\) is ,updated as though in a two-Iabet'graph. with the other
'~bel interpreted as "no-line" and haviRg complementary suppott. i.e. '"
. -s, (,xt. P.(À)ois updated ~ such a way as to converge asymptotical/y ,
to 1 when excit~d. and to 0 when inhibited (see Appendix A).
5 4 Normalizatlon detaits ,
Figure.5.l
An equi-Iength neighbour.liood for the vertical orientation with 7 curva-
. toré clllsses, Ali arcs of, ç,ircle, vertically tangent to the center of the.,oeighbourhood
'have' the s~me length, "\~~n (= l/ltma:c) is the minimum radius, of curvàtu~e,
, which /imits the extent of the neighbourho~d according to the maximum curvature
constraint,
5.4. Normalization detilii$
Two details remain.' but' the-y are central to succe~sfll' implementations. First.
the sUÎ,port functions must be normalized to account for arc-length effects. and secondly.
they have to be mapped into a common interval 50 that values are comparable across
positions. We discuss each of these hormalizations in turn.
5.4.1 ,Extént o~ neighbourhood support
.The unit tangent support function has so. far been described in terms of coy .
circularity coefficients. but nothing has been said apout the shape or ,extent of the neighbourho~d over w,hich tangents in~eract. We ~ould àssume a circular neighbourhood ~hape.
detérmlned by. the neighbourhood diameter and the Jl)aximum curvature const.rairit. H<?w-
. eve~. this tircul'ë., shape is not ideal because arcs of different curvature have distinèt intraneighbourho.od lengths. implying a bias of the support fur:tction towards longer arcs.
ln ordèr to make the support 'of a ta,ngent to a curv~ independent of tire particular
,cur~atur~. the extent of th~ neighbourhood. is adjuste.d ~o that arés of cirdès' with ail
: curvatur~ , hav~ the sam~ intra-neighbourhood Jength .
Letting R den~te 'the maximum arc "ength distance of interaction between unit
• 5 4 Notmalization detaUs
ta~gents. the-"c,urve' descril;»ing the boundary of the eq~i,.length r.oegiôn is given by,
in 'polar coo~dinate form. Figùre' 5.1 depicts such a neighbourhood. with the minimum
,radius of curvature rmm ~ 1/ ""max constraint applied. Thé: neighbourhood of node i
is, thus composed of ail unit tangents whose estimated arc le,t'gth distance from (Xi, 11,)
:.Pif(>') =::; R. The estimated 3rc length distance can be obtained from th~ e.sti~ated radius'
"?~ curvature Plj(>') with
Letting Eaj(>') denot, the neighbourhood extent' predicate. we have
E' '(>') = {l, if Dt] (A) ~ 'R:
0, otherwise,
'!,tra-pixellength correction
Next. we con~ide,:. the 'intra-pixel Jength correction to the compatibili~y coeffi·
cients. This is necessary in ordet. to insure that the process is isotropie. A straight line
of éI' gÎven length intersects a differeM number o( pixels of a digital grid, depen~ing on its
orientation, For example. ,diagonal lines intersect fewer piXél~ than lines of the same length
at any other orien~ation. whilé the-linès paraI/el to a grid axis i~ect the most. ,U~less a
compensatiçn .is in~roduced. the process will !herefore c·"prefer" rthOgonal ~rientat~~ns to
diagonal ones. A simple normalization coefficient i~ given hy
. where w)/ is th~ angufar difTerence 'b~tweenëJ.v and the ~eàrest gri,d axis.
With" these two co,ens~tiPns. we'obtain the fin~1 expression for the ~mpat·
ibility coefficients by multiplying the expression of Equation (4.13) by E'J(>.j and 1(>.,).0
r~k'p.:>.') = ctJ(,x,>.') :E,Jt>.) Kt~(>">") ç;~k'p.,>.~) 1(>"),'
where' Cij(.\, >") is the 'co-circularity coefficient. Kt (>', >") is tHe curva~ure cfass partitioning
function. and ct'" (>', .\') is the curvature consistenoy predicate,.
____________________ __
Normalization details
5.A.~ Normafization of the sùpport fùnction
The support function obtained prevlously is
but its range must be n~rmalized before use.
For a given neigf1bourhood. radius. qne can compute the integral of ~e local
'Co~patibjJjtr coefficients given trat a single curve (assume a straigh~ Une) traverses the
'entire neighbourhood in the proper orientat!on. Denote this integral by Smax. This sum
determines the maximum support that a label can obtain trom its neighbourhood. and the
sum varÎes according, to th~ radius of the neighbourhood. This is the maximum support
th'at can be achieved.
_ The mi!1imum acceptàble support for a label depends both on geometry and
npise. First. the process should. be stable near the end of a genuine (non-noise) curve; that
is: the cur.ve should neither grow nor shrink du ring relaxation. Second. a threshold can be
. established according to the response of the initial operafl>r convotutionsin the presence
of pure noise. Now. consider the unit tangent at the end, of a low contra st li ne. The
operator response. which is sensitive to contrast. will be rather low at that point. while
the support for the tangent woutd be approximately smax/2 (the curve traverses only half
the neighbourhood). times t~e average certainty of the tangents on the curve. Assuming a
'minimùm contrast criterian. Pmsn. we fix the mini~um acceptable support of a label as
With this choice of Smin. relative stability at end-fines is insured for a wide
ra nie of initial contrasts .. If. on the other hand. the ~njtial contra~t of a curve is below the
minimum. t,hen that cUlve willgradually_ shorten until it 'disappears.
Normalizltion details
The label support is normalized by mapping the ;nterv~1 [smtn, Smax} linearly
intoJhe interval [O,lJ. The required normalized support. S,(-XJ. is therefore
St ( -X) == St (-X) - Sm, n .
smaf - Srmn
It can readily be seen that this expression is equal to 1 when t"h-e raw su.pport St (.x) equals
the màximum support. Smax. while the numerator vanishes if the raw support equals the
minimum acceptable support. Smtn. Of course. anything Jess for the raw support leads ta a
negative ~o~malized support. The normaliza~ion of the support occurs before the projectIon
of the support vector at anode onto the positive quadrant; see Appendix A.
"This completes the discuss10n of the technical issues related to the implementation of a discrete trace inference process within a relaxation labelling, computational
framework. We turn our attention now to the results of the trace inference process over
various kinds of images.
..~~~----_.-".
Experirrients
Jn discussing the experiments perfo~with _the trace inference process described in the preceding Chapters. we will go from simple to camplex. Thus. in the first
part of this Chapter. we discuss experiments based on artificial images designed to evaluate
specifie features of the process. such as sensitivity ta curvature. robustness in the presence of noise. and the effect of neighbourhood size on the smoothness of the inferred trace.
At the same time. the trace inference process is compared to ather procedures to extract
curves from images. in the presence of large amounts of noise. Further experiment$ based
on real images. such as satellite and bio-medic.al imagery. and fingerprints. are discussed
----.... iu-n the second part of.this Chapter .
Artificiaf images
Senlitivity to curvature
The first experiment is designed to evaluate sensitivity to curvature. Referring to
Figure 6.1. the im_le is composed of 4 concentric circles whose radii were chosen to match
individual curvature classes. :rhe following parameters are used for thè-initial operat~rs
(tee Eq. (3.1) for the_ para~eterized form ~f thé operatoi):
ul = 1'.14 'D2-= 1.8
CT3 = 2.28
B = 1.266 C = 0.5
Artif.cial images
nearly straight
.... low cllrvature
.. medium curvature
high curvature
Figure 6.1
Trace inference process on concentric drcles after 2 Iterations. The
resuTting tangent field (short segments) and curvature field (arrows pointing to
center of curvature) are superimposed on the image (filled pixels)
The assigned
tangent and curvature fields are perlect everywhere except at a few locations were
quantization affects the local structure of the curve more severely
These errors
would disappear using a larger neighbourhood size
A neighbourhood diameter of 15 pixels IS used. with 7 curvature classes determined by the
following radius limlts (in pixels):
radius "mlts:
2.7,4.2,7.2,21.0
The·circles have the following radii: 0
radii of circles:
3.5,6.8,15.0,23.0
The result displayed in
Igure 6.1 is after 2 iterafions. with step size 1. and using a
supporting threshold s . = 0.5. In these displays. tangents are indicated by short line
'Segments. and c
atures by vectors pointing toward the center of the osculating circ/e .
....-=_."--
The magnitude of the curvatUre vector is proportion al to the radius of curvature.
Se~sitivity to ~oise
The next ex periment is designed to evaluate the effect of noise on the trace
inference process. The image consists of a single hand-drawn curve on a uniform background. featuring a sharp orientation discontinuity and varying curvature. The experiment
Artifidal images
is performed independently for two neighbourhood sizes. lS and 2S pixels respectiveiy.oand
for each size there ar~ 5' noise levels: S / N = 00. 1.8. 0.9. 0.6. and 0.45. The noise added
to the image has unif~rm----a1strlbution U (0, A). where A is the peak-to-peak ~mplitude of
t'he noise. Given thàt the 'curve has constant intensity le over a background of constant
inten,sity lb' the SIN ratio is obta,i~ed by ,
SIN = Ile - lbl
Both experiments use 7 curvature classes. afld the radius limrts for each size
are as follows: '
size 15 radius limits:
2.7,4.2, 7.2,21.0
slze 25 radius limits:
4.5,7.0, 12.0, 35.0
T~e initial convolutions are w;th operators whose size is adjusted to the respective .neighbou[hood sizes. For the smaller neighbo~rhbod slze; the parameters are those in (6.1). an~
for the larger one. the parameters are as follows:
0'1 = 1.9 0'2,= 3.0
The results displayed in Figure 6.2 are after 2 iterations. using' à supporting thre~ho(d
, Smln = 0.5. The performance of the trace inference, process in the presence of noise is
very satisfactory: especially for the larger neighbourhood size,
To emphasize these results. a comparison between various other methods,for
sele~ting curv~s is displayed in Figure 6.3. these are based on the same curve as in Figure
6.2. at SIN = 0.45. the noisiest case.
ln (a). an optimabintensity threshold is chosen. interactivély, 50 that most of
the curve points are selected, but"this res';;'ts in too many nori-curve points being selected
,at the ~ame time. Significant additional processing would be requin!d to rem ove these noise
6.1 Artificiallmages
Neighbourhood size 15
Neighbourhood size 2S
, 'Figure 6.2 Trace infer:nce on ah Image con~isting of a single curve. using tWQ
neighbourhood sizes. and with the addition of various amounts of noise: to obtain
$/ N rat.ios ofoo. 1.8.0.9 on tbis page and ratios 0.6 and 0.45 on the following page.
After two Iterations. only those tangents with certai"ties ·above 0.5 are displayed.
The sm ailer neighbburhood size results in fairly stable illference down to S / N = 0.9.
wnile the larger neighbourhood size ~emains quite stable for S / N down to 0.45 •
. wher.e tbe-turve is nearly imperceptible at close range.
ln (~). a thresh'old is applied to th'e làt~r~ maxima based on an initia,l operat~r' .
size of .25. as for tne ,Iarg~ neighhourhood of Figure 6.2.
T~is result is in fact the ot~ ~
iteration of the trace inference process. 6 and hence resembles a proc~ss of selecting the
maximal response at each-position. Again. ta obtain ail curve points. a low threshold must
~.----~--~~-----------o
Neighbourhood sile '15
6 1 Artiflcial images
Neighbourhood sile 25
Figure 6.2 (,continued)
Noise sensitivity experiment for SIN =? 0.6 and 0.45,
be chosen'. resulting in too man y non~curve points. ,and signifieant post-processing wôuld
. b~ requj~ed.
, ln (c). the result dispfayed comes from 'an eartier attem,pt toformulate an, infer~
ence p'rocess [Zucker and ,-Parent. 1984) in which consistenèy is achieved through compari-
son of .expected versus observed operator responses. This method is corner-sensitive. and
, slightly curvature-sensitive. -and thu$. represents an' improvement over an earlier method
using only tangent informatio!l [Zucker. Hummel and Rosenfeld.1977). the result of which
is"not displayed here. The effective neighbourhood diameter for this experiment is ,3. Thus.
,this procedure has ooly 'slight curvature sensitivity. and does not have a built-in noi~e re-
mov~1 caRability for short low-contrast ~egments as in the trac~ i~ference process. It is no
surpri,se then. that ~his method also degrades rapidly in th~ presence of noise. '
. " . Finàlly. in .(dl. the result fQr the la,rgest neighbourhood at SIN = 0.45- trom
~ Figure 6.2 is reproduced. ' Compiuison with the rest of the figures clearly indicates the'
6.1. Artlhtial ",mages
...:: , ....
,--- "',--
Figure 6.3 A cOll]parison of difTerent- methods for detecting curves (a) inJenslties '
thresholded to intlude most of the curV,e points. resulting in~many non-êurve points.
bèing' selected. (b) thresholded lateral maxim~~equiVaîent to the oth iteration.of
~he trace inferen~e protess: ag~ly-cr1ôw threshold allows ail turve points to
be selected. at the cost onncluding sQme non-curve'-points: Tc) previous Parent
and 'Zucker method. based on çomparison of expected versus observed operator
responses. this method i~ not curvature-based. and depends onlyon the immediate
3 by 3 neighbourhood for support. hence the noise sensitivity .. (d) trace inference
-process. same as prevlous Figure for neighbourhood size 25 and S / N = 0.45. It
tlearly iIIustrates the advantage of using curvature information
importance of curvature information.
Neighbour.hood size and smoothness
The experiment designed to evaluate the effect of neighbourhood size on smoothness is ,perfor~ed on a 'single curve. using threé 'nejg~6ourhoo~ sizes. The curve is essen-
tialty a straight line. with a gaussian-like bump in its center being the region of interest f~r
this experiment. Three neighbourhood diameters werè used: .
size 15 radius limits:
2.7, 4.2, .7.2,21.0
_________ _
IIII .•• -------- !-------....----.,.,
6.1 Artiflciallmages
sii~ ~5 radi~s limits:
4.5, 7.0,12.0,35.0
size 45 radius limits:
8.1. 12.6, 21.ô, 63~O
a'~'d each neighbourhood size W3S mat:ched with initial convolution operators of c~rre~pond­
'tYl = 1.14
(12 == 1.8
03 == 2.28
B = 1.266 C=O.5
ul = 1.9 u2 = 3.0
tY3' =' 3.8
D'y = 6.0.
B = 1.266 C=0.5
D'y = 12.0
B = 1.266 C= 0.5
The results are displayed in Figure 6.4. The progressÎpn ~f neighbourhood si;e
is from thè smallest in (a) to the largest in (c). White the bump is fully represented in (a).
with positipn. orientation and curvature. there is only a slight variation in position' in (c).
ltnd neither orientationnor curvature variation. Thu.s. the inferred trace is smoother when.
using a huger neighbourhood.'
Note that this expeiiment is possible only becausè the macro-struct'ure of the'
curve used in this experiment is that of a straight line. hence that 'its CUrvature is within
certain limits. It is always possible to utilize large neighbourhoods when the macro-structure
.of the curves in an image have curvatures within the maximum curvature constraint implied
b~ the n~ighbourhood ~.ize (as discussed in Sec~ion 4.5) .. and it may be interestlng to d~
50. as in multiple-.level processing. However. if the image consists of curves with IOhg high-
. curvature segments. the effect of utilizing 3' larger neighbourhood. or of imposing ~ smaller '.
maximum curvature constraint. would be to filter out the higher curvature compon~nts
of the curves. This happens because the ·tangent support along these segments re!"ains
smaU for any given cUlYatur~c1ass. because the curves will tend to traverse many curvilture
~cI~sses ,within ~uc:h a large neighbourhood.
, Figure 6.4 Effeef of varying neighbourhood size on the smoothness of the inferred
trace of a curve. The image is'a single eurve. essentially stralght but wlth a gausslan-
Ii~e bump. Three neighbourhood sizes are used. going fr:om the smallest ln (a) to
the .argest ln (c). In (a). the diameter of the neighbourhood is 15. and the bumPl.
is weil represented in the result. its curvature being within the maximum eurvature
,constraint. In (b). the diameter is '25. and already the bump is smoother than ln -
(a). - Fi~ally. in (e). wh~re the diameter of the neighbourhood li 45. the eurvlture
field. inferred is straight everywhere: "nd therds only a slight lateral dlsplacement
of the trace where the bump Is.
Natural images.
Figure 6.5
(a) a satellite image of a forest with logging roads. and (b) the result ~f
2 iterations of the trace inference process, using a neighbourhood size of 25. ,a step
'size of 1.0. and displayed at a confiden'çe threshold of U.6 ' The curvature v~ctors ar
omi~ted for the sake of clarity
N.tural images
The preceding 'experiments on arti~icial images ~~Q.wed that the cu~vature in-,
formatio~ helped the t-race inference process to find curves in controlled situations. The /
main interest of the procedure. however r lies in it~ applicatk>n to finding curves 'in real im':'
ages. ~uch as satellite images. :bio-medical imagès. and fingerprints. In this Section. three
experiments based on such images are described,.
Sa,t~lIite image: logging roads in, fo~est
The first riatural image experiment is based on a satellite. image of forest terrain
in which logging roads are visible as' 1ight. elongated streaks. on a slightly darker back-
'ground~ The experiment is pelfor~ed using a size ~5 nèighbourho~~. with parameters for
thé initial.con~olution and radius limits as defined in Eqs. (6.7) and (6.8) ,fo~ Size 25. The
i"f~re .... ce process is run for two iterati<?ns. with a step size of 1.0.
Natural images
Figùre ~.6 (a) an IIngiogram. or radiograph of blood vesse/s'in the bnlin.'and. (b)
the result after 2 iterations of the trace inference process. using 'a neig'hbourhood
'size of 15. a step size of 1. O. and ~isplayed at a confidence 'threshold of 0.5, '
The result displayed in Figure 6.5 is thresholded at a èonfidence level of 0.6.
Th~ second experiment takes a, bio-medical image as' !ts input. an angiogra~.
or a radiograph of blood vessels in the brain. It 1s a good example of an image with m~ny
·curves: ail of which have varying curvature. with many -curve crossings at various angle$.
The image is first convolved with operator parameters as given in Eq.
The neighbourhood,size is 15. the number of.iterations is 2: with a step size of 1.
A'II tangents with a certainty of al Jeàst '0.5, are displayed in Figure 6.6. however
the curvature vectors are omitted for the sake of clarity .
6.2.3· Fingerprint·
Th~fi,nal experiment in volves a fingerprint j~age. The neighbourhoo~ size whic~
62 Natural images
Figure 6.7
(a) the image of a fingerprint. and (b) the result after 2 iterations'of the
; trace Inference process. using a neighbourhood size of 11. a step size of 1 O. and ,
, displayed at.iI confid~nce threshold of only 03. ,due to the extremely low contrast ,
of the original image.
, was' chose~ ... l1 plxels in diameter. is s~aller than in the other experim~nts. However. the
. inItiai convolutions w~re perf;r~~d with the sa me operator as for 'lbe angiogram experiment.
i.~. with 'parameters as in Eq. (6.1).
Âgain. 2, i'teratiqns of the process were l,Ised. The display threshold for the
tangents 1s set to 0.3. a'iow value because the image itself had low contrast.
Summary and Conclusions
Infor!,"ation about the 'exact structure of curve~ is lost when they are projected
into quantiled imagès. Hence curve detection is an inferential process. utilizing both image
information and other constraints. We formulate the curve inference process-as two distinct
stages. in which local information is .first recovered 50 that Oit can guide the global stage.
ln this thesis we concentrated on the recovery of local information. and demonstrated that
lt could be accomplished both in ,theory and in practice.
Images contain information not directly about curves. but rather about their
traces; or the set of quantized image positions through which the curve passes. But<these traces ~r~rtot uniquely specified; they must be separated from other image st ruc-
ture. Therefore the first stage of eurve inference must include trace inferenee. and the
, ~evelopment of an approach to this occupied most of this. thesis.
Inherent in trace inference is a chicken-and-egg problem. If the functional form
lof the curve were known. then the trace could simpl{be calculated. But sinee it is not.
most of the effort went into deve/op,ing an estimation procedure sufficently powerful ta
provide a model for the curve in the neighborhood of each possible trace point.' The model
for curves included the tangent and curvature at each point. and it is this model that guided
trace inference. The result was what ~e called- a tangent. field. or a representation of the
trace. tangent. and curvatures suitably quantjzed\
, ,Sinœ oit is the high-frequency m~o-st!'Uc~. of curves that is ,'ost through
Summary and C~nclusions
\,. quantization. it i~ natural to emp10y smoothness constraints while estimaEmg 1,hem. We
derived such an es~imation procedure by examining how discretization and quantization
affect- their differential-geometric definitions. The result was a functional with terms through
curvature variation which could be maximized to guide trace inference. It appears that
functiQnals through curvature variation are necessary to properly separate the influences of
nearby curves. yet are sufflcient to place discontinuities.
The computation of curvat",re is notoriously sensitive to noise. To avoid these
prob1ems. we introduced an alternate method for coarsely estimating it. based on average
values of tangent estimates within spatial neighbourhoods ca lied curvature classes.
Computrng the tangent field was the overall goal of the first stage of curve
inference. and we demonstrated that curvature and curvature ·cons;stency (or limits on
curvature ~ariation) can be utili~ed advantageously. The information in the tangent field
certainly provides a rich. stable foundation for global curve inference.
~Ibllolrlphy
Bibliography
Attneave. F .':. Applications of Inforrr,ation Theory to Psychology: a summary of ,basic
conèepts. methods. and results. Holt. RilJehart and Winston. New York. 1959.
Barrow. H. G .. !r:'d Tenenbaum. J. M ..
~'Interpreting line drawings as three-dimen~ional
-iurfaces:' Artificiallntelligence. vol. 17: 1981'. pp: 75-116.
Binford. T. O .. "Inferring surfaces-from images." Artificiallnte/l/gence. vol. 17. 1981. pp.
Brady. M .. and Asada. H~. "Smoothed local symmetries and their implementation." Robotics
Research. vol. 3. 1984. pp. 37-61 .
Davis. l. S .. and Freeman .. "Corner detection -in cha'in codes:' IEEE, Transactions on
Pattern Analysis and Mac~i,!e Intelligence. 1977.
Davis. l. 5 .. and Rosenfeld. A.. "Cooperating processes for low-leveJ vision: a- survey."
ArtificÎallntelligence. vol. 17. 1981. pp. 245-263.
do Carmo. M. P .. DifferentiaI GeQmetry of Curves and Surfaces. Prentice Hall. Englewood
Cliffs. 'N.J .. 1976. '
~augeras. 0 .. and Berthod. M .. "Scene labeling. an optimization approach." Proceedings
of the IEEE COnference on Pattern Recognition and Ima(e Processing.1979. pp. 318-
Fischler. M. A .. and BoUes. R. C .. "Perceptual organization and curve partitioning," Proceedings of the 1,~83 Image Un~erstanding WorkshoPi ~983.
Hartshorne. R .. Aigebraic Geometry. Springer Verlag. 1972 .. _
Hedlund. M .. Granlund. G. H .. and Knutsson. H .• "A consistency operation for U~nd
cur~e enhancem~nt." Proceedings of the Pattern Recognitio,! and ''!lage 'processing
cqnferènce. 1982. pp. 93-96.