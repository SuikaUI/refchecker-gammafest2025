On representing chemical environments
Albert P. Bart´ok,1, ∗Risi Kondor,2 and G´abor Cs´anyi1
1Department of Engineering, University of Cambridge,
Trumpington Street, Cambridge, CB2 1PZ, United Kingdom
2Department of Computer Science, University of Chicago,
1100 East 58th Street, Chicago, IL 60637, United States of America
 
We review some recently published methods to represent atomic neighbourhood environments, and
analyse their relative merits in terms of their faithfulness and suitability for ﬁtting potential energy
surfaces. The crucial properties that such representations (sometimes called descriptors) must have
are diﬀerentiability with respect to moving the atoms, and invariance to the basic symmetries
of physics: rotation, reﬂection, translation, and permutation of atoms of the same species.
demonstrate that certain widely used descriptors that initially look quite diﬀerent are speciﬁc cases
of a general approach, in which a ﬁnite set of basis functions with increasing angular wave numbers
are used to expand the atomic neighbourhood density function. Using the example system of small
clusters, we quantitatively show that this expansion needs to be carried to higher and higher wave
numbers as the number of neighbours increases in order to obtain a faithful representation, and
that variants of the descriptors converge at very diﬀerent rates.
We also propose an altogether
new approach, called Smooth Overlap of Atomic Positions (SOAP), that sidesteps these diﬃculties
by directly deﬁning the similarity between any two neighbourhood environments, and show that
it is still closely connected to the invariant descriptors. We test the performance of the various
representations by ﬁtting models to the potential energy surface of small silicon clusters and the
bulk crystal.
PACS numbers: 07.05.Tp,36.40.Mr
INTRODUCTION
The appropriate representation of atomic environments is a crucial ingredient of algorithms used in modern
computational chemistry and condensed matter physics.
For example, in structure search applications1, each con-
ﬁguration depends numerically on the precise initial conditions and the path of the search, so it is important
to be able to identify equivalent structures and detect
similarities. In molecular dynamics simulations of phase
transitions2, one needs good order parameters that are
capable of detecting changes in the local order around
atoms. Typically the representation is in terms of a descriptor (also called a ﬁngerprint), a tuple of real valued functions of the atomic positions, e.g. bond lengths,
bond angles, etc. “In silico” drug discovery3,4 and other
areas of chemical informatics also rely on characterising
molecules using descriptors.
When constructing interatomic potentials and ﬁtting potential energy surfaces
(PES)5–8, the driving application behind the present
work, the functional forms depend on components of
a carefully chosen representation of atomic neighbourhoods.
While specifying the position of each atom in a Cartesian coordinate system provides a simple and unequivocal description of atomic conﬁgurations, it is not directly suitable for making comparisons between structures: the list of coordinates is ordered arbitrarily and
two structures might be mapped to each other by a rotation, reﬂection or translation so that two diﬀerent lists
of atomic coordinates can, in fact, represent the same or
very similar structures. A good representation is invariant with respect to permutational, rotational, reﬂectional
and translational symmetries, while retaining the faithfulness of the Cartesian representation.
In particular,
a system of invariant descriptors q1, q2, . . . , qM is said to
be complete if it uniquely determines the atomic environment, up to symmetries. It is said to be over-complete if
it contains spurious descriptors in the sense that a proper
subset of {q1, q2, . . . , qM} is, by itself, complete. If a representation is complete, then there is a one-to-one mapping (i.e.
a bijection) between the genuinely diﬀerent
atomic environments and the invariant tuples comprising the representation. An over-complete representation
assigns potentially many distinct descriptors to a given
atomic structure, but guarantees that genuinely diﬀerent
atomic structures will never have identical descriptors associated with them: the function relating representations
to atomic structures is a surjection.
Fitting potential energy surfaces (PESs) and electrostatic multipole moment surfaces of small molecules to
data generated by ﬁrst principles electronic structure calculations has been a mainstay of computational chemistry for decades7,9–27.
Typically, when modelling the
PES of a small group of atoms, the list of pairwise distances is used or, equivalently, some transformed version of the interatomic distances, e.g.
reciprocal6 or
exponential7. This description works when the number
of atoms is ﬁxed.
Even in this case, a seemingly new
conﬁguration is obtained by just permuting the order of
atoms, i.e. crucial symmetries may be missing in this
framework.
Braams and Bowman7 remedied this last
shortcoming by using polynomials of pairwise distances,
 
constructed such that each term is invariant to the permutation of identical atoms. Computer code is available
that generates the permutationally invariant polynomials automatically7 (up to ten atoms), but this approach
still does not allow for varying number of atoms in the
database of conﬁgurations.
In order to generate interatomic potentials for solids
or large clusters, capable of describing a wide variety
of conditions, the number of neighbours that contribute
to the energetics of an atom has to be allowed to vary,
with the symmetry invariant descriptors remaining continuous and diﬀerentiable.
Even though it is possible
to allow the dimensionality M to change with the number of neighbours, for the purpose of function ﬁtting it
is more practical that M remains the same.
the traditional representations fulﬁl this criterion. Recently, however, a number of new, promising descriptors
have been proposed together with potential energy surfaces based on them5,8,24,28,29. Behler and Parrinello’s
“symmetry functions”5 were used to generate potentials
for silicon30, sodium31, zinc oxide32 and water33 amongst
others; Bartok et al. employed the bispectrum8 to ﬁt a
many-body potential for crystalline phases and defects in
diamond. Sanville et al. used a subset of internal coordinates to ﬁt silicon potentials28. Rupp et al. used the
ordered eigenvalues of the Coulomb-matrix to ﬁt atomisation energies29 of a set of over 7000 small organic
molecules.
At this point it is not clear which method
of representing atomic neighbourhoods will prove to be
optimal in the long term. We attempt to disentangle this
issue from the rather complex details of generating ﬁrst
principles data and ﬁtting PES, and separately consider
the problem of constructing good descriptors.
The most well-known invariants describing atomic
neighbourhoods are the bond-order parameters originally
proposed by Steinhardt et al.34 Here we show that the
bond-order parameters form a subset of a more general
set of invariants called the bispectrum35. The formally in-
ﬁnite array of bispectrum components provides an overcomplete system of invariants, and by truncating it one
obtains representations whose sensitivity can be reﬁned
at will. We relate the bispectrum to the representation
proposed by Behler et al.5,36, and show that, together
with another descriptor set described below, their angular parts are all simple polynomials of the same set of
canonical invariants.
The paper is organised as follows.
In section II we
brieﬂy recall how potential energy surfaces are constructed using invariant descriptors.
In section III we
describe a number of descriptors, starting with a simple distance metric between atomic conﬁgurations which
will be used as a reference to assess the faithfulness of
all other descriptors but which itself is not diﬀerentiable.
In Section IV we introduce a new, continuous and differentiable distance metric for constructing potential energy surfaces, called Smooth Overlap of Atomic Functions (SOAP), which has superior properties. In section
V we show numerical tests that help assess the degree
of completeness and faithfulness of various descriptors
and SOAP, and also show an explore their performance
in ﬁtting models for small silicon clusters and the bulk
POTENTIAL ENERGY SURFACE FITTING
The main motivation behind this paper is to deﬁne and
assess a family of invariant descriptors to be used for ﬁtting interatomic potentials, or potential energy surfaces
(PESs). In the construction of potentials for materials
applications, the short range part of the total energy is
decomposed into atomic contributions,
, . . . , q(n)
where ε is the contribution of the nth atom, and q(n) =
, . . . , q(n)
M ) is a system of descriptors characterizing
the local atomic environment.
Traditionally, such atomic energy functions are deﬁned
in closed form. However, recently, there has been a lot
of interest in using more ﬂexible, nonparametric PESs,
derived from computing the total energy and its derivatives at a certain set {q(1), . . . , q(N)} of “training” con-
ﬁgurations using ﬁrst principles calculations. A crucial
question then is how to ﬁt ε to the computed datapoints.
The simplest approach is to use a linear ﬁt, while Behler
and Parrniello advocate using artiﬁcial neural networks
(NN)5, and Bart´ok et al. use Gaussian Approximation
Potentials8.
However, ultimately, each of these procedures result in a PES of the form
where the coeﬃcient vector α = (α1, . . . , αN) is determined by the ﬁtting procedure, and K is a ﬁxed (nonlinear) function, called the kernel, whose role, intuitively,
is to capture the degree of similarity between the atomic
environments described by its two arguments. Clearly,
then, the choice of descriptors, in particular, their invariance to symmetries, as well as the choice of kernel, are
critical ingredients to obtaining good quality PESs.
In general, the kernel K can be interpreted as a covariance function, and therefore it must be symmetric and positive deﬁnite (meaning that K(q, q′)
K(q′, q) and for any non-zero vector α of coeﬃcients, P
ℓαkαℓK(q(k), q(ℓ)) > 0). Rasmussen and
Williams37 present a number of such kernels, some of the
simplest ones being the following.
The dot-product (DP) kernel is deﬁned as
which, when substituted into equation (1), results in
qjβj ≡q · β,
i.e. the linear regression on the descriptor elements with
coeﬃcient vector β.
When using artiﬁcial neural networks with NH hidden
units, the atomic energy function ε is given by
ε(q) = b +
vjh(q, uj),
where b is the bias, v the vector of unit weights, h is
the transfer function, and {uj}NH
j=1 the unit parameters37.
In the limit of an inﬁnite number of hidden units, for
speciﬁc transfer functions it is possible to reformulate
equation (3) in the form of equation (1) with well-deﬁned
covariance functions37–39.
For example, for h(q, u) =
tanh(u0 + P ujqj) the corresponding kernel is39
2 + const.
Finally, the squared exponential (SE) kernel that we
have used in the past with the Gaussian Approximation
Potentials8 and in some of the examples below is
DESCRIPTORS
Among the applications mentioned in the introduction, some require representing the geometry of an entire molecule, while for others one needs to describe the
neighbourhood of an atom perhaps within a ﬁnite cutoﬀdistance. While these two cases are closely related,
the descriptors for one are not directly suitable for the
other, although often the same idea can be used to derive
representations for either case. Below, we focus on representing the neighbour environment of a single atom, but
for some cases we brieﬂy mention easy generalisations
that yield global molecular descriptors.
neighbouring
{r1, r2, . . . , rN}
the symmetric matrix
· · · r1 · rN
· · · r2 · rN
rN · r1 rN · r2 · · · rN · rN
is, according to Weyl40, an over-complete array of basic
invariants with respect to rotation, reﬂection and translation. However, Σ is not a suitable descriptor, because
permutations of atoms change the order of rows and
columns. For example, swapping atoms 1 and 2 results
in the transformed matrix
· · · r2 · rN
· · · r1 · rN
rN · r2 rN · r1 · · · rN · rN
To compare two structures using their Weyl matrices
Σ and Σ′, we deﬁne a reference distance metric
dref = min
P ||Σ −PΣ′PT ||,
where P is a permutation matrix and the minimisation
is over all possible permutations. This metric is not differentiable at locations where the permutation that minimises (7) changes. It would also be intractable to calculate exactly for large numbers of atoms, but nevertheless
we will use this metric to assess the faithfulness of other
representations for a small system. Other, diﬀerentiable
invariants shown later in this paper are, however, closely
related to the elements of Σ.
One way to generate permutationally invariant differentiable functions of the Weyl matrix is to compute
its eigenvalues; indeed, a very similar descriptor was recently used to ﬁt the atomisation energies of a large set of
molecules29. However, the list of eigenvalues is very far
from being complete, since there are only N eigenvalues,
whereas the dimensionality of the conﬁguration space of
N neighbour atoms is 3N −3 (after the rotational symmetries are removed). It is also unclear how to make the
descriptors based on the eigenspectrum continuous and
diﬀerentiable as the number of neighbours varies.
The Z-matrix, or internal coordinates, is a customary
set of rotationally invariant descriptors usually used to
describe the geometry of entire molecules, but it is not
invariant to permutations of atoms. The Z-matrix is complete, but in contrast to the Weyl matrix of basic invariants which are based solely on bond lengths and bond
angles, it is a minimal set of descriptors that also contains some dihedral angles.
Another straightforward way to compare structures is
based on pairing the atoms from each and ﬁnding the
optimal rotation that brings the two structures into as
close an alignment as possible. For each pair of structures
i=1 and {r′
i=1, it is possible to order the atoms according to their distance from the central atom (or centre
of mass, in case we want to compare entire molecules) and
where ˆR represents an arbitrary rotation (including the
possibility of a reﬂection). We can then deﬁne the distance between two conﬁgurations as
This distance clearly has all the necessary invariances and
completeness properties, but, like dref, it is not suitable
for parametrising potential energy surfaces, because it
is again not diﬀerentiable: the reordering procedure and
the minimisation over rotations and reﬂections introduce
In the ﬁeld of molecular informatics, one popular descriptor is based on the histogram of pairwise atomic
distances41, similar to Valle’s crystal ﬁngerprint42. We
will not consider these here, because they are unsuitable for ﬁtting PES, as they are clearly not complete:
e.g. from six unordered distance values it is not necessarily possible to construct a unique tetrahedron, even
though the number of degrees of freedom is also six.
Figure 1 shows two tetrahedra that were constructed such
FIG. 1. Two distinct tetrahedra, constructed from the same
set of 6 distances.
that the edges in each correspond to the same set of six
distances. The tetrahedra are manifestly diﬀerent, which
can also be seen by comparing the lists of angles, shown
in Table I.
Bond-order parameters
As a ﬁrst step in deriving continuous invariant representations of atomic environments, we deﬁne the atomic
neighbour density function associated with a given atom
wZiδ(r −ri),
where the index i runs over the neighbours of the atom
within some cutoﬀdistance, wZi is a unique weight factor assigned according to the atomic species of i, and ri
is the vector from the central atom to neighbour i. For
clarity, we will omit the species weights from now on, and
assume a single atomic species, but none of our results
rely on this. Determining which neighbours to include
in the summation can be done by using a simple binary
valued, or a smooth real valued cutoﬀfunction of the
interatomic distance, or via a more sophisticated procedure, e.g. Voronoi analysis34. The atomic neighbour
density is already invariant to permuting neighbours, because changing the order of the atoms in the neighbour
list only aﬀects the order of the summation. To simplify
the following derivation, for now we omit the information
on the radial distance to the neighbours, but will show
later how the radial information can be included. The
atomic neighbour density function can then be expanded
in terms of spherical harmonics:
clmYlm(ˆr),
where ˆr is the point on the unit sphere corresponding to
the direction of the vector r, thus ρ(ˆr) is the projection
of ρ(r) onto the unit sphere, S2.
The properties of functions deﬁned on the unit sphere
are related to the group theory of SO(3), the group of
three dimensional rotations. Spherical harmonics form
an orthonormal basis set for L2(S2), the class of square
integrable functions on the sphere:
⟨Ylm|Yl′m′⟩= δll′δmm′,
where the inner product of functions f and g is deﬁned
f ∗(ˆr)g(ˆr) dΩ(ˆr),
where the surface element dΩ(ˆr) can be expressed in
terms of the polar angles θ and φ as
dΩ(ˆr) = sin θ dθ dφ,
and the coeﬃcients clm are given by
clm = ⟨ρ|Ylm⟩=
The quantities Qlm introduced by Steinhardt et al.34
are proportional to the coeﬃcients clm. Dividing by N,
the number of neighbours of the atom (within a ﬁnite
cut-oﬀdistance) provides the atomic order parameters
Furthermore, averaging (12) over atoms in the entire system gives a set of global order parameters
Ylm(ˆrii′),
where Nb is the total number of atom pairs included in
the summation, and we wrote rii′ for the vector connecting atom i to its neighbour i′. Both sets are invariant
to permutations of atoms and translations, but still depend on the orientation of the reference frame. However,
rotationally invariant combinations can be constructed
TABLE I. Angles of the tetrahedra shown in ﬁgure 1.
m1,m2,m3=−l
Qlm1Qlm2Qlm2
for atomic neighbourhoods and
m1,m2,m3=−l
¯Qlm1 ¯Qlm2 ¯Qlm2
for the entire structure. The factor in parentheses is the
Wigner-3jm symbol43, which is zero unless m1 + m2 +
The numbers Ql and Wl are called second-order and
third-order bond-order parameters, respectively.
possible to normalise Wl such that it does not depend
strongly on the number of neighbours:
For symmetry reasons, only coeﬃcients with l ≥4
have non-zero values in environments with cubic symmetry and l ≥6 for environments with icosahedral symmetry. Diﬀerent values correspond to crystalline materials
with diﬀerent symmetry, while the global order parameters vanish in disordered phases, such as liquids. Bondorder parameters were originally introduced for studying
order in liquids and glasses34, but were soon adopted for
a wide range of applications. They have been used to
study the free energy of clusters44,45, melting of quantum solids46, nucleation47, as well as to serve as reaction
coordinates in simulations of phase transitions48,49 and
glasses50, and also to generate interatomic potentials51.
The power spectrum
Using some basic concepts from representation theory,
we now prove that the second-order bond-order parameters are indeed rotationally invariant, then we show a
more general set of third order invariants,35 of which the
Qs and the Ws are a subset. An arbitrary rotation ˆR operating on a spherical harmonic function Ylm transforms
it into a linear combination of spherical harmonics with
the same l index:
mm′( ˆR)Ylm′,
where the Dl( ˆR) matrices are known as the Wigner matrices, which form the irreducible representations of the
three dimensional rotation group, SO(3). The elements
of the Wigner matrices are given by
mm′( ˆR) = ⟨Ylm| ˆR|Ylm′⟩.
It follows that the rotation operator ˆR acts on the function ρ as
mm′(R)Ylm′
thus the column vector cl of expansion coeﬃcients transforms under rotation as
cl →Dl( ˆR)cl.
Making use of the fact that rotations are unitary operations on L2(S2), it is possible to show that the matrices
Dl are unitary,
Dl†Dl = I,
and therefore c†
l cl transforms according to
l Dl†  Dlcl
is invariant under rotation.
We call pl the rotational power spectrum due to the analogy with the familiar power spectrum of ordinary Fourier analysis.
We also note that the elements of cl transform under
reﬂection about the origin as
cl →(−1)l cl,
thus the power spectrum is also invariant to this symmetry operation. A comparison with equations (11), (12)
and (13) shows that the second-order bond-order parameters are related to the power spectrum via the simple
The power spectrum is clearly not a complete descriptor for a general function f(ˆr) on the sphere, for example
consider the two diﬀerent functions
f1 = Y22 + Y2−2 + Y33 + Y3−3
f2 = Y21 + Y2−1 + Y32 + Y3−2,
which both have the same power spectrum, p2 = 2 and
p3 = 2 (with all other components equal to zero). However, for the restricted class of functions which are sums
of a limited number of delta functions (such as the atomic
neighbour density ρ in equation (9)), the power spectrum
elements turn out to be polynomials of the basic invariants of Weyl. Using numerical experiments we demonstrate in section V that for a ﬁxed number of neighbours
a certain set of power spectrum components is likely to
be over-complete.
The bispectrum
We generalise the concept of the power spectrum to
obtain a larger set of invariants via coupling diﬀerent angular momentum channels35,52. Let us consider the direct
product cl1 ⊗cl2, which transforms under a rotation as
cl1 ⊗cl2 →
 Dll ⊗Dl2
(cl1 ⊗cl2) .
It follows from the representation theory of compact
groups that the direct product of two irreducible representations can be decomposed into a direct sum of irreducible representations53. In case of the SO(3) group,
the direct product of two Wigner matrices can be decomposed into a direct sum of Wigner matrices,
where Cl l1l2
mm1m2 denote the Clebsch-Gordan coeﬃcients
or, using more compact notation,
Dll ⊗Dl2 =
where Cl1l2 denote the matrices formed of the Clebsch-
Gordan coeﬃcients. These are themselves unitary, so the
vector Cl1l2 (cl1 ⊗cl2) transforms as
Cl1l2 (cl1 ⊗cl2) →
Cl1l2 (cl1 ⊗cl2) . (20)
Writing out the block diagonal matrix in the square
brackets as
D|l1−l2|+1
we see that each block selects a particular slice of the
vector in equation (20), which transforms according to a
given Dl matrix. We give a new symbol to these slices,
gl l1l2, so that the original vector is their direct sum
Cl1l2 (cl1 ⊗cl2) ≡
and each gl l1l2 transforms under rotation as
gl l1l2 →Dlgl l1l2.
Analogously to the power spectrum, we can now deﬁne
the bispectrum as the collection of scalars
bl l1l2 = c†
l gl l1l2,
which are invariant to rotations:
bl l1l2 = c†
l gl l1l2 →
 clDl† Dlgl l1l2 = c†
l gl l1l2.
It follows from equation (17) that those elements of the
bispectrum where l1 + l2 + l is odd change sign under
reﬂection about the origin. If invariance to reﬂection is
required, we take the absolute value of these components
or omit them from the descriptor.
Rewriting the bispectrum formula as
mm1m2cl1m1cl2m2,
the similarity to the third-order bond-order parameters
becomes apparent. Indeed, the Wigner 3jm-symbols are
related to the Clebsch-Gordan coeﬃcients through
= (−1)l1−l2−m3
and by substituting the spherical harmonics identity
Ylm = (−1)mY ∗
l−m in equation (12) it follows that
Qlm = (−1)m(Qlm)∗.
Substituting the identities (22) and (23) into the deﬁnition (14) we obtain
m1,m2,m3=−l
(−1)−mCl l l
m1m2−m3Qlm1Qlm2(−1)m(Qlm3)∗,
thus the third-order parameters Wl are seen to be proportional to the diagonal elements of the bispectrum, bl l l.
Noting that Y00 ≡1, the coeﬃcient c00 is the number
of neighbours N, and using Cl 0 l2
m 0 m2 = δl l2δmm2, the bispectrum elements l1 = 0, l = l2 are identical to the
previously introduced power spectrum components:
bl 0 l = N
lmδmm2clm2 =
lmclm = Npl,
therefore,
Wl ∝bl l l.
The ﬁrst few terms of the power spectrum and bispectrum for an atom with three neighbours are shown below,
where θii′ is the angle between the bonds to neighbours
i and i′, and the sums are over all the neighbours.
cos θii′ + 3
cos2 θii′ + 6
cos3 θii′ −3
cos θii′ + 3
cos4 θii′ −15
cos2 θii′ + 13
cos2 θii′ + 5
b321 = 150
cos3 θii′+
cos θii′ −1
cos2 θii′ −2
cos θii′ + 18
Radial basis
Thus far we neglected the distance of neighbouring
atoms from the central atom by using the unit-sphere
projection of the atomic environment. One way to introduce radial information is to complement the spherical
harmonics basis in equation (10) with radial basis functions gn54,
cnlmgn(r)Ylm(ˆr).
If the set of radial basis functions is not orthonormal, i.e.
⟨gn|gm⟩= Snm ̸= δnm, after obtaining the coeﬃcients
nlm = ⟨gnYlm|ρ⟩,
the elements cnlm are given by
In practice, when constructing the bispectrum, either
nlm or cnlm can be used.
Rotational invariance must only apply globally, and
not to each radial basis separately, therefore the angular
momentum channels corresponding to diﬀerent radial basis functions need to be coupled. So, although extending
equations (16) and (21) simply as
bnl l1l2 =
nlmCl l1l2
mm1m2cnl1m1cnl2m2
invariants
describing
threedimensional neighbourhood of the atom, this can easily
lead to a poor representation if the radial basis functions
do not suﬃciently overlap. The diﬀerent radial shells will
only be weakly coupled, and the representation will have
spurious quasi-invariances to rotating subsets of atoms
at approximately the same distance, as illustrated in Figure 2.
FIG. 2. Example of weakly overlapping radial basis functions
gn(r), cf. equation (24). Atoms 1 and 2 at distance r1 and
r2 from the centre become decoupled as their contribution to
the power spectrum or bispectrum elements is weighed down
by the product gn(r1)gn(r2), which is rather small for all n.
To avoid this, it is necessary to choose basis functions
that are sensitive over a wide range of distances, although
this may reduce the sensitivity of each radial basis function, because they are varying very slowly.
The ﬁnetuning of the basis set is rather arbitrary, and there is
no guarantee that a choice exists that is optimal or even
satisfactory for all systems of interest.
We suggest constructing radial functions from cubic
and higher order polynomials, φα(r) = (rcut −r)α+2/Nα
for α = 1, 2, . . . , nmax, normalised on the range (0, rcut)
(rcut −r)2(α+2)dr =
The orthonormalised construction
guarantees that each radial function returns smoothly
to zero at the cutoﬀwith both the ﬁrst and the second
derivative equal to zero. The matrix W of linear combination coeﬃcients is obtained from the overlap matrix
φα(r)φβ(r)dr =
(5 + 2α)(5 + 2β)
W = S−1/2.
FIG. 3. Example of radial basis functions gn(r), as deﬁned in
equation (25) for n = 1, 2, 3, 4.
Another way to avoid radial decoupling is to deﬁne
the rotational invariants in such a way that they couple
diﬀerent radial channels explicitly, for example, as
n1lmcn2lm , and
bn1n2l l1l2 =
n1lmCl l1l2
× cn2l1m1cn2l2m2.
Here, each invariant has contributions from two diﬀerent
radial basis channels, and so we ensure that they cannot become decoupled, but at the price of increasing the
number of invariants quadratically or even cubically in
the number of radial basis functions used.
4-dimensional power spectrum and bispectrum
We now present an alternative to the SO(3) power
spectrum and bispectrum that does not need the explicit introduction of a radial basis set, but still represents atomic neighbourhoods in three-dimensional space.
We start by projecting the atomic neighbourhood density within a cutoﬀradius rcut onto the surface of the
four-dimensional sphere S3 with radius r0.
The surface of S3 is deﬁned as the set of points s ∈R4, where
0, while the polar angles φ, θ and θ0
of s are deﬁned so that
s1 = r0 cos θ0
s2 = r0 sin θ0 cos θ
s3 = r0 sin θ0 sin θ cos φ
s4 = r0 sin θ0 sin θ sin φ.
We choose to use the projection
φ = arctan(y/x)
θ = arccos(z/|r|)
θ0 = π|r|/r0
where r0 > rcut is a parameter, thus rotations in threedimensional space correspond to a subset of rotations
in four-dimensional space. This projection is somewhat
similar to a Riemann projection, except in that case θ0
would be deﬁned as
θ0 = 2 arctan(|r|/2r0),
θ0 ≈|r|/r0 for |r| ≪r0.
In contrast to the Riemann projection, our choice of θ0
allows more sensitive representation of the entire radial
The limit r0 = rcut projects each atom at the
cutoﬀdistance to the South pole of the 4-dimensional
sphere, thus losing all angular information.
an r0 would project all positions onto a small surface
area of the sphere around the North pole, requiring a
large number of basis functions to represent the atomic
environment. In practice, a large range of r0 values works
well, in particular, we used r0 = 4
To illustrate the procedure, Figure 4 shows the Riemann projections for one and two dimensions, which can
be easily drawn.
FIG. 4. Two- and three-dimensional Riemann constructions
that map a ﬂat space onto the surface of a sphere in one higher
dimension.
An arbitrary function ρ deﬁned on the surface of a 4D
sphere can be numerically represented using the hyperspherical harmonic functions U j
m′m(φ, θ, θ0)43,55:
which, in fact, correspond to individual matrix components of the Wigner (i.e. rotational) matrices, as deﬁned
in equation (15). In this case the arguments represent a
rotation by θ0 around the vector pointing in the (φ, θ)
direction, which can be transformed to the conventional
Euler-angles, and j takes half-integer values.
The hyperspherical harmonics form an orthonormal
basis for L2(S3), thus the expansion coeﬃcients cj
can be calculated via
m′m = ⟨U j
where ⟨.|.⟩denotes the inner product deﬁned on the fourdimensional hypersphere:
dθ0 sin2 θ0
f ∗(θ0, θ, φ) g(θ0, θ, φ).
Although the coeﬃcients cj
m′m have two indices besides
j, for each j it is convenient to collect them into a single vector cj. Similarly to the three-dimensional case,
rotations act on the hyperspherical harmonic functions
where the matrix elements Rj
2m2 are given by
2m2 = ⟨U j
1m1| ˆR|U j
Hence the rotation ˆR acting on ρ transforms the coeﬃcient vectors cj according to
The unitary Rj matrices are the SO(4) analogues of the
Wigner-matrices Dl of the SO(3) case above, and it can
be shown that the direct product of the four-dimensional
rotation matrices decomposes according to
Rjl ⊗Rj2 =
which is the 4-dimensional analogue of equation (19).
The coupling constants Hj1j2, or Clebsch-Gordan coeﬃcients of SO(4) are55,56
2 ≡Cj j1j2
mm1m2Cj j1j2
The rest of the derivation continues analogously to the
3D case, and ﬁnally we arrive at the expression for the
SO(4) bispectrum elements
mm1m2Cj j1j2
while the SO(4) power spectrum is
The SO(4) bispectrum is invariant to rotations of fourdimensional space, which include three-dimensional rotations. However, there are additional rotations, associated
with the third polar angle θ0, which, in our case, represents the radial information. In order to eliminate the
unphysical invariance with respect to rotations along the
third polar angle, we modify the atomic density as
ρ(r) = δ(0) +
we add the central atom — with the coordinates
(0, 0, 0) — as a ﬁxed reference point, anchoring the neighbourhood.
The resulting invariants Bj j1j2 have only
three indices, but contain both radial and angular information, and have the required symmetry properties.
There are no adjustable parameters in the deﬁnition of
these invariants, apart from the projection parameter r0
discussed above.
The number of components in the truncated representation depends on the band limit jmax in the expansion (28). For symmetry reasons, the bispectrum components with non-integer j1+j2+j change sign under reﬂection and, because of this reason, we omitted them. Just
as in the 3D case, the representation is probably overcomplete, i.e. most of the bispectrum components are redundant. To reduce the number of redundant elements,
we only used the ‘diagonal’ components, i.e. j1 = j2.
Table II shows the number of bispectrum elements for
increasing band limit values.
TABLE II. Number of components in the full and diagonal
bispectrum as a function of the band limit jmax.
Parrinello-Behler descriptor
We include in the tests below the descriptor suggested
by Parrinello and Behler5 using the parameters published
recently57 (and henceforth termed PB). The two- and
three-body symmetry functions (in their terminology)
−ηα(ri −Rsα)2
α = 21−ζα X
(1 + λα cos θii′)ζα×
fc(ri)fc(ri′)fc(rii′),
where the cutoﬀfunction is deﬁned as
for r ≤rcut
for r > rcut
Diﬀerent values of the parameters η, Rs, ζ, λ can be used
to generate an arbitrary number of invariants.
η = 0.001 Bohr−2
η = 0.010 Bohr−2
η = 0.020 Bohr−2
η = 0.035 Bohr−2
η = 0.060 Bohr−2
η = 0.100 Bohr−2
η = 0.200 Bohr−2
η = 0.400 Bohr−2
Radial basis functions G2 in the Parrinello-Behler
(PB) type descriptors57.
Angular Fourier Series
Notice that the angular part of the power spectrum,
bispectrum (section III C) and the descriptors deﬁned by
Parrinello and Behler (section III F) are all simple polynomials of the canonical set P
ii′ cosm θii′ for integer m,
which, in turn, are sums of powers of the basic invariants
of Weyl. We include in the tests in the next section a further descriptor set, which we call the Angular Fourier Series (AFS) descriptor, formed by a system of orthogonal
polynomials of the basic invariants, conveniently chosen
as the Chebyshev-polynomials Tl(x), as
Tl(cos θ) = cos(lθ),
and incorporate the radial information using the basis
functions deﬁned in equation (25), leading to
gn(ri)gn(ri′) cos(lθii′).
FIG. 6. Examples of the angular basis functions for lmax = 4
of the AFS descriptor.
A SIMILARITY MEASURE BETWEEN
ATOMIC ENVIRONMENTS
It is clear from the preceding section that there is a
lot of freedom in constructing descriptors, e.g.
choice of angular band limit, the radial basis and also
which subset of the basis elements are actually used. As
we have shown in section II, the key to PES ﬁtting are
not the descriptors per se, but the similarity measure
K(q, q′) that is constructed from the descriptors. This
suggests an alternative approach, in which descriptors are
bypassed altogether, and a similarity measure between
atomic neighbourhoods is constructed directly. The criteria for a good similarity measure is not only that it be
invariant to symmetry operations of the atoms of each environment and have a well-deﬁned limit when comparing
two identical or two very diﬀerent environments, but also
that the it change smoothly with the Cartesian atomic
coordinates.
We deﬁne the similarity of two atomic environments
directly as the inner product of two atomic neighbour
densities ρ and ρ′ (deﬁned in equation (9)), as the overlap
S(ρ, ρ′) =
ρ(r)ρ′(r)dr.
This clearly satisﬁes the permutational invariance criterion. Integrating equation (29) over all possible rotations
of one of the environments leads to a rotationally invariant similarity kernel
k(ρ, ρ′) =
S(ρ, ˆRρ′)
ρ(r)ρ′( ˆRr)dr
It is easy to see that for n = 1, all angular information –
the relative orientation of individual atoms – is lost because the order of the two integrations can be exchanged,
but for n ≥2 the kernel retains the angular information of the original environments. The obvious practical
diﬃculty with this construction is the evaluation of the
angular integral, which is addressed next.
Analytic evaluation a smooth similarity kernel
Retaining the Dirac-delta functions in the deﬁnition of
the atomic neighbour density would lead to a discontinuous similarity kernel in that the dissimilarity between two
environments with very close but not identical atomic positions would be large. Therefore, instead of the Diracdelta functions, we construct the atomic neighbour density using Gaussians, expanded in terms of spherical harmonic functions as58
 −α|r −ri|2
−α(r2 + r2
ιl(2αrri) Ylm(ˆr) Y ∗
where ιl are the modiﬁed spherical Bessel functions of
the ﬁrst kind. The atomic neighbour density function is
then deﬁned as a sum of Gaussians with one centred on
each neighbour,
 −α|r −ri|2
lm(r)Ylm(ˆr),
lm(r) ≡4π exp
−α(r2 + r2
ιl(2αrri)Y ∗
The overlap between an atomic environment (unprimed) and a rotated environment (primed) is
S( ˆR) ≡S(ρ, ˆRρ′) =
dr ρ(r)ρ′( ˆRr) =
l′, m′, m′′
m′m′′( ˆR)
lm(ˆr)Yl′m′′(ˆr) =
mm′(α, ri, ri′)Dl
mm′( ˆR) =
where the integral of the coeﬃcients is
mm′(α, ri, ri′) =
ιl (αriri′) Ylm(ˆri)Y ∗
mm′(α, ri, ri′).
The rotationally invariant kernel with n = 2 then becomes
k(ρ, ρ′) =
d ˆR S∗( ˆR)S( ˆR) =
d ˆR D∗( ˆR)l
mm′D( ˆR)λ
where we used the orthogonality of the Wigner-matrices.
Although in practice we always use n = 2, it is easy
to derive the kernel for any arbitrary order n using the
Clebsch-Gordan series in equation (18). For n = 3, using
the fact that S, as deﬁned in equation (29) is real and
k(ρ, ρ′) =
d ˆR S( ˆR)3,
which can be shown to be
k(ρ, ρ′) =
l1m1l2m2Clm′
Raising a positive deﬁnite function to a positive integer
power yields a function that is similarly positive deﬁnite. In our context, raising k to some power ζ ≥2 has
the eﬀect of accentuating the sensitivity of the kernel to
changing the atomic positions, which we generally found
to be advantageous in experiments. Therefore, following
normalization by dividing by
k(ρ, ρ)k(ρ′, ρ′), we deﬁne
the general form of what we call the Smooth Overlap of
Atomic Positions (SOAP) kernel as
K(ρ, ρ′) =
k(ρ, ρ)k(ρ′, ρ′)
where ζ is any positive integer.
Radial basis and relation to spectra
Note that Il
mm′ needs to be computed for each pair
of neighbours, which can become expensive for a large
number of neighbours. If we expand equation (32) using
radial basis functions gn(r), the atomic neighbour density
function becomes
 −α|r −ri|2
cnlmgn(r)Ylm(ˆr),
and similarly, the ρ′ environment is expanded using coeﬃcients c′
nlm. If the radial basis functions form an orthonormal basis, i.e.
drgn(r)gn′(r) = δnn′,
the sum in equation (33) becomes
The signiﬁcance of this result becomes apparent when
substituting equation (38) into equation (34) to obtain
k(ρ, ρ′) =
n,n′,l,m,m′
nlm′)∗(cnlm)∗c′
cnlm(cn′lm)∗,
is exactly the power spectrum (cf. equation (26)), and,
analogously, p′
nn′l is the power spectrum of the primed
environment. Furthermore, the kernel in equation (39)
is the dot-product of the power spectra, cf. equation (2).
Analogously, the kernel for n = 3, deﬁned in equation
(35), can be expressed as
k(ρ, ρ′) =
bn1n2nl l1l2b′
n1n2nl l1l2,
bn1n2n l1l2l ≡
cn1l1m1cn2l2m2(cnlm)∗Clm
cf. equation (21), and b′ is analogously the bispectrum of
the primed environment. In Figure 7 we show the convergence of the similarity kernel (39) with increasing number
of angular and radial basis functions in the expansion.
In this section we started out by taking a diﬀerent approach to the problem of comparing neighbour environments, deﬁning the SOAP similarity kernel (36) directly,
rather than going via a descriptor. Equations (39) and
(41), however, reveal the relation between SOAP and the
SO(3) power spectrum and bispectrum: SOAP is equivalent to using the SO(3) power or bispectrum descriptor
together with Gaussian atomic neighbour density contributions and a dot product covariance kernel. The advantage of SOAP over the previous descriptors is that it
eliminates some of the ad hoc choices that were needed
before, while retaining control over the smoothness of the
similarity measure using α, the width of the Gaussians
in deﬁning the atomic neighbourhood density in equation
(32) and its sensitivity using the exponent ζ in equation
Diﬀerence in K (ρ, ρ′)
FIG. 7. Convergence of the similarity kernel K(ρ, ρ′) of two
arbitrary atomic environments with 15 neighbours at diﬀerent
sizes of basis expansion. We used the parameters α = 0.4 and
ζ = 1.0, and the converged kernel is K(ρ, ρ′) = −0.842735.
The top panel shows the convergence of the kernel, evaluated
according to equation (34), with increasing number of spherical harmonics functions. The bottom panel shows the convergence of the kernel, evaluated according to equation (39),
with increasing number of radial basis functions, while keeping lmax = 16.
NUMERICAL RESULTS
We have derived methods to transform atomic neighbourhoods to descriptors that are invariant under the required symmetry operators, however, their relative merit
for ﬁtting potential energy surfaces remains to be seen.
The faithfulness of the representation, i.e. that no genuinely diﬀerent conﬁgurations should map onto the same
descriptor, is of particular interest. As the inverse transformation from the descriptor to atomic coordinates —
apart from the simplest cases — is not available, we describe numerical experiments in which we attempt to reconstruct atomic coordinates from descriptors, up to rotations, reﬂections and permutations. Descriptors which
severely fail in this test are unlikely to be good for ﬁtting potential energy surfaces, because entire manifolds
of neighbour environments that are genuinely diﬀerent
with widely varying true energies will be assigned the
same descriptor, resulting in ﬁtted PES with many degenerate modes. We compare and test the performance
of the various descriptors by generating potential energy
surfaces for silicon clusters and the bulk crystal using our
Gaussian Approximation Potentials framework8.
Reconstruction experiments
Recall that the elements ri · ri′ of Σ deﬁned in equation (5) are an over-complete set of basic invariants,
which, in the case of atoms scattered on the surface of a
unit sphere (|ri| = 1), are the cosines of the bond angles,
θii′. Thus, the angular part of all descriptors in section
III are permutationally invariant functions of the basic
invariants in Σ, and depending on the actual number of
descriptor elements used, they may form an incomplete,
complete or over-complete representation of the atomic
environment. In practice, one would like to use as few
descriptors as possible, partly due to computational cost,
but also because descriptors that use high exponents of
the angles are likely to lead to less smooth PESs, as will
be shown below.
Given N neighbours, the number of independent degrees of freedom in the neighbourhood conﬁguration is
3N −3, so we need at most this many algebraically independent descriptor elements.
But because the algebraic dependency relationships between the descriptor elements is in general complicated, it is unclear how many
descriptor elements are actually needed in order to make
the descriptor complete and thus able to uniquely specify
an atomic environment of the N neighbours. However,
it is possible to conduct numerical experiments in which
we compare the descriptors of a ﬁxed target with that of
a candidate structure and minimise the diﬀerence with
respect to the atomic coordinates of the candidate. In
this way we determine if a representation is likely to be
complete or not, and in the latter case to characterise the
degree of its faithfulness.
Descriptor matching procedure.
The global minimum
of the descriptor diﬀerence between the target and the
candidate is zero and is always attained on a manifold due
to the symmetries built into the descriptors, but for an
incomplete descriptor, many inequivalent structures will
also appear equivalent, thus enlarging the dimensionality
of the global minimum manifold.
Furthermore, it can
be expected that the descriptor diﬀerence function has a
number of local minima.
In our experiments we tried to recover a given target structure after randomising its atomic coordinates.
For each n (4 ≤n ≤19) we used 10 diﬀerent Sin clusters as targets, obtained from a tight-binding59 molecular dynamics trajectory run at a temperature of 2000 K.
For each target cluster, we selected one atom as the origin, randomised the positions of its neighbours by some
amount, and then tried to reconstruct the original structure by minimising the magnitude of the diﬀerence between the descriptors of the ﬁxed target and the candidate as the atomic positions of the latter were varied.
In contrast to a general global minimum search problem, we have the advantage of knowing the target value
of the objective function at the global minimum. Also,
the motivation of our experiments is to ﬁnd at least one
conﬁguration, if it exists, that is genuinely diﬀerent from
the target, but where the descriptors match within a predeﬁned numerical tolerance. Thus it is suﬃcient to perform local, gradient-based optimisations starting from
random conﬁgurations, and reject all local minima (by
noting the small gradient of the objective function while
the value of the objective function is not small) until we
ﬁnd one where the objective function — the diﬀerence
in the descriptors — is less than than the speciﬁed tolerance. If the conﬁguration thus obtained is genuinely
diﬀerent from the target, the descriptor is shown to be
incomplete.
In order to assess the success of the reconstruction
procedure (i.e. whether the target and candidate con-
ﬁgurations are genuinely diﬀerent or not) we employed
the reference measures deﬁned in equations (7) and (8).
However, in some cases it was diﬃcult or impossible to
ﬁnd the right rotation ˆR in (8), whereas dref in (7) proved
reliable. For each dref, an initial P was generated by ordering the atoms according to their distances from the
central atom, then the optimal permutation was found
using a simple random search in the space of permutations.
We minimised the diﬀerence between the target and
candidate descriptors in the space of atomic coordinates
of the latter using the Conjugate Gradients algorithm,
stopping the minimisation when either the gradient or
the reference distance dref became smaller than 10−8˚A2
and 10−2˚A2, respectively. In order to ensure that structures deemed non-equivalent by dref > 10−2˚A2 were genuinely diﬀerent, we cross-checked them by noting the
value of ∆from equation (8) and also employing the
atomic ﬁngerprints suggested by Oganov and Valle42. To
give a sense of the typical magnitude of the dref measure,
the actual diﬀerence in terms of atomic distances between
two example structures is shown in Figure 8.
FIG. 8. Two Si8 clusters that diﬀer by dref = 4.1˚A
black atoms are taken as the origin in each environment, i.e.
the centres of rotations. In terms of Parrinello-Behler type
descriptors, the diﬀerence P
α)2 between the two
atomic environments is 6 · 10−7. The bond lengths are shown
in ˚Angstr¨oms.
In the ﬁrst set of reconstruction experiments, in order to provide a fair comparison, the truncation of the
formally inﬁnite set of descriptors was chosen in such a
way that the ﬁnite descriptors had roughly equal num-
Average dREF
Average dREF
Diﬀerence between the target and reconstructed
structures after randomisation and minimisation for randomisations of 0.2 ˚A (top) and 1.6 ˚A (bottom) as a function of the
number of atoms in the cluster, n, averaged over 10 targets for
each cluster size. The radial cutoﬀwas 6 ˚A. Diﬀerent lines
correspond to diﬀerent descriptors: Parrinello-Behler (PS),
Angular Fourier Series (AFS), bispectrum (BS) and power
spectrum (PS). The two versions of the bispectrum diﬀer in
the handling of the radial degrees of freedom.
bers of components: 51 in total for the SO(3) bispectrum
and PB descriptors and 50 for the AFS and SO(3) power
spectrum. This corresponds to a truncation of the SO(4)
bispectrum with 2jmax = 5 (the factor of 2 on account
of the half-integer nature of j), the SO(3) bispectrum
with lmax = 4 and nmax = 3, the PB descriptor with its
published parameters57 and the AFS and SO(3) power
spectrum using lmax = 9 and nmax = 5. We note that
in case of the PB descriptor the band limit of the angular descriptors (corresponding to our lmax or jmax) was
ζmax = 16 and only the values ζ = 1, 2, 4, 16 are used.
Figure 9 shows the quality of reconstruction for different cluster sizes, based on the PB, AFS, SO(3) power
FIG. 10. Two Si8 clusters that diﬀer by dref = 0.7˚A
reference atom, i.e.
the centre of the rotation, is coloured
The only diﬀerence between the two clusters is the
relative position of the furthest atom, A.
Average dREF
Diﬀerence between the target and reconstructed
structures after randomisation by 1.6˚A and minimisation, as
a function of the number of atoms in the cluster, n, averaged
over 10 targets for each cluster size. The cutoﬀwas 9˚A. The
line types corresponding to the diﬀerent descriptors are the
same as in Figure 9.
spectrum, SO(3) bispectrum and SO(4) bispectrum as
given by the reference distance dref achieved, averaged
over 10 reconstruction trials for each cluster size n. The
general trend is the same for all descriptors: as the number of neighbours increases, the average dref increases,
and thus the faithfulness of the reconstruction decreases.
Noting that the stopping criterion for the reconstruction process was dref < 10−2˚A2, larger randomisation of
the initial atomic coordinates (bottom panel) reveals the
poor representation power for all descriptors using this
parameter set for n > 10, and the neighbour conﬁguration becomes impossible to determine from the descriptor.
The poor quality of representation is partly attributable to the decrease in sensitivity to the positions
of atoms near the cutoﬀ. For example, Figure 10 shows
two Si8 clusters for which none of the descriptors lead to
perfect reconstructions (resulting in the observed peak
on Figure 9). The atom marked A in the ﬁgure is within
the 6˚A cutoﬀ, but close to it. In order to separate out
this eﬀect, we repeated the reconstruction experiments
with a radial cutoﬀof 9˚A (omitting the PB descriptor
now since there is no published parameter set for this
cutoﬀ). The results are shown in Figure 11 for the larger
initial randomisation. The peak near n = 8 is now absent, and the transition from faithful reconstruction (for
n ≤9 for the SO(3) power spectrum and AFS, and for
n ≤12 for the SO(4) bispectrum) to failure for larger n
is much clearer.
Since all the descriptors are likely to be over-complete
when the inﬁnite series of the basis set expansion is not
truncated, the reconstruction quality is expected to increase with increasing descriptor length. To verify this,
Figure 12 shows the reconstruction quality of the AFS
descriptor for varying truncations of the angular part
of the basis set. The representation becomes monotonically better for higher angular resolutions. However, this
comes at the price of introducing ever more highly oscillating basis functions, which might be less and less
suitable for ﬁtting generally smooth potential energy surfaces.
Figure 12 also shows the achieved reference values
when using the SOAP similarity measure. In this case,
rather than minimising the diﬀerence between descriptors, we optimised the candidate structure until its normalised similarity to the target as given by equation (36)
was as close to unity as possible.
In contrast to the
other descriptors, SOAP with the modest band limit of
lmax = 6 performs perfectly for all structures, without
showing any degradation for larger numbers of neighbours.
To verify that the above results are not aﬀected by
artefacts of the minimisation procedure, e.g. getting
stuck, Figure 13 shows the convergence of the reference
measure dref during a minimisation as well as the corresponding convergence of the target function (the difference between the target and candidate descriptors).
There was no diﬃculty in converging the target function
to zero (the global minimum) for any of the complete (or
over-complete) descriptors or SOAP, while the reference
similarity converged to a non-zero value for incomplete
descriptors.
Gaussian Approximation Potentials
Our main motivation for assessing diﬀerent approaches
to representing atomic neighbour environments is to determine their eﬃcacy for generating interatomic potentials. Therefore, as a ﬁnal test, we ﬁtted a series of interatomic potentials for Si3−19, based on diﬀerent descriptors, using our Gaussian Approximation Potential (GAP)
Average dREF
Average dREF
FIG. 12. Diﬀerence between target and reconstructed structures after randomisation by 1.6˚A and minimisation as a function of the number of atoms in the cluster, n, using the AFS
descriptor (top) and SOAP (bottom) with a radial cutoﬀof
9˚A, averaged over 10 targets for each cluster size. For the case
of AFS, the diﬀerent curves correspond to diﬀerent numbers
of components of the descriptor, achieved by varying the truncation of the angular expansion, while in the case of SOAP,
we varied the truncation of the expansion of the atomic neighbourhood density, which corresponds to varying the accuracy
of the evaluation of the similarity measure.
framework8. The training and the testing conﬁgurations
were obtained from tight-binding59 molecular dynamics
trajectories run at the temperatures between 500 K and
2000 K. We used four sets of cluster conﬁgurations, containing 2000, 4000, 6000 and 8000 atomic environments
for the training, corresponding to a total of 180, 360, 540
and 720 unique cluster conﬁgurations, respectively. The
test set contained 12000 atomic environments, independent from those used in the ﬁtting procedure.
We tested AFS, the SO(3) power spectrum and the
SO(4) bispectrum using the squared exponential covari-
number of minimisation steps
FIG. 13. Convergence of reference distance measure during a
typical reconstruction procedure. The inset shows the value
of the minimisation target approaching zero, i.e. descriptor
equivalence, for all of the descriptors.
ance kernel (4) as well as SOAP for potential ﬁtting.
The accuracy of the resulting potential energy surfaces
is shown in Table III as a function of the angular band
limit, and in Figure 14 as a function of the database size.
Both demonstrate that SOAP outperforms the other descriptors. As can be expected from the reconstruction
tests (cf. Figure 12) the ﬁt gets better with all descriptors
when a larger angular resolution is used, with the error
not yet saturated for lmax = 12. Similarly, increasing the
database size makes the ﬁt more accurate, and one can
expect improvement if even more than 8000 atomic environments are used (this corresponds to, on average, just
40 conﬁgurations for each cluster size).
Perhaps contrary to initial expectations, making all the
descriptors more faithful by using a larger angular band
limit is not necessarily beneﬁcial. Descriptor components
corresponding to high angular momentum channels involve angular basis functions that are highly oscillatory,
and can thus degrade the ﬁtted potential energy surface.
To demonstrate this, we constructed a GAP model for
bulk silicon using a database of conﬁgurations with randomly displaced atoms in randomly distorted unit cells,
containing two atoms. Figure 15 shows the elastic constants of the GAP ﬁts as a function of the angular band
limit for SOAP and the SO(4) bispectrum descriptor
(which performed the best in our reconstruction and cluster PES tests compared to the other descriptors). In case
of the bispectrum, the elastic constants of the model improve up to 2jmax = 8, but then deteriorate dramatically,
irrespective of the database size. SOAP does not show
this behaviour, and leads to reasonable elastic constants
using the smaller database, and is already well converged
for lmax = 6 using the larger database. Given the view
of SOAP as an SO(3) power spectrum, it appears that
the beneﬁt comes from the combination of building the
Database size
RMS force error (eV/˚A)
FIG. 14. Quality of GAP potentials constructed using diﬀerent descriptors, as a function of the size of the database used
for the ﬁt, with all conﬁgurations drawn from Sin clusters
with 3 ≤n ≤19. The angular band limit was lmax = 12 in all
cases (equivalent to 2jmax = 12 for the SO(4) bispectrum).
atomic neighbourhood density from smooth Gaussians
and using the dot product kernel — both directly linked
to the construction of SOAP as a smooth similarity measure — in contrast to using Dirac-delta functions for the
density and a squared exponential kernel for the other
descriptors.
Ndata = 500
Ndata = 100
lmax / 2jmax
SOAP SO(4) Bispectrum
FIG. 15. Elastic constants C11, C12 and C0
44 of GAP models
for bulk silicon using the SO(4) bispectrum and SOAP, as a
function of the angular band limit lmax (for SOAP) or jmax
(for the bispectrum). The top and bottom panels correspond
to a database size of 100 and 500 conﬁgurations. The dashed
line indicates exact values of the tight-binding model which
was used to generate the database.
TABLE III. Quality of the GAP potential energy surface using
diﬀerent descriptors and angular band limits, as measured
by the RMS energy and force errors.
The ﬁtting database
contained 8000 atomic neighbourhoods in Sin clusters with
3 ≤n ≤19. The units of the RMS errors of the energy and
force are meV/atom and eV/˚A, respectively.
Angular band limit
α = 2, ζ = 4
CONCLUSION
In this paper we discussed a number of approaches to
representing atomic neighbour environments within a ﬁnite cutoﬀsuch that the representation is a continuous
and diﬀerentiable function of the atomic positions and
is invariant to global rotations, reﬂections, and permutations of atoms. We showed that the Steinhardt bondorder parameters are equivalent to certain elements of
the SO(3) angular power spectrum and bispectrum. To
incorporate radial information, and therefore provide a
full description of the atomic neighbour environment, we
reviewed the construction of the SO(4) power spectrum
and bispectrum as an alternative to introducing explicit
radial basis functions.
We also demonstrated that all
these constructs, as well as the descriptors suggested by
Parrinello and Behler, use very similar terms and form
part of a general family that is based on the bond angles.
In practice, when the expansion is truncated, the faithfulness of the descriptors decreases as the number of neighbours increases, leading to a tuneable trade-oﬀbetween
the size of the descriptor and its faithfulness in terms of
its ability to represent the atomic environment uniquely
up to symmetries. With typically used parameters, however, the faithfulness of the descriptors are quite diﬀerent,
and all descriptors fail for Si clusters with more than 13
atoms. In order to improve on this, we therefore introduced a similarity measure between atomic neighbour environments called Smooth Overlap of Atomic Positions,
which does not suﬀer from these diﬃculties and demonstrates excellent faithfulness for any number of neighbours. We also tested the performance of the descriptors
for ﬁtting models of small silicon clusters and bulk silicon
crystal and found that SOAP leads to a more accurate
and much more robust potential energy surface.
ACKNOWLEDGMENTS
APB gratefully acknowledges funding from Magdalene
College, Cambridge.
Figures 8 and 10 were generated
using AtomEye60. This work was partly supported by
the European Framework Programme 
under grant agreement no. 229205.
∗ 
1 C. J. Pickard and R. J. Needs, Nature Materials 7, 775
2 D. J. Wales, Energy Landscapes, Applications to Clusters,
Biomolecules and Glasses .
4 M. Segall, J. Comput. Aided Mol. Des. 26, 121 .
5 J. Behler and M. Parrinello, Phys. Rev. Lett. 98, 146401
6 L. Raﬀ, R. Komanduri, M. Hagan, and S. Bukkapatnam,
Neural Networks in Chemical Reaction Dynamics .
7 B. Braams and J. Bowman, Int. Rev. in Phys. Chem. 28,
577 .
8 A. P. Bart´ok, M. C. Payne, R. Kondor,
and G. Cs´anyi,
Phys. Rev. Lett. 104, 136403 .
9 D. Tromans, Hydrometallurgy 48, 327 .
10 J. Ischtwan and M. A. Collins, J. Chem. Phys. 100, 8080
11 M. A. Collins, Theor. Chem. Acc. 108, 313 .
12 T.-S. Ho, T. Hollebeek, H. Rabitz, L. B. Harding,
G. C. Schatz, J. Chem. Phys. 105, 10472 .
13 G. G. Maisuradze, D. L. Thompson, A. F. Wagner,
M. Minkoﬀ, J. Chem. Phys. 119, 10002 .
14 Y. Guo, A. Kawano, D. L. Thompson, A. F. Wagner, and
M. Minkoﬀ, J. Chem. Phys. 121, 5091 .
15 X. Huang, B. J. Braams, S. Carter, and J. M. Bowman,
J. Am. Chem. Soc. 126, 5042 .
16 X. Zhang, B. J. Braams,
and J. M. Bowman, J. Chem.
Phys. 124, 021104 .
17 T. B. Blank, S. D. Brown, A. W. Calhoun,
Doren, J. Chem. Phys. 103, 4129 .
18 H. Gassner, M. Probst, A. Lauenstein, and K. Hermansson, J. Phys. Chem. A 102, 4596 .
19 S. Lorenz, A. Groß, and M. Scheﬄer, Chem. Phys. Lett.
395, 210 .
20 A. Brown, B. Braams, K. Christoﬀel, Z. Jin, and J. Bowman, J. Chem. Phys. 119, 8790 .
21 X. Huang, B. J. Braams,
and J. M. Bowman, J. Chem.
Phys. 122, 44308 .
22 S. Manzhos and T. Carrington, J. Chem. Phys. 125,
194105 .
23 S. Manzhos, X. Wang, R. Dawes,
and T. Carrington, J.
Phys. Chem. A 110, 5295 .
24 C. Handley and P. Popelier, Journal of Chemical Theory
and Computation 5, 1474 .
25 H. Partridge and D. W. Schwenke, J. Chem. Phys. 106
26 R. H. Tipping and A. Forbes, J. Mol. Spectrosc. 39, 65
27 W. Cencek, K. Szalewicz, C. Leforestier, R. v. Harrevelt,
and A. v. d. Avoird, Phys. Chem. Chem. Phys. 10 .
28 E. Sanville, A. Bholoa, R. Smith,
and S. D. Kenny, J.
Phys.: Condens. Matter 20, 285219 .
29 M. Rupp, A. Tkatchenko, K.-R. M¨uller,
and O. A. von
Lilienfeld, Phys. Rev. Lett. 108, 058301 .
30 J. Behler, R. Martoˇn´ak, D. Donadio,
and M. Parrinello,
Phys. Rev. Lett. 100, 185501 .
31 H. Eshet, R. Khaliullin, T. K¨uhne, J. Behler, and M. Parrinello, Phys. Rev. Lett. 108, 115701 .
32 N. Artrith, T. Morawietz, and J. Behler, Phys. Rev. B 83,
153101 .
33 T. Morawietz, V. Sharma, and J. Behler, J. Chem. Phys.
136, 064103 .
34 P. Steinhardt, D. Nelson,
and M. Ronchetti, Phys. Rev.
B 28, 784 .
35 R. Kondor, “A novel set of rotationally and translationally invariant features for images based on the noncommutative bispectrum,” , arxiv:cs/0701127.
36 J. Behler, J. Chem. Phys. 134, 074106 .
37 C. E. R. Williams and C. K. I, Gaussian Processes for
Machine Learning .
38 D. Mackay, Information Theory, Inference, and Learning
Algorithms .
39 R. M. Neal, Bayesian Learning for Neural Networks, Ph.D.
thesis, Department of Computer Science, University of
Toronto .
40 H. Weyl, The Classical Groups, Their Invariants and Representations .
Swamidass,
L. Ralaivola, and P. Baldi, Bioinformatics 21, i359 .
42 M. Valle and A. Oganov, Acta Cryst. A66, 507 .
43 D. A. Varshalovich, A. N. Moskalev, and V. K. Khersonskii, Quantum theory of angular momentum .
44 J. P. K. Doye, M. A. Miller,
and D. J. Wales, J. Chem.
Phys. 110, 6896 .
45 L. B. P´artay, A. P. Bart´ok, and G. Cs´anyi, J. Phys. Chem.
B 114, 10502 .
46 C. Chakravarty and R. M. Lynden-Bell, J. Chem. Phys.
113, 9239 .
47 R. D. Mountain and A. C. Brown, J. Chem. Phys. 80, 2730
48 J. Duijneveldt and D. Frenkel, J. Chem. Phys. 96, 4655
49 E. R. Hern´andez and J. ´I˜niguez, Phys. Rev. Lett. 98,
055501 .
50 A. van Blaaderen and P. Wiltzius, Science 270, 1177
51 R. Biswas and D. Hamann, Phys. Rev. B 36, 6434 .
52 R. Kakarala, Triple correlation on groups, Ph.D. thesis,
Department of Mathematics, UC Irvine .
53 H. Maschke, Math. Ann. 50, 492 (1898).
54 C. D. Taylor, Phys. Rev. B 80, 024104 .
55 A. V. Meremianin, J. Phys. A: Math. Gen. 39, 3099 .
56 M. A. Caprio, K. D. Sviratcheva,
and A. E. McCoy, J.
Math. Phys. 51, 093518 .
57 N. Artrith and J. Behler, Phys. Rev. B 85, 045439 .
58 K. Kaufmann and W. Baumeister, Journal of Physics B:
Atomic, Molecular and Optical Physics 22, 1 .
59 D. Porezag, T. Frauenheim, T. K¨ohler, G. Seifert,
R. Kaschner, Phys. Rev. B 51, 12947 .
60 J. Li, Modell. Simul. Mater. Sci. Eng. 11, 173 .