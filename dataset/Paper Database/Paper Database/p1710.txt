Received January 17, 2021, accepted February 25, 2021, date of publication March 4, 2021, date of current version March 16, 2021.
Digital Object Identifier 10.1109/ACCESS.2021.3064084
Improving the Prediction of Heart Failure
Patients’ Survival Using SMOTE and
Effective Data Mining Techniques
ABID ISHAQ1, SAIMA SADIQ
1, MUHAMMAD UMER
1,4, SALEEM ULLAH
SEYEDALI MIRJALILI2,3,5, (Senior Member, IEEE), VAIBHAV RUPAPARA
AND MICHELE NAPPI
7, (Senior Member, IEEE)
1Department of Computer Science, Khwaja Fareed University of Engineering and Information Technology, Rahim Yar Khan 64200, Pakistan
2Center for Artiﬁcial Intelligence Research and Optimization, Torrens University Australia, Brisbane, QLD 4006, Australia
3Yonsei Frontier Lab, Yonsei University, Seoul 03722, South Korea
4Department of Computer Science and Information Technology, The Islamia University of Bahawalpur, Bahawalpur 63100, Pakistan
5King Abdulaziz University, Jeddah 21589, Saudi Arabia
6School of Computing and Information Sciences, Florida International University, Miami, FL 33199, USA
7Department of Computer Science, University of Salerno, 84084 Fisciano, Italy
Corresponding authors: Vaibhav Rupapara ( ) and Michele Nappi ( )
This work was supported by the Department of Computer Science, Khwaja Fareed University of Engineering and Information Technology,
Rahim Yar Khan, Pakistan.
ABSTRACT Cardiovascular disease is a substantial cause of mortality and morbidity in the world. In clinical
data analytics, it is a great challenge to predict heart disease survivor. Data mining transforms huge amounts
of raw data generated by the health industry into useful information that can help in making informed
decisions. Various studies proved that signiﬁcant features play a key role in improving performance of
machine learning models. This study analyzes the heart failure survivors from the dataset of 299 patients
admitted in hospital. The aim is to ﬁnd signiﬁcant features and effective data mining techniques that can
boost the accuracy of cardiovascular patient’s survivor prediction. To predict patient’s survival, this study
employs nine classiﬁcation models: Decision Tree (DT), Adaptive boosting classiﬁer (AdaBoost), Logistic
Regression (LR), Stochastic Gradient classiﬁer (SGD), Random Forest (RF), Gradient Boosting classiﬁer
(GBM), Extra Tree Classiﬁer (ETC), Gaussian Naive Bayes classiﬁer (G-NB) and Support Vector Machine
(SVM). The imbalance class problem is handled by Synthetic Minority Oversampling Technique (SMOTE).
Furthermore, machine learning models are trained on the highest ranked features selected by RF. The results
are compared with those provided by machine learning algorithms using full set of features. Experimental
results demonstrate that ETC outperforms other models and achieves 0.9262 accuracy value with SMOTE
in prediction of heart patient’s survival.
INDEX TERMS Data mining, heart disease classiﬁcation, machine learning, cardiovascular disease, feature
selection, SMOTE.
I. INTRODUCTION
According to WHO, Heart Diseases are a leading cause of
death worldwide . It is quite difﬁcult to identify the cardiovascular disease (CVD) because of some contributory factors
which contribute to CVD like high blood pressure, cholesterol level, diabetics, abnormal pulse rate, and many other
factors . Sometimes CVD symptoms may vary for different
genders. For example, a male patient is more likely to have
The associate editor coordinating the review of this manuscript and
approving it for publication was Ramesh Babu N
chest pain while a female patient has some other symptoms
with chest pain like chest discomfort: such as nausea, extreme
fatigue, and shortness of breath . Researchers have been
exploring a wide range of techniques to predict heart diseases
but the disease prediction at an early stage is not very efﬁcient
due to many factors,including but not limited to complexity,
execution time, and accuracy of the approach . As such,
proper treatment and diagnosis can save many lives .
One American dies every 36 seconds due to CVD .
More than .665 million people die due to heart disease which
1 in every 4 deaths . Cardiovascular disease costs a lot
VOLUME 9, 2021
This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see 
A. Ishaq et al.: Improving the Prediction of Heart Failure Patients’ Survival
to the US healthcare system. In the years 2014 and 2015,
it cost about $219 billion per year in terms of healthcare
services, medicine, and lost productivity due to death .
Early diagnosis can also help to prevent heart failure which
can lead to the death of a person. Angiography is considered
as the most precise and accurate method for the prediction of
cardiac artery disease (CAD) , but it is very costly which
makes it less accessible to low-income families.
A number of factors such as blood pressure, cholesterol,
creatine, etc., affect heart health, so it makes it difﬁcult to
diagnose. The authors in analyzed different factors that
cause heart disease and identiﬁed controllable factors such
as alcohol usage, smoking, diabetics, high cholesterol, and
limited physical activity. In the modern era, electronic health
records (EHRs) are also helpful for clinical and research
purposes . The physical examination might have some
errors and in the case of heart disease, these minor errors
can cost a life in the future. Machine learning-based expert
systems effectively diagnose CVD and as a result death ratio
is reduced .
Data mining plays an immense role in extracting useful
information from big data. It is widely used in almost every
ﬁeld of life like medicine, engineering, business, and education. Data mining is used to explore the data to extract the hidden crucial decision making information from the collection
of the past repository for future. A variety of machine learning
algorithms have been used to understand the complexity and
non-linear interaction between different factors by decreasing
the error in prediction and factual outcomes . Due to
ever increasing medical data, we need to leverage on machine
learning algorithms to assist medical healthcare professionals
in analyzing data and making accurate and precise diagnostic
decisions. In medical data mining, different classiﬁcation
algorithms are used to predict the CVD in patients and death
predictions due to the heart attack .
Ahmad et al. released a dataset consisting of medical
records of heart patients having heart failure previously collected at Institute of Cardiology and Allied hospital Faisalabad, Pakistan. Authors predicted mortality rate by applying
Cox regression. They also highlighted the patterns of survival
using Kaplan-Meier Plots. It is notable that the have made
the dataset publicly available for the scientiﬁc community.
Subsequently, Zahid et al. explored the same dataset
and proposed two different gender-based models to predict
mortality. Afterwards, Chicco and Jurman predicted performance of machine learning using only two features of
the same dataset. Even though aforementioned researchers
showed interesting results by applying standard statistical
techniques, such methods are inefﬁcient for large-scale datasets leaving room for other machine learning algorithms.
This motivated our attempts to help healthcare professionals by developing machine learning techniques in the
diagnosis of CVD patients’ survival. We employed nine
machine learning models: Decision Tree (DT) , Adaptive Boosting model (AdaBoost) , Logistic Regression (LR) , Stochastic Gradient Descent (SGD) ,
Forest (RF) ,
(GBM) , Extra Tree Classiﬁer (ETC) , Gaussian
Naive Bayes (G-NB) and Support Vector Machine
(SVM) . Synthetic Minority Oversampling Technique
(SMOTE) is applied to handle class-imbalance problem. This
study contributes to the literature in the following areas:
• Designed an effective decision support system that can
effectively diagnose the survival of heart failure patients.
• Performance
tree-based,
regression-based,
statistical-based models is compared using SMOTE
technique in predicting survival of heart patients.
• To investigate the major risk factors, signiﬁcant features
are identiﬁed from the dataset that also affect the performance of the machine learning algorithm.
The rest of the paper organised as follows: Section II
describes the heart related work that gives a brief description
of related literature. Section III describes the dataset, preprocessing and visualisation of data to ﬁnd the hidden pattern
that is present in the dataset. It also describes the different
algorithms used in this research. Section IV describes the
discussion and analysis of the result. Conclusion and future
work is presented in section V.
II. RELATED WORK
Data mining with the help of machine learning is very useful
for solving different kinds of problems. In medical data mining, healthcare data is difﬁcult to be manually handled as it
has vast data sources. Advancement in artiﬁcial intelligence
also inducted precise and accurate systems for the medical
application while dealing with sensitive medical data .
Heart disease is a leading cause of death even in developed
areas . Machine learning models have been widely used
in identifying risks at early stages of heart disease. Smoking,
age, diabetes and hypertension are considered as risk factors
for heart disease .
Muthukaruppan and Er proposed a Particle Swarm
Optimization (PSO)-based fuzzy expert system for the detection of CVD. Rules were extracted from the decision tree
and then converted into fuzzy rules. They have achieved
93.27% accuracy by the fuzzy expert system. In their work,
a small number of rules were extracted on the small-size
dataset. Alizadehsani et al. applied an ensemble-based
learning approach. In their research, they used the dataset
which was obtained from the Rajaie Cardiovascular Medical and Research Centre and comprises of 303 instances.
Authors used the begging C45 ensemble learning approach
for CVD prediction. They have achieved 68.96% accuracy for
diagnosis of stenosis in the Right Coronary Artery (RCA),
61.46% accuracy in Left Circumﬂex (LCX), and 79.54%
accuracy in Left Anterior Descending (LAD). Another group
of researchers improved the results by applying the SVM
model and achieved 80.50% accuracy for RCA, 86.14% accuracy for LAD and 83.17% accuracy for LCX .
Manogaran et al. employed Multiple Kernel Learning (MKL) with Adaptive Neuro-Fuzzy Inference System
(ANFIS) for the diagnosis of heart disease using the KEGG
VOLUME 9, 2021
A. Ishaq et al.: Improving the Prediction of Heart Failure Patients’ Survival
metabolic reaction network dataset and achieved robust
results. In , Manogaran et al. studied different kinds of
heart diseases. They proposed an ensemble learning framework of different neural network models and a method of
aggregating random under-sampling. To enhance the performance of the classiﬁcation algorithms they used preprocessing steps with feature selection. They used different
kinds of unidirectional and bidirectional neural networks
models and the result proved that the ensemble classiﬁers
with BiGRU or BiLSTM with a CNN model outperformed.
Tama et al. proposed the two-tier ensemble model in
which some classiﬁers are exploited as base classiﬁers of
another ensemble. The proposed stacked architecture is built
by blending the class labels prediction of Gradient Boosting
Machine (GBM), Random Forest (RF), and Extreme Gradient Boosting (XGBoost). Their proposed detection model is
evaluated on four different kinds of datasets. They also used
particle swarm optimization-based feature selection techniques. Their proposed model performed better with respect
to the 10-fold cross-validation. Authors only considered the
stacking of tree-based models. Other regression-based and
statistical-based could be tested to improve model results.
Melillo et al. proposed an automatic classiﬁer for the
patients with high risk which separates them from the lowrisk patients. In their study classiﬁcation and regression tree
(CART) performed better with 93.3% sensitivity and 63.5%
speciﬁcity. They analyzed only 12 low-risk patients and 34
high-risk patients. A bigger dataset needs to be explored to
test the effectiveness of their proposed approach.
Guidi et al. scrutinized the clinical support system
(CDSS) for the analysis of heart failure. They used different
machine learning classiﬁers in their research and compared
their performance. With 87.6% accuracy, random forest, and
CART performed best.
Parthiban and Srivatsa research focused on the patient
who had heart issues with diabetes. They used different kinds
of predictive features such as blood pressure, blood sugar, and
age. They achieved 94.60% accuracy by the SVM classiﬁer.
Dataset was imbalanced and the authors did not use any
approach to handle this problem. Al Rahhal et al. utilized
a deep neural network (DNN) model for the classiﬁcation of
ECG signals to study the top set of features.They allowed
expert interaction at each iteration during training which can
cause biases.
Shah et al. proposed a system to study different
conditions that can affect the heart and primary factors for
the deaths. Different supervised machine learning algorithms
were used such as Decision Tree (DT), Naïve Bayes (NB), RF,
and KNN. Out of 76 attributes, only 14 attributes were used
because the accurate and efﬁcient system with less number
of attributes is their research goal. Out of four supervised
machine learning classiﬁers KNN outperformed. Ensemble
approaches could be applied to improve the classiﬁcation
results. Mohan et al. proposed a hybrid model for heart
disease prediction. Authors also proposed a novel feature
TABLE 1. Dataset specifications.
selection method to improve training of Machine Learning
models and achieved 88% accuracy. More feature engineering techniques and machine learning models could be analyzed to improve performance. Geweid and Abdallah 
designed an optimized and improved SVM model using
ECG-signals for heart disease identiﬁcation. More advanced
machine learning models with the combination of signal
processing applications need to be explored.
A comprehensive literature survey showed that existing
approaches performed well in the prediction of heart disease
on different datasets. However, different optimization techniques have been used to improve several measures such as
accuracy, precision, and recall. In this research, the main goal
is to highlight a comparison of different machine learning
techniques to select the most suitable method for heart disease survival prediction. To the best of our knowledge, it is
the ﬁrst attempt to analyze all features of the dataset 
using machine learning models in predicting heart patient’s
III. MATERIALS AND METHODS
A. DATASET DESCRIPTION
In this research, the Heart-failure-clinical-records-dataset
 is derived from the UCI machine learning repository
 . The dataset contains the medical records of 299 patients
who had heart problems, collecting during the follow-up
period where every patient proﬁle has 13 clinical features.
Out of 299 records, 194 are men, and 105 are women. The
ages of all the patients are above 40 years. In target class, 1
is for deceased and 0 is for alive. All 299 patients who had
left ventricular systolic dysfunction and had heart failure in
the past were in the class III or IV of NYHA. The overview
of the data set is given in the Table. 1.
VOLUME 9, 2021
A. Ishaq et al.: Improving the Prediction of Heart Failure Patients’ Survival
FIGURE 1. Important features by RF classifier.
B. FEATURE IMPORTANCE
Data visualization assist with explaining the hidden patterns that present inside the dataset. It helps to qualitatively
get more information about the dataset by visualizing the
attributes characteristics. RF was used to employ feature
ranking. Figure 1 shows the feature importance predicted
by the RF. RF clearly identiﬁes Time, Creatinine, Ejection
fraction, Age, Platelets, CPK and Sodium as the most relevant
C. CLASSIFIERS
Classiﬁcation, a supervised machine learning model is utilized for predicting the result from the data. This work
proposes a technique for the prediction of heart disease
using classiﬁcation methods, and to improve the classiﬁcation accuracy using an ensemble of classiﬁers. The data has
been divided into a training set and a test set, and individual
classiﬁers are trained using a train set. The efﬁciency of the
classiﬁers is tested with the test data. The details of several
machine learning classiﬁers is discussed in Table 2.
D. SYNTHETIC MINORITY OVERSAMPLING TECHNIQUE
SMOTE technique is an oversampling method and has been
widely used to deal with class imbalanced data in medicine
 . SMOTE increases the number of data instances by
generating random synthetic data of minority class from its
nearest neighbours using Euclidean distance. New instances
become similar to the original data because they are generated
on the basis of original features . SMOTE is not the
best option in dealing with high-dimensional data as it can
create additional noise. In this study, new training dataset is
generated using SMOTE technique. SMOTE increased data
samples from 97 instances to 300 instances for each class.
E. EVALUATION MATRICES
There are some performance evaluation methods for the
machine learning models. The blend of different evaluation tools is expected to endorse the development
of analytical research . In this research, four basic
FIGURE 2. Flowchart of proposed heart failure patient’s survival
prediction framework.
(accuracy,
precision,
examined for the difference in machine learning-based
algorithms.
Confusion matrix helps us to calculate all four metrics.
The elements of the confusion matrix are true positive (TP),
true negative (TN), false positive (FP) and false negative
(FN). If data is related to the medical false negative is the
VOLUME 9, 2021
A. Ishaq et al.: Improving the Prediction of Heart Failure Patients’ Survival
TABLE 2. Machine learning models.
TABLE 3. Performance evaluation measures.
most critical prediction. The measures of the performance are
given in Table 3.
IV. ANALYSIS AND DISCUSSION OF RESULTS
In this section, experimental design and results of all experiments for heart patients’ survival prediction are discussed.
Firstly, we present the results with full set of features followed by the results with the signiﬁcant set of features. The
dataset, containing 13 features about body features, clinical
features and lifestyle features. Some of these features are
binary such as anaemia, diabetes, blood pressure, smoking
and Gender. Death event feature is taken as a target class in
binary classiﬁcation task which tells if a patient is survived
or died before 130 days of follow up period. Speciﬁcation of
the dataset is presented in Table 1. SMOTE is applied to make
dataset balanced. Machine learning models have been trained
on the balanced dataset and evaluated on accuracy, precision,
recall and F-Score. Flowchart of the proposed methodology
is presented in Figure 2.
A. EXPERIMENTAL DESIGN
Supervised machine learning models have been conducted
in order to analyze the performance of the models. Data
has been split into the train set and test set as 70:30 ratio.
This ratio is practiced in several literature’s for classiﬁcation
tasks and help to avoid overﬁtting . Performances of the
machine learning classiﬁers are tested using different performance evaluation metrics. All the experiments have been
conducted in a python environment using different libraries
on an 2 GB Dell PowerEdge T430 graphical processing
unit on 2x Intel Xeon 8 Cores running at 2.4Ghz machine
which is equipped with 32 GB DDR4 Random Access
Memory (RAM).
VOLUME 9, 2021
A. Ishaq et al.: Improving the Prediction of Heart Failure Patients’ Survival
FIGURE 3. Performance of classifiers on full set of features.
B. EXPERIMENTAL RESULTS ON FULL SET OF FEATURES
A comparative analysis of supervised machine learning classiﬁers has been performed on full set of features of heartfailure-clinical-record-dataset. Some classiﬁers showed good
results on evaluation metrics while some showed poor performance. This work has applied tree-based, regression based,
and statistical-based models for the prediction of heart failure survival. Tree-based ensemble models include DT, RF
and ETC. Tree-based boosting models AdaBoost and GBM.
Regression-based include LR and SGD. and Statistical-based
include G-NB and SVM. Table 4 presents the performance
evaluation of machine learning models on full set of features. As per the results in Table 4, the LR classiﬁer has
achieved good results with 0.8556 accuracy, 0.85 precision,
0.86 recall and 0.85 F-Score. SVM and G-NB were second
good classiﬁers with 0.8667 accuracy and 0.86 F-Score. RF, a
tree-based classiﬁer, outperformed among all nine classiﬁers
using all features and obtained 0.8889 accuracy 0.89 value for
precision, recall and F-Score.
The worst classiﬁer was SGD for heart failure survival
prediction with 0.6667 accuracy, 0.62 precision, 0.67 recall
and 0.63 F-Score. Performance comparison of all models is
presented in Figure 3.
C. EXPERIMENTAL RESULTS WITH SMOTE
SMOTE is a powerful solution to the class imbalance problem
and have shown robust results in various domains. SMOTE
algorithm adds synthetic data to the minority class to make
a balanced dataset. Table 5 shows the result of machine
learning classiﬁers using SMOTE technique on all 13 features of heart-failure-record dataset. From Table 5, it is
clear that performance of tree-based classiﬁers signiﬁcantly
improve with the SMOTE in all evaluation matrices. Performance of DT improved from 0.79 accuracy to 0.8278
TABLE 4. Classification result of all machine learning models using all
features without SMOTE.
accuracy with SMOTE. AdaBoost showed good performance
and obtained 0.8852 accuracy, 0.89 precision, 0.89 recall and
0.89 F-Score with balanced dataset. Similarly RF achieved
0.9180 with accuracy and 0.82 F-Score and improved results
with SMOTE. ETC with full features and SMOTE showed
10% improvement in results as compared to those results
achieved without applying SMOTE. ETC achieved highest
results with 0.9262 accuracy, 0.93 precision, 0.93 recall and
0.93 F-Score. Boosting algorithm build trees by reducing
errors from previously built weak learners. Up-sampling of
the similar data does not show any impact in improving
of results . That is the reason that GBM did not show
any improvement with SMOTE. Performance evaluation of
machine learning models with SMOTE has been shown in
It can be clearly observed that performance of regressionbased (LR and SGD) models and statistical-based (G-NB and
SVM) models have been decreased with SMOTE. SMOTE
performed well with tree-based classiﬁers for the prediction of heart patient’s survival. Accuracy comparison of the
classiﬁers with SMOTE and without SMOTE is presented
in Figure 5.
VOLUME 9, 2021
A. Ishaq et al.: Improving the Prediction of Heart Failure Patients’ Survival
FIGURE 4. Performance of classifiers on full set of features with SMOTE.
TABLE 5. Classification results of all machine learning models using all
features with SMOTE.
D. EXPERIMENTAL RESULTS ON IMPORTANT FEATURES
SELECTED BY RF
In this experiment important features selected by RF are
investigated by machine learning classiﬁers with SMOTE
technique. First classiﬁers were trained and tested by removing least important features identiﬁed by RF. Performance of
the classiﬁers were pretty good by removing last four features
that are: Anaemia, Diabetes, Gender, and Smoking. Further
removal of features started a decrease in performance. Accuracy results by removing four least important features are
presented in Table 6. The accuracy result of LR showed 1%
improvement with 9 signiﬁcant features and achieved 0.8442
accuracy. GBM showed signiﬁcant improvement using 9 signiﬁcant features and showed 4% improvement in accuracy
result and achieved 0.8852 accuracy. Performance comparison of full-set of features with 9 signiﬁcant features identiﬁed
by RF is presented in Figure 6.
E. IMPACT OF SIGNIFICANT FEATURES
Experimental results demonstrated that supervised machine
learning models can efﬁciently predict heart failure patients
TABLE 6. Accuracy of all machine learning models using nine significant
features with SMOTE.
survival. Tree-based algorithms showed good performance on
imbalanced and balanced dataset with SMOTE technique. RF
clearly identiﬁed Time, Creatinine, Ejection fraction, Age,
Platelets, CPK and Sodium as signiﬁcant features as shown in
Figure 1. Results showed that tree-based algorithms outperformed using nine features identiﬁed by RF using SMOTE
technique. This aspect is useful in patient care as doctors can
predict patient’s survival by just analyzing nine signiﬁcant
ETC outperformed other models with 0.9262 accuracy
using nine signiﬁcant features with SMOTE technique for the
prediction of heart patient’s survival. ETC selects a random
subset of features like RF for node splitting. It is different
from RF in a way that it makes trees from complete data
samples by selecting cut points for nodes randomly. While
RF selects the cut point for the node using local samples.
Trees of training set labels can be made independent by
setting the value of k as 1 . RF produces constant approximation whereas ETC produces multi-linear approximation.
Such additional randomization in the ensemble smoothed the
decision boundaries and also a reason for better performance
VOLUME 9, 2021
A. Ishaq et al.: Improving the Prediction of Heart Failure Patients’ Survival
FIGURE 5. Accuracy comparison of classifiers with SMOTE and without SMOTE.
FIGURE 6. Accuracy comparison of classifiers with SMOTE using full-set of features and 9 features
identified by RF.
than RF. also showed that ET outperformed RF in terms
of accuracy.
V. CONCLUSION
Processing raw health data of heart information using
machine learning algorithms will help in saving the lives
of heart patients. By analyzing factors contributing to heart
failure, mortality rate can be controlled by adopting preventive measures. In this study, an effective and efﬁcient
machine learning based technique is suggested for the prediction of heart patients’ survival. Machine learning techniques
include LR, AdaBoost,RF, GBM, G-NB and SVM. SMOTE
is applied to deal class imbalance problem. Furthermore,
RF employed feature ranking. According to RF, most
signiﬁcant features are: Time, Creatinine, Ejection fraction,
Age, Platelets, CPK and Sodium. Performance of machine
learning models are compared on a full set of features and
selected features from Heart-failure-clinical-records-dataset.
Thus experimental results proved that tree-based with feature
selection are highly effective in achieving highest accuracy.
SMOTE technique signiﬁcantly improved performance of
tree-based classiﬁers in predicting heart patient’s survival.
ETC with SMOTE showed highest result in all evaluation
measures and achieved 0.9262 accuracy, 0.93 precision, 0.93
recall and 0.93 F-Score.
This work has the potential to improve the health care
system, and become a useful tool for health care providers in
predicting survival of heart failure. It will also help physicians
in understanding that if a patient of heart failure will survive,
they can focus on major risk factors. The future work of
this research can be performed with multiple combinations
of machine learning models to beneﬁt from their advantages
VOLUME 9, 2021
A. Ishaq et al.: Improving the Prediction of Heart Failure Patients’ Survival
combined. To improve the performance of machine learning
models, better feature selection techniques can be devised. In
this case, meta-heuristics can be used due to NP-hard nature
of feature selection problems.