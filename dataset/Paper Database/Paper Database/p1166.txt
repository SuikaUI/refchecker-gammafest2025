Toward Causal Inference With Interference
Michael G. Hudgens and M. Elizabeth Halloran
Michael G. Hudgens is Research Associate Professor, Department of Biostatistics, University of
North Carolina, Chapel Hill, NC 27599 (E-mail: ). M. Elizabeth Halloran is
Professor, Program in Biostatistics and Biomathematics, Fred Hutchinson Cancer Research Center,
and Department of Biostatistics, University of Washington, Seattle, WA 98185 (E-mail:
 )
A fundamental assumption usually made in causal inference is that of no interference between
individuals (or units); that is, the potential outcomes of one individual are assumed to be unaffected
by the treatment assignment of other individuals. However, in many settings, this assumption
obviously does not hold. For example, in the dependent happenings of infectious diseases, whether
one person becomes infected depends on who else in the population is vaccinated. In this article, we
consider a population of groups of individuals where interference is possible between individuals
within the same group. We propose estimands for direct, indirect, total, and overall causal effects of
treatment strategies in this setting. Relations among the estimands are established; for example, the
total causal effect is shown to equal the sum of direct and indirect causal effects. Using an
experimental design with a two-stage randomization procedure (first at the group level, then at the
individual level within groups), unbiased estimators of the proposed estimands are presented.
Variances of the estimators are also developed. The methodology is illustrated in two different
settings where interference is likely: assessing causal effects of housing vouchers and of vaccines.
Group-randomized trials; Potential outcomes; Stable unit treatment value assumption; SUTVA;
1. INTRODUCTION
1.1 Background and Outline
A fundamental assumption usually made in the potential outcomes approach to causal inference
is that of no interference between individuals , a critical component of the stable
unit treatment value assumption (SUTVA) . Under the no-interference
assumption, the potential outcomes of any individual are assumed to be unaffected by the
treatment assignment of every other individual. However, in many settings, this assumption
obviously does not hold. A classical example is given by the dependent happenings of
infectious diseases , where whether one person becomes infected depends
on who else in the population is vaccinated. In econometrics, a household’s decision whether
to move may be affected by whether their neighbors receive a housing voucher to move . In education, interventions given to certain students may affect other students in the
same class . Sobel and Rosenbaum gave several
other examples where interference is likely. In some settings, interference is a nuisance while
in other settings it creates effects of interest. An example of the former includes agricultural
experiments, where fallow rows between treatment plots can sometimes eliminate interference
NIH Public Access
Author Manuscript
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
 
J Am Stat Assoc. 2008 June ; 103(482): 832–842. doi:10.1198/016214508000000292.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
between plots. An example of the latter includes vaccinating against infectious diseases, where
interference is an inherent result of the biology of transmission and is intrinsically of interest.
The assumption of no interference between individuals is often made without critical
examination. Models not requiring this assumption have been considered in the context of plant
variety evaluation and cross-over trials . However, these methods typically assume a specific interference structure that is local
in either space or time. Without making any such assumptions about the nature of interference,
Struchiner, Halloran, Robins, and Spielman and Halloran and Struchiner 
conceptually defined several different types of causal effects of interventions that are possible
in the presence of interference, namely, direct, indirect, total, and overall effects. To estimate
the latter three effects, they noted one needs a population of groups as in group-randomized
studies . Several vaccination studies have been conducted or analyzed with the
intent to estimate certain of these effects .
Halloran and Struchiner delineated many of the complications of using potential
outcomes to define causal estimands for the different types of effects possible in the presence
of interference. They used Rubin’s suggestion for a general notation in the
presence of interference to define individual direct, indirect, total, and overall effects by letting
the potential outcomes for any individual depend on the vector of treatment assignments to the
other individuals in the population. However, they found this approach impracticable because
the number of possible potential outcomes becomes unwieldy for any reasonably sized
population. More recently, Sobel proposed causal estimands for assessing housing
voucher effects defined by averaging causal effects over all possible treatment assignments for
a particular voucher allocation strategy compared to a benchmark allocation wherein all
households receive no voucher. Rosenbaum developed nonparametric tests and
confidence intervals for assessing treatment effect in the presence of interference.
In this article, we consider a population of groups of individuals where interference is possible
between individuals within the same group. We propose causal estimands for direct, indirect,
total, and overall causal effects of treatment assignment strategies based on Sobel’s approach
of averaging over all possible treatment assignments (Sec. 3). Relations among the estimands
are established and inference concerning the estimands is considered (Sec. 4). Using an
experimental design with a two-stage randomization procedure (the first at the group level, the
second at the individual level within groups), unbiased estimators of the proposed estimands
are presented. Estimating the variance of the estimators is also considered. The methodology
is illustrated in two different settings where interference is likely: assessing causal effects of
housing vouchers and of vaccines (Sec. 5). Proofs are given in the Appendix. We begin with
an example to motivate the development of the rest of the article.
1.2 Motivating Example
In this section, we consider data from an individually randomized, placebo-controlled trial of
killed oral cholera vaccines to illustrate the direct, indirect, total, and overall effects as defined
by Halloran and Struchiner . Table 1 presents data from a reanalysis of this trial where
the interest was in determining whether the level of vaccine coverage in a residential area,
called a bari, was related to the incidence of cholera in individual vaccine recipients or placebo
recipients residing in the bari . The target population was divided into groups
by level of vaccine coverage. For illustration, we consider the groups with more than 50% and
less than 28% coverage, which we denote as groups A and B.
The effects of vaccination can be estimated based on differences in the incidence of cholera
during the first year of follow-up of the trial. The direct effects are estimated by comparing the
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
incidence (risk per 1,000 population) between vaccinated individuals and unvaccinated
individuals within each group. For example, the estimated direct effect in group B is 7.01-2.66
= 4.35, suggesting vaccination results in 4.35 fewer cases of cholera per 1,000 individuals per
year. The estimated direct effect in group A is 1.47-1.27 = .20, considerably lower than in
group B. The difference in the two estimates illustrates one of the challenges in making
comparisons directly within groups when interference is present. If an analysis were limited
to group A only, the evidence would suggest that the vaccine has little effect.
The indirect effects of vaccination are those effects due to the level of coverage. They can be
estimated by comparing the outcomes in the unvaccinated in the two groups or the outcomes
in the vaccinated in the two groups. For instance, the estimated indirect effect in the
unvaccinated is 7.01 - 1.47 = 5.54. Note this estimate is greater than the estimated direct effect
in either of the groups, highlighting the importance of looking beyond direct effects in the
presence of interference. Based on similar analyses, Ali et al. concluded that the vaccines
provide significant indirect protection to nonvaccinated individuals.
Total and overall effects provide summary measures that combine direct and indirect effects.
The total effect of vaccination is the effect of being vaccinated in the group with higher
coverage (A) compared to not being vaccinated in the group with lower coverage (B). The
estimated total effect (B - A) is 7.01-1.27 = 5.74. Note the total effect (B - A) estimate equals
the direct effect estimate in group A plus the indirect effect estimate in the unvaccinated (B -
A). The overall effect is the average effect of being in the group with higher coverage compared
to being in the group with lower coverage. The overall effect can be estimated by the difference
in incidence between the two groups, that is, 35/8,479 - 25/18,623 = 2.79/1,000.
2. PRELIMINARIES
2.1 Potential Outcomes
Suppose there are N > 1 groups of individuals [or blocks of units using Rosenbaum’s 
terminology]. For i = 1, . . . , N, let ni denote the number of individuals in group i and let Zi ≡
(Zi1, . . . , Zini) denote the treatments those ni individuals receive. We assume throughout that
assignment of an individual to a particular treatment is equivalent to receipt of that treatment
that is, there is perfect compliance. Assume Zij is a dichotomous random variable having values
0 or 1 such that Zi can take on 2ni possible values. Let Zi(j) denote the ni - 1 subvector of Zi
with the j th entry deleted. The vector Zi will be referred to as an intervention or treatment
program, to distinguish it from the individual treatment Zij. Let zi and zij denote possible values
of Zi and Zi and Zij. Define Rj to be the set of vectors of possible treatment programs of length
j for j = 1, 2, . . . ; for example, R2 ≡ {(0, 0), (0, 1), (1, 0), (1, 1)}. Possible values zi of Zi are
elements of Rni. For positive integer n and k ∈ {0, . . . , n}, define
to be the subset of Rn
wherein exactly k individuals receive treatment 1; for example,
Denote the potential outcome of individual j in group i under treatment zi as Yij (zi). Following
the usual approach to causal inference , we assume the Yij (zi)
potential responses are fixed because they do not depend on the realized random assignment
of treatments Zi, whereas the observed responses Yij (Zi) do depend on Zi and, thus, are random
variables. The notation Yij (zi) allows for the possibility that the potential outcome for individual
j may depend on another individual’s treatment assignment in group i; that is, there may be
interference between individuals within a group. Implicit in this notation is the assumption that
the potential outcomes for individuals in group i do not depend on treatment assignments of
individuals in group i’ for i’ ≠ i. In other words, we assume no interference between individuals
in different groups but allow for interference between individuals within the same group
 . This will be a reasonable assumption provided the
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
groups are sufficiently separate (e.g., in space or time). Sobel called this a partial
interference assumption. In the literature of group-randomized studies, violation of no
interference across groups is called contamination.
2.2 Treatment Assignment Mechanisms
Let ψ and ϕ denote parameterizations that govern the distribution of Zi for i = 1, . . . , N. For
example, ψ might correspond to randomly assigning half of individuals in a group to treatment
1 and the other half to treatment 0, while ϕ might correspond to assigning all individuals in a
group to treatment 0. We refer to ψ and ϕ as individual treatment assignment strategies. Our
goal is to assess the causal effects of assigning groups to ψ compared to ϕ.
As is typical of causal inference articles, we use randomization inference whereby the
randomization distribution induced by the experimental design forms the basis for statistical
inference. For the experimental design, we consider a two-stage randomization procedure. In
the first stage, each of the N groups is randomly assigned to either ϕ or ψ. In the second stage,
individuals are randomly assigned treatment conditional on their group’s assignment in the
first stage. For example, in the first stage, half of the N groups might be assigned to an allocation
strategy ϕ and the other half ψ; in the second stage, two-thirds of the individuals within a group
are randomly assigned treatment 1 for groups assigned ϕ, while one-third of the individuals
within a group are randomly assigned treatment 1 for groups assigned ψ. Such a design has
been referred to as splitplot or pseudo-cluster
 randomization and has been proposed for evaluation
of intervention programs in the elderly and vaccine efficacy (see Sec. 5.2).
This design can be employed to answer questions such as: How many infections will be averted
by vaccinating two-thirds of the population compared to only vaccinating one-third of the
population? What proportion of households will move if two-thirds receive vouchers compared
to only one-third receiving vouchers?
Corresponding to the first stage of randomization, let S ≡ (S1, . . . , SN) denote the group
assignments with Si = 1 if the ith group is assigned to ψ and 0 otherwise. Let ν denote the
parameterization that governs the distribution of S and let C ≡ Σi Si denote the number of groups
assigned ψ. Define ν to be a mixed or permutation group assignment strategy if 0 < C < N and Prν (S = s) = C!(N - C)!/N! if
, 0 otherwise. In other words, under a mixed group assignment strategy, a fixed number
C of N groups are assigned ψ, with each of the
possible group assignments receiving
equal probability. Similarly, corresponding to the second stage of randomization, let Ki ≡ Σj
Zij and define ϕ and ψ to be mixed individual group assignment strategies if Ki is fixed given
Si, with 0 < Ki < ni and each of the
possible individual treatment assignments receiving
equal probability.
3. CAUSAL ESTIMANDS
3.1 Average Potential Outcomes
A fundamental problem in causal inference is that, in general, it is not possible to observe more
than one potential outcome for an individual. Faced with this problem, causal estimands are
typically defined in terms of averages of potential outcomes that are identifiable from
observable random variables. Following this approach, we begin by writing the potential
outcomes for individual j in group i under zij = z as
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
for z = 0, 1. Because (1) depends on zi(j), define the individual average potential outcome under
treatment assignment z by
In other words, the individual average potential outcome is the conditional expectation of Yij
(Zi) given Zij = z under assignment strategy ψ. Averaging over individuals, define the group
average potential outcome under treatment assignment z as
Finally, averaging over groups, define the population average potential outcome under
treatment assignment z as
The average potential outcomes discussed previously are defined as functions of both the group
assignment ψ (or ϕ) and the individual treatment assignment z. We can also define average
potential outcomes solely as a function of ψ. For example, define the marginal individual
average potential outcome by
, that is, the average potential
outcome for individual j in group i when group i is assigned ψ. Similarly, define the marginal
group and population average potential outcomes by
In the following sections, causal estimands are defined in terms of these various average
potential outcomes.
3.2 Direct Causal Effects
Halloran and Struchiner defined the direct effect of a treatment on an individual as the
difference between the potential outcome for that individual given treatment compared to the
potential outcome for that individual without treatment, all other things being equal. Formally,
following Halloran and Struchiner , we define the individual direct causal effect of
treatment 0 compared to treatment 1 for individual j in group i by
Next, define the individual average direct causal effect for individual j in group i by
that is, the difference in individual average potential outcomes when zij = 0 and when zij = 1
under ψ. Using Rubin’s terminology, (3) is a marginal causal effect in that a comparison
is being made between expected values of the marginal distributions of Yij (Zi(j), Zij = 0) and
of Yij (Zi(j), Zij = 1). Finally, define the group average direct causal effect by
and the population average direct causal
3.3 Indirect Causal Effects
In contrast to direct effects, an indirect effect describes the effect on an individual of the
treatment received by others in the group. In particular, Halloran and Struchiner defined
the indirect effect of a treatment on an individual as the difference between the potential
outcomes for that individual without treatment when the group (i) receives an intervention
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
program and (ii) receives the benchmark program of no intervention. Similar to Halloran and
Struchiner , we define the individual indirect causal effect of treatment program zi
compared with on individual j in group i by
where is another ni-dimensional vector of individual treatment assignments. (Note does
not denote the transpose of zi.)
Remark—Definition (4) does not restrict either zi or to be the benchmark program of no
intervention; that is, individual indirect causal effects may exist between two different
intervention programs. The same is true for the definitions of individual total and overall causal
Remark—The individual indirect causal effect could be defined analogously for individuals
=1 ; that is, individuals under either treatment may experience indirect effects. This
yields two individual indirect causal effects, which need not be equal. For simplicity, only
indirect effects based on (4) are considered in the rest of this article.
Similar to direct effects, define the individual average indirect causal effect by
. Clearly, if ψ = ϕ, then
; that is, there are no
individual average indirect causal effects. Finally, define the group average indirect causal
and the population average
indirect causal effect as
3.4 Total Causal Effects
Total effects describe both the direct and the indirect effects of a particular treatment
assignment on an individual. Halloran and Struchiner defined the total effect of a
treatment on an individual as the difference between the potential outcomes for that individual
(i) with treatment when the group receives an intervention program and (ii) without treatment
when the group receives no intervention. Following Halloran and Struchiner , we define
the individual total causal effects for individual j in group i as
Define the individual average total causal effect by
, the group
average total causal effect by
population average total causal effect by
Remark—It follows from (2), (4), and (5) that the individual total causal effect is the sum of
individual direct and indirect causal effects, that is,
. Likewise, the total causal effects can be
decomposed as the sum of direct and indirect causal effects at the individual average, group
average, and population average levels, for example,
result formalizes, using a causal framework, models from the vaccine and plant variety
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
evaluation literature, which assume the total effect is the sum of direct and indirect effects
 .
Remark—A few other characteristics of the algebra of causal effects bear mentioning. First,
total causal effects are not commutative; for example,
will not necessarily equal
for ϕ ≠ ψ. However, indirect effects have the property
. Thus, the total causal effects, while not
necessarily equal, are constrained in sum to equal the sum of the direct effects. Also note that
if and only if
is, in the absence of indirect effects, the total effects are commutative if and only if the direct
effects are equal.
3.5 Overall Causal Effect
Halloran and Struchiner defined the overall causal effect to be the average effect of an
intervention program relative to no intervention. We define the individual overall causal
effect of treatment zi compared to treatment for individual j in group i by
. Similarly, for the comparison of ϕ to ψ, define the individual
average overall causal effect by
, the group average overall
causal effect by
, and the population average overall causal effect
3.6 No Interference
The estimands defined previously simplify under the assumption of no interference between
individuals within a group, that is, under the assumption
for any two treatment
programs zi = (zi1, . . . , zini) and
 . Assuming no interference, the potential outcomes for individual j in group
i can be written simply as Yij (0) and Yij (1). In turn, the individual direct causal effect equals
Yij (0) - Yij (1). The corresponding group average direct causal effect becomes
, that is, the usual average causal effect (ACE) estimand. By (4), the
individual indirect causal effect equals 0 for all individuals assuming no-interference.
Similarly, by (5), the individual total causal effect equals the individual direct causal effect.
Likewise, at the group and population average levels, under the no-interference assumption
the indirect causal effect is 0 and the direct causal effect equals the total causal effect. Assuming
no interference also implies the direct, indirect, and total effects do not depend on the treatment
assignment strategies ϕ and ψ, whereas in the presence of interference within a group, they do
in general.
4. INFERENCE
In this section, we consider drawing inference about the estimands defined previously.
Throughout this section, we assume:
Assumption 1. ν, ϕ, and ψ are mixed assignment strategies.
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
In Section 4.1, we present estimators for the estimands defined previously and show they are
unbiased under Assumption 1. In Section 4.2, we consider the variances of these estimators.
4.1 Estimators
Theorem 1—Suppose Si = 1 and let
is the average of observed outcomes for individuals in group i receiving
treatment z under treatment program Zi. Under Assumption 1,
Corollary: Under Assumption 1,
is a conditionally unbiased
estimator of
given Si = 1.
Remark: Unbiased estimators of the group average indirect, total, and overall causal effects
do not exist without further assumptions because the same group is not observed under ϕ and
Theorem 2—For z = 0, 1, let
Assumption 1,
for z = 0.1.
Corollary: Under Assumption 1, unbiased estimators for the population average direct,
indirect, and total causal effects are given by
is defined
analogously to
for z = 0, 1.
Theorem 3—Let
Under Assumption 1,
Corollary: Under Assumption 1, an unbiased estimator of
is given by
is defined analogously to
4.2 Variance Estimators
In general, unbiased estimators of the variances of the estimators discussed previously do not
exist without making further assumptions. For example, consider estimating
under Assumption 1. The estimator
is based on sampling from the
set of potential outcomes
for some fixed value of Ki. This set can be
partitioned into
clusters of size Ki, where each cluster corresponds to a particular
. Moreover, given Si = 1 from the first stage of randomization, the second randomization
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
stage entails selecting exactly one of these clusters according to Zi. Thus,
can be viewed
as the sample mean from a single systematic sample. It is known that, in general, unbiased
estimators of the variance of the sample mean from a single systematic sample do not exist
without making further assumptions about the underlying population .
Therefore, to make progress in deriving variance estimators, in Section 4.2.1 an additional
assumption is introduced about the structure of interference (stratified interference), which
may be plausible in a broad range of settings. In Section 4.2.2, variance estimators of the direct,
indirect, total, and overall causal effect estimators are proposed. Under the additional
assumption of stratified interference, these variance estimators are shown to be unbiased if the
causal effects are additive and positively biased otherwise.
4.2.1 Stratified Interference—Suppose that Rni, that is, the set of possible treatment
programs for group i, can be partitioned into strata such that within strata there is no
interference. In particular, we assume:
Assumption 2 (Stratified interference). For k = 1, . . . , ni - 1,
for all zi,
To illustrate the meaning of Assumption 2, consider a study of the effects of an intervention
on children in a school. The stratified interference assumption states that the outcome for a
child receiving the intervention will be the same when k - 1 schoolmates also receive the
intervention, regardless of which particular k - 1 schoolmates receive the intervention. This
assumption can be viewed as an intermediate assumption between (i) assuming no interference
within a group and (ii) making no assumptions about the nature of interference within a group.
Moreover, because there are ni possible values of Ki given zij = z, it follows that Yij (zi(j), zij =
z) can take on ni values. Thus, for a given zij = z, an individual has ni potential outcomes under
Assumption 2 compared to only one potential outcome under (i) and 2ni-1 potential outcomes
under (ii).
To illustrate the utility of Assumption 2, again consider estimating
Suppose, by way of contradiction, there exists an unbiased estimator
general, that is, under Assumption 1 only. Denote this estimator by g(Oi1 (Zi)), where Oi1
(Zi) ≡ {Yij (Zi) : Zij = 1} is the set of observed outcomes for individuals in group i assigned
treatment Zij = 1 and g is some real-valued function of Oi (Zi). By our supposition,
under Assumption 1. Consider the following two
different scenarios where ni = 3 and Ki = 2 given Si = 1.
First, suppose Yij(zi) = k for j = 1, 2, 3, and
, where κ is some
constant. In other words, the potential outcomes in group i are constant for all individuals and
all treatment programs given Si = 1. Then
, implying g({κ, κ}) = 0 for
any constant κ.
Second, suppose Yij (zi) = f (zi) for j = 1, 2, 3 and
, where f is some real-valued function
of zi. In other words, for any treatment program
, all individuals in group i have the same
response. Suppose also that f (011) ≠ f (110) ≠ f (101). Now
, implying
equals the sample variance of the set
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
. However, because Oi1 (Zi) = {f (Zi), f (Zi)} in this scenario, it follows
that E{g(Oi1 (Zi))| Si = 1} = 0. Thus, g is a biased estimator of
contradiction.
Intuitively, an unbiased estimator of
does not exist in general because the
observed data no way to distinguish between these two scenarios under either scenario, the
observed outcomes are all equal, that is, Yi1 (Zi) = Yi2(Zi) = Yi3(Zi). However, with the addition
of Assumption 2, one can rule out the possibility of the second scenario. Namely, under
Assumption 2, Yi1 (110) = Yi1 (101) and Yi2(110) = Yi2(011), implying f (011) = f (110) f (101).
More generally, unbiased variance estimators do not exist without further assumptions (such
as stratified interference) because observing Yij (zi) provides no information about Yij (ωi) for
ωi ≠ zi. Under Assumption 2, each individual now has only two potential outcomes, one for
zij = 0 and one for zij = 1,, within a particular stratum
. Therefore, given Si, the observed
data under one treatment program will provide information about the potential outcomes under
other treatment programs. For example, suppose ψ is a mixed strategy such that Ki is fixed.
Then, under Assumption 2, the outcomes for individual j are constant for all
zij = 1. Denote this value by Yij (1; ψ), that is, Yij (1; ψ) ≡ Yij (ω, zij = 1) for any
Define Yij (0; ψ) similarly.
4.2.2 Variance Estimators Assuming Stratified Interference
Theorem 4: Let
is the within-group sample variance,
analogously. Under Assumptions 1 and 2,
for z = 0, 1.
Theorem 5: Let
Under Assumptions 1 and 2,
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
variance of the ni differences Yij (0; ψ) - Yij (1; ψ).
Corollary: Under Assumptions 1 and 2,
with equality holding if and only if
for fixed constant ηDi and j = 1, . . . , ni.
Remark: The corollary to Theorem 5 says (8) is a conditionally unbiased estimator of
if and only if the individual direct effect is additive. If (9) does not hold,
(8) will be a positively biased estimator of
. This could occur, for instance,
if the potential outcomes are binary, taking on values 0 and 1 only. In this case, (9) will only
be true if either (i) ηDi = 0 or (ii) |ηDi| = 1, with (ii) corresponding to the scenario that either
(Yij (0; ψ), Yij (1; ψ)) = (0, 1) for all j or (Yij (0; ψ), Yij (1; ψ)) = (1, 0) for all j.
Theorem 6: Let
. Under Assumptions 1 and 2,
Corollary: Under Assumptions 1 and 2,
with equality
holding if and only if (9) holds for all i = 1, . . . , N.
Remark: The corollary to Theorem 6 is similar to the corollary to Theorem 5 in that (10) is an
unbiased estimator of
if and only if the individual direct effects are additive. If
direct additivity does not hold for all individuals, (10) will be positively biased. Analogous
results for the group average indirect, total, and overall effects follow from Theorems 7-9.
Theorem 7: Let
. Under Assumptions 1 and 2,
variance of the N differences
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
Corollary: Under Assumptions 1 and 2,
with equality
holding if and only if
for fixed constant ηI and i = 1, . . . , N.
Theorem 8: Let
. Under Assumptions 1 and 2,
Corollary: Under Assumptions 1 and 2,
with equality
holding if and only if
for fixed constant ηT and i = 1, . . . , N.
Theorem 9: Let
is defined analogously. Under
Assumptions 1 and 2,
Corollary: Under Assumptions 1 and 2,
with equality
holding if and only if
for fixed constant ηO and i = 1, . . . , N.
5. EXAMPLES
5.1 Housing Vouchers
Motivated by randomized studies designed to assess the effect of vouchers on housing mobility,
Sobel proposed causal estimands and estimators when interference between units is
present. At the first level, Sobel considered the effect of housing vouchers on the lease-up rate,
that is, whether a household moves. At the second level, he considered voucher effects on other
outcomes such as parents’ perceptions of safety, welfare receipt, and child health. In this
section, some of these estimands and estimators are shown to be special cases of those defined
in Sections 3 and 4.1. To begin, we demonstrate that Sobel’s causal estimand and estimator of
the voucher effect on the lease-up rate are examples of the group average total causal effect
estimand and estimator. Because Sobel considered just one group, we drop the subscript i for
group in the rest of this section.
Consider a study where n households within a neighborhood are randomized to receive a
housing voucher. In our terminology, households correspond to individuals and the
neighborhood corresponds to a single group. Let Zj = 1 if the j th household receives a voucher,
Zj = 0 otherwise for j = 1, . . . , n. Let Yj (z) = 1 if the j th household moves using a voucher,
Yj (z) = 0 otherwise. Because moving using a voucher is clearly not possible without a voucher,
it follows immediately from the definition of Yj (z) that
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
Suppose Prϕ(Z = 0) = 1; that is, ϕ corresponds to the benchmark allocation strategy where no
household receives a voucher. Then (11) implies
for any other household assignment strategy ψ. In particular, suppose ψ corresponds to the
mixed assignment strategy, where exactly k of n households receive a voucher. Then
which is equivalent (up to a minus sign) to equation (2) of Sobel in the setting where there are
two levels of treatment. Sobel actually considered the more general situation of three treatment
levels, which is not considered here. Sobel’s corresponding estimator, the observed lease-up
rate among voucher recipients, is equivalent to
as given by (6). Under exclusion
restriction (11),
Although interference is possible among those receiving housing vouchers, the exclusion
restriction (11) precludes interference when a household does not receive a voucher. Thus, the
indirect effect of housing vouchers on mobility is 0,
, and the total effects equal
the direct effects. If households could move without the aid of a voucher, an analysis based on
(11) could potentially overestimate the magnitude of the total effect of vouchers. By instead
defining Yj (z) = 1 if the j th household moves and 0 otherwise, a voucher allocation strategy
may have indirect effects in those not receiving vouchers as well as direct and total causal
effects. For example, this would allow for the possibility that if several neighbors move because
they receive vouchers, household j might also move even though they did not obtain a voucher.
Estimating such indirect causal effects of voucher distribution within a neighborhood on those
households that do not receive a voucher would likely be of interest to policy makers. Of course,
in this case, observation of potential outcomes under the benchmark allocation program Z =
0 would also be necessary to estimate the indirect and total effects.
Sobel’s estimand of the effects of vouchers on outcomes such as welfare receipt can be viewed
as an example of the group average overall effect estimand. For instance, assume all households
that receive a voucher subsequently move and ϕ is the benchmark allocation strategy. Then
taking the expected value of Sobel’s “average effect” [his eq. (3)] over the distribution of
possible intervention programs under ψ yields the group average overall effect
Sobel noted that the average overall effect is a weighted average of the indirect effects on those
not receiving a voucher, which he called spillover effects, and the effects in those receiving a
voucher. More precisely, for ϕ the benchmark allocation strategy, the overall effect equals the
following weighted sum of the indirect and total effects:
Because the design of the housing voucher study does not include randomizing some
neighborhoods to the benchmark allocation, outcomes such as welfare receipt and parents’
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
perception of safety are not observed under this allocation. Thus, without further assumptions
akin to (11), voucher effects on these outcomes are not identifiable from the data. Alternatively,
these effects are identifiable by considering a population of neighborhoods and a two-stage
randomization design. For example, neighborhoods within a city or set of cities could be
identified that were sufficiently separated geographically to ensure that the assumption of no
interference between neighborhoods is plausible. Then, in the first stage of randomization,
some neighborhoods could be randomly assigned the benchmark allocation and other
neighborhoods to an allocation strategy where in the second stage, a specified proportion of
randomly selected households would receive a voucher. Such a design would permit estimation
of the direct, indirect, total, and overall effects of housing vouchers on the outcomes described
previously without making exclusion restrictions such as (11). Estimation of the variances of
the causal effect estimators would also be possible with this design under the additional
assumption of stratified interference.
5.2 Vaccines
Direct application of the proposed methods to the data given in Table 1 is not appropriate
because baris were not randomly assigned to particular levels of vaccine coverage in the actual
trial. Therefore, for illustrative purposes, we consider a hypothetical two-stage randomized
placebo-controlled trial of cholera vaccines in a setting similar to that of Ali et al. .
Suppose in the first stage of this hypothetical trial that five geographically separate groups
were randomized using a mixed allocation strategy ν such that three groups were assigned ϕ
and the remaining two were assigned ψ. Then, in the second stage, suppose 30% of individuals
were randomly chosen to receive vaccine within groups assigned ϕ and 50% of individuals
were randomly chosen to receive vaccine within groups assigned ψ. Individuals were then
followed for one year for detection of cholera. Results from this hypothetical trial are given in
Estimates of the population average direct, indirect, total, and overall effects are given in Table
3. The estimated variances are also presented. Note the direct effect estimate is nearly three
times greater under ϕ (30% coverage) compared to ψ (50% coverage). Ali et al. noted
a similar phenomenon and cautioned that high levels of vaccine coverage can bias estimates
of vaccine efficacy (i.e., the direct effect of vaccination). In fact, the issue here is not one of
bias, but rather that the parameter being estimated can depend on the level of coverage due to
interference between individuals. Moreover, the totality of effects of a vaccination strategy
must be viewed by considering indirect, total, and overall effects in addition to direct effects.
Estimates of these other effects can easily be interpreted by investigators. For example, the
indirect effect estimate in Table 3 suggests 50% vaccine coverage results in 2.8 fewer cholera
cases per 1,000 unvaccinated individuals per year compared to only 30% vaccine coverage.
Note the estimated total effect of being vaccinated under ψ is over three times the corresponding
estimated direct effect, demonstrating the importance of randomizing groups to different levels
of vaccine coverage. Had all groups received 50% coverage such that only the direct effect
could be estimated, the utility of vaccination would have been substantially underestimated.
The estimated overall effect provides a simple summary comparison of the two strategies,
indicating that, on average, 50% vaccine coverage results in 2.4 fewer cases of cholera per
1,000 individuals per year compared to 30% vaccine coverage.
6. DISCUSSION
In this article, estimands for direct, indirect, total, and overall causal effects of different
treatment strategies are proposed in the setting where interference between individuals is
possible. Relations between the estimands are established, and estimators of the proposed
estimands are presented. These estimators are shown to be unbiased assuming a two-stage
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
randomization procedure with a mixed assignment mechanism at each stage (Assumption 1).
Under an additional assumption of stratified interference (Assumption 2), variance estimators
of the causal effect estimators are derived that are unbiased under additivity and positively
biased otherwise.
This article builds on previous work in several significant ways. First, causal inference in the
presence of interference is considered in a general framework not specific to any one subject
area, unifying previous work on housing mobility studies and infectious diseases
 . The definitions of individual direct, indirect, total, and
overall causal effects in the presence of interference are
formally extended to groups and populations of groups by averaging over all possible treatment
assignments for particular allocation strategies . By considering a population of
groups, rather than just one group as in Sobel , unbiased estimators of the causal
estimands of interest are derived without requiring exclusion restriction assumptions. The
variance of causal effect estimators in the presence of interference is also considered, which
had not been done previously. The utility of the proposed variance estimators will depend on
whether Assumptions 1 and 2 are reasonable. Assumption 1 is determined by the experimental
design and, thus, should be under control of the investigator. Assumption 2 may be reasonable
in many settings, such as in the evaluation of the effects of vaccines, educational interventions,
or housing vouchers. However, in other contexts, such as in cross-over trials or plant variety
studies, assuming different forms of interference may be more appropriate.
The methods developed here could be extended to settings with more than two treatment levels
or noncompliance as in Sobel . Consideration of population subgroups may be of interest
in the presence of interference. As in Halloran, Longini, Cowart, and Nizam , one could
define the indirect, total, and overall effects for different subgroups of the population. For
example, a strategy of vaccinating 70% of children against influenza and another strategy of
not vaccinating children could be compared by the indirect effects on the incidence of influenza
in adults from the same population. Similarly, Moulton et al. and Sobel 
considered populations consisting of participants and nonparticipants; that is, a subset of the
population does not receive either treatment.
In addition to these extensions, other areas of research remain to be explored in the setting
where interference between individuals is present. Different randomization strategies and
interference structures might be considered. An anonymous referee suggested more efficient
variance estimators might be derived if one is willing to make certain additional additivity
assumptions. For example, under (9),
are estimating the same parameter,
and, thus, more efficient variance estimators might be obtained by combining data from
individuals assigned Zij = 0 and individuals assigned Zij = 1. Stochastic causal models could
also be considered, wherein the potential outcomes Yij (zi) are treated as random rather than
fixed . Methods are needed to construct confidence
intervals for the different causal effects, perhaps by building on the work of Rosenbaum
Rubin recently noted that causal inference can be conducted by making only two
assumptions: a probabilistic model about the treatment assignment mechanism and SUTVA.
By providing a framework where the latter assumption is not completely necessary, our work
here will hopefully contribute to a foundation for causal inference in the presence of
interference upon which others can build.
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
Acknowledgements
MGH and MEH were supported in part by NIH grant 2 R01 AI32042. The authors thank Peter Gilbert and Thomas
Richardson for helpful comments.
APPENDIX: PROOFS OF THEOREMS 1-9
A.1 Proof of Theorem 1
Without loss of generality, let z = 1. Under Assumption 1, Ki is fixed, so that
Now any z such that zij = 0 does not contribute to the summation, so that we can equivalently
Under Assumption 1, Prψ (Zij = 1) = Ki/ni, implying
A.2 Proof of Theorem 2
Without loss of generality, let z = 1. Using the fact that
Theorem 1 it follows that
A.3 Proof of Theorem 3
The conditional expectation result follows from
The remainder of the proof parallels that of Theorem 2.
A.4 Proof of Theorem 4
The proof follows directly from known properties of estimators of population means using
simple random sampling (SRS) and two-stage cluster sampling . For example, given Si = 1 and
Assumptions 1 and 2,
can be viewed as the sample mean from a simple random sample
drawn without replacement from {Yi1(1; ψ), . . . , Yini (1; ψ)}. Thus,
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
is the within-group variance. It is also
well known that
, implying (7) holds.
Similarly, that
for z = 0, 1 follows from known results on twostage cluster sampling. A sketch of a proof of this follows. First, one can show
. Next, note E(Si) = C/N such that
So the remaining task at hand becomes finding
, which can be shown to equal
Substituting this into (A.3) implies
which simplifies to (A.2).
A.5 Proof of Theorem 5
The proof follows from Splawa-Neyman and Rubin ; a sketch is given here. First,
, which, of course, equals
. We know the form of
for z = 0, 1 from the proof of Theorem 4. Additionally, one can show
. Therefore,
which simplifies to
The proof is then completed by noting that
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
A.6 Proof of Theorem 6
The proof follows along similar lines as the derivation of
in the proof of
Theorem 4. In particular, one can first show
. Next, similar to
in Theorem
4, one can show
. Taking the expected value
of (10), we have
Combining this result with Theorem 5 proves the theorem.
A.7 Proof of Theorem 7
The proof follows along the same lines as the proof of Theorem 5. Namely, one can show
defined analogously to
in Theorem 4, implying
From the proof of Theorem 4, we have
and similarly
, which together with (A.5) prove
the theorem.
A.8 Proof of Theorem 8
The proof is analogous to the proof of Theorem 7.
A.9 Proof of Theorem 9
As in the proof of Theorem 4, one can show
. Following the same lines as the proofs of
Theorems 5 and 7, one can also show
Hudgens and Halloran
J Am Stat Assoc. Author manuscript; available in PMC 2008 December 10.
NIH-PA Author Manuscript
NIH-PA Author Manuscript
NIH-PA Author Manuscript
is defined analogously
, implying
Additionally, one can show
, which implies
. Using an analogous result for
, the theorem