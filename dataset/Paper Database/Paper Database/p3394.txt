Theranostics 2013, Vol. 3, Issue 10
 
Thheerraannoossttiiccss
2013; 3(10):802-815. doi: 10.7150/thno.5130
Direct Estimation of Kinetic Parametric Images for
Dynamic PET
Guobao Wang and Jinyi Qi ï€ª
Department of Biomedical Engineering, University of California, Davis, CA 95616.
ï€ª Corresponding author: .
Â© Ivyspring International Publisher. This is an open-access article distributed under the terms of the Creative Commons License ( 
licenses/by-nc-nd/3.0/). Reproduction is permitted for personal, noncommercial use, provided that the article is in whole, unmodified, and properly cited.
Received: 2013.01.24; Accepted: 2013.08.04; Published: 2013.11.20
Dynamic positron emission tomography (PET) can monitor spatiotemporal distribution of radiotracer in vivo. The spatiotemporal information can be used to estimate parametric images of
radiotracer kinetics that are of physiological and biochemical interests. Direct estimation of
parametric images from raw projection data allows accurate noise modeling and has been shown
to offer better image quality than conventional indirect methods, which reconstruct a sequence of
PET images first and then perform tracer kinetic modeling pixel-by-pixel. Direct reconstruction of
parametric images has gained increasing interests with the advances in computing hardware. Many
direct reconstruction algorithms have been developed for different kinetic models. In this paper
we review the recent progress in the development of direct reconstruction algorithms for parametric image estimation. Algorithms for linear and nonlinear kinetic models are described and
their properties are discussed.
Key words: Dynamic positron emission tomography, Direct estimation
1 Introduction
1.1 Parametric Imaging with Dynamic PET
Dynamic positron emission tomography (PET)
provides the additional temporal information of tracer kinetics compared to static PET. It has been shown
that tracer kinetics can be useful in tumor diagnosis
such as differentiation between malignant and benign
lesions , and in therapy monitoring where the
kinetic values from dynamic PET can be more predictive for assessment of response than the standard uptake value at a single time point .
There are basically two approaches for deriving
region-of-interest (ROI) kinetic modeling and parametric imaging . The ROI based approach fits a kinetic model to the average time activity curve (TAC)
of a selected ROI, so it is easy to implement and has
low computation cost. In contrast, parametric imaging
estimates kinetic parameters for every pixel and provides the spatial distribution of kinetic parameters. It
is thus more suitable to study heterogeneous tracer
uptake in tissue. Parametric images have been found
useful in many biological research and clinical diagnosis . However, parametric imaging is more
demanding computationally and more sensitive to
noise in dynamic PET data than the ROI-based kinetic
modeling. Obtaining parametric images of high quality therefore raises new challenges that were not faced
by conventional ROI-based methods .
1.2 Direct Reconstruction of Parametric Images
The typical procedure of parametric imaging is
to reconstruct a sequence of emission images from the
measured PET projection data first, and then to fit the
TAC at each pixel to a linear or nonlinear kinetic
model. To obtain an efficient estimate, the noise distribution of the reconstructed activity images should
International Publisher
Theranostics 2013, Vol. 3, Issue 10
 
be modeled in the kinetic analysis. However, exact
modeling of the noise distribution in PET images can
be difficult because noise is spatially variant and object-dependent. Usually the spatial variation and correlations between pixels are simply ignored in the
kinetic fitting step, which can lead to very noisy results.
Direct reconstruction has been developed to reduce noise amplification in parametric imaging. Direct reconstruction methods combine tracer kinetic
modeling and emission image reconstruction into a
single formula to estimate parametric images directly
from the raw projection data . Because PET
projection data are well-modeled as independent
Poisson random variables, direct reconstruction allows accurate compensation of noise propagation
from sinogram measurements to the kinetic fitting
process. It has been shown that images reconstructed
by direct reconstruction methods have better bias-variance characteristics than those obtained by
indirect methods for both linear models and
nonlinear kinetic models .
One drawback of direct reconstruction of parametric images is that the optimization algorithms are
more complex than indirect methods , due to
the intertwinement of the temporal and spatial correlations. In addition, when compartment models are
used, the relationship between the kinetic parameters
and PET data also becomes nonlinear. Therefore, the
development of efficient optimization algorithms for
direct reconstruction is of high significance.
1.3 A Brief History of Direct Reconstruction
The theory of direct reconstruction of parametric
images was developed right after the publication of
likelihood
expectation-maximization (EM) algorithm for static PET reconstruction . In 1984, Snyder presented an
ML EM algorithm to estimate compartmental parameters from time-of-flight list-mode data. Carson and
Lange in 1985 presented an EM algorithm for
maximum likelihood reconstruction of kinetic parameters from PET projection data. However, neither
of these algorithms was validated using a realistic
simulation or real data at the time, possibly due to the
limitation of computing hardware.
In 1995, Limber et al combined a least
reconstruction
Levenberg-Marquardt (LM) algorithm to estimate the
parameters of a single exponential decay model from
SPECT projection data. Separable nonlinear least
squares were used by Huesman et al in 1998 to
estimate kinetic parameters of a one-tissue compartment model from 3D SPECT projection data. To reduce computation cost, several researchers also developed methods for direct estimation of kinetic parameters for ROIs instead of reconstruction of the
whole parametric images, e.g. . These algorithms are only efficient for a small-scale problem
with a limited number of ROIs. When the number of
unknown parameters goes beyond a few hundreds,
both the LM algorithm used by Limber et al and
the separable nonlinear least squares used by Huesman et al become inefficient.
The development of algorithms that are suitable
for large-scale direct estimation began to attract more
and more attention with the recent advances in computing technology. In 2005, a parametric iterative coordinate descent (PICD) algorithm was proposed by
Kamasak et al for penalized likelihood estimation
of parametric images of a two-tissue compartment
model. To our knowledge, this was the first demonstration of direct parametric reconstruction on a dense
set of voxels. Yan et al proposed a new EM algorithm for direct ML reconstruction of kinetic parameters of a one-tissue compartment model. Both Kamasakâ€™s PICD and Yanâ€™s EM algorithms are specific to
their respective compartment models. To simplify
practical implementation, Wang and Qi in 2008 proposed generalized optimization transfer algorithms
for direct penalized likelihood reconstruction of
parametric images that are applicable to a wide variety of kinetic models . The algorithms resemble
the empirical iterative implementation of the indirect
method that alternates between an image reconstruction update and kinetic fitting step (e.g., ), but
have the advantage of guaranteed monotonic convergence to the direct estimate. Later Wang and Qi
 also proposed an EM-based optimization
transfer algorithm for direct penalized likelihood reconstruction that has faster convergence rate, especially at situations with low background events (randoms and scatters).
Direct reconstruction of parametric images for
linear kinetic models has also been developed due to
its computational efficiency. In 1997, Matthews et al
 used the ML EM algorithm to estimate the parametric images of a set of linear temporal basis functions. Meikle et al in 1998 presented a direct reconstruction for the spectral analysis model using the
non-negative least squares method. Mathematically,
direct reconstruction of linear parametric images is
essentially the same as dynamic image reconstruction
with overlapping temporal basis functions, such as
B-splines . To avoid pre-defined basis functions,
Reader et al also proposed a method to estimate the
linear coefficients and temporal basis functions simultaneously . To obtain physiologically relevant
kinetic parameters directly, Patlak model has been
incorporated into direct reconstruction by defining
Theranostics 2013, Vol. 3, Issue 10
 
two temporal basis functions as the blood input function and its integral . In 2007, Wang et al presented a maximum a posteriori (MAP) reconstruction
of the Patlak parameters using a preconditioned conjugate gradient (PCG) algorithm. Tsoumpas et al 
presented an ML EM algorithm for direct Patlak reconstruction. Li and Leahy , and Zhu et al 
developed direct reconstruction of the Patlak parameters from list-mode data. Tang et al used anatomical prior information to improve the Patlak reconstruction. Rahmim et al used the AB-EM algorithm
 to allow negative values in the direct estimation
for a Patlak-like graphical analysis model . It has
been observed that the strong correlation between the
two temporal basis functions in the Patlak model
slows down the convergence speed of the direct reconstruction. A nested EM algorithm was developed
by Wang and Qi to improve the convergence rate
of direct linear parametric reconstruction.
1.4 Aim of This Paper
In this paper we will provide an overview of the
recent progress in the development of direct reconstruction algorithms. We will describe technical details of different algorithms and analyze their properties. Methods for direct reconstruction of linear and
nonlinear parametric images as well as for joint estimation of parametric images and input function will
be included. We expect the information in this review
will provide useful guidance to readers for choosing a
proper direct reconstruction method.
2 General Formulation of Direct Reconstruction
2.1 PET Data Model
A dynamic PET scan is often divided into multiple consecutive time frames, with each frame containing coincidence events recorded from the start of
the frame till the end of the frame. The image intensity
at pixel ğ‘— in time frame m, ğ‘¥ğ‘š(ğœ½ğ‘—), is then given by
ğ¶T(ğœ; ğœ½ğ‘—)ğ‘’âˆ’ğœ†ğ‘¡ğ‘‘ğœ
where ğ‘¡ğ‘š,ğ‘  and ğ‘¡ğ‘š,ğ‘’ denote the start and end times of
frame ğ‘š, respectively, and ğœ† is the decay constant of
the radiotracer. ğ¶Tàµ«ğ‘¡; ğœ½ğ‘—àµ¯ is the tracer concentration in
pixel ğ‘— at time ğ‘¡ and is determined by a linear or nonlinear kinetic model with the parameter vector
ğœ½ğ‘—âˆˆâ„ğ‘›ğ‘˜Ã—1. ğ‘›ğ‘˜ is the total number of kinetic parameters for each pixel.
measurements
{ğ‘Œğ‘–ğ‘š, ğ‘–= 1 âˆ™âˆ™âˆ™
, ğ‘›ğ‘–, ğ‘š= 1 âˆ™âˆ™âˆ™, ğ‘›ğ‘š} can be well modeled as a collection
of independent Poisson random variables ,
ğ‘Œğ‘–ğ‘šâˆ¼Poissonàµ›ğ‘¦à´¤ğ‘–ğ‘š(ğœ½)àµŸ â€¦(2)
where ğ‘– and ğ‘š are the indices of detector pairs and
time frames, respectively, and ğ‘›ğ‘– and ğ‘›ğ‘š are the total
numbers of the detector pairs and of the time frames,
respectively. The expected projection {ğ‘¦à´¤ğ‘–ğ‘š(ğœ½)} is related to the dynamic image {ğ‘¥Ì…ğ‘–ğ‘š(ğœ½)}, through an affine
transform,
ğ‘¦à´¤ğ‘–ğ‘š(ğœ½) = ğ‘™ğ‘–ğ‘š(ğœ½) + ğ‘Ÿğ‘–ğ‘š â€¦(3)
ğ‘™ğ‘–ğ‘š(ğœ½) = âˆ‘
where ğ‘ğ‘–ğ‘—, the (ğ‘–. ğ‘—)th element of the system matrix
ğ‘·âˆˆâ„ğ‘›ğ‘–Ã—ğ‘›ğ‘—, is the probability of detecting an event
originated in pixel ğ‘— by detector pair ğ‘–, and ğ‘Ÿğ‘–ğ‘š is the
expectation of scattered and random events at detector pair ğ‘– in the ğ‘šth frame. ğ‘›ğ‘— is the total number of
image pixels.
Let ğ’šà´¤ğ‘š(ğœ½) â‰¡{ğ‘¦à´¤ğ‘–ğ‘š(ğœ½)}ğ‘–=1
ğ‘›ğ‘– and ğ’“ğ‘šâ‰¡{ğ‘Ÿğ‘–ğ‘š}ğ‘–=1
projection vectors and ğ’™ğ‘š(ğœ½) â‰¡{ğ‘¥ğ‘š(ğœ½ğ‘—)}ğ‘—=1
ğ‘›ğ‘— the image
vector in frame ğ‘š. The forward model for time frame
ğ‘š can be rewritten in a matrix-vector product form:
ğ’šà´¤ğ‘š(ğœ½) = ğ‘·ğ’™ğ‘š(ğœ½) + ğ’“ğ‘š â€¦(5)
Let us define a matrix of kinetic parameters,
ğš¯â‰¡[ğœ½1,âˆ™âˆ™âˆ™, ğœ½ğ‘›ğ’‹]ğ‘‡, in which each column represents an
image of a kinetic parameter. We use ğš¯ to denote its
ordered vector. Similarly we also define the following
ğ‘¿(ğš¯) = àµ£ğ’™1(ğœ½),âˆ™âˆ™âˆ™, ğ’™ğ‘›ğ‘š(ğœ½)àµ§
ğ’€à´¤(ğš¯) = á‰‚ğ’šà´¤1(ğœ½),âˆ™âˆ™âˆ™, ğ’šà´¤ğ‘›ğ‘š(ğœ½)á‰ƒ
ğ‘¹= àµ£ğ’“1,âˆ™âˆ™âˆ™, ğ’“ğ‘›ğ‘šàµ§
ğ’™(ğœ½), ğ’šà´¥(ğœ½) and ğ’“ respectively. Then the expectation of
the whole dynamic PET data can be expressed either
ğ’€à´¤(ğš¯) = ğ‘·ğ‘¿(ğš¯) + ğ‘¹ â€¦(6)
ğ’šà´¤(ğœ½) = àµ«ğ‘°ğ‘›ğ‘šâ¨‚ğ‘·àµ¯ğ’™(ğœ½) + ğ’“ â€¦(7)
where ğ‘°ğ‘ is a ğ‘Ã— ğ‘ identity matrix and â¨‚ denotes the
Kronecker product. Equation (6) is the form for practical implementation and equation (7) is more suitable
for algorithm analysis.
2.2 Maximum Likelihood Reconstruction
The goal of direct reconstruction is to estimate ğœ½
from dynamic PET measurements. Let ğ‘¦ğ‘–ğ‘š denote a
set of dynamic PET measurements. ğ’€ and ğ’š are the
Theranostics 2013, Vol. 3, Issue 10
 
matrix and the vector that are formed by {ğ‘¦ğ‘–ğ‘š} in the
same fashion as ğ’€à´¥ and ğ’šà´¤, respectively. The log Poisson
likelihood function of the dynamic PET data is
ğ¿(ğ’š|ğœ½) = âˆ‘
ğ‘¦ğ‘–ğ‘šlog ğ‘¦à´¤ğ‘–ğ‘š(ğœ½) âˆ’ğ‘¦à´¤ğ‘–ğ‘š(ğœ½)
â„ğ‘–ğ‘šàµ«ğ‘™ğ‘–ğ‘š(ğœ½)àµ¯
where a constant term is neglected and â„ğ‘–ğ‘š(ğ‘™) is defined by
â„ğ‘–ğ‘š(ğ‘™) = ğ‘¦ğ‘–ğ‘šlog(ğ‘™+ ğ‘Ÿğ‘–ğ‘š) âˆ’(ğ‘™+ ğ‘Ÿğ‘–ğ‘š) â€¦(10)
Maximum likelihood (ML) reconstruction finds
the solution by maximizing the log likelihood function,
ğœ½à·œ= argmaxğœ½âˆˆğ’®ğ¿(ğ’š|ğœ½) â€¦(11)
where ğ’® denotes the feasible set of the kinetic parameters ğœ½ (e.g. satisfying nonnegativity or box constraints). The resulting images from ML reconstruction at convergence are often very noisy because the
tomography problem is ill-conditioned. In practice,
the true ML solution is seldom being sought. Rather
images are regularized either by early termination
before convergence or using a penalty function or
image prior to encourage spatial smoothness.
2.3 Penalized Likelihood Reconstruction
Penalized likelihood (PL) reconstruction (or
equivalently maximum a posteriori, MAP) regularizes
the solution by incorporating a roughness penalty in
the objective function to encourage spatially smooth
images. PL reconstruction finds the parametric image
that maximizes the penalized likelihood function as
ğœ½à·œ= argmaxğœ½âˆˆğ’®Î¦(ğœ½), Î¦(ğœ½) = ğ¿(ğ’š|ğœ½) âˆ’ğ›½ğ‘‰(ğœ½)
where ğ‘‰(ğœ½) is a smoothness penalty and ğ›½ is the regularization parameter that controls the tradeoff between the resolution and noise. If ğ›½ is too small, the
reconstructed image approaches the ML estimate and
becomes very noisy; if ğ›½ is too large, the reconstructed
image becomes very smooth and useful information
can be lost.
The smoothness penalty can be applied either on
the kinetic parameters ğœ½ or on the dynamic image
{ğ’™ğ‘š(ğœ½)}ğ‘š=1
ğ‘›ğ‘š, depending on the application. A penalty
applied on the dynamic images can be expressed by
where ğ‘ˆ(ğ) is a smoothness penalty given by
ğ›¾ğ‘—ğ‘˜ğœ“(ğœ‡ğ‘—âˆ’ğœ‡ğ‘˜)
and ğœ“(ğ‘¡) is the potential function. ğ’©ğ‘— denotes the
neighborhood of pixel ğ‘—; ğ›¾ğ‘—ğ‘˜ is the weighting factor
equal to the inverse distance between pixels ğ‘— and ğ‘˜.
A typical neighborhood includes the eight nearest
pixels in 2D and 26 nearest voxels in 3D.
The basic requirement of ğœ“(ğ‘¡) is that it is even
and non-decreasing of |ğ‘¡|. A common choice in PET
image reconstruction is the quadratic function
2 ğ‘¡2 . The disadvantage of the quadratic
regularization is that it can over-smooth edges and
small objects when a large ğ›½ is used. To preserve
edges, non-quadratic penalty functions can be used.
Examples includes the absolute value function
ğœ“(ğ‘¡) = |ğ‘¡|
ğœ“(ğ‘¡) = |ğ‘¡| âˆ’
ğ›¿) , and other variations . Nonconvex penalty functions can also be used to even
enhance edges, but they are much less popular because the resulting objective function may have multiple local optima.
3 Reconstruction of Parametric Images
for Linear Kinetic Models
3.1 Linear Kinetic Models
One way to represent time activity curves is to
use a set of linear temporal basis functions. The tracer
concentration ğ¶T(ğ‘¡; ğ“) at time t can be described by,
ğ¶T(ğ‘¡; ğ“) = âˆ‘
where ğ‘›ğ‘˜ is the total number of basis functions, ğµğ‘˜(ğ‘¡)
is the ğ‘˜th temporal basis function and ğœ™ğ‘˜ is the coefficient to be estimated.
The temporal basis functions can be divided into
two categories. The first category primarily focuses on
efficient representation of time activity curves. Examples include B-splines and wavelets , as
well as those obtained from principal component
analysis or adaptively estimated from PET data
 . One advantage of these basis functions is that
they can represent a wide variety of time activity
curves. A disadvantage is that the associated coefficients are not directly related to the kinetic parameters
of physiological interest. Kinetic modeling is often
required to estimate kinetic parameters from the
TACs after reconstruction. In comparison, the second
category to be described below provides linear coefficients that are directly related to the kinetic parameters of interest.
3.1.1 Spectral Analysis
In spectral analysis the basis functions are a set
of pre-determined exponential functions convolved
with the blood input function ğ¶p(ğ‘¡) ,
ğµğ‘˜(ğ‘¡) = ğœˆğ‘˜ğ‘’âˆ’ğœˆğ‘˜ğ‘¡âˆ—ğ¶p(ğ‘¡) â€¦(16)
where ğœˆğ‘˜ denotes the rate constant of the ğ‘˜th spectrum and â€˜âˆ—â€™ represents the convolution operator. The
Theranostics 2013, Vol. 3, Issue 10
 
exponential spectral bases are consistent with the
compartmental models and the distribution volume
(DV) of a reversible tracer can be directly computed
from the spectral coefficients {ğœ™ğ‘˜} by
If the blood input function ğ¶p(ğ‘¡) in (16) is replaced by a reference region TAC ğ¶r(ğ‘¡), the calculated
quantity from the spectral coefficients then becomes
the distribution volume ratio (DVR), which is related
to binding potential (BP), a major parameter of interest in neuroreceptor studies, by
ğµğ‘ƒ= ğ·ğ‘‰ğ‘…âˆ’1 = âˆ‘
3.1.2 Patlak Model
The Patlak graphical method is a linear
technique which has been widely used in dynamic
PET data analysis. For a tracer with an irreversible
compartment, the time activity curve satisfies the following linear relationship at the steady state:
ğ¶p(ğ‘¡) = ğ¾ğ‘–
+ ğ‘, ğ‘¡> ğ‘¡âˆ— â€¦(19)
where ğ‘¡âˆ— is the time for the tracer to reach steady state.
The Patlak slope ğ¾ğ‘– represents the overall influx rate
of the tracer into the irreversible compartment and
has found applications in many disease studies. For
example, ğ¾ğ‘– is proportional to the glucose metabolic
rate in FDG scans. In some applications, the plasma
input function ğ¶p(ğ‘¡) can also be replaced by a reference region input function ğ¶r(ğ‘¡).
Equation (19) can be rewritten into the following
linear model:
ğ¶T(ğ‘¡; ğ“) = ğ¾ğ‘–ğµ1(ğ‘¡) + ğ‘ğµ2(ğ‘¡), ğ‘¡> ğ‘¡âˆ— â€¦(20)
where ğ“â‰¡[ğ¾ğ‘–, ğ‘]ğ‘‡ and the two basis functions are
ğµ1(ğ‘¡) = âˆ«ğ¶p(ğœ)ğ‘‘ğœ
ğµ2(ğ‘¡) = ğ¶p(ğ‘¡) â€¦(22)
3.1.3 Logan Plot and Relative Equilibrium Plot
For reversible tracers, the Logan plot can be used
to estimate distribution volume or binding potential
 . The standard Logan plot equation is
+ ğ‘â€², ğ‘¡> ğ‘¡âˆ— â€¦(23)
However, the tissue activity curve ğ¶T(ğ‘¡) is involved nonlinearly in the Logan plot (and also in the
multilinear model by Ichise et al ), which makes
direct reconstruction more difficult. Considering the
fact that the ratio between the tissue time activity
ğ¶T(ğ‘¡) and plasma concentration ğ¶p(ğ‘¡) remains constant at relative equilibrium, Zhou et al proposed
replacing ğ¶T(ğ‘¡) in the denominators by ğ¶p(ğ‘¡). The
model is referred to as the relative equilibrium (RE)
model. After a slight rearrangement, we can write the
RE model in the following form:
âˆ«ğ¶T(ğœ)ğ‘‘ğœ= ğ·ğ‘‰âˆ«ğ¶p(ğœ)ğ‘‘ğœ+ ğ‘à·¤â€²ğ¶p(ğ‘¡), ğ‘¡> ğ‘¡âˆ—
where the cumulative time activity âˆ«ğ¶T(ğœ)ğ‘‘ğœ
is expressed as a linear combination of the same two basis
functions as those in the Patlak plot.
To use the RE model, all the time frames should
start from ğ‘¡= 0 so that the reconstructed dynamic
images represent the cumulative time activity
. One consequence is that the projection
data in different frames are no longer independent, so
the likelihood function in (9) needs some modification
to obtain a true ML estimate. In addition, the intercept
ğ‘à·¨â€² in Eq. (24) is usually negative, which makes the
classic EM algorithm not applicable to the resulting
direct reconstruction.
Taking the derivative on both sides of (24), Zhou
et al presented an alternative form of the RE
ğ¶T(ğ‘¡) = ğ·ğ‘‰ğ¶p(ğ‘¡) + ğ‘à·¤â€²ğ¶Ì‡ p(ğ‘¡), ğ‘¡> ğ‘¡âˆ— â€¦(25)
where ğ¶Ì‡ p(ğ‘¡) is the first-order derivative of ğ¶p(ğ‘¡). One
advantage of the modified RE model in (25) is that it
does not involve the cumulative time activity. In addition, since both ğ‘à·¨â€² and ğ¶Ì‡ p(ğ‘¡) are negative, we can
rewrite (25) in positive terms
ğ¶T(ğ‘¡; ğ“) = ğ·ğ‘‰ğµ1(ğ‘¡) + àµ«âˆ’ğ‘à·¤â€²àµ¯ğµ2(ğ‘¡), ğ‘¡> ğ‘¡âˆ— â€¦(26)
with ğ“= àµ£ğ·ğ‘‰, âˆ’ğ‘à·¨â€²àµ§
ğ‘‡ and the two basis functions
ğµ1(ğ‘¡) = ğ¶p(ğ‘¡) â€¦(27)
ğµ2(ğ‘¡) = âˆ’ğ¶Ì‡ p(ğ‘¡) â€¦ (28)
The model equation (26) is now suitable for direct reconstruction using the classic EM algorithm
because the coefficient âˆ’ğ‘à·¨â€² and the basis function
ğµ2(ğ‘¡) are both nonnegative when ğ‘¡> ğ‘¡âˆ—. Note that
ğ¶p(ğ‘¡) can also be replaced by a reference region TAC
ğ¶r(ğ‘¡) to calculate DVR.
3.2 Forward Projection
With a linear kinetic model in (15), the dynamic
PET images can be expressed in a matrix-vector
ğ‘¿ğ‘‡= ğ‘©ğš¯ğ‘‡ â€¦(29)
or equivalently,
ğ’™= á‰€ğ‘©â¨‚ğ‘°ğ‘›ğ‘—á‰ğœ½ â€¦(30)
Theranostics 2013, Vol. 3, Issue 10
 
where the (ğ‘š, ğ‘˜)th element of the temporal basis matrix ğ‘©âˆˆâ„ğ‘›ğ‘šÃ—ğ‘›ğ‘˜ is given by
ğµğ‘˜(ğœ)ğ‘’âˆ’ğœ†ğœğ‘‘ğœ
Substituting the above equations into Eq. (6), we
get the following forward model for the linear kinetic
ğ’€à´¤(ğš¯) = ğ‘·ğš¯ğ‘©ğ‘‡+ ğ‘¹ â€¦(32)
or equivalently,
ğ’šà´¤(ğœ½) = (ğ‘©â¨‚ğ‘·)ğœ½+ ğ’“ â€¦(33)
3.3 Direct Reconstruction Using a Single
System Matrix
By treating ğ‘©â¨‚ğ‘· as a single system matrix
ğ‘¨â‰¡ğ‘©â¨‚ğ‘·, any existing algorithms for static PET reconstruction can be used for the direct estimation of
nonnegative linear parametric images. For example,
applying the ML EM algorithm , we get the
following update equation for direct linear parametric
image reconstruction :
ğ‘ğ‘—ğ‘ğ‘˜âˆ‘âˆ‘ğ‘ğ‘–ğ‘—ğµğ‘šğ‘˜
where the superscript ğ‘› denotes the ğ‘›th iteration and
Similar to static PET reconstruction, the convergence of the parametric EM algorithm can be very
slow. Preconditioned conjugate gradient (PCG) algorithm and other accelerated algorithms can be
used to achieve a faster convergence. One example of
direct application of PCG to Patlak reconstruction can
be found in . When negative values are present in
the parametric images, such as those in the original
relative equilibrium model (24), the AB-EM algorithm
can be used .
One disadvantage of direct reconstruction using
a single system matrix is that the convergence can be
extremely slow when the temporal basis functions are
highly correlated as in the spectral analysis and Patlak
model . This is because the combination of the
temporal correlation and high spatial dimension results in an ill-posed problem that is much worse than
the static PET reconstruction. One way to solve this
problem is to decouple the spatial image update and
temporal parameter estimation at each iteration using
the nested EM algorithm described below.
3.4 Nested EM Algorithm
The nested EM algorithm at iteration (ğ‘›+ 1)
first calculates an intermediate dynamic image {ğ‘¥à·œğ‘—ğ‘š
ğ‘¦à´¤ğ‘–ğ‘š(ğœ½ğ‘›) â€¦(37)
and then updates the kinetic parameter estimate by
another EM-like equation
ğ‘¦à´¤ğ‘–ğ‘š(ğœ½ğ‘›) , ğ‘™= 1, â€¦ , ğ‘›ğ‘™ â€¦(38)
ğ‘›,ğ‘›ğ‘™+1 , and ğ‘™ is the
sub-iteration number in iteration (ğ‘›+ 1). Each full
iteration of the nested EM algorithm consists of one
iteration of EM-like emission image update (37) and
multiple iterations of kinetic parameter estimation
The nested EM algorithm was derived by using
the optimization transfer principle . A surrogate
function ğ‘„em(ğœ½; ğœ½ğ‘›) is constructed at each iteration,
ğ‘„em(ğœ½; ğœ½ğ‘›) = âˆ‘ğ‘ğ‘—
ğ‘em(ğœ½ğ‘—; ğ’™à·œğ‘—
em,ğ‘›) â€¦(39)
ğ‘emàµ«ğœ½ğ‘—; ğ’™à·œğ‘—
em,ğ‘›àµ¯= âˆ‘ğ’™à·œğ‘—ğ‘š
log ğ‘¥ğ‘šàµ«ğœ½ğ‘—àµ¯âˆ’ğ‘¥ğ‘šàµ«ğœ½ğ‘—àµ¯
where ğ‘¥à·œğ‘—ğ‘š
em,ğ‘› is given by (37). This surrogate function
ğ‘„em(ğœ½; ğœ½ğ‘›) âˆ’ğ‘„em(ğœ½ğ‘›; ğœ½ğ‘›) â‰¤ğ¿(ğ’š|ğœ½) âˆ’ğ¿(ğ’š|ğœ½ğ‘›) â€¦(41)
Then the maximization of the original likelihood
function ğ¿(ğ’š|ğœ½) is transferred into the maximization
of the surrogate function ğ‘„em(ğœ½; ğœ½ğ‘›) that can be
solved pixel-by-pixel,
ğ‘›+1 = argmaxğœ½ğ‘—â‰¥ğŸğ‘em(ğœ½ğ‘—; ğ’™à·œğ‘—
em,ğ‘›) â€¦(42)
Applying the EM algorithm to (42) results in the
update equation in (38). The property of the surrogate
function guarantees
ğ¿(ğ’š|ğœ½ğ‘›+1) â‰¥ğ¿(ğ’š|ğœ½ğ‘›) â€¦(43)
and ğœ½ğ‘› converges to the global solution.
It is easy to verify that the traditional EM algorithm in (34) is a special case of the nested EM algorithm with ğ‘›ğ‘™= 1 . By running multiple iterations
of (38) with ğ‘›ğ‘™> 1, the nested EM algorithm can substantially accelerate the convergence rate of the direct
reconstruction of linear parametric images without
affecting the overall computational time as the size of
matrix ğ‘© is much smaller than that of the system matrix ğ‘·. This is clearly demonstrated by a toy example
shown in Fig. 1 . Starting from the same initial
image, the nested EM takes 6 iterations to converge to
the true solution, while the traditional EM requires
more than 60 iterations. The nested EM algorithm can
be further accelerated by considering the nested EM
algorithm as an implicit preconditioner and using
conjugate directions .
Theranostics 2013, Vol. 3, Issue 10
 
Figure 1: Isocontours of the likelihood function of a toy problem and the
trajectories of the iterates of the traditional EM (ğ‘›ğ‘™= 1) and the nested
EM (ğ‘›ğ‘™= 30). The nested EM takes 6 iterations to converge to the final
solution, while the traditional EM requires more than 60 iterations. Reprinted from with permission.
4 Reconstruction of Parametric Images
for Compartment Models
4.1 Compartment Modeling
While linear models are advantageous for computational efficiency, nonlinear kinetic models based
on compartment modeling are more related to the
well-developed biochemical kinetics . Under a
compartment model, the total tracer concentration in
ğ¶T(ğ‘¡; ğ“) = (1 âˆ’ğ‘“v) âˆ‘
ğ‘ğ‘›(ğ‘¡) + ğ‘“vğ¶wb(ğ‘¡)
where ğ‘“v is the fractional volume of blood, ğ¶wb(ğ‘¡)is
the whole blood concentration, and ğ‘ğ‘›(ğ‘¡) represents
the concentration of the ğ‘›th tissue compartment. The
compartment concentrations are related with each
other by a set of ordinary differential equations ,
ğ‘‘ğ‘¡ğ’„(ğ‘¡) = ğ‘²ğ’„(ğ‘¡) + ğ‘³ğ’–(ğ‘¡) â€¦(45)
where ğ’„(ğ‘¡) = [ğ‘1(ğ‘¡),âˆ™âˆ™âˆ™, ğ‘ğ‘(ğ‘¡)]ğ‘‡, ğ‘² and ğ‘³ are the kinetic
parameter matrices that are formed by the rate constants in ğ“, and ğ’–(ğ‘¡) denotes the system input.
Taking the Laplace transform of (45), we get
ğ‘ ğ’„à·œ(ğ‘ ) = ğ‘²ğ’„à·œ(ğ‘ ) + ğ‘³ğ’–à·(ğ‘ ) â€¦(46)
where ğ’„à·œ(ğ‘ ) = â„’[ğ’„(ğ‘¡)] and ğ’–à·œ(ğ‘ ) = â„’[ğ’–(ğ‘¡)] denote the
Laplace transforms of ğ’„(ğ‘¡) and ğ’–(ğ‘¡) , respectively.
Then solution of the differential equation (45) can be
obtained by
ğ’„(ğ‘¡) = â„’âˆ’1[(ğ‘ ğ‘°ğ‘âˆ’ğ‘²)âˆ’1ğ‘³ğ’–à·(ğ‘ )] â€¦(47)
where â„’âˆ’1 denotes the inverse Laplace transform.
For the commonly used two-tissue compartment
model, we have
ğ‘²= àµ¬âˆ’(ğ‘˜2 + ğ‘˜3)
âˆ’ğ‘˜4àµ°, ğ’„(ğ‘¡) = á‰€ğ¶f(ğ‘¡)
ğ¶b(ğ‘¡)á‰ â€¦(48)
0 àµ¯, ğ’–(ğ‘¡) = ğ¶p(ğ‘¡) â€¦(49)
with ğ“= [ğ‘“v, ğ¾1, ğ‘˜2, ğ‘˜3, ğ‘˜4]ğ‘‡, where ğ¾1, ğ‘˜2, ğ‘˜3, ğ‘˜4 are
the tracer rate constants, ğ¶f(ğ‘¡) and ğ¶b(ğ‘¡) are the concentrations in the free and bound compartments, and
ğ¶p(ğ‘¡) is the tracer concentration in plasma. The analytical solution of ğ’„(ğ‘¡) is given by
âˆ’ğ‘˜3 àµ°á‰†ğ‘’âˆ’ğ›¼1ğ‘¡âˆ—ğ¶p(ğ‘¡)
ğ‘’âˆ’ğ›¼2ğ‘¡âˆ—ğ¶p(ğ‘¡)á‰‡ â€¦(50)
where âˆ†ğ›¼= ğ›¼2 âˆ’ğ›¼1 with ğ›¼1,2 =
2 (ğ‘˜2 + ğ‘˜3 + ğ‘˜4) âˆ“
2 [(ğ‘˜2 + ğ‘˜3 + ğ‘˜4)2 âˆ’4ğ‘˜2ğ‘˜4]1/2 , and â€œ*â€ denotes the
convolution operator.
4.2 Model-dependent Algorithms
4.2.1 PICD Algorithm
The parametric iterative coordinate descent
(PICD) algorithm was the first direct reconstruction algorithm implemented for a large-scale parametric reconstruction with a compartment model. It
first transforms the rate constants in the compartment
model into a set of auxiliary parameters and then estimates the auxiliary parameters directly from the
sinogram data. For example, the TAC in a
two-tissue-compartment model is rewritten as
ğ¶T(ğ‘¡; ğ“) = àµ«1 âˆ’ğ‘“vàµ¯âˆ‘
âˆ—ğ¶p(ğ‘¡) + ğ‘“vğ¶wb(ğ‘¡)
parameters
ğ“= [ğ‘“v, ğœˆ1, ğœˆ2, ğ›¼1, ğ›¼2]ğ‘‡. Once the auxiliary parameters
are estimated, the kinetic rate constants can be calculated by
ğ‘˜1 = ğœˆ1 + ğœˆ2 â€¦(52)
ğœˆ1ğœˆ2(ğ›¼1âˆ’ğ›¼2)2
(ğœˆ1ğ›¼1+ğœˆ2ğ›¼2)(ğœˆ1+ğœˆ2) â€¦(54)
ğ›¼1ğ›¼2(ğœˆ1+ğœˆ2)
ğœˆ1ğ›¼1+ğœˆ2ğ›¼2 â€¦(55)
To estimate the auxiliary parameters, a coordinate descent (CD) algorithm is used. The original
log-likelihood function is approximated by its second-order Taylor expansion. At each iteration, the
auxiliary parameters are updated by
ğ‘›+1 = argminğœ½ğ‘—âˆˆğ’®âˆ‘
2 (ğœ½ğ‘—)) + ğ›½ğ‘‰à·œ(ğœ½ğ‘—) â€¦(56)
Theranostics 2013, Vol. 3, Issue 10
 
where âˆ†ğ‘¥ğ‘šàµ«ğœ½ğ‘—àµ¯= ğ‘¥ğ‘šàµ«ğœ½ğ‘—àµ¯âˆ’ğ‘¥ğ‘šàµ«ğœ½ğ‘—
ğ‘› and ğ»à·ğ‘—ğ‘š
ğ‘› denote the gradient and Hessian of the negative
log-likelihood function ğ¿(ğ’š|ğœ½) with respect to ğ‘¥ğ‘šàµ«ğœ½ğ‘—àµ¯
at ğœ½à· ğ‘›,ğ‘—â‰¡{ğœ½1
ğ‘›+1, â€¦ , ğœ½ğ‘—âˆ’1
ğ‘›, â€¦ , ğœ½ğ‘›ğ‘—
ğ‘›} and are given by
â„Ì‡ ğ‘–ğ‘š(ğ‘™ğ‘–ğ‘šàµ«ğœ½à·œ
ğ‘›,ğ‘—àµ¯) â€¦(57)
â„Ìˆ ğ‘–ğ‘š(ğ‘™ğ‘–ğ‘šàµ«ğœ½à·œ
ğ‘›,ğ‘—àµ¯) â€¦(58)
first-order
derivative â„Ì‡ ğ‘–ğ‘š(ğ‘™) and
second-order derivative â„Ìˆ ğ‘–ğ‘š(ğ‘™) are respectively given by
â„Ì‡ ğ‘–ğ‘š(ğ‘™) =
ğ‘™+ğ‘Ÿğ‘–ğ‘šâˆ’1 â€¦(59)
â„Ìˆ ğ‘–ğ‘š(ğ‘™) = âˆ’
(ğ‘™+ğ‘Ÿğ‘–ğ‘š)2 â€¦(60)
The regularization term ğ‘‰à·(ğœ½ğ‘—) equals to ğ‘‰(ğœ½)
with ğœ½ fixed at ğœ½à· ğ‘›,ğ‘— for all pixels other than pixel ğ‘—.
The PICD algorithm uses an iterative gradient
descent algorithm to update the linear parameters in
ğœ½ğ‘— and an iterative golden section search to estimate
the nonlinear components. To accelerate the convergence rate and reduce computational cost, the PICD
algorithm updates the linear parameters more frequently than the nonlinear parameters.
The PICD algorithm is well suited for one- and
two-tissue-compartment models. For kinetic models
with more than two tissue compartments, however,
the parameter transformation becomes too complicated.
4.2.2 PMOLAR-1T Algorithm
The PMOLAR-1T algorithm is an EM algorithm for direct reconstruction of parametric images
for the one-tissue compartment model. It is derived by
introducing a new set of complete data that simultaneously decouples the pixel correlation as well as the
temporal convolution. Here we introduce it using the
optimization transfer framework.
First we note that the surrogate function in (40) is
applicable
one-tissue-compartment model, the tissue time activity curve can be described by
ğ¶T(ğ‘¡) = ğœ‰(ğ‘¡; ğ“) âˆ—ğ¶p(ğ‘¡), ğœ‰(ğ‘¡; ğ“) = ğ¾1ğ‘’âˆ’ğ‘˜2ğ‘¡ â€¦(61)
and we have
ğ‘šâ€²=1 àµ«ğ‘¡ğ‘šâ€²; ğœ½ğ‘—àµ¯ğ‘¢ğ‘š,ğ‘šâ€²
where ğ‘¢ğ‘š,ğ‘šâ€² â‰œâˆ†ğ‘¡âˆ«
ğ¶pàµ«ğœâˆ’ğ‘¡ğ‘šâ€²àµ¯ğ‘’âˆ’ğœ†ğœğ‘‘ğœ
. Here we approximate the convolution integral using the summation over ğ‘›ğ‘ uniformly sampled time points with âˆ†ğ‘¡
being the time interval.
Applying the EM surrogate function to (40) one
more time to decouple the temporal correlation, we
can find the maximum of (40) iteratively by
ğ‘¢ğ‘šâ€²á‰€ğœ‰Ì‚ğ‘—,ğ‘šâ€²
ğ‘›,ğ‘™log ğœ‰(ğ‘¡ğ‘šâ€²; ğœ½ğ‘—á‰âˆ’
ğœ‰(ğ‘¡ğ‘šâ€²; ğœ½ğ‘—))
ğ‘™= 1,âˆ™âˆ™âˆ™, ğ‘›ğ‘™
where ğ‘¢ğ‘šâ€² â‰œâˆ‘
and ğœ‰à· ğ‘—,ğ‘šâ€²
ğ‘›,ğ‘™ is given by
For the one-tissue compartment model with
ğœ½ğ‘—= àµ£ğ¾1,ğ‘—, ğ‘˜2,ğ‘—àµ§
ğ‘‡, the optimization in (63) has the following analytical solution:
ğ‘›,ğ‘™+1 = ğ»âˆ’1 á‰†
ğ‘›,ğ‘™á‰‡ â€¦(65)
ğ‘›,ğ‘™+1ğ‘¡ğ‘šâ€²) â€¦(66)
where ğ»âˆ’1(âˆ™) is the inverse function of the function
ğ»(ğ‘˜2) 
ğ‘¡ğ‘šâ€²ğ‘¢ğ‘šâ€²exp(âˆ’ğ‘˜2ğ‘¡ğ‘šâ€²)
ğ‘¢ğ‘šâ€²exp(âˆ’ğ‘˜2ğ‘¡ğ‘šâ€²)
and can be calculated by a look-up table.
The original PMOLAR-1T algorithm only
uses one subiteration with ğ‘›ğ‘™= 1. Based on our experience with the nest EM algorithm for linear models,
we expect that the convergence rate of the
PMOLAR-1T algorithm can be accelerated by using
more than one subiterations (ğ‘›ğ‘™> 1).
4.3 Model-independent Algorithms
4.3.1 Iterative NLS Algorithms
Reader et al proposed an iterative nonlinear
least squares (NLS) algorithm for direct parametric
image reconstruction. It iteratively applies the NLS
kinetic fitting following an EM image update:
ğ‘›+1 = argminğœ½ğ‘—âˆˆğ’®
em,ğ‘›âˆ’ğ‘¥ğ‘š(ğœ½ğ‘—))2
where {ğ‘¥à·œğ‘—ğ‘š
em,ğ‘›} is the dynamic image given in (37). The
weighting factor ğ‘¤ğ‘—ğ‘š
ğ‘› has to be chosen empirically. In
 a uniform weight ğ‘¤ğ‘—ğ‘š
ğ‘›= 1 was used. Based on the
fact that (40) resembles a Poisson log-likelihood function, Matthews et al proposed the following
nonuniform weighting factor
Theranostics 2013, Vol. 3, Issue 10
 
which substantially improved performance over the
uniform weight.
However, neither the uniform nor the nonuniform weights provides any theoretical guarantee of
convergence because the quadratic function in (68) is
not a proper surrogate function. It has been observed
that the uniform weight can result in non-monotonic
changes in the likelihood function, although the results with the nonuniform weighting are reasonably
4.3.2 OT-SP Algorithm
To obtain a guaranteed convergence while
maintaining the simplicity of the iterative NLS algorithm, Wang and Qi proposed a quadratic surrogate function for the penalized likelihood function
using optimization transfer (OT). The surrogate function of the log-likelihood is derived based on the fact
that the second-order derivative of â„ğ‘–ğ‘š(ğ‘™) is a
non-decreasing function of ğ‘™ and is bounded when
ğ‘Ÿğ‘–ğ‘š> 0. The potential function ğœ“(ğ‘¡) in (14) also has a
bounded, non-increasing second-order derivative of
|ğ‘¡|. Omitting the constants that are independent of ğœ½,
the surrogate function of the penalized likelihood is
ğ‘„(ğœ½; ğ’›ğ‘›+1) = âˆ’âˆ‘
ğ‘›+1 âˆ’ğ‘™ğ‘–ğ‘š(ğœ½)á‰
(ğœ½); ğ’™ğ‘š(ğœ½ğ‘›)) â€¦(70)
where the optimum curvature {ğœ‚ğ‘–ğ‘š
ğ‘›} is set to 
ğ‘™2 [â„ğ‘–ğ‘š(ğ‘™) âˆ’â„ğ‘–ğ‘š(0) âˆ’ğ‘™â„Ì‡ ğ‘–ğ‘š(ğ‘™)], ğ‘™> 0
âˆ’â„Ìˆ ğ‘–ğ‘š(ğ‘™), ğ‘™= 0
with ğ‘™= ğ‘™ğ‘–ğ‘š(ğœ½ğ‘›) and ğ’›ğ‘›+1 â‰¡{ğ‘§ğ‘–ğ‘š
ğ‘›+1} is an intermediate
dynamic sinogram at iteration (ğ‘›+ 1),
ğ‘›+1 = ğ‘™ğ‘–ğ‘š(ğœ½ğ‘›) +
â„Ì‡ğ‘–ğ‘š(ğ‘™ğ‘–ğ‘š(ğœ½ğ‘›))
The second term in (70) is the surrogate function
for the penalty function and is given by
ğ‘ˆà·¥(ğ; ğğ‘›) =
where ğ‘¤ğœ“(ğ‘¡) is the optimum curvature of the penalty
function ğœ“(ğ‘¡)
For example ğ‘¤ğœ“(ğ‘¡) = 1 for the quadratic penalty
and ğ‘¤ğœ“(ğ‘¡) =
|ğ‘¡|+ğ›¿ for the nonquadratic Lange penalty.
With ğ‘Ÿğ‘–ğ‘š> 0, the surrogate ğ‘„(ğœ½; ğ’›ğ‘›+1) satisfies
the following condition:
ğ‘„(ğœ½; ğ’›ğ‘›+1) âˆ’ğ‘„(ğœ½ğ‘›; ğ’›ğ‘›+1) â‰¤Î¦(ğœ½) âˆ’Î¦(ğœ½ğ‘›) â€¦(75)
Hence it minorizes the original objective function Î¦(ğœ½).
The optimization of the quadratic surrogate
function can be solved pixel-by-pixel in a coordinate
descent (CD) fashion . However, the OT-CD algorithm is difficult to parallelize because of the sequential update.
For simultaneous update, Wang and Qi further
developed an OT-SP (optimization transfer using
separable paraboloids) algorithm that uses separable paraboloids to decouple the correlations between pixels in ğ‘„(ğœ½; ğ’›ğ‘›+1) at each iteration. The overall surrogate function that minorizes the original objective function ğ›·(ğœ½) at iteration n is
ğ‘„ğ‘ ğ‘(ğœ½; ğœ½ğ‘›) = âˆ’âˆ‘
sp,ğ‘›âˆ’ğ‘¥ğ‘šàµ«ğœ½ğ‘—àµ¯á‰
where the weighting factor {ğ‘¤ğ‘—ğ‘š
ğ‘›} in the separable
least squares is
= âˆ‘ğ‘ğ‘–,ğ‘ğ‘–ğ‘—ğœ‚ğ‘–ğ‘š
ğ›¾ğ‘—ğ‘˜ğ‘¤ğœ“á‰€ğ‘¥ğ‘šàµ«ğœ½ğ‘—
with ğ‘ğ‘–= âˆ‘ğ‘ğ‘–ğ‘—
. The intermediate dynamic image
sp,ğ‘›} is given by
sp,ğ‘›= ğ‘¥ğ‘šàµ«ğœ½ğ‘—
ğ‘›(ğœ½ğ‘›) is the gradient of ğ›·(ğœ½) with respect to
ğ‘›(ğœ½ğ‘›) = âˆ’ âˆ‘ğ‘ğ‘–ğ‘—â„Ì‡ ğ‘–ğ‘šàµ«ğ‘™ğ‘–ğ‘š(ğœ½)àµ¯âˆ’
ğ›¾ğ‘—ğ‘˜ğœ“Ì‡ àµ£ğ‘¥ğ‘šàµ«ğœ½ğ‘—àµ¯âˆ’ğ‘¥ğ‘š(ğœ½ğ‘˜)àµ§
evaluated at ğœ½= ğœ½ğ‘›.
Because ğ‘„ğ‘ ğ‘(ğœ½; ğœ½ğ‘›) is separable for pixels, maximization of ğ‘„ğ‘ ğ‘(ğœ½; ğœ½ğ‘›) is reduced to a pixel-wise least
squares fitting optimization:
ğ‘›+1 = argminğœ½ğ‘—âˆˆğ’®
sp,ğ‘›âˆ’ğ‘¥ğ‘šàµ«ğœ½ğ‘—àµ¯á‰
which can be solved by any existing nonlinear least
squares methods (e.g. the Levenberg-Marquardt algorithm).
In summary, each iteration of the OT-SP algorithm consists of two steps: an image update in (78)
and a NLS fitting in (80). It has the simplicity of the
iterative NLS algorithm, but guarantees a monotonic
convergence with Î¦(ğœ½ğ‘›+1 â‰¥Î¦(ğœ½ğ‘›). Compared to the
PICD and OT-CD algorithms, the OT-SP algorithm
can be easily parallelized. A disadvantage of the
OT-SP is that it requires the background {rim} to be
Theranostics 2013, Vol. 3, Issue 10
 
positive for the quadratic surrogate function to work,
so the convergence rate can be slow when the level of
background events is low.
4.3.3 OT-EM Algorithm
The OT-EM (optimization transfer using the EM
surrogate) was derived for direct reconstruction under low background levels . It combines the
EM surrogate function in (40) for the log-likelihood
function and a separable surrogate function for the
penalty function. The overall surrogate function is
ğ‘„(ğœ½; ğœ½ğ‘›) = âˆ‘
á‰„ğ‘ğ‘—ğ‘emàµ«ğœ½ğ‘—; ğ’™à·ğ‘—
ğœ“àµ£2ğ‘¥ğ‘šàµ«ğœ½ğ‘—àµ¯âˆ’ğ‘¥ğ‘š(ğœ½ğ‘˜
The optimization of the penalized likelihood
function Î¦(ğœ½) with respect to ğœ½ is transferred into the
maximization of the surrogate function ğ‘„(ğœ½; ğœ½ğ‘›) ,
which can be solved by the following small-scale pixel-wise optimization:
ğ‘›+1 = argmaxğœ½ğ‘—âˆˆğ’®ğ‘emàµ«ğœ½ğ‘—; ğ’™à·œğ‘—
ğœ“àµ£2ğ‘¥ğ‘šàµ«ğœ½ğ‘—àµ¯âˆ’ğ‘¥ğ‘š(ğœ½ğ‘˜
A modified Levenberg-Marquardt algorithm
was developed to solve this pixel-wise penalized
likelihood fitting in .
The OT-EM guarantees a monotonic increase in
the penalized likelihood Î¦(ğœ½ğ‘›+1) â‰¥Î¦(ğœ½ğ‘›) following
the optimization transfer properties of ğ‘„(ğœ½; ğœ½ğ‘›). It can
be much faster than the OT-SP algorithm when the
level of background events (scatters and randoms) is
5 Joint Reconstruction of Parametric Images and Input Function
In parametric image reconstruction, the blood
input function ğ¶p(ğ‘¡) is required to be known a priori.
One standard method of measuring blood input is
arterial blood sampling, which is invasive and technically challenging. An alternative to arterial sampling is to derive the input function from a blood region or a reference region in a reconstructed image
 . When the region used for extraction of the input
function is of small size, the image-derived input
function (IDIF) can be less accurate due to partial
volume and other effects. Joint estimation of the input
function and parametric images can potentially improve the accuracy of the IDIF as well as the parametric images by fitting the input function and parametric image to the data simultaneously .
5.1 General Formulation
Given a set of kinetic parameters, the time activity curve ğ¶T(ğ‘¡; ğ“) is a linear function of the input
function u(t), which can be either the blood input
function ğ¶p(ğ‘¡) or a reference tissue function ğ¶v(ğ‘¡). Let
ğ’— denote the vector of parameters that defines the
input function ğ‘¢(ğ‘¡) (e.g. the activity values at a set of
time points). Then the joint estimation can be formulated as
ğœ½à·œ, ğ’—à·œ= argmaxğœ½âˆˆğ’®,ğ’—âˆˆğ’°Î¦(ğœ½, ğ’—) â€¦(83)
where ğ’° denotes the feasible set of ğ’— and the penalized likelihood function Î¦(ğœ½) defined in (12) is rewritten here as an explicit function of ğ’—.
The maximization in (83) can be solved by an
alternating update algorithm (e.g. in )
ğœ½ğ‘›+1 = argmaxğœ½âˆˆğ’®Î¦(ğœ½, ğ’—ğ‘›)
ğ’—ğ‘›+1 = argmaxğ’—âˆˆğ’°Î¦(ğœ½ğ‘›+1, ğ’—) â€¦(84)
5.2 Joint Estimation without an Input Region
One method for joint estimation without an input region was presented by Reader et al . The
algorithm was developed for the linear spectral analysis model. It uses the EM algorithm to find the ML
estimation of the input function and the linear coefficients from dynamic projection data. Here we introduce it using the optimization transfer principle and
describe how to extend it to nonlinear kinetic models.
We use the EM surrogate function in (40) for the
log-likelihood function Î¦(ğœ½, ğ’—). Here we rewrite it as
an explicit function of the input parameters ğ’—,
ğ‘„ğ‘›(ğœ½, ğ’—) = âˆ‘ğ‘ğ‘—ğ‘em
ğ‘›àµ«ğœ½ğ‘—, ğ’—àµ¯= âˆ‘ğ‘¥à·œğ‘—ğ‘š
em,ğ‘›log ğ‘¥ğ‘šàµ«ğœ½ğ‘—, ğ’—àµ¯âˆ’ğ‘¥ğ‘š(ğœ½ğ‘—, ğ’—)
where ğ‘¥à·œğ‘—ğ‘š
em,ğ‘› is given by (37) and ğ‘¥ğ‘š(ğœ½ğ‘—, ğ’—) is the same
as ğ‘¥ğ‘š(ğœ½ğ‘—) but as an explicit function of ğ’—. Since
ğ‘„ğ‘›(ğœ½, ğ’—) is separable for pixels when v is given, the
optimization (84) is transferred to
ğ‘›+1 = argmaxğœ½ğ‘—âˆˆğ’®ğ‘em
ğ‘›(ğœ½ğ‘—, ğ’—ğ‘›) â€¦(87)
ğ’—ğ‘›+1 = maxğ’—âˆˆğ’°ğ‘¸ğ‘›(ğœ½ğ‘›+1, ğ’—) â€¦(88)
For a linear kinetic model, both above steps can
be solved by the EM algorithm with multiple
sub-iterations. When only one sub-iteration is used, it
is equivalent to the algorithm in .
For compartment models, the optimization in
(87) can be solved by the modified Levenberg-Marquardt algorithm given in . The update
of ğ’— in (88) can still be solved by the EM algorithm.
Theranostics 2013, Vol. 3, Issue 10
 
5.3 Joint Estimation with an Input Region
One issue with the joint estimation without an input region is that there is an unknown scaling factor on ğ’—
and the linear coefficients in {ğœ½ğ‘—} that cannot be determined. The problem can be solved if there is a region in the
image that contains purely the input function. Let ğ›¤ denote such a region. Then the image intensity at pixel ğ‘—âˆˆğ›¤
in time frame ğ‘š is
ğ‘¥ğ‘šàµ«ğœ½ğ‘—, ğ’—àµ¯= âˆ«
ğ‘¢(ğœ; ğ’—)ğ‘’âˆ’ğœ†ğœğ‘‘ğœ
, ğ‘—âˆˆğ›¤ â€¦(89)
The joint estimation then estimates the kinetic parameters at pixels outside ğ›¤ and the time activity curve
inside ğ›¤ simultaneously.
Using the same paraboloidal surrogate functions for the OT-SP algorithm, the following algorithm can be
obtained :
ğ‘›+1 = argminğœ½âˆˆğ’®âˆ‘ğ‘¤ğ‘—ğ‘š
sp,ğ‘›âˆ’ğ‘¥ğ‘šàµ«ğœ½ğ‘—, ğ’—ğ‘›àµ¯á‰
ğ’—ğ‘›+1 = argminğ’—âˆˆğ’°àµ›âˆ‘
sp,ğ‘›âˆ’ğ‘¥ğ‘š(ğœ½ğ‘—
sp,ğ‘›âˆ’ğ‘¥ğ‘š(ğœ½ğ‘›+1, ğ’—)]
where {ğœ½ğ‘—} and ğ’— are updated in an alternating fashion. ğœ½ğ‘—
ğ‘›+1 for ğ‘—âˆ‰ğ›¤ is updated by the Levenberg-Marquardt
algorithm. The estimation of ğ’— in ( (90) is a linear least squares problem that can be solved easily (e.g. by QR
decomposition).
6 Examples
Here we show some simulation results to demonstrate the advantage of direct reconstruction over indirect
reconstruction. We simulated a 60-minute 18F-FDG brain scan using a brain phantom that consisted of gray
matter, white matter and a small tumor inside the white matter. The time activity curve of each region was
generated using a two-tissue compartment model and an analytical blood input function. Figure 2 shows the ğ‘˜3
images reconstructed by an indirect method and the OT-EM algorithm and Figure 3 shows the corresponding ğ¾ğ‘–
images. Clearly the direct reconstruction results have much less noise than the indirect reconstruction results
while maintaining the same spatial resolution. The improvement is similar to those observed in other studies for
both linear and compartment models .
Figure 2: The true and reconstructed ğ‘˜3 images by the indirect and direct algorithms (ğ›½= 0.0003).
Theranostics 2013, Vol. 3, Issue 10
 
Figure 3: True and reconstructed ğ¾ğ‘–= ğ¾1ğ‘˜3/(ğ‘˜2 + ğ‘˜3) images by the indirect and direct algorithms (ğ›½= 0.0003).
7 Conclusion
We have provided an overview of direct estimation algorithms for parametric image reconstruction
from dynamic PET data. Because of the combination
of tomographic reconstruction and kinetic modeling,
direct reconstruction algorithms are more complicated than static image reconstruction. Different algorithms have been developed to balance the tradeoff
between simplicity in implementation and fast convergence. We hope that the information in this paper
can provide guidance to readers for choosing the
proper direct reconstruction algorithm in real applications. In some situations, the choice is clear. For
example, the nested EM algorithm should be preferred over the traditional EM algorithm for linear
parametric image reconstruction because the former
converges much faster while preserving the same
simplicity in implementation. In other situations, the
choice may be more dependent on the user. We note
that as long as the algorithm guarantees global convergence, a simple algorithm can still reach the final
solution, albeit with a large number of iterations. We
expect that direct parametric image reconstruction
will find more and more applications in dynamic PET
studies and more novel algorithms will be developed
in the future.
Acknowledgement
The authors would like to thank Will Hutchcroft
for assistance in typesetting the manuscript.
This work was supported by the National Institute of Biomedical Imaging and Bioengineering under
grants R01EB000194 and RC4EB012836 and the Department of Energy under grant DE-SC0002294.
Competing Interests
The authors have declared that no competing
interest exists.